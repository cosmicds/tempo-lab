{"version":3,"file":"js/app.dcf9b3e2.js","mappings":"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AAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,KAAO,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACv9EC,EAAG,CAAC,OAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,MAAQ,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC19EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,KAAO,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UCHj9EC,EAAoB,CAC/BH,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACj+EC,EAAG,CAAC,OAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACl+EC,EAAG,CAAC,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,UCHp9EE,EAAmB,CAC9BJ,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC/9EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAU,OAAU,OAAU,OAAU,OAAU,OAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,SAC/9EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,MAAQ,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UCH98EG,EAAoB,CAC/BL,EAAG,CAAC,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,KAAO,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,SAC59EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,KAAO,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,SAC59EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UCH59EI,EAAoB,CAC/BN,EAAG,CAAC,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,IAAM,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC52EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACv9EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,UCHh9EK,EAAiB,CAC5BP,EAAG,CAAC,EAAK,mBAAqB,mBAAqB,oBAAsB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,GAAK,iBAAmB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,GAAK,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,GACh/JC,EAAG,CAAC,EAAK,mBAAqB,mBAAqB,oBAAsB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,GAAK,iBAAmB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,GAAK,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,GACh/JC,EAAG,CAAC,EAAK,mBAAqB,mBAAqB,oBAAsB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,GAAK,iBAAmB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,GAAK,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,ICFr+JM,EAAiC,CAC5CR,EAAG,CAAC,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC79EC,EAAG,CAAC,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,SACjiFC,EAAG,CAAC,SAAW,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UAIn9EO,EAAe,CAC1B,KAAQ,YACR,WAAc,CACZ,CACE,KAAQ,cACR,UAAa,CACX,EACA,EACA,GACA,KAEF,QAAW,CACT,GACA,EACA,GACA,KAEF,UAAa,sBACb,MAAS,EACT,KAAQ,qBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,EACA,GACA,KAEF,QAAW,CACT,GACA,GACA,GACA,KAEF,UAAa,sBACb,MAAS,oBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,GACA,KAEF,QAAW,CACT,GACA,GACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,GACA,KAEF,QAAW,CACT,GACA,GACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,GACA,KAEF,QAAW,CACT,GACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,GACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,IACA,IACA,KAEF,QAAW,CACT,GACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,KCnYDC,EAAsB,CACjCV,EAAG,CAAC,kBAAoB,mBAAqB,iBAAmB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,GAAK,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,GAAK,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBACh8JC,EAAG,CAAC,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,GAAK,iBAAmB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,GAAK,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBACh+JC,EAAG,CAAC,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,EAAK,EAAK,EAAK,EAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,oBAAsB,mBAAqB,oBAAsB,oBAAsB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,GAAK,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,GAAK,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,oBAIxgJS,EAAqB,CAChC,KAAQ,YACR,WAAc,CACZ,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,EACA,KAEF,QAAW,CACT,IACA,GACA,EACA,KAEF,UAAa,sBACb,MAAS,EACT,KAAQ,qBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,GACA,EACA,KAEF,UAAa,sBACb,MAAS,oBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,GACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,GACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,IACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,EACA,KAEF,QAAW,CACT,IACA,IACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,EACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,KClYDC,EAAmB,CAC9BZ,EAAG,CAAC,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,iBAAmB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,oBAAsB,mBAAqB,mBAAqB,oBAAsB,mBAAqB,oBAAsB,kBAAoB,iBAAmB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,iBAAmB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,gBAAkB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,iBAAmB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,iBAAmB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,gBAAkB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,gBAAkB,kBAAoB,gBAAkB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAC3lKC,EAAG,CAAC,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,gBAAkB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,gBAAkB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,iBAAmB,kBAAoB,iBAAmB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,mBACjhKC,EAAG,CAAC,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,gBAAkB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBA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","sources":["webpack://@cosmicds/tempo-lite/./src/components/LocationSearch.vue?5288","webpack://@cosmicds/tempo-lite/./src/components/LocationSearch.vue","webpack://@cosmicds/tempo-lite/./src/mapbox.ts","webpack://@cosmicds/tempo-lite/./src/components/LocationSearch.vue?99f6","webpack://@cosmicds/tempo-lite/./src/utils/vue.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/magma.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/inferno.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/plasma.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/viridis.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/cividis.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/gray.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/svs_nitrogen_dioxide.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/sargassum.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/cmo_haline.ts","webpack://@cosmicds/tempo-lite/./src/colormaps/index.ts","webpack://@cosmicds/tempo-lite/./src/esri/ImageLayerConfig.ts","webpack://@cosmicds/tempo-lite/./src/esri/utils.ts","webpack://@cosmicds/tempo-lite/./src/esri/geometry.ts","webpack://@cosmicds/tempo-lite/./src/utils/array_operations/array_math.ts","webpack://@cosmicds/tempo-lite/./src/esri/services/sampling.ts","webpack://@cosmicds/tempo-lite/./src/esri/services/TimeRangeOffsetter.ts","webpack://@cosmicds/tempo-lite/./src/esri/services/TempoDataService.ts","webpack://@cosmicds/tempo-lite/./src/composables/useUniqueTimeSelection.ts","webpack://@cosmicds/tempo-lite/./src/composables/useTimezone.ts","webpack://@cosmicds/tempo-lite/./src/utils/atleast1d.ts","webpack://@cosmicds/tempo-lite/./src/utils/timeRange.ts","webpack://@cosmicds/tempo-lite/./src/stores/app.ts","webpack://@cosmicds/tempo-lite/./src/TempoLab.vue","webpack://@cosmicds/tempo-lite/./src/TempoLab.vue?9a16","webpack://@cosmicds/tempo-lite/./src/TempoLab.vue?d70b","webpack://@cosmicds/tempo-lite/./src/components/ColorBar.vue?15b2","webpack://@cosmicds/tempo-lite/./src/components/ColorBar.vue","webpack://@cosmicds/tempo-lite/./src/components/ColorBar.vue?632f","webpack://@cosmicds/tempo-lite/./src/components/ColorBarHorizontal.vue?50bf","webpack://@cosmicds/tempo-lite/./src/components/ColorBarHorizontal.vue","webpack://@cosmicds/tempo-lite/./src/components/ColorBarHorizontal.vue?6f32","webpack://@cosmicds/tempo-lite/./src/components/InfoButton.vue?db30","webpack://@cosmicds/tempo-lite/./src/components/InfoButton.vue","webpack://@cosmicds/tempo-lite/./src/components/InfoButton.vue?de13","webpack://@cosmicds/tempo-lite/./plugins/vuetify.ts","webpack://@cosmicds/tempo-lite/./src/components/SnackbarAlert.vue?dde0","webpack://@cosmicds/tempo-lite/./src/components/SnackbarAlert.vue","webpack://@cosmicds/tempo-lite/./src/components/SnackbarAlert.vue?3716","webpack://@cosmicds/tempo-lite/./src/components/ShareButton.vue?f44e","webpack://@cosmicds/tempo-lite/./src/components/ShareButton.vue","webpack://@cosmicds/tempo-lite/./src/components/ShareButton.vue?a5b6","webpack://@cosmicds/tempo-lite/./src/utils/dom.ts","webpack://@cosmicds/tempo-lite/./src/composables/useDraggableDialog.ts","webpack://@cosmicds/tempo-lite/./src/components/CDSDialog.vue?f933","webpack://@cosmicds/tempo-lite/./src/components/CDSDialog.vue","webpack://@cosmicds/tempo-lite/./src/components/CDSDialog.vue?51b6","webpack://@cosmicds/tempo-lite/./src/components/MarqeeAlert.vue?b891","webpack://@cosmicds/tempo-lite/./src/components/MarqeeAlert.vue","webpack://@cosmicds/tempo-lite/./src/components/MarqeeAlert.vue?852b","webpack://@cosmicds/tempo-lite/./src/components/TimeseriesGraph.vue?a88f","webpack://@cosmicds/tempo-lite/./src/components/TimeseriesGraph.vue","webpack://@cosmicds/tempo-lite/./src/components/TimeseriesGraph.vue?a5cc","webpack://@cosmicds/tempo-lite/./src/components/SelectionComposer.vue?63bd","webpack://@cosmicds/tempo-lite/./src/components/SelectionComposer.vue","webpack://@cosmicds/tempo-lite/./src/components/SelectionComposer.vue?525e","webpack://@cosmicds/tempo-lite/./src/changes.ts","webpack://@cosmicds/tempo-lite/./src/components/HeaderBar.vue?c32b","webpack://@cosmicds/tempo-lite/./src/components/HeaderBar.vue","webpack://@cosmicds/tempo-lite/./src/components/HeaderBar.vue?482e","webpack://@cosmicds/tempo-lite/./src/date_time_range_selection/useTimezone.ts","webpack://@cosmicds/tempo-lite/./src/date_time_range_selection/useDateTimeSelector.ts","webpack://@cosmicds/tempo-lite/./src/date_time_range_selection/DateTimeRangeSelection.vue?5777","webpack://@cosmicds/tempo-lite/./src/date_time_range_selection/DateTimeRangeSelection.vue","webpack://@cosmicds/tempo-lite/./src/date_time_range_selection/DateTimeRangeSelection.vue?5987","webpack://@cosmicds/tempo-lite/./src/utils/array_operations/aggregator.ts","webpack://@cosmicds/tempo-lite/./src/utils/calendar_utils.ts","webpack://@cosmicds/tempo-lite/./src/esri/services/aggregation.ts","webpack://@cosmicds/tempo-lite/./src/components/plotly/plotly_styles.ts","webpack://@cosmicds/tempo-lite/./src/components/plotly/plotly_graph_elements.ts","webpack://@cosmicds/tempo-lite/./src/components/plotly/PlotlyGraph.vue?e433","webpack://@cosmicds/tempo-lite/./src/components/plotly/PlotlyGraph.vue","webpack://@cosmicds/tempo-lite/./src/components/plotly/PlotlyGraph.vue?0a73","webpack://@cosmicds/tempo-lite/./src/components/FoldedPlotlyGraph.vue?0cbd","webpack://@cosmicds/tempo-lite/./src/components/FoldedPlotlyGraph.vue","webpack://@cosmicds/tempo-lite/./src/components/FoldedPlotlyGraph.vue?2617","webpack://@cosmicds/tempo-lite/./src/utils/foldingValidation.ts","webpack://@cosmicds/tempo-lite/./src/components/DataFoldingAndBinning.vue?6043","webpack://@cosmicds/tempo-lite/./src/components/DataFoldingAndBinning.vue","webpack://@cosmicds/tempo-lite/./src/components/DataFoldingAndBinning.vue?1cea","webpack://@cosmicds/tempo-lite/./src/components/AdvancedOperations.vue?7006","webpack://@cosmicds/tempo-lite/./src/components/AdvancedOperations.vue","webpack://@cosmicds/tempo-lite/./src/components/AdvancedOperations.vue?a53d","webpack://@cosmicds/tempo-lite/./src/components/CTextField.vue?3472","webpack://@cosmicds/tempo-lite/./src/components/CTextField.vue","webpack://@cosmicds/tempo-lite/./src/components/CTextField.vue?1cb1","webpack://@cosmicds/tempo-lite/./src/components/DatasetCard.vue?c956","webpack://@cosmicds/tempo-lite/./src/components/DatasetCard.vue","webpack://@cosmicds/tempo-lite/./src/components/DatasetCard.vue?03d4","webpack://@cosmicds/tempo-lite/./src/utils/data_converters.ts","webpack://@cosmicds/tempo-lite/./src/components/UserDatasetTable.vue?f0de","webpack://@cosmicds/tempo-lite/./src/components/UserDatasetTable.vue","webpack://@cosmicds/tempo-lite/./src/components/UserDatasetTable.vue?047f","webpack://@cosmicds/tempo-lite/./src/components/UserDatasetEditor.vue?c4c0","webpack://@cosmicds/tempo-lite/./src/components/UserDatasetEditor.vue","webpack://@cosmicds/tempo-lite/./src/components/UserDatasetEditor.vue?c384","webpack://@cosmicds/tempo-lite/./src/components/DatasetControls.vue?731f","webpack://@cosmicds/tempo-lite/./src/components/DatasetControls.vue","webpack://@cosmicds/tempo-lite/./src/components/DatasetControls.vue?d58e","webpack://@cosmicds/tempo-lite/./src/components/ComparisonDataControls.vue?3088","webpack://@cosmicds/tempo-lite/./src/components/ComparisonDataControls.vue","webpack://@cosmicds/tempo-lite/./src/components/ComparisonDataControls.vue?ed95","webpack://@cosmicds/tempo-lite/./src/composables/useEsriTimesteps.ts","webpack://@cosmicds/tempo-lite/./src/components/TimeChips.vue?2981","webpack://@cosmicds/tempo-lite/./src/components/TimeChips.vue","webpack://@cosmicds/tempo-lite/./src/components/TimeChips.vue?b22d","webpack://@cosmicds/tempo-lite/./src/components/MapControls.vue?90e0","webpack://@cosmicds/tempo-lite/./src/components/MapControls.vue","webpack://@cosmicds/tempo-lite/./src/components/MapControls.vue?552a","webpack://@cosmicds/tempo-lite/./src/colormaps/utils.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/useMarker.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/baseUseSelection.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/useRectangleSelection.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/utils.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/usePointSelection.ts","webpack://@cosmicds/tempo-lite/./src/utils/color.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/useMultiMarker.ts","webpack://@cosmicds/tempo-lite/./src/maplibre_controls.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/useMap.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/MaplibreHomeTool.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/useZoomHome.ts","webpack://@cosmicds/tempo-lite/./src/components/MaplibreMap.vue?df5a","webpack://@cosmicds/tempo-lite/./src/components/MaplibreMap.vue","webpack://@cosmicds/tempo-lite/./src/components/MaplibreMap.vue?d3f0","webpack://@cosmicds/tempo-lite/./src/esri/maplibre/useEsriImageLayer.ts","webpack://@cosmicds/tempo-lite/./src/composables/maplibre/useFieldOfRegard.ts","webpack://@cosmicds/tempo-lite/./src/components/EsriMap.vue?2726","webpack://@cosmicds/tempo-lite/./src/components/EsriMap.vue","webpack://@cosmicds/tempo-lite/./src/components/EsriMap.vue?e24d","webpack://@cosmicds/tempo-lite/./src/components/MapColorbarWrap.vue?6038","webpack://@cosmicds/tempo-lite/./src/components/MapColorbarWrap.vue","webpack://@cosmicds/tempo-lite/./src/components/MapColorbarWrap.vue?dc27","webpack://@cosmicds/tempo-lite/./src/composables/addPowerPlants.ts","webpack://@cosmicds/tempo-lite/./src/togeojson.js","webpack://@cosmicds/tempo-lite/./src/composables/useAbortableFetch.ts","webpack://@cosmicds/tempo-lite/./src/composables/useKML.ts","webpack://@cosmicds/tempo-lite/./src/composables/addAQI.ts","webpack://@cosmicds/tempo-lite/./src/components/MapWithControls.vue?1f2a","webpack://@cosmicds/tempo-lite/./src/components/MapWithControls.vue","webpack://@cosmicds/tempo-lite/./src/components/MapWithControls.vue?3721","webpack://@cosmicds/tempo-lite/./src/components/PopupInfoButton.vue?baf3","webpack://@cosmicds/tempo-lite/./src/components/PopupInfoButton.vue","webpack://@cosmicds/tempo-lite/./src/components/PopupInfoButton.vue?a321","webpack://@cosmicds/tempo-lite/./src/composables/useMaplibreLayerOrderControl.ts","webpack://@cosmicds/tempo-lite/./src/utils/names.ts","webpack://@cosmicds/tempo-lite/./src/components/LayerOrderControl.vue?488e","webpack://@cosmicds/tempo-lite/./src/components/LayerOrderControl.vue","webpack://@cosmicds/tempo-lite/./src/components/LayerOrderControl.vue?a836","webpack://@cosmicds/tempo-lite/./src/composables/useMaplibreLayerOpacity.ts","webpack://@cosmicds/tempo-lite/./src/composables/useMaplibreLayerVisibility.ts","webpack://@cosmicds/tempo-lite/./src/components/MaplibreLayerControlItem.vue?fae7","webpack://@cosmicds/tempo-lite/./src/components/MaplibreLayerControlItem.vue","webpack://@cosmicds/tempo-lite/./src/components/MaplibreLayerControlItem.vue?697e","webpack://@cosmicds/tempo-lite/./src/components/PowerPlantsFilterControl.vue?d562","webpack://@cosmicds/tempo-lite/./src/components/PowerPlantsFilterControl.vue","webpack://@cosmicds/tempo-lite/./src/components/PowerPlantsFilterControl.vue?f078","webpack://@cosmicds/tempo-lite/./src/main.ts","webpack://@cosmicds/tempo-lite/./src/assets/power_plants.ts","webpack://@cosmicds/tempo-lite/webpack/bootstrap","webpack://@cosmicds/tempo-lite/webpack/runtime/chunk loaded","webpack://@cosmicds/tempo-lite/webpack/runtime/compat get default export","webpack://@cosmicds/tempo-lite/webpack/runtime/define property getters","webpack://@cosmicds/tempo-lite/webpack/runtime/global","webpack://@cosmicds/tempo-lite/webpack/runtime/hasOwnProperty shorthand","webpack://@cosmicds/tempo-lite/webpack/runtime/make namespace object","webpack://@cosmicds/tempo-lite/webpack/runtime/publicPath","webpack://@cosmicds/tempo-lite/webpack/runtime/jsonp chunk loading","webpack://@cosmicds/tempo-lite/webpack/startup"],"sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, renderSlot as _renderSlot, vShow as _vShow, withDirectives as _withDirectives, withKeys as _withKeys, normalizeClass as _normalizeClass, withCtx as _withCtx, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_font_awesome_icon = _resolveComponent(\"font-awesome-icon\")!\n  const _component_v_combobox = _resolveComponent(\"v-combobox\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"forward-geocoding-container\",\n    style: _normalizeStyle(_ctx.cssStyles)\n  }, [\n    _withDirectives(_createVNode(_component_v_combobox, {\n      class: _normalizeClass(['forward-geocoding-input', _ctx.locationJustUpdated ? 'geocode-success' : '', _ctx.small ? 'forward-geocoding-input-small' : '']),\n      modelValue: _ctx.searchText,\n      \"onUpdate:modelValue\": [\n        _cache[0] || (_cache[0] = ($event: any) => ((_ctx.searchText) = $event)),\n        _ctx.setLocationFromSearchFeature\n      ],\n      items: _ctx.searchResults ? _ctx.searchResults.features : [],\n      \"item-title\": _ctx.textForMapboxFeature,\n      \"bg-color\": _ctx.bgColor,\n      label: \"Enter city or zip\",\n      density: _ctx.small ? 'compact' : 'default',\n      \"hide-details\": \"\",\n      solo: \"\",\n      color: _ctx.accentColor,\n      onInput: () => {},\n      onKeydown: [\n        _withKeys(_ctx.performForwardGeocodingSearch, [\"enter\"]),\n        _cache[1] || (_cache[1] = _withKeys(($event: any) => (_ctx.searchResults = null), [\"esc\"]))\n      ],\n      \"error-messages\": _ctx.searchErrorMessage,\n      \"onClick:append\": _ctx.focusCombobox,\n      \"onUpdate:focused\": _cache[2] || (_cache[2] = ($event: any) => (_ctx.onFocusChange($event))),\n      ref: \"searchInput\",\n      menu: _ctx.menuOpen,\n      \"onUpdate:menu\": _cache[3] || (_cache[3] = ($event: any) => (_ctx.menuOpen = $event))\n    }, {\n      append: _withCtx(() => [\n        _createVNode(_component_font_awesome_icon, {\n          class: \"geocoding-search-icon\",\n          icon: \"magnifying-glass\",\n          size: _ctx.searchOpen ? 'xl' : _ctx.buttonSize,\n          color: \"gray\",\n          onClick: _ctx.toggleSearch\n        }, null, 8, [\"size\", \"onClick\"]),\n        _renderSlot(_ctx.$slots, \"append-icon\", { class: \"geocode-icon\" }),\n        _withDirectives(_createVNode(_component_font_awesome_icon, {\n          class: \"geocoding-close-icon\",\n          icon: \"circle-xmark\",\n          size: _ctx.searchOpen ? 'xl' : '1x',\n          color: \"gray\",\n          onClick: _ctx.closeSearch\n        }, null, 8, [\"size\", \"onClick\"]), [\n          [_vShow, _ctx.searchOpen && !_ctx.stayOpen]\n        ])\n      ]),\n      _: 3\n    }, 8, [\"class\", \"modelValue\", \"items\", \"item-title\", \"bg-color\", \"density\", \"color\", \"onUpdate:modelValue\", \"onKeydown\", \"error-messages\", \"onClick:append\", \"menu\"]), [\n      [_vShow, _ctx.searchOpen]\n    ]),\n    _withDirectives(_createVNode(_component_font_awesome_icon, {\n      class: \"geocoding-search-icon\",\n      icon: \"magnifying-glass\",\n      size: _ctx.searchOpen ? 'xl' : _ctx.buttonSize,\n      color: \"gray\",\n      onClick: _withModifiers(_ctx.toggleSearch, [\"prevent\"])\n    }, null, 8, [\"size\", \"onClick\"]), [\n      [_vShow, !_ctx.searchOpen && !_ctx.stayOpen]\n    ])\n  ], 4))\n}","<template>\n  <div class=\"forward-geocoding-container\" :style=\"cssStyles\">\n    <v-combobox\n      v-show=\"searchOpen\"\n      :class=\"['forward-geocoding-input', locationJustUpdated ? 'geocode-success' : '', small ? 'forward-geocoding-input-small' : '']\"\n      v-model=\"searchText\"\n      :items=\"searchResults ? searchResults.features : []\"\n      :item-title=\"textForMapboxFeature\"\n      :bg-color=\"bgColor\"\n      label=\"Enter city or zip\"\n      :density=\"small ? 'compact' : 'default'\"\n      hide-details\n      solo\n      :color=\"accentColor\"\n      @input=\"() => {}\"\n      @update:model-value=\"setLocationFromSearchFeature\"\n      @keydown.enter=\"performForwardGeocodingSearch\"\n      @keydown.esc=\"searchResults = null\"\n      :error-messages=\"searchErrorMessage\"\n      @click:append=\"focusCombobox\"\n      @update:focused=\"onFocusChange($event)\"\n      ref=\"searchInput\"\n      :menu=\"menuOpen\"\n      @update:menu=\"menuOpen = $event\"\n    >\n    <template v-slot:append>\n      <font-awesome-icon\n        class=\"geocoding-search-icon\"\n        icon=\"magnifying-glass\"\n        :size=\"searchOpen ? 'xl' : buttonSize\"\n        color=\"gray\"\n        @click=\"toggleSearch\"\n      ></font-awesome-icon>\n\n      <slot name=\"append-icon\" class=\"geocode-icon\"></slot>\n\n      <font-awesome-icon\n        class=\"geocoding-close-icon\"\n        v-show=\"searchOpen && !stayOpen\"\n        icon=\"circle-xmark\"\n        :size=\"searchOpen ? 'xl' : '1x'\"\n        color=\"gray\"\n        @click=\"closeSearch\"\n      ></font-awesome-icon>\n    </template>\n  </v-combobox>\n  <font-awesome-icon\n      v-show=\"!searchOpen && !stayOpen\"\n      class=\"geocoding-search-icon\"\n      icon=\"magnifying-glass\"\n      :size=\"searchOpen ? 'xl' : buttonSize\"\n      color=\"gray\"\n      @click.prevent=\"toggleSearch\"\n    ></font-awesome-icon>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { MapBoxFeatureCollection, MapBoxFeature, textForMapboxFeature } from \"@/mapbox\";\n\ntype SearchProvider = (searchText: string) => Promise<MapBoxFeatureCollection | null>;\n\nexport default defineComponent({\n  name: 'LocationSearch',\n\n  emits: ['update:modelValue', 'set-location', 'error', 'geolocate'],\n\n  props: {\n    searchProvider: {\n      type: Function as PropType<SearchProvider>,\n      default: () => {}\n    },\n    modelValue: {\n      type: Boolean,\n      default: true,\n      required: false,\n    },\n    stayOpen: {\n      type: Boolean,\n      default: false,\n    },\n    accentColor: {\n      type: String,\n      default: 'white',\n    },\n    small: {\n      type: Boolean,\n      default: false,\n    },\n    theme: {\n      type: String,\n      default: 'dark',\n    },\n    buttonSize: {\n      type: String,\n      default: '1x',\n    },\n    \n    bgColor: {\n      type: String,\n      default: 'white',\n    },\n    \n    persistSelected: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  \n  data() {\n    return {\n      searchOpen: this.modelValue || this.stayOpen,\n      searchText: null as string | null,\n      searchResults: null as MapBoxFeatureCollection | null,\n      searchErrorMessage: null as string | null,\n      locationJustUpdated: false,\n      locationUpdatedText: 'Location updated',\n      comboFocused: false,\n      menuOpen: false,\n    };\n  },\n\n  computed: {\n    cssStyles() {\n      return {\n        '--accent-color': this.accentColor,\n        '--bg-color': this.bgColor,\n        '--fg-container-padding': this.searchOpen ? (this.small ? '0px 5px 0px 0px' : '5px 10px 12px 10px') : '0px',\n        '--border-radius': this.searchOpen ? '7px' : '20px',\n      };\n    },\n  },\n  \n  \n  \n\n  \n  methods: {\n    performForwardGeocodingSearch() {\n      console.log('performForwardGeocodingSearch', this.searchText);\n      if (this.searchText === null || this.searchText.length < 3) {\n        return;\n      }\n      this.searchProvider(this.searchText).then((info) => {\n        if (info !== null && info.features?.length === 1) {\n          this.setLocationFromSearchFeature(info.features[0]);\n        } else if (info !== null && info.features?.length == 0) {\n          this.searchErrorMessage = \"No matching places were found\";\n          console.log('No matching places were found');\n          this.$emit('error', this.searchErrorMessage);\n        } else {\n          this.searchResults = info;\n        }\n      });\n    },\n    \n    textForMapboxFeature(feature: MapBoxFeature) {\n      if (typeof feature === 'string') {\n        return;\n      }\n      return textForMapboxFeature(feature);\n    },\n    \n       \n    onFocusChange(focused: boolean) {\n      console.log('focus change', focused);\n      this.comboFocused = focused;\n      // if (!focused && this.searchResults === null) {\n      //   this.searchText = null;\n      // }\n    },\n    \n    blurCombobox() {\n      console.log('blurring');\n      const input = this.$refs.searchInput as HTMLInputElement;\n      console.log(input);\n      input.blur();\n    },\n    \n    focusCombobox() {\n      const input = this.$refs.searchInput as HTMLInputElement;\n      input.focus();\n    },\n    \n    setLocationFromSearchFeature(feature: MapBoxFeature | string) {\n      // if it's a string do nothing\n      if (typeof feature === 'string') {\n        return;\n      }\n      console.log('setting location');\n      if (feature === null) { return; }\n      const name = this.textForMapboxFeature(feature);\n      if (name !== undefined) {\n        this.locationUpdatedText = name;\n      } else {\n        this.locationUpdatedText = feature.place_name.split(',').slice(0, 2).join(', ');\n      }\n      \n      // blur (defocus) the v-combobox\n      this.blurCombobox();\n      this.timedJustUpdatedLocation();\n      this.clearSearchData();\n      this.$emit('set-location', [feature, this.locationUpdatedText]);\n    },\n\n    toggleSearch() {\n      console.log('toggleSearch', this.searchOpen, this.searchText);\n      if (this.searchOpen) {\n        this.performForwardGeocodingSearch();\n        // this.$nextTick(() => this.focusCombobox());\n        this.menuOpen = true;\n        this.focusCombobox();\n      } else {\n        this.searchOpen = true;\n      }\n    },\n\n    closeSearch() {\n      this.searchOpen = false;\n      this.clearSearchData();\n    },\n\n    clearSearchData() {\n      this.searchResults = null;\n      this.searchText = null;\n      this.searchErrorMessage = null;\n    },\n    \n    timedJustUpdatedLocation() {\n      this.locationJustUpdated = true;\n      setTimeout(() => {\n        this.locationJustUpdated = this.persistSelected;\n      }, 5000);\n    },\n  },\n  \n  watch: {\n    \n    modelValue(value: boolean) {\n      this.searchOpen = value;\n    },\n    \n    searchOpen(value: boolean) {\n      this.$emit('update:modelValue', value);\n    },\n    \n    searchText(text: string | null) {\n      if (this.searchErrorMessage) {\n        this.searchErrorMessage = null;\n      }\n      if (!text || text.length === 0) {\n        this.searchResults = null;\n      }\n    },\n  }\n  \n});\n\n</script>\n\n\n<style lang=\"less\">\n\n// https://vue-loader.vuejs.org/guide/scoped-css.html#deep-selectors\n.forward-geocoding-container {\n  --border-radius: 20px;\n  position: relative;\n  color: var(--accent-color);\n  background-color: rgba(255, 255, 255, 0.4);\n  border-radius: var(--border-radius);\n  margin-left: 0.25rem;\n  margin-bottom: 0.25rem;\n  padding: var(--fg-container-padding);\n  backdrop-filter: blur(2px);\n\n  .v-field {\n    background-color: transparent !important;\n  }\n\n  // there are two separate labels, we want the 2nd one to be large. the first is the small floating label\n  .v-field > .v-field__field > .v-label.v-field-label:nth-child(2) {\n    font-size: 1.2rem;\n  }\n\n  // .v-input--horizontal .v-input__append {\n  //   margin-inline-start: 0;\n  // }\n  \n  .v-text-field {\n    min-width: 150px;\n  }\n  \n  .v-field--variant-filled.v-field--has-background .v-field__overlay {\n    border-top-right-radius: 0px;\n}\n\n  .forward-geocoding-input > .v-input__control > .v-field {\n    border-radius: var(--border-radius);\n  }\n  \n  .forward-geocoding-input.geocode-success label {\n    opacity: 1;\n  }\n  \n  .forward-geocoding-input-small label {\n    // .v-label sets default to 1rem\n    font-size: 0.8rem;\n  }\n\n  .forward-geocoding-input-row {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-around;\n    gap: 10px;\n    align-items: center;\n  }\n  \n  .geocoding-search-icon {\n    padding-inline: calc(0.3 * var(--default-line-height));\n    padding-block: calc(0.4 * var(--default-line-height));\n  }\n\n  .geocoding-search-icon:hover, #geocoding-close-icon:hover {\n    cursor: pointer;\n  }\n\n}\n</style>\n","export interface MapBoxContextItem {\n  id: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  mapbox_id: string;\n  text: string;\n  wikidata: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  short_code?: string;\n}\n\n// The field names here come from MapBox\nexport interface MapBoxFeature {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  place_type: string[];\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  place_name: string;\n  text?: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  properties: { short_code: string; };\n  center: [number, number];\n  context: MapBoxContextItem[];\n}\n\nexport interface MapBoxFeatureCollection {\n  type: \"FeatureCollection\";\n  features: MapBoxFeature[];\n}\n\n// TODO: Add more options as we need them\n// See https://docs.mapbox.com/api/search/geocoding-v6/#forward-geocoding-with-search-text-input\nexport interface MapBoxForwardGeocodingOptions {\n  // For countries, use the ISO 3166-1 alpha-2 country codes:\n  // https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2\n  countries?: string[];\n  types?: string[];\n  limit?: number;\n}\n\nconst RELEVANT_FEATURE_TYPES = [\"postcode\", \"place\", \"region\", \"country\"];\nconst NA_COUNTRIES = [\"United States\", \"Canada\", \"Mexico\"];\nconst NA_ABBREVIATIONS = [\"US-\", \"CA-\", \"MX-\"];\n\nexport function findBestFeature(collection: MapBoxFeatureCollection): MapBoxFeature | null {\n  const relevantFeatures = collection.features.filter(feature => RELEVANT_FEATURE_TYPES.some(type => feature.place_type.includes(type)));\n  const placeFeature = relevantFeatures.find(feature => feature.place_type.includes(\"place\")) ?? (relevantFeatures.find(feature => feature.place_type.includes(\"postcode\")) ?? undefined);\n  if (placeFeature !== undefined) {\n    return placeFeature;\n  }\n  const regionFeature = relevantFeatures.find(feature => feature.place_type.includes(\"region\"));\n  if (regionFeature !== undefined) {\n    return regionFeature;\n  }\n  const countryFeature = relevantFeatures.find(feature => feature.place_type.includes(\"country\"));\n  if (countryFeature !== undefined) {\n    return countryFeature;\n  }\n  return null;\n}\n\nexport function textForMapboxFeature(feature: MapBoxFeature): string {\n  const pieces: string[] = [];\n  if (feature.text) {\n    pieces.push(feature.text);\n  }\n  feature.context.forEach(item => {\n    const itemType = item.id.split(\".\")[0];\n    if (!RELEVANT_FEATURE_TYPES.includes(itemType)) {\n      return;\n    }\n    let text = null as string | null;\n    const shortCode = item.short_code;\n    if (itemType === \"region\" && shortCode != null) {\n      if (NA_ABBREVIATIONS.some(abbr => shortCode.startsWith(abbr))) {\n        text = shortCode.substring(3);\n      }\n    } else if (itemType === \"country\") {\n      const itemText = item.text;\n      if (!NA_COUNTRIES.includes(itemText)) {\n        text = itemText; \n      }\n    }\n    if (text !== null) {\n      pieces.push(text);\n    }\n  });\n  return pieces.join(\", \");\n}\n\nexport function textForMapboxResults(results: MapBoxFeatureCollection): string {\n  const feature = findBestFeature(results);\n  return feature !== null ? textForMapboxFeature(feature) : \"\";\n}\n\nexport async function textForLocation(longitudeDeg: number, latitudeDeg: number): Promise<string> {\n  const accessToken = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${longitudeDeg},${latitudeDeg}.json?access_token=${accessToken}`;\n  return fetch(url)\n    .then(response => response.json())\n    .then((result: MapBoxFeatureCollection) => {\n      if (result.features.length === 0) {\n        const ns = latitudeDeg >= 0 ? 'N' : 'S';\n        const ew = longitudeDeg >= 0 ? 'E' : 'W';\n        const lat = Math.abs(latitudeDeg).toFixed(3);\n        const lon = Math.abs(longitudeDeg).toFixed(3);\n        return `${lat} ${ns}, ${lon} ${ew}`;\n      }\n      return textForMapboxResults(result);\n    });\n}\n\nexport async function geocodingInfoForSearch(searchText: string, options?: MapBoxForwardGeocodingOptions): Promise<MapBoxFeatureCollection> {\n  const accessToken = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  const search = new URLSearchParams();\n  search.set(\"access_token\", accessToken ?? \"\");\n  const types = (options?.types ?? [\"place\", \"postcode\"]).join(\",\");\n  search.set(\"types\", types);\n  if (options?.countries) {\n    search.set(\"country\", options.countries.join(\",\"));\n  }\n  search.set(\"limit\", options?.limit?.toString() ?? \"5\");\n  const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${searchText}.json?${search.toString()}`;\n  return fetch(url).then(response => response.json());\n}\n","import { render } from \"./LocationSearch.vue?vue&type=template&id=19e84937&ts=true\"\nimport script from \"./LocationSearch.vue?vue&type=script&lang=ts\"\nexport * from \"./LocationSearch.vue?vue&type=script&lang=ts\"\n\nimport \"./LocationSearch.vue?vue&type=style&index=0&id=19e84937&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { isRef, type ComputedRef } from \"vue\";\n\nexport function isComputedRef(ref: unknown): ref is ComputedRef {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-expect-error A general `Ref` won't have `effect`\n  return isRef(ref) && !!ref.effect;\n}\n","\nimport type { ColorMap } from \"./types\";\n\nexport const magma: ColorMap = {\n  r: [0.001462, 0.002258, 0.003279, 0.004512, 0.00595, 0.007588, 0.009426, 0.011465, 0.013708, 0.016156, 0.018815, 0.021692, 0.024792, 0.028123, 0.031696, 0.03552, 0.039608, 0.04383, 0.048062, 0.05232, 0.056615, 0.060949, 0.06533, 0.069764, 0.074257, 0.078815, 0.083446, 0.088155, 0.092949, 0.097833, 0.102815, 0.107899, 0.113094, 0.118405, 0.123833, 0.12938, 0.135053, 0.140858, 0.146785, 0.152839, 0.159018, 0.165308, 0.171713, 0.178212, 0.184801, 0.19146, 0.198177, 0.204935, 0.211718, 0.218512, 0.225302, 0.232077, 0.238826, 0.245543, 0.25222, 0.258857, 0.265447, 0.271994, 0.278493, 0.284951, 0.291366, 0.29774, 0.304081, 0.310382, 0.316654, 0.322899, 0.329114, 0.335308, 0.341482, 0.347636, 0.353773, 0.359898, 0.366012, 0.372116, 0.378211, 0.384299, 0.390384, 0.396467, 0.402548, 0.408629, 0.414709, 0.420791, 0.426877, 0.432967, 0.439062, 0.445163, 0.451271, 0.457386, 0.463508, 0.46964, 0.47578, 0.481929, 0.488088, 0.494258, 0.500438, 0.506629, 0.512831, 0.519045, 0.52527, 0.531507, 0.537755, 0.544015, 0.550287, 0.556571, 0.562866, 0.569172, 0.57549, 0.581819, 0.588158, 0.594508, 0.600868, 0.607238, 0.613617, 0.620005, 0.626401, 0.632805, 0.639216, 0.645633, 0.652056, 0.658483, 0.664915, 0.671349, 0.677786, 0.684224, 0.690661, 0.697098, 0.703532, 0.709962, 0.716387, 0.722805, 0.729216, 0.735616, 0.742004, 0.748378, 0.754737, 0.761077, 0.767398, 0.773695, 0.779968, 0.786212, 0.792427, 0.798608, 0.804752, 0.810855, 0.816914, 0.822926, 0.828886, 0.834791, 0.840636, 0.846416, 0.852126, 0.857763, 0.86332, 0.868793, 0.874176, 0.879464, 0.884651, 0.889731, 0.8947, 0.899552, 0.904281, 0.908884, 0.913354, 0.917689, 0.921884, 0.925937, 0.929845, 0.933606, 0.937221, 0.940687, 0.944006, 0.94718, 0.95021, 0.953099, 0.955849, 0.958464, 0.960949, 0.96331, 0.965549, 0.967671, 0.96968, 0.971582, 0.973381, 0.975082, 0.97669, 0.97821, 0.979645, 0.981, 0.982279, 0.983485, 0.984622, 0.985693, 0.9867, 0.987646, 0.988533, 0.989363, 0.990138, 0.990871, 0.991558, 0.992196, 0.992785, 0.993326, 0.993834, 0.994309, 0.994738, 0.995122, 0.99548, 0.99581, 0.996096, 0.996341, 0.99658, 0.996775, 0.996925, 0.997077, 0.997186, 0.997254, 0.997325, 0.997351, 0.997351, 0.997341, 0.997285, 0.997228, 0.997138, 0.997019, 0.996898, 0.996727, 0.996571, 0.996369, 0.996162, 0.995932, 0.99568, 0.995424, 0.995131, 0.994851, 0.994524, 0.994222, 0.993866, 0.993545, 0.99317, 0.992831, 0.99244, 0.992089, 0.991688, 0.991332, 0.99093, 0.99057, 0.990175, 0.989815, 0.989434, 0.989077, 0.988717, 0.988367, 0.988033, 0.987691, 0.987387, 0.987053],\n  g: [0.000466, 0.001295, 0.002305, 0.00349, 0.004843, 0.006356, 0.008022, 0.009828, 0.011771, 0.01384, 0.016026, 0.01832, 0.020715, 0.023201, 0.025765, 0.028397, 0.03109, 0.03383, 0.036607, 0.039407, 0.04216, 0.044794, 0.047318, 0.049726, 0.052017, 0.054184, 0.056225, 0.058133, 0.059904, 0.061531, 0.06301, 0.064335, 0.065492, 0.066479, 0.067295, 0.067935, 0.068391, 0.068654, 0.068738, 0.068637, 0.068354, 0.067911, 0.067305, 0.066576, 0.065732, 0.064818, 0.063862, 0.062907, 0.061992, 0.061158, 0.060445, 0.059889, 0.059517, 0.059352, 0.059415, 0.059706, 0.060237, 0.060994, 0.061978, 0.063168, 0.064553, 0.066117, 0.067835, 0.069702, 0.07169, 0.073782, 0.075972, 0.078236, 0.080564, 0.082946, 0.085373, 0.087831, 0.090314, 0.092816, 0.095332, 0.097855, 0.100379, 0.102902, 0.10542, 0.10793, 0.110431, 0.11292, 0.115395, 0.117855, 0.120298, 0.122724, 0.125132, 0.127522, 0.129893, 0.132245, 0.134577, 0.136891, 0.139186, 0.141462, 0.143719, 0.145958, 0.148179, 0.150383, 0.152569, 0.154739, 0.156894, 0.159033, 0.161158, 0.163269, 0.165368, 0.167454, 0.16953, 0.171596, 0.173652, 0.175701, 0.177743, 0.179779, 0.181811, 0.18384, 0.185867, 0.187893, 0.189921, 0.191952, 0.193986, 0.196027, 0.198075, 0.200133, 0.202203, 0.204286, 0.206384, 0.208501, 0.210638, 0.212797, 0.214982, 0.217194, 0.219437, 0.221713, 0.224025, 0.226377, 0.228772, 0.231214, 0.233705, 0.236249, 0.238851, 0.241514, 0.244242, 0.24704, 0.249911, 0.252861, 0.255895, 0.259016, 0.262229, 0.26554, 0.268953, 0.272473, 0.276106, 0.279857, 0.283729, 0.287728, 0.291859, 0.296125, 0.30053, 0.305079, 0.309773, 0.314616, 0.31961, 0.324755, 0.330052, 0.3355, 0.341098, 0.346844, 0.352734, 0.358764, 0.364929, 0.371224, 0.377643, 0.384178, 0.39082, 0.397563, 0.4044, 0.411324, 0.418323, 0.42539, 0.432519, 0.439703, 0.446936, 0.45421, 0.46152, 0.468861, 0.476226, 0.483612, 0.491014, 0.498428, 0.505851, 0.51328, 0.520713, 0.528148, 0.535582, 0.543015, 0.550446, 0.557873, 0.565296, 0.572706, 0.580107, 0.587502, 0.594891, 0.602275, 0.609644, 0.616999, 0.62435, 0.631696, 0.639027, 0.646344, 0.653659, 0.660969, 0.668256, 0.675541, 0.682828, 0.690088, 0.697349, 0.704611, 0.711848, 0.719089, 0.726324, 0.733545, 0.740772, 0.747981, 0.75519, 0.762398, 0.769591, 0.776795, 0.783977, 0.791167, 0.798348, 0.805527, 0.812706, 0.819875, 0.827052, 0.834213, 0.841387, 0.84854, 0.855711, 0.862859, 0.870024, 0.877168, 0.88433, 0.89147, 0.898627, 0.905763, 0.912915, 0.920049, 0.927196, 0.934329, 0.94147, 0.948604, 0.955742, 0.962878, 0.970012, 0.977154, 0.984288, 0.991438],\n  b: [0.013866, 0.018331, 0.023708, 0.029965, 0.03713, 0.044973, 0.052844, 0.06075, 0.068667, 0.076603, 0.084584, 0.09261, 0.100676, 0.108787, 0.116965, 0.125209, 0.133515, 0.141886, 0.150327, 0.158841, 0.167446, 0.176129, 0.184892, 0.193735, 0.20266, 0.211667, 0.220755, 0.229922, 0.239164, 0.248477, 0.257854, 0.267289, 0.276784, 0.286321, 0.295879, 0.305443, 0.315, 0.324538, 0.334011, 0.343404, 0.352688, 0.361816, 0.370771, 0.379497, 0.387973, 0.396152, 0.404009, 0.411514, 0.418647, 0.425392, 0.431742, 0.437695, 0.443256, 0.448436, 0.453248, 0.45771, 0.46184, 0.46566, 0.46919, 0.472451, 0.475462, 0.478243, 0.480812, 0.483186, 0.48538, 0.487408, 0.489287, 0.491024, 0.492631, 0.494121, 0.495501, 0.496778, 0.49796, 0.499053, 0.500067, 0.501002, 0.501864, 0.502658, 0.503386, 0.504052, 0.504662, 0.505215, 0.505714, 0.50616, 0.506555, 0.506901, 0.507198, 0.507448, 0.507652, 0.507809, 0.507921, 0.507989, 0.508011, 0.507988, 0.50792, 0.507806, 0.507648, 0.507443, 0.507192, 0.506895, 0.506551, 0.506159, 0.505719, 0.50523, 0.504692, 0.504105, 0.503466, 0.502777, 0.502035, 0.501241, 0.500394, 0.499492, 0.498536, 0.497524, 0.496456, 0.495332, 0.49415, 0.49291, 0.491611, 0.490253, 0.488836, 0.487358, 0.485819, 0.484219, 0.482558, 0.480835, 0.479049, 0.477201, 0.47529, 0.473316, 0.471279, 0.46918, 0.467018, 0.464794, 0.462509, 0.460162, 0.457755, 0.455289, 0.452765, 0.450184, 0.447543, 0.444848, 0.442102, 0.439305, 0.436461, 0.433573, 0.430644, 0.427671, 0.424666, 0.421631, 0.418573, 0.415496, 0.412403, 0.409303, 0.406205, 0.403118, 0.400047, 0.397002, 0.393995, 0.391037, 0.388137, 0.385308, 0.382563, 0.379915, 0.377376, 0.374959, 0.372677, 0.370541, 0.368567, 0.366762, 0.365136, 0.363701, 0.362468, 0.361438, 0.360619, 0.360014, 0.35963, 0.359469, 0.359529, 0.35981, 0.360311, 0.36103, 0.361965, 0.363111, 0.364466, 0.366025, 0.367783, 0.369734, 0.371874, 0.374198, 0.376698, 0.379371, 0.38221, 0.38521, 0.388365, 0.391671, 0.395122, 0.398714, 0.402441, 0.406299, 0.410283, 0.41439, 0.418613, 0.42295, 0.427397, 0.431951, 0.436607, 0.441361, 0.446213, 0.45116, 0.456192, 0.461314, 0.466526, 0.471811, 0.477182, 0.482635, 0.488154, 0.493755, 0.499428, 0.505167, 0.510983, 0.516859, 0.522806, 0.528821, 0.534892, 0.541039, 0.547233, 0.553499, 0.55982, 0.566202, 0.572645, 0.57914, 0.585701, 0.592307, 0.598983, 0.605696, 0.612482, 0.619299, 0.626189, 0.633109, 0.640099, 0.647116, 0.654202, 0.661309, 0.668481, 0.675675, 0.682926, 0.690198, 0.697519, 0.704863, 0.712242, 0.719649, 0.727077, 0.734536, 0.742002, 0.749504]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const inferno: ColorMap = {\n  r: [0.001462, 0.002267, 0.003299, 0.004547, 0.006006, 0.007676, 0.009561, 0.011663, 0.013995, 0.016561, 0.019373, 0.022447, 0.025793, 0.029432, 0.033385, 0.037668, 0.042253, 0.046915, 0.051644, 0.056449, 0.06134, 0.066331, 0.071429, 0.076637, 0.081962, 0.087411, 0.09299, 0.098702, 0.104551, 0.110536, 0.116656, 0.122908, 0.129285, 0.135778, 0.142378, 0.149073, 0.15585, 0.162689, 0.169575, 0.176493, 0.183429, 0.190367, 0.197297, 0.204209, 0.211095, 0.217949, 0.224763, 0.231538, 0.238273, 0.244967, 0.25162, 0.258234, 0.26481, 0.271347, 0.27785, 0.284321, 0.290763, 0.297178, 0.303568, 0.309935, 0.316282, 0.32261, 0.328921, 0.335217, 0.3415, 0.347771, 0.354032, 0.360284, 0.366529, 0.372768, 0.379001, 0.385228, 0.391453, 0.397674, 0.403894, 0.410113, 0.416331, 0.422549, 0.428768, 0.434987, 0.441207, 0.447428, 0.453651, 0.459875, 0.4661, 0.472328, 0.478558, 0.484789, 0.491022, 0.497257, 0.503493, 0.50973, 0.515967, 0.522206, 0.528444, 0.534683, 0.54092, 0.547157, 0.553392, 0.559624, 0.565854, 0.572081, 0.578304, 0.584521, 0.590734, 0.59694, 0.603139, 0.60933, 0.615513, 0.621685, 0.627847, 0.633998, 0.640135, 0.64626, 0.652369, 0.658463, 0.66454, 0.670599, 0.676638, 0.682656, 0.688653, 0.694627, 0.700576, 0.7065, 0.712396, 0.718264, 0.724103, 0.729909, 0.735683, 0.741423, 0.747127, 0.752794, 0.758422, 0.76401, 0.769556, 0.775059, 0.780517, 0.785929, 0.791293, 0.796607, 0.801871, 0.807082, 0.812239, 0.817341, 0.822386, 0.827372, 0.832299, 0.837165, 0.841969, 0.846709, 0.851384, 0.855992, 0.860533, 0.865006, 0.869409, 0.873741, 0.878001, 0.882188, 0.886302, 0.890341, 0.894305, 0.898192, 0.902003, 0.905735, 0.90939, 0.912966, 0.916462, 0.919879, 0.923215, 0.92647, 0.929644, 0.932737, 0.935747, 0.938675, 0.941521, 0.944285, 0.946965, 0.949562, 0.952075, 0.954506, 0.956852, 0.959114, 0.961293, 0.963387, 0.965397, 0.967322, 0.969163, 0.970919, 0.97259, 0.974176, 0.975677, 0.977092, 0.978422, 0.979666, 0.980824, 0.981895, 0.982881, 0.983779, 0.984591, 0.985315, 0.985952, 0.986502, 0.986964, 0.987337, 0.987622, 0.987819, 0.987926, 0.987945, 0.987874, 0.987714, 0.987464, 0.987124, 0.986694, 0.986175, 0.985566, 0.984865, 0.984075, 0.983196, 0.982228, 0.981173, 0.980032, 0.978806, 0.977497, 0.976108, 0.974638, 0.973088, 0.971468, 0.969783, 0.968041, 0.966243, 0.964394, 0.962517, 0.960626, 0.95872, 0.956834, 0.954997, 0.953215, 0.951546, 0.950018, 0.948683, 0.947594, 0.946809, 0.946392, 0.946403, 0.946903, 0.947937, 0.949545, 0.95174, 0.954529, 0.957896, 0.961812, 0.966249, 0.971162, 0.976511, 0.982257, 0.988362],\n  g: [0.000466, 0.00127, 0.002249, 0.003392, 0.004692, 0.006136, 0.007713, 0.009417, 0.011225, 0.013136, 0.015133, 0.017199, 0.019331, 0.021503, 0.023702, 0.025921, 0.028139, 0.030324, 0.032474, 0.034569, 0.03659, 0.038504, 0.040294, 0.041905, 0.043328, 0.044556, 0.045583, 0.046402, 0.047008, 0.047399, 0.047574, 0.047536, 0.047293, 0.046856, 0.046242, 0.045468, 0.044559, 0.043554, 0.042489, 0.041402, 0.040329, 0.039309, 0.0384, 0.037632, 0.03703, 0.036615, 0.036405, 0.036405, 0.036621, 0.037055, 0.037705, 0.038571, 0.039647, 0.040922, 0.042353, 0.043933, 0.045644, 0.04747, 0.049396, 0.051407, 0.05349, 0.055634, 0.057827, 0.06006, 0.062325, 0.064616, 0.066925, 0.069247, 0.071579, 0.073915, 0.076253, 0.078591, 0.080927, 0.083257, 0.08558, 0.087896, 0.090203, 0.092501, 0.09479, 0.097069, 0.099338, 0.101597, 0.103848, 0.106089, 0.108322, 0.110547, 0.112764, 0.114974, 0.117179, 0.119379, 0.121575, 0.123769, 0.12596, 0.12815, 0.130341, 0.132534, 0.134729, 0.136929, 0.139134, 0.141346, 0.143567, 0.145797, 0.148039, 0.150294, 0.152563, 0.154848, 0.157151, 0.159474, 0.161817, 0.164184, 0.166575, 0.168992, 0.171438, 0.173914, 0.176421, 0.178962, 0.181539, 0.184153, 0.186807, 0.189501, 0.192239, 0.195021, 0.197851, 0.200728, 0.203656, 0.206636, 0.20967, 0.212759, 0.215906, 0.219112, 0.222378, 0.225706, 0.229097, 0.232554, 0.236077, 0.239667, 0.243327, 0.247056, 0.250856, 0.254728, 0.258674, 0.262692, 0.266786, 0.270954, 0.275197, 0.279517, 0.283913, 0.288385, 0.292933, 0.297559, 0.30226, 0.307038, 0.311892, 0.316822, 0.321827, 0.326906, 0.33206, 0.337287, 0.342586, 0.347957, 0.353399, 0.358911, 0.364492, 0.37014, 0.375856, 0.381636, 0.387481, 0.393389, 0.399359, 0.405389, 0.411479, 0.417627, 0.423831, 0.430091, 0.436405, 0.442772, 0.449191, 0.45566, 0.462178, 0.468744, 0.475356, 0.482014, 0.488716, 0.495462, 0.502249, 0.509078, 0.515946, 0.522853, 0.529798, 0.53678, 0.543798, 0.55085, 0.557937, 0.565057, 0.572209, 0.579392, 0.586606, 0.593849, 0.601122, 0.608422, 0.61575, 0.623105, 0.630485, 0.63789, 0.64532, 0.652773, 0.66025, 0.667748, 0.675267, 0.682807, 0.690366, 0.697944, 0.70554, 0.713153, 0.720782, 0.728427, 0.736087, 0.743758, 0.751442, 0.759135, 0.766837, 0.774545, 0.782258, 0.789974, 0.797692, 0.805409, 0.813122, 0.820825, 0.828515, 0.836191, 0.843848, 0.851476, 0.859069, 0.866624, 0.874129, 0.881569, 0.888942, 0.896226, 0.903409, 0.910473, 0.917399, 0.924168, 0.930761, 0.937159, 0.943348, 0.949318, 0.955063, 0.960587, 0.965896, 0.971003, 0.975924, 0.980678, 0.985282, 0.989753, 0.994109, 0.998364],\n  b: [0.013866, 0.01857, 0.024239, 0.030909, 0.038558, 0.046836, 0.055143, 0.06346, 0.071862, 0.080282, 0.088767, 0.097327, 0.10593, 0.114621, 0.123397, 0.132232, 0.141141, 0.150164, 0.159254, 0.168414, 0.177642, 0.186962, 0.196354, 0.205799, 0.215289, 0.224813, 0.234358, 0.243904, 0.25343, 0.262912, 0.272321, 0.281624, 0.290788, 0.299776, 0.308553, 0.317085, 0.325338, 0.333277, 0.340874, 0.348111, 0.354971, 0.361447, 0.367535, 0.373238, 0.378563, 0.383522, 0.388129, 0.3924, 0.396353, 0.400007, 0.403378, 0.406485, 0.409345, 0.411976, 0.414392, 0.416608, 0.418637, 0.420491, 0.422182, 0.423721, 0.425116, 0.426377, 0.427511, 0.428524, 0.429425, 0.430217, 0.430906, 0.431497, 0.431994, 0.4324, 0.432719, 0.432955, 0.433109, 0.433183, 0.433179, 0.433098, 0.432943, 0.432714, 0.432412, 0.432039, 0.431594, 0.43108, 0.430498, 0.429846, 0.429125, 0.428334, 0.427475, 0.426548, 0.425552, 0.424488, 0.423356, 0.422156, 0.420887, 0.419549, 0.418142, 0.416667, 0.415123, 0.413511, 0.411829, 0.410078, 0.408258, 0.406369, 0.404411, 0.402385, 0.40029, 0.398125, 0.395891, 0.393589, 0.391219, 0.388781, 0.386276, 0.383704, 0.381065, 0.378359, 0.375586, 0.372748, 0.369846, 0.366879, 0.363849, 0.360757, 0.357603, 0.354388, 0.351113, 0.347777, 0.344383, 0.340931, 0.337424, 0.333861, 0.330245, 0.326576, 0.322856, 0.319085, 0.315266, 0.311399, 0.307485, 0.303526, 0.299523, 0.295477, 0.29139, 0.287264, 0.283099, 0.278898, 0.274661, 0.27039, 0.266085, 0.26175, 0.257383, 0.252988, 0.248564, 0.244113, 0.239636, 0.235133, 0.230606, 0.226055, 0.221482, 0.216886, 0.212268, 0.207628, 0.202968, 0.198286, 0.193584, 0.18886, 0.184116, 0.17935, 0.174563, 0.169755, 0.164924, 0.16007, 0.155193, 0.150292, 0.145367, 0.140417, 0.13544, 0.130438, 0.125409, 0.120354, 0.115272, 0.110164, 0.105031, 0.099874, 0.094695, 0.089499, 0.084289, 0.079073, 0.073859, 0.068659, 0.063488, 0.058367, 0.053324, 0.048392, 0.043618, 0.03905, 0.034931, 0.031409, 0.028508, 0.02625, 0.024661, 0.02377, 0.023606, 0.024202, 0.025592, 0.027814, 0.030908, 0.034916, 0.039886, 0.045581, 0.05175, 0.058329, 0.065257, 0.072489, 0.07999, 0.087731, 0.095694, 0.103863, 0.112229, 0.120785, 0.129527, 0.138453, 0.147565, 0.156863, 0.166353, 0.176037, 0.185923, 0.196018, 0.206332, 0.216877, 0.227658, 0.238686, 0.249972, 0.261534, 0.273391, 0.285546, 0.29801, 0.31082, 0.323974, 0.337475, 0.351369, 0.365627, 0.380271, 0.395289, 0.410665, 0.426373, 0.442367, 0.458592, 0.47497, 0.491426, 0.50786, 0.524203, 0.540361, 0.556275, 0.571925, 0.587206, 0.602154, 0.61676, 0.631017, 0.644924]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const plasma: ColorMap = {\n  r: [0.050383, 0.063536, 0.075353, 0.086222, 0.096379, 0.10598, 0.115124, 0.123903, 0.132381, 0.140603, 0.148607, 0.156421, 0.16407, 0.171574, 0.17895, 0.186213, 0.193374, 0.200445, 0.207435, 0.21435, 0.221197, 0.227983, 0.234715, 0.241396, 0.248032, 0.254627, 0.261183, 0.267703, 0.274191, 0.280648, 0.287076, 0.293478, 0.299855, 0.30621, 0.312543, 0.318856, 0.32515, 0.331426, 0.337683, 0.343925, 0.35015, 0.356359, 0.362553, 0.368733, 0.374897, 0.381047, 0.387183, 0.393304, 0.399411, 0.405503, 0.41158, 0.417642, 0.423689, 0.429719, 0.435734, 0.441732, 0.447714, 0.453677, 0.459623, 0.46555, 0.471457, 0.477344, 0.48321, 0.489055, 0.494877, 0.500678, 0.506454, 0.512206, 0.517933, 0.523633, 0.529306, 0.534952, 0.54057, 0.546157, 0.551715, 0.557243, 0.562738, 0.568201, 0.573632, 0.579029, 0.584391, 0.589719, 0.595011, 0.600266, 0.605485, 0.610667, 0.615812, 0.620919, 0.625987, 0.631017, 0.636008, 0.640959, 0.645872, 0.650746, 0.65558, 0.660374, 0.665129, 0.669845, 0.674522, 0.67916, 0.683758, 0.688318, 0.69284, 0.697324, 0.701769, 0.706178, 0.710549, 0.714883, 0.719181, 0.723444, 0.72767, 0.731862, 0.736019, 0.740143, 0.744232, 0.748289, 0.752312, 0.756304, 0.760264, 0.764193, 0.76809, 0.771958, 0.775796, 0.779604, 0.783383, 0.787133, 0.790855, 0.794549, 0.798216, 0.801855, 0.805467, 0.809052, 0.812612, 0.816144, 0.819651, 0.823132, 0.826588, 0.830018, 0.833422, 0.836801, 0.840155, 0.843484, 0.846788, 0.850066, 0.853319, 0.856547, 0.85975, 0.862927, 0.866078, 0.869203, 0.872303, 0.875376, 0.878423, 0.881443, 0.884436, 0.887402, 0.89034, 0.89325, 0.896131, 0.898984, 0.901807, 0.904601, 0.907365, 0.910098, 0.9128, 0.915471, 0.918109, 0.920714, 0.923287, 0.925825, 0.928329, 0.930798, 0.933232, 0.93563, 0.93799, 0.940313, 0.942598, 0.944844, 0.947051, 0.949217, 0.951344, 0.953428, 0.95547, 0.957469, 0.959424, 0.961336, 0.963203, 0.965024, 0.966798, 0.968526, 0.970205, 0.971835, 0.973416, 0.974947, 0.976428, 0.977856, 0.979233, 0.980556, 0.981826, 0.983041, 0.984199, 0.985301, 0.986345, 0.987332, 0.98826, 0.989128, 0.989935, 0.990681, 0.991365, 0.991985, 0.992541, 0.993032, 0.993456, 0.993814, 0.994103, 0.994324, 0.994474, 0.994553, 0.994561, 0.994495, 0.994355, 0.994141, 0.993851, 0.993482, 0.993033, 0.992505, 0.991897, 0.991209, 0.990439, 0.989587, 0.988648, 0.987621, 0.986509, 0.985314, 0.984031, 0.982653, 0.98119, 0.979644, 0.977995, 0.976265, 0.974443, 0.97253, 0.970533, 0.968443, 0.966271, 0.964021, 0.961681, 0.959276, 0.956808, 0.954287, 0.951726, 0.949151, 0.946602, 0.944152, 0.941896, 0.940015],\n  g: [0.029803, 0.028426, 0.027206, 0.026125, 0.025165, 0.024309, 0.023556, 0.022878, 0.022258, 0.021687, 0.021154, 0.020651, 0.020171, 0.019706, 0.019252, 0.018803, 0.018354, 0.017902, 0.017442, 0.016973, 0.016497, 0.016007, 0.015502, 0.014979, 0.014439, 0.013882, 0.013308, 0.012716, 0.012109, 0.011488, 0.010855, 0.010213, 0.009561, 0.008902, 0.008239, 0.007576, 0.006915, 0.006261, 0.005618, 0.004991, 0.004382, 0.003798, 0.003243, 0.002724, 0.002245, 0.001814, 0.001434, 0.001114, 0.000859, 0.000678, 0.000577, 0.000564, 0.000646, 0.000831, 0.001127, 0.00154, 0.00208, 0.002755, 0.003574, 0.004545, 0.005678, 0.00698, 0.00846, 0.010127, 0.01199, 0.014055, 0.016333, 0.018833, 0.021563, 0.024532, 0.027747, 0.031217, 0.03495, 0.038954, 0.043136, 0.047331, 0.051545, 0.055778, 0.060028, 0.064296, 0.068579, 0.072878, 0.07719, 0.081516, 0.085854, 0.090204, 0.094564, 0.098934, 0.103312, 0.107699, 0.112092, 0.116492, 0.120898, 0.125309, 0.129725, 0.134144, 0.138566, 0.142992, 0.147419, 0.151848, 0.156278, 0.160709, 0.165141, 0.169573, 0.174005, 0.178437, 0.182868, 0.187299, 0.191729, 0.196158, 0.200586, 0.205013, 0.209439, 0.213864, 0.218288, 0.222711, 0.227133, 0.231555, 0.235976, 0.240396, 0.244817, 0.249237, 0.253658, 0.258078, 0.2625, 0.266922, 0.271345, 0.27577, 0.280197, 0.284626, 0.289057, 0.293491, 0.297928, 0.302368, 0.306812, 0.311261, 0.315714, 0.320172, 0.324635, 0.329105, 0.33358, 0.338062, 0.342551, 0.347048, 0.351553, 0.356066, 0.360588, 0.365119, 0.36966, 0.374212, 0.378774, 0.383347, 0.387932, 0.392529, 0.397139, 0.401762, 0.406398, 0.411048, 0.415712, 0.420392, 0.425087, 0.429797, 0.434524, 0.439268, 0.444029, 0.448807, 0.453603, 0.458417, 0.463251, 0.468103, 0.472975, 0.477867, 0.48278, 0.487712, 0.492667, 0.497642, 0.502639, 0.507658, 0.512699, 0.517763, 0.52285, 0.52796, 0.533093, 0.53825, 0.543431, 0.548636, 0.553865, 0.559118, 0.564396, 0.5697, 0.575028, 0.580382, 0.585761, 0.591165, 0.596595, 0.602051, 0.607532, 0.613039, 0.618572, 0.624131, 0.629718, 0.63533, 0.640969, 0.646633, 0.652325, 0.658043, 0.663787, 0.669558, 0.675355, 0.681179, 0.68703, 0.692907, 0.69881, 0.704741, 0.710698, 0.716681, 0.722691, 0.728728, 0.734791, 0.74088, 0.746995, 0.753137, 0.759304, 0.765499, 0.77172, 0.777967, 0.784239, 0.790537, 0.796859, 0.803205, 0.809579, 0.815978, 0.822401, 0.828846, 0.835315, 0.841812, 0.848329, 0.854866, 0.861432, 0.868016, 0.874622, 0.88125, 0.887896, 0.894564, 0.901249, 0.90795, 0.914672, 0.921407, 0.928152, 0.934908, 0.941671, 0.948435, 0.95519, 0.961916, 0.96859, 0.975158],\n  b: [0.527975, 0.533124, 0.538007, 0.542658, 0.547103, 0.551368, 0.555468, 0.559423, 0.56325, 0.566959, 0.570562, 0.574065, 0.577478, 0.580806, 0.584054, 0.587228, 0.59033, 0.593364, 0.596333, 0.599239, 0.602083, 0.604867, 0.607592, 0.610259, 0.612868, 0.615419, 0.617911, 0.620346, 0.622722, 0.625038, 0.627295, 0.62949, 0.631624, 0.633694, 0.6357, 0.63764, 0.639512, 0.641316, 0.643049, 0.64471, 0.646298, 0.64781, 0.649245, 0.650601, 0.651876, 0.653068, 0.654177, 0.655199, 0.656133, 0.656977, 0.65773, 0.65839, 0.658956, 0.659425, 0.659797, 0.660069, 0.66024, 0.66031, 0.660277, 0.660139, 0.659897, 0.659549, 0.659095, 0.658534, 0.657865, 0.657088, 0.656202, 0.655209, 0.654109, 0.652901, 0.651586, 0.650165, 0.64864, 0.64701, 0.645277, 0.643443, 0.641509, 0.639477, 0.637349, 0.635126, 0.632812, 0.630408, 0.627917, 0.625342, 0.622686, 0.619951, 0.61714, 0.614257, 0.611305, 0.608287, 0.605205, 0.602065, 0.598867, 0.595617, 0.592317, 0.588971, 0.585582, 0.582154, 0.578688, 0.575189, 0.57166, 0.568103, 0.564522, 0.560919, 0.557296, 0.553657, 0.550004, 0.546338, 0.542663, 0.538981, 0.535293, 0.531601, 0.527908, 0.524216, 0.520524, 0.516834, 0.513149, 0.509468, 0.505794, 0.502126, 0.498465, 0.494813, 0.491171, 0.487539, 0.483918, 0.480307, 0.476706, 0.473117, 0.469538, 0.465971, 0.462415, 0.45887, 0.455338, 0.451816, 0.448306, 0.444806, 0.441316, 0.437836, 0.434366, 0.430905, 0.427455, 0.424013, 0.420579, 0.417153, 0.413734, 0.410322, 0.406917, 0.403519, 0.400126, 0.396738, 0.393355, 0.389976, 0.3866, 0.383229, 0.37986, 0.376494, 0.37313, 0.369768, 0.366407, 0.363047, 0.359688, 0.356329, 0.35297, 0.34961, 0.346251, 0.34289, 0.339529, 0.336166, 0.332801, 0.329435, 0.326067, 0.322697, 0.319325, 0.315952, 0.312575, 0.309197, 0.305816, 0.302433, 0.299049, 0.295662, 0.292275, 0.288883, 0.28549, 0.282096, 0.278701, 0.275305, 0.271909, 0.268513, 0.265118, 0.261721, 0.258325, 0.254931, 0.25154, 0.248151, 0.244767, 0.241387, 0.238013, 0.234646, 0.231287, 0.227937, 0.224595, 0.221265, 0.217948, 0.214648, 0.211364, 0.2081, 0.204859, 0.201642, 0.198453, 0.195295, 0.19217, 0.189084, 0.186041, 0.183043, 0.180097, 0.177208, 0.174381, 0.171622, 0.168938, 0.166335, 0.163821, 0.161404, 0.159092, 0.156891, 0.154808, 0.152855, 0.151042, 0.149377, 0.14787, 0.146529, 0.145357, 0.144363, 0.143557, 0.142945, 0.142528, 0.142303, 0.142279, 0.142453, 0.142808, 0.143351, 0.144061, 0.144923, 0.145919, 0.147014, 0.14818, 0.14937, 0.15052, 0.151566, 0.152409, 0.152921, 0.152925, 0.152178, 0.150328, 0.146861, 0.140956, 0.131326]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const viridis: ColorMap = {\n  r: [0.267004, 0.26851, 0.269944, 0.271305, 0.272594, 0.273809, 0.274952, 0.276022, 0.277018, 0.277941, 0.278791, 0.279566, 0.280267, 0.280894, 0.281446, 0.281924, 0.282327, 0.282656, 0.28291, 0.283091, 0.283197, 0.283229, 0.283187, 0.283072, 0.282884, 0.282623, 0.28229, 0.281887, 0.281412, 0.280868, 0.280255, 0.279574, 0.278826, 0.278012, 0.277134, 0.276194, 0.275191, 0.274128, 0.273006, 0.271828, 0.270595, 0.269308, 0.267968, 0.26658, 0.265145, 0.263663, 0.262138, 0.260571, 0.258965, 0.257322, 0.255645, 0.253935, 0.252194, 0.250425, 0.248629, 0.246811, 0.244972, 0.243113, 0.241237, 0.239346, 0.237441, 0.235526, 0.233603, 0.231674, 0.229739, 0.227802, 0.225863, 0.223925, 0.221989, 0.220057, 0.21813, 0.21621, 0.214298, 0.212395, 0.210503, 0.208623, 0.206756, 0.204903, 0.203063, 0.201239, 0.19943, 0.197636, 0.19586, 0.1941, 0.192357, 0.190631, 0.188923, 0.187231, 0.185556, 0.183898, 0.182256, 0.180629, 0.179019, 0.177423, 0.175841, 0.174274, 0.172719, 0.171176, 0.169646, 0.168126, 0.166617, 0.165117, 0.163625, 0.162142, 0.160665, 0.159194, 0.157729, 0.15627, 0.154815, 0.153364, 0.151918, 0.150476, 0.149039, 0.147607, 0.14618, 0.144759, 0.143343, 0.141935, 0.140536, 0.139147, 0.13777, 0.136408, 0.135066, 0.133743, 0.132444, 0.131172, 0.129933, 0.128729, 0.127568, 0.126453, 0.125394, 0.124395, 0.123463, 0.122606, 0.121831, 0.121148, 0.120565, 0.120092, 0.119738, 0.119512, 0.119423, 0.119483, 0.119699, 0.120081, 0.120638, 0.12138, 0.122312, 0.123444, 0.12478, 0.126326, 0.128087, 0.130067, 0.132268, 0.134692, 0.137339, 0.14021, 0.143303, 0.146616, 0.150148, 0.153894, 0.157851, 0.162016, 0.166383, 0.170948, 0.175707, 0.180653, 0.185783, 0.19109, 0.196571, 0.202219, 0.20803, 0.214, 0.220124, 0.226397, 0.232815, 0.239374, 0.24607, 0.252899, 0.259857, 0.266941, 0.274149, 0.281477, 0.288921, 0.296479, 0.304148, 0.311925, 0.319809, 0.327796, 0.335885, 0.344074, 0.35236, 0.360741, 0.369214, 0.377779, 0.386433, 0.395174, 0.404001, 0.412913, 0.421908, 0.430983, 0.440137, 0.449368, 0.458674, 0.468053, 0.477504, 0.487026, 0.496615, 0.506271, 0.515992, 0.525776, 0.535621, 0.545524, 0.555484, 0.565498, 0.575563, 0.585678, 0.595839, 0.606045, 0.616293, 0.626579, 0.636902, 0.647257, 0.657642, 0.668054, 0.678489, 0.688944, 0.699415, 0.709898, 0.720391, 0.730889, 0.741388, 0.751884, 0.762373, 0.772852, 0.783315, 0.79376, 0.804182, 0.814576, 0.82494, 0.83527, 0.845561, 0.85581, 0.866013, 0.876168, 0.886271, 0.89632, 0.906311, 0.916242, 0.926106, 0.935904, 0.945636, 0.9553, 0.964894, 0.974417, 0.983868, 0.993248],\n  g: [0.004874, 0.009605, 0.014625, 0.019942, 0.025563, 0.031497, 0.037752, 0.044167, 0.050344, 0.056324, 0.062145, 0.067836, 0.073417, 0.078907, 0.08432, 0.089666, 0.094955, 0.100196, 0.105393, 0.110553, 0.11568, 0.120777, 0.125848, 0.130895, 0.13592, 0.140926, 0.145912, 0.150881, 0.155834, 0.160771, 0.165693, 0.170599, 0.17549, 0.180367, 0.185228, 0.190074, 0.194905, 0.199721, 0.20452, 0.209303, 0.214069, 0.218818, 0.223549, 0.228262, 0.232956, 0.237631, 0.242286, 0.246922, 0.251537, 0.25613, 0.260703, 0.265254, 0.269783, 0.27429, 0.278775, 0.283237, 0.287675, 0.292092, 0.296485, 0.300855, 0.305202, 0.309527, 0.313828, 0.318106, 0.322361, 0.326594, 0.330805, 0.334994, 0.339161, 0.343307, 0.347432, 0.351535, 0.355619, 0.359683, 0.363727, 0.367752, 0.371758, 0.375746, 0.379716, 0.38367, 0.387607, 0.391528, 0.395433, 0.399323, 0.403199, 0.407061, 0.41091, 0.414746, 0.41857, 0.422383, 0.426184, 0.429975, 0.433756, 0.437527, 0.44129, 0.445044, 0.448791, 0.45253, 0.456262, 0.459988, 0.463708, 0.467423, 0.471133, 0.474838, 0.47854, 0.482237, 0.485932, 0.489624, 0.493313, 0.497, 0.500685, 0.504369, 0.508051, 0.511733, 0.515413, 0.519093, 0.522773, 0.526453, 0.530132, 0.533812, 0.537492, 0.541173, 0.544853, 0.548535, 0.552216, 0.555899, 0.559582, 0.563265, 0.566949, 0.570633, 0.574318, 0.578002, 0.581687, 0.585371, 0.589055, 0.592739, 0.596422, 0.600104, 0.603785, 0.607464, 0.611141, 0.614817, 0.61849, 0.622161, 0.625828, 0.629492, 0.633153, 0.636809, 0.640461, 0.644107, 0.647749, 0.651384, 0.655014, 0.658636, 0.662252, 0.665859, 0.669459, 0.67305, 0.676631, 0.680203, 0.683765, 0.687316, 0.690856, 0.694384, 0.6979, 0.701402, 0.704891, 0.708366, 0.711827, 0.715272, 0.718701, 0.722114, 0.725509, 0.728888, 0.732247, 0.735588, 0.73891, 0.742211, 0.745492, 0.748751, 0.751988, 0.755203, 0.758394, 0.761561, 0.764704, 0.767822, 0.770914, 0.77398, 0.777018, 0.780029, 0.783011, 0.785964, 0.788888, 0.791781, 0.794644, 0.797475, 0.800275, 0.803041, 0.805774, 0.808473, 0.811138, 0.813768, 0.816363, 0.818921, 0.821444, 0.823929, 0.826376, 0.828786, 0.831158, 0.833491, 0.835785, 0.838039, 0.840254, 0.84243, 0.844566, 0.846661, 0.848717, 0.850733, 0.852709, 0.854645, 0.856542, 0.8584, 0.860219, 0.861999, 0.863742, 0.865448, 0.867117, 0.868751, 0.87035, 0.871916, 0.873449, 0.874951, 0.876424, 0.877868, 0.879285, 0.880678, 0.882046, 0.883393, 0.88472, 0.886029, 0.887322, 0.888601, 0.889868, 0.891125, 0.892374, 0.893616, 0.894855, 0.896091, 0.89733, 0.89857, 0.899815, 0.901065, 0.902323, 0.90359, 0.904867, 0.906157],\n  b: [0.329415, 0.335427, 0.341379, 0.347269, 0.353093, 0.358853, 0.364543, 0.370164, 0.375715, 0.381191, 0.386592, 0.391917, 0.397163, 0.402329, 0.407414, 0.412415, 0.417331, 0.42216, 0.426902, 0.431554, 0.436115, 0.440584, 0.44496, 0.449241, 0.453427, 0.457517, 0.46151, 0.465405, 0.469201, 0.472899, 0.476498, 0.479997, 0.483397, 0.486697, 0.489898, 0.493001, 0.496005, 0.498911, 0.501721, 0.504434, 0.507052, 0.509577, 0.512008, 0.514349, 0.516599, 0.518762, 0.520837, 0.522828, 0.524736, 0.526563, 0.528312, 0.529983, 0.531579, 0.533103, 0.534556, 0.535941, 0.53726, 0.538516, 0.539709, 0.540844, 0.541921, 0.542944, 0.543914, 0.544834, 0.545706, 0.546532, 0.547314, 0.548053, 0.548752, 0.549413, 0.550038, 0.550627, 0.551184, 0.55171, 0.552206, 0.552675, 0.553117, 0.553533, 0.553925, 0.554294, 0.554642, 0.554969, 0.555276, 0.555565, 0.555836, 0.556089, 0.556326, 0.556547, 0.556753, 0.556944, 0.55712, 0.557282, 0.55743, 0.557565, 0.557685, 0.557792, 0.557885, 0.557965, 0.55803, 0.558082, 0.558119, 0.558141, 0.558148, 0.55814, 0.558115, 0.558073, 0.558013, 0.557936, 0.55784, 0.557724, 0.557587, 0.55743, 0.55725, 0.557049, 0.556823, 0.556572, 0.556295, 0.555991, 0.555659, 0.555298, 0.554906, 0.554483, 0.554029, 0.553541, 0.553018, 0.552459, 0.551864, 0.551229, 0.550556, 0.549841, 0.549086, 0.548287, 0.547445, 0.546557, 0.545623, 0.544641, 0.543611, 0.54253, 0.5414, 0.540218, 0.538982, 0.537692, 0.536347, 0.534946, 0.533488, 0.531973, 0.530398, 0.528763, 0.527068, 0.525311, 0.523491, 0.521608, 0.519661, 0.517649, 0.515571, 0.513427, 0.511215, 0.508936, 0.506589, 0.504172, 0.501686, 0.499129, 0.496502, 0.493803, 0.491033, 0.488189, 0.485273, 0.482284, 0.479221, 0.476084, 0.472873, 0.469588, 0.466226, 0.462789, 0.459277, 0.455688, 0.452024, 0.448284, 0.444467, 0.440573, 0.436601, 0.432552, 0.428426, 0.424223, 0.419943, 0.415586, 0.411152, 0.40664, 0.402049, 0.397381, 0.392636, 0.387814, 0.382914, 0.377939, 0.372886, 0.367757, 0.362552, 0.357269, 0.35191, 0.346476, 0.340967, 0.335384, 0.329727, 0.323998, 0.318195, 0.312321, 0.306377, 0.300362, 0.294279, 0.288127, 0.281908, 0.275626, 0.269281, 0.262877, 0.256415, 0.249897, 0.243329, 0.236712, 0.230052, 0.223353, 0.21662, 0.209861, 0.203082, 0.196293, 0.189503, 0.182725, 0.175971, 0.169257, 0.162603, 0.156029, 0.149561, 0.143228, 0.137064, 0.131109, 0.125405, 0.120005, 0.114965, 0.110347, 0.106217, 0.102646, 0.099702, 0.097452, 0.095953, 0.09525, 0.095374, 0.096335, 0.098125, 0.100717, 0.104071, 0.108131, 0.112838, 0.118128, 0.123941, 0.130215, 0.136897, 0.143936]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const cividis: ColorMap = {\n  r: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003602, 0.017852, 0.03211, 0.046205, 0.058378, 0.068968, 0.078624, 0.087465, 0.095645, 0.103401, 0.110658, 0.117612, 0.124291, 0.130669, 0.13683, 0.142852, 0.148638, 0.154261, 0.159733, 0.165113, 0.170362, 0.17549, 0.180503, 0.185453, 0.190303, 0.195057, 0.199764, 0.204385, 0.208926, 0.213431, 0.217863, 0.222264, 0.226598, 0.230871, 0.23512, 0.239312, 0.243485, 0.247605, 0.251675, 0.255731, 0.25974, 0.263738, 0.267693, 0.271639, 0.275513, 0.279411, 0.28324, 0.287065, 0.290884, 0.294669, 0.298421, 0.302169, 0.305886, 0.309601, 0.313287, 0.316941, 0.320595, 0.32425, 0.327875, 0.331474, 0.335073, 0.338673, 0.342246, 0.345793, 0.349341, 0.352892, 0.356418, 0.359916, 0.363446, 0.366923, 0.37043, 0.373884, 0.377371, 0.38083, 0.384268, 0.387705, 0.391151, 0.394568, 0.397991, 0.401418, 0.40482, 0.408226, 0.411607, 0.414992, 0.418383, 0.421748, 0.42512, 0.428462, 0.431817, 0.435168, 0.438504, 0.44181, 0.445148, 0.448447, 0.451759, 0.455072, 0.458366, 0.461616, 0.464947, 0.468254, 0.471501, 0.474812, 0.478186, 0.481622, 0.485141, 0.488697, 0.492278, 0.495913, 0.499552, 0.503185, 0.506866, 0.51054, 0.514226, 0.51792, 0.521643, 0.525348, 0.529086, 0.532829, 0.536553, 0.540307, 0.544069, 0.54784, 0.551612, 0.555393, 0.559181, 0.562972, 0.566802, 0.570607, 0.574417, 0.578236, 0.582087, 0.585916, 0.589753, 0.593622, 0.597469, 0.601354, 0.605211, 0.609105, 0.612977, 0.616852, 0.620765, 0.624654, 0.628576, 0.632506, 0.636412, 0.640352, 0.64427, 0.648222, 0.652178, 0.656114, 0.660082, 0.664055, 0.668008, 0.671991, 0.675981, 0.679979, 0.68395, 0.687957, 0.691971, 0.695985, 0.700008, 0.704037, 0.708067, 0.712105, 0.716177, 0.720222, 0.724274, 0.728334, 0.732422, 0.736488, 0.740589, 0.744664, 0.748772, 0.752886, 0.756975, 0.761096, 0.765223, 0.769353, 0.773486, 0.777651, 0.781795, 0.785965, 0.790116, 0.794298, 0.79848, 0.802667, 0.806859, 0.811054, 0.815274, 0.819499, 0.823729, 0.827959, 0.832192, 0.836429, 0.840693, 0.844957, 0.849223, 0.853515, 0.857809, 0.862105, 0.866421, 0.870717, 0.875057, 0.879378, 0.88372, 0.888081, 0.89244, 0.896818, 0.901195, 0.905589, 0.91, 0.914407, 0.918828, 0.923279, 0.927724, 0.93218, 0.93666, 0.941147, 0.945654, 0.950178, 0.954725, 0.959284, 0.963872, 0.968469, 0.973114, 0.97778, 0.982497, 0.987293, 0.992218, 0.994847, 0.995249, 0.995503, 0.995737],\n  g: [0.135112, 0.138068, 0.141013, 0.143951, 0.146877, 0.149791, 0.152673, 0.155377, 0.157932, 0.160495, 0.163058, 0.165621, 0.168204, 0.1708, 0.17342, 0.176082, 0.178802, 0.18161, 0.18455, 0.186915, 0.188769, 0.19095, 0.193366, 0.195911, 0.198528, 0.201199, 0.203903, 0.206629, 0.209372, 0.212122, 0.214879, 0.217643, 0.220406, 0.22317, 0.225935, 0.228697, 0.231458, 0.234216, 0.236972, 0.239724, 0.242475, 0.245221, 0.247965, 0.250707, 0.253444, 0.25618, 0.258914, 0.261644, 0.264372, 0.267099, 0.269823, 0.272546, 0.275266, 0.277985, 0.280702, 0.283419, 0.286134, 0.288848, 0.291562, 0.294274, 0.296986, 0.299698, 0.302409, 0.30512, 0.307831, 0.310542, 0.313253, 0.315965, 0.318677, 0.32139, 0.324103, 0.326816, 0.329531, 0.332247, 0.334963, 0.337681, 0.340399, 0.34312, 0.345842, 0.348565, 0.351289, 0.354016, 0.356744, 0.359474, 0.362206, 0.364939, 0.367676, 0.370414, 0.373153, 0.375896, 0.378641, 0.381388, 0.384139, 0.38689, 0.389646, 0.392404, 0.395164, 0.397928, 0.400694, 0.403464, 0.406236, 0.409011, 0.41179, 0.414572, 0.417357, 0.420145, 0.422937, 0.425733, 0.428531, 0.431334, 0.43414, 0.43695, 0.439763, 0.44258, 0.445402, 0.448226, 0.451053, 0.453887, 0.456718, 0.459552, 0.462405, 0.465241, 0.468083, 0.47096, 0.473832, 0.476699, 0.479573, 0.482451, 0.485318, 0.488198, 0.491076, 0.49396, 0.496851, 0.499743, 0.502643, 0.505546, 0.508454, 0.511367, 0.514285, 0.517207, 0.520135, 0.523067, 0.526005, 0.528948, 0.531895, 0.534849, 0.537807, 0.540771, 0.543741, 0.546715, 0.549695, 0.552682, 0.555673, 0.55867, 0.561674, 0.564682, 0.567697, 0.570718, 0.573743, 0.576777, 0.579816, 0.582861, 0.585913, 0.58897, 0.592034, 0.595104, 0.59818, 0.601264, 0.604354, 0.60745, 0.610553, 0.613664, 0.61678, 0.619904, 0.623034, 0.626171, 0.629316, 0.632468, 0.635626, 0.638793, 0.641966, 0.645145, 0.648334, 0.651529, 0.654731, 0.657942, 0.66116, 0.664384, 0.667618, 0.670859, 0.674107, 0.677364, 0.680629, 0.6839, 0.687181, 0.69047, 0.693766, 0.697071, 0.700384, 0.703705, 0.707035, 0.710373, 0.713719, 0.717074, 0.720438, 0.72381, 0.72719, 0.73058, 0.733978, 0.737385, 0.740801, 0.744226, 0.747659, 0.751101, 0.754553, 0.758014, 0.761483, 0.764962, 0.76845, 0.771947, 0.775454, 0.778969, 0.782494, 0.786028, 0.789572, 0.793125, 0.796687, 0.800258, 0.803839, 0.80743, 0.81103, 0.814639, 0.818257, 0.821885, 0.825522, 0.829168, 0.832822, 0.836486, 0.840159, 0.843841, 0.84753, 0.851228, 0.854933, 0.858646, 0.862365, 0.866089, 0.869819, 0.87355, 0.877281, 0.881008, 0.884718, 0.888385, 0.892954, 0.898384, 0.903866, 0.909344],\n  b: [0.304751, 0.311105, 0.317579, 0.323982, 0.330479, 0.337065, 0.343704, 0.3505, 0.357521, 0.364534, 0.371608, 0.378769, 0.385902, 0.3931, 0.400353, 0.407577, 0.414764, 0.421859, 0.428802, 0.435532, 0.439563, 0.441085, 0.441561, 0.441564, 0.441248, 0.440785, 0.440196, 0.439531, 0.438863, 0.438105, 0.437342, 0.436593, 0.43579, 0.435067, 0.434308, 0.433547, 0.43284, 0.432148, 0.431404, 0.430752, 0.43012, 0.429528, 0.428908, 0.428325, 0.42779, 0.427299, 0.426788, 0.426329, 0.425924, 0.425497, 0.425126, 0.424809, 0.42448, 0.424206, 0.423914, 0.423678, 0.423498, 0.423304, 0.423167, 0.423014, 0.422917, 0.422873, 0.422814, 0.42281, 0.422789, 0.422821, 0.422837, 0.422979, 0.423031, 0.423211, 0.423373, 0.423517, 0.423716, 0.423973, 0.424213, 0.424512, 0.42479, 0.42512, 0.425512, 0.425889, 0.42625, 0.42667, 0.427144, 0.427605, 0.428053, 0.428559, 0.429127, 0.429685, 0.430226, 0.430823, 0.431501, 0.432075, 0.432796, 0.433428, 0.434209, 0.43489, 0.435653, 0.436475, 0.437305, 0.438096, 0.438986, 0.439848, 0.440708, 0.441642, 0.44257, 0.443577, 0.444578, 0.44556, 0.44664, 0.447692, 0.448864, 0.449982, 0.451134, 0.452341, 0.453659, 0.454885, 0.456264, 0.457582, 0.458976, 0.460457, 0.461969, 0.463395, 0.464908, 0.466357, 0.467681, 0.468845, 0.469767, 0.470384, 0.471008, 0.471453, 0.471751, 0.472032, 0.472305, 0.472432, 0.47255, 0.47264, 0.472707, 0.472639, 0.47266, 0.472543, 0.472401, 0.472352, 0.472163, 0.471947, 0.471704, 0.471439, 0.471147, 0.470829, 0.470488, 0.469988, 0.469593, 0.469172, 0.468724, 0.468118, 0.467618, 0.46709, 0.466401, 0.465821, 0.465074, 0.464441, 0.463638, 0.46295, 0.462237, 0.461351, 0.460583, 0.459641, 0.458668, 0.457818, 0.456791, 0.455886, 0.454801, 0.453689, 0.452702, 0.451534, 0.450338, 0.44927, 0.448018, 0.446736, 0.445424, 0.444251, 0.442886, 0.441491, 0.440072, 0.438624, 0.437147, 0.435647, 0.434117, 0.432386, 0.430805, 0.429194, 0.427554, 0.425717, 0.424028, 0.422131, 0.420393, 0.418448, 0.416472, 0.414659, 0.412638, 0.410587, 0.408516, 0.406422, 0.404112, 0.401966, 0.399613, 0.397423, 0.395016, 0.392597, 0.390153, 0.387684, 0.385198, 0.382504, 0.379785, 0.377043, 0.374292, 0.371529, 0.368747, 0.365746, 0.362741, 0.359729, 0.3565, 0.353259, 0.350011, 0.346571, 0.343333, 0.339685, 0.336241, 0.332599, 0.32877, 0.324968, 0.320982, 0.317021, 0.312889, 0.308594, 0.304348, 0.29996, 0.295244, 0.290611, 0.28588, 0.280876, 0.275815, 0.270532, 0.265085, 0.259365, 0.253563, 0.247445, 0.24131, 0.234677, 0.227954, 0.220878, 0.213336, 0.205468, 0.203445, 0.207561, 0.21237, 0.217772]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const gray: ColorMap = {\n  r: [0.0, 0.00392156862745098, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.0196078431372549, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.03529411764705882, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.054901960784313725, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.12156862745098039, 0.12549019607843137, 0.12941176470588234, 0.13333333333333333, 0.13725490196078433, 0.1411764705882353, 0.14509803921568626, 0.14901960784313725, 0.15294117647058825, 0.1568627450980392, 0.16078431372549018, 0.16470588235294117, 0.16862745098039217, 0.17254901960784313, 0.1764705882352941, 0.1803921568627451, 0.1843137254901961, 0.18823529411764706, 0.19215686274509802, 0.19607843137254902, 0.2, 0.20392156862745098, 0.20784313725490194, 0.21176470588235294, 0.21568627450980393, 0.2196078431372549, 0.22352941176470587, 0.22745098039215686, 0.23137254901960785, 0.23529411764705882, 0.2392156862745098, 0.24313725490196078, 0.24705882352941178, 0.25098039215686274, 0.2549019607843137, 0.2588235294117647, 0.2627450980392157, 0.26666666666666666, 0.27058823529411763, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.2901960784313725, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.3058823529411765, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.32156862745098036, 0.3254901960784314, 0.32941176470588235, 0.3333333333333333, 0.33725490196078434, 0.3411764705882353, 0.34509803921568627, 0.34901960784313724, 0.3529411764705882, 0.3568627450980392, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.37254901960784315, 0.3764705882352941, 0.3803921568627451, 0.38431372549019605, 0.38823529411764707, 0.39215686274509803, 0.396078431372549, 0.4, 0.403921568627451, 0.40784313725490196, 0.4117647058823529, 0.4156862745098039, 0.4196078431372549, 0.4235294117647059, 0.42745098039215684, 0.43137254901960786, 0.43529411764705883, 0.4392156862745098, 0.44313725490196076, 0.44705882352941173, 0.45098039215686275, 0.4549019607843137, 0.4588235294117647, 0.4627450980392157, 0.4666666666666667, 0.47058823529411764, 0.4745098039215686, 0.4784313725490196, 0.4823529411764706, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.4980392156862745, 0.5019607843137255, 0.5058823529411764, 0.5098039215686274, 0.5137254901960784, 0.5176470588235293, 0.5215686274509804, 0.5254901960784314, 0.5294117647058824, 0.5333333333333333, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5490196078431373, 0.5529411764705883, 0.5568627450980392, 0.5607843137254902, 0.5647058823529412, 0.5686274509803921, 0.5725490196078431, 0.5764705882352941, 0.580392156862745, 0.5843137254901961, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6039215686274509, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6431372549019607, 0.6470588235294118, 0.6509803921568628, 0.6549019607843137, 0.6588235294117647, 0.6627450980392157, 0.6666666666666666, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6901960784313725, 0.6941176470588235, 0.6980392156862745, 0.7019607843137254, 0.7058823529411764, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7254901960784313, 0.7294117647058823, 0.7333333333333333, 0.7372549019607844, 0.7411764705882353, 0.7450980392156863, 0.7490196078431373, 0.7529411764705882, 0.7568627450980392, 0.7607843137254902, 0.7647058823529411, 0.7686274509803921, 0.7725490196078432, 0.7764705882352941, 0.7803921568627451, 0.7843137254901961, 0.788235294117647, 0.792156862745098, 0.796078431372549, 0.8, 0.803921568627451, 0.807843137254902, 0.8117647058823529, 0.8156862745098039, 0.8196078431372549, 0.8235294117647058, 0.8274509803921568, 0.8313725490196078, 0.8352941176470589, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8901960784313725, 0.8941176470588235, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9568627450980391, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9921568627450981, 0.996078431372549, 1.0],\n  g: [0.0, 0.00392156862745098, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.0196078431372549, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.03529411764705882, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.054901960784313725, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.12156862745098039, 0.12549019607843137, 0.12941176470588234, 0.13333333333333333, 0.13725490196078433, 0.1411764705882353, 0.14509803921568626, 0.14901960784313725, 0.15294117647058825, 0.1568627450980392, 0.16078431372549018, 0.16470588235294117, 0.16862745098039217, 0.17254901960784313, 0.1764705882352941, 0.1803921568627451, 0.1843137254901961, 0.18823529411764706, 0.19215686274509802, 0.19607843137254902, 0.2, 0.20392156862745098, 0.20784313725490194, 0.21176470588235294, 0.21568627450980393, 0.2196078431372549, 0.22352941176470587, 0.22745098039215686, 0.23137254901960785, 0.23529411764705882, 0.2392156862745098, 0.24313725490196078, 0.24705882352941178, 0.25098039215686274, 0.2549019607843137, 0.2588235294117647, 0.2627450980392157, 0.26666666666666666, 0.27058823529411763, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.2901960784313725, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.3058823529411765, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.32156862745098036, 0.3254901960784314, 0.32941176470588235, 0.3333333333333333, 0.33725490196078434, 0.3411764705882353, 0.34509803921568627, 0.34901960784313724, 0.3529411764705882, 0.3568627450980392, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.37254901960784315, 0.3764705882352941, 0.3803921568627451, 0.38431372549019605, 0.38823529411764707, 0.39215686274509803, 0.396078431372549, 0.4, 0.403921568627451, 0.40784313725490196, 0.4117647058823529, 0.4156862745098039, 0.4196078431372549, 0.4235294117647059, 0.42745098039215684, 0.43137254901960786, 0.43529411764705883, 0.4392156862745098, 0.44313725490196076, 0.44705882352941173, 0.45098039215686275, 0.4549019607843137, 0.4588235294117647, 0.4627450980392157, 0.4666666666666667, 0.47058823529411764, 0.4745098039215686, 0.4784313725490196, 0.4823529411764706, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.4980392156862745, 0.5019607843137255, 0.5058823529411764, 0.5098039215686274, 0.5137254901960784, 0.5176470588235293, 0.5215686274509804, 0.5254901960784314, 0.5294117647058824, 0.5333333333333333, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5490196078431373, 0.5529411764705883, 0.5568627450980392, 0.5607843137254902, 0.5647058823529412, 0.5686274509803921, 0.5725490196078431, 0.5764705882352941, 0.580392156862745, 0.5843137254901961, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6039215686274509, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6431372549019607, 0.6470588235294118, 0.6509803921568628, 0.6549019607843137, 0.6588235294117647, 0.6627450980392157, 0.6666666666666666, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6901960784313725, 0.6941176470588235, 0.6980392156862745, 0.7019607843137254, 0.7058823529411764, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7254901960784313, 0.7294117647058823, 0.7333333333333333, 0.7372549019607844, 0.7411764705882353, 0.7450980392156863, 0.7490196078431373, 0.7529411764705882, 0.7568627450980392, 0.7607843137254902, 0.7647058823529411, 0.7686274509803921, 0.7725490196078432, 0.7764705882352941, 0.7803921568627451, 0.7843137254901961, 0.788235294117647, 0.792156862745098, 0.796078431372549, 0.8, 0.803921568627451, 0.807843137254902, 0.8117647058823529, 0.8156862745098039, 0.8196078431372549, 0.8235294117647058, 0.8274509803921568, 0.8313725490196078, 0.8352941176470589, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8901960784313725, 0.8941176470588235, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9568627450980391, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9921568627450981, 0.996078431372549, 1.0],\n  b: [0.0, 0.00392156862745098, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.0196078431372549, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.03529411764705882, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.054901960784313725, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.12156862745098039, 0.12549019607843137, 0.12941176470588234, 0.13333333333333333, 0.13725490196078433, 0.1411764705882353, 0.14509803921568626, 0.14901960784313725, 0.15294117647058825, 0.1568627450980392, 0.16078431372549018, 0.16470588235294117, 0.16862745098039217, 0.17254901960784313, 0.1764705882352941, 0.1803921568627451, 0.1843137254901961, 0.18823529411764706, 0.19215686274509802, 0.19607843137254902, 0.2, 0.20392156862745098, 0.20784313725490194, 0.21176470588235294, 0.21568627450980393, 0.2196078431372549, 0.22352941176470587, 0.22745098039215686, 0.23137254901960785, 0.23529411764705882, 0.2392156862745098, 0.24313725490196078, 0.24705882352941178, 0.25098039215686274, 0.2549019607843137, 0.2588235294117647, 0.2627450980392157, 0.26666666666666666, 0.27058823529411763, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.2901960784313725, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.3058823529411765, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.32156862745098036, 0.3254901960784314, 0.32941176470588235, 0.3333333333333333, 0.33725490196078434, 0.3411764705882353, 0.34509803921568627, 0.34901960784313724, 0.3529411764705882, 0.3568627450980392, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.37254901960784315, 0.3764705882352941, 0.3803921568627451, 0.38431372549019605, 0.38823529411764707, 0.39215686274509803, 0.396078431372549, 0.4, 0.403921568627451, 0.40784313725490196, 0.4117647058823529, 0.4156862745098039, 0.4196078431372549, 0.4235294117647059, 0.42745098039215684, 0.43137254901960786, 0.43529411764705883, 0.4392156862745098, 0.44313725490196076, 0.44705882352941173, 0.45098039215686275, 0.4549019607843137, 0.4588235294117647, 0.4627450980392157, 0.4666666666666667, 0.47058823529411764, 0.4745098039215686, 0.4784313725490196, 0.4823529411764706, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.4980392156862745, 0.5019607843137255, 0.5058823529411764, 0.5098039215686274, 0.5137254901960784, 0.5176470588235293, 0.5215686274509804, 0.5254901960784314, 0.5294117647058824, 0.5333333333333333, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5490196078431373, 0.5529411764705883, 0.5568627450980392, 0.5607843137254902, 0.5647058823529412, 0.5686274509803921, 0.5725490196078431, 0.5764705882352941, 0.580392156862745, 0.5843137254901961, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6039215686274509, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6431372549019607, 0.6470588235294118, 0.6509803921568628, 0.6549019607843137, 0.6588235294117647, 0.6627450980392157, 0.6666666666666666, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6901960784313725, 0.6941176470588235, 0.6980392156862745, 0.7019607843137254, 0.7058823529411764, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7254901960784313, 0.7294117647058823, 0.7333333333333333, 0.7372549019607844, 0.7411764705882353, 0.7450980392156863, 0.7490196078431373, 0.7529411764705882, 0.7568627450980392, 0.7607843137254902, 0.7647058823529411, 0.7686274509803921, 0.7725490196078432, 0.7764705882352941, 0.7803921568627451, 0.7843137254901961, 0.788235294117647, 0.792156862745098, 0.796078431372549, 0.8, 0.803921568627451, 0.807843137254902, 0.8117647058823529, 0.8156862745098039, 0.8196078431372549, 0.8235294117647058, 0.8274509803921568, 0.8313725490196078, 0.8352941176470589, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8901960784313725, 0.8941176470588235, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9568627450980391, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9921568627450981, 0.996078431372549, 1.0]\n};\n","\nimport type { ColorMap } from \"./types\";\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const svs_nitrogen_dioxide: ColorMap = {\n  r: [0.027451, 0.027451, 0.0313726, 0.0313726, 0.0313726, 0.0352941, 0.0392157, 0.0392157, 0.0431373, 0.0431373, 0.0470588, 0.0509804, 0.0509804, 0.054902, 0.054902, 0.0588235, 0.0627451, 0.0627451, 0.0666667, 0.0666667, 0.0705882, 0.0745098, 0.0745098, 0.0784314, 0.0823529, 0.0823529, 0.0862745, 0.0901961, 0.0901961, 0.0941176, 0.0941176, 0.0980392, 0.101961, 0.101961, 0.105882, 0.109804, 0.113725, 0.117647, 0.121569, 0.12549, 0.133333, 0.137255, 0.145098, 0.14902, 0.156863, 0.164706, 0.172549, 0.180392, 0.188235, 0.196078, 0.207843, 0.215686, 0.223529, 0.231373, 0.239216, 0.25098, 0.258824, 0.266667, 0.278431, 0.286275, 0.294118, 0.301961, 0.313726, 0.321569, 0.329412, 0.337255, 0.345098, 0.356863, 0.364706, 0.372549, 0.380392, 0.388235, 0.4, 0.407843, 0.415686, 0.427451, 0.435294, 0.443137, 0.45098, 0.462745, 0.470588, 0.478431, 0.490196, 0.501961, 0.509804, 0.521569, 0.529412, 0.541176, 0.552941, 0.564706, 0.576471, 0.584314, 0.6, 0.607843, 0.619608, 0.631373, 0.639216, 0.654902, 0.662745, 0.67451, 0.686275, 0.694118, 0.705882, 0.713726, 0.72549, 0.737255, 0.745098, 0.756863, 0.764706, 0.772549, 0.784314, 0.792157, 0.803922, 0.811765, 0.819608, 0.827451, 0.835294, 0.847059, 0.85098, 0.858824, 0.870588, 0.87451, 0.882353, 0.890196, 0.898039, 0.905882, 0.909804, 0.917647, 0.92549, 0.929412, 0.937255, 0.941176, 0.94902, 0.952941, 0.960784, 0.964706, 0.972549, 0.976471, 0.980392, 0.984314, 0.988235, 0.988235, 0.992157, 0.992157, 0.992157, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.996078, 0.996078, 0.996078, 0.992157, 0.992157, 0.988235, 0.984314, 0.980392, 0.976471, 0.972549, 0.968627, 0.964706, 0.956863, 0.94902, 0.945098, 0.933333, 0.92549, 0.917647, 0.905882, 0.898039, 0.886275, 0.87451, 0.858824, 0.847059, 0.835294, 0.819608, 0.803922, 0.788235, 0.772549, 0.760784, 0.741176, 0.72549, 0.705882, 0.690196, 0.67451, 0.65098, 0.635294, 0.615686, 0.596078, 0.580392, 0.556863, 0.541176, 0.521569, 0.501961, 0.486275, 0.466667, 0.45098, 0.427451, 0.411765, 0.396078, 0.376471, 0.364706, 0.345098, 0.329412, 0.317647, 0.298039, 0.286275, 0.270588, 0.258824, 0.247059, 0.235294, 0.227451, 0.219608, 0.211765, 0.211765, 0.207843, 0.207843, 0.211765, 0.211765, 0.215686, 0.223529, 0.227451, 0.231373],\n  g: [0.0156863, 0.0156863, 0.0156863, 0.0196078, 0.0196078, 0.0196078, 0.0235294, 0.0235294, 0.0235294, 0.0235294, 0.027451, 0.027451, 0.027451, 0.0313726, 0.0313726, 0.0313726, 0.0352941, 0.0352941, 0.0352941, 0.0352941, 0.0392157, 0.0392157, 0.0392157, 0.0431373, 0.0431373, 0.0431373, 0.0470588, 0.0470588, 0.0470588, 0.0509804, 0.0509804, 0.0509804, 0.0509804, 0.054902, 0.054902, 0.054902, 0.0588235, 0.0588235, 0.0588235, 0.0588235, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0705882, 0.0705882, 0.0705882, 0.0745098, 0.0745098, 0.0784314, 0.0823529, 0.0823529, 0.0862745, 0.0901961, 0.0941176, 0.0980392, 0.101961, 0.105882, 0.105882, 0.109804, 0.113725, 0.117647, 0.121569, 0.12549, 0.129412, 0.133333, 0.137255, 0.141176, 0.141176, 0.145098, 0.14902, 0.152941, 0.156863, 0.160784, 0.164706, 0.168627, 0.172549, 0.176471, 0.180392, 0.184314, 0.188235, 0.192157, 0.196078, 0.2, 0.203922, 0.207843, 0.211765, 0.215686, 0.219608, 0.223529, 0.227451, 0.231373, 0.235294, 0.239216, 0.247059, 0.25098, 0.254902, 0.258824, 0.262745, 0.270588, 0.27451, 0.282353, 0.290196, 0.294118, 0.301961, 0.309804, 0.321569, 0.329412, 0.337255, 0.34902, 0.356863, 0.368627, 0.376471, 0.388235, 0.396078, 0.407843, 0.415686, 0.427451, 0.435294, 0.447059, 0.458824, 0.466667, 0.482353, 0.494118, 0.505882, 0.517647, 0.529412, 0.545098, 0.556863, 0.572549, 0.584314, 0.6, 0.615686, 0.627451, 0.643137, 0.654902, 0.670588, 0.686275, 0.698039, 0.709804, 0.721569, 0.733333, 0.74902, 0.756863, 0.772549, 0.780392, 0.792157, 0.803922, 0.811765, 0.823529, 0.831373, 0.843137, 0.85098, 0.862745, 0.870588, 0.878431, 0.890196, 0.898039, 0.905882, 0.913725, 0.921569, 0.929412, 0.937255, 0.941176, 0.94902, 0.952941, 0.960784, 0.964706, 0.968627, 0.972549, 0.976471, 0.976471, 0.980392, 0.980392, 0.980392, 0.980392, 0.976471, 0.976471, 0.972549, 0.968627, 0.964706, 0.960784, 0.956863, 0.952941, 0.945098, 0.941176, 0.937255, 0.929412, 0.92549, 0.917647, 0.913725, 0.905882, 0.901961, 0.894118, 0.886275, 0.882353, 0.878431, 0.870588, 0.866667, 0.858824, 0.854902, 0.847059, 0.839216, 0.835294, 0.827451, 0.823529, 0.815686, 0.807843, 0.8, 0.792157, 0.788235, 0.780392, 0.768627, 0.760784, 0.752941, 0.741176, 0.733333, 0.721569, 0.709804, 0.698039, 0.686275, 0.67451, 0.662745, 0.65098, 0.635294, 0.623529, 0.607843, 0.592157, 0.580392, 0.564706, 0.552941, 0.541176, 0.529412, 0.517647, 0.501961, 0.494118, 0.486275, 0.47451, 0.470588, 0.462745],\n  b: [0.0509804, 0.054902, 0.0588235, 0.0627451, 0.0666667, 0.0745098, 0.0784314, 0.0862745, 0.0901961, 0.0941176, 0.101961, 0.109804, 0.113725, 0.121569, 0.12549, 0.133333, 0.141176, 0.145098, 0.152941, 0.156863, 0.164706, 0.172549, 0.180392, 0.184314, 0.192157, 0.196078, 0.203922, 0.211765, 0.215686, 0.223529, 0.227451, 0.235294, 0.243137, 0.247059, 0.254902, 0.262745, 0.266667, 0.27451, 0.282353, 0.286275, 0.294118, 0.301961, 0.309804, 0.317647, 0.32549, 0.333333, 0.341176, 0.352941, 0.360784, 0.368627, 0.376471, 0.384314, 0.396078, 0.403922, 0.411765, 0.419608, 0.427451, 0.435294, 0.443137, 0.45098, 0.454902, 0.462745, 0.466667, 0.470588, 0.47451, 0.478431, 0.482353, 0.486275, 0.486275, 0.490196, 0.490196, 0.490196, 0.494118, 0.494118, 0.494118, 0.498039, 0.498039, 0.498039, 0.498039, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.498039, 0.498039, 0.498039, 0.494118, 0.494118, 0.494118, 0.490196, 0.490196, 0.490196, 0.486275, 0.486275, 0.482353, 0.482353, 0.478431, 0.47451, 0.47451, 0.470588, 0.466667, 0.462745, 0.458824, 0.454902, 0.45098, 0.447059, 0.443137, 0.439216, 0.435294, 0.431373, 0.431373, 0.423529, 0.423529, 0.419608, 0.415686, 0.411765, 0.407843, 0.403922, 0.4, 0.4, 0.396078, 0.392157, 0.388235, 0.384314, 0.380392, 0.376471, 0.368627, 0.364706, 0.360784, 0.352941, 0.34902, 0.341176, 0.337255, 0.329412, 0.32549, 0.321569, 0.317647, 0.313726, 0.313726, 0.313726, 0.313726, 0.317647, 0.321569, 0.32549, 0.333333, 0.337255, 0.34902, 0.356863, 0.364706, 0.376471, 0.384314, 0.392157, 0.403922, 0.411765, 0.423529, 0.431373, 0.443137, 0.45098, 0.462745, 0.47451, 0.482353, 0.498039, 0.505882, 0.517647, 0.533333, 0.54902, 0.564706, 0.576471, 0.592157, 0.611765, 0.623529, 0.643137, 0.654902, 0.670588, 0.686275, 0.694118, 0.709804, 0.717647, 0.72549, 0.733333, 0.737255, 0.741176, 0.745098, 0.745098, 0.741176, 0.737255, 0.729412, 0.72549, 0.717647, 0.705882, 0.698039, 0.686275, 0.678431, 0.670588, 0.658824, 0.65098, 0.643137, 0.639216, 0.631373, 0.627451, 0.627451, 0.627451, 0.627451, 0.627451, 0.631373, 0.631373, 0.635294, 0.639216, 0.643137, 0.65098, 0.654902, 0.658824, 0.662745, 0.662745, 0.666667, 0.670588, 0.670588, 0.67451, 0.67451, 0.67451, 0.67451, 0.67451, 0.67451, 0.678431, 0.678431, 0.682353, 0.686275, 0.686275, 0.690196, 0.698039, 0.701961, 0.709804, 0.713726, 0.717647, 0.72549, 0.733333, 0.737255, 0.745098, 0.74902, 0.756863, 0.760784, 0.764706, 0.768627, 0.772549, 0.772549, 0.776471, 0.776471, 0.776471, 0.776471, 0.776471, 0.776471, 0.776471],\n};\n\n\nexport const svsColorRamp = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        7,\n        4,\n        13,\n        255\n      ],\n      \"toColor\": [\n        13,\n        7,\n        29,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 0.047619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        13,\n        7,\n        29,\n        255\n      ],\n      \"toColor\": [\n        20,\n        11,\n        49,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.047619047619047616,\n      \"stop\": 0.09523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        20,\n        11,\n        49,\n        255\n      ],\n      \"toColor\": [\n        29,\n        14,\n        68,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.09523809523809523,\n      \"stop\": 0.14285714285714285\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        29,\n        14,\n        68,\n        255\n      ],\n      \"toColor\": [\n        49,\n        16,\n        93,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.14285714285714285,\n      \"stop\": 0.19047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        49,\n        16,\n        93,\n        255\n      ],\n      \"toColor\": [\n        76,\n        17,\n        117,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.19047619047619047,\n      \"stop\": 0.23809523809523808\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        76,\n        17,\n        117,\n        255\n      ],\n      \"toColor\": [\n        103,\n        26,\n        126,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.23809523809523808,\n      \"stop\": 0.2857142857142857\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        103,\n        26,\n        126,\n        255\n      ],\n      \"toColor\": [\n        133,\n        36,\n        128,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.2857142857142857,\n      \"stop\": 0.3333333333333333\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        133,\n        36,\n        128,\n        255\n      ],\n      \"toColor\": [\n        167,\n        49,\n        123,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.3333333333333333,\n      \"stop\": 0.38095238095238093\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        167,\n        49,\n        123,\n        255\n      ],\n      \"toColor\": [\n        197,\n        61,\n        113,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.38095238095238093,\n      \"stop\": 0.42857142857142855\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        197,\n        61,\n        113,\n        255\n      ],\n      \"toColor\": [\n        223,\n        80,\n        102,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.42857142857142855,\n      \"stop\": 0.47619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        223,\n        80,\n        102,\n        255\n      ],\n      \"toColor\": [\n        244,\n        110,\n        89,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.47619047619047616,\n      \"stop\": 0.5238095238095237\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        244,\n        110,\n        89,\n        255\n      ],\n      \"toColor\": [\n        253,\n        148,\n        81,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5238095238095237,\n      \"stop\": 0.5714285714285714\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        148,\n        81,\n        255\n      ],\n      \"toColor\": [\n        253,\n        190,\n        107,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5714285714285714,\n      \"stop\": 0.6190476190476191\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        190,\n        107,\n        255\n      ],\n      \"toColor\": [\n        253,\n        221,\n        144,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6190476190476191,\n      \"stop\": 0.6666666666666666\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        221,\n        144,\n        255\n      ],\n      \"toColor\": [\n        254,\n        245,\n        185,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6666666666666666,\n      \"stop\": 0.7142857142857142\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        254,\n        245,\n        185,\n        255\n      ],\n      \"toColor\": [\n        245,\n        247,\n        177,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7142857142857142,\n      \"stop\": 0.7619047619047619\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        245,\n        247,\n        177,\n        255\n      ],\n      \"toColor\": [\n        214,\n        232,\n        160,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7619047619047619,\n      \"stop\": 0.8095238095238095\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        214,\n        232,\n        160,\n        255\n      ],\n      \"toColor\": [\n        163,\n        213,\n        170,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8095238095238095,\n      \"stop\": 0.8571428571428571\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        163,\n        213,\n        170,\n        255\n      ],\n      \"toColor\": [\n        106,\n        189,\n        175,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8571428571428571,\n      \"stop\": 0.9047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        106,\n        189,\n        175,\n        255\n      ],\n      \"toColor\": [\n        60,\n        151,\n        192,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9047619047619047,\n      \"stop\": 0.9523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        60,\n        151,\n        192,\n        255\n      ],\n      \"toColor\": [\n        59,\n        117,\n        198,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9523809523809523,\n      \"stop\": 1.0\n    }\n  ]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const sargassum: ColorMap = {\n  r: [0.3843137254901961, 0.38823529411764707, 0.396078431372549, 0.4, 0.40784313725490196, 0.41568627450980394, 0.42745098039215684, 0.43529411764705883, 0.44313725490196076, 0.4549019607843137, 0.4666666666666667, 0.4745098039215686, 0.48627450980392156, 0.49411764705882355, 0.5058823529411764, 0.5137254901960784, 0.5254901960784314, 0.5333333333333333, 0.5450980392156862, 0.5529411764705883, 0.5647058823529412, 0.5725490196078431, 0.5843137254901961, 0.592156862745098, 0.6039215686274509, 0.615686274509804, 0.6235294117647059, 0.6352941176470588, 0.6431372549019608, 0.6549019607843137, 0.6627450980392157, 0.6745098039215687, 0.6823529411764706, 0.6901960784313725, 0.7019607843137254, 0.7098039215686275, 0.7215686274509804, 0.7294117647058823, 0.7372549019607844, 0.7490196078431373, 0.7568627450980392, 0.7686274509803922, 0.7764705882352941, 0.788235294117647, 0.796078431372549, 0.803921568627451, 0.8156862745098039, 0.8235294117647058, 0.8313725490196079, 0.8392156862745098, 0.8470588235294118, 0.8509803921568627, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8862745098039215, 0.8901960784313725, 0.8941176470588236, 0.8980392156862745, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9058823529411765, 0.9098039215686274, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9490196078431372, 0.9529411764705882, 0.9529411764705882, 0.9568627450980393, 0.9607843137254902, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9686274509803922, 0.9725490196078431, 0.9725490196078431, 0.9764705882352941, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.984313725490196, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.984313725490196, 0.984313725490196, 0.984313725490196, 0.984313725490196, 0.9803921568627451, 0.9803921568627451, 0.9803921568627451, 0.9803921568627451, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9686274509803922, 0.9686274509803922, 0.9647058823529412, 0.9647058823529412, 0.9607843137254902, 0.9529411764705882, 0.9490196078431372, 0.9411764705882353, 0.9333333333333333, 0.9254901960784314, 0.9137254901960784, 0.9058823529411765, 0.8941176470588236, 0.8862745098039215, 0.8745098039215686, 0.8666666666666667, 0.8549019607843137, 0.8470588235294118, 0.8392156862745098, 0.8274509803921568, 0.8196078431372549, 0.807843137254902, 0.8, 0.788235294117647, 0.7803921568627451, 0.7686274509803922, 0.7568627450980392, 0.7450980392156863, 0.7372549019607844, 0.7254901960784313, 0.7137254901960784, 0.7058823529411765, 0.6941176470588235, 0.6823529411764706, 0.6745098039215687, 0.6627450980392157, 0.6509803921568628, 0.6392156862745098, 0.6313725490196078, 0.6196078431372549, 0.6078431372549019, 0.6, 0.5882352941176471, 0.5764705882352941, 0.5686274509803921, 0.5568627450980392, 0.5450980392156862, 0.5333333333333333, 0.5215686274509804, 0.5098039215686274, 0.5019607843137255, 0.49019607843137253, 0.4823529411764706, 0.4745098039215686, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.4745098039215686, 0.47843137254901963, 0.48627450980392156, 0.49411764705882355, 0.5019607843137255, 0.5137254901960784, 0.5254901960784314, 0.5372549019607843, 0.5450980392156862, 0.5568627450980392, 0.5686274509803921, 0.5803921568627451, 0.592156862745098, 0.6039215686274509, 0.615686274509804, 0.6235294117647059, 0.6352941176470588, 0.6470588235294118, 0.6588235294117647, 0.6705882352941176, 0.6823529411764706, 0.6941176470588235, 0.7058823529411765, 0.7137254901960784, 0.7254901960784313, 0.7372549019607844, 0.7490196078431373, 0.7607843137254902, 0.7725490196078432, 0.7843137254901961, 0.792156862745098, 0.803921568627451, 0.8156862745098039, 0.8235294117647058, 0.8352941176470589, 0.8470588235294118, 0.8549019607843137, 0.8666666666666667, 0.8784313725490196, 0.8901960784313725, 0.8980392156862745, 0.9098039215686274, 0.9215686274509803, 0.9294117647058824, 0.9411764705882353, 0.9490196078431372, 0.9568627450980393, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9725490196078431],\n  g: [0.07058823529411765, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.10196078431372549, 0.10588235294117647, 0.11372549019607843, 0.11764705882352941, 0.12549019607843137, 0.13333333333333333, 0.13725490196078433, 0.1450980392156863, 0.14901960784313725, 0.1568627450980392, 0.1607843137254902, 0.16470588235294117, 0.17254901960784313, 0.17647058823529413, 0.1843137254901961, 0.18823529411764706, 0.19607843137254902, 0.2, 0.20784313725490197, 0.21176470588235294, 0.21568627450980393, 0.2235294117647059, 0.22745098039215686, 0.23529411764705882, 0.23921568627450981, 0.24705882352941178, 0.25098039215686274, 0.25882352941176473, 0.2627450980392157, 0.26666666666666666, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.3254901960784314, 0.32941176470588235, 0.33725490196078434, 0.3411764705882353, 0.34901960784313724, 0.35294117647058826, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.3764705882352941, 0.3803921568627451, 0.38823529411764707, 0.39215686274509803, 0.4, 0.403921568627451, 0.4117647058823529, 0.41568627450980394, 0.4235294117647059, 0.42745098039215684, 0.43529411764705883, 0.4392156862745098, 0.4470588235294118, 0.45098039215686275, 0.4588235294117647, 0.4627450980392157, 0.47058823529411764, 0.4745098039215686, 0.47843137254901963, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.5019607843137255, 0.5058823529411764, 0.5137254901960784, 0.5176470588235295, 0.5254901960784314, 0.5294117647058824, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5529411764705883, 0.5568627450980392, 0.5647058823529412, 0.5686274509803921, 0.5764705882352941, 0.5803921568627451, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6392156862745098, 0.6431372549019608, 0.6470588235294118, 0.6470588235294118, 0.6509803921568628, 0.6509803921568628, 0.6509803921568628, 0.6549019607843137, 0.6549019607843137, 0.6588235294117647, 0.6588235294117647, 0.6627450980392157, 0.6627450980392157, 0.6666666666666666, 0.6666666666666666, 0.6705882352941176, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6862745098039216, 0.6901960784313725, 0.6901960784313725, 0.6941176470588235, 0.6941176470588235, 0.6980392156862745, 0.6980392156862745, 0.7019607843137254, 0.7019607843137254, 0.7019607843137254, 0.7058823529411765, 0.7058823529411765, 0.7098039215686275, 0.7098039215686275, 0.7137254901960784, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7215686274509804, 0.7254901960784313, 0.7254901960784313, 0.7294117647058823, 0.7294117647058823, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7254901960784313, 0.7254901960784313, 0.7254901960784313, 0.7254901960784313, 0.7215686274509804, 0.7215686274509804, 0.7215686274509804, 0.7215686274509804, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7098039215686275, 0.7098039215686275, 0.7098039215686275, 0.7058823529411765, 0.7058823529411765, 0.7058823529411765, 0.7058823529411765, 0.7058823529411765, 0.7019607843137254, 0.7019607843137254, 0.7019607843137254, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.7019607843137254, 0.7019607843137254, 0.7058823529411765, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7294117647058823, 0.7372549019607844, 0.7411764705882353, 0.7490196078431373, 0.7529411764705882, 0.7607843137254902, 0.7647058823529411, 0.7725490196078432, 0.7803921568627451, 0.7843137254901961, 0.792156862745098, 0.8, 0.803921568627451, 0.8117647058823529, 0.8156862745098039, 0.8235294117647058, 0.8313725490196079, 0.8352941176470589, 0.8431372549019608, 0.8470588235294118, 0.8549019607843137, 0.8588235294117647, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8823529411764706, 0.8862745098039215, 0.8941176470588236, 0.8980392156862745, 0.9058823529411765, 0.9098039215686274, 0.9176470588235294, 0.9254901960784314, 0.9294117647058824, 0.9372549019607843, 0.9411764705882353, 0.9490196078431372, 0.9529411764705882, 0.9568627450980393, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.9803921568627451, 0.9882352941176471],\n  b: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.0, 0.0, 0.0, 0.0, 0.00392156862745098, 0.00392156862745098, 0.00784313725490196, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.11764705882352941, 0.12156862745098039, 0.12156862745098039, 0.12549019607843137, 0.12549019607843137, 0.12941176470588237, 0.12941176470588237, 0.13333333333333333, 0.13333333333333333, 0.13333333333333333, 0.13725490196078433, 0.13725490196078433, 0.13725490196078433, 0.1411764705882353, 0.1411764705882353, 0.1411764705882353, 0.1450980392156863, 0.1450980392156863, 0.1450980392156863, 0.1450980392156863, 0.14901960784313725, 0.14901960784313725, 0.14901960784313725, 0.14901960784313725, 0.14901960784313725, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1607843137254902, 0.1607843137254902, 0.1607843137254902, 0.1607843137254902, 0.16470588235294117, 0.16470588235294117, 0.16470588235294117, 0.16470588235294117, 0.16862745098039217, 0.16862745098039217, 0.17254901960784313, 0.17647058823529413, 0.1803921568627451, 0.18823529411764706, 0.19607843137254902, 0.20392156862745098, 0.21568627450980393, 0.23137254901960785, 0.24705882352941178, 0.2627450980392157, 0.2784313725490196, 0.29411764705882354, 0.30980392156862746, 0.3254901960784314, 0.3411764705882353, 0.35294117647058826, 0.3686274509803922, 0.3843137254901961, 0.396078431372549, 0.4117647058823529, 0.4235294117647059, 0.4392156862745098, 0.45098039215686275, 0.4666666666666667, 0.47843137254901963, 0.49019607843137253, 0.5019607843137255, 0.5137254901960784, 0.5254901960784314, 0.5411764705882353, 0.5529411764705883, 0.5647058823529412, 0.5764705882352941, 0.5882352941176471, 0.6, 0.611764705882353, 0.6235294117647059, 0.6352941176470588, 0.6470588235294118, 0.6549019607843137, 0.6666666666666666, 0.6784313725490196, 0.6901960784313725, 0.7019607843137254, 0.7137254901960784, 0.7254901960784313, 0.7372549019607844, 0.7490196078431373, 0.7568627450980392, 0.7686274509803922, 0.7803921568627451, 0.788235294117647, 0.8, 0.807843137254902, 0.8196078431372549, 0.8274509803921568, 0.8313725490196079, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8862745098039215, 0.8901960784313725, 0.8941176470588236, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9529411764705882, 0.9568627450980393, 0.9607843137254902, 0.9647058823529412, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9921568627450981, 0.9921568627450981],\n};\n\n\nexport const sargassumColorRamp = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        98,\n        18,\n        0,\n        255\n      ],\n      \"toColor\": [\n        124,\n        32,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 0.047619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        124,\n        32,\n        1,\n        255\n      ],\n      \"toColor\": [\n        154,\n        50,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.047619047619047616,\n      \"stop\": 0.09523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        154,\n        50,\n        0,\n        255\n      ],\n      \"toColor\": [\n        184,\n        67,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.09523809523809523,\n      \"stop\": 0.14285714285714285\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        184,\n        67,\n        0,\n        255\n      ],\n      \"toColor\": [\n        213,\n        83,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.14285714285714285,\n      \"stop\": 0.19047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        213,\n        83,\n        1,\n        255\n      ],\n      \"toColor\": [\n        225,\n        101,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.19047619047619047,\n      \"stop\": 0.23809523809523808\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        225,\n        101,\n        1,\n        255\n      ],\n      \"toColor\": [\n        233,\n        119,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.23809523809523808,\n      \"stop\": 0.2857142857142857\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        233,\n        119,\n        1,\n        255\n      ],\n      \"toColor\": [\n        242,\n        137,\n        15,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.2857142857142857,\n      \"stop\": 0.3333333333333333\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        242,\n        137,\n        15,\n        255\n      ],\n      \"toColor\": [\n        249,\n        153,\n        28,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.3333333333333333,\n      \"stop\": 0.38095238095238093\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        249,\n        153,\n        28,\n        255\n      ],\n      \"toColor\": [\n        253,\n        165,\n        34,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.38095238095238093,\n      \"stop\": 0.42857142857142855\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        165,\n        34,\n        255\n      ],\n      \"toColor\": [\n        252,\n        170,\n        38,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.42857142857142855,\n      \"stop\": 0.47619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        252,\n        170,\n        38,\n        255\n      ],\n      \"toColor\": [\n        249,\n        177,\n        40,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.47619047619047616,\n      \"stop\": 0.5238095238095237\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        249,\n        177,\n        40,\n        255\n      ],\n      \"toColor\": [\n        248,\n        183,\n        42,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5238095238095237,\n      \"stop\": 0.5714285714285714\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        248,\n        183,\n        42,\n        255\n      ],\n      \"toColor\": [\n        233,\n        186,\n        70,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5714285714285714,\n      \"stop\": 0.6190476190476191\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        233,\n        186,\n        70,\n        255\n      ],\n      \"toColor\": [\n        204,\n        184,\n        115,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6190476190476191,\n      \"stop\": 0.6666666666666666\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        204,\n        184,\n        115,\n        255\n      ],\n      \"toColor\": [\n        171,\n        182,\n        153,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6666666666666666,\n      \"stop\": 0.7142857142857142\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        171,\n        182,\n        153,\n        255\n      ],\n      \"toColor\": [\n        138,\n        178,\n        188,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7142857142857142,\n      \"stop\": 0.7619047619047619\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        138,\n        178,\n        188,\n        255\n      ],\n      \"toColor\": [\n        122,\n        181,\n        215,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7619047619047619,\n      \"stop\": 0.8095238095238095\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        122,\n        181,\n        215,\n        255\n      ],\n      \"toColor\": [\n        155,\n        199,\n        226,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8095238095238095,\n      \"stop\": 0.8571428571428571\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        155,\n        199,\n        226,\n        255\n      ],\n      \"toColor\": [\n        190,\n        218,\n        236,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8571428571428571,\n      \"stop\": 0.9047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        190,\n        218,\n        236,\n        255\n      ],\n      \"toColor\": [\n        223,\n        236,\n        245,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9047619047619047,\n      \"stop\": 0.9523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        223,\n        236,\n        245,\n        255\n      ],\n      \"toColor\": [\n        248,\n        252,\n        253,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9523809523809523,\n      \"stop\": 1.0\n    }\n  ]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const haline: ColorMap = {\n  r: [0.1629529545569048, 0.16481011306381138, 0.16661616674455051, 0.16836623940471737, 0.17005470631768066, 0.1716750780810942, 0.17321986700170694, 0.1746804342417165, 0.17604336542541646, 0.17729823332351538, 0.17843229662509333, 0.17942266920100228, 0.180254232712636, 0.180897536581308, 0.1813298273265454, 0.1815069308605479, 0.18139595590863708, 0.1809499433760711, 0.18011665240948918, 0.17884195577310877, 0.17707513448329337, 0.1747764954226868, 0.17192558838006158, 0.1685302279919113, 0.164637354379816, 0.16031416565937215, 0.15565394557274276, 0.15073735679779035, 0.14564275779798264, 0.1404368075255881, 0.13517265040893509, 0.12989065618077872, 0.12462051256931497, 0.11938590047805706, 0.11422949121970527, 0.10914049113753677, 0.10414385842443263, 0.09926304855671816, 0.0944951258080505, 0.08986951574154733, 0.08539285840535987, 0.08106756674391194, 0.0769441893273207, 0.07300703739422579, 0.06927650669442811, 0.06578801445169752, 0.06255595479554787, 0.059592051819134705, 0.05691772151374492, 0.05455347307306369, 0.05251889627870444, 0.050838773472474307, 0.04951454037014189, 0.04855490408104566, 0.047963691562250284, 0.04773946305380069, 0.047875451814151544, 0.0483598472050416, 0.049176387574113, 0.05030518671680884, 0.05172369283691292, 0.05340767549062541, 0.05533215100674955, 0.05747218306369887, 0.05980352430527091, 0.06230309069250609, 0.06494927925026378, 0.06772215122553368, 0.0706035074778493, 0.07357840396611612, 0.07663101364217326, 0.07974739830752586, 0.08291580548873803, 0.08612580955679122, 0.08936817980172057, 0.09263475301781654, 0.09591831391237074, 0.09921323508992197, 0.10251396146531713, 0.10581448535228527, 0.1091104131658914, 0.11239784950892981, 0.11567333621600695, 0.11893417013803154, 0.12217818929740112, 0.12540189437459884, 0.1286031296249826, 0.13177997116656254, 0.13493070192214515, 0.1380549051543558, 0.1411501069188545, 0.1442150210041466, 0.14724858201038377, 0.15024993416559976, 0.15321920226797617, 0.15615458635588805, 0.15905548258963134, 0.16192138547473778, 0.1647524478987732, 0.1675482630437003, 0.17030806884524888, 0.173031724594995, 0.17571936649681574, 0.17837165032593938, 0.18098781677618211, 0.18356807194166253, 0.1861127112291279, 0.18862304058887, 0.19109852514864226, 0.19353972277173262, 0.19594728833405683, 0.1983227076664062, 0.20066603425074547, 0.20297813604786474, 0.20526004447420448, 0.2075134652380221, 0.20973894946144023, 0.21193776912721762, 0.21411134378441182, 0.2162615771757636, 0.21838952862057853, 0.2204969036245258, 0.22258552726351216, 0.22465736600629022, 0.22671413523001882, 0.22875791756964453, 0.23079086796822001, 0.2328150701112509, 0.23483285614219046, 0.23684664957075507, 0.2388588283644082, 0.24087168222405414, 0.24288806087225434, 0.24491067596723043, 0.24694202909654656, 0.24898467028821447, 0.251041844633167, 0.2531164830585315, 0.2552111567013787, 0.2573286340449816, 0.25947244473861586, 0.2616456589963801, 0.2638509342960792, 0.26609108289659433, 0.2683698467163787, 0.27069035099494715, 0.2730554221838173, 0.2754676310512872, 0.2779309010023177, 0.28044833184082757, 0.2830229969716622, 0.28565699250220966, 0.2883543502639873, 0.29111809079756673, 0.2939511790083493, 0.29685621314189514, 0.2998362114418811, 0.30289439617634056, 0.3060335830069556, 0.30925653734539094, 0.3125659486948475, 0.3159647522698377, 0.3194556489243874, 0.32304124427931485, 0.3267240985578744, 0.33050707514885924, 0.33439297391994083, 0.3383839618515475, 0.3424824761777381, 0.34669092650509575, 0.351011700367143, 0.3554477481971079, 0.3600022066505756, 0.36467644578419367, 0.3694728210602396, 0.3743936915522128, 0.3794414259131371, 0.38461840795578295, 0.38992704160225383, 0.3953697549145613, 0.4009508646485599, 0.40667140195994433, 0.4125334807152799, 0.41853956675270404, 0.4246921350385853, 0.4309936593663836, 0.43744659753040943, 0.4440533711015542, 0.45081633883461397, 0.4577377626480225, 0.46481976504714334, 0.4720642768256656, 0.4794729738954752, 0.48704720218658354, 0.49478788975543747, 0.502695445574845, 0.5107722312752203, 0.519017580722989, 0.527427047659408, 0.5359974387485315, 0.5447242959015132, 0.5536017493685389, 0.5626223858732353, 0.5717801732913298, 0.5810619798273547, 0.5904522695833789, 0.59993630566992, 0.6094978370184863, 0.6191178753985616, 0.6287753075069072, 0.6384515865712357, 0.6481275660781143, 0.6577845458065525, 0.667404707037929, 0.6769617561788033, 0.6864487597795673, 0.69585443145648, 0.7051685608468115, 0.71438302722636, 0.7234917624309317, 0.7324906484647774, 0.7413773645706981, 0.7501511992657797, 0.758812842117251, 0.7673641682613402, 0.7758080262912036, 0.7841480375461038, 0.7923777293356836, 0.800497630396886, 0.8085242857272323, 0.8164630734789561, 0.8243194501554684, 0.8320860387263339, 0.8397544323444477, 0.8473543986252204, 0.8548913210362115, 0.8623409541601502, 0.8697191661117473, 0.877047948076314, 0.8843061388708379, 0.8914967901846199, 0.898650661869968, 0.9057328617844135, 0.9127681739145864, 0.9197719823668247, 0.9266999503758118, 0.9336093927737403, 0.9404610328906413, 0.9472803518326599, 0.9540659681238263, 0.9608049809199471, 0.9675287370768705, 0.9741967269037245, 0.9808627042040826, 0.9874684104099173, 0.9940805805099583],\n  g: [0.09521591660747855, 0.0963511590972791, 0.09744967053737302, 0.09851521320092249, 0.09955275459284393, 0.10056873145593648, 0.10157135702513853, 0.10257097334218751, 0.10356584027704996, 0.10458024676581804, 0.1056380265564063, 0.10674165621081344, 0.10793563466790623, 0.10923866406414962, 0.11070429246224553, 0.1123613365530294, 0.1142804413027346, 0.11652515301133853, 0.1191682999758128, 0.12228861049996234, 0.1259620672997293, 0.13024864459406924, 0.1351768519397535, 0.14073088183460164, 0.14684331943301, 0.15340748473917706, 0.16029117959242076, 0.16736888953134454, 0.17452933124088685, 0.1816841459042555, 0.1887688275072176, 0.19573985804384908, 0.2025703385486159, 0.20924466230343952, 0.2157456284251405, 0.22208312061819008, 0.22825465182827054, 0.23426097673881258, 0.24011399581702425, 0.24581471938893312, 0.2513729453557033, 0.256799705029183, 0.2620915612909199, 0.2672655035330154, 0.2723273008096985, 0.2772789491245567, 0.2821282390686886, 0.2868831717247525, 0.29154887162812176, 0.2961302536799314, 0.30063184093875434, 0.3050562292020493, 0.3094102218220906, 0.3136977658751047, 0.3179225992994974, 0.3220882581897951, 0.3261980852298422, 0.3302552388254388, 0.3342627026038174, 0.33822329503101706, 0.34213967896327, 0.34601437099898574, 0.3498497505368459, 0.35364806847548513, 0.35741145551306436, 0.3611419300223894, 0.36484140549022287, 0.36851169751907215, 0.37215453039677776, 0.3757710087912915, 0.37936299913099886, 0.38293223649328834, 0.38648014137990283, 0.39000806896659534, 0.39351731349892055, 0.39700911235508674, 0.4004846497947374, 0.4039446967979293, 0.407390264684531, 0.4108228877965505, 0.41424356901188075, 0.41765327256964846, 0.4210529263321469, 0.4244432161011251, 0.42782466919265655, 0.43119871063381826, 0.4345661396549307, 0.4379277275711909, 0.44128421897143094, 0.4446356900078315, 0.44798348190176723, 0.45132831167041504, 0.45467082457551683, 0.4580115969309521, 0.46135071307922276, 0.46468936526295607, 0.4680281092699005, 0.47136747964858944, 0.47470770262422896, 0.478049331937957, 0.4813931150452206, 0.484739501366448, 0.48808883039949774, 0.49144122896414794, 0.4947975030047193, 0.49815801614320204, 0.5015231101060642, 0.5048927132825591, 0.5082675669534004, 0.5116479477164066, 0.5150341080561434, 0.5184259856373716, 0.5218241099237965, 0.5252286912572144, 0.5286398903414566, 0.5320576287402744, 0.535482279322358, 0.5389139515314046, 0.5423527133674996, 0.5457984712571944, 0.5492514494924778, 0.5527116487772891, 0.5561790393438252, 0.5596535532346759, 0.5631352211554989, 0.5666239548700177, 0.5701196510565367, 0.5736222405040751, 0.577131576635999, 0.5806474896434284, 0.5841698333340916, 0.5876984999166237, 0.5912331932277819, 0.5947736703172153, 0.598319767629138, 0.6018713111492172, 0.6054278820406325, 0.6089891735215488, 0.6125550130731925, 0.6161251617120728, 0.6196990932330638, 0.6232764459181283, 0.6268570181766053, 0.630440554670746, 0.634026414751126, 0.6376141889650659, 0.6412035896296302, 0.6447944545228799, 0.6483859905965969, 0.6519777450281342, 0.6555692556652558, 0.6591606030439278, 0.6627507929293074, 0.6663393219020087, 0.6699256847308839, 0.673509649075136, 0.6770906951012129, 0.680668005929282, 0.684241027807421, 0.6878091952372648, 0.6913723055472414, 0.6949295261702347, 0.6984800979280559, 0.7020233920397538, 0.7055587631720374, 0.7090857414439621, 0.7126036449951605, 0.7161115318028217, 0.7196086676710338, 0.7230942938245446, 0.7265676248366645, 0.7300279237012575, 0.7334743741555847, 0.7369059239634065, 0.7403216514270206, 0.7437205957454258, 0.7471017539541064, 0.7504640777072077, 0.7538064699246834, 0.7571277813375661, 0.760426747786949, 0.7637021069222052, 0.7669525443587899, 0.7701766751192416, 0.7733730477083216, 0.7765401418648604, 0.7796763669997492, 0.7827800615723168, 0.7858494937119429, 0.7888828634531383, 0.7918783070193569, 0.7948339036614173, 0.7977476856267914, 0.8006176519006482, 0.8034417864099652, 0.8062180814071851, 0.8089441566688712, 0.8116180108735556, 0.8142382455983396, 0.8168032862890818, 0.819311801237797, 0.8217627673204915, 0.8241555398979113, 0.8264893011624767, 0.828764813194564, 0.8309836316507101, 0.8331474672067843, 0.8352587020450518, 0.837320741926722, 0.8393379672623437, 0.8413146218129587, 0.843255556919926, 0.8451659780810963, 0.8470513147981416, 0.848919836337816, 0.850774894928254, 0.8526212799355241, 0.8544637256207057, 0.8563065614925247, 0.8581536540348341, 0.860008371786031, 0.8618735721244006, 0.8637516069265696, 0.8656443435632366, 0.8675531974405399, 0.8694791724028597, 0.8714229056785223, 0.8733886508286131, 0.8753781889640524, 0.8773871783186646, 0.8794151844938148, 0.8814616081475757, 0.8835308362945183, 0.8856278479633188, 0.8877421380157633, 0.8898726582646793, 0.8920307544658761, 0.8942111604773197, 0.8964055876253053, 0.8986242192828277, 0.9008669432468145, 0.9031210853874222, 0.9054032588350297, 0.9077032841253238, 0.9100148294768658, 0.9123594905222979, 0.9147111822755605, 0.9170893351552456, 0.9194825361628594, 0.9218921210725944, 0.9243252266483534, 0.9267668902399696, 0.929238214203635, 0.9317124815536733, 0.9342202886448684, 0.9367275819156851],\n  b: [0.42257292476430436, 0.43184596598336555, 0.4412064832719169, 0.4506510991070379, 0.4601751103492679, 0.46977222082107756, 0.4794342308257477, 0.4891506793097687, 0.49894160120778436, 0.5087715885336103, 0.5186108302832771, 0.5284836071020165, 0.5383245681077662, 0.5481352134375516, 0.5578435355461391, 0.5674471854200234, 0.5768505865319291, 0.5859821014031293, 0.5947494236872949, 0.6030366129604394, 0.6107077426144937, 0.6176174300439591, 0.6236290832033221, 0.6286357211183263, 0.6325796572366661, 0.6354701889106298, 0.6373742153046679, 0.6383989700654712, 0.638668756905635, 0.6383089542091028, 0.6374350053971095, 0.636146985204408, 0.6345282558695404, 0.6326478270215731, 0.6305768690676523, 0.6283455167242665, 0.6259979600528258, 0.6235717761795677, 0.621081667645192, 0.6185591936304666, 0.616016629522781, 0.6134596708213713, 0.6109238301118911, 0.6083965011432549, 0.6058873223830183, 0.60341417524383, 0.6009787922718963, 0.5985797542127682, 0.596221496217621, 0.5939076044300872, 0.5916414807294642, 0.5894315315373579, 0.5872714908845412, 0.5851627302038015, 0.5831062484926558, 0.5811027291021745, 0.5791525884087009, 0.5772560174768573, 0.5754130176762239, 0.5736234310853615, 0.5718869664041402, 0.5702032209969471, 0.5685716996038682, 0.5669918301827848, 0.5654629772812437, 0.5639844532816007, 0.5625555278152573, 0.5611754356007422, 0.5598433829250934, 0.5585612898846837, 0.5573268773673928, 0.5561380319387883, 0.5549938581786431, 0.5538934528024704, 0.5528359060062189, 0.5518203023495192, 0.5508457212473491, 0.549913365431319, 0.5490228475752887, 0.5481703859285302, 0.5473550236322454, 0.5465757987301746, 0.5458317432175193, 0.5451231873866257, 0.5444513010684173, 0.5438113725374379, 0.5432023919026625, 0.5426233385794481, 0.5420731800699918, 0.5415550926551251, 0.5410638066180113, 0.540597926876092, 0.5401563599016087, 0.5397383042732707, 0.5393460827274305, 0.5389744586257711, 0.5386222668134233, 0.5382883230992108, 0.5379733478625169, 0.5376757027790604, 0.5373922894579649, 0.5371218460871988, 0.5368636833242294, 0.536618361299776, 0.5363817525707026, 0.5361525222751042, 0.5359293193132266, 0.5357133548543864, 0.5355003101591437, 0.5352887824024628, 0.5350773667248226, 0.5348665525352745, 0.5346528031121535, 0.5344345169358407, 0.5342102605335537, 0.5339799959048033, 0.5337406085215398, 0.5334905459074958, 0.5332283775266504, 0.5329535750363619, 0.5326634150194081, 0.5323564832742772, 0.5320314302436226, 0.5316870266023981, 0.5313212748929952, 0.5309328290550865, 0.5305203252817071, 0.5300820599240353, 0.5296167282704776, 0.5291230766564496, 0.5285995915811124, 0.5280443921862177, 0.5274567814051943, 0.5268356212312693, 0.5261791312000029, 0.5254854952988165, 0.5247545535679302, 0.5239852980594518, 0.5231756545447472, 0.5223239185167129, 0.5214304767886039, 0.5204944566826074, 0.5195136536074572, 0.5184861377534478, 0.5174130230514244, 0.5162935692788782, 0.5151259285643696, 0.513906976489259, 0.5126390269795514, 0.5113214639163841, 0.5099537040511894, 0.5085297306531971, 0.5070537569679475, 0.5055253556302098, 0.5039440536705715, 0.5023062065413991, 0.5006109626120457, 0.49886092205559446, 0.4970557164988521, 0.49519500358009544, 0.49327320043306105, 0.49129274764094805, 0.4892553378582481, 0.4871607422199747, 0.4850087606010108, 0.48279556264598117, 0.4805201317683439, 0.4781864627637871, 0.4757945201032026, 0.47334431361562507, 0.47083590349003773, 0.4682667163182039, 0.46563433316514585, 0.46294412957653946, 0.4601965063235069, 0.4573919681273961, 0.45453113947832696, 0.45161478329337396, 0.4486438228496627, 0.4456193674826628, 0.4425380639654961, 0.4394056497009877, 0.4362249727525225, 0.4329983295596442, 0.42972840805534807, 0.42641834706043324, 0.4230718037095968, 0.4196930295353452, 0.4162869557148225, 0.41285928778106906, 0.4094166097874234, 0.4059664974607166, 0.40251763925076683, 0.39907996334425494, 0.39566476762665204, 0.3922848482216537, 0.3889513459863399, 0.38568043413774905, 0.3824934902796896, 0.3794106529717773, 0.3764539238160732, 0.373647073460407, 0.3710154595070918, 0.36858304535734304, 0.36637986074596723, 0.36443633829693634, 0.3627802030453921, 0.3614380620192426, 0.36043549828900656, 0.3597956834322973, 0.35953617653436143, 0.35967076687063276, 0.3602086612732602, 0.3611542742755426, 0.3625096347273936, 0.36426656411016184, 0.36641546843198697, 0.36894367860467714, 0.37183581727406156, 0.37507449518178715, 0.37864099375401244, 0.38251589762619864, 0.3866796514151401, 0.39111302579861484, 0.3957974875667233, 0.40071547599054824, 0.405850593321366, 0.4111824877427081, 0.41669355606115976, 0.4223760515178233, 0.4282186311869483, 0.4342112747863317, 0.44033584973804246, 0.44657231853713225, 0.45293066342084337, 0.4594053245849991, 0.46596504038120606, 0.4726125804953009, 0.47935960153209206, 0.48617718269199267, 0.4930589607663434, 0.5000298200873778, 0.5070444917818385, 0.5141229319104883, 0.5212774789419143, 0.5284479861571415, 0.535698951997222, 0.5429753047678268, 0.5503044468166357, 0.5576799909240343, 0.5650790057480892, 0.572541386344326, 0.5800041593344547, 0.5875425838151492, 0.5950648878797101, 0.6026699962989522],\n};\n","\nimport { magma } from \"./magma\";\nimport { inferno } from \"./inferno\";\nimport { plasma } from \"./plasma\";\nimport { viridis } from \"./viridis\";\nimport { cividis } from \"./cividis\";\nimport { gray } from \"./gray\";\nimport { svs_nitrogen_dioxide, svsColorRamp } from \"./svs_nitrogen_dioxide\";\nimport { sargassum, sargassumColorRamp } from \"./sargassum\";\nimport { haline } from \"./cmo_haline\";\n\nimport type { ColorMaps } from \"./types\";\n\nexport const colormaps: ColorMaps = {\n  \"magma\": magma,\n  \"inferno\": inferno,\n  \"plasma\": plasma,\n  \"viridis\": viridis,\n  \"cividis\": cividis,\n  \"svs\": svs_nitrogen_dioxide,\n  \"sargassum\": sargassum,\n  \"gray\": gray,\n  \"haline\": haline,\n};\n\n// add custom colormaps here\nexport const nonEsriColormaps = {\n  'svs': {rgb: svs_nitrogen_dioxide, esriColorRamp: svsColorRamp},\n  'sargassum': {rgb: sargassum, esriColorRamp: sargassumColorRamp},\n};\n\nexport type AvailableColorMaps = 'magma' | 'inferno' | 'plasma' | 'viridis' | 'cividis' | 'svs' | 'gray' | 'sargassum' | 'haline';\nexport type AvailableReverseColorMaps = `${AvailableColorMaps}_r`;\nexport type AllAvailableColorMaps = AvailableColorMaps | AvailableReverseColorMaps | 'None';\n","/* eslint-disable @typescript-eslint/naming-convention */\n\n\n// const earthdataRestSerivceURL = \"https://gis.earthdata.nasa.gov/image/rest/services/C2930763263-LARC_CLOUD/TEMPO_NO2_L3_V03_HOURLY_TROPOSPHERIC_VERTICAL_COLUMN/ImageServer\";\nimport { Variables } from './types';\n\nexport type ColorRamps = \"Magma\" | \"Inferno\" | \"Plasma\" | \"Viridis\" | \"Gray\" | \"Hillshade\" | \"Cividis\" | \"SVS\" | \"sargassum\";\n\ntype PixelType = \"C128\" | \"C64\" | \"F32\" | \"F64\" | \"S16\" | \"S32\" | \"S8\" | \"U1\" | \"U16\" | \"U2\" | \"U32\" | \"U4\" | \"U8\" | \"UNKNOWN\";\n\ninterface RasterFunctionObject {\n  rasterFunction: string;\n  variableName?: string; // Optional, as it might be implied or set by composition\n  rasterFunctionArguments?: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    [key: string]: any;\n    Raster?: RasterFunctionObject | { variableName: string }; // Input can be another function or the base 'Raster'\n  };\n  outputPixelType?: PixelType;\n}\n\n// https://developers.arcgis.com/rest/services-reference/enterprise/raster-function-objects/\n// https://developers.arcgis.com/rest/services-reference/enterprise/raster-function-objects/#resample\nexport function _stretchRule(min: number, max: number): RasterFunctionObject {\n  return {\n    'rasterFunction': 'Stretch',\n    'outputPixelType': 'U8' as PixelType,\n    'variableName': 'Raster',\n    'rasterFunctionArguments': {\n      'StretchType': 5,\n      'Statistics': [[\n        min, // max\n        max, // min\n        0, 0\n      ]],\n      'DRA': false,\n      'UseGamma': false,\n      'Gamma': [1],\n      'ComputeGamma': true,\n      'Min': 255,\n      'Max': 0\n    },\n  };\n}\n\nexport const stretches = {\n  'NO2_Troposphere': [0, 15000000000000000],\n  'Ozone_Column_Amount': [250, 430], // +- 2 sigma\n  'HCHO': [0, 50000000000000000],\n} as Record<Variables, [number, number]>;\nexport const colorramps = {\n  'NO2_Troposphere': 'Magma',\n  'Ozone_Column_Amount': 'Cividis', \n  'HCHO': 'Viridis',\n} as Record<Variables, ColorRamps>;\n\nexport const colorbarOptions = {\n  'no2': {stretch: stretches['NO2_Troposphere'], cbarScale: 1e14, colormap: colorramps['NO2_Troposphere'] + '_r', label:'NO<sub>2</sub>&nbsp;&nbsp;'},\n  'no2Monthly': {stretch: stretches['NO2_Troposphere'], cbarScale: 1e14, colormap: colorramps['NO2_Troposphere'] + '_r', label: 'NO<sub>2</sub>&nbsp;&nbsp;'},\n  'no2DailyMax': {stretch: stretches['NO2_Troposphere'], cbarScale: 1e14, colormap: colorramps['NO2_Troposphere'] + '_r', label: 'NO<sub>2</sub>&nbsp;&nbsp;'},\n  'o3': {stretch: stretches['Ozone_Column_Amount'], cbarScale: 1, colormap: colorramps['Ozone_Column_Amount'] + '_r', label: 'Ozone&nbsp;'},\n  'hcho': {stretch: stretches['HCHO'], cbarScale: 1e14, colormap: colorramps['HCHO'] + '_r', label: 'Formaldehyde&nbsp;&nbsp;'},\n  'hchoMonthly': {stretch: stretches['HCHO'], cbarScale: 1e14, colormap: colorramps['HCHO'] + '_r', label: 'Formaldehyde&nbsp;&nbsp;'},\n  'hchoDailyMax': {stretch: stretches['HCHO'], cbarScale: 1e14, colormap: colorramps['HCHO'] + '_r', label: 'Formaldehyde&nbsp;&nbsp;'},\n};\n\nimport { nonEsriColormaps } from '@/colormaps';\n\n\nexport function _colorMapRule(colorRamp: ColorRamps): RasterFunctionObject {\n  if (Object.keys(nonEsriColormaps).includes((colorRamp as string).toLowerCase())) {\n    return {\n      'rasterFunction': 'Colormap',\n      'variableName': 'Raster',\n      'rasterFunctionArguments': {\n        'colorramp': nonEsriColormaps[colorRamp.toLowerCase()].esriColorRamp,\n      },\n    };\n  }\n  return {\n    'rasterFunction': 'Colormap',\n    'variableName': 'Raster',\n    'rasterFunctionArguments': {\n      'ColormapName': colorRamp,\n    },\n  };\n}\n\nexport type ResamplingType = '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' ; \n//0=NearestNeighbor, 1=Bilinear, 2=Cubic, 3=Majority, 4=BilinearInterpolationPlus, 5=BilinearGaussBlur, 6=BilinearGaussBlurPlus, 7=Average, 8=Minimum, 9=Maximum\n\nexport enum ResamplingTypeEnum {\n  NearestNeighbor = '0',\n  Bilinear = '1',\n  Cubic = '2',\n  Majority = '3',\n  BilinearInterpolationPlus = '4',\n  BilinearGaussBlur = '5',\n  BilinearGaussBlurPlus = '6',\n  Average = '7',\n  Minimum = '8',\n  Maximum = '9'\n}\n\n\n// Generated by Copilot\nexport function _resampleRule(resamplingType: keyof typeof ResamplingTypeEnum): RasterFunctionObject {\n  return {\n    'rasterFunction': 'Resample',\n    'variableName': 'Raster',\n    'rasterFunctionArguments': {\n      'ResamplingType': ResamplingTypeEnum[resamplingType], // Convert string to enum value\n    },\n  };\n}\n\n\nexport function composeRasterRules(\n  baseRule: RasterFunctionObject,\n  additionalRules: RasterFunctionObject[]\n): RasterFunctionObject {\n  let currentRule: RasterFunctionObject = { ...baseRule };\n\n\n  for (let i = 0; i < additionalRules.length; i++) {\n    const nextOuterRule = { ...additionalRules[i] }; // Copy to avoid modifying original rule objects\n\n    // Ensure rasterFunctionArguments exists\n    if (!nextOuterRule.rasterFunctionArguments) {\n      nextOuterRule.rasterFunctionArguments = {};\n    }\n\n    // Assign the current (inner) rule as the 'Raster' input to the next outer rule.\n    nextOuterRule.rasterFunctionArguments.Raster = currentRule;\n\n    currentRule = nextOuterRule; // The newly composed rule becomes the current one for the next iteration\n  }\n\n  return currentRule;\n}\n\nexport const renderingRule = (range: [number, number], colormap: ColorRamps, resamplineRule: keyof typeof ResamplingTypeEnum = 'NearestNeighbor') => \n  composeRasterRules(_stretchRule(Math.min(...range), Math.max(...range)), [_colorMapRule(colormap), _resampleRule(resamplineRule)]);\n\nexport interface RenderingRuleOptions {\n  range: [number, number];\n  colormap: ColorRamps;\n}\n\ninterface MultidimensionalDefinition {\n  variableName: string;\n  dimensionName: string;\n  values: number[] | Array<number[]>;\n}\n\n\n\nexport interface EsriSlice {\n  sliceId: number;\n  multidimensionalDefinition: MultidimensionalDefinition[];\n}\n\nexport interface EsriSliceResponse {\n  slices: EsriSlice[];\n}\n\n\nexport type VariableNames = 'NO2_Troposphere' | 'Ozone_Column_Amount' | 'HCHO';\n\nexport async function fetchEsriTimeSteps(esriUrl: string, variableName: VariableNames, dimensionName = \"StdTime\"): Promise<EsriSliceResponse> {\n  const url = esriUrl + '/slices';\n  const format = \"json\";\n  const multidimensionalDefinition = { variableName: variableName, dimensionName: dimensionName };\n  const params = { f: format, multidimensionalDefinition: JSON.stringify(multidimensionalDefinition) };\n  const fetchURL = new URL(url);\n  fetchURL.search = new URLSearchParams(params).toString();\n  return fetch(fetchURL).then(res => {\n    return res.json();\n  });\n}\n\nexport function extractTimeSteps(data: EsriSliceResponse): number[] {\n  const slices = data.slices;\n  const timesteps = slices.map(slice => slice.multidimensionalDefinition[0].values[0]);\n  // check if timesteps are arrays or numbers. if arrays take first element of each\n\n\n  return timesteps.reduce((acc: number[], val) => {\n    if (Array.isArray(val)) {\n      return acc.concat(val[0]);\n    } else {\n      acc.push(val);\n      return acc;\n    }\n  }, []);\n}\n","import { extractTimeSteps, fetchEsriTimeSteps, VariableNames } from \"./ImageLayerConfig\";\n\nexport const ESRI_URLS = {\n  'no2': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C2930763263-LARC_CLOUD/TEMPO_NO2_L3_V03_HOURLY_TROPOSPHERIC_VERTICAL_COLUMN/ImageServer\",\n    variable: \"NO2_Troposphere\",\n  },\n  'no2Monthly': {\n    url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_NO2_L3_V03_Monthly_Mean/ImageServer\",\n    variable: \"NO2_Troposphere\",\n  },\n  'no2DailyMax' : {\n    url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_NO2_L3_V03_Daily_Maximum/ImageServer\",\n    variable: \"NO2_Troposphere\",\n  },\n  'o3': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C2930764281-LARC_CLOUD/TEMPO_O3TOT_L3_V03_HOURLY_OZONE_COLUMN_AMOUNT/ImageServer\",\n    variable: \"Ozone_Column_Amount\",\n  },\n  'hcho': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C2930761273-LARC_CLOUD/TEMPO_HCHO_L3_V03_HOURLY_VERTICAL_COLUMN/ImageServer\",\n    variable: \"HCHO\",\n  },\n  'hchoMonthly': {\n    url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_HCHO_L3_V03_Monthly_Mean/ImageServer\",\n    variable: \"HCHO\",\n  },\n  'hchoDailyMax': {\n    url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_HCHO_L3_V03_Daily_Maximum/ImageServer\",\n    variable: \"HCHO\",\n  },\n} as Record<string, { url: string; variable: VariableNames }>;\n\nexport const MOLECULE_OPTIONS = [\n  { title: 'NO', value: 'no2' },\n  { title: 'Monthly Mean NO', value: 'no2Monthly' },\n  { title: 'Daily Max NO', value: 'no2DailyMax' },\n  { title: 'O', value: 'o3' },\n  { title: 'HCHO', value: 'hcho' },\n  { title: 'Monthly Mean HCHO', value: 'hchoMonthly' },\n  { title: 'Daily Max HCHO', value: 'hchoDailyMax' },\n] as const;\n\nexport type MoleculeType = keyof typeof ESRI_URLS;\n\nexport function moleculeName(molecule: MoleculeType): string {\n  return MOLECULE_OPTIONS.find(m => m.value == molecule)?.title ?? \"\";\n}\n\nexport async function getEsriTimesteps(url: string, variable: VariableNames): Promise<number[]> {\n  return fetchEsriTimeSteps(url, variable).then(extractTimeSteps);\n}\n","export type EsriGeometryType = 'esriGeometryPoint' | 'esriGeometryMultipoint' | 'esriGeometryPolyline' | 'esriGeometryPolygon' | 'esriGeometryEnvelope';\n\nexport type RectBounds = {\n  xmin: number;\n  ymin: number;\n  xmax: number;\n  ymax: number;\n};\n\nexport type PointBounds = {\n  x: number;\n  y: number;\n};\nexport function rectangleToGeometry(rect: RectBounds) {\n  const { xmin, ymin, xmax, ymax } = rect;\n  return {\n    rings: [[\n      [xmin, ymin],\n      [xmin, ymax],\n      [xmax, ymax],\n      [xmax, ymin],\n      [xmin, ymin]\n    ]],\n    spatialReference: { wkid: 4326 } // Assuming WGS 84\n    // spatialReference: { wkid: 3857 } // Web Mercator. idk if this really matters for points\n  };\n}\n\nexport function pointToGeometry(point: PointBounds) {\n  const { x, y } = point;\n  return {\n    x: x,\n    y: y,\n    spatialReference: { wkid: 4326 } // Assuming WGS 84\n    // spatialReference: { wkid: 3857 } // Web Mercator. idk if this really matters for points\n  };\n}","export function isBad(v: number | null | undefined): v is null | undefined {\n  return v === null || v === undefined || isNaN(v);\n}\n\nexport function nan2null(v: number | null): number | null {\n  return isBad(v) ? null : v;\n}\n\n\n// typeof NaN is 'number'. Just included here \ntype DirtyNumberArray = Array<number | null | typeof NaN | undefined>;\n\nfunction _getValidData(arr: DirtyNumberArray) {\n  const validArr: number[] = [];\n  let sum = 0;\n  for (const v of arr) {\n    if (!isBad(v)) {\n      validArr.push(v);\n      sum += v;\n    }\n  }\n  return { validArr, sum, length: validArr.length };\n}\n\nfunction _length(arr: DirtyNumberArray): number {\n  return arr.length;\n}\n\nfunction _nanLength(arr: DirtyNumberArray): number {\n  return arr.filter(v => !isBad(v)).length;\n}\n\nexport function sum(arr: DirtyNumberArray): number | null {\n  if (arr.length === 0 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  return (arr as number[]).reduce((a, b) => a + b, 0);\n}\n\nexport function nansum(arr: DirtyNumberArray): number {\n  const { sum } = _getValidData(arr);\n  return sum;\n}\n\nexport function mean(arr: DirtyNumberArray): number | null {\n  // filter nan, null, undefined\n  if (arr.length === 0 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  const sum = (arr as number[]).reduce((a, b) => a + b, 0);\n  return sum / arr.length;\n}\n\nexport function nanmean(_arr: DirtyNumberArray): number | null {\n  const { sum, length } = _getValidData(_arr);\n  if (length === 0) return null;\n  return sum / length;\n}\n\nexport function difference(a: number | null | undefined, b: number | null | undefined): number | null {\n  if (isBad(a) || isBad(b)) return null;\n  return a - b;\n}\n\nexport function diff(arr: DirtyNumberArray): (number | null)[] {\n  const result: (number | null)[] = [];\n  for (let i = 1; i < arr.length; i++) {\n    result.push(difference(arr[i],arr[i - 1]));\n  }\n  return result;\n}\n\n\nexport function variance(arr: DirtyNumberArray): number | null {\n  if (arr.length < 2 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  const m = mean(arr);\n  if (m === null) return null;\n  const diffs = (arr as number[]).map(v => (v - m) * (v - m));\n  return mean(diffs); // mean = sum(diffs) / n\n}\n\nexport function stdev(arr: DirtyNumberArray): number | null {\n  const v = variance(arr);\n  if (v === null) return null;\n  return Math.sqrt(v);\n}\n\nexport function standardError(arr: DirtyNumberArray): number | null {\n  const s = stdev(arr);\n  return s ? s / Math.sqrt(arr.length) : null;\n}\n\nexport function nanvariance(arr: DirtyNumberArray): number | null {\n  const { validArr, length } = _getValidData(arr);\n  if (length < 2) {\n    return null;\n  }\n  const m = nanmean(validArr);\n  if (m === null) return null;\n  const diffs = validArr.map(v => (v - m) * (v - m));\n  const result = nanmean(diffs);\n  return result;\n}\n\n\nexport function nanstdev(arr: DirtyNumberArray): number | null {\n  const v = nanvariance(arr);\n  if (v === null) return null;\n  return Math.sqrt(v);\n}\n\nexport function nanstandardError(arr: DirtyNumberArray): number | null {\n  const stdev = nanstdev(arr);\n  const length = _nanLength(arr);\n  if (stdev === null || length === 0) return null;\n  return stdev / Math.sqrt(length);\n}\n\nexport function median(arr: DirtyNumberArray): number | null {\n  if (arr.length === 0 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  const sorted = [...(arr as number[])].sort((a, b) => a - b);\n  const mid = Math.floor(sorted.length / 2);\n  \n  if (sorted.length % 2 === 0) {\n    return (sorted[mid - 1] + sorted[mid]) / 2;\n  } else {\n    return sorted[mid];\n  }\n}\n\nexport function nanmedian(arr: DirtyNumberArray): number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  return median(validArr);\n}\n\nexport function nanmedianAbsoluteDeviation(arr: DirtyNumberArray): number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  const med = median(validArr);\n  if (med === null) return null;\n  const absDevs = validArr.map(v => Math.abs(v - med));\n  return median(absDevs);\n}\n\nexport function mad(arr: number[]): number;\nexport function mad(arr: DirtyNumberArray): number | null {\n  const med = median(arr);\n  if (med === null) return null;\n  const absDevs = (arr as number[]).map(v => Math.abs(v - med));\n  return median(absDevs);\n}\n\nexport function nanmad(arr: DirtyNumberArray): number | null {\n  return nanmedianAbsoluteDeviation(arr);\n}\n\n\nexport function arrayMax(arr: number[]): number | null {\n  if (arr.length === 0) {\n    return null;\n  }\n\n  return arr.reduce((max, current) => {\n    return current > max ? current : max;\n  });\n}\n\nexport function arrayMin(arr: number[]): number | null {\n  if (arr.length === 0) {\n    return null;\n  }\n\n  return arr.reduce((min, current) => {\n    return current < min ? current : min;\n  });\n}\n\nexport function nanmin(arr: DirtyNumberArray, returnIndex: true): { value: number, index: number } | null;\nexport function nanmin(arr: DirtyNumberArray, returnIndex?: false): number | null;\nexport function nanmin(arr: DirtyNumberArray, returnIndex = false): { value: number, index: number } | number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  if (!returnIndex) {\n    return arrayMin(validArr);\n  } else {\n    const r = validArr.reduce((min, val, idx) => val < min.value ? { value: val, index: idx } : min, { value: validArr[0], index: 0 });\n    return r;\n  }\n}\n\nexport function nanmax(arr: DirtyNumberArray, returnIndex: true): { value: number, index: number } | null;\nexport function nanmax(arr: DirtyNumberArray, returnIndex?: false): number | null;\nexport function nanmax(arr: DirtyNumberArray, returnIndex = false): { value: number, index: number } | number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  if (!returnIndex) {\n    return arrayMax(validArr);\n  } else {\n    const r = validArr.reduce((max, val, idx) => val > max.value ? { value: val, index: idx } : max, { value: validArr[0], index: 0 });\n    return r;\n  }\n}\n\n\n\n// Combining errors in quadrature\nexport function sumOfSquares(arr: number[]): number {\n  return arr.reduce((acc, val) => acc + val * val, 0);\n}\n\nexport function nanSumOfSquares(arr: DirtyNumberArray): number {\n  const { validArr } = _getValidData(arr);\n  return sumOfSquares(validArr);\n}\n\nexport function meanOfSquares(arr: DirtyNumberArray): number | null {\n  const { validArr, length } = _getValidData(arr);\n  if (length === 0) return null;\n  return sumOfSquares(validArr) / length;\n}\nexport function nanMeanOfSquares(arr: DirtyNumberArray): number | null {\n  const { validArr, length } = _getValidData(arr);\n  if (length === 0) return null;\n  return sumOfSquares(validArr) / length;\n}\n\nexport function rootMeanSquare(arr: DirtyNumberArray): number | null{\n  const ms = meanOfSquares(arr);\n  if (ms === null) return null;\n  return Math.sqrt(ms);\n}\n\nexport function nanRootMeanSquare(arr: DirtyNumberArray): number | null {\n  const ms = nanMeanOfSquares(arr);\n  if (ms === null) return null;\n  return Math.sqrt(ms);\n}\n\nexport function weightedMean(values: DirtyNumberArray, errors: DirtyNumberArray): {mean: number | null, error: number | null} {\n  if (values.length === 0 || values.length !== errors.length) {\n    return {mean: null, error: null};\n  }\n  let weightedSum = 0;\n  let weightTotal = 0;\n  for (let i = 0; i < values.length; i++) {\n    const v = values[i];\n    const e = errors[i];\n    if (isBad(v) || isBad(e) || e === 0) {\n      continue; // skip bad values or zero error\n    }\n    const weight = 1 / (e * e);\n    weightedSum += v * weight;\n    weightTotal += weight;\n  }\n  if (weightTotal === 0) return {mean: null, error: null};\n  return {mean: weightedSum / weightTotal, error: Math.sqrt(1 / weightTotal)};\n} \n\nexport function clip(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\nexport function allEqual<T>(arr: T[]): boolean {\n  if (arr.length === 0) return true;\n  const first = arr[0];\n  return arr.every(v => v === first);\n}","// algorithm to predict how esri will sample the region\nimport { RectBounds } from \"../geometry\";\nimport { EsriImageServiceSpec } from \"../types\";\n\nexport class EsriSampler {\n  public metadata: EsriImageServiceSpec | undefined;\n  public geometry: RectBounds | undefined;\n  public serviceBounds: RectBounds;\n  public pixelXSize: number;\n  public pixelYSize: number;\n  private serviceXsize: number;\n  private serviceYsize: number;\n  \n    \n  constructor(\n    serviceMetaData: EsriImageServiceSpec, \n    geometry?: RectBounds\n  ) {\n    this.metadata = serviceMetaData;\n    this.geometry = geometry;\n    \n    this.serviceBounds = {\n      xmin: serviceMetaData.fullExtent.xmin,\n      ymin: serviceMetaData.fullExtent.ymin,\n      xmax: serviceMetaData.fullExtent.xmax,\n      ymax: serviceMetaData.fullExtent.ymax\n    };\n    \n    this.pixelXSize = serviceMetaData.pixelSizeX;\n    this.pixelYSize = serviceMetaData.pixelSizeY;\n    this.serviceXsize = this.serviceBounds.xmax - this.serviceBounds.xmin;\n    this.serviceYsize = this.serviceBounds.ymax - this.serviceBounds.ymin;\n  }\n  \n  setGeometry(geometry: RectBounds) {\n    // this.geometry = {\n    //   xmin: Math.min(geometry.xmin, geometry.xmax),\n    //   ymin: Math.min(geometry.ymin, geometry.ymax),\n    //   xmax: Math.max(geometry.xmin, geometry.xmax),\n    //   ymax: Math.max(geometry.ymin, geometry.ymax)\n    // };\n    this.geometry = geometry; // we need to maintain the orientation\n    // the orientation affects the sampling locations.\n  }\n  \n  // not the geometry X and Y size are signed. \n  // It is not garunteed that xmax > xmin or ymax > ymin\n  // The Esri Image ser\n  get geometryXsize(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    return (this.geometry.xmax - this.geometry.xmin);\n  }\n  \n  get geometryYsize(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    return (this.geometry.ymax - this.geometry.ymin);\n  }\n  \n  setMetadata(serviceMetaData: EsriImageServiceSpec) {\n    this.metadata = serviceMetaData;\n    this.serviceBounds = {\n      xmin: serviceMetaData.fullExtent.xmin,\n      ymin: serviceMetaData.fullExtent.ymin,\n      xmax: serviceMetaData.fullExtent.xmax,\n      ymax: serviceMetaData.fullExtent.ymax\n    }  ;\n    this.pixelXSize = serviceMetaData.pixelSizeX;\n    this.pixelYSize = serviceMetaData.pixelSizeY;\n    this.serviceXsize = this.serviceBounds.xmax - this.serviceBounds.xmin;\n    this.serviceYsize = this.serviceBounds.ymax - this.serviceBounds.ymin;\n  }  \n  \n  get geometryAspectRatio(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    const latSize = Math.abs(this.geometry.ymax - this.geometry.ymin);\n    const lonSize = Math.abs(this.geometry.xmax - this.geometry.xmin);\n    return lonSize / latSize;\n  }\n  \n  get geometryArea(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    const latSize = Math.abs(this.geometry.ymax - this.geometry.ymin);\n    const lonSize = Math.abs(this.geometry.xmax - this.geometry.xmin);\n    return latSize * lonSize;\n  }\n  \n  getSampleDistance(sampleCount: number): number {\n    return Math.sqrt(this.geometryArea) / Math.sqrt(sampleCount);\n  }\n  \n  getSampleCount(sampleDistance: number): number {\n    return this.geometryArea / (sampleDistance * sampleDistance);\n  }\n  \n  get pixelSize(): number {\n    return Math.sqrt(this.pixelXSize * this.pixelYSize);\n  }\n  \n  calculateActualSampleCount(initialSampleCount: number): number {\n    let sampleDistance = this.getSampleDistance(initialSampleCount);\n    \n    if (sampleDistance < this.pixelSize) {\n      console.log(`Requested sample distance (${sampleDistance}) is smaller than pixel size, adjusting to pixel size`);\n      sampleDistance = this.pixelSize;\n      console.log('Adjusted sample distance:', sampleDistance);\n    }\n\n    const nx = Math.round(Math.abs(this.geometryXsize) / sampleDistance);\n    const ny = Math.round(Math.abs(this.geometryYsize) / sampleDistance);\n    const actualSampleCount = nx * ny;\n    return actualSampleCount;\n  }\n  \n  getSamplingSpecificationFromSamplingDistance(sampleDistance: number) {\n    const nx = Math.round(Math.abs(this.geometryXsize) / sampleDistance);\n    const ny = Math.round(Math.abs(this.geometryYsize) / sampleDistance);\n    const count = nx * ny;\n    return {\n      count,\n      distance: sampleDistance,\n      lats: ny,\n      lons: nx\n    };\n  }\n  \n  getSamplingSpecificationFromSampleCount(initialSampleCount: number, permitOversampling: boolean = false) {\n    let sampleDistance = this.getSampleDistance(initialSampleCount);\n    \n    if ((sampleDistance < this.pixelSize) && !permitOversampling) {\n      console.log(`Requested sample distance (${sampleDistance}) is smaller than pixel size, adjusting to pixel size`);\n      const adjustedSampleCount = this.getSamplingSpecificationFromSamplingDistance(this.pixelSize).count;\n      console.log('Adjusted sample count:', adjustedSampleCount);\n      sampleDistance = this.getSampleDistance(adjustedSampleCount);\n    }\n\n    return this.getSamplingSpecificationFromSamplingDistance(sampleDistance);\n    \n  }\n  \n  \n  /** \n  Predict the sampling locations based on the geometry and metadata\n  Returns an object with x and y arrays of sampling locations\n  \n  Esri seems to always sample starting from the upper-left corner.\n  **/\n  getSampleLocations(sampleCount: number) {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n\n    const spec = this.getSamplingSpecificationFromSampleCount(sampleCount);\n    console.log('Sampling spec:', spec);\n    const lats: number[] = [];\n    const lons: number[] = [];\n    const _ysign = Math.sign(this.geometryXsize);\n    const _xsign = Math.sign(this.geometryXsize);\n    \n    // spacing function for each sample\n    const delta = (i: number) => i * spec.distance + spec.distance / 2;\n\n    for (let i = 0; i < spec.lats; i++) {\n      lats.push(Math.max(this.geometry.ymin, this.geometry.ymax) - delta(i));\n    }\n    for (let j = 0; j < spec.lons; j++) {\n      lons.push(Math.min(this.geometry.xmin, this.geometry.xmax) + delta(j));\n    }\n    return {x: lons, y: lats, spec: spec};\n    \n  }\n  \n  getSampleLocationsGrid(sampleCount: number) {\n    const locations = this.getSampleLocations(sampleCount);\n    console.log(this.getSamplingSpecificationFromSampleCount(locations.spec.count));\n    const points: {x: number, y: number}[] = [];\n    for (let i = 0; i < locations.x.length; i++) {\n      for (let j = 0; j < locations.y.length; j++) {\n        points.push({x: locations.x[i], y: locations.y[j]});\n      }\n    }\n    return points;\n  }\n  \n}","// Generated by Copilot\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { getTimezoneOffset } from 'date-fns-tz';\nimport type { MillisecondRange } from '../../types';\n\n/**\n * TimeRangeOffsetter class for converting UTC time ranges to local time ranges\n * based on a specified timezone.\n * \n * Purpose: Time ranges are defined in UTC (e.g., \"12pm every Monday UTC\").\n * When fetching data for a specific region, we need to offset these ranges\n * to local time so that \"12pm\" corresponds to 12pm in the region's timezone\n * (e.g., 12pm ET, 12pm PT, etc.).\n */\nexport class TimeRangeOffsetter {\n  private timezone: string;\n\n  constructor(timezone: string) {\n    this.timezone = timezone;\n  }\n\n\n  private getOffsetMs(timestamp: number): number {\n    return getTimezoneOffset(this.timezone, new Date(timestamp));\n  }\n\n  \n  offsetRange(utcRange: MillisecondRange): MillisecondRange {\n\n    const offsetMs = this.getOffsetMs(utcRange.start);\n    // this is gonna be a problem if the range crosses a DST boundary ~ doop dee doo for now we ignore that\n    // TODO: handle DST boundary crossing\n    const localStart = utcRange.start - offsetMs;\n    const localEnd = utcRange.end - offsetMs;\n\n    return {\n      start: localStart,\n      end: localEnd\n    };\n  }\n\n  offsetRanges(utcRanges: MillisecondRange[]): MillisecondRange[] {\n    return utcRanges.map(range => this.offsetRange(range));\n  }\n\n  crossesDSTBoundary(range: MillisecondRange): boolean {\n    const startOffset = this.getOffsetMs(range.start);\n    const endOffset = this.getOffsetMs(range.end);\n    return startOffset !== endOffset;\n  }\n\n  splitRangeAtDSTBoundary(range: MillisecondRange): MillisecondRange[] {\n    // Future implementation: Binary search to find the exact DST transition point\n    // For now, just return the original range\n    console.warn('DST boundary crossing detected but not yet handled. Range:', range);\n    return [range];\n  }\n\n\n  offsetRangesWithDSTHandling(utcRanges: MillisecondRange[]): MillisecondRange[] {\n    const result: MillisecondRange[] = [];\n\n    for (const range of utcRanges) {\n      if (this.crossesDSTBoundary(range)) {\n        // Split and offset each part\n        const splitRanges = this.splitRangeAtDSTBoundary(range);\n        splitRanges.forEach(splitRange => {\n          result.push(this.offsetRange(splitRange));\n        });\n      } else {\n        // Offset the whole range\n        result.push(this.offsetRange(range));\n      }\n    }\n\n    return result;\n  }\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { rectangleToGeometry, pointToGeometry } from '../geometry';\nimport type { RectBounds, PointBounds, EsriGeometryType } from '../geometry';\nimport type { \n  EsriGetSamplesReturn, \n  EsriGetSamplesReturnError, \n  EsriGetSamplesSample, \n  Variables, \n  EsriInterpolationMethod, \n  CEsriTimeseries, \n  EsriImageServiceSpec,\n} from '../types';\nimport type { AggValue, DataPointError, MillisecondRange } from \"../../types\";\nimport {nanmean, diff} from '../../utils/array_operations/array_math';\nimport { EsriSampler } from './sampling';\n\nimport { TimeRangeOffsetter } from './TimeRangeOffsetter';\nimport tz_lookup from '@photostructure/tz-lookup';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface FetchOptions {\n  sampleCount?: number;\n  interpolation?: EsriInterpolationMethod;\n  returnFirstValueOnly?: boolean;\n  outFields?: string | string[];\n  sliceID?: string | number;\n}\n\n\nexport type TimeRanges = MillisecondRange | MillisecondRange[];\n\nexport interface RawSampleData {\n  samples: CEsriTimeseries[];\n  metadata: {\n    totalSamples: number;\n    timeRange: MillisecondRange | MillisecondRange[];\n    geometry: RectBounds | PointBounds;\n    geometryType: 'rectangle' | 'point';\n  };\n}\n\nexport interface TimeSeriesData {\n  values: Record<number, AggValue>;\n  errors: Record<number, DataPointError>;\n  locations: Array<{ x: number; y: number }>;\n  geometryType: 'rectangle' | 'point';\n}\n\n// ============================================================================\n// UTILITY FUNCTIONS\n// ============================================================================\n\nfunction safeParseNumber(value: string | null | undefined): number | null {\n  if (value === null || value === '' || value === undefined) return null;\n  const parsed = parseFloat(value);\n  return isNaN(parsed) ? null : parsed;\n}\n\nfunction stringifyEsriGetSamplesParameters(params: {\n  geometry: ReturnType<typeof rectangleToGeometry> | ReturnType<typeof pointToGeometry>;\n  geometryType: EsriGeometryType;\n  sampleDistance?: number;\n  sampleCount?: number;\n  mosaicRule?: string | Record<string, unknown>;\n  pixelSize?: number;\n  returnFirstValueOnly?: boolean;\n  interpolation: EsriInterpolationMethod;\n  outFields?: string | string[];\n  sliceID?: string | number;\n  time?: string | [number, number] | [Date, Date];\n  f: 'pjson';\n}): URLSearchParams {\n  const {\n    geometry,\n    geometryType,\n    sampleDistance,\n    sampleCount,\n    mosaicRule,\n    pixelSize,\n    returnFirstValueOnly,\n    interpolation,\n    outFields,\n    sliceID,\n    time,\n  } = params;\n  \n  const options: Record<string, string> = {\n    f: 'pjson',\n    geometry: JSON.stringify(geometry),\n    geometryType: geometryType,\n    interpolation: interpolation,\n  };\n\n  if (sampleDistance) options.sampleDistance = sampleDistance.toString();\n  if (sampleCount) options.sampleCount = sampleCount.toString();\n  if (mosaicRule) options.mosaicRule = JSON.stringify(mosaicRule);\n  if (pixelSize) options.pixelSize = pixelSize.toString();\n  if (returnFirstValueOnly !== undefined) options.returnFirstValueOnly = returnFirstValueOnly.toString();\n  if (outFields) options.outFields = Array.isArray(outFields) ? outFields.join(',') : outFields;\n  if (sliceID !== undefined) options.sliceID = sliceID.toString();\n  if (time) {\n    const timeStr = Array.isArray(time)\n      ? time.map((t) => (t instanceof Date ? t.getTime() : t)).join(',')\n      : time;\n    options.time = timeStr;\n  }\n\n  return new URLSearchParams(options);\n}\n\n\nclass ImageServiceServiceMetadata {\n  url: string;\n  metadataCache: EsriImageServiceSpec | null = null;\n  private _loadingMetadata: boolean = false;\n  \n  constructor(url: string) {\n    this.url = url;\n  }\n  \n  private async _getServiceMetadata(): Promise<EsriImageServiceSpec> {\n    const url = `${this.url}?f=json`;\n    return fetch(url)\n      .then((response) => {\n        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);\n        return response.json();\n      })\n      .catch((error) => {\n        console.error('Error fetching service metadata:', error);\n        throw error;\n      });\n  }\n  \n  async updateMetadataCache() {\n    // in general we really should invalidate the cache when the URL changes\n    // however, we know that for this purpose, the grid is identical for all\n    // the various services we may access, so ease of use, we will always have a metaDataCache\n    // available. \n    // this.metadataCache = null; // Invalidate cache\n    this._loadingMetadata = true;\n    this.metadataCache = await this._getServiceMetadata();\n    this._loadingMetadata = false;\n    console.log('Service metadata updated:', this.metadataCache);\n    return this.metadataCache;\n  }\n  \n  getMetadata(): EsriImageServiceSpec {\n    if (!this.metadataCache) {\n      if (this._loadingMetadata) {\n        throw new Error('Metadata is currently loading. Please wait and try again.');\n      }\n      throw new Error('Metadata not loaded yet. Call updateMetadataCache() first.');\n    }\n    return this.metadataCache;\n  }\n  \n  get meta(): EsriImageServiceSpec | null {\n    return this.metadataCache;\n  }\n  \n  async withMetadataCache(): Promise<EsriImageServiceSpec> {\n    if (this.metadataCache) {\n      return this.metadataCache;\n    }\n    if (this._loadingMetadata) {\n      // Wait until loading is done. Check eveery 100ms\n      while (this._loadingMetadata) {\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      }\n      if (this.metadataCache) {\n        return this.metadataCache;\n      } else {\n        throw new Error('Failed to load metadata.');\n      }\n    }\n    return this.updateMetadataCache();\n  }\n  \n  async waitForCache(): Promise<ImageServiceServiceMetadata> {\n    await this.withMetadataCache();\n    return this;\n  }\n  \n  \n  get timeRange(): [number, number] | null {\n    if (this.metadataCache && this.metadataCache.timeInfo && this.metadataCache.timeInfo.timeExtent) {\n      return [this.metadataCache.timeInfo.timeExtent[0], this.metadataCache.timeInfo.timeExtent[1]];\n    }\n    return null;\n  }\n  \n  get extent(): RectBounds | null {\n    if (this.metadataCache && this.metadataCache.extent) {\n      return {\n        xmin: this.metadataCache.extent.xmin,\n        ymin: this.metadataCache.extent.ymin,\n        xmax: this.metadataCache.extent.xmax,\n        ymax: this.metadataCache.extent.ymax,\n      };\n    }\n    return null;\n  } \n  \n  get spatialReference(): number | null {\n    if (this.metadataCache && this.metadataCache.spatialReference) {\n      return this.metadataCache.spatialReference.wkid || null;\n    }\n    return null;\n  }\n  \n  clippedToTimeExtent(timeRange: MillisecondRange): [MillisecondRange, boolean] {\n    const serviceTimeRange = this.timeRange;\n    if (!serviceTimeRange) return [timeRange, false];\n    const start = Math.max(timeRange.start, serviceTimeRange[0]);\n    const end = Math.min(timeRange.end, serviceTimeRange[1]);\n    const clipped = start !== timeRange.start || end !== timeRange.end;\n    return [{ start, end }, clipped];\n  }\n  \n  // \n}\n\n\n// ============================================================================\n// TEMPO DATA SERVICE\n// ============================================================================\n\nexport class TempoDataService extends ImageServiceServiceMetadata {\n  private _baseUrls: string | string[] = [];\n  private requestUrl: string = '';\n  private variable: Variables | string;\n  private metas = new Map<string, ImageServiceServiceMetadata>();\n  \n  constructor(baseUrl: string | string[], variable: Variables | string = \"NO2_Troposphere\") {\n    super(Array.isArray(baseUrl) ? baseUrl[0] : baseUrl);\n    this._baseUrls = baseUrl;\n    if (!Array.isArray(this._baseUrls)) {\n      this.requestUrl = this._baseUrls;\n    } else {\n      this.requestUrl = this._baseUrls[this._baseUrls.length - 1];\n    }\n    this.baseUrlArray.forEach((url) => {\n      this.metas.set(url, new ImageServiceServiceMetadata(url));\n    });\n    \n    this.variable = variable;\n    this.updateMetadataCache();\n  }\n\n  \n  get baseUrlArray(): string[] {\n    return Array.isArray(this._baseUrls) ? this._baseUrls : [this._baseUrls];\n  }\n  \n  // updateMetadataCache(): void {\n  //   this.baseUrlArray.forEach((url) => {\n  //     if (!this.metas.has(url)) {\n  //       this.metas.set(url, new ImageServiceServiceMetadata(url));\n  //     }\n  //   });\n  // }\n\n  // ============================================================================\n  // CONFIGURATION\n  // ============================================================================\n\n  setVariable(variable: Variables | string): void {\n    this.variable = variable;\n  }\n\n  getVariable(): Variables | string {\n    return this.variable;\n  }\n\n  setBaseUrl(baseUrl: string): void {\n    if (this.baseUrl === baseUrl) return;\n    this.baseUrl = baseUrl;\n    this.updateMetadataCache();\n  }\n  \n  get baseUrl(): string {\n    return this.url;\n  }\n  \n  set baseUrl(value: string) {\n    if (this.url === value) return;\n    this.url = value;\n    this.updateMetadataCache();\n  }\n\n  getBaseUrl(): string {\n    return this.baseUrl;\n  }\n\n  \n\n  // ============================================================================\n  // CORE DATA FETCHING\n  // ============================================================================\n  /**\n   * Fetch raw samples from the ESRI Image Server\n   */\n  async fetchSample(\n    geometry: RectBounds | PointBounds,\n    timeRange: MillisecondRange,\n    options: FetchOptions = {}\n  ): Promise<RawSampleData> {\n    const esriGeometry = this.isRectBounds(geometry) \n      ? rectangleToGeometry(geometry as RectBounds)\n      : pointToGeometry(geometry as PointBounds);\n\n    const geometryType: EsriGeometryType = this.isRectBounds(geometry)\n      ? 'esriGeometryPolygon'\n      : 'esriGeometryPoint';\n\n    // Handle multiple time ranges by combining them\n    const timeString = `${timeRange.start},${timeRange.end}`;\n    \n    // log sample geometry type and time range\n    console.log(`Fetching samples for geometry type: ${geometryType}, time range: ${timeString}`);\n\n\n    const params = {\n      f: 'pjson' as const,\n      interpolation: 'RSP_NearestNeighbor' as EsriInterpolationMethod,\n      returnFirstValueOnly: false,\n      geometry: esriGeometry,\n      geometryType: geometryType,\n      time: timeString,\n      sampleCount: options.sampleCount || 30, // 100 is the Esri default. 30 has been our default\n      ...options\n    };\n\n    const urlWithParams = `${this.baseUrl}/getSamples/?${stringifyEsriGetSamplesParameters(params).toString()}`;\n    \n    try {\n      const response = await fetch(urlWithParams);\n      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);\n      \n      const data: EsriGetSamplesReturn | EsriGetSamplesReturnError = await response.json();\n      \n      if ('error' in data) {\n        throw new Error(`Error fetching samples (${data.error.code}): ${data.error.message} ${data.error.details}`);\n      }\n\n      const processedSamples = data.samples.map((sample: EsriGetSamplesSample) => ({\n        x: sample.location.x,\n        y: sample.location.y,\n        time: sample.attributes.StdTime,\n        date: new Date(sample.attributes.StdTime),\n        variable: safeParseNumber(sample.attributes[this.variable] ?? ''),\n        value: safeParseNumber(sample.value),\n        locationId: sample.locationId,\n        geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point' as 'rectangle' | 'point'\n      })); // this is a CEsriTimeseries[]\n      console.log(`Fetched ${processedSamples.length} samples for time range ${new Date(timeRange.start)}-${new Date(timeRange.end)}`);\n      return {\n        samples: processedSamples,\n        metadata: {\n          totalSamples: processedSamples.length,\n          timeRange: timeRange,\n          geometry,\n          geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point'\n        }\n      };\n    } catch (error) {\n      console.error('Error in TempoDataService.fetchSamples:', params);\n      throw error;\n    }\n  }\n  \n  /**\n   * Fetch raw samples from the ESRI Image Server\n   */\n  async fetchSamples(\n    geometry: RectBounds | PointBounds,\n    timeRanges: TimeRanges,\n    options: FetchOptions = {}\n  ): Promise<RawSampleData> {\n    \n    if (!Array.isArray(timeRanges)) {\n      return this.fetchSample(geometry, timeRanges, options);\n    }\n    \n    const promises = timeRanges.map(async (tr) => {\n      try {\n        return await this.fetchSample(geometry, tr, options);\n      } catch (error) {\n        console.error(`Error fetching sample for time range ${tr.start}-${tr.end}:`, error);\n        return null;\n      }\n    });\n\n    return Promise.all(promises).then((results) => {\n      const validResults = results.filter((result): result is RawSampleData => result !== null);\n      const samples = validResults.map((result) => result.samples).flat();\n      console.log(`Total samples fetched across all time ranges: ${samples.length}`);\n      console.log(samples);\n      return {\n        samples,\n        metadata: {\n          totalSamples: samples.length,\n          timeRange: timeRanges,\n          geometry: geometry,\n          geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point',\n        }\n      } as RawSampleData;\n    });\n  }\n\n  // ============================================================================\n  // AGGREGATION METHODS\n  // ============================================================================\n\n  /**\n   * Aggregate samples by time (for rectangle areas)\n   */\n  aggregateByTime(samples: CEsriTimeseries[]): TimeSeriesData {\n    // Group samples by time\n    const grouped = new Map<number, CEsriTimeseries[]>();\n    samples.forEach((sample) => {\n      if (!grouped.has(sample.time)) {\n        grouped.set(sample.time, []);\n      }\n      grouped.get(sample.time)?.push(sample);\n    });\n\n    // Calculate aggregated values\n    const values: Record<number, AggValue> = {};\n    const errors: Record<number, DataPointError> = {};\n    \n    grouped.forEach((samples, time) => {\n      const sampleValues = samples.map(s => s.value);\n      values[time] = this.calculateMean(sampleValues, time);\n      errors[time] = this.calculateError(sampleValues);\n    });\n\n    // Collect unique locations\n    const seen = new Set<string>();\n    const locations: Array<{ x: number; y: number }> = [];\n    for (const sample of samples) {\n      const key = `${sample.x},${sample.y}`;\n      if (!seen.has(key)) {\n        seen.add(key);\n        locations.push({ x: sample.x, y: sample.y });\n      }\n    }\n\n    return { values, errors, locations, geometryType: samples[0].geometryType };\n  }\n\n  /**\n   * Get single point data (for center points or individual points)\n   */\n  // aggregatePoint(samples: CEsriTimeseries[]): TimeSeriesData | null {\n  //   if (samples.length === 0) return null;\n    \n  //   // For point data, we typically expect one sample per time\n  //   // Group by time and aggregate\n  //   const grouped = new Map<number, CEsriTimeseries[]>();\n  //   samples.forEach((sample) => {\n  //     if (!grouped.has(sample.time)) {\n  //       grouped.set(sample.time, []);\n  //     }\n  //     grouped.get(sample.time)?.push(sample);\n  //   });\n\n  //   // Calculate aggregated values\n  //   const values: Record<number, AggValue> = {};\n  //   const errors: Record<number, DataPointError> = {};\n    \n  //   grouped.forEach((samples, time) => {\n  //     const sampleValues = samples.map(s => s.value);\n  //     values[time] = this.calculateMean(sampleValues, time);\n  //     errors[time] = this.calculateError(sampleValues);\n  //   });\n\n  //   // For point data, we expect only one location\n  //   const locations: Array<{ x: number; y: number }> = [];\n  //   if (samples.length > 0) {\n  //     const sample = samples[0];\n  //     locations.push({ x: sample.x, y: sample.y });\n  //   }\n\n  //   return { values, errors, locations };\n  // }\n\n  // ============================================================================\n  // CONVENIENCE METHODS\n  // ============================================================================\n  \n  getTimeSeriesStatistics(jsonData: RawSampleData) {\n    const samples = jsonData.samples || [];\n    \n    const uniqueLocations = new Set();\n    const uniqueLatitudes = new Set<number>();\n    const uniqueLongitudes = new Set<number>();\n    const valuesPerLocation = {};\n    \n    for (const sample of samples) {\n      const location = {x: sample.x, y: sample.y};\n      const locString = `${location.x},${location.y}`;\n      if (location) {\n        // Use a string representation for unique locations in the Set\n        uniqueLocations.add(locString);\n        uniqueLatitudes.add(location.y);\n        uniqueLongitudes.add(location.x);\n      }\n      \n      valuesPerLocation[locString] = (valuesPerLocation[locString] || 0) + 1;\n\n    }\n    \n    const totalValues = samples.length;\n    const numUniqueLocations = uniqueLocations.size;\n    \n    const latitudeSpacing = diff([...uniqueLatitudes].sort());\n    const longitudeSpacing = diff([...uniqueLongitudes].sort());\n    \n    \n    \n    return {\n      numUniqueLocations,\n      totalValues,\n      valuesPerLocation,\n      latitudeSpacing: nanmean(latitudeSpacing),\n      longitudeSpacing: nanmean(longitudeSpacing),\n    };\n  }\n  \n  getRegionCenter(geometry: RectBounds | PointBounds): { lat: number; lon: number } {\n    if (this.isRectBounds(geometry)) {\n      return {\n        lat: (geometry.ymin + geometry.ymax) / 2,\n        lon: (geometry.xmin + geometry.xmax) / 2\n      };\n    } else { // It's a point\n      return {\n        lat: geometry.y,\n        lon: geometry.x\n      };\n    }\n  }\n  /**\n   * Fetch and aggragate any valid geometry data (rectangle or point)\n   */\n  async fetchTimeseriesData(\n    geometry: RectBounds | PointBounds,\n    timeRanges: TimeRanges,\n    options: FetchOptions = {}\n  ): Promise<TimeSeriesData> {\n    \n    const { lat: centerLat, lon: centerLon } = this.getRegionCenter(geometry);\n    const timezone = tz_lookup(centerLat, centerLon);\n    console.log(`Determined timezone for geometry (${centerLat.toFixed(2)}, ${centerLon.toFixed(2)}): ${timezone}`);\n    \n    // Convert UTC time ranges to local time ranges for this timezone\n    const offsetter = new TimeRangeOffsetter(timezone);\n    const timeRangesArray = Array.isArray(timeRanges) ? timeRanges : [timeRanges];\n    const localTimeRanges = offsetter.offsetRanges(timeRangesArray);\n    \n    console.log(`Offset ${timeRangesArray.length} UTC time range(s) to ${timezone}`);\n    console.log('UTC ranges:', timeRangesArray);\n    console.log('Local ranges:', localTimeRanges);\n    \n    if (this.isRectBounds(geometry) && this.meta) {\n      const sampler = new EsriSampler(this.meta, geometry);\n      const sampleCount = options.sampleCount || 30;\n      console.log(`Requested sample count: ${sampleCount}`);\n      options.sampleCount = sampler.getSamplingSpecificationFromSampleCount(sampleCount).count;\n      console.log(`Using sample count: ${options.sampleCount}`);\n    }\n    const rawData = await this.fetchSamples(geometry, localTimeRanges, options);\n    const stats = this.getTimeSeriesStatistics(rawData);\n    console.log(`Data is sampled from ${stats.numUniqueLocations} unique locations with a total of ${stats.totalValues} values.`);\n    \n    console.log(`Approximate spacing between unique locations: ${stats.latitudeSpacing?.toFixed(4)} latitude, ${stats.longitudeSpacing?.toFixed(4)} longitude`);\n    return this.aggregateByTime(rawData.samples);\n  }\n  \n  /**\n   * Fetch and aggregate rectangle data (current fetchRectangleSamples equivalent)\n   */\n  // async fetchRectangleTimeseries(\n  //   rectangle: RectBounds,\n  //   timeRanges: TimeRanges,\n  //   options: FetchOptions = {}\n  // ): Promise<TimeSeriesData> {\n  //   const rawData = await this.fetchSamples(rectangle, timeRanges, options);\n  //   return this.aggregateByTime(rawData.samples);\n  // }\n\n  /**\n   * Fetch and aggregate point data (current fetchCenterPointSample equivalent)\n   */\n  // async fetchPointTimeseries(\n  //   point: PointBounds,\n  //   timeRanges: TimeRanges,\n  //   options: FetchOptions = {}\n  // ): Promise<TimeSeriesData | null> {\n  //   const rawData = await this.fetchSamples(point, timeRanges, options);\n  //   return this.aggregatePoint(rawData.samples);\n  // }\n\n  /**\n   * Get center point of rectangle and fetch data for it\n   */\n  async fetchCenterPointData(\n    rectangle: RectBounds,\n    timeRanges: TimeRanges,\n    options: FetchOptions = {}\n  ): Promise<TimeSeriesData | null> {\n    const center: PointBounds = {\n      x: (rectangle.xmin + rectangle.xmax) / 2,\n      y: (rectangle.ymin + rectangle.ymax) / 2\n    };\n    \n    return this.fetchTimeseriesData(center, timeRanges, options);\n  }\n\n  // ============================================================================\n  // UTILITY METHODS\n  // ============================================================================\n\n  private isRectBounds(geometry: RectBounds | PointBounds): geometry is RectBounds {\n    return 'xmin' in geometry && 'xmax' in geometry && 'ymin' in geometry && 'ymax' in geometry;\n  }\n\n  private calculateMean(samples: (number | null)[], time: number): AggValue {\n    const validSamples = samples.filter((sample) => sample !== null);\n    if (validSamples.length === 0) return { value: null, date: new Date(time) };\n    const sum = validSamples.reduce((acc, val) => acc + (val ?? 0), 0);\n    return { value: sum / validSamples.length, date: new Date(time) };\n  }\n\n  private calculateError(samples: (number | null)[]): DataPointError {\n    const validSamples = samples.filter((sample) => sample !== null);\n    if (validSamples.length === 0) return { lower: null, upper: null };\n    \n    const mean = validSamples.reduce((acc, val) => acc + (val ?? 0), 0) / validSamples.length;\n    const squaredDiffs = validSamples.map((sample) => {\n      if (sample === null) return 0;\n      return Math.pow(sample - mean, 2);\n    });\n    // squared standard error of the mean = variance / n\n    const squaredSEM = squaredDiffs.reduce((acc, val) => acc + val, 0) / Math.pow(validSamples.length, 2);\n    \n    return { lower: Math.sqrt(squaredSEM), upper: Math.sqrt(squaredSEM) };\n  }\n} ","import { ref, computed, watch, Ref } from 'vue';\nimport { getTimezoneOffset } from 'date-fns-tz';\n\nconst ONEDAYMS = 1000 * 60 * 60 * 24;\n\nfunction isBad(value: unknown): value is null | undefined {\n  return value === null || value === undefined;\n}\n\nexport const useUniqueTimeSelection = (timestamps: Ref<number[]>) => {\n  const timeIndex = ref(0);\n  const singleDateSelected = ref<Date>(new Date());\n  const minIndex = ref<number>(0);\n  const maxIndex = ref<number>(0);\n  \n  const mode = ref<'single' | 'all'>('single');\n  const initialTimeSelection = ref<'first' | 'last'>('first');\n\n  function getOneDaysTimestamps(date: Date) {\n    if (isBad(date)) {\n      return [];\n    }\n    const mod = [] as {ts:number, idx: number}[];\n    timestamps.value.forEach((ts, idx) => {\n      if ((ts - date.getTime()) < ONEDAYMS && (ts - date.getTime()) > 0) {\n        mod.push({ ts, idx });\n      }\n    });\n    return mod;\n  }\n  \n  function getAllDaysTimestamps(date: Date) {\n    if (isBad(date)) {\n      return [];\n    }\n    // const mod = [] as {ts:number, idx: number}[];\n    // timestamps.value.forEach((ts, idx) => {\n    //   mod.push({ ts, idx });\n    // });\n    return timestamps.value.map((ts, idx) => ({ ts, idx }));\n  }\n\n  function setNearestDate(date: number | null) {\n    if (date == null) {\n      return;\n    }\n\n    const mod = mode.value === 'single' ? getOneDaysTimestamps(new Date(date)) : getAllDaysTimestamps(new Date(date));\n    if (mod.length > 0) {\n      minIndex.value = mod[0].idx;\n      maxIndex.value = mod[mod.length - 1].idx;\n      timeIndex.value = initialTimeSelection.value === 'first' ? minIndex.value : maxIndex.value;\n    } else {\n      console.warn(\"No timestamps found for the given date.\");\n    }\n  }\n\n  const timestamp = computed(() => {\n    if (timestamps.value.length === 0) {\n      return null;\n    }\n    const val = timestamps.value[timeIndex.value];\n    return val;\n  });\n\n  const date = computed(() => {\n    return timestamp.value ? new Date(timestamp.value) : null;\n  });\n\n  const offset = (date: Date) => getTimezoneOffset(\"US/Eastern\", date);\n\n  const uniqueDays = computed(() => {\n    const easternDates = timestamps.value.map(ts => new Date(ts + offset(new Date(ts))));\n    const days = easternDates.map(date => (new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate())).getTime());\n    const unique = Array.from(new Set(days));\n    return unique.map(ts => new Date(ts));\n  });\n\n  const uniqueDaysIndex = (ts: number) => {\n    let date = new Date(ts + offset(new Date(ts)));\n    date = new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n    return uniqueDays.value.map(e => e.getTime()).indexOf(date.getTime());\n  };\n\n  function getUniqueDayIndex(date: Date | null | undefined): number {\n    if (isBad(date)) {\n      return 0;\n    }\n    return uniqueDays.value.findIndex(day => day.getTime() === date.getTime());\n  }\n\n  function moveBackwardOneDay() {\n    const currentIndex = getUniqueDayIndex(singleDateSelected.value);\n    if (currentIndex > 0) {\n      singleDateSelected.value = uniqueDays.value[currentIndex - 1];\n    }\n  }\n\n  function moveForwardOneDay() {\n    const nextIndex = getUniqueDayIndex(singleDateSelected.value) + 1;\n    if (nextIndex < uniqueDays.value.length) {\n      singleDateSelected.value = uniqueDays.value[nextIndex];\n    }\n  }\n\n  function nearestDate(date: Date): number {\n    const time = date.getTime();\n    const timestamp = timestamps.value.find(ts => ((ts - time) < ONEDAYMS) && (ts - time) >= 0);\n    if (timestamp !== undefined) {\n      return timestamp;\n    } else {\n      console.warn(\"No matching timestamp found, returning default value.\");\n      return timestamps.value[0];\n    }\n  }\n\n  function nearestDateIndex(date: Date): number {\n    const timestamp = date.getTime();\n    const index = timestamps.value.findIndex(ts => ((ts - timestamp) < ONEDAYMS) && (ts - timestamp) >= 0);\n    if (index < 0) {\n      console.log(\"No matching timestamp found, returning default index.\");\n      return 0;\n    }\n    return index;\n  }\n\n  watch(singleDateSelected, (value) => {\n    if (value) { \n      setNearestDate(value.getTime());\n    }\n  });\n  \n  watch(mode, () => {\n    setNearestDate(singleDateSelected.value.getTime());\n  });\n\n  watch(timestamps, (newTimestamps) => {\n    if (newTimestamps.length === 0) {\n      timeIndex.value = 0;\n      minIndex.value = 0;\n      maxIndex.value = 0;\n      return;\n    }\n    // Reset to first date if current date is out of range\n    if (timeIndex.value == null || timeIndex.value >= newTimestamps.length) {\n      timeIndex.value = 0;\n      singleDateSelected.value = new Date(newTimestamps[0]);\n    } else {\n      setNearestDate(singleDateSelected.value.getTime());\n      console.log(minIndex.value, maxIndex.value);\n    }\n  }, { immediate: true });\n\n  return {\n    timeIndex,\n    timestamp,\n    date,\n    singleDateSelected,\n    maxIndex,\n    minIndex,\n    uniqueDays,\n    mode,\n    initialTimeSelection,\n    uniqueDaysIndex,\n    setNearestDate,\n    getUniqueDayIndex,\n    moveBackwardOneDay,\n    moveForwardOneDay,\n    nearestDate,\n    nearestDateIndex\n  };\n};\n","import { computed, type Ref } from 'vue';\nimport { toZonedTime, fromZonedTime, format as formatTz, getTimezoneOffset } from 'date-fns-tz';\nimport type { MillisecondRange } from '../types/datetime';\n\nexport type Timezone = \n  \"US/Eastern\" |\n  \"US/Central\" |\n  \"US/Mountain\" |\n  \"US/Arizona\" |\n  \"US/Pacific\" |\n  \"US/Alaska\" |\n  \"UTC\";\n\ntype TimezoneOption = { tz: Timezone, name: string };\n\n/**\n * Composable for centralized timezone handling and formatting\n */\nexport function useTimezone(selectedTimezone: Ref<string>) {\n  \n  /**\n   * Convert UTC timestamp to timezone-aware date\n   */\n  function toTimezone(timestamp: number): Date {\n    const utcDate = new Date(timestamp);\n    return toZonedTime(utcDate, selectedTimezone.value);\n  }\n\n  /**\n   * Convert timezone-aware date to UTC timestamp\n   */\n  function fromTimezone(date: Date): number {\n    return fromZonedTime(date, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Set date to local midnight in selected timezone\n   */\n  function setToMidnight(date: Date): number {\n    const zonedDate = toZonedTime(date, selectedTimezone.value);\n    zonedDate.setHours(0, 0, 0, 0);\n    return fromZonedTime(zonedDate, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Set date to end of day in selected timezone\n   */\n  function setToEndOfDay(date: Date): number {\n    const zonedDate = toZonedTime(date, selectedTimezone.value);\n    zonedDate.setHours(23, 59, 59, 999);\n    return fromZonedTime(zonedDate, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Format timestamp with full date and time\n   */\n  function formatTimeLong(timestamp: number): string {\n    const utcDate = new Date(timestamp);\n    const zonedDate = toZonedTime(utcDate, selectedTimezone.value);\n    return formatTz(zonedDate, 'EEE, MMM d, yyyy \\'at\\' h:mm a', { timeZone: selectedTimezone.value });\n  }\n\n  /**\n   * Format duration with timezone prefix\n   */\n  function formatDuration(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    const startZoned = toZonedTime(startUtc, selectedTimezone.value);\n    const endZoned = toZonedTime(endUtc, selectedTimezone.value);\n    \n    const startTime = startZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    const endTime = endZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    \n    return `${selectedTimezone.value}: ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format timezone range with date and time\n   */\n  function formatTimezoneRange(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    const startZoned = toZonedTime(startUtc, selectedTimezone.value);\n    const endZoned = toZonedTime(endUtc, selectedTimezone.value);\n    \n    const startDate = startZoned.toLocaleDateString('en-US', { \n      month: 'short', \n      day: 'numeric' \n    });\n    const startTime = startZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    const endTime = endZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    \n    return `${startDate} ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format UTC range\n   */\n  function formatUTCRange(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    \n    const startDate = startUtc.toLocaleDateString('en-US', { \n      month: 'short', \n      day: 'numeric',\n      timeZone: 'UTC'\n    });\n    const startTime = startUtc.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true,\n      timeZone: 'UTC'\n    });\n    const endTime = endUtc.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true,\n      timeZone: 'UTC'\n    });\n    \n    return `${startDate} ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format time string for display\n   */\n  function formatTime(timeString: string): string {\n    const [hour, minute] = timeString.split(':').map(Number);\n    const date = new Date();\n    date.setHours(hour, minute, 0, 0);\n    return date.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n  }\n\n  /**\n   * Format date for display\n   */\n  function formatDateDisplay(date: Date | null): string {\n    return date?.toDateString() || '';\n  }\n\n  // Computed properties for reactive timezone info\n  const timezoneInfo = computed(() => ({\n    name: selectedTimezone.value,\n    offset: new Date().toLocaleString('en', {\n      timeZone: selectedTimezone.value,\n      timeZoneName: 'short'\n    }).split(' ').pop() || ''\n  }));\n\n  function isDST(date: Date): boolean {\n    const standardOffset = getTimezoneOffset(selectedTimezone.value, new Date(date.getUTCFullYear(), 0, 1));\n    const currentOffset = getTimezoneOffset(selectedTimezone.value, date);\n    if (standardOffset === currentOffset) {\n      return false;\n    }\n    return true;\n  }\n\n  function timezoneOptions(date: Date): TimezoneOption[] {\n    const dateIsDST = isDST(date);\n    return [\n      { tz: 'US/Eastern', name: dateIsDST ? 'Eastern Daylight' : 'Eastern Standard' },\n      { tz: 'US/Central', name: dateIsDST ? 'Central Daylight' : 'Central Standard' },\n      { tz: 'US/Mountain', name: dateIsDST ? 'Mountain Daylight' : 'Mountain Standard' },\n      { tz: 'US/Arizona', name: 'Mountain Standard' },\n      { tz: 'US/Pacific', name: dateIsDST ? 'Pacific Daylight' : 'Pacific Standard' },\n      { tz: 'US/Alaska', name: dateIsDST ? 'Alaska Daylight' : 'Alaska Standard' },\n      { tz: 'UTC', name: 'UTC' },\n    ];\n  }\n\n  return {\n    // Core timezone operations\n    toTimezone,\n    fromTimezone,\n    setToMidnight,\n    setToEndOfDay,\n    \n    // Formatting functions\n    formatTimeLong,\n    formatDuration,\n    formatTimezoneRange,\n    formatUTCRange,\n    formatTime,\n    formatDateDisplay,\n\n    // Utility functions\n    isDST,\n    timezoneOptions,\n    \n    // Computed properties\n    timezoneInfo,\n  };\n}\n","\n\n/**\n * @function atleast1d\n * Ensures that the input is at least 1-dimensional. If the input is a single value, it wraps it in an array.\n * If the input is already an array, it returns the array as is.\n * If the input is undefined, it returns undefined.\n * If the input is null, it returns an array with a single null element.\n */\n// The complicated typing ensures that if T is undefined, the return type is also undefined.\nexport function atleast1d<T>(value: T | T[]): T[] {\n  return (Array.isArray(value) ? value : [value]);\n}","import { getTimezoneOffset } from \"date-fns-tz\";\nimport type { MillisecondRange, TimeRange, UserDataset } from \"../types\";\n\nexport function formatSingleRange(range: MillisecondRange): string {\n  const startString = new Date(range.start).toLocaleDateString();\n  const endString = new Date(range.end).toLocaleDateString();\n  if (startString === endString) {\n    return startString;\n  }\n  return `${startString} - ${endString}`;\n}\n\nexport function formatTimeRange(ranges: MillisecondRange | MillisecondRange[]): string {\n  if (Array.isArray(ranges)) {\n    if (ranges.length === 0) {\n      return 'No time range set';\n    }\n    \n    if (ranges.length === 1) {\n      return formatSingleRange(ranges[0]); \n    } else {\n      // For multiple ranges, show the full span\n      const allStarts = ranges.map(r => r.start);\n      const allEnds = ranges.map(r => r.end);\n      const minStart = Math.min(...allStarts);\n      const maxEnd = Math.max(...allEnds);\n      return `${new Date(minStart).toLocaleDateString()} - ${new Date(maxEnd).toLocaleDateString()} (${ranges.length} ranges)`;\n    }\n  } else {\n    return formatSingleRange(ranges);\n  }\n}\n\nexport function getTimeRangeDisplay(sel: UserDataset): string {\n  if (!sel.timeRange || !sel.timeRange.range) {\n    return `No time range set for selection ${sel.id}`;\n  }\n  return formatTimeRange(sel.timeRange.range);\n}\n\nexport function rangeForSingleDay(day: Date, timezone: string): MillisecondRange {\n  const offset = getTimezoneOffset(timezone, day);\n  const dayUTC = day.getTime() - offset;\n  const start = dayUTC - (dayUTC % 86400000) - offset; // Start of the day in milliseconds\n  const end = start + (86400000 - 1); // End of the day in milliseconds\n  return { start, end };\n}\n\nexport function areEquivalentMsRanges(first: MillisecondRange, second: MillisecondRange): boolean {\n  return first.start === second.start && first.end === second.end;\n}\n\nexport function areEquivalentTimeRanges(first: TimeRange, second: TimeRange): boolean {\n  if (first.id === second.id) {\n    return true;\n  }\n\n  const array = Array.isArray(first.range);\n  if (array !== Array.isArray(second.range)) {\n    return false;\n  }\n\n  if (array) {\n    const firstRange = first.range as MillisecondRange[];\n    const secondRange = second.range as MillisecondRange[];\n    return firstRange.length === secondRange.length &&\n      firstRange.every((rg, idx) => areEquivalentMsRanges(rg, secondRange[idx]));\n  } else {\n    return areEquivalentMsRanges(first.range as MillisecondRange, second.range as MillisecondRange);\n  }\n}\n","import { defineStore, type StateTree } from \"pinia\";\nimport { computed, ref, watch, toRaw } from \"vue\";\nimport { v4 } from \"uuid\";\nimport type { Map } from \"maplibre-gl\";\nimport { isComputedRef } from \"@/utils/vue\";\nimport { parse, stringify } from \"zipson\";\n\nimport type { AggValue, InitMapOptions, LatLngPair, MappingBackends, SelectionType, TimeRange, UnifiedRegion, UserDataset } from \"@/types\";\nimport { ESRI_URLS, MoleculeType } from \"@/esri/utils\";\nimport { TempoDataService } from \"@/esri/services/TempoDataService\";\nimport { useUniqueTimeSelection } from \"@/composables/useUniqueTimeSelection\";\nimport { useTimezone, type Timezone } from \"@/composables/useTimezone\";\nimport { atleast1d } from \"@/utils/atleast1d\";\nimport { formatSingleRange, rangeForSingleDay } from \"@/utils/timeRange\";\n\nconst createTempoStore = (backend: MappingBackends) => defineStore(\"tempods\", () => {\n  const debugMode = ref(false);\n  const timeRanges = ref<TimeRange[]>([]);\n  const regions = ref<UnifiedRegion[]>([]);\n  const datasets = ref<UserDataset[]>([]);\n  const timestamps = ref<number[]>([]);\n  const timestampsLoaded = ref(false);\n  const tempoDataServices: Record<MoleculeType, TempoDataService> = {};\n  const backendRef = ref<MappingBackends>(backend);\n  const maxSampleCount = ref(50);\n  const sampleErrors = ref<Record<string, string | null>>({});\n  const regionsCreatedCount = ref(0);\n  const userSelectedCalendarDates: number[] = [];\n  const userSelectedTimezones: string[] = [];\n  const userSelectedLocations: string[] = [];\n  const userSelectedNotableEvents: [string, string][] = [];\n  const shareButtonClickedCount = ref(0);\n  const playButtonClickedCount = ref(0);\n  const timeSliderUsedCount = ref(0);\n  const opacitySliderUsedCount = ref(0);\n\n  const maps = ref<Map[]>([]);\n\n  const selectionActive = ref<SelectionType>(null);\n  const focusRegion = ref<UnifiedRegion | null>(null);\n\n  const showFieldOfRegard = ref(false);\n  const showRoads = ref(true);\n  const showSamplingPreviewMarkers = ref(false);\n\n  const selectedTimezone = ref<Timezone>(\"US/Eastern\");\n  const { isDST, timezoneOptions: tzOptions } = useTimezone(selectedTimezone);\n\n  const dateIsDST = computed(() => isDST(singleDateSelected.value));\n  const timezoneOptions = computed(() => tzOptions(singleDateSelected.value));\n     \n  // This part is still assuming that multiple maps will be temporally linked\n  // If/when we want to make that not the case, we'll need to rethink this\n  // and some of the consuming components\n  const {\n    timeIndex,\n    timestamp,\n    date,\n    singleDateSelected,\n    maxIndex,\n    minIndex,\n    uniqueDays,\n    uniqueDaysIndex,\n    setNearestDate,\n    moveBackwardOneDay,\n    moveForwardOneDay,\n    nearestDateIndex\n  } = useUniqueTimeSelection(timestamps);\n\n  const displayedDayTimeRange = computed<TimeRange>(() => {\n    const range = rangeForSingleDay(singleDateSelected.value, selectedTimezone.value);\n    return {\n      id: 'displayed-day',\n      name: 'Displayed Day',\n      description: `Displayed Day (${new Date(range.start).toLocaleDateString()})`,\n      range,\n      type: 'singledate'\n    };\n  });\n\n  const accentColor = ref(\"#068ede\");\n  const accentColor2 = ref(\"#ffcc33\");\n  const tempoRed = ref(\"#b60e32\");\n\n\n  function getTempoDataService(molecule: MoleculeType) {\n    if (molecule in tempoDataServices) {\n      return tempoDataServices[molecule];\n    }\n    const url = ESRI_URLS[molecule];\n    const service = new TempoDataService(url.url, url.variable);\n    tempoDataServices[molecule] = service;\n    return service;\n  }\n\n  function addTimeRange(range: TimeRange) {\n    timeRanges.value.push(range);\n  }\n\n  function deleteTimeRange(range: TimeRange) {\n    const index = timeRanges.value.findIndex(r => r.id === range.id);\n    if (index < 0) {\n      return;\n    }\n    timeRanges.value.splice(index, 1);\n  }\n\n  watch(singleDateSelected, (_newDate, oldDate) => {\n    const oldRange = rangeForSingleDay(oldDate, selectedTimezone.value);\n    const displayedDateSelections = datasets.value.filter(sel => {\n      const range = sel.timeRange.range;\n      return !Array.isArray(range) &&\n             range.start === oldRange.start &&\n             range.end === oldRange.end;\n    });\n    if (displayedDateSelections.length === 0) {\n      return;\n    }\n  \n    const index = timeRanges.value.findIndex(timeRange => {\n      const range = timeRange.range;\n      return !Array.isArray(range) &&\n             range.start === oldRange.start &&\n             range.end === oldRange.end &&\n             timeRange.id !== \"displayed-day\";\n    });\n    if (index < 0) {\n      const formatted = formatSingleRange(oldRange);\n      const oldTimeRange: TimeRange = {\n        id: v4(),\n        name: formatted,\n        description: formatted,\n        range: oldRange,\n        type: 'singledate'\n      };\n      timeRanges.value.push(oldTimeRange);\n    }\n  });\n\n  watch(displayedDayTimeRange, (val) => {\n    if (!timeRanges.value.length) {\n      timeRanges.value.push(val);\n    } else {\n      timeRanges.value[0] = val;\n    }\n  }, { immediate: true });\n\n  const zoomScale = 0.5; // for matplibre-gl\n  const urlParams = new URLSearchParams(window.location.search);\n  const initLat = parseFloat(urlParams.get(\"lat\") || '40.044');\n  const initLon = parseFloat(urlParams.get(\"lon\") || '-98.789');\n  const initZoom = parseFloat(urlParams.get(\"zoom\") || `${4 * zoomScale}`); // 4 is the default zoom level for the map, multiplied by zoomScale for maplibre\n  const initTime = urlParams.get(\"t\");\n  const initState = ref<InitMapOptions>({\n    loc: [initLat, initLon] as LatLngPair,\n    zoom: initZoom,\n    t: initTime ? +initTime : null\n  });\n  \n  const homeLat = 40.044;\n  const homeLon = -98.789;\n  const homeZoom = 4 * zoomScale; // 4 is the default zoom level for the map, multiplied by zoomScale for maplibre\n  const homeState = ref({\n    loc: [homeLat, homeLon] as LatLngPair,\n    zoom: homeZoom,\n    t: null as number | null\n  });\n\n  watch(timestampsLoaded, (loaded: boolean) => {\n    if (loaded) {\n      console.log('timestamps loaded');\n      if (initState.value.t) {\n        let index = uniqueDaysIndex(initState.value.t);\n        if (index == -1) {\n          return;\n        }\n        console.log('set the date');\n        singleDateSelected.value = uniqueDays.value[index];\n        index = nearestDateIndex(new Date(initState.value.t));\n        if (index == -1) {\n          return;\n        }\n        timeIndex.value = index;\n        // FIXME if needed. if we find the time is not being set, use nextTick\n        // this.$nextTick(() => { this.timeIndex = index;});\n      }\n    }\n  });\n\n  watch(timestamps, () => {\n    if (uniqueDays.value.length === 0) {\n      return;\n    }\n    singleDateSelected.value = uniqueDays.value[uniqueDays.value.length - 1];\n  });\n\n  function addRegion(region: UnifiedRegion) {\n    // TODO: Fix the typing here\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    regions.value.push(region);\n  }\n\n  function deleteDataset(dataset: UserDataset) {\n    const index = datasets.value.findIndex(s => s.id == dataset.id);\n    if (index < 0) {\n      return;\n    }\n    datasets.value.splice(index, 1);\n  }\n\n  function addDataset(dataset: UserDataset, fetch=true) {\n    datasets.value.push(dataset);\n    if (fetch) {\n      fetchDataForDataset(dataset);\n    }\n    return dataset;\n  }\n\n  function markDatasetUpdated(dataset: UserDataset) {\n    const index = datasets.value.findIndex(ds => ds.id === dataset.id);\n    if (index >= 0) {\n      datasets.value[index] = { ...dataset };\n    }\n  }\n\n  function setRegionName(region: UnifiedRegion, newName: string) {\n    if (newName.trim() === '') {\n      console.error(\"Region name cannot be empty.\");\n      return;\n    }\n    // eslint-disable-next-line\n    // @ts-ignore it is not actually deep\n    const existing = (regions.value as UnifiedRegion[]).find(r => r.name === newName && r.id !== region.id);\n    if (existing) {\n      console.error(`A region with the name \"${newName}\" already exists.`);\n      return;\n    }\n    region.name = newName;\n    console.log(`Renamed ${region.geometryType} region to: ${newName}`);\n    \n    // check for any datasets using this region and update the region name\n    datasets.value.forEach(ds => {\n      if (ds.region.id === region.id) {\n        ds.region.name = region.name;\n      }\n    });\n  }\n\n  async function fetchDataForDataset(dataset: UserDataset) {\n    dataset.loading = true;\n\n    // loadingSamples.value = sel.id;\n    // sampleErrors.value[sel.id] = null;\n    \n    const timeRanges = atleast1d(dataset.timeRange.range);\n    \n    try {\n      const service = getTempoDataService(dataset.molecule);\n      const data = await service.fetchTimeseriesData(dataset.region.geometryInfo, timeRanges);\n      dataset.samples = data.values;\n      dataset.errors = data.errors;\n      // loadingSamples.value = \"finished\";\n      console.log(`Fetched data for ${timeRanges.length} time range(s)`);\n    } catch (error) {\n      sampleErrors.value[dataset.id] = error instanceof Error ? error.message : String(error);\n      // loadingSamples.value = \"error\";\n    }\n  \n    dataset.loading = false;\n  \n    markDatasetUpdated(dataset);\n  }\n\n  async function fetchCenterPointDataForDataset(dataset: UserDataset) {\n    sampleErrors.value[dataset.id] = null;\n\n    const service = getTempoDataService(dataset.molecule);\n    const timeRanges = atleast1d(dataset.timeRange.range);\n\n    \n    try {\n      service.setBaseUrl(ESRI_URLS[dataset.molecule].url);\n      const data = await service.fetchCenterPointData(\n        dataset.region.geometryInfo,\n        timeRanges,\n        { sampleCount: maxSampleCount.value },\n      );\n      if (data) {\n        dataset.samples = data.values;\n        dataset.locations = data.locations;\n        console.log(`Fetched center point data for ${timeRanges.length} time range(s)`);\n      }\n    } catch (error) {\n      sampleErrors.value[dataset.id] = error instanceof Error ? error.message : String(error);\n    }\n  }\n\n  function datasetHasSamples(dataset: UserDataset): boolean {\n    return (dataset.samples !== undefined) && Object.keys(dataset.samples).length > 0;\n  }\n\n  function regionHasDatasets(region: UnifiedRegion): boolean {\n    const sel = datasets.value.find(ds => ds.region.id === region.id);\n    return sel !== undefined;\n  }\n\n  function deleteRegion(region: UnifiedRegion) {\n    const index = regions.value.findIndex(r => r.id === region.id);\n    if (index < 0) {\n      return;\n    }\n    regions.value.splice(index, 1);\n  }\n\n  function registerMap(map: Map) {\n    maps.value.push(map);\n  }\n\n  function deregisterMap(map: Map) {\n    const index = maps.value.findIndex(m => m === map);\n    if (index > -1) {\n      maps.value.splice(index);\n    }\n  }\n\n  function reset() {\n    regions.value = [];\n    regionsCreatedCount.value = 0;\n    timeRanges.value = [];\n    datasets.value = [];\n  }\n\n  return {\n    debugMode,\n\n    accentColor,\n    accentColor2,\n    tempoRed,\n\n    selectedTimezone,\n    dateIsDST,\n    timezoneOptions,\n\n    selectionActive,\n    focusRegion,\n\n    showFieldOfRegard,\n    showRoads,\n    showSamplingPreviewMarkers,\n\n    homeState,\n    initState,\n\n    maps,\n    registerMap,\n    deregisterMap,\n\n    regions,\n    regionsCreatedCount,\n    timeRanges,\n    backend: backendRef,\n    maxSampleCount,\n    getTempoDataService,\n    tempoDataServices,\n    datasets,\n    timestamps,\n    timestampsLoaded,\n    displayedDayTimeRange,\n\n    addTimeRange,\n    addRegion,\n    addDataset,\n    fetchDataForDataset,\n    fetchCenterPointDataForDataset,\n    markDatasetUpdated,\n    datasetHasSamples,\n    regionHasDatasets,\n    setRegionName,\n\n    deleteTimeRange,\n    deleteRegion,\n    deleteDataset,\n\n    userSelectedLocations,\n    userSelectedTimezones,\n    userSelectedCalendarDates,\n    userSelectedNotableEvents,\n    shareButtonClickedCount,\n    playButtonClickedCount,\n    timeSliderUsedCount,\n    opacitySliderUsedCount,\n\n    timeIndex,\n    timestamp,\n    date,\n    singleDateSelected,\n    maxIndex,\n    minIndex,\n    uniqueDays,\n    uniqueDaysIndex,\n    setNearestDate,\n    moveBackwardOneDay,\n    moveForwardOneDay,\n    nearestDateIndex,\n\n    reset,\n  };\n});\n\nexport const useTempoStore = createTempoStore(\"maplibre\");\n\ntype TempoStore = ReturnType<typeof useTempoStore>;\n\nfunction isDateLikeString(value: string): boolean {\n  return /^\\d{4}-\\d{2}-\\d{2}/.test(value);\n}\n\nexport function deserializeTempoStore(value: string): StateTree {\n  if (!value) {\n    return {};\n  }\n  try {\n    const parsed = parse(value);\n    parsed.singleDateSelected = new Date(parsed.singleDateSelected);\n    for (const dataset of parsed.datasets) {\n      const samples = dataset.samples as Record<number, AggValue>;\n      if (samples) {\n        for (const entry of Object.values(samples)) {\n          entry.date = new Date(entry.date);\n        }\n      }\n\n      // Convert dates in plotlyDatasets if they exist\n      if (dataset.plotlyDatasets) {\n        for (const plotlyDataset of dataset.plotlyDatasets) {\n          if (plotlyDataset.datasetOptions?.customdata) {\n            plotlyDataset.datasetOptions.customdata = plotlyDataset.datasetOptions.customdata.map(d => d ? new Date(d) : d);\n          }\n          \n          // Convert strings in x array if they are dates\n          if (plotlyDataset.x?.[0] && typeof plotlyDataset.x[0] === 'string' && isDateLikeString(plotlyDataset.x[0])) {\n            plotlyDataset.x = plotlyDataset.x.map(d => d ? new Date(d) : d);\n          }\n        }\n      }\n    }\n    return parsed;\n  } catch (error) {\n    console.error(error);\n    return {};\n  }\n}\n\nconst OMIT = new Set([\"debugMode\", \"selectionActive\", \"maps\"]);\nexport function serializeTempoStore(store: TempoStore): string {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const state: Record<string, any> = {};\n  for (const [key, value] of Object.entries(store.$state)) {\n    if (OMIT.has(key) || isComputedRef(value)) {\n      continue;\n    }\n    state[key] = toRaw(value);\n  }\n  state.regions = state.regions.map(r => {\n    const s = { ...r };\n    delete s.layer;\n    return s;\n  });\n  const stringified = stringify(state);\n  return stringified;\n}\n\nexport function postDeserializeTempoStore(store: TempoStore) {\n  for (const dataset of store.datasets) {\n    if (dataset.loading) {\n      store.fetchDataForDataset(dataset);\n    }\n  }\n}\n","<template>\n  <v-app\n    id=\"app\"\n    :style=\"cssVars\"\n  >\n    <header-bar />\n    <div ref=\"root\" class=\"layout-root\"></div>\n\n    <template v-if=\"mapTargets\">\n      <teleport\n        v-for=\"[key, target] in Object.entries(mapTargets)\"\n        :key=\"key\"\n        :to=\"target\"\n      >\n        <map-with-controls />\n      </teleport>\n    </template>\n\n    <teleport\n      v-if=\"sidePanelTarget\"\n      :to=\"sidePanelTarget\"\n    >\n      <v-tabs\n        v-model=\"tab\"\n        :color=\"tempoRed\"\n      >\n        <v-tab :value=\"0\">TEMPO Deep Dive</v-tab>\n        <v-tab :value=\"1\">Comparison Data</v-tab>\n      </v-tabs>\n      \n      <v-tabs-window v-model=\"tab\">\n        <v-tabs-window-item\n          class=\"tab-content\"\n          :value=\"0\"\n          :key=\"0\"\n        >\n          <dataset-controls />\n        </v-tabs-window-item>\n        <v-tabs-window-item\n          :value=\"1\"\n          :key=\"1\"\n          class=\"tab-content\"\n        >\n          <comparison-data-controls />\n        </v-tabs-window-item>\n      </v-tabs-window>\n    </teleport>\n  </v-app>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onBeforeMount, onMounted, reactive, ref, useTemplateRef, type Ref } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { ComponentItemConfig, GoldenLayout, LayoutConfig, type RowOrColumn } from \"golden-layout\";\nimport { v4 } from \"uuid\";\n\nimport { useTempoStore, deserializeTempoStore, postDeserializeTempoStore, serializeTempoStore } from \"@/stores/app\";\n\ntype MaybeHTMLElement = HTMLElement | null;\nconst root = useTemplateRef(\"root\");\nconst mapTargets = reactive<Record<string, Ref<MaybeHTMLElement>>>({});\nconst sidePanelTarget = ref<MaybeHTMLElement>(null);\nconst tab = ref(0);\n\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  debugMode,\n  tempoRed,\n} = storeToRefs(store);\n\nconst query = new URLSearchParams(window.location.search);\ndebugMode.value = (query.get(\"debug\") ?? process.env.VUE_APP_TEMPO_LAB_DEBUG)?.toLowerCase() == \"true\";\n\nconst infoColor = \"#092088\";\nconst cssVars = computed(() => {\n  return {\n    '--accent-color': accentColor.value,\n    '--accent-color-2': accentColor2.value,\n    '--info-background': infoColor,\n    '--tempo-red': tempoRed.value,\n  };\n});\n\nconst localStorageKey = \"tempods\";\n\nonBeforeMount(() => {\n  const storedState = window.localStorage.getItem(localStorageKey);\n  if (storedState) {\n    const state = deserializeTempoStore(storedState);\n    store.$patch(state);\n    postDeserializeTempoStore(store);\n  }\n});\n\nfunction mapConfig(): ComponentItemConfig {\n  return {\n    type: 'component',\n    componentType: 'map-panel',\n    title: 'Map',\n    draggable: false,\n    width: 70,\n  };\n}\n\n// We'll probably be using this eventually\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction addMapPanel() {\n  if (layout) {\n    const config = mapConfig();\n    const row = layout.rootItem as RowOrColumn;\n    row.addItem(config, Object.keys(mapTargets).length);\n  }\n}\n\n// And maybe this too\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction removeMapPanel(index: number) {\n  if (layout) {\n    const idx = Math.round(index);\n    if (idx >= Object.keys(mapTargets).length) {\n      throw new Error(`Index ${idx} is out of range for map panels`);\n    }\n    const row = layout.rootItem as RowOrColumn;\n    row.contentItems[idx]?.remove();\n  }\n}\n\n// bind add and remove to the window for easy access from the console\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(window as any).addMapPanel = addMapPanel;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(window as any).removeMapPanel = removeMapPanel;\n\nlet layout: GoldenLayout | null = null;\nonMounted(() => {\n  const rootEl = root.value as HTMLElement;\n  if (!rootEl) {\n    return;\n  }\n  layout = new GoldenLayout(rootEl);\n\n  layout.registerComponentFactoryFunction(\"side-panel\", container => {\n    container.element.id = \"side-panel\";\n    sidePanelTarget.value = container.element;\n  });\n\n  layout.registerComponentFactoryFunction(\"map-panel\", container => {\n    container.element.classList.add(\"map-panel\");\n    const id = v4();\n    const target = ref<MaybeHTMLElement>(null);\n    target.value = container.element;\n    mapTargets[id] = target;\n  });\n\n  const config: LayoutConfig = {\n    settings: {\n      hasHeaders: false,\n      responsiveMode: \"always\",\n    },\n    root: {\n      type: 'row',\n      content: [\n        mapConfig(), \n        {\n          type: 'component',\n          componentType: 'side-panel',\n          title: 'Controls',\n          draggable: false,\n          width: 30,\n        },\n      ],\n    },\n  };\n  layout.resizeWithContainerAutomatically = true;\n  layout.loadLayout(config);\n\n  window.addEventListener(\"visibilitychange\", () => {\n    if (document.visibilityState === \"hidden\") {\n      const stringified = serializeTempoStore(store); \n      window.localStorage.setItem(localStorageKey, stringified);\n    }\n  });\n});\n</script>\n\n<style lang=\"less\">\n// NB: The styles here are NOT scoped - these are intended to apply to the overall application,\n// as this component is really just a layout container.\n// If we do want component-only styles, just add a <style scoped> block below this one\n\n@font-face {\n  font-family: \"Highway Gothic Narrow\";\n  src: url(\"./assets/HighwayGothicNarrow.ttf\");\n}\n\n// JC: This was commented out, but I put it back in because my browser (Chrome on Ubuntu) didn't already have Lexend\n@import url('https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap');\n\nhtml, body .layout-root {\n  width: 100%;\n  height: 100%;\n}\n\nhtml, body {\n  padding: 0;\n  margin: 0;\n}\n\nbody {\n  font-family: Verdana, Arial, Helvetica, sans-serif;\n}\n\n#app {\n  h1, h2, h3, h4, h5, h6, p, div {\n    user-select: none;\n    -webkit-user-select: none;\n  }\n  font-family: \"Lexend\", sans-serif;\n}\n\n#side-panel {\n  overflow-y: scroll;\n}\n\n:root {\n  // font-size: clamp(14px, 1.7vw, 16px);\n  // --default-font-size: 1rem; // we don't use this\n  font-size: 16px; // this is the standard browser default\n  --default-line-height: clamp(1rem, min(2.2vh, 2.2vw), 1.6rem); // we don't use this\n  --smithsonian-blue: #009ade;\n  --smithsonian-yellow: #ffcc33;\n  --info-background: #092088;\n  --map-height: 500px;\n}\n\n@media (max-width: 750px) {\n  :root {\n    --map-height: 60vh;\n    --map-height: 60dvh;\n    --map-height: 60svh;\n    font-size: 14px;\n  }\n}\n\n// Some Golden Layout adjustments\n.lm_content {\n  background: rgb(var(--v-theme-background));\n  overflow-y: auto!important;\n}\n\n.lm_splitter {\n  background-color: #333333;\n  opacity: 0.7;\n\n  &.lm_dragging {\n    background-color: var(--smithsonian-blue);\n  }\n}\n\n.tab-content {\n  padding: 0.5rem 1rem;\n  border: 5px solid var(--tempo-red);\n  border-radius: 10px;\n  margin: 10px;\n}\n</style>\n","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, Teleport as _Teleport, createBlock as _createBlock, createCommentVNode as _createCommentVNode, unref as _unref, createTextVNode as _createTextVNode, withCtx as _withCtx, normalizeStyle as _normalizeStyle } from \"vue\"\n\nimport { computed, onBeforeMount, onMounted, reactive, ref, useTemplateRef, type Ref } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { ComponentItemConfig, GoldenLayout, LayoutConfig, type RowOrColumn } from \"golden-layout\";\nimport { v4 } from \"uuid\";\n\nimport { useTempoStore, deserializeTempoStore, postDeserializeTempoStore, serializeTempoStore } from \"@/stores/app\";\n\ntype MaybeHTMLElement = HTMLElement | null;\nconst infoColor = \"#092088\";\nconst localStorageKey = \"tempods\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'TempoLab',\n  setup(__props) {\n\nconst root = useTemplateRef(\"root\");\nconst mapTargets = reactive<Record<string, Ref<MaybeHTMLElement>>>({});\nconst sidePanelTarget = ref<MaybeHTMLElement>(null);\nconst tab = ref(0);\n\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  debugMode,\n  tempoRed,\n} = storeToRefs(store);\n\nconst query = new URLSearchParams(window.location.search);\ndebugMode.value = (query.get(\"debug\") ?? process.env.VUE_APP_TEMPO_LAB_DEBUG)?.toLowerCase() == \"true\";\n\nconst cssVars = computed(() => {\n  return {\n    '--accent-color': accentColor.value,\n    '--accent-color-2': accentColor2.value,\n    '--info-background': infoColor,\n    '--tempo-red': tempoRed.value,\n  };\n});\n\nonBeforeMount(() => {\n  const storedState = window.localStorage.getItem(localStorageKey);\n  if (storedState) {\n    const state = deserializeTempoStore(storedState);\n    store.$patch(state);\n    postDeserializeTempoStore(store);\n  }\n});\n\nfunction mapConfig(): ComponentItemConfig {\n  return {\n    type: 'component',\n    componentType: 'map-panel',\n    title: 'Map',\n    draggable: false,\n    width: 70,\n  };\n}\n\n// We'll probably be using this eventually\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction addMapPanel() {\n  if (layout) {\n    const config = mapConfig();\n    const row = layout.rootItem as RowOrColumn;\n    row.addItem(config, Object.keys(mapTargets).length);\n  }\n}\n\n// And maybe this too\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction removeMapPanel(index: number) {\n  if (layout) {\n    const idx = Math.round(index);\n    if (idx >= Object.keys(mapTargets).length) {\n      throw new Error(`Index ${idx} is out of range for map panels`);\n    }\n    const row = layout.rootItem as RowOrColumn;\n    row.contentItems[idx]?.remove();\n  }\n}\n\n// bind add and remove to the window for easy access from the console\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(window as any).addMapPanel = addMapPanel;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(window as any).removeMapPanel = removeMapPanel;\n\nlet layout: GoldenLayout | null = null;\nonMounted(() => {\n  const rootEl = root.value as HTMLElement;\n  if (!rootEl) {\n    return;\n  }\n  layout = new GoldenLayout(rootEl);\n\n  layout.registerComponentFactoryFunction(\"side-panel\", container => {\n    container.element.id = \"side-panel\";\n    sidePanelTarget.value = container.element;\n  });\n\n  layout.registerComponentFactoryFunction(\"map-panel\", container => {\n    container.element.classList.add(\"map-panel\");\n    const id = v4();\n    const target = ref<MaybeHTMLElement>(null);\n    target.value = container.element;\n    mapTargets[id] = target;\n  });\n\n  const config: LayoutConfig = {\n    settings: {\n      hasHeaders: false,\n      responsiveMode: \"always\",\n    },\n    root: {\n      type: 'row',\n      content: [\n        mapConfig(), \n        {\n          type: 'component',\n          componentType: 'side-panel',\n          title: 'Controls',\n          draggable: false,\n          width: 30,\n        },\n      ],\n    },\n  };\n  layout.resizeWithContainerAutomatically = true;\n  layout.loadLayout(config);\n\n  window.addEventListener(\"visibilitychange\", () => {\n    if (document.visibilityState === \"hidden\") {\n      const stringified = serializeTempoStore(store); \n      window.localStorage.setItem(localStorageKey, stringified);\n    }\n  });\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_header_bar = _resolveComponent(\"header-bar\")!\n  const _component_map_with_controls = _resolveComponent(\"map-with-controls\")!\n  const _component_v_tab = _resolveComponent(\"v-tab\")!\n  const _component_v_tabs = _resolveComponent(\"v-tabs\")!\n  const _component_dataset_controls = _resolveComponent(\"dataset-controls\")!\n  const _component_v_tabs_window_item = _resolveComponent(\"v-tabs-window-item\")!\n  const _component_comparison_data_controls = _resolveComponent(\"comparison-data-controls\")!\n  const _component_v_tabs_window = _resolveComponent(\"v-tabs-window\")!\n  const _component_v_app = _resolveComponent(\"v-app\")!\n\n  return (_openBlock(), _createBlock(_component_v_app, {\n    id: \"app\",\n    style: _normalizeStyle(cssVars.value)\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_header_bar),\n      _createElementVNode(\"div\", {\n        ref_key: \"root\",\n        ref: root,\n        class: \"layout-root\"\n      }, null, 512),\n      mapTargets\n        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(Object.entries(mapTargets), ([key, target]) => {\n            return (_openBlock(), _createBlock(_Teleport, {\n              key: key,\n              to: target\n            }, [\n              _createVNode(_component_map_with_controls)\n            ], 8, [\"to\"]))\n          }), 128))\n        : _createCommentVNode(\"\", true),\n      (sidePanelTarget.value)\n        ? (_openBlock(), _createBlock(_Teleport, {\n            key: 1,\n            to: sidePanelTarget.value\n          }, [\n            _createVNode(_component_v_tabs, {\n              modelValue: tab.value,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((tab).value = $event)),\n              color: _unref(tempoRed)\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_tab, { value: 0 }, {\n                  default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n                    _createTextVNode(\"TEMPO Deep Dive\", -1)\n                  ]))]),\n                  _: 1\n                }),\n                _createVNode(_component_v_tab, { value: 1 }, {\n                  default: _withCtx(() => [...(_cache[3] || (_cache[3] = [\n                    _createTextVNode(\"Comparison Data\", -1)\n                  ]))]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }, 8, [\"modelValue\", \"color\"]),\n            _createVNode(_component_v_tabs_window, {\n              modelValue: tab.value,\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((tab).value = $event))\n            }, {\n              default: _withCtx(() => [\n                (_openBlock(), _createBlock(_component_v_tabs_window_item, {\n                  class: \"tab-content\",\n                  value: 0,\n                  key: 0\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_dataset_controls)\n                  ]),\n                  _: 1\n                })),\n                (_openBlock(), _createBlock(_component_v_tabs_window_item, {\n                  value: 1,\n                  key: 1,\n                  class: \"tab-content\"\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_comparison_data_controls)\n                  ]),\n                  _: 1\n                }))\n              ]),\n              _: 1\n            }, 8, [\"modelValue\"])\n          ], 8, [\"to\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _: 1\n  }, 8, [\"style\"]))\n}\n}\n\n})","import script from \"./TempoLab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TempoLab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TempoLab.vue?vue&type=style&index=0&id=49f5ce79&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\nconst _hoisted_2 = { class: \"colorbar-labels\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: _ctx.id,\n    class: \"colorbar-container\"\n  }, [\n    _createElementVNode(\"div\", {\n      style: _normalizeStyle({'--background-color': _ctx.backgroundColor}),\n      class: \"colorbar\"\n    }, null, 4),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"start\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.startValue), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"label\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.label), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"end\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.endValue), 1)\n        ], true)\n      ])\n    ])\n  ], 8, _hoisted_1))\n}","\n<template>\n<div :id=\"id\" class=\"colorbar-container\">\n  <div \n    :style=\"{'--background-color': backgroundColor}\"\n    class=\"colorbar\">\n  </div>\n  <div class=\"colorbar-labels\"> \n    <div><slot name=\"start\">{{ startValue }}</slot></div>\n    <div>\n      <slot name=\"label\">{{ label }}</slot>\n    </div>\n    <div><slot name=\"end\">{{ endValue }}</slot></div>\n  </div>\n</div>\n</template>\n\n\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\n\n// type for a function that maps to either a  (color, opacity) pair or just a color\ntype ColorFunction = (x: number) => string;\ntype ExtendType = boolean | 'start' | 'end' | 'both';\n\nexport default defineComponent({\n  name: 'ColorBar',\n  props: {\n    \n    name: {\n      type: String,\n      default: null\n    },\n    \n    cmapName: {\n      type: String,\n      default: 'none'\n    },\n    nsteps: {\n      type: Number,\n      default: 20\n    },\n    label: {\n      type: String,\n      default: 'Colorbar'\n    },\n    \n    cmap: {\n      type: Function as PropType<ColorFunction>,\n      default: (x: number) => `rgb(255,0,${x * 255})`\n    },\n    \n    backgroundColor: {\n      type: String,\n      default: '#5c5229'\n    },\n    \n    startValue: {\n      type: String,\n      default: '0%'\n    },\n    \n    endValue: {\n      type: String,\n      default: '100%'\n    },\n    \n    extend: {\n      type: (Boolean || String) as PropType<ExtendType>,\n      default: () => 'both'\n    }\n    \n  },\n  \n  \n  mounted() {\n    this.colorbarGradient();\n  },\n  \n  computed: {\n    id() {\n      return this.name ? `colorbar-${this.name}` : `colorbar-${Math.random().toString(36).slice(2)}`;\n    },\n    \n    triangles() {\n      return this.extend !== false;\n    },\n    \n    showStartTriangle() {\n      return this.extend === 'both' || this.extend === 'start' || this.extend;\n    },\n    \n    showEndTriangle() {\n      return this.extend === 'both' || this.extend === 'end' || this.extend;\n    }\n  },\n  \n  \n  \n  methods: {\n    \n    cssLinearGradientFromCmap() {\n      const n = this.nsteps;\n      const colors = Array.from({length: n+1}, (_, i) => {\n        const co = this.cmap(i/n);\n        const [color, _opacity] = Array.isArray(co) ? co : [co,1];\n        return `${color} ${i*100/n}%`;\n      });\n      return `linear-gradient(to top, ${colors.join(', ')})`;\n    },\n    \n    colorbarGradient() {\n      const colorbar = document.querySelector('#' + this.id + '> .colorbar');\n      if (!colorbar) {\n        return;\n      }\n      // remove all the children of the colorbar\n      while (colorbar.firstChild) {\n        colorbar.removeChild(colorbar.firstChild);\n      }\n      const div = document.createElement('div');\n      div.className = 'colorbar-chunk';\n      div.style.background = this.cssLinearGradientFromCmap();\n      div.style.height = '100%';\n      \n      \n      // add the start and end triangles\n      if (this.triangles) {\n        const start = document.createElement('div');\n        start.className = 'colorbar-start';\n        const end = document.createElement('div');\n        end.className = 'colorbar-end';\n        colorbar.appendChild(end);\n        colorbar.appendChild(div);\n        colorbar.appendChild(start);\n      \n        if (start && this.showStartTriangle) {\n          start.style.backgroundColor = this.cmap(0);\n          this.styleDownTriangle(start as HTMLDivElement);\n        }\n        if (end && this.showEndTriangle) {\n          end.style.backgroundColor = this.cmap(1);\n          this.styleUpTriangle(end as HTMLDivElement);\n        }\n      } else {\n        colorbar.appendChild(div);\n      }\n    },\n    \n    styleUpTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderBottom = `${height}px solid ${color}`;\n    },\n    \n    styleDownTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderTop = `${height}px solid ${color}`;\n    }\n  },\n  \n  watch: {\n    nsteps() {\n      this.colorbarGradient();\n    },\n    cmap() {\n      this.colorbarGradient();\n    },\n    cmapName() {\n      this.colorbarGradient();\n    },\n  }\n  \n});\n</script>\n\n<style scoped>\n/*\n* Prefixed by https://autoprefixer.github.io\n* PostCSS: v8.4.14,\n* Autoprefixer: v10.4.7\n* Browsers: last 5 version\n*/\n\n.colorbar-container {\n  position: relative;\n  display: inline-block;\n  --width: 1.25em;\n  width: -webkit-fit-content;\n  width: -moz-fit-content;\n  width: fit-content;\n  margin-left: 5px;\n  margin-right: 1em;\n  background: var(--background-color);\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.colorbar {\n  height: 100%;\n  width: var(--width);\n  margin-left: 5px;\n  margin-right: 1em;\n  background: var(--background-color);\n  display:-webkit-box;\n  display:-ms-flexbox;\n  display:flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-filter: drop-shadow(0 0 0.1rem white);\n          filter: drop-shadow(0 0 0.1rem white);\n}\n\n/* make .colorbar-start and .colorbar-end triangles */\n.colorbar-chunk {\n  \n  -ms-flex-negative: 1;\n  \n      flex-shrink: 1;\n  -webkit-box-flex:1;\n      -ms-flex-positive:1;\n          flex-grow:1;\n}\n\n.colorbar-start {\n  -ms-flex-preferred-size: min-content;\n      flex-basis: min-content;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n  -webkit-box-flex:1;\n      -ms-flex-positive:1;\n          flex-grow:1;\n}\n\n.colorbar-end {\n  -ms-flex-preferred-size: min-content;\n      flex-basis: min-content;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n  -webkit-box-flex: 1;\n      -ms-flex-positive: 1;\n          flex-grow: 1;\n}\n\n\n\n.colorbar-labels {\n  position: absolute;\n  width: -webkit-max-content;\n  width: -moz-max-content;\n  width: max-content;\n  height: 100%;\n  top: 50%;\n  line-height: 1.75;\n  /* right: -1.5ch; */\n  -webkit-transform-origin: top center;\n      -ms-transform-origin: top center;\n          transform-origin: top center;\n  -webkit-transform: rotate(180deg) translate(-100%,-50%);\n      -ms-transform: rotate(180deg) translate(-100%,-50%);\n          transform: rotate(180deg) translate(-100%,-50%);\n  -webkit-writing-mode: vertical-rl;\n      -ms-writing-mode: tb-rl;\n          writing-mode: vertical-rl;\n  \n  display: -webkit-box;\n  \n  display: -ms-flexbox;\n  \n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  }\n</style>\n","import { render } from \"./ColorBar.vue?vue&type=template&id=4b188667&scoped=true&ts=true\"\nimport script from \"./ColorBar.vue?vue&type=script&lang=ts\"\nexport * from \"./ColorBar.vue?vue&type=script&lang=ts\"\n\nimport \"./ColorBar.vue?vue&type=style&index=0&id=4b188667&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4b188667\"]])\n\nexport default __exports__","import { renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\nconst _hoisted_2 = { class: \"colorbar-labels\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: _ctx.id,\n    class: \"colorbar-container-horizontal\"\n  }, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"start\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.startValue), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"label\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.label), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"end\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.endValue), 1)\n        ], true)\n      ])\n    ]),\n    _createElementVNode(\"div\", {\n      style: _normalizeStyle({'--background-color': _ctx.backgroundColor}),\n      class: \"colorbar\"\n    }, null, 4)\n  ], 8, _hoisted_1))\n}","\n<template>\n<div :id=\"id\" class=\"colorbar-container-horizontal\">\n  <div class=\"colorbar-labels\"> \n    <div><slot name=\"start\">{{ startValue }}</slot></div>\n    <div>\n      <slot name=\"label\">{{ label }}</slot>\n    </div>\n    <div><slot name=\"end\">{{ endValue }}</slot></div>\n  </div>\n  <div \n    :style=\"{'--background-color': backgroundColor}\"\n    class=\"colorbar\">\n  </div>\n  \n</div>\n</template>\n\n\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\n\n// type for a function that maps to either a  (color, opacity) pair or just a color\ntype ColorFunction = (x: number) => string;\ntype ExtendType = boolean | 'start' | 'end' | 'both';\n\nexport default defineComponent({\n  name: 'ColorBar',\n  props: {\n    \n    name: {\n      type: String,\n      default: null\n    },\n    \n    cmapName: {\n      type: String,\n      default: 'none'\n    },\n    \n    nsteps: {\n      type: Number,\n      default: 20\n    },\n    label: {\n      type: String,\n      default: 'Colorbar'\n    },\n    \n    cmap: {\n      type: Function as PropType<ColorFunction>,\n      default: (x: number) => `rgb(255,0,${x * 255})`\n    },\n    \n    backgroundColor: {\n      type: String,\n      default: '#5c5229'\n    },\n    \n    startValue: {\n      type: String,\n      default: '0%'\n    },\n    \n    endValue: {\n      type: String,\n      default: '100%'\n    },\n    \n    extend: {\n      type: (Boolean || String) as PropType<ExtendType>,\n      default: () => 'both'\n    }\n    \n  },\n  \n  \n  mounted() {\n    this.colorbarGradient();\n    // console.log(this.$el);\n  },\n  \n  computed: {\n    id() {\n      return this.name ? `colorbar-${this.name}` : `colorbar-${Math.random().toString(36).slice(2)}`;\n    },\n    \n    triangles() {\n      return this.extend !== false;\n    },\n    \n    showStartTriangle() {\n      return this.extend === 'both' || this.extend === 'start' || this.extend;\n    },\n    \n    showEndTriangle() {\n      return this.extend === 'both' || this.extend === 'end' || this.extend;\n    }\n  },\n  \n  \n  \n  methods: {\n    \n    cssLinearGradientFromCmap() {\n      const n = this.nsteps;\n      const colors = Array.from({length: n+1}, (_, i) => {\n        const co = this.cmap(i/n);\n        const [color, _opacity] = Array.isArray(co) ? co : [co,1];\n        return `${color} ${i*100/n}%`;\n      });\n      return `linear-gradient(to right, ${colors.join(', ')})`;\n    },\n    \n    colorbarGradient() {\n      const colorbar = document.querySelector('#' + this.id + '> .colorbar');\n      if (!colorbar) {\n        return;\n      }\n      // remove all the children of the colorbar\n      while (colorbar.firstChild) {\n        colorbar.removeChild(colorbar.firstChild);\n      }\n      const div = document.createElement('div');\n      // const div = this.$el.querySelector('.colorbar-chunk');\n      div.className = 'colorbar-chunk';\n      div.style.background = this.cssLinearGradientFromCmap();\n      div.style.height = 'var(--height)';\n      div.style.width = '100%';\n      \n      \n      // add the start and end triangles\n      if (this.triangles) {\n        const start = document.createElement('div');\n        start.className = 'colorbar-start';\n        const end = document.createElement('div');\n        end.className = 'colorbar-end';\n        colorbar.appendChild(start);\n        colorbar.appendChild(div);\n        colorbar.appendChild(end);\n        end && this.showEndTriangle;\n        if (start && this.showStartTriangle) {\n          start.style.backgroundColor = this.cmap(0);\n          this.styleLeftTriangle(start as HTMLDivElement);\n        }\n        if (end && this.showEndTriangle) {\n          end.style.backgroundColor = this.cmap(1);\n          this.styleRightTriangle(end as HTMLDivElement);\n        }\n      } else {\n        colorbar.appendChild(div);\n      }\n    },\n    \n    styleColorbarChunk(div: HTMLDivElement) {\n      div.style.background = this.cssLinearGradientFromCmap();\n      div.style.height = 'var(--height)';\n      div.style.flexGrow = '1';\n      div.style.flexShrink = '1';\n      \n    },\n    \n    styleUpTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderBottom = `${height}px solid ${color}`;\n    },\n    \n    styleDownTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderTop = `${height}px solid ${color}`;\n      div.style.flexShrink = '0';\n      div.style.flexGrow = '1';\n    },\n    \n    styleLeftTriangle(div: HTMLDivElement) {\n      div.style.width=\"var(--height)\";\n      div.style.height=\"var(--height)\";\n      const height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      div.style.backgroundColor = 'transparent';\n      \n      div.style.borderTop = `${height/2}px solid transparent`;\n      div.style.borderBottom = `${height/2}px solid transparent`;\n      div.style.borderRight = `${height}px solid ${color}`;\n    },\n    \n    styleRightTriangle(div: HTMLDivElement) {\n      div.style.width=\"var(--height)\";\n      div.style.height=\"var(--height)\";\n      const height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      div.style.backgroundColor = 'transparent';\n      \n      div.style.borderTop = `${height/2}px solid transparent`;\n      div.style.borderBottom = `${height/2}px solid transparent`;\n      div.style.borderLeft = `${height}px solid ${color}`;\n    }\n  },\n  \n  watch: {\n    nsteps() {\n      this.colorbarGradient();\n    },\n    cmap() {\n      this.colorbarGradient();\n    },\n    cmapName() {\n      this.colorbarGradient();\n    }\n  }\n  \n});\n</script>\n\n<style scoped>\n/*\n* Prefixed by https://autoprefixer.github.io\n* PostCSS: v8.4.14,\n* Autoprefixer: v10.4.7\n* Browsers: last 5 version\n*/\n\n.colorbar-container-horizontal {\n  position: relative;\n  display: block;\n  --height: 1.25em;\n  width: 100%;\n}\n.colorbar {\n  width: 100%;\n  height: var(--height);\n  background: var(--background-color);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -webkit-filter: drop-shadow(0 0 0.1rem white);\n          filter: drop-shadow(0 0 0.1rem white);\n}\n\n\n.colorbar-labels {\n  \n  width: calc(100% - 2*var(--height));\n  height: -webkit-max-content;\n  height: -moz-max-content;\n  height: max-content;\n  /* left: 50%; */\n  -webkit-transform-origin: top center;\n      -ms-transform-origin: top center;\n          transform-origin: top center;\n  -webkit-transform: translate(var(--height), 0);\n      -ms-transform: translate(var(--height), 0);\n          transform: translate(var(--height), 0);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n</style>\n","import { render } from \"./ColorBarHorizontal.vue?vue&type=template&id=7e971f46&scoped=true&ts=true\"\nimport script from \"./ColorBarHorizontal.vue?vue&type=script&lang=ts\"\nexport * from \"./ColorBarHorizontal.vue?vue&type=script&lang=ts\"\n\nimport \"./ColorBarHorizontal.vue?vue&type=style&index=0&id=7e971f46&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7e971f46\"]])\n\nexport default __exports__","import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, mergeProps as _mergeProps, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, renderSlot as _renderSlot, toDisplayString as _toDisplayString, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"info-button-close-icon\" }\nconst _hoisted_2 = { class: \"v-card-info-text ma-3\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_v_dialog, {\n    modelValue: _ctx.dialogVisible,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.dialogVisible) = $event)),\n    \"max-width\": \"500\"\n  }, {\n    activator: _withCtx(({ props: activatorProps }) => [\n      _createVNode(_component_v_tooltip, {\n        text: _ctx.tooltipTextValue,\n        disabled: !_ctx.showTooltip\n      }, {\n        activator: _withCtx(( { props} ) => [\n          _createVNode(_component_v_icon, _mergeProps({...activatorProps, ...props}, {\n            class: \"info-button-icon\",\n            elevation: \"1\",\n            onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.dialogVisible = true)),\n            onKeydown: _ctx.handleKeydown\n          }), {\n            default: _withCtx(() => [...(_cache[3] || (_cache[3] = [\n              _createTextVNode(\" mdi-information-variant-circle-outline \", -1)\n            ]))]),\n            _: 1\n          }, 16, [\"onKeydown\"])\n        ]),\n        _: 2\n      }, 1032, [\"text\", \"disabled\"])\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_component_v_card, { class: \"gradient-background\" }, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_v_icon, {\n              class: \"info-button-close-icon__icon\",\n              onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.dialogVisible = false)),\n              onKeydown: _ctx.handleKeydown\n            }, {\n              default: _withCtx(() => [...(_cache[4] || (_cache[4] = [\n                _createTextVNode(\" mdi-close \", -1)\n              ]))]),\n              _: 1\n            }, 8, [\"onKeydown\"])\n          ]),\n          _createElementVNode(\"div\", _hoisted_2, [\n            _renderSlot(_ctx.$slots, \"default\", {}, () => [\n              _createTextVNode(_toDisplayString(_ctx.helpText), 1)\n            ], true)\n          ])\n        ]),\n        _: 3\n      })\n    ]),\n    _: 3\n  }, 8, [\"modelValue\"]))\n}","<template>\n  <v-dialog v-model=\"dialogVisible\" max-width=\"500\">\n    <template v-slot:activator=\"{ props: activatorProps }\">\n      <v-tooltip :text=\"tooltipTextValue\" :disabled=\"!showTooltip\">\n        <template v-slot:activator=\" { props} \">\n        <v-icon \n          v-bind=\"{...activatorProps, ...props}\" \n          class=\"info-button-icon\"\n          elevation=\"1\"\n          @click=\"dialogVisible = true\"\n          @keydown=\"handleKeydown\"\n          >\n          mdi-information-variant-circle-outline\n        </v-icon>\n        </template>\n      </v-tooltip>\n    </template>\n    <v-card class=\"gradient-background\">\n      <div class=\"info-button-close-icon\">\n        <v-icon \n          class=\"info-button-close-icon__icon\"\n          @click=\"dialogVisible = false\"\n          @keydown=\"handleKeydown\"\n        >\n          mdi-close\n        </v-icon>\n      </div>\n      <div class=\"v-card-info-text ma-3\">\n        <slot>{{ helpText }}</slot>\n      </div>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  name: 'InfoButton',\n  props: {\n    helpText: {\n      type: String,\n      required: false\n    },\n    showTooltip: {\n      type: Boolean,\n      required: false,\n      default: true\n    },\n    tooltipText: {\n      type: String,\n      required: false,\n      default: undefined\n    }\n  },\n  \n\n  \n  data() {\n    return {\n      dialogVisible: false,\n      tooltipTextValue: this.tooltipText ?? (this.showTooltip ? 'Learn More' : undefined),\n    };\n  },\n\n  methods: {\n    handleKeydown(event: KeyboardEvent) {\n      if (event.key === 'Enter') {\n        this.dialogVisible = !this.dialogVisible;\n      }\n    },\n  },\n});\n</script>\n\n<style scoped>\n.v-card-info-text {\n  font-size: 1em;\n  line-height: 1.5em;\n  padding-block: 1em;\n  padding-inline: 1.5em;\n  \n  p {\n    margin-block: 0.5em;\n  }\n\n}\n\n.v-card-info-text > p {\n  margin-bottom: 1em;\n}\n\n.info-button-close-icon {\n  position: relative;\n  height: 1em;\n}\n\n.info-button-close-icon__icon {\n  /* position:absolute !important;\n  right:0 !important; */\n  float:right;\n  right: 1em;\n  top: 1em;\n\n  cursor:pointer;\n  \n  padding:1em !important;\n  margin:-1em !important;\n}\n\n.info-button-close-icon__icon:hover {\n  background-color: #f0f0f0;\n  color: black;\n  border-radius: 50%;\n  padding: 0.5em;\n  margin: -0.5em;\n  transition: background-color 0.3s;\n}\n\n.info-button-icon {\n  font-size: 1.3em; \n  color: var(--accent-color);\n}\n\n</style>","import { render } from \"./InfoButton.vue?vue&type=template&id=e9e5abe8&scoped=true&ts=true\"\nimport script from \"./InfoButton.vue?vue&type=script&lang=ts\"\nexport * from \"./InfoButton.vue?vue&type=script&lang=ts\"\n\nimport \"./InfoButton.vue?vue&type=style&index=0&id=e9e5abe8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-e9e5abe8\"]])\n\nexport default __exports__","import { aliases, mdi } from 'vuetify/iconsets/mdi';\nimport { createVuetify } from 'vuetify';\n\n// For test use. Do not include createVuetify()\n// see https://next.vuetifyjs.com/en/features/treeshaking/\n//import * as components from 'vuetify/components';\n//import * as directives from 'vuetify/directives';\n\n// Translations provided by Vuetify\nimport { en } from 'vuetify/locale';\n\n// Styles\nimport 'vuetify/styles';\nimport '@mdi/font/css/materialdesignicons.css';\n\nexport default createVuetify({\n  // Icon Fonts\n  icons: {\n    defaultSet: 'mdi',\n    aliases,\n    sets: {\n      mdi,\n    },\n  },\n  locale: {\n    locale: 'en',\n    fallback: 'en',\n    messages: { en },\n  },\n  theme: {\n    defaultTheme: 'dark',\n  },\n});\n\n// Export for test.\n//export { components, directives };\n","import { renderSlot as _renderSlot, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createCommentVNode as _createCommentVNode, withKeys as _withKeys, createElementVNode as _createElementVNode, mergeProps as _mergeProps, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"cds-snackbar-alert ma-2\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_snackbar = _resolveComponent(\"v-snackbar\")!\n\n  return (!_ctx.hide)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        (!_ctx.hideButton)\n          ? _renderSlot(_ctx.$slots, \"activator\", {\n              key: 0,\n              onClick: _ctx.openDialog,\n              id: \"snackbar-activator-slot\"\n            }, () => [\n              _createVNode(_component_v_btn, {\n                onClick: _ctx.openDialog,\n                color: \"#333\",\n                id: \"snackbar-activator\",\n                size: \"small\"\n              }, {\n                prepend: _withCtx(() => [\n                  _createVNode(_component_v_icon, {\n                    color: \"red\",\n                    icon: \"mdi-alert-octagram\"\n                  })\n                ]),\n                default: _withCtx(() => [\n                  _createTextVNode(\" \" + _toDisplayString(_ctx.label), 1)\n                ]),\n                _: 1\n              }, 8, [\"onClick\"])\n            ])\n          : _createCommentVNode(\"\", true),\n        _createVNode(_component_v_snackbar, _mergeProps({\n          modelValue: _ctx.snackbar,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.snackbar) = $event)),\n          location: \"top center\"\n        }, _ctx.$attrs, {\n          \"close-on-back\": \"\",\n          role: \"alert\",\n          \"aria-live\": \"assertive\",\n          timeout: \"-1\"\n        }), {\n          actions: _withCtx(() => [\n            _createVNode(_component_v_btn, {\n              tabindex: \"0\",\n              color: \"red\",\n              variant: \"text\",\n              onClick: _ctx.closeDialog\n            }, {\n              default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n                _createTextVNode(\" Close \", -1)\n              ]))]),\n              _: 1\n            }, 8, [\"onClick\"])\n          ]),\n          default: _withCtx(() => [\n            _createElementVNode(\"span\", {\n              ref: \"snackbarMessage\",\n              tabindex: \"0\",\n              onKeydown: _cache[0] || (_cache[0] = _withKeys(\n//@ts-ignore\n(...args) => (_ctx.closeDialog && _ctx.closeDialog(...args)), [\"esc\"]))\n            }, [\n              _renderSlot(_ctx.$slots, \"default\", {}, () => [\n                _createTextVNode(_toDisplayString(_ctx.msg), 1)\n              ])\n            ], 544)\n          ]),\n          _: 3\n        }, 16, [\"modelValue\"])\n      ]))\n    : _createCommentVNode(\"\", true)\n}","<script lang=\"ts\">\n/**\n * v-snackbar wrapper component. The message can be passed\n * as a prop or as as the default slot. Props are passed\n * through to v-snackbar.\n * \n * Example Usage\n * \n * <SnackbarAlert msg=\"Hello there\" />\n * \n * <SnackbarAlert msg=\"Hello there\">\n *  <template v-slot:activator=\"{ onClick, id }\">\n *   <v-btn :id=\"id\" @click=\"onClick\" color=\"primary\">\n *    Custom Activator\n *   </v-btn>\n *  </template>\n * </SnackbarAlert>\n * \n */\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  name: \"SnackbarAlert\",\n  \n  emits: ['update:modelValue'],\n\n  props: {\n    msg: {\n      type: String || undefined || null,\n      required: false,\n      default: undefined,\n    },\n    hide: {\n      type: Boolean,\n      required: false,\n      default: false\n    },\n    label: {\n      type: String,\n      required: false,\n      default: \"Recent changes\"\n    },\n    modelValue: {\n      type: Boolean,\n      required: false,\n      default: false\n    },\n    hideButton: {\n      type: Boolean,\n      required: false,\n      default: false\n    }\n  },\n\n  data() {\n    return {\n      snackbar: false,\n    };\n  },\n  \n  methods: {\n    openDialog() {\n      if (this.snackbar) return;\n      \n      this.snackbar = true;\n      this.$emit('update:modelValue', true);\n      this.$nextTick(() => {\n        (this.$refs.snackbarMessage as HTMLElement).focus();\n      });\n    },\n    closeDialog() {\n      this.snackbar = false;\n      this.$emit('update:modelValue', false);\n      // make sure the focus goes back to the right place\n      this.$nextTick(() => {\n        this.$el.querySelector('#snackbar-activator')?.focus();\n        this.$el.querySelector('#snackbar-activator-slot')?.focus();\n      });\n    },\n  },\n  \n  watch: {\n    modelValue(val: boolean) {\n      if (val) {\n        this.openDialog();\n      } else {\n        this.closeDialog();\n      }\n    }\n  }\n\n\n});\n</script>\n\n<template>\n  <div class=\"cds-snackbar-alert ma-2\" v-if=\"!hide\">\n    \n    <slot v-if=\"!hideButton\" name=\"activator\" :onClick=\"openDialog\" id=\"snackbar-activator-slot\">\n      <v-btn @click=\"openDialog\" color=\"#333\" id=\"snackbar-activator\" size=\"small\">\n        <template v-slot:prepend>\n          <v-icon color=\"red\" icon=\"mdi-alert-octagram\"></v-icon>\n        </template>\n        {{ label }}\n      </v-btn>\n    </slot>\n    \n    <v-snackbar \n      v-model=\"snackbar\" \n      location=\"top center\" \n      v-bind=\"$attrs\"\n      close-on-back\n      role=\"alert\"\n      aria-live=\"assertive\"\n      timeout=\"-1\"\n      >\n      <span ref=\"snackbarMessage\" tabindex=\"0\" @keydown.esc=\"closeDialog\">\n      <slot> {{ msg }} </slot>\n      </span>\n\n\n      <template v-slot:actions>\n        <v-btn tabindex=\"0\" color=\"red\" variant=\"text\" @click=\"closeDialog\">\n          Close\n        </v-btn>\n      </template>\n    </v-snackbar>\n  </div>\n</template>\n","import { render } from \"./SnackbarAlert.vue?vue&type=template&id=034a6a3c&ts=true\"\nimport script from \"./SnackbarAlert.vue?vue&type=script&lang=ts\"\nexport * from \"./SnackbarAlert.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys, mergeProps as _mergeProps } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_snackbar = _resolveComponent(\"v-snackbar\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_use_clipboard = _resolveComponent(\"use-clipboard\")!\n\n  return (_openBlock(), _createBlock(_component_use_clipboard, { source: _ctx.source }, {\n    default: _withCtx(({ copy }) => [\n      (_ctx.tooltipDisabled || _ctx.alert)\n        ? (_openBlock(), _createBlock(_component_v_snackbar, {\n            key: 0,\n            class: \"share-button-snackbar\",\n            timeout: \"3500\",\n            location: \"top\",\n            activator: \"#share-button\",\n            text: \"Share link copied to clipboard. Paste to share this view!\",\n            color: \"success\",\n            variant: \"flat\",\n            \"min-height\": \"0px\",\n            \"min-width\": \"0px\",\n            transition: \"slide-y-transition\",\n            \"close-on-content-click\": \"\"\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_v_tooltip, {\n        disabled: _ctx.tooltipDisabled,\n        text: \"Share selected view\"\n      }, {\n        activator: _withCtx(({ props }) => [\n          _createVNode(_component_v_btn, _mergeProps({\n            id: \"share-button\",\n            \"aria-label\": \"Get link to share selected view\",\n            class: \"share-button\",\n            icon: \"\",\n            onClick: () => {\n            copy(_ctx.source);\n            _ctx.$emit('share');\n          }\n          ,\n            onKeyup: _withKeys(() => {\n            copy(_ctx.source);\n            _ctx.$emit('share');\n          }, [\"enter\"])\n          }, props, {\n            color: _ctx.buttonColor,\n            elevation: _ctx.elevation,\n            size: _ctx.size,\n            rounded: _ctx.rounded\n          }), {\n            default: _withCtx(() => [\n              _createVNode(_component_v_icon, { color: _ctx.iconColor }, {\n                default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n                  _createTextVNode(\"mdi-share-variant\", -1)\n                ]))]),\n                _: 1\n              }, 8, [\"color\"])\n            ]),\n            _: 1\n          }, 16, [\"onClick\", \"onKeyup\", \"color\", \"elevation\", \"size\", \"rounded\"])\n        ]),\n        _: 2\n      }, 1032, [\"disabled\"])\n    ]),\n    _: 1\n  }, 8, [\"source\"]))\n}","\n<template>\n  <use-clipboard v-slot=\"{ copy }\" :source=\"source\">\n    <v-snackbar \n      v-if=\"tooltipDisabled || alert\"\n      class=\"share-button-snackbar\"   \n      timeout=\"3500\" \n      location=\"top\" \n      activator=\"#share-button\"\n      text=\"Share link copied to clipboard. Paste to share this view!\"\n      color=\"success\"\n      variant=\"flat\"\n      min-height=\"0px\"\n      min-width=\"0px\"\n      transition=\"slide-y-transition\"\n      close-on-content-click\n      >\n    </v-snackbar>\n    <v-tooltip :disabled=\"tooltipDisabled\" text=\"Share selected view\">\n      <template v-slot:activator=\"{ props }\">\n        <v-btn\n          id=\"share-button\"\n          aria-label=\"Get link to share selected view\"\n          class=\"share-button\"\n          icon\n          @click=\"() => {\n            copy(source);\n            $emit('share');\n          }\n          \"\n          @keyup.enter=\"() => {\n            copy(source);\n            $emit('share');\n          }\"\n          v-bind=\"props\"\n          :color=\"buttonColor\"\n          :elevation=\"elevation\"\n          :size=\"size\"\n          :rounded=\"rounded\"\n        > \n          <v-icon :color=\"iconColor\">mdi-share-variant</v-icon>\n        </v-btn>\n      </template>\n    </v-tooltip>\n  </use-clipboard>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    source: {\n      type: String,\n      required: true,\n    },\n    buttonColor: {\n      type: String,\n      default: \"#ffffff66\",\n    },\n    iconColor: {\n      type: String,\n      default: \"#333\",\n    },\n    elevation: {\n      type: [String, Number],\n      default: \"0\",\n    },\n    size: {\n      type: String,\n      default: \"small\",\n    },\n    rounded: {\n      type: [String, Number],\n      default: \"1\",\n    },\n    tooltipDisabled: {\n      type: Boolean,\n      default: false,\n    },\n    alert: {\n      type: Boolean,\n      default: false,\n    },\n    \n  },\n  \n  data() {\n    return {\n      snackbar: false,\n    };\n  },\n\n  emits: [\"share\"],\n});\n</script>\n\n<style>\n.share-button {\n  z-index: 1000;\n  padding-inline: 5px;\n  border-radius: 8px !important;\n  border: thin solid var(--accent-color-2) !important;\n}\n\n.share-button-snackbar .v-snackbar__wrapper > .v-snackbar__content {\n  padding: 0.75em 1em;\n}\n\n</style>\n","import { render } from \"./ShareButton.vue?vue&type=template&id=1a0de751&ts=true\"\nimport script from \"./ShareButton.vue?vue&type=script&lang=ts\"\nexport * from \"./ShareButton.vue?vue&type=script&lang=ts\"\n\nimport \"./ShareButton.vue?vue&type=style&index=0&id=1a0de751&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","export async function getElementRect(element: Element): Promise<DOMRectReadOnly> {\n  let rect: DOMRectReadOnly | null = null;\n  let resolveRectPromise: (value: DOMRectReadOnly | PromiseLike<DOMRectReadOnly>) => void;\n  const rectPromise = new Promise<DOMRectReadOnly>((resolve, _reject) => {\n    resolveRectPromise = resolve;\n  });\n  const observer = new IntersectionObserver(entries => {\n    rect = entries[0].boundingClientRect;\n    resolveRectPromise(rect);\n\n    observer.disconnect();\n  });\n  observer.observe(element);\n\n  return rectPromise;\n}\n","import { onBeforeUnmount, Ref, watch } from \"vue\";\nimport { getElementRect } from \"../utils/dom\";\n\nimport { DragInfo } from \"../types\";\n\nexport interface UseDraggableDialogOptions {\n  root: Ref<HTMLElement | null>;\n  dragPredicate?: (element: HTMLElement) => boolean;\n  dialogSelector?: string;\n  scrimSelector?: string;\n}\n\nexport function useDraggableDialog(options: UseDraggableDialogOptions) {\n\n  const root = options.root;\n  const dialogSelector = options.dialogSelector ?? \".v-dialog.v-overlay--active\";\n  const scrimSelector = options.scrimSelector ?? \".v-overlay__scrim\";\n\n  let dragInfo: DragInfo | null = null;\n  type MouseEventHandler = (event: MouseEvent) => void;\n  let mousedown: MouseEventHandler | null = null;\n  let mouseup: MouseEventHandler | null = null;\n  let mousemove: MouseEventHandler | null = null;\n\n  function removeListeners(element: HTMLElement) {\n    if (mousedown) {\n      element.removeEventListener(\"mousedown\", mousedown);\n    }\n    if (mouseup) {\n      element.removeEventListener(\"mouseup\", mouseup);\n    }\n    if (mousemove) {\n      element.removeEventListener(\"mousemove\", mousemove);\n    }\n  }\n\n  function setupDraggable(element: HTMLElement) {\n    removeListeners(element);\n\n    let dragging = false;\n\n    mousedown = async (event: MouseEvent) => {\n      if (options.dragPredicate && !options.dragPredicate(event.target as HTMLElement)) {\n        element.style.cursor = \"\";\n        return;\n      }\n      dragging = true;\n\n      element.style.cursor = \"grabbing\";\n      const closestDialog = element.closest(dialogSelector);\n      if (event.button === 0 && closestDialog != null) {\n        const boundingRect = await getElementRect(closestDialog);\n        const d: DragInfo = {\n          el: closestDialog as HTMLElement,\n          title: element,\n          mouseStartX: event.clientX,\n          mouseStartY: event.clientY,\n          elStartX: boundingRect.left,\n          elStartY: boundingRect.top,\n          overlays: document.querySelectorAll(scrimSelector),\n        };\n        if (dragInfo && dragInfo.el) {\n          d.oldTransition = dragInfo.el.style.transition;\n        }\n        if (d.el) {\n          d.el.style.margin = \"0\";\n          d.el.style.transition = \"none\";\n          if (d.el.style.position !== \"fixed\") {\n            d.el.style.position = \"fixed\";\n            d.el.style.left = Math.min(\n              Math.max(d.elStartX + event.clientX - d.mouseStartX, 0),\n              window.innerWidth - boundingRect.width\n            ) + \"px\";\n            d.el.style.top = Math.min(\n              Math.max(d.elStartY + event.clientY - d.mouseStartY , 0),\n              window.innerHeight - boundingRect.height\n            ) - 0.5 * window.innerHeight + \"px\";\n          }\n        }\n        d.title.classList.add(\"dragging\");\n        d.overlays.forEach(overlay => (overlay as HTMLElement).style.display = \"none\");\n\n        dragInfo = d;\n      }\n    };\n    element.addEventListener(\"mousedown\", mousedown);\n\n    mousemove = async (event: MouseEvent) => {\n      if (options.dragPredicate && !options.dragPredicate(event.target as HTMLElement)) {\n        element.style.cursor = \"\";\n        return;\n      }\n      element.style.cursor = dragging ? \"grabbing\" : \"grab\";\n      if (dragInfo === null || dragInfo.el == null) {\n        return;\n      }\n      const boundingRect = await getElementRect(dragInfo.el);\n      dragInfo.el.style.left = Math.min(\n        Math.max(dragInfo.elStartX + event.clientX - dragInfo.mouseStartX, 0),\n        window.innerWidth - boundingRect.width\n      ) + \"px\";\n      dragInfo.el.style.top = Math.min(\n        Math.max(dragInfo.elStartY + event.clientY - dragInfo.mouseStartY , 0),\n        window.innerHeight - boundingRect.height\n      ) - 0.5 * window.innerHeight + \"px\";\n    };\n    document.addEventListener(\"mousemove\", mousemove);\n\n    mouseup = (event: MouseEvent) => {\n      if (options.dragPredicate && !options.dragPredicate(event.target as HTMLElement)) {\n        element.style.cursor = \"\";\n        return;\n      }\n\n      dragging = false;\n\n      element.style.cursor = \"grab\";\n      if (dragInfo === null) {\n        return;\n      }\n      if (dragInfo.oldTransition && dragInfo.el) {\n        dragInfo.el.style.transition = dragInfo.oldTransition;\n      }\n      dragInfo.el = undefined;\n      dragInfo.title.classList.remove(\"dragging\");\n      dragInfo.overlays.forEach(overlay => (overlay as HTMLElement).style.display = '');\n    };\n    document.addEventListener(\"mouseup\", mouseup);\n    \n    // If the window changes size, the dialog may be partially/completely out of bounds\n    // We fix that here\n    const resizeObserver = new ResizeObserver(async (entries) => {\n      for (const entry of entries) {\n        const dialogs = entry.target.querySelectorAll(dialogSelector);\n        for (const d of dialogs) {\n          const dialog = d as HTMLElement;\n          const boundingRect = await getElementRect(dialog);\n          dialog.style.left = Math.min(parseInt(dialog.style.left), window.innerWidth - boundingRect.width) + \"px\";\n          dialog.style.top = Math.min(parseInt(dialog.style.top), window.innerHeight - boundingRect.height) + \"px\";\n        }\n      }\n    });\n    resizeObserver.observe(document.body);\n  }\n\n  if (root.value) {\n    setupDraggable(root.value);\n  }\n\n  watch(root, newRoot => {\n    if (newRoot !== null) {\n      setupDraggable(newRoot);\n    }\n  });\n\n  onBeforeUnmount(() => {\n    const element = root.value;\n    if (element) {\n      removeListeners(element);\n      element.style.cursor = \"\";\n    }\n  });\n\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withKeys as _withKeys, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createVNode as _createVNode, unref as _unref, normalizeClass as _normalizeClass } from \"vue\"\n\nimport { computed, ref, onMounted, nextTick, watch, useAttrs, useTemplateRef } from \"vue\";\nimport { VCard } from \"vuetify/components\";\nimport { UseDraggableDialogOptions, useDraggableDialog } from \"../composables/useDraggableDialog\";\n\ninterface CDSDialogProps {\n  title: string;\n  modelValue?: boolean;\n  color?: string;\n  titleColor?: string;\n  shortTitle?: string;\n  draggable?: boolean;\n  button?: boolean;\n  scrim?: boolean;\n  persistent?: boolean;\n  modal?: boolean;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'CDSDialog',\n  props: {\n    title: {},\n    modelValue: { type: Boolean, default: false },\n    color: { default: \"red\" },\n    titleColor: { default: \"primary\" },\n    shortTitle: { default: \"\" },\n    draggable: { type: Boolean, default: false },\n    button: { type: Boolean, default: false },\n    scrim: { type: Boolean, default: true },\n    persistent: { type: Boolean, default: false },\n    modal: { type: Boolean, default: true }\n  },\n  emits: [\"update:modelValue\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst props = __props;\n\nconst emit = __emit;\n\nconst card = useTemplateRef<InstanceType<typeof VCard>>(\"card\");\nconst showDialog = ref(props.modelValue);\nconst displayedShortTitle = computed(() => props.shortTitle || props.title);\nconst cardRoot = ref<HTMLElement | null>(null);\n\nconst attrs = useAttrs();\n\nif (props.draggable) {\n  const options: UseDraggableDialogOptions = {\n    root: cardRoot,\n    dialogSelector: \".cds-dialog-card\",\n  };\n  if (attrs[\"drag-predicate\"]) {\n    options.dragPredicate = attrs[\"drag-predicate\"] as (element: HTMLElement) => boolean;\n  }\n  useDraggableDialog(options);\n}\n\nfunction updateRoot() {\n  nextTick(() => {\n    if (card.value) {\n      cardRoot.value = card.value.$el;\n    }\n  });\n}\n\nfunction close(event: PointerEvent) {\n  showDialog.value = false;\n  event.stopPropagation();\n}\n\nonMounted(() => {\n  if (props.draggable && props.modelValue) {\n    updateRoot();\n  }\n});\n\nwatch(showDialog, value => {\n  emit(\"update:modelValue\", value);\n});\n\nwatch(() => props.modelValue, value => {\n  showDialog.value = value;\n  if (value && props.draggable) {\n    updateRoot();\n  }\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_v_dialog, {\n    class: _normalizeClass(['cds-dialog', `${displayedShortTitle.value.toLowerCase().replace(/ /g, '-')}-cds-dialog`, !__props.modal ? 'nonmodal' : '']),\n    modelValue: showDialog.value,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((showDialog).value = $event)),\n    scrim: __props.scrim,\n    persistent: __props.persistent,\n    \"no-click-animation\": !__props.modal\n  }, {\n    activator: _withCtx(($attrs) => [\n      _renderSlot(_ctx.$slots, \"activator\", _normalizeProps(_guardReactiveProps($attrs)), () => [\n        (__props.button)\n          ? (_openBlock(), _createBlock(_component_v_btn, {\n              key: 0,\n              color: __props.color,\n              title: displayedShortTitle.value,\n              class: \"cds-dialog-button\",\n              onClick: _cache[0] || (_cache[0] = ($event: any) => (showDialog.value = true)),\n              onKeyup: _cache[1] || (_cache[1] = _withKeys(($event: any) => (showDialog.value = true), [\"enter\"])),\n              tabindex: \"0\"\n            }, {\n              default: _withCtx(() => [\n                _createTextVNode(\" Open \" + _toDisplayString(displayedShortTitle.value), 1)\n              ]),\n              _: 1\n            }, 8, [\"color\", \"title\"]))\n          : _createCommentVNode(\"\", true)\n      ])\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_unref(VCard), {\n        ref_key: \"card\",\n        ref: card,\n        class: \"cds-dialog-card\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_toolbar, {\n            density: \"compact\",\n            color: __props.titleColor\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_toolbar_title, { text: __props.title }, null, 8, [\"text\"]),\n              _createVNode(_component_v_spacer),\n              _createVNode(_component_v_btn, {\n                class: \"cds-dialog-close-icon\",\n                icon: \"mdi-close\",\n                onClick: close,\n                \"onKeyup:enter\": close\n              })\n            ]),\n            _: 1\n          }, 8, [\"color\"]),\n          _createVNode(_component_v_card_text, null, {\n            default: _withCtx(() => [\n              _renderSlot(_ctx.$slots, \"default\", {}, () => [\n                _cache[3] || (_cache[3] = _createTextVNode(\" Add content to the default slot \", -1))\n              ])\n            ]),\n            _: 3\n          })\n        ]),\n        _: 3\n      }, 512)\n    ]),\n    _: 3\n  }, 8, [\"class\", \"modelValue\", \"scrim\", \"persistent\", \"no-click-animation\"]))\n}\n}\n\n})","<template>\n  <v-dialog \n    :class=\"['cds-dialog', `${displayedShortTitle.toLowerCase().replace(/ /g, '-')}-cds-dialog`, !modal ? 'nonmodal' : '']\" \n    v-model=\"showDialog\" \n    :scrim=\"scrim\"\n    :persistent=\"persistent\"\n    :no-click-animation=\"!modal\"\n    >\n    <!-- add the activator slot, but only use it if the appropriate value is given for activator -->\n     <template v-slot:activator=\"$attrs\">\n      <slot name=\"activator\" v-bind=\"$attrs\">\n        <v-btn\n          v-if=\"button\"\n          :color=\"color\"\n          :title=\"displayedShortTitle\"\n          class=\"cds-dialog-button\"\n          @click=\"showDialog = true\"\n          @keyup.enter=\"showDialog = true\"\n          tabindex=\"0\"\n          >\n          Open {{ displayedShortTitle }}\n        </v-btn>\n      </slot>\n    </template>\n     \n    <v-card\n      ref=\"card\"\n      class=\"cds-dialog-card\"\n    >\n        <v-toolbar\n          density=\"compact\"\n          :color=\"titleColor\"\n        >\n          <v-toolbar-title :text=\"title\"></v-toolbar-title>\n          <v-spacer></v-spacer>\n          <v-btn\n            class=\"cds-dialog-close-icon\"\n            icon=\"mdi-close\"\n            @click=\"close\"\n            @keyup:enter=\"close\"\n          >\n          </v-btn>\n        </v-toolbar>\n      \n      <v-card-text>\n        \n        <slot>\n          Add content to the default slot\n        </slot>\n        \n      </v-card-text>\n    </v-card>\n  </v-dialog>\n\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, onMounted, nextTick, watch, useAttrs, useTemplateRef } from \"vue\";\nimport { VCard } from \"vuetify/components\";\nimport { UseDraggableDialogOptions, useDraggableDialog } from \"../composables/useDraggableDialog\";\n\ninterface CDSDialogProps {\n  title: string;\n  modelValue?: boolean;\n  color?: string;\n  titleColor?: string;\n  shortTitle?: string;\n  draggable?: boolean;\n  button?: boolean;\n  scrim?: boolean;\n  persistent?: boolean;\n  modal?: boolean;\n}\n\nconst props = withDefaults(defineProps<CDSDialogProps>(), {\n  modelValue: false,\n  color: \"red\",\n  shortTitle: \"\",\n  draggable: false,\n  button: false,\n  titleColor: \"primary\",\n  scrim: true,\n  persistent: false,\n  modal: true,\n});\n\nconst emit = defineEmits<{\n  (event: \"update:modelValue\", value: boolean): void;\n}>();\n\nconst card = useTemplateRef<InstanceType<typeof VCard>>(\"card\");\nconst showDialog = ref(props.modelValue);\nconst displayedShortTitle = computed(() => props.shortTitle || props.title);\nconst cardRoot = ref<HTMLElement | null>(null);\n\nconst attrs = useAttrs();\n\nif (props.draggable) {\n  const options: UseDraggableDialogOptions = {\n    root: cardRoot,\n    dialogSelector: \".cds-dialog-card\",\n  };\n  if (attrs[\"drag-predicate\"]) {\n    options.dragPredicate = attrs[\"drag-predicate\"] as (element: HTMLElement) => boolean;\n  }\n  useDraggableDialog(options);\n}\n\nfunction updateRoot() {\n  nextTick(() => {\n    if (card.value) {\n      cardRoot.value = card.value.$el;\n    }\n  });\n}\n\nfunction close(event: PointerEvent) {\n  showDialog.value = false;\n  event.stopPropagation();\n}\n\nonMounted(() => {\n  if (props.draggable && props.modelValue) {\n    updateRoot();\n  }\n});\n\nwatch(showDialog, value => {\n  emit(\"update:modelValue\", value);\n});\n\nwatch(() => props.modelValue, value => {\n  showDialog.value = value;\n  if (value && props.draggable) {\n    updateRoot();\n  }\n});\n\n</script>\n\n<style>\n\n.cds-dialog {\n  display: flex;\n  width: calc(100% - 1rem);\n}\n.cds-dialog-card {\n  align-self: center;\n  max-width: 80%;\n}\n\n.cds-dialog-close-icon {\n  cursor: pointer;\n}\n\n.v-dialog.cds-dialog > .v-overlay__content {\n  align-self: center;\n  margin: unset;\n}\n\n.cds-dialog .v-card-text {\n  height: fit-content;\n  max-height: 60vh;\n}\n\n.cds-dialog.nonmodal {\n\n  .v-overlay__content {\n    visibility: hidden;\n\n    .v-card {\n      visibility: visible;\n    }\n  }\n\n}\n</style>\n","import script from \"./CDSDialog.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CDSDialog.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CDSDialog.vue?vue&type=style&index=0&id=47468c07&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { resolveComponent as _resolveComponent, createVNode as _createVNode, renderSlot as _renderSlot, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"cds-marquee-alert elevation-3 sucess\"\n}\nconst _hoisted_2 = { class: \"cds-marquee-alert__content\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_avatar = _resolveComponent(\"v-avatar\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_ctx.isVisible)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createVNode(_component_v_avatar, {\n          variant: \"flat\",\n          color: \"info\",\n          icon: \"mdi-exclamation-thick\"\n        }),\n        _createElementVNode(\"div\", _hoisted_2, [\n          _renderSlot(_ctx.$slots, \"default\", {}, () => [\n            _createElementVNode(\"span\", null, _toDisplayString(_ctx.message), 1)\n          ])\n        ]),\n        _createVNode(_component_v_btn, {\n          onClick: _ctx.close,\n          class: \"cds-marquee-alert__close-button\",\n          \"aria-label\": \"Close alert\",\n          variant: \"tonal\"\n        }, {\n          default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n            _createTextVNode(\" Close \", -1)\n          ]))]),\n          _: 1\n        }, 8, [\"onClick\"])\n      ]))\n    : _createCommentVNode(\"\", true)\n}","<style>\n.cds-marquee-alert\n{\n  position: sticky;\n  top: 0;\n  left: 0;\n  /* width: 100vw; */\n  padding-inline: 1rem;\n  padding-block: 5px;\n  margin-bottom: 1rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n  background-color: rgb(var(--v-theme-success));\n  color: white;\n  z-index: 9999;\n}\n\n.cds-marquee-alert__content\n{\n  line-height: 1.5;\n  flex-grow: 1;\n}\n\n.cds-marquee-alert__close-button\n{\n  padding: 5px;\n}\n</style>\n\n<template>\n  <div v-if=\"isVisible\" class=\"cds-marquee-alert elevation-3 sucess\">\n    <v-avatar variant=\"flat\" color=\"info\" icon=\"mdi-exclamation-thick\" />\n    <div class=\"cds-marquee-alert__content\">\n      <slot>\n        <span>{{ message }}</span>\n      </slot>\n    </div>\n    <v-btn @click=\"close\" class=\"cds-marquee-alert__close-button\" aria-label=\"Close alert\" variant=\"tonal\">\n      Close\n    </v-btn>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\n\nexport default defineComponent({\n  name: 'MarqueeAlert',\n\n  props: {\n    message: {\n      type: String,\n      default: 'hello'\n    },\n    modelValue: {\n      type: Boolean,\n      required: false,\n      default: true\n    },\n    timeout: {\n      type: Number,\n      default: 5000\n    }\n  },\n  \n  mounted() {\n    setTimeout(() => {\n      this.isVisible = false;\n    }, this.timeout);\n  },\n\n  data() {\n    return {\n      isVisible: true,\n    };\n  },\n\n  methods: {\n    close() {\n      this.isVisible = false;\n    }\n  },\n\n  watch: {\n    isVisible(value) {\n      this.$emit('update:modelValue', value);\n    },\n\n    modelValue(value) {\n      this.isVisible = value;\n    }\n  }\n\n\n});\n</script>\n","import { render } from \"./MarqeeAlert.vue?vue&type=template&id=185155c3&ts=true\"\nimport script from \"./MarqeeAlert.vue?vue&type=script&lang=ts\"\nexport * from \"./MarqeeAlert.vue?vue&type=script&lang=ts\"\n\nimport \"./MarqeeAlert.vue?vue&type=style&index=0&id=185155c3&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { onMounted, computed, ref, watch, nextTick } from \"vue\";\nimport { v4 } from \"uuid\";\nimport { PlotlyHTMLElement, newPlot, restyle, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\n\nimport { AggValue, UserDataset } from \"../types\";\n\n\ninterface TimeseriesProps {\n  data: UserDataset[]; // composed selections\n  showErrors?: boolean;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'TimeseriesGraph',\n  props: {\n    data: {},\n    showErrors: { type: Boolean }\n  },\n  emits: [\"click\"],\n  setup(__props: any, { emit: __emit }) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst props = __props;\nconst sampleKeyCounts = computed(() => props.data.map(sel => Object.keys(sel.samples ?? {}).length));\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\n\nconst emit = __emit;\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst traceVisible = ref<Map<string, boolean>>(new Map());\n\nfunction renderPlot() {\n\n  errorTraces = [];\n  \n  const plotlyData: Data[] = [];\n  if (props.data.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  \n  if (props.data.map(sel => Object.keys(sel.samples ?? {}).length).every(len => len === 0)) {\n    console.log(\"No samples provided for timeseries graph\");\n    return;\n  }\n\n  let max = 0;\n  props.data.forEach(data => {\n    const samples = data.samples;\n    if (!samples) { return; }\n    // derive color from region if present\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n    const regionColor = (data as any).region?.color;\n    const ts = Object.keys(samples).sort();\n    const dataT: Date[] = [];\n    const dataV: (number | null)[] = [];\n    ts.forEach(t => {\n      const point: AggValue = samples[t];\n      if (point.value !== null) {\n        dataT.push(point.date);\n        dataV.push(point.value);\n      }\n    });\n    max = Math.max(max, Math.max(...dataV.filter((v): v is number => v !== null)));\n\n    const legendGroup = v4();\n    if (!traceVisible.value.has(data.id)) {\n      traceVisible.value.set(data.id, true);\n    }\n    legendGroups[data.id] = legendGroup;\n    plotlyData.push({\n      x: dataT,\n      y: dataV,\n      mode: \"lines+markers\",\n      legendgroup: legendGroup,\n      showlegend: true,\n      name: data.region.name,\n      marker: { color: regionColor },\n      visible: traceVisible.value.get(data.id) ? true : \"legendonly\",\n    });\n\n    const errors = data.errors;\n    if (errors != null) {\n      const upperY: (number | null)[] = [];\n      const lowerY: (number | null)[] = [];\n\n      ts.forEach(t => {\n        const point: AggValue = samples[t];\n        const value = point.value;\n        const errs = errors[t];\n        if (value === null || errs == null) {\n          // lowerY.push(null);\n          // upperY.push(null);\n          return;\n        }\n        const { lower, upper } = errs;\n        const valueLower = value - lower;\n        const valueHigher = value + upper;\n        const low = Math.min(valueLower, valueHigher);\n        const high = Math.max(valueLower, valueHigher);\n        max = Math.max(max, high);\n        lowerY.push(low);\n        upperY.push(high);\n      });\n\n      plotlyData.push({\n        x: dataT,\n        y: lowerY,\n        mode: \"lines\",\n        line: { width: 0 },\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n\n      plotlyData.push({\n        x: dataT,\n        y: upperY,\n        mode: \"lines\",\n        line: { width: 0 },\n        fill: \"tonexty\",\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const layout = {\n    width: 600,\n    height: 400,\n    yaxis: {\n      title: { text: \"Molecules / cm<sup>2</sup>\" },\n      range: [0, axisMax],\n    }\n  };\n\n  newPlot(graph.value ?? id, plotlyData, layout).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", { date, value: point.y as number });\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plotlyData[data.curveNumber];\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (!group) { \n        console.error(\"No legend group for trace\", trace);\n        return true; \n      }\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (!dataId) { \n        console.error(\"Could not find data ID for legend group\", group);\n        return true; \n      }\n      const currentlyVisible = traceVisible.value.get(dataId);\n      traceVisible.value.set(dataId, !currentlyVisible);\n      // if currently visible and errors are visible set stlye the error traces too\n      nextTick(() => { // next tick so that updated traceVisible is available\n        if (currentlyVisible && props.showErrors) {\n          updateErrorDisplay(true);\n        }\n      });\n      return true;\n    });\n  });\n}\n\nfunction updateErrorDisplay(visible: boolean) {\n  if (graph.value) {\n    errorTraces.forEach((traceIndex) => {\n      const trace = plot.value?.data[traceIndex];\n      if (!trace) return;\n      if (!graph.value) return;\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (dataId && traceVisible.value.get(dataId)) {\n        restyle(graph.value, { visible }, [traceIndex]);\n      } \n    });\n  }\n}\n\n\nonMounted(() => {\n  renderPlot();\n});\n\n\nwatch(() => props.showErrors, updateErrorDisplay);\n\nwatch(sampleKeyCounts, (newCounts: number[], oldCounts: number[]) => {\n  const different = (newCounts.length != oldCounts.length) && \n                    newCounts.some((value, index) => value !== oldCounts[index]);\n  if (!different) {\n    return;\n  }\n  if (newCounts.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  console.log(\"Data changed, re-rendering plot\");\n  renderPlot();\n});\n\nwatch(() => props.data, (newData, oldData) => {\n  console.log(\"Data prop changed, re-rendering plot\");\n  renderPlot();\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref_key: \"graph\",\n    ref: graph,\n    id: id,\n    class: \"timeseries\"\n  }, null, 512))\n}\n}\n\n})","<!-- eslint-disable @typescript-eslint/no-unused-vars -->\n<template>\n  <div\n    ref=\"graph\"\n    :id=\"id\"\n    class=\"timeseries\"\n  >\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { onMounted, computed, ref, watch, nextTick } from \"vue\";\nimport { v4 } from \"uuid\";\nimport { PlotlyHTMLElement, newPlot, restyle, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\n\nimport { AggValue, UserDataset } from \"../types\";\n\n\ninterface TimeseriesProps {\n  data: UserDataset[]; // composed selections\n  showErrors?: boolean;\n}\n\nconst props = defineProps<TimeseriesProps>();\nconst sampleKeyCounts = computed(() => props.data.map(sel => Object.keys(sel.samples ?? {}).length));\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\n\nconst emit = defineEmits<{\n  (event: \"click\", value: AggValue): void;\n}>();\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst traceVisible = ref<Map<string, boolean>>(new Map());\n\nfunction renderPlot() {\n\n  errorTraces = [];\n  \n  const plotlyData: Data[] = [];\n  if (props.data.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  \n  if (props.data.map(sel => Object.keys(sel.samples ?? {}).length).every(len => len === 0)) {\n    console.log(\"No samples provided for timeseries graph\");\n    return;\n  }\n\n  let max = 0;\n  props.data.forEach(data => {\n    const samples = data.samples;\n    if (!samples) { return; }\n    // derive color from region if present\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n    const regionColor = (data as any).region?.color;\n    const ts = Object.keys(samples).sort();\n    const dataT: Date[] = [];\n    const dataV: (number | null)[] = [];\n    ts.forEach(t => {\n      const point: AggValue = samples[t];\n      if (point.value !== null) {\n        dataT.push(point.date);\n        dataV.push(point.value);\n      }\n    });\n    max = Math.max(max, Math.max(...dataV.filter((v): v is number => v !== null)));\n\n    const legendGroup = v4();\n    if (!traceVisible.value.has(data.id)) {\n      traceVisible.value.set(data.id, true);\n    }\n    legendGroups[data.id] = legendGroup;\n    plotlyData.push({\n      x: dataT,\n      y: dataV,\n      mode: \"lines+markers\",\n      legendgroup: legendGroup,\n      showlegend: true,\n      name: data.region.name,\n      marker: { color: regionColor },\n      visible: traceVisible.value.get(data.id) ? true : \"legendonly\",\n    });\n\n    const errors = data.errors;\n    if (errors != null) {\n      const upperY: (number | null)[] = [];\n      const lowerY: (number | null)[] = [];\n\n      ts.forEach(t => {\n        const point: AggValue = samples[t];\n        const value = point.value;\n        const errs = errors[t];\n        if (value === null || errs == null) {\n          // lowerY.push(null);\n          // upperY.push(null);\n          return;\n        }\n        const { lower, upper } = errs;\n        const valueLower = value - lower;\n        const valueHigher = value + upper;\n        const low = Math.min(valueLower, valueHigher);\n        const high = Math.max(valueLower, valueHigher);\n        max = Math.max(max, high);\n        lowerY.push(low);\n        upperY.push(high);\n      });\n\n      plotlyData.push({\n        x: dataT,\n        y: lowerY,\n        mode: \"lines\",\n        line: { width: 0 },\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n\n      plotlyData.push({\n        x: dataT,\n        y: upperY,\n        mode: \"lines\",\n        line: { width: 0 },\n        fill: \"tonexty\",\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const layout = {\n    width: 600,\n    height: 400,\n    yaxis: {\n      title: { text: \"Molecules / cm<sup>2</sup>\" },\n      range: [0, axisMax],\n    }\n  };\n\n  newPlot(graph.value ?? id, plotlyData, layout).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", { date, value: point.y as number });\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plotlyData[data.curveNumber];\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (!group) { \n        console.error(\"No legend group for trace\", trace);\n        return true; \n      }\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (!dataId) { \n        console.error(\"Could not find data ID for legend group\", group);\n        return true; \n      }\n      const currentlyVisible = traceVisible.value.get(dataId);\n      traceVisible.value.set(dataId, !currentlyVisible);\n      // if currently visible and errors are visible set stlye the error traces too\n      nextTick(() => { // next tick so that updated traceVisible is available\n        if (currentlyVisible && props.showErrors) {\n          updateErrorDisplay(true);\n        }\n      });\n      return true;\n    });\n  });\n}\n\nfunction updateErrorDisplay(visible: boolean) {\n  if (graph.value) {\n    errorTraces.forEach((traceIndex) => {\n      const trace = plot.value?.data[traceIndex];\n      if (!trace) return;\n      if (!graph.value) return;\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (dataId && traceVisible.value.get(dataId)) {\n        restyle(graph.value, { visible }, [traceIndex]);\n      } \n    });\n  }\n}\n\n\nonMounted(() => {\n  renderPlot();\n});\n\n\nwatch(() => props.showErrors, updateErrorDisplay);\n\nwatch(sampleKeyCounts, (newCounts: number[], oldCounts: number[]) => {\n  const different = (newCounts.length != oldCounts.length) && \n                    newCounts.some((value, index) => value !== oldCounts[index]);\n  if (!different) {\n    return;\n  }\n  if (newCounts.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  console.log(\"Data changed, re-rendering plot\");\n  renderPlot();\n});\n\nwatch(() => props.data, (newData, oldData) => {\n  console.log(\"Data prop changed, re-rendering plot\");\n  renderPlot();\n});\n\n</script>\n\n<style scoped>\n.timeseries:not(:empty) {\n  width: 600px;\n  height: 400px;\n}\n</style>\n","import script from \"./TimeseriesGraph.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TimeseriesGraph.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TimeseriesGraph.vue?vue&type=style&index=0&id=bdb40e34&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bdb40e34\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, createElementVNode as _createElementVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"d-flex ga-2\" }\n\nimport { computed, ref, watch } from \"vue\";\nimport { v4 } from \"uuid\";\n\nimport type { MappingBackends, RectangleSelection, TimeRange, UserDataset } from \"../types\";\nimport type { MillisecondRange } from \"../types/datetime\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"../esri/utils\";\n\ninterface SelectionComposerProps {\n  backend: MappingBackends;\n  timeRanges: TimeRange[];\n  regions: RectangleSelectionType[];\n  disabled?: { region?: boolean; timeRange?: boolean; molecule?: boolean };\n}\n\ntype RectangleSelectionType = RectangleSelection;\n\ninterface DraftUserDataset {\n  region?: RectangleSelectionType | null;\n  timeRange?: TimeRange | null;\n  molecule?: MoleculeType | null;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'SelectionComposer',\n  props: {\n    backend: {},\n    timeRanges: {},\n    regions: {},\n    disabled: {}\n  },\n  emits: [\"create\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst selectedTimeRange = ref<TimeRange | null>(null);\n\nconst props = __props;\n\nconst emit = __emit;\n\nconst loading = ref(false);\n\nconst draftUserDataset = ref<DraftUserDataset>({ region: null, timeRange: null, molecule: null });\nconst availableMolecules = computed(() => MOLECULE_OPTIONS.map(o => ({ key: o.value as MoleculeType, title: o.title })));\n\n// Public composition progress\nconst creationProgress = computed(() => {\n  let count = 0;\n  if (draftUserDataset.value.region) count += 1;\n  if (draftUserDataset.value.timeRange) count += 1;\n  if (draftUserDataset.value.molecule) count += 1;\n  return { count, percent: (count / 3) * 100 };\n});\n\nfunction setDraftSelectionRegion(region: RectangleSelectionType | null) {\n  (draftUserDataset.value.region as RectangleSelectionType | null) = region || null;\n}\n\nfunction setDraftSelectionMolecule(molecule: MoleculeType | null) {\n  draftUserDataset.value.molecule = molecule || null;\n}\n\nfunction setDraftSelectionTimeRange(range: TimeRange | null) {\n  draftUserDataset.value.timeRange = range || null;\n}\n\nasync function composeSelection(): Promise<UserDataset | null> {\n  // const color = COLORS[selectionCount % COLORS.length]; // we will use the color from the region\n  \n  const draft = draftUserDataset.value;\n  if (!draft.region || !draft.timeRange || !draft.molecule) {\n    console.error('Draft selection incomplete');\n    return null;\n  }\n  \n  const sel: UserDataset = {\n    id: v4(),\n    region: draft.region, // as { id: string; name: string; rectangle: RectangleSelectionInfo; color: string; layer?: unknown },\n    timeRange: draft.timeRange,\n    molecule: draft.molecule as MoleculeType,\n  };\n  emit(\"create\", sel);\n  return sel;\n}\n\n\nfunction reset() {\n  draftUserDataset.value = { region: null, timeRange: null, molecule: null };\n  selectedTimeRange.value = null;\n}\n\nwatch(selectedTimeRange, (timeRange: TimeRange | null) => {\n  setDraftSelectionTimeRange(timeRange ?? null);\n});\n\n// just watch the id's. using a 'deep' watch caused a significant performance hit\nwatch(() => props.regions.map(r => r.id), (newRegions) => {\n  if (draftUserDataset.value.region) {\n    const exists = newRegions.find(rid => rid === draftUserDataset.value.region?.id);\n    if (!exists) {\n      draftUserDataset.value.region = null;\n    }\n  }\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_chip = _resolveComponent(\"v-chip\")!\n  const _component_v_card_title = _resolveComponent(\"v-card-title\")!\n  const _component_v_list_item_title = _resolveComponent(\"v-list-item-title\")!\n  const _component_v_list_item_subtitle = _resolveComponent(\"v-list-item-subtitle\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_select = _resolveComponent(\"v-select\")!\n  const _component_v_progress_linear = _resolveComponent(\"v-progress-linear\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_card_title, { class: \"d-flex justify-space-between\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_chip, {\n            size: \"x-small\",\n            color: \"primary\",\n            variant: \"tonal\"\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(creationProgress.value.count) + \"/3\", 1)\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_v_card_text, { class: \"d-flex flex-column ga-3\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_select, {\n            items: __props.timeRanges,\n            modelValue: selectedTimeRange.value,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((selectedTimeRange).value = $event)),\n            label: \"Time Range\",\n            disabled: __props.disabled?.timeRange,\n            density: \"compact\",\n            \"hide-details\": \"\",\n            variant: \"outlined\",\n            \"return-object\": \"\"\n          }, {\n            item: _withCtx(({ index, props }) => [\n              _createVNode(_component_v_list_item, _normalizeProps(_guardReactiveProps({ ...props, title: props.value.name })), {\n                title: _withCtx(() => [...(_cache[3] || (_cache[3] = []))]),\n                default: _withCtx(() => [\n                  _createVNode(_component_v_list_item_title, null, {\n                    default: _withCtx(() => [\n                      _createTextVNode(_toDisplayString(__props.timeRanges[index].name), 1)\n                    ]),\n                    _: 2\n                  }, 1024),\n                  (__props.timeRanges[index].name === 'Displayed Day')\n                    ? (_openBlock(), _createBlock(_component_v_list_item_subtitle, { key: 0 }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(new Date((__props.timeRanges[index].range as MillisecondRange).start).toDateString()), 1)\n                        ]),\n                        _: 2\n                      }, 1024))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                _: 2\n              }, 1040)\n            ]),\n            selection: _withCtx(() => [\n              _createTextVNode(_toDisplayString(selectedTimeRange.value?.name || 'Select Time Range'), 1)\n            ]),\n            _: 1\n          }, 8, [\"items\", \"modelValue\", \"disabled\"]),\n          _createVNode(_component_v_select, {\n            items: __props.regions.map(r => ({ title: r.name, value: r })),\n            \"model-value\": draftUserDataset.value.region,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => (setDraftSelectionRegion($event as RectangleSelectionType))),\n            label: \"Region\",\n            disabled: __props.disabled?.region,\n            \"item-title\": \"title\",\n            \"item-value\": \"value\",\n            density: \"compact\",\n            \"hide-details\": \"\",\n            variant: \"outlined\"\n          }, null, 8, [\"items\", \"model-value\", \"disabled\"]),\n          _createVNode(_component_v_select, {\n            items: availableMolecules.value.map(m => ({ title: m.title, value: m.key })),\n            \"model-value\": draftUserDataset.value.molecule,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => (setDraftSelectionMolecule($event))),\n            label: \"Molecule\",\n            disabled: __props.disabled?.molecule,\n            \"item-title\": \"title\",\n            \"item-value\": \"value\",\n            density: \"compact\",\n            \"hide-details\": \"\",\n            variant: \"outlined\"\n          }, null, 8, [\"items\", \"model-value\", \"disabled\"]),\n          _createVNode(_component_v_progress_linear, {\n            \"model-value\": creationProgress.value.percent,\n            height: \"6\",\n            color: \"primary\",\n            rounded: \"\"\n          }, null, 8, [\"model-value\"]),\n          _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_v_btn, {\n              color: \"primary\",\n              disabled: creationProgress.value.count < 3,\n              onClick: composeSelection,\n              size: \"small\",\n              loading: loading.value\n            }, {\n              loader: _withCtx(() => [\n                _createVNode(_component_v_progress_linear, { indeterminate: \"\" })\n              ]),\n              default: _withCtx(() => [\n                _cache[4] || (_cache[4] = _createTextVNode(\" Access Data \", -1))\n              ]),\n              _: 1\n            }, 8, [\"disabled\", \"loading\"]),\n            _createVNode(_component_v_btn, {\n              color: \"secondary\",\n              variant: \"tonal\",\n              size: \"small\",\n              onClick: reset\n            }, {\n              default: _withCtx(() => [...(_cache[5] || (_cache[5] = [\n                _createTextVNode(\" Reset \", -1)\n              ]))]),\n              _: 1\n            })\n          ])\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n  <v-card>\n    <v-card-title class=\"d-flex justify-space-between\">\n      <v-chip size=\"x-small\" color=\"primary\" variant=\"tonal\">{{ creationProgress.count }}/3</v-chip>\n    </v-card-title>\n    <v-card-text class=\"d-flex flex-column ga-3\">\n      <!-- Time Range Picker: offer Effective (current day/custom) and any active custom ranges -->\n      <v-select\n        :items=\"timeRanges\"\n        v-model=\"selectedTimeRange\"\n        label=\"Time Range\"\n        :disabled=\"disabled?.timeRange\"\n        density=\"compact\"\n        hide-details\n        variant=\"outlined\"\n        return-object\n      >\n        <template #item=\"{ index, props }\">\n          <v-list-item v-bind=\"{ ...props, title: props.value.name }\">\n            <template #title></template>\n            <template #default>\n              <v-list-item-title>{{ timeRanges[index].name }}</v-list-item-title>\n              <v-list-item-subtitle\n                v-if=\"timeRanges[index].name === 'Displayed Day'\"\n              >\n                {{ new Date((timeRanges[index].range as MillisecondRange).start).toDateString() }}\n              </v-list-item-subtitle>\n            </template>\n          </v-list-item>\n        </template>\n        <template #selection>\n          {{ selectedTimeRange?.name || 'Select Time Range' }}\n        </template>\n      </v-select>\n\n      <!-- Region Picker -->\n      <v-select\n        :items=\"regions.map(r => ({ title: r.name, value: r }))\"\n        :model-value=\"draftUserDataset.region\"\n        @update:model-value=\"setDraftSelectionRegion($event as RectangleSelectionType)\"\n        label=\"Region\"\n        :disabled=\"disabled?.region\"\n        item-title=\"title\"\n        item-value=\"value\"\n        density=\"compact\"\n        hide-details\n        variant=\"outlined\"\n      />\n\n      <!-- Molecule Picker -->\n      <v-select\n        :items=\"availableMolecules.map(m => ({ title: m.title, value: m.key }))\"\n        :model-value=\"draftUserDataset.molecule\"\n        @update:model-value=\"setDraftSelectionMolecule($event)\"\n        label=\"Molecule\"\n        :disabled=\"disabled?.molecule\"\n        item-title=\"title\"\n        item-value=\"value\"\n        density=\"compact\"\n        hide-details\n        variant=\"outlined\"\n      />\n\n      <v-progress-linear :model-value=\"creationProgress.percent\" height=\"6\" color=\"primary\" rounded></v-progress-linear>\n\n      <div class=\"d-flex ga-2\">\n        <v-btn\n          color=\"primary\"\n          :disabled=\"creationProgress.count < 3\"\n          @click=\"composeSelection\"\n          size=\"small\"\n          :loading=\"loading\"\n        >\n          <template #loader>\n            <v-progress-linear\n              indeterminate\n            ></v-progress-linear>\n          </template>\n          Access Data\n        </v-btn>\n        <v-btn\n          color=\"secondary\"\n          variant=\"tonal\"\n          size=\"small\"\n          @click=\"reset\"\n        >\n          Reset\n        </v-btn>\n      </div>\n    </v-card-text>\n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport { v4 } from \"uuid\";\n\nimport type { MappingBackends, RectangleSelection, TimeRange, UserDataset } from \"../types\";\nimport type { MillisecondRange } from \"../types/datetime\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"../esri/utils\";\n\nconst selectedTimeRange = ref<TimeRange | null>(null);\n\ninterface SelectionComposerProps {\n  backend: MappingBackends;\n  timeRanges: TimeRange[];\n  regions: RectangleSelectionType[];\n  disabled?: { region?: boolean; timeRange?: boolean; molecule?: boolean };\n}\n\nconst props = defineProps<SelectionComposerProps>();\n\nconst emit = defineEmits<{\n  (event: \"create\", selection: UserDataset): void;\n}>();\n\nconst loading = ref(false);\n\ntype RectangleSelectionType = RectangleSelection;\n\ninterface DraftUserDataset {\n  region?: RectangleSelectionType | null;\n  timeRange?: TimeRange | null;\n  molecule?: MoleculeType | null;\n}\nconst draftUserDataset = ref<DraftUserDataset>({ region: null, timeRange: null, molecule: null });\nconst availableMolecules = computed(() => MOLECULE_OPTIONS.map(o => ({ key: o.value as MoleculeType, title: o.title })));\n\n// Public composition progress\nconst creationProgress = computed(() => {\n  let count = 0;\n  if (draftUserDataset.value.region) count += 1;\n  if (draftUserDataset.value.timeRange) count += 1;\n  if (draftUserDataset.value.molecule) count += 1;\n  return { count, percent: (count / 3) * 100 };\n});\n\nfunction setDraftSelectionRegion(region: RectangleSelectionType | null) {\n  (draftUserDataset.value.region as RectangleSelectionType | null) = region || null;\n}\n\nfunction setDraftSelectionMolecule(molecule: MoleculeType | null) {\n  draftUserDataset.value.molecule = molecule || null;\n}\n\nfunction setDraftSelectionTimeRange(range: TimeRange | null) {\n  draftUserDataset.value.timeRange = range || null;\n}\n\nasync function composeSelection(): Promise<UserDataset | null> {\n  // const color = COLORS[selectionCount % COLORS.length]; // we will use the color from the region\n  \n  const draft = draftUserDataset.value;\n  if (!draft.region || !draft.timeRange || !draft.molecule) {\n    console.error('Draft selection incomplete');\n    return null;\n  }\n  \n  const sel: UserDataset = {\n    id: v4(),\n    region: draft.region, // as { id: string; name: string; rectangle: RectangleSelectionInfo; color: string; layer?: unknown },\n    timeRange: draft.timeRange,\n    molecule: draft.molecule as MoleculeType,\n  };\n  emit(\"create\", sel);\n  return sel;\n}\n\n\nfunction reset() {\n  draftUserDataset.value = { region: null, timeRange: null, molecule: null };\n  selectedTimeRange.value = null;\n}\n\nwatch(selectedTimeRange, (timeRange: TimeRange | null) => {\n  setDraftSelectionTimeRange(timeRange ?? null);\n});\n\n// just watch the id's. using a 'deep' watch caused a significant performance hit\nwatch(() => props.regions.map(r => r.id), (newRegions) => {\n  if (draftUserDataset.value.region) {\n    const exists = newRegions.find(rid => rid === draftUserDataset.value.region?.id);\n    if (!exists) {\n      draftUserDataset.value.region = null;\n    }\n  }\n});\n</script>\n\n<style scoped>\n.v-progress-linear {\n  width: 80%;\n}\n</style>\n","import script from \"./SelectionComposer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SelectionComposer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SelectionComposer.vue?vue&type=style&index=0&id=c6a1b998&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c6a1b998\"]])\n\nexport default __exports__","export default [\n  {\n    date: \"2025-04-24\",\n    html: 'Educational resources designed for for informal educators (e.g., in museums, public outreach) are now available on the Cosmic Data Stories website at <a style=\"font-weight: normal;\" tabindex=\"0\"  href=\"https://www.cosmicds.cfa.harvard.edu/resources/tempo\" target=\"_blank\" rel=\"noopener\">Educator Resources</a>. You can also find the link the menu.',\n    highlight: new Date() < new Date('2025-05-7 00:00:00') ,\n    \n  },\n  {\n    date: \"2025-02-02\",\n    html:\n      'During the LA fires that began on Jan 7th, NO<sub>2</sub> levels far exceeded the default range displayed on our maps. For Jan 7 - Feb 2, 2025, we added an option to use an extended range of NO<sub>2</sub> values. For those dates, a button appears on the map to toggle between the standard and extended range.',\n      \n  },\n  {\n    date: \"2025-01-21\",\n    text:\n      \"Enable viewing the full resolution data. By default this is always off, displaying data at 1/2 the native Level 3 resolution for better performance\"\n  },\n  {\n    date: \"2025-01-09\",\n    text:\n      \"We have added a new sharable url feature! Click the share icon to copy a link for the current view (location, zoom level, date, and time) to your clipboard.\",\n  },\n  {\n    date: \"2024-11-29\",\n    text:\n      \"We are in the process of updating our data processing routines and images to use averaging rather than the nearest-neighbor pixel value when reprojecting. TEMPO images for dates after Nov 29th use the new pipeline, and past images will be updated over time\",\n  },\n];\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\"\nimport _imports_0 from '@/assets/TEMPO-Logo-Small.png'\n\n\nconst _hoisted_1 = { class: \"header\" }\nconst _hoisted_2 = { class: \"snackbar-alert-ul\" }\nconst _hoisted_3 = [\"data-date\"]\nconst _hoisted_4 = [\"innerHTML\"]\nconst _hoisted_5 = { id: \"menu-area\" }\nconst _hoisted_6 = {\n  style: {\"font-weight\":\"normal\"},\n  tabindex: \"0\",\n  href: \"https://www.cosmicds.cfa.harvard.edu/resources/tempo\",\n  target: \"_blank\",\n  rel: \"noopener\"\n}\n\nimport { computed, ref } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { useDisplay } from \"vuetify\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { useTempoStore } from \"@/stores/app\";\nimport changes from \"@/changes\";\n\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faArrowsRotate } from \"@fortawesome/free-solid-svg-icons\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'HeaderBar',\n  emits: [\"intro-slide\"],\n  setup(__props, { emit: __emit }) {\n\nlibrary.add(faArrowsRotate);\n\nconst emit = __emit;\n\nconst store = useTempoStore();\nconst {\n  accentColor2,\n  shareButtonClickedCount,\n} = storeToRefs(store);\n\nconst display = useDisplay();\n\nconst currentUrl = ref(window.location.href);\nconst showChanges = ref(false);\nconst showAboutData = ref(false);\nconst showCredits = ref(false);\n\nconst touchscreen = supportsTouchscreen();\n\nconst smallSize = computed(() => {\n  return display.smAndDown.value;\n});\n\n\nconst mobile = computed(() => {\n  return smallSize.value && touchscreen;\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_cds_dialog = _resolveComponent(\"cds-dialog\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_share_button = _resolveComponent(\"share-button\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_list = _resolveComponent(\"v-list\")!\n  const _component_v_menu = _resolveComponent(\"v-menu\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _cache[25] || (_cache[25] = _createElementVNode(\"div\", { id: \"logo-title\" }, [\n      _createElementVNode(\"a\", {\n        href: \"https://tempo.si.edu\",\n        target: \"_blank\",\n        rel: \"noopener noreferrer\"\n      }, [\n        _createElementVNode(\"img\", {\n          src: _imports_0,\n          alt: \"TEMPO Logo\",\n          style: {\"width\":\"100px\",\"height\":\"100px\"}\n        })\n      ])\n    ], -1)),\n    _cache[26] || (_cache[26] = _createElementVNode(\"h1\", { id: \"title\" }, \"TEMPO Lab: Investigate Air Quality\", -1)),\n    _createVNode(_component_cds_dialog, {\n      title: \"What's new\",\n      modelValue: showChanges.value,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((showChanges).value = $event)),\n      color: _unref(accentColor2)\n    }, {\n      default: _withCtx(() => [\n        _createElementVNode(\"ul\", _hoisted_2, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(changes), (change) => {\n            return (_openBlock(), _createElementBlock(\"li\", {\n              class: \"change-item mb-5\",\n              key: change.date,\n              \"data-date\": change.date\n            }, [\n              _createElementVNode(\"span\", {\n                style: _normalizeStyle({\"font-weight\":\"bold\", \"color\": `${change.highlight ? \"var(--smithsonian-yellow)\" : \"currentColor\"}` })\n              }, _toDisplayString(change.date), 5),\n              _cache[14] || (_cache[14] = _createElementVNode(\"br\", null, null, -1)),\n              _cache[15] || (_cache[15] = _createTextVNode()),\n              _createElementVNode(\"span\", {\n                innerHTML: change.html\n              }, null, 8, _hoisted_4),\n              _createTextVNode(_toDisplayString(change.text), 1)\n            ], 8, _hoisted_3))\n          }), 128))\n        ])\n      ]),\n      _: 1\n    }, 8, [\"modelValue\", \"color\"]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      ((new Date('2025-05-7 00:00:00') > new Date()))\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 0,\n            class: \"whats-new-button pulse\",\n            \"aria-label\": \"What's new\",\n            onClick: _cache[1] || (_cache[1] = ($event: any) => (showChanges.value = true)),\n            onKeyup: _cache[2] || (_cache[2] = _withKeys(($event: any) => (showChanges.value = true), [\"enter\"])),\n            variant: \"outlined\",\n            rounded: \"lg\",\n            color: _unref(accentColor2),\n            elevation: \"0\",\n            size: \"lg\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_tooltip, {\n                location: \"bottom\",\n                activator: \"parent\",\n                disabled: mobile.value,\n                text: \"What's new\"\n              }, null, 8, [\"disabled\"]),\n              _createVNode(_component_v_icon, null, {\n                default: _withCtx(() => [...(_cache[16] || (_cache[16] = [\n                  _createTextVNode(\"mdi-creation\", -1)\n                ]))]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }, 8, [\"color\"]))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_share_button, {\n        source: currentUrl.value,\n        buttonColor: \"black\",\n        iconColor: _unref(accentColor2),\n        elevation: \"0\",\n        size: \"small\",\n        rounded: \"1\",\n        \"tooltip-disabled\": mobile.value,\n        onClick: _cache[3] || (_cache[3] = ($event: any) => (shareButtonClickedCount.value += 1)),\n        alert: \"\"\n      }, null, 8, [\"source\", \"iconColor\", \"tooltip-disabled\"]),\n      _createVNode(_component_v_btn, {\n        \"aria-role\": \"menu\",\n        \"aria-label\": \"Show menu\",\n        class: \"menu-button\",\n        variant: \"outlined\",\n        rounded: \"lg\",\n        color: _unref(accentColor2),\n        elevation: \"5\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_icon, { size: \"x-large\" }, {\n            default: _withCtx(() => [...(_cache[17] || (_cache[17] = [\n              _createTextVNode(\"mdi-menu\", -1)\n            ]))]),\n            _: 1\n          }),\n          _createVNode(_component_v_menu, { activator: \"parent\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_list, null, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"See recent changes\",\n                    onClick: _cache[4] || (_cache[4] = ($event: any) => (showChanges.value = true)),\n                    onKeyup: _cache[5] || (_cache[5] = _withKeys(($event: any) => (showChanges.value = true), [\"enter\"]))\n                  }, {\n                    default: _withCtx(() => [...(_cache[18] || (_cache[18] = [\n                      _createTextVNode(\" What's New \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show introduction\",\n                    onClick: _cache[6] || (_cache[6] = () => emit('intro-slide', 1)),\n                    onKeyup: _cache[7] || (_cache[7] = _withKeys(() => emit('intro-slide', 1), [\"enter\"]))\n                  }, {\n                    default: _withCtx(() => [...(_cache[19] || (_cache[19] = [\n                      _createTextVNode(\" Introduction \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show user guide\",\n                    onClick: _cache[8] || (_cache[8] = () => emit('intro-slide', 4)),\n                    onKeyup: _cache[9] || (_cache[9] = _withKeys(() => emit('intro-slide', 4), [\"enter\"]))\n                  }, {\n                    default: _withCtx(() => [...(_cache[20] || (_cache[20] = [\n                      _createTextVNode(\" User Guide \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show dialog telling about the data\",\n                    onClick: _cache[10] || (_cache[10] = ($event: any) => (showAboutData.value = true)),\n                    onKeyup: _cache[11] || (_cache[11] = _withKeys(($event: any) => (showAboutData.value = true), [\"enter\"]))\n                  }, {\n                    default: _withCtx(() => [...(_cache[21] || (_cache[21] = [\n                      _createTextVNode(\" About the Data \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, { \"aria-label\": \"Leave Page to Educator Resources\" }, {\n                    default: _withCtx(() => [\n                      _createElementVNode(\"a\", _hoisted_6, [\n                        _cache[23] || (_cache[23] = _createTextVNode(\"Educator Resources\", -1)),\n                        _createVNode(_component_v_icon, null, {\n                          default: _withCtx(() => [...(_cache[22] || (_cache[22] = [\n                            _createTextVNode(\"mdi-open-in-new\", -1)\n                          ]))]),\n                          _: 1\n                        })\n                      ])\n                    ]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show credits\",\n                    onClick: _cache[12] || (_cache[12] = ($event: any) => (showCredits.value = true)),\n                    onKeyup: _cache[13] || (_cache[13] = _withKeys(($event: any) => (showCredits.value = true), [\"enter\"]))\n                  }, {\n                    default: _withCtx(() => [...(_cache[24] || (_cache[24] = [\n                      _createTextVNode(\" Credits \", -1)\n                    ]))]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"color\"])\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"header\">\n    <!-- tempo logo -->\n    <div id=\"logo-title\">\n    <a href=\"https://tempo.si.edu\" target=\"_blank\" rel=\"noopener noreferrer\" >\n      <img \n        src=\"@/assets/TEMPO-Logo-Small.png\"\n        alt=\"TEMPO Logo\"\n        style=\"width: 100px; height: 100px;\"\n      >\n    </a>\n    </div>\n\n    <h1 id=\"title\">TEMPO Lab: Investigate Air Quality</h1>\n    <!-- <cds-dialog\n      title=\"Time Series\"\n      v-model=\"samplesGraph\"\n      :color=\"accentColor2\"\n      draggable\n      :scrim=\"false\"\n      :drag-predicate=\"(element: HTMLElement) => element.closest('.plotly') == null\"\n    >\n      <timeseries-graph\n        v-if=\"userSelections.length > 0\"\n        :data=\"userSelections\"\n      />\n    </cds-dialog> -->\n\n    <!-- </div> -->\n    <cds-dialog title=\"What's new\" v-model=\"showChanges\" :color=\"accentColor2\">\n      <ul class=\"snackbar-alert-ul\">\n        <li class=\"change-item mb-5\" v-for=\"change in changes\" :key=\"change.date\" :data-date=\"change.date\">\n          <span :style='{\"font-weight\":\"bold\", \"color\": `${change.highlight ? \"var(--smithsonian-yellow)\" : \"currentColor\"}` }'>{{ change.date }}</span><br> <span v-html=\"change.html\">  </span>{{ change.text }}\n        </li>\n      </ul>\n      <!-- <template v-slot:activator=\"{ onClick, id }\">\n        <v-btn :id=\"id\" @click=\"onClick\" color=\"primary\">\n          Custom Activator\n        </v-btn>\n      </template>  -->\n    </cds-dialog>\n\n    <div id=\"menu-area\">\n      <v-btn \n        v-if=\"(new Date('2025-05-7 00:00:00') > new Date())\"\n        class='whats-new-button pulse' \n        aria-label=\"What's new\" \n        @click=\"showChanges = true\" \n        @keyup.enter=\"showChanges = true\" \n        variant=\"outlined\" \n        rounded=\"lg\" \n        :color=\"accentColor2\" \n        elevation=\"0\"\n        size=\"lg\"\n        >\n        <v-tooltip location=\"bottom\" activator=\"parent\" :disabled=\"mobile\" text=\"What's new\"></v-tooltip>\n        <v-icon>mdi-creation</v-icon>\n      </v-btn>\n      <share-button\n        :source=\"currentUrl\"\n        buttonColor=\"black\"\n        :iconColor=\"accentColor2\"\n        elevation=\"0\"\n        size=\"small\"\n        rounded=\"1\"\n        :tooltip-disabled=\"mobile\"\n        @click=\"shareButtonClickedCount += 1\"\n        alert\n      />\n      <v-btn aria-role=\"menu\" aria-label=\"Show menu\" class=\"menu-button\" variant=\"outlined\" rounded=\"lg\" :color=\"accentColor2\" elevation=\"5\">\n        <v-icon size=\"x-large\">mdi-menu</v-icon>\n        <v-menu\n          activator=\"parent\"\n          >\n          <v-list>\n            <v-list-item \n              tabindex=\"0\"\n              aria-label=\"See recent changes\"\n              @click=\"showChanges = true\"\n              @keyup.enter=\"showChanges = true\"\n              >\n              What's New\n            </v-list-item>\n\n            <v-list-item \n              tabindex=\"0\" \n              aria-label=\"Show introduction\"\n              @click=\"() => emit('intro-slide', 1)\"\n              @keyup.enter=\"() => emit('intro-slide', 1)\"\n              >\n                Introduction\n            </v-list-item>\n            \n            <v-list-item \n              tabindex=\"0\"\n              aria-label=\"Show user guide\"\n              @click=\"() => emit('intro-slide', 4)\"\n              @keyup.enter=\"() => emit('intro-slide', 4)\"\n              >\n              User Guide\n            </v-list-item>\n            \n            <v-list-item \n              tabindex=\"0\"\n              aria-label=\"Show dialog telling about the data\"\n              @click=\"showAboutData = true\"\n              @keyup.enter=\"showAboutData = true\"\n              >\n              About the Data\n            </v-list-item>\n            \n            <v-list-item \n              \n              aria-label=\"Leave Page to Educator Resources\"\n              >\n              <a style=\"font-weight: normal;\" tabindex=\"0\"  href=\"https://www.cosmicds.cfa.harvard.edu/resources/tempo\" target=\"_blank\" rel=\"noopener\">Educator Resources<v-icon>mdi-open-in-new</v-icon></a>\n            </v-list-item>\n            \n            <v-list-item \n              tabindex=\"0\" \n              aria-label=\"Show credits\"\n              @click=\"showCredits = true\"\n              @keyup.enter=\"showCredits = true\"\n              >\n                Credits\n            </v-list-item>\n            \n          </v-list>\n        </v-menu>\n      </v-btn>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { useDisplay } from \"vuetify\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { useTempoStore } from \"@/stores/app\";\nimport changes from \"@/changes\";\n\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faArrowsRotate } from \"@fortawesome/free-solid-svg-icons\";\n\nlibrary.add(faArrowsRotate);\n\nconst emit = defineEmits<{\n  (event: \"intro-slide\", value: number): void;\n}>();\n\nconst store = useTempoStore();\nconst {\n  accentColor2,\n  shareButtonClickedCount,\n} = storeToRefs(store);\n\nconst display = useDisplay();\n\nconst currentUrl = ref(window.location.href);\nconst showChanges = ref(false);\nconst showAboutData = ref(false);\nconst showCredits = ref(false);\n\nconst touchscreen = supportsTouchscreen();\n\nconst smallSize = computed(() => {\n  return display.smAndDown.value;\n});\n\n\nconst mobile = computed(() => {\n  return smallSize.value && touchscreen;\n});\n</script>\n\n<style scoped lang=\"less\">\n#title {\n  color: var(--smithsonian-yellow);\n  font-weight: 600;\n  font-size: 2.5rem;\n  text-align: center;\n  text-wrap: nowrap;\n  flex-grow: 1;\n}\n\na[href=\"https://tempo.si.edu\"]>img {\n  // display: inline;\n  height: 70px !important;\n  width: auto !important;\n}\n\n.header {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  padding: 10px;\n\n  >* {\n    background-color: transparent;\n  }\n\n  >div {\n    outline: 1px solid transparent;\n  }\n\n  #menu-area {\n    display: flex;\n    justify-self: end;\n    gap: 1rem;\n    align-items: center;\n\n    :deep(.icon-wrapper) {\n      width: 40px;\n      height: 40px;\n      border-radius: 8px !important;\n    }\n\n  }\n}\n\n\n\n</style>\n","import script from \"./HeaderBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./HeaderBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./HeaderBar.vue?vue&type=style&index=0&id=f614e1aa&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f614e1aa\"]])\n\nexport default __exports__","import { computed, type Ref } from 'vue';\nimport { toZonedTime, fromZonedTime, format as formatTz, getTimezoneOffset } from 'date-fns-tz';\nimport type { MillisecondRange } from '../types/datetime';\n\nexport type Timezone = \n  \"US/Eastern\" |\n  \"US/Central\" |\n  \"US/Mountain\" |\n  \"US/Arizona\" |\n  \"US/Pacific\" |\n  \"US/Alaska\" |\n  \"UTC\";\n\ntype TimezoneOption = { tz: Timezone, name: string };\n\n/**\n * Composable for centralized timezone handling and formatting\n */\nexport function useTimezone(selectedTimezone: Ref<string>) {\n  \n  /**\n   * Convert UTC timestamp to timezone-aware date\n   */\n  function toTimezone(timestamp: number): Date {\n    const utcDate = new Date(timestamp);\n    return toZonedTime(utcDate, selectedTimezone.value);\n  }\n\n  /**\n   * Convert timezone-aware date to UTC timestamp\n   */\n  function fromTimezone(date: Date): number {\n    return fromZonedTime(date, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Set date to local midnight in selected timezone\n   */\n  function setToMidnight(date: Date): number {\n    const zonedDate = toZonedTime(date, selectedTimezone.value);\n    zonedDate.setHours(0, 0, 0, 0);\n    return fromZonedTime(zonedDate, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Set date to end of day in selected timezone\n   */\n  function setToEndOfDay(date: Date): number {\n    const zonedDate = toZonedTime(date, selectedTimezone.value);\n    zonedDate.setHours(23, 59, 59, 999);\n    return fromZonedTime(zonedDate, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Format timestamp with full date and time\n   */\n  function formatTimeLong(timestamp: number): string {\n    const utcDate = new Date(timestamp);\n    const zonedDate = toZonedTime(utcDate, selectedTimezone.value);\n    return formatTz(zonedDate, 'EEE, MMM d, yyyy \\'at\\' h:mm a', { timeZone: selectedTimezone.value });\n  }\n\n  /**\n   * Format duration with timezone prefix\n   */\n  function formatDuration(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    const startZoned = toZonedTime(startUtc, selectedTimezone.value);\n    const endZoned = toZonedTime(endUtc, selectedTimezone.value);\n    \n    const startTime = startZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    const endTime = endZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    \n    return `${selectedTimezone.value}: ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format timezone range with date and time\n   */\n  function formatTimezoneRange(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    const startZoned = toZonedTime(startUtc, selectedTimezone.value);\n    const endZoned = toZonedTime(endUtc, selectedTimezone.value);\n    \n    const startDate = startZoned.toLocaleDateString('en-US', { \n      month: 'short', \n      day: 'numeric' \n    });\n    const startTime = startZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    const endTime = endZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    \n    return `${startDate} ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format UTC range\n   */\n  function formatUTCRange(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    \n    const startDate = startUtc.toLocaleDateString('en-US', { \n      month: 'short', \n      day: 'numeric',\n      timeZone: 'UTC'\n    });\n    const startTime = startUtc.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true,\n      timeZone: 'UTC'\n    });\n    const endTime = endUtc.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true,\n      timeZone: 'UTC'\n    });\n    \n    return `${startDate} ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format time string for display\n   */\n  function formatTime(timeString: string): string {\n    const [hour, minute] = timeString.split(':').map(Number);\n    const date = new Date();\n    date.setHours(hour, minute, 0, 0);\n    return date.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n  }\n\n  /**\n   * Format date for display\n   */\n  function formatDateDisplay(date: Date | null): string {\n    return date?.toDateString() || '';\n  }\n\n  // Computed properties for reactive timezone info\n  const timezoneInfo = computed(() => ({\n    name: selectedTimezone.value,\n    offset: new Date().toLocaleString('en', {\n      timeZone: selectedTimezone.value,\n      timeZoneName: 'short'\n    }).split(' ').pop() || ''\n  }));\n\n  function isDST(date: Date): boolean {\n    const standardOffset = getTimezoneOffset(selectedTimezone.value, new Date(date.getUTCFullYear(), 0, 1));\n    const currentOffset = getTimezoneOffset(selectedTimezone.value, date);\n    if (standardOffset === currentOffset) {\n      return false;\n    }\n    return true;\n  }\n\n  function timezoneOptions(date: Date): TimezoneOption[] {\n    const dateIsDST = isDST(date);\n    return [\n      { tz: 'US/Eastern', name: dateIsDST ? 'Eastern Daylight' : 'Eastern Standard' },\n      { tz: 'US/Central', name: dateIsDST ? 'Central Daylight' : 'Central Standard' },\n      { tz: 'US/Mountain', name: dateIsDST ? 'Mountain Daylight' : 'Mountain Standard' },\n      { tz: 'US/Arizona', name: 'Mountain Standard' },\n      { tz: 'US/Pacific', name: dateIsDST ? 'Pacific Daylight' : 'Pacific Standard' },\n      { tz: 'US/Alaska', name: dateIsDST ? 'Alaska Daylight' : 'Alaska Standard' },\n      { tz: 'UTC', name: 'UTC' },\n    ];\n  }\n\n  return {\n    // Core timezone operations\n    toTimezone,\n    fromTimezone,\n    setToMidnight,\n    setToEndOfDay,\n    \n    // Formatting functions\n    formatTimeLong,\n    formatDuration,\n    formatTimezoneRange,\n    formatUTCRange,\n    formatTime,\n    formatDateDisplay,\n\n    // Utility functions\n    isDST,\n    timezoneOptions,\n    \n    // Computed properties\n    timezoneInfo,\n  };\n}\n","import { ref, computed, watch } from 'vue';\nimport type { Ref } from 'vue';\nimport { useTimezone } from './useTimezone';\nimport type { \n  MillisecondRange,\n  TimeRangeSelectionType \n} from '@/types/datetime';\n\ninterface UseDateTimeSelectorOptions {\n  currentDate?: Ref<Date>;\n  selectedTimezone?: Ref<string>;\n}\n\n/**\n * Custom hook for date/time selection with optional configuration\n * @param options - Optional configuration object with currentDate and selectedTimezone refs\n */\nexport function useDateTimeSelector(\n  options: UseDateTimeSelectorOptions = {}\n) {\n  const { currentDate } = options;\n  \n  const utcTimezone = options.selectedTimezone ? options.selectedTimezone : ref<string>('UTC');\n  \n  const { \n    toTimezone, \n    fromTimezone, \n    setToMidnight, \n    setToEndOfDay,\n    formatTime \n  } = useTimezone(utcTimezone);\n  \n  // Extend selection type locally to include 'singledate' and 'pattern' without altering global type\n  const selectionType = ref<TimeRangeSelectionType>('singledate');\n  \n  // Weekday selection state\n  const selectedDayOfWeek = ref<number>(1); // Default to Monday\n  const selectedTime = ref<string>('09:00');\n  const instancesBack = ref<number>(4);\n  const timePlusMinus = ref<number>(0.4999); // +/- 0.5 hour by default. \n  // Pattern selection state (multi-day and multi-time)\n  const selectedDays = ref<number[]>([1, 2, 3, 4, 5]); // Default Mon-Fri\n  const selectedTimes = ref<string[]>(['12:00']); // Default 9 AM\n  \n  // Track if user has manually set the weekday start date\n  const hasManualWeekdayStartDate = ref<boolean>(false);\n\n  // Initialize weekdayStartDateTimestamp from currentDate option if provided\n  const weekdayStartDateTimestamp = ref<number>(\n    currentDate?.value?.getTime() || new Date().getTime()\n  );\n  const startDate = ref<number>(0);\n  const endDate = ref<number>(0);\n  \n  // Computed properties for date picker integration (convert timestamps to/from date objects)\n  const weekdayStartDate = computed({\n    get: () => {\n      if (hasManualWeekdayStartDate.value && weekdayStartDateTimestamp.value > 0) {\n        return new Date(weekdayStartDateTimestamp.value).toISOString().split('T')[0];\n      }\n      return new Date(weekdayStartDateTimestamp.value).toISOString().split('T')[0];\n    },\n    set: (value: string) => {\n      const date = new Date(value + 'T00:00:00');\n      setWeekdayStartTimestamp(date.getTime());\n    }\n  });\n  \n  const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  const monthNames = [\n    'January', 'February', 'March', 'April', 'May', 'June',\n    'July', 'August', 'September', 'October', 'November', 'December'\n  ];\n  const selectedMonths = ref<number[]>([new Date().getMonth()]); // Default to current month\n  const selectedYears = ref<number[]>([new Date().getFullYear()]); // Default to current year\n  \n  // New methods for direct timestamp manipulation\n  function setWeekdayStartTimestamp(timestamp: number): void {\n    weekdayStartDateTimestamp.value = timestamp;\n    hasManualWeekdayStartDate.value = timestamp > 0;\n  }\n  \n  // Generate millisecond ranges\n  function generateMillisecondRanges(): MillisecondRange[] {\n    // if (selectionType.value === 'weekday') {\n    //   return generateWeekdayRanges();\n    // } else \n    if (selectionType.value === 'pattern') {\n      return generatePatternRanges();\n    } else if (selectionType.value === 'singledate') {\n      return generateSingleDateRange();\n    } else if (selectionType.value === 'monthrange') {\n      return generateMonthRanges();\n    } else {\n      return generateDateRangeRanges();\n    }\n  }\n  \n  // Parse time string into hour and minute\n  const parsedTime = computed(() => {\n    const [hour, minute] = selectedTime.value.split(':').map(Number);\n    return { hour, minute };\n  });\n  \n  function generateMonthRanges(): MillisecondRange[] {\n    if (selectedMonths.value.length === 0 || selectedYears.value.length === 0) {\n      return [];\n    }\n\n    const ranges: MillisecondRange[] = [];\n    for (const year of selectedYears.value) {\n      for (const month of selectedMonths.value) {\n        const startDate = fromTimezone(new Date(year, month, 1));\n        const endDate = fromTimezone(new Date(year, month + 1, 0, 23, 59, 59, 999)); // End of the month\n        parcelLongRanges(startDate, endDate).forEach(r => ranges.push(r));\n      }\n    }\n\n    // Sort newest-first\n    return ranges.sort((a, b) => b.start - a.start);\n  }\n  \n  function generateWeekdayRanges(): MillisecondRange[] {\n    // Determine base timestamp: use manual timestamp if set, otherwise current date\n    const baseTimestamp = hasManualWeekdayStartDate.value && weekdayStartDateTimestamp.value > 0\n      ? weekdayStartDateTimestamp.value\n      : weekdayStartDateTimestamp.value;\n    \n    // Create timezone-aware date for calculations  \n    const baseDate = toTimezone(baseTimestamp);\n    \n    const targetDayOfWeek = selectedDayOfWeek.value;\n    \n    // Find the target day occurrence - use baseDate if it already matches, otherwise find the most recent occurrence\n    const currentDate = new Date(baseDate);\n    \n    const currentDay= currentDate.getDay();\n    const daysDifference = (currentDay - targetDayOfWeek + 7) % 7;\n    if (daysDifference !== 0) {\n      currentDate.setDate(currentDate.getDate() - daysDifference);\n    }\n    \n    // Generate ranges for the specified number of instances back\n    const ranges = Array.from({ length: instancesBack.value }, (_, i) => {\n      const rangeDate = new Date(currentDate);\n      rangeDate.setDate(currentDate.getDate() - (i * 7)); // Go back by weeks\n      \n      // Set the specific time\n      rangeDate.setHours(parsedTime.value.hour, parsedTime.value.minute, 0, 0);\n      \n      // Convert to UTC timestamp for the API\n      const startTime = fromTimezone(rangeDate);\n      const endTime = startTime + (timePlusMinus.value * 60 * 60 * 1000); // Add offset\n      \n      return {\n        start: startTime - (timePlusMinus.value * 60 * 60 * 1000), // Subtract offsetr\n        end: endTime\n      };\n    });\n    \n    return ranges.sort((a, b) => - (a.start - b.start));\n  }\n\n  // Generate ranges for pattern mode (multi-day, multi-time) by reusing weekday generator\n  function generatePatternRanges(): MillisecondRange[] {\n    if (selectedDays.value.length === 0 || selectedTimes.value.length === 0) {\n      return [];\n    }\n\n    const originalDay = selectedDayOfWeek.value;\n    const originalTime = selectedTime.value;\n\n    const results: MillisecondRange[] = [];\n    try {\n      for (const day of selectedDays.value) {\n        for (const time of selectedTimes.value) {\n          selectedDayOfWeek.value = day;\n          selectedTime.value = time;\n          results.push(...generateWeekdayRanges());\n        }\n      }\n    } finally {\n      // Restore original selection to avoid side effects\n      selectedDayOfWeek.value = originalDay;\n      selectedTime.value = originalTime;\n    }\n\n    // Sort newest-first and dedupe identical start/end pairs\n    results.sort((a, b) => b.start - a.start);\n    const seen = new Set<string>();\n    const deduped: MillisecondRange[] = [];\n    for (const r of results) {\n      const key = `${r.start}-${r.end}`;\n      if (!seen.has(key)) {\n        seen.add(key);\n        deduped.push(r);\n      }\n    }\n    return deduped;\n  }\n  \n  function parcelLongRanges(startMs: number, endMs: number, chunckSize = 864000000): MillisecondRange[] {\n    const ranges: MillisecondRange[] = [];\n    let currentStart = startMs;\n\n    while (currentStart < endMs) {\n      const currentEnd = Math.min(currentStart + chunckSize - 1, endMs);\n      ranges.push({\n        start: currentStart,\n        end: currentEnd\n      });\n      currentStart = currentEnd + 1;\n    }\n\n    return ranges;\n  }\n  \n  function generateDateRangeRanges(): MillisecondRange[] {\n    if (startDate.value === 0 || endDate.value === 0) return [];\n    \n    // Use timestamps directly - they should already be set to appropriate times (midnight, end of day, etc.)\n    const startMs = startDate.value;\n    const endMs = endDate.value;\n    \n    const oneDayMs = 24 * 60 * 60 * 1000; // Milliseconds in a day\n    \n    return parcelLongRanges(startMs, endMs, 10 * oneDayMs); // Chunk size of 10 days\n  }\n  \n  \n  // Single date (timestamp at timezone-local midnight) state\n  const singleDate = ref<number>(0);\n  \n  function setSingleDateTimestamp(ts: number) {\n    // Normalize to midnight in the selected timezone\n    const midnightTs = setToMidnight(new Date(ts));\n    singleDate.value = midnightTs;\n  }\n  \n  // Initialize singleDate from parent currentDate if not already set\n  if (singleDate.value === 0) {\n    const initialParentTs = currentDate?.value?.getTime();\n    if (initialParentTs) {\n      setSingleDateTimestamp(initialParentTs);\n    }\n  }\n  \n  function generateSingleDateRange(): MillisecondRange[] {\n    if (singleDate.value === 0) return [];\n    const start = singleDate.value;\n    const end = setToEndOfDay(new Date(singleDate.value));\n    return [{ start, end }];\n  }\n\n  // Watch for currentDate changes and update weekdayStartDateTimestamp if not manually set\n  if (currentDate) {\n    watch(currentDate, (newCurrentDate) => {\n      if (!hasManualWeekdayStartDate.value) {\n        weekdayStartDateTimestamp.value = newCurrentDate.getTime();\n      }\n      // If singleDate not manually set yet (still 0), default it from parent\n      if (singleDate.value === 0) {\n        setSingleDateTimestamp(newCurrentDate.getTime());\n      }\n    });\n  }\n  \n  return {\n    // State\n    selectionType,\n    selectedDayOfWeek,\n    selectedTime,\n    instancesBack,\n    dayNames,\n    timePlusMinus,\n    singleDate,\n    selectedDays,\n    selectedTimes,\n    \n    // Computed properties for date picker integration\n    weekdayStartDate,\n    startDate,\n    endDate,\n    \n    selectedMonths,\n    selectedYears,\n    monthNames,\n    \n    // New timestamp methods\n    setWeekdayStartTimestamp,\n    setStartTimestamp: (timestamp: number) => { startDate.value = timestamp; },\n    setEndTimestamp: (timestamp: number) => { endDate.value = timestamp; },\n    setSingleDateTimestamp,\n    \n    // Timezone utilities\n    setToMidnight,\n    setToEndOfDay,\n    \n    // Utilities\n    generateMillisecondRanges,\n    formatTime,\n    generateSingleDateRange,\n    generatePatternRanges,\n    generateMonthRanges,\n  };\n}","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, isRef as _isRef, withCtx as _withCtx, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"date-range-section\"\n}\nconst _hoisted_2 = { class: \"mb-4\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"pattern-section\"\n}\nconst _hoisted_4 = { class: \"mb-4\" }\nconst _hoisted_5 = [\"value\"]\nconst _hoisted_6 = { class: \"ml-1\" }\nconst _hoisted_7 = { class: \"mb-4 simple-patterns\" }\nconst _hoisted_8 = { class: \"mb-4\" }\nconst _hoisted_9 = { class: \"mt-2 dtrs-flex-time-box\" }\nconst _hoisted_10 = { class: \"pm-wrapper\" }\nconst _hoisted_11 = { class: \"mb-2\" }\nconst _hoisted_12 = {\n  key: 0,\n  class: \"single-date-section\"\n}\nconst _hoisted_13 = { class: \"mb-4\" }\nconst _hoisted_14 = {\n  key: 0,\n  class: \"month-selection-section\"\n}\nconst _hoisted_15 = { class: \"mb-4\" }\nconst _hoisted_16 = [\"value\"]\nconst _hoisted_17 = { class: \"ml-1\" }\nconst _hoisted_18 = { class: \"mb-4\" }\nconst _hoisted_19 = [\"value\"]\nconst _hoisted_20 = { class: \"ml-1\" }\nconst _hoisted_21 = { class: \"mb-4 simple-patterns\" }\n\nimport { watch, computed, ref, onMounted } from 'vue';\nimport DatePicker from '@vuepic/vue-datepicker';\nimport '@vuepic/vue-datepicker/dist/main.css';\nimport { useTimezone } from '../composables/useTimezone';\nimport { useDateTimeSelector } from './useDateTimeSelector';\nimport type { MillisecondRange, TimeRangeSelectionType } from '../types/datetime';\nimport { formatTimeRange } from \"@/utils/timeRange\";\n\n\n// === INTERFACES === \n// === PROPS ===\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DateTimeRangeSelection',\n  props: {\n    currentDate: {},\n    defaultStartDate: {},\n    defaultEndDate: {},\n    allowedDates: {},\n    validTimes: {}\n  },\n  emits: [\"ranges-change\"],\n  setup(__props: any, { emit: __emit }) {\n\n// === IMPORTS ===\nconst props = __props;\n\n// === EMITS ===\nconst emit = __emit;\n\n// === COMPOSABLE SETUP ===\n// Create refs for the current date and timezone to pass to the composable\nconst currentDateRef = ref(props.currentDate);\n// Using UTC for time range generation - will be offset to local timezone when fetching data\nconst timezoneRef = ref('UTC');\n// Initialize timezone handling\nconst { setToMidnight, setToEndOfDay, formatDateDisplay } = useTimezone(timezoneRef);\n\n// Initialize the datetime selector composable with optional parameters\nconst {\n  selectionType,\n  instancesBack,\n  timePlusMinus,\n  weekdayStartDate,\n  startDate,\n  endDate,\n  setWeekdayStartTimestamp,\n  setStartTimestamp: setStartTimestampInternal,\n  setEndTimestamp: setEndTimestampInternal,\n  dayNames,\n  monthNames,\n  selectedMonths,\n  selectedYears,\n  generateMillisecondRanges,\n  // single date additions\n  singleDate,\n  setSingleDateTimestamp,\n  generateSingleDateRange,\n  // pattern additions\n  selectedDays,\n  selectedTimes,\n  generatePatternRanges,\n  generateMonthRanges,\n} = useDateTimeSelector({\n  currentDate: currentDateRef,\n  selectedTimezone: timezoneRef\n});\n\n// === REFS ===\nconst weekdayCalendar = ref();\n// const startDateCalendar = ref();\n// const endDateCalendar = ref();\nconst singleDateCalendar = ref();\n\n// === PICKER STATE ===\n// Direct date objects for date pickers - no unnecessary timestamp conversion\nconst weekdayStartDateObj = ref<Date | null>(null);\nconst startDateObj = ref<Date | null>(null);\nconst endDateObj = ref<Date | null>(null);\nconst singleDateObj = ref<Date | null>(null);\n\n// Pre-populated time options (every hour from 6am-9pm; user can add custom HH:MM)\nconst timeOptions = ref<string[]>(Array.from({ length: 15 }, (_, h) => `${String(h+6).padStart(2, '0')}:00`));\n// // Compute available time options based on min/max hour in allowedDates in the selected timezone\n// causes a bit a performance degredation and offers 6-9pm for all data, so hard cord it. \n// a better range would be from 9am - 5pm\n// const minMaxHours = computed(() => {\n//   const dates = props.validTimes ?? [];\n//   if (dates.length === 0) return { min: 0, max: 23 };\n//   const hours = dates.map(d => {\n//     return toTimezone(d).getHours();\n//   });\n//   const min = Math.min(...hours);\n//   const max = Math.max(...hours);\n//   return { min, max };\n// });\n\n// const timeOptions = computed<string[]>(() => {\n//   const { min, max } = minMaxHours.value;\n//   const count = max - min + 1;\n//   const hours = count > 0 ? Array.from({ length: count }, (_, i) => min + i) : Array.from({ length: 24 }, (_, i) => i);\n//   return hours.map(h => `${String(h).padStart(2, '0')}:00`);\n// });\n\nconst possibleYears = computed(() => {\n  const dates = props.allowedDates ?? [2024];\n  if (dates.length === 0) return [2023, new Date().getFullYear()];\n  const years = dates.map(d => d.getFullYear());\n  // Deduplicate and sort\n  return [...new Set(years)].sort((a, b) => a - b);\n});\n\n// Day options for v-select\nconst dayOptions = computed(() => \n  dayNames.map((day, index) => ({ title: day, value: index }))\n);\n\n// Generate ranges for visualization\n// const ranges = computed(() => {\n//   return generateMillisecondRanges();\n// });\n\n// Validation rules\nconst instanceRules = computed(() => [\n  (v: number) => v >= 1 && v <= 104 || 'Must be between 1 and 104 (2 years)'\n]);\n\nconst customTimeRangeName = computed((): string => {\n  \n  if (selectionType.value === 'singledate') {\n    \n    return `${singleDateObj.value ? formatDateDisplay(singleDateObj.value) : 'No date selected'}`;\n    \n  } else if (selectionType.value === 'pattern') {\n    \n    // string to describe the pattern\n    const dayNamesSelected = selectedDays.value.map(d => dayNames[d].slice(0,3)).join(',');\n    const timesSelected = selectedTimes.value.join(', ');\n    return `Pattern: [${dayNamesSelected}]  [${timesSelected}]  ${Math.abs(timePlusMinus.value)}h  (${formatTimeRange(generatePatternRanges())})`;\n    \n  } else if (selectionType.value === 'monthrange') {\n    \n    const monthNamesSelected = selectedMonths.value.map(m => monthNames[m].slice(0,3)).join(', ');\n    const yearsSelected = selectedYears.value.join(', ');\n    \n    return `Months: [${monthNamesSelected}] in [${yearsSelected}] (${formatTimeRange(generatePatternRanges())})`;\n    \n  } else if (selectionType.value === 'daterange') {\n    \n    return `${startDateObj.value ? formatDateDisplay(startDateObj.value) : 'No start date'} - ${endDateObj.value ? formatDateDisplay(endDateObj.value) : 'No end date'}`;\n    \n  } else {\n    \n    return 'Unrecognized selection type';\n  }\n    \n});\n\n// === METHODS ===\n// Update custom range button handler\nfunction updateCustomRange() {\n  let currentRanges: MillisecondRange[] = [];\n  if (selectionType.value === 'singledate') {\n    currentRanges = generateSingleDateRange();\n  } else if (selectionType.value === 'pattern') {\n    currentRanges = generatePatternRanges();\n  } else if (selectionType.value === 'monthrange') {\n    currentRanges = generateMonthRanges();\n  } else {\n    currentRanges = generateMillisecondRanges();\n  }\n  emit('ranges-change', currentRanges, selectionType.value, customTimeRangeName.value);\n}\n\n// Date change handlers\nfunction handleWeekdayDateChange(value: Date) {\n  if (value != null) {\n    if (value.getTime() !== weekdayStartDateObj.value?.getTime()) {\n      weekdayStartDateObj.value = value;\n      // Update composable state directly\n      setWeekdayStartTimestamp(value.getTime());\n      weekdayCalendar.value?.closeMenu();\n    }\n  }\n}\n\nfunction handleStartDateChange(value: Date) {\n  if (value != null) {\n    if (value.getTime() !== startDateObj.value?.getTime()) {\n      startDateObj.value = value;\n      // Convert to timestamp and update composable\n      const timestamp = setToMidnight(value);\n      setStartTimestampInternal(timestamp);\n      // startDateCalendar.value?.closeMenu();\n    }\n  }\n}\n\nfunction handleEndDateChange(value: Date) {\n  if (value != null) {\n    if (value.getTime() !== endDateObj.value?.getTime()) {\n      endDateObj.value = value;\n      // Convert to timestamp and update composable\n      const timestamp = setToEndOfDay(value);\n      setEndTimestampInternal(timestamp);\n      // endDateCalendar.value?.closeMenu();\n    }\n  }\n}\n\n\nconst dateRangeArray = computed<Date[] | null>(() => {\n  if (startDateObj.value && endDateObj.value) {\n    return [startDateObj.value, endDateObj.value];\n  }\n  return null;\n});\nconst dateRangeCalendar = ref();\nfunction handleDateRangeChange(value: Date[]) {\n  if (value && value.length === 2) {\n    const [start, end] = value;\n    let changed = false;\n    if (start.getTime() !== startDateObj.value?.getTime()) {\n      handleStartDateChange(start);\n      changed = true;\n    }\n    if (end.getTime() !== endDateObj.value?.getTime()) {\n      handleEndDateChange(end);\n      changed = true;\n    }\n    if (changed) {\n      dateRangeCalendar.value?.closeMenu();\n    }\n  }\n}\n\nfunction handleSingleDateChange(value: Date) {\n  if (value && value.getTime() !== singleDateObj.value?.getTime()) {\n    singleDateObj.value = value;\n    setSingleDateTimestamp(value.getTime());\n    singleDateCalendar.value?.closeMenu();\n  }\n}\n\n// Normalize entered times to HH:MM 24h (flexible entry via copilot)\nfunction normalizeTimes(values: string[]) {\n  const normalized = values\n    .map(v => String(v).trim())\n    .map(v => {\n      // Accept HH, H, HH:MM, H:MM, also allow am/pm inputs like 9am, 2:30 PM\n      const lower = v.toLowerCase().replace(/\\s+/g, '');\n      const ampmMatch = lower.match(/^(\\d{1,2})(?::(\\d{1,2}))?(am|pm)$/);\n      if (ampmMatch) {\n        let hour = parseInt(ampmMatch[1], 10);\n        const minute = ampmMatch[2] ? parseInt(ampmMatch[2], 10) : 0;\n        const suffix = ampmMatch[3];\n        if (suffix === 'pm' && hour < 12) hour += 12;\n        if (suffix === 'am' && hour === 12) hour = 0;\n        return `${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}`;\n      }\n      const m = lower.match(/^(\\d{1,2})(?::(\\d{1,2}))?$/);\n      if (!m) return null;\n      const h = parseInt(m[1], 10);\n      const mm = m[2] ? parseInt(m[2], 10) : 0;\n      if (isNaN(h) || h < 0 || h > 23) return null;\n      if (isNaN(mm) || mm < 0 || mm > 59) return null;\n      return `${String(h).padStart(2, '0')}:${String(mm).padStart(2, '0')}`;\n    })\n    .filter((v): v is string => !!v);\n  // Deduplicate\n  const unique = Array.from(new Set(normalized));\n  selectedTimes.value = unique;\n}\n\n// Formatting functions\n// Formatting functions moved to useTimezone composable\n\n// === LIFECYCLE HOOKS ===\nonMounted(() => {\n  // Initialize default dates\n  if (props.defaultStartDate) {\n    startDateObj.value = props.defaultStartDate;\n    const timestamp = setToMidnight(props.defaultStartDate);\n    setStartTimestampInternal(timestamp);\n  }\n  if (props.defaultEndDate) {\n    endDateObj.value = props.defaultEndDate;\n    const timestamp = setToEndOfDay(props.defaultEndDate);\n    setEndTimestampInternal(timestamp);\n  } else {\n    // Default end date to today\n    const today = new Date();\n    endDateObj.value = today;\n    const timestamp = setToEndOfDay(today);\n    setEndTimestampInternal(timestamp);\n  }\n  \n  // Initialize weekday start date\n  if (weekdayStartDate.value) {\n    weekdayStartDateObj.value = new Date(weekdayStartDate.value + 'T00:00:00');\n  }\n\n  if (singleDate.value > 0 && !singleDateObj.value) {\n    singleDateObj.value = new Date(singleDate.value);\n  }\n});\n\n// === WATCHERS ===\n// Watch for prop changes and update refs\nwatch(() => props.currentDate, (newDate) => {\n  currentDateRef.value = newDate;\n});\n\n// Keep weekdayStartDateObj in sync with the composable's weekdayStartDate\nwatch(() => weekdayStartDate.value, (newDateString) => {\n  const newDate = newDateString ? new Date(newDateString + 'T00:00:00') : null;\n  if (newDate?.getTime() !== weekdayStartDateObj.value?.getTime()) {\n    weekdayStartDateObj.value = newDate;\n  }\n});\n\n// Keep singleDateObj in sync with the composable's singleDate\nwatch(() => singleDate.value, (newTs) => {\n  if (newTs > 0) {\n    const newDate = new Date(newTs);\n    if (newDate.getTime() !== singleDateObj.value?.getTime()) {\n      singleDateObj.value = newDate;\n    }\n  } else {\n    singleDateObj.value = null;\n  }\n});\n\n// Sync date objects with composable timestamps (one-way: composable  UI)\nwatch(() => startDate.value, (newTimestamp) => {\n  const newDate = newTimestamp > 0 ? new Date(newTimestamp) : null;\n  if (newDate?.getTime() !== startDateObj.value?.getTime()) {\n    startDateObj.value = newDate;\n  }\n});\n\nwatch(() => endDate.value, (newTimestamp) => {\n  const newDate = newTimestamp > 0 ? new Date(newTimestamp) : null;\n  if (newDate?.getTime() !== endDateObj.value?.getTime()) {\n    endDateObj.value = newDate;\n  }\n});\n\n// Ranges are now only emitted when the Update Custom Range button is clicked\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_radio = _resolveComponent(\"v-radio\")!\n  const _component_v_radio_group = _resolveComponent(\"v-radio-group\")!\n  const _component_v_expand_transition = _resolveComponent(\"v-expand-transition\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_combobox = _resolveComponent(\"v-combobox\")!\n  const _component_v_number_input = _resolveComponent(\"v-number-input\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, {\n    class: \"datetime-range-selector\",\n    elevation: \"2\"\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_card_text, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_radio_group, {\n            modelValue: _unref(selectionType),\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => (_isRef(selectionType) ? (selectionType).value = $event : null)),\n            row: \"\",\n            density: \"compact\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_radio, {\n                label: \"Single Date\",\n                value: \"singledate\",\n                density: \"compact\"\n              }),\n              _createVNode(_component_v_radio, {\n                label: \"Date Range\",\n                value: \"daterange\",\n                density: \"compact\"\n              }),\n              _createVNode(_component_v_radio, {\n                label: \"Months Range\",\n                value: \"monthrange\",\n                density: \"compact\"\n              }),\n              _createVNode(_component_v_radio, {\n                label: \"Pattern (Days  Times)\",\n                value: \"pattern\",\n                density: \"compact\"\n              })\n            ]),\n            _: 1\n          }, 8, [\"modelValue\"]),\n          _createVNode(_component_v_expand_transition, null, {\n            default: _withCtx(() => [\n              (_unref(selectionType) === 'daterange')\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                      _cache[16] || (_cache[16] = _createElementVNode(\"label\", { class: \"text-subtitle-2 mb-2 d-block\" }, \"Pick Date Range\", -1)),\n                      _createVNode(_unref(DatePicker), {\n                        range: \"\",\n                        \"multi-calendars\": {solo: true},\n                        ref_key: \"dateRangeCalendar\",\n                        ref: dateRangeCalendar,\n                        \"model-value\": dateRangeArray.value,\n                        onInternalModelChange: handleDateRangeChange,\n                        \"allowed-dates\": __props.allowedDates,\n                        format: (d) => d.map(_unref(formatDateDisplay)).join(' - '),\n                        teleport: true,\n                        \"enable-time-picker\": false,\n                        dark: \"\",\n                        \"year-range\": [__props.allowedDates ? __props.allowedDates[0].getFullYear() : 2023, __props.allowedDates ? __props.allowedDates[__props.allowedDates.length - 1].getFullYear() : new Date().getFullYear()]\n                      }, null, 8, [\"model-value\", \"allowed-dates\", \"format\", \"year-range\"])\n                    ])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_expand_transition, null, {\n            default: _withCtx(() => [\n              (_unref(selectionType) === 'pattern')\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                    _createElementVNode(\"div\", _hoisted_4, [\n                      _cache[17] || (_cache[17] = _createElementVNode(\"label\", { class: \"text-subtitle-2 mb-2 d-block\" }, \"Days of Week\", -1)),\n                      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(dayOptions.value, (day, idx) => {\n                        return (_openBlock(), _createElementBlock(\"label\", {\n                          key: idx,\n                          class: \"mr-3\",\n                          style: {\"text-wrap\":\"nowrap\"}\n                        }, [\n                          _withDirectives(_createElementVNode(\"input\", {\n                            type: \"checkbox\",\n                            value: day.value,\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => (_isRef(selectedDays) ? (selectedDays).value = $event : null))\n                          }, null, 8, _hoisted_5), [\n                            [_vModelCheckbox, _unref(selectedDays)]\n                          ]),\n                          _createElementVNode(\"span\", _hoisted_6, _toDisplayString(day.title.slice(0,3)), 1)\n                        ]))\n                      }), 128))\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[2] || (_cache[2] = ($event: any) => (selectedDays.value = [1,2,3,4,5]))\n                      }, {\n                        default: _withCtx(() => [...(_cache[18] || (_cache[18] = [\n                          _createTextVNode(\"Weekdays\", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[3] || (_cache[3] = ($event: any) => (selectedDays.value = [0,6]))\n                      }, {\n                        default: _withCtx(() => [...(_cache[19] || (_cache[19] = [\n                          _createTextVNode(\"Weekends\", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[4] || (_cache[4] = ($event: any) => (selectedDays.value = [0,1,2,3,4,5,6]))\n                      }, {\n                        default: _withCtx(() => [...(_cache[20] || (_cache[20] = [\n                          _createTextVNode(\"Full Week\", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[5] || (_cache[5] = ($event: any) => (selectedDays.value = []))\n                      }, {\n                        default: _withCtx(() => [...(_cache[21] || (_cache[21] = [\n                          _createTextVNode(\"Clear\", -1)\n                        ]))]),\n                        _: 1\n                      })\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_8, [\n                      _createElementVNode(\"div\", _hoisted_9, [\n                        _createVNode(_component_v_combobox, {\n                          modelValue: _unref(selectedTimes),\n                          \"onUpdate:modelValue\": [\n                            _cache[6] || (_cache[6] = ($event: any) => (_isRef(selectedTimes) ? (selectedTimes).value = $event : null)),\n                            normalizeTimes\n                          ],\n                          items: timeOptions.value,\n                          label: \"Add/select times\",\n                          multiple: \"\",\n                          chips: \"\",\n                          \"closable-chips\": \"\",\n                          density: \"compact\",\n                          variant: \"outlined\",\n                          \"hide-details\": \"\",\n                          hint: \"24h format HH:MM (e.g., 09:00, 14:30)\",\n                          \"persistent-hint\": \"\"\n                        }, null, 8, [\"modelValue\", \"items\"]),\n                        _createElementVNode(\"div\", _hoisted_10, [\n                          _withDirectives(_createElementVNode(\"input\", {\n                            id: \"dtrs-time-plus-minus\",\n                            type: \"checkbox\",\n                            \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => (_isRef(timePlusMinus) ? (timePlusMinus).value = $event : null)),\n                            \"true-value\": 11.9999,\n                            \"false-value\": 0.49999\n                          }, null, 512), [\n                            [_vModelCheckbox, _unref(timePlusMinus)]\n                          ]),\n                          _cache[22] || (_cache[22] = _createElementVNode(\"label\", { for: \"dtrs-time-plus-minus\" }, \"All Day\", -1))\n                        ])\n                      ])\n                    ]),\n                    _createElementVNode(\"div\", null, [\n                      _createVNode(_component_v_number_input, {\n                        modelValue: _unref(instancesBack),\n                        \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => (_isRef(instancesBack) ? (instancesBack).value = $event : null)),\n                        label: \"Number of Weeks\",\n                        rules: instanceRules.value,\n                        min: 1,\n                        max: 104,\n                        density: \"compact\",\n                        variant: \"outlined\",\n                        \"control-variant\": \"split\"\n                      }, null, 8, [\"modelValue\", \"rules\"])\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                      _cache[23] || (_cache[23] = _createElementVNode(\"label\", null, \"going back from\", -1)),\n                      _createVNode(_unref(DatePicker), {\n                        class: \"reference-date-picker\",\n                        ref_key: \"weekdayCalendar\",\n                        ref: weekdayCalendar,\n                        \"model-value\": weekdayStartDateObj.value,\n                        onInternalModelChange: handleWeekdayDateChange,\n                        \"allowed-dates\": __props.allowedDates,\n                        format: _unref(formatDateDisplay),\n                        \"preview-format\": _unref(formatDateDisplay),\n                        clearable: false,\n                        \"text-input\": \"\",\n                        teleport: true,\n                        dark: \"\",\n                        \"year-range\": [__props.allowedDates ? __props.allowedDates[0].getFullYear() : 2023, __props.allowedDates ? __props.allowedDates[__props.allowedDates.length - 1].getFullYear() : new Date().getFullYear()]\n                      }, null, 8, [\"model-value\", \"allowed-dates\", \"format\", \"preview-format\", \"year-range\"])\n                    ])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_expand_transition, null, {\n            default: _withCtx(() => [\n              (_unref(selectionType) === 'singledate')\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                    _createElementVNode(\"div\", _hoisted_13, [\n                      _cache[24] || (_cache[24] = _createElementVNode(\"label\", { class: \"text-subtitle-2 mb-2 d-block\" }, \"Date\", -1)),\n                      _createVNode(_unref(DatePicker), {\n                        ref_key: \"singleDateCalendar\",\n                        ref: singleDateCalendar,\n                        \"model-value\": singleDateObj.value,\n                        onInternalModelChange: handleSingleDateChange,\n                        \"allowed-dates\": __props.allowedDates,\n                        format: _unref(formatDateDisplay),\n                        \"preview-format\": _unref(formatDateDisplay),\n                        clearable: false,\n                        \"text-input\": \"\",\n                        teleport: true,\n                        dark: \"\",\n                        \"year-range\": [__props.allowedDates ? __props.allowedDates[0].getFullYear() : 2023, __props.allowedDates ? __props.allowedDates[__props.allowedDates.length - 1].getFullYear() : new Date().getFullYear()]\n                      }, null, 8, [\"model-value\", \"allowed-dates\", \"format\", \"preview-format\", \"year-range\"])\n                    ])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_expand_transition, null, {\n            default: _withCtx(() => [\n              (_unref(selectionType) === 'monthrange')\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                    _createElementVNode(\"div\", _hoisted_15, [\n                      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(monthNames), (month) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                          key: month,\n                          class: \"d-inline-block\"\n                        }, [\n                          _cache[25] || (_cache[25] = _createElementVNode(\"label\", {\n                            class: \"mr-3\",\n                            style: {\"text-wrap\":\"nowrap\"},\n                            for: \"dtrs-month-{{ month }}\"\n                          }, null, -1)),\n                          _withDirectives(_createElementVNode(\"input\", {\n                            id: \"dtrs-month-{{ month }}\",\n                            type: \"checkbox\",\n                            value: _unref(monthNames).indexOf(month),\n                            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => (_isRef(selectedMonths) ? (selectedMonths).value = $event : null))\n                          }, null, 8, _hoisted_16), [\n                            [_vModelCheckbox, _unref(selectedMonths)]\n                          ]),\n                          _createElementVNode(\"span\", _hoisted_17, _toDisplayString(month), 1)\n                        ]))\n                      }), 128))\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_18, [\n                      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(possibleYears.value, (year) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                          key: year,\n                          class: \"d-inline-block\"\n                        }, [\n                          _cache[26] || (_cache[26] = _createElementVNode(\"label\", {\n                            class: \"mr-3\",\n                            style: {\"text-wrap\":\"nowrap\"},\n                            for: \"dtrs-year-{{ year }}\"\n                          }, null, -1)),\n                          _withDirectives(_createElementVNode(\"input\", {\n                            id: \"dtrs-year-{{ year }}\",\n                            type: \"checkbox\",\n                            value: year,\n                            \"onUpdate:modelValue\": _cache[10] || (_cache[10] = ($event: any) => (_isRef(selectedYears) ? (selectedYears).value = $event : null))\n                          }, null, 8, _hoisted_19), [\n                            [_vModelCheckbox, _unref(selectedYears)]\n                          ]),\n                          _createElementVNode(\"span\", _hoisted_20, _toDisplayString(year), 1)\n                        ]))\n                      }), 128))\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_21, [\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[11] || (_cache[11] = ($event: any) => (selectedMonths.value = [11,0,1]))\n                      }, {\n                        default: _withCtx(() => [...(_cache[27] || (_cache[27] = [\n                          _createTextVNode(\"Winter\", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[12] || (_cache[12] = ($event: any) => (selectedMonths.value = [2,3,4]))\n                      }, {\n                        default: _withCtx(() => [...(_cache[28] || (_cache[28] = [\n                          _createTextVNode(\"Spring\", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[13] || (_cache[13] = ($event: any) => (selectedMonths.value = [5,6,7]))\n                      }, {\n                        default: _withCtx(() => [...(_cache[29] || (_cache[29] = [\n                          _createTextVNode(\"Summer\", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[14] || (_cache[14] = ($event: any) => (selectedMonths.value = [8,9,10]))\n                      }, {\n                        default: _withCtx(() => [...(_cache[30] || (_cache[30] = [\n                          _createTextVNode(\"Fall\", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createVNode(_component_v_btn, {\n                        size: \"x-small\",\n                        variant: \"outlined\",\n                        class: \"mr-2 mb-2\",\n                        onClick: _cache[15] || (_cache[15] = ($event: any) => (selectedMonths.value = []))\n                      }, {\n                        default: _withCtx(() => [...(_cache[31] || (_cache[31] = [\n                          _createTextVNode(\"Clear Months\", -1)\n                        ]))]),\n                        _: 1\n                      })\n                    ])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_btn, {\n            color: \"primary\",\n            variant: \"elevated\",\n            class: \"mb-4\",\n            onClick: updateCustomRange\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_icon, { class: \"mr-2\" }, {\n                default: _withCtx(() => [...(_cache[32] || (_cache[32] = [\n                  _createTextVNode(\"mdi-update\", -1)\n                ]))]),\n                _: 1\n              }),\n              _cache[33] || (_cache[33] = _createTextVNode(\" Confirm Selection \", -1))\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n  <v-card class=\"datetime-range-selector\" elevation=\"2\">\n\n    <v-card-text>\n      <!-- Selection Type Radio Buttons -->\n      <v-radio-group \n        v-model=\"selectionType\" \n        row \n        density=\"compact\"\n      >\n        <v-radio \n          label=\"Single Date\" \n            value=\"singledate\"\n          density=\"compact\"\n        />    \n        <v-radio \n          label=\"Date Range\" \n          value=\"daterange\"\n          density=\"compact\"\n        />\n        <v-radio \n          label=\"Months Range\" \n          value=\"monthrange\"\n          density=\"compact\"\n        />\n\n        <v-radio \n          label=\"Pattern (Days  Times)\" \n          value=\"pattern\"\n          density=\"compact\"\n        />\n      </v-radio-group>\n\n\n\n      <!-- Date Range Section -->\n      <v-expand-transition>\n        <div v-if=\"selectionType === 'daterange'\" class=\"date-range-section\">\n          <!-- Date Range Picker -->\n            <div class=\"mb-4\">\n              <label class=\"text-subtitle-2 mb-2 d-block\">Pick Date Range</label>\n              <date-picker\n                range\n                :multi-calendars=\"{solo: true}\"\n                ref=\"dateRangeCalendar\"\n                :model-value=\"dateRangeArray\"\n                @internal-model-change=\"handleDateRangeChange\"\n                :allowed-dates=\"allowedDates\"\n                :format=\"(d) => d.map(formatDateDisplay).join(' - ')\"\n                :teleport=\"true\"\n                :enable-time-picker=\"false\"\n                dark\n                :year-range=\"[allowedDates ? allowedDates[0].getFullYear() : 2023, allowedDates ? allowedDates[allowedDates.length - 1].getFullYear() : new Date().getFullYear()]\"\n              />\n          </div>\n        </div>\n      </v-expand-transition>\n\n      <!-- Pattern Section (Multi-day, Multi-time) -->\n      <v-expand-transition>\n        <div v-if=\"selectionType === 'pattern'\" class=\"pattern-section\">\n          <!-- Days of Week Multi-toggle -->\n          <div class=\"mb-4\">\n            <label class=\"text-subtitle-2 mb-2 d-block\">Days of Week</label>\n            <!-- just do labeled checkboxes -->\n            <label v-for=\"(day, idx) in dayOptions\" :key=\"idx\" class=\"mr-3\" style=\"text-wrap: nowrap;\">\n              <input \n                type=\"checkbox\" \n                :value=\"day.value\" \n                v-model=\"selectedDays\" \n              />\n              <span class=\"ml-1\">{{ day.title.slice(0,3) }}</span>\n            </label>\n          </div>\n          <div class=\"mb-4 simple-patterns\">\n            <!-- weekdays -->\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedDays = [1,2,3,4,5]\"\n            >Weekdays</v-btn>\n            <!-- weekends -->\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedDays = [0,6]\"\n            >Weekends</v-btn>\n            <!-- full weeek -->\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedDays = [0,1,2,3,4,5,6]\"\n            >Full Week</v-btn>\n            <!-- clear -->\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedDays = []\"\n            >Clear</v-btn>\n          </div>\n\n          <!-- Times Multi-select -->\n          <div class=\"mb-4\">\n            <div class=\"mt-2 dtrs-flex-time-box\">\n              <v-combobox\n                v-model=\"selectedTimes\"\n                :items=\"timeOptions\"\n                label=\"Add/select times\"\n                multiple\n                chips\n                closable-chips\n                density=\"compact\"\n                variant=\"outlined\"\n                hide-details\n                hint=\"24h format HH:MM (e.g., 09:00, 14:30)\"\n                persistent-hint\n                @update:model-value=\"normalizeTimes\"\n              />\n              \n              <div class=\"pm-wrapper\">\n                <input\n                  id=\"dtrs-time-plus-minus\"\n                  type=\"checkbox\"\n                  v-model=\"timePlusMinus\"\n                  :true-value=\"11.9999\"\n                  :false-value=\"0.49999\"\n                />\n                <label for=\"dtrs-time-plus-minus\">All Day</label>\n              </div>\n            </div>\n          </div>\n\n          <!-- Instances -->\n          <div>\n            <v-number-input\n              v-model=\"instancesBack\"\n              label=\"Number of Weeks\"\n              :rules=\"instanceRules\"\n              :min=\"1\"\n              :max=\"104\"\n              density=\"compact\"\n              variant=\"outlined\"\n              control-variant=\"split\"\n            />\n          </div>\n          <!-- Reference Date -->\n          <div class=\"mb-2\">\n            <label>going back from</label>\n            <date-picker\n              class=\"reference-date-picker\"\n              ref=\"weekdayCalendar\"\n              :model-value=\"weekdayStartDateObj\"\n              @internal-model-change=\"handleWeekdayDateChange\"\n              :allowed-dates=\"allowedDates\"\n              :format=\"formatDateDisplay\"\n              :preview-format=\"formatDateDisplay\"\n              :clearable=\"false\"\n              text-input\n              :teleport=\"true\"\n              dark\n              :year-range=\"[allowedDates ? allowedDates[0].getFullYear() : 2023, allowedDates ? allowedDates[allowedDates.length - 1].getFullYear() : new Date().getFullYear()]\"\n            />\n          </div>\n        </div>\n      </v-expand-transition>\n\n      <!-- Single Date Section -->\n      <v-expand-transition>\n        <div v-if=\"selectionType === 'singledate'\" class=\"single-date-section\">\n          <div class=\"mb-4\">\n            <label class=\"text-subtitle-2 mb-2 d-block\">Date</label>\n            <date-picker\n              ref=\"singleDateCalendar\"\n              :model-value=\"singleDateObj\"\n              @internal-model-change=\"handleSingleDateChange\"\n              :allowed-dates=\"allowedDates\"\n              :format=\"formatDateDisplay\"\n              :preview-format=\"formatDateDisplay\"\n              :clearable=\"false\"\n              text-input\n              :teleport=\"true\"\n              dark\n              :year-range=\"[allowedDates ? allowedDates[0].getFullYear() : 2023, allowedDates ? allowedDates[allowedDates.length - 1].getFullYear() : new Date().getFullYear()]\"\n            />\n          </div>\n        </div>\n      </v-expand-transition>\n      \n      <!-- Month Selection -->\n      <v-expand-transition>\n        <div v-if=\"selectionType === 'monthrange'\" class=\"month-selection-section\">\n          <div class=\"mb-4\">\n            <div  v-for=\"month in monthNames\" :key=\"month\" class=\"d-inline-block\">\n            <label class=\"mr-3\" style=\"text-wrap: nowrap;\" for=\"dtrs-month-{{ month }}\"></label>\n              <input \n                id=\"dtrs-month-{{ month }}\"\n                type=\"checkbox\" \n                :value=\"monthNames.indexOf(month)\" \n                v-model=\"selectedMonths\" \n              />\n              <span class=\"ml-1\">{{ month }}</span>\n            </div>\n          </div>\n          \n          <div class=\"mb-4\">\n            <div v-for=\"year in possibleYears\" :key=\"year\" class=\"d-inline-block\">\n            <label  class=\"mr-3\" style=\"text-wrap: nowrap;\" for=\"dtrs-year-{{ year }}\"></label>\n              <input \n                id=\"dtrs-year-{{ year }}\"\n                type=\"checkbox\" \n                :value=\"year\" \n                v-model=\"selectedYears\" \n              />\n              <span class=\"ml-1\">{{ year }}</span>\n            </div>\n            \n          </div>\n          \n          <div class=\"mb-4 simple-patterns\">\n            <!-- winter, spring, summer, fall -->\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedMonths = [11,0,1]\"\n            >Winter</v-btn>\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedMonths = [2,3,4]\"\n            >Spring</v-btn>\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedMonths = [5,6,7]\"\n            >Summer</v-btn>\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedMonths = [8,9,10]\"\n            >Fall</v-btn>\n            <!-- clear -->\n            <v-btn \n              size=\"x-small\" \n              variant=\"outlined\" \n              class=\"mr-2 mb-2\"\n              @click=\"selectedMonths = []\"\n            >Clear Months</v-btn>\n          </div>\n        </div>\n      </v-expand-transition>\n      \n\n      <!-- Update Custom Range Button -->\n      <v-btn\n        color=\"primary\"\n        variant=\"elevated\"\n        class=\"mb-4\"\n        @click=\"updateCustomRange\"\n      >\n        <v-icon class=\"mr-2\">mdi-update</v-icon>\n        Confirm Selection \n      </v-btn>\n\n    </v-card-text>\n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\n// === IMPORTS ===\nimport { watch, computed, ref, onMounted } from 'vue';\nimport DatePicker from '@vuepic/vue-datepicker';\nimport '@vuepic/vue-datepicker/dist/main.css';\nimport { useTimezone } from '../composables/useTimezone';\nimport { useDateTimeSelector } from './useDateTimeSelector';\nimport type { MillisecondRange, TimeRangeSelectionType } from '../types/datetime';\nimport { formatTimeRange } from \"@/utils/timeRange\";\n\n\n// === INTERFACES === \n// === PROPS ===\nconst props = defineProps<{\n  currentDate: Date;\n  defaultStartDate?: Date;\n  defaultEndDate?: Date;\n  allowedDates?: Date[];\n  validTimes?: number[]; // timestamps\n}>();\n\n// === EMITS ===\nconst emit = defineEmits<{\n  'ranges-change': [ranges: MillisecondRange[], selectionType: TimeRangeSelectionType, customName: string];\n}>();\n\n// === COMPOSABLE SETUP ===\n// Create refs for the current date and timezone to pass to the composable\nconst currentDateRef = ref(props.currentDate);\n// Using UTC for time range generation - will be offset to local timezone when fetching data\nconst timezoneRef = ref('UTC');\n// Initialize timezone handling\nconst { setToMidnight, setToEndOfDay, formatDateDisplay } = useTimezone(timezoneRef);\n\n// Initialize the datetime selector composable with optional parameters\nconst {\n  selectionType,\n  instancesBack,\n  timePlusMinus,\n  weekdayStartDate,\n  startDate,\n  endDate,\n  setWeekdayStartTimestamp,\n  setStartTimestamp: setStartTimestampInternal,\n  setEndTimestamp: setEndTimestampInternal,\n  dayNames,\n  monthNames,\n  selectedMonths,\n  selectedYears,\n  generateMillisecondRanges,\n  // single date additions\n  singleDate,\n  setSingleDateTimestamp,\n  generateSingleDateRange,\n  // pattern additions\n  selectedDays,\n  selectedTimes,\n  generatePatternRanges,\n  generateMonthRanges,\n} = useDateTimeSelector({\n  currentDate: currentDateRef,\n  selectedTimezone: timezoneRef\n});\n\n// === REFS ===\nconst weekdayCalendar = ref();\n// const startDateCalendar = ref();\n// const endDateCalendar = ref();\nconst singleDateCalendar = ref();\n\n// === PICKER STATE ===\n// Direct date objects for date pickers - no unnecessary timestamp conversion\nconst weekdayStartDateObj = ref<Date | null>(null);\nconst startDateObj = ref<Date | null>(null);\nconst endDateObj = ref<Date | null>(null);\nconst singleDateObj = ref<Date | null>(null);\n\n// Pre-populated time options (every hour from 6am-9pm; user can add custom HH:MM)\nconst timeOptions = ref<string[]>(Array.from({ length: 15 }, (_, h) => `${String(h+6).padStart(2, '0')}:00`));\n// // Compute available time options based on min/max hour in allowedDates in the selected timezone\n// causes a bit a performance degredation and offers 6-9pm for all data, so hard cord it. \n// a better range would be from 9am - 5pm\n// const minMaxHours = computed(() => {\n//   const dates = props.validTimes ?? [];\n//   if (dates.length === 0) return { min: 0, max: 23 };\n//   const hours = dates.map(d => {\n//     return toTimezone(d).getHours();\n//   });\n//   const min = Math.min(...hours);\n//   const max = Math.max(...hours);\n//   return { min, max };\n// });\n\n// const timeOptions = computed<string[]>(() => {\n//   const { min, max } = minMaxHours.value;\n//   const count = max - min + 1;\n//   const hours = count > 0 ? Array.from({ length: count }, (_, i) => min + i) : Array.from({ length: 24 }, (_, i) => i);\n//   return hours.map(h => `${String(h).padStart(2, '0')}:00`);\n// });\n\nconst possibleYears = computed(() => {\n  const dates = props.allowedDates ?? [2024];\n  if (dates.length === 0) return [2023, new Date().getFullYear()];\n  const years = dates.map(d => d.getFullYear());\n  // Deduplicate and sort\n  return [...new Set(years)].sort((a, b) => a - b);\n});\n\n// Day options for v-select\nconst dayOptions = computed(() => \n  dayNames.map((day, index) => ({ title: day, value: index }))\n);\n\n// Generate ranges for visualization\n// const ranges = computed(() => {\n//   return generateMillisecondRanges();\n// });\n\n// Validation rules\nconst instanceRules = computed(() => [\n  (v: number) => v >= 1 && v <= 104 || 'Must be between 1 and 104 (2 years)'\n]);\n\nconst customTimeRangeName = computed((): string => {\n  \n  if (selectionType.value === 'singledate') {\n    \n    return `${singleDateObj.value ? formatDateDisplay(singleDateObj.value) : 'No date selected'}`;\n    \n  } else if (selectionType.value === 'pattern') {\n    \n    // string to describe the pattern\n    const dayNamesSelected = selectedDays.value.map(d => dayNames[d].slice(0,3)).join(',');\n    const timesSelected = selectedTimes.value.join(', ');\n    return `Pattern: [${dayNamesSelected}]  [${timesSelected}]  ${Math.abs(timePlusMinus.value)}h  (${formatTimeRange(generatePatternRanges())})`;\n    \n  } else if (selectionType.value === 'monthrange') {\n    \n    const monthNamesSelected = selectedMonths.value.map(m => monthNames[m].slice(0,3)).join(', ');\n    const yearsSelected = selectedYears.value.join(', ');\n    \n    return `Months: [${monthNamesSelected}] in [${yearsSelected}] (${formatTimeRange(generatePatternRanges())})`;\n    \n  } else if (selectionType.value === 'daterange') {\n    \n    return `${startDateObj.value ? formatDateDisplay(startDateObj.value) : 'No start date'} - ${endDateObj.value ? formatDateDisplay(endDateObj.value) : 'No end date'}`;\n    \n  } else {\n    \n    return 'Unrecognized selection type';\n  }\n    \n});\n\n// === METHODS ===\n// Update custom range button handler\nfunction updateCustomRange() {\n  let currentRanges: MillisecondRange[] = [];\n  if (selectionType.value === 'singledate') {\n    currentRanges = generateSingleDateRange();\n  } else if (selectionType.value === 'pattern') {\n    currentRanges = generatePatternRanges();\n  } else if (selectionType.value === 'monthrange') {\n    currentRanges = generateMonthRanges();\n  } else {\n    currentRanges = generateMillisecondRanges();\n  }\n  emit('ranges-change', currentRanges, selectionType.value, customTimeRangeName.value);\n}\n\n// Date change handlers\nfunction handleWeekdayDateChange(value: Date) {\n  if (value != null) {\n    if (value.getTime() !== weekdayStartDateObj.value?.getTime()) {\n      weekdayStartDateObj.value = value;\n      // Update composable state directly\n      setWeekdayStartTimestamp(value.getTime());\n      weekdayCalendar.value?.closeMenu();\n    }\n  }\n}\n\nfunction handleStartDateChange(value: Date) {\n  if (value != null) {\n    if (value.getTime() !== startDateObj.value?.getTime()) {\n      startDateObj.value = value;\n      // Convert to timestamp and update composable\n      const timestamp = setToMidnight(value);\n      setStartTimestampInternal(timestamp);\n      // startDateCalendar.value?.closeMenu();\n    }\n  }\n}\n\nfunction handleEndDateChange(value: Date) {\n  if (value != null) {\n    if (value.getTime() !== endDateObj.value?.getTime()) {\n      endDateObj.value = value;\n      // Convert to timestamp and update composable\n      const timestamp = setToEndOfDay(value);\n      setEndTimestampInternal(timestamp);\n      // endDateCalendar.value?.closeMenu();\n    }\n  }\n}\n\n\nconst dateRangeArray = computed<Date[] | null>(() => {\n  if (startDateObj.value && endDateObj.value) {\n    return [startDateObj.value, endDateObj.value];\n  }\n  return null;\n});\nconst dateRangeCalendar = ref();\nfunction handleDateRangeChange(value: Date[]) {\n  if (value && value.length === 2) {\n    const [start, end] = value;\n    let changed = false;\n    if (start.getTime() !== startDateObj.value?.getTime()) {\n      handleStartDateChange(start);\n      changed = true;\n    }\n    if (end.getTime() !== endDateObj.value?.getTime()) {\n      handleEndDateChange(end);\n      changed = true;\n    }\n    if (changed) {\n      dateRangeCalendar.value?.closeMenu();\n    }\n  }\n}\n\nfunction handleSingleDateChange(value: Date) {\n  if (value && value.getTime() !== singleDateObj.value?.getTime()) {\n    singleDateObj.value = value;\n    setSingleDateTimestamp(value.getTime());\n    singleDateCalendar.value?.closeMenu();\n  }\n}\n\n// Normalize entered times to HH:MM 24h (flexible entry via copilot)\nfunction normalizeTimes(values: string[]) {\n  const normalized = values\n    .map(v => String(v).trim())\n    .map(v => {\n      // Accept HH, H, HH:MM, H:MM, also allow am/pm inputs like 9am, 2:30 PM\n      const lower = v.toLowerCase().replace(/\\s+/g, '');\n      const ampmMatch = lower.match(/^(\\d{1,2})(?::(\\d{1,2}))?(am|pm)$/);\n      if (ampmMatch) {\n        let hour = parseInt(ampmMatch[1], 10);\n        const minute = ampmMatch[2] ? parseInt(ampmMatch[2], 10) : 0;\n        const suffix = ampmMatch[3];\n        if (suffix === 'pm' && hour < 12) hour += 12;\n        if (suffix === 'am' && hour === 12) hour = 0;\n        return `${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}`;\n      }\n      const m = lower.match(/^(\\d{1,2})(?::(\\d{1,2}))?$/);\n      if (!m) return null;\n      const h = parseInt(m[1], 10);\n      const mm = m[2] ? parseInt(m[2], 10) : 0;\n      if (isNaN(h) || h < 0 || h > 23) return null;\n      if (isNaN(mm) || mm < 0 || mm > 59) return null;\n      return `${String(h).padStart(2, '0')}:${String(mm).padStart(2, '0')}`;\n    })\n    .filter((v): v is string => !!v);\n  // Deduplicate\n  const unique = Array.from(new Set(normalized));\n  selectedTimes.value = unique;\n}\n\n// Formatting functions\n// Formatting functions moved to useTimezone composable\n\n// === LIFECYCLE HOOKS ===\nonMounted(() => {\n  // Initialize default dates\n  if (props.defaultStartDate) {\n    startDateObj.value = props.defaultStartDate;\n    const timestamp = setToMidnight(props.defaultStartDate);\n    setStartTimestampInternal(timestamp);\n  }\n  if (props.defaultEndDate) {\n    endDateObj.value = props.defaultEndDate;\n    const timestamp = setToEndOfDay(props.defaultEndDate);\n    setEndTimestampInternal(timestamp);\n  } else {\n    // Default end date to today\n    const today = new Date();\n    endDateObj.value = today;\n    const timestamp = setToEndOfDay(today);\n    setEndTimestampInternal(timestamp);\n  }\n  \n  // Initialize weekday start date\n  if (weekdayStartDate.value) {\n    weekdayStartDateObj.value = new Date(weekdayStartDate.value + 'T00:00:00');\n  }\n\n  if (singleDate.value > 0 && !singleDateObj.value) {\n    singleDateObj.value = new Date(singleDate.value);\n  }\n});\n\n// === WATCHERS ===\n// Watch for prop changes and update refs\nwatch(() => props.currentDate, (newDate) => {\n  currentDateRef.value = newDate;\n});\n\n// Keep weekdayStartDateObj in sync with the composable's weekdayStartDate\nwatch(() => weekdayStartDate.value, (newDateString) => {\n  const newDate = newDateString ? new Date(newDateString + 'T00:00:00') : null;\n  if (newDate?.getTime() !== weekdayStartDateObj.value?.getTime()) {\n    weekdayStartDateObj.value = newDate;\n  }\n});\n\n// Keep singleDateObj in sync with the composable's singleDate\nwatch(() => singleDate.value, (newTs) => {\n  if (newTs > 0) {\n    const newDate = new Date(newTs);\n    if (newDate.getTime() !== singleDateObj.value?.getTime()) {\n      singleDateObj.value = newDate;\n    }\n  } else {\n    singleDateObj.value = null;\n  }\n});\n\n// Sync date objects with composable timestamps (one-way: composable  UI)\nwatch(() => startDate.value, (newTimestamp) => {\n  const newDate = newTimestamp > 0 ? new Date(newTimestamp) : null;\n  if (newDate?.getTime() !== startDateObj.value?.getTime()) {\n    startDateObj.value = newDate;\n  }\n});\n\nwatch(() => endDate.value, (newTimestamp) => {\n  const newDate = newTimestamp > 0 ? new Date(newTimestamp) : null;\n  if (newDate?.getTime() !== endDateObj.value?.getTime()) {\n    endDateObj.value = newDate;\n  }\n});\n\n// Ranges are now only emitted when the Update Custom Range button is clicked\n</script>\n\n<style scoped>\n/* === INPUT STYLES === */\n.time-input {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.23);\n  border-radius: 4px;\n  background: transparent;\n  color: inherit;\n  font-family: inherit;\n  font-size: 14px;\n  transition: border-color 0.2s ease, box-shadow 0.2s ease;\n}\n\n.time-input:focus {\n  outline: none;\n  border-color: rgb(var(--v-theme-primary));\n  box-shadow: 0 0 0 2px rgba(var(--v-theme-primary), 0.2);\n}\n\n.dtrs-flex-time-box {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px 10px;\n  align-items: center;\n}\n\n.pm-wrapper {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  flex: 0 0 auto;\n}\n\n.pm-wrapper > span {\n  font-size: 1.2em;\n  line-height: 1;\n}\n\n.reference-date-picker {\n  /*Font sizes*/\n    --dp-font-size: 0.8rem; /*Default font-size*/\n    --dp-preview-font-size: 0.7rem; /*Font size of the date preview in the action row*/\n}\n\n</style>\n","import script from \"./DateTimeRangeSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DateTimeRangeSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DateTimeRangeSelection.vue?vue&type=style&index=0&id=333004fe&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-333004fe\"]])\n\nexport default __exports__","\nimport {\n  nan2null,\n  nanmin,\n  nanmax,\n} from \"@/utils/array_operations/array_math\";\n\nimport {\n  mean,\n  standardError,\n  stdev,\n  sum,\n  median,\n  mad,\n  rootMeanSquare,\n} from \"@/utils/array_operations/array_math\";\n\n\n\n/**\n * Aggregate numerical data and calculates an associated error\n *\n * @param y - An array of numerical values (or nulls) to aggregate.\n * @param e - An optional array of numerical error values (or nulls) corresponding to `y`.\n * @param aggFunc - mean, median, min, max, sum\n * @param errorFunc - The error calculation function to use. Options are:\n *   - `'standardError'`: Calculates the standard error of the values.\n *   - `'stdev'`: Calculates the standard deviation of the values.\n *   - `'mad'`: Calculates the median absolute deviation, scaled to approximate standard deviation.\n * @returns An object containing:\n *   - `value`: The aggregated value, or `null` if the input data is empty or invalid.\n *   - `error`: The calculated error value, or `null` if the input data is empty or invalid.\n *\n * The function handles null values in the input arrays by filtering them out before performing calculations.\n * Notes on Errors\n * \n * For`'sum'`, the error is calculated as the square root of the sum of squared data errors.\n * \n * For `'median'` with `'standardError'`, the error is scaled to approximate the standard error of the median\n * assuming a normal distribution.\n * \n * In general, the final error is quadrature sum of the aggregation error and the RMS of the input errors.\n */\nexport function aggregateData(\n  y: (number | null)[],\n  e: (number | null)[] | undefined,\n  aggFunc: 'mean' | 'median' | 'min' | 'max' | 'sum',\n  errorFunc: 'standardError' | 'stdev' | 'mad',\n): { value: number | null; error: number | null } {\n  \n  // console log an error if we will be ignoring the errorFunc choice\n  // if ((aggFunc === 'min' || aggFunc === 'max' || aggFunc === 'sum') ) {\n  //   console.warn(`Warning: Choice of error function will be ignored when using aggFunc of ${aggFunc}`);\n  // }\n  \n  let aggY: number | null = null;\n  let aggE: number | null = null;\n  \n  const cleanY = y.filter(v => v !== null) as number[];\n  const cleanE = e ? e.filter(v => v !== null) as number[] : [];\n  \n  if (cleanY.length === 0) {\n    return { value: null, error: null };\n  }\n  \n  \n  // Special case for sum since error is different\n  if (aggFunc === 'sum') {\n    aggY = sum(cleanY);\n    aggE = stdev(cleanY);\n    const calE = rootMeanSquare(cleanE);\n    return { value: aggY, error: nan2null(Math.sqrt((aggE ?? 0) ** 2 + (calE ?? 0) ** 2)) };\n  }\n  \n  // Special case for rms since error is different\n  if (aggFunc === 'max') {\n    const r = nanmax(cleanY, true);\n    aggY = r ? r.value : null;\n    aggE = r ? cleanE[r.index] : null;\n    return { value: aggY, error: aggE };\n  }\n  \n  \n  // Special case for rms since error is different\n  if (aggFunc === 'min') {\n    const r = nanmin(cleanY, true);\n    aggY = r ? r.value : null;\n    aggE = r ? cleanE[r.index] : null;\n    return { value: aggY, error: aggE };\n  }\n  \n  // We will be using RMS error in quadrature with aggregation error\n  const calE = rootMeanSquare(cleanE);\n  \n  if (aggFunc === 'mean') {\n    aggY = mean(cleanY);\n  }\n  \n  if (aggFunc === 'median') {\n    aggY = median(cleanY);\n  }\n  \n  if (errorFunc === 'standardError') {\n    aggE = standardError(cleanY);\n    \n  } else if (errorFunc === 'stdev') {\n    aggE = stdev(cleanY);\n    \n  } else if (errorFunc === 'mad') {\n    aggE = mad(cleanY); // scale factor for normal distribution\n    aggE = aggE !== null ? aggE * 1.4826 : null; // convert to stddev equivalent\n  }\n  \n  // sqrt(pi/2) = 1.2533141...\n  // https://stats.stackexchange.com/a/61759\n  // https://en.wikipedia.org/wiki/Median#Sampling_distribution\n  if (aggE !== null && aggFunc === 'median' && errorFunc === 'standardError') {\n    aggE = aggE * 1.25331; // convert to standard error on median (assuming normal)\n  }\n  \n  const finalError = nan2null(Math.sqrt((aggE ?? 0) ** 2 + (calE ?? 0) ** 2));\n  \n  return { value: aggY, error: finalError };\n}\n\n\n\n","import { toZonedTime, fromZonedTime } from 'date-fns-tz';\n\nexport const START_WEEK_ON_MONDAY = false;\n\n\nexport function getBeginningOfWeek(date: Date, timezone?: string): Date {\n  const zonedDate = timezone ? toZonedTime(date, timezone) : new Date(date);\n  const day = zonedDate.getDay(); // 0 (Sun) to 6 (Sat)\n  const weekStart = new Date(zonedDate);\n  if (START_WEEK_ON_MONDAY) {\n    if (day === 0) { // if it is a Sunday, go back 6 days to monday\n      weekStart.setDate(zonedDate.getDate() - 6);\n    } else { // otherwise only go back to Monday\n      weekStart.setDate(zonedDate.getDate() - (day - 1));\n    }\n  \n  } else { // we can just subtract the day number\n    weekStart.setDate(zonedDate.getDate() - day);\n  }\n  weekStart.setHours(0, 0, 0, 0);\n  // want this to return the UTC time (so we can use the timestamp if we want)\n  return timezone ? fromZonedTime(weekStart, timezone) : weekStart;\n}\n\nexport function getEndOfWeek(date: Date, timezone?: string): Date {\n  // we'll handle the timzone\n  const zonedDate = timezone ? toZonedTime(date, timezone) : date;\n  const weekEnd = getBeginningOfWeek(zonedDate); // we'll modify this to be the end\n  // increment by 6 days 23:59:59.999\n  weekEnd.setDate(weekEnd.getDate() + 6); // move to Sunday\n  weekEnd.setHours(23, 59, 59, 999); // end of the day\n  return timezone ? fromZonedTime(weekEnd, timezone) : weekEnd;\n}\n\n\nfunction dayOfYear(date: Date): number {\n  const start = new Date(date.getFullYear(), 0, 0);\n  const diff = date.getTime() - start.getTime();\n  const oneDay = 1000 * 60 * 60 * 24;\n  return Math.floor(diff / oneDay);\n}\n\nfunction getWeekOfYearSundayStart(date: Date) {\n  const currentDayOfYear = dayOfYear(date);\n  const januaryFirst = new Date(date.getFullYear(), 0, 1);\n  const dayOfYearStart = januaryFirst.getDay();\n  \n  return Math.floor((currentDayOfYear + dayOfYearStart) / 7) + 1; \n}\n\nfunction getWeekOfYearMondayStart(date: Date) {\n  const currentDayOfYear = dayOfYear(date);\n  const januaryFirst = new Date(date.getFullYear(), 0, 1);\n  // Shift so that Monday = 0, Sunday = 6\n  const dayOfYearStart = (januaryFirst.getDay() + 6) % 7;\n\n  return Math.floor((currentDayOfYear + dayOfYearStart) / 7) + 1;\n}\n\nexport function getWeekOfYear(date: Date) {\n  return START_WEEK_ON_MONDAY ? getWeekOfYearMondayStart(date) : getWeekOfYearSundayStart(date);\n}\n\n\n/**\n * Helper to get number of days in a month\n * @param month 1-12 for Jan-Dec\n * @param year full year e.g. 2023\n * @returns number of days in the month\n */\nexport function daysInMonth(month, year) {\n  return new Date(year, month, 0).getDate();\n}\n\nexport function getDaysInMonth(date: Date): number {\n  return daysInMonth(date.getMonth() + 1, date.getFullYear());\n}\n\nexport function getDaysInYear(date: Date): number {\n  const year = date.getFullYear();\n  return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0) ? 366 : 365;\n}\n\nexport function seasonFraction(date: Date): number {\n  // D=12, J=1, F=2, M=3, A=4, M=5, J=6, J=7, A=8, S=9, O=10, N=11\n  // D=11, J=0, F=1, M=2, A=3, M=4, J=5, J=6, A=7, S=8, O=9, N=10 (0-based)\n  const month = date.getMonth();\n  const seasonStartingMonths = [11, 2, 5, 8]; // Dec-11, Mar-2, Jun-5, Sep-8\n  const seasonEndingMonths = [1, 4, 7, 10]; // Feb-1, May-4, Aug-7, Nov-10\n  const season = Math.floor(((month + 1) / 3) % 4); // 0, 1, 2, 3 for DJF, MAM, JJA, SON\n\n  const yearOff = season === 0 ? 1 : 0; // if DJF, then year offset is 1\n  const seasonStart = new Date(\n    date.getFullYear() - yearOff, \n    seasonStartingMonths[season], 1).getTime(); // Dec 1 of previous year\n  const seasonEnd = new Date(\n    date.getFullYear(),\n    seasonEndingMonths[season] +1 , -1, 23, 59, 59, 999).getTime(); // Last day of Feb\n  const seasonFrac = (date.getTime() - seasonStart) / (seasonEnd - seasonStart);\n  return seasonFrac;\n  \n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function _run_value_or_funcion<T, D>(valueOrFunc: T | ((input: D) => T) | undefined, argument?: D) : T | undefined {\n  if (valueOrFunc === undefined) return undefined;\n  if (typeof valueOrFunc === 'function') {\n    if (!argument) throw new Error('An argument must be provided when value is a function');\n    return (valueOrFunc as (input: D) => T)(argument);\n  }\n  return valueOrFunc;\n} \n\nexport type BinSizes = 's' | 'minute' | 'hour' | 'day' | 'week' | 'month' | 'year' | 'none' | 'weekendweekday';\nexport type FoldPeriods = 'day' | 'week' | 'year' | 'none' | 'weekendweekday';\n\n/**\n * \n * Handle our basic BinSizes and time specifiers\n * \n * \n*/\n\nfunction altFloorHour(date: Date): Date {\n  const msPerHour = 3600000; // milliseconds in an hour\n  return new Date(Math.round(date.getTime() / msPerHour) * msPerHour);\n}\n\nfunction floorWeekendWeekday(date: Date): Date {\n  // The weekend defined to be consecutive Saturday and Sunday\n  const _date = new Date(date);\n  const day = date.getDay();\n  _date.setHours(0, 0, 0, 0); // set to start of day\n  \n  const isWeekday = !(day === 0 || day === 6);\n  // just push to previous Monday\n  \n  \n  if (isWeekday) { // move to Monday\n    _date.setDate(date.getDate() - day + 1);\n    return _date;\n  } \n  \n  // // eslint-disable-next-line no-empty\n  if (day === 6) { \n    _date.setDate(date.getDate() - 5); // move to Monday\n  }\n  \n  if (day == 0) {\n    _date.setDate(date.getDate() - 1 - 5);\n  }\n  \n  return _date;\n}\n\nconst d = (date: Date) => new Date(date); // helper to avoid mutating input date\nconst dateFlooringMap = new Map<BinSizes, (date: Date) => Date>([\n  ['s', (date: Date) => new Date(d(date).setMilliseconds(0))],\n  \n  ['minute', (date: Date) => new Date(d(date).setSeconds(0, 0))],\n  \n  // ['hour', (date: Date) => new Date(d(date).setMinutes(0, 0, 0))],\n  ['hour', altFloorHour], // we want to bin to the nearest hour\n  \n  ['day', (date: Date) => new Date(d(date).setHours(0, 0, 0, 0))],\n  \n  ['week', (date: Date) => getBeginningOfWeek(date)],\n  \n  ['month', (date: Date) => new Date(date.getFullYear(), date.getMonth(), 1, 0, 0, 0, 0)],\n  \n  ['year', (date: Date) => new Date(date.getFullYear(), 0, 1, 0, 0, 0, 0)],\n  \n  ['none', (date: Date) => date],\n  \n  ['weekendweekday', (date: Date) => floorWeekendWeekday(date)],\n  \n]); \n  \n// we never actually use this fucntionc\n// const getDateLocalPart = new Map<BinSizes, (date: Date) => number>([\n//   ['s', (date: Date) => date.getSeconds()],\n//   ['minute', (date: Date) => date.getMinutes()],\n//   ['hour', (date: Date) => date.getHours()],\n//   ['day', (date: Date) => date.getDate()],\n//   ['week', (date: Date) => getWeekOfYear(date)],\n//   ['month', (date: Date) => date.getMonth()], // return 1-12\n//   ['year', (date: Date) => date.getFullYear()],\n//   ['none', (date: Date) => date.getTime()], // not sure if this makes sense\n//   ['weekendweekday', (date: Date) => {\n//     const day = date.getDay();\n//     return (day === 0 || day === 6) ? 2 : 5; // 6 = Sat/Sun, 1 = Mon-Fri\n//   }], \n// ]);\n\nconst MS_IN_SECOND = 1000;\nconst MS_IN_MINUTE = 60 * MS_IN_SECOND;\nconst MS_IN_HOUR = 60 * MS_IN_MINUTE;\nconst MS_IN_DAY = 24 * MS_IN_HOUR;\nconst MS_IN_WEEK = 7 * MS_IN_DAY;\n\nexport const binDurationMs = new Map<BinSizes, number | ((date: Date) => number)>([\n  ['s', MS_IN_SECOND],\n  ['minute', MS_IN_MINUTE],\n  ['hour', MS_IN_HOUR],\n  ['day', MS_IN_DAY],\n  ['week', MS_IN_WEEK],\n  ['month', (date: Date) => {\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    return daysInMonth(month + 1, year) * MS_IN_DAY;\n  }],\n  ['year', (date: Date) => {\n    const year = date.getFullYear();\n    return getDaysInYear(new Date(year, 0, 1)) * MS_IN_DAY;\n  }],\n  ['none', 1],\n  ['weekendweekday', (date: Date) => {\n    const day = date.getDay();\n    return MS_IN_DAY * (day === 0 || day === 6 ? 1 : 1);\n  }],\n]);\n\nexport function floorTime(date: Date, floorTo: BinSizes): Date {\n  const func = dateFlooringMap.get(floorTo);\n  if (!func) throw new Error(`Unsupported floorTo value: ${floorTo}`);\n  return func(new Date(date)); // use new Date to avoid mutating input date\n}\n\nexport function getBinSizeAsMs(size: BinSizes, date?: Date): number | undefined {\n  const duration = binDurationMs.get(size);\n  return _run_value_or_funcion(duration, date);\n}\n\n\n// we never actually use this function\n// export const applyFoldOnFunctions = (date: Date, f: BinSizes) => getDateLocalPart.get(f)!(date);\n\nexport const applyFloorFunctions = (date: Date, bin: BinSizes) => dateFlooringMap.get(bin)!(date);\n\n\nexport function getFoldedPhase(date: Date, period: FoldPeriods, normalize=false): number {\n  if (period === 'none') return date.getTime();\n  const originalTime = date.getTime();\n  const foldOn = applyFloorFunctions(new Date(date), period).getTime();\n  if (!normalize) {\n    return originalTime - foldOn;\n  }\n  const durationMsValue = binDurationMs.get(period)!;\n  const durationMs = typeof durationMsValue === 'function' ? durationMsValue(date) : durationMsValue;\n\n  return (originalTime - foldOn) / durationMs;\n\n}\n\n\n\n\n\n/**\n * Returns a number or function that provides a precise duration in milliseconds\n * for the given TimeSpecifier.\n * In particular - for month and year, it returns a function that takes a Date object\n */\n\n\ntype SecondSpecifier = 's' | 'sec' | 'second' ;\ntype MinuteSpecifier =  'min' | 'minute' ;\ntype HourSpecifier = 'h' | 'hr' | 'hour' ;\ntype DaySpecifier = 'd' | 'day' ;\ntype MonthSpecifier = 'm' | 'mon' | 'month' ;\ntype YearSpecifier = 'y' | 'yr' | 'year' ;\ntype WeekSpecifier = 'w' | 'wk' | 'week' ;\ntype TimeSpecifier = SecondSpecifier | MinuteSpecifier | HourSpecifier | DaySpecifier | MonthSpecifier | YearSpecifier | WeekSpecifier ;\n\nconst timespecifierToBinSize: Record<TimeSpecifier, BinSizes> = {\n  's': 's', 'sec': 's', 'second': 's', \n  'min': 'minute', 'minute': 'minute', \n  'h': 'hour', 'hr': 'hour', 'hour': 'hour', \n  'd': 'day', 'day': 'day', \n  'w': 'week', 'wk': 'week', 'week': 'week', \n  'm': 'month', 'mon': 'month', 'month': 'month', \n  'y': 'year', 'yr': 'year', 'year': 'year',\n};\n\nexport function parseTimeSpecifier(spec: string): [number, BinSizes] | null {\n  const tsoptions = Object.keys(timespecifierToBinSize).join('|');\n  const decimalOrFloatRegex = '\\\\d*\\\\.?\\\\d+'; // matches integers or decimals of form 10, .5, 0.25, 2.0 etc.\n  const regex = new RegExp(`^(${decimalOrFloatRegex})?\\\\s*(${tsoptions})$`, 'i');\n  const match = spec.trim().match(regex);\n  if (!match) return null;\n  const value = match[1] ? parseFloat(match[1]) : 1;\n  const unit = match[2].toLowerCase() as TimeSpecifier;\n  let binSize: BinSizes;\n  if (unit in timespecifierToBinSize) {\n    binSize = timespecifierToBinSize[unit];\n  } else {\n    return null;\n  }\n  return [value, binSize];\n}\n\n\n\nfunction timeSpecDurationMs(spec: TimeSpecifier) {\n  const parsed = parseTimeSpecifier(spec)!;\n  const [value , binSize] = parsed;\n  const duration = binDurationMs.get(binSize)!;\n  if (typeof duration === 'number') {\n    return value * duration;\n  } else {\n    return (d: Date) => value * duration(d);\n  }\n}\n\n/**\n * Convenience wrapper around timeSpecDurationMs to return the duration in ms\n * for a given TimeSpecifier and optional Date (required for month and year)\n * For a loop it is better to call timeSpecDurationMs once and reuse the result\n * rather than calling this function repeatedly which results in multiple lookups\n * and function creations.\n */\nexport function timespecifierToMs(spec: TimeSpecifier, date?: Date): number | undefined {\n  return _run_value_or_funcion(timeSpecDurationMs(spec), date);\n}\n\n","/* eslint-disable indent */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/** A set of generic routines for aggregating data that comes from \n * our Tempo Data Serivce\n*/\n\nimport type { Prettify } from \"@/types\";\nimport type { RawSampleData } from \"./TempoDataService\";\nimport type { CEsriTimeseries } from \"../types\";\n// import type { TimeSeriesData } from \"./TempoDataService\";\nimport type { AggValue, DataPointError } from \"@/types\";\nimport { \n  toZonedTime, // returns a Date object where the time is ajusted\n  fromZonedTime, \n  format as formatTz,\n  formatInTimeZone\n} from 'date-fns-tz';\nimport {\n  nan2null,\n} from \"../../utils/array_operations/array_math\";\n\nimport { aggregateData } from \"../../utils/array_operations/aggregator\";\n\nexport interface TimeSeriesData {\n  values: Record<number, AggValue>;\n  errors: Record<number, DataPointError>;\n  locations: Array<{ x: number; y: number }>;\n  geometryType: 'rectangle' | 'point';\n}\n\n// a flexible aggregation\n// aggregation options\n// daily, multi-day, weekly\n\n/** https://www.geeksforgeeks.org/javascript/calculate-current-week-number-in-javascript/\n* getWeekoOfYear for Date object\n* If you have a UTC/js timestamp, and want the day of week for a \n* specfic timezone\n*/\nimport {\n  getBeginningOfWeek,\n  getWeekOfYear,\n} from '@/utils/calendar_utils';\n\ntype Window = string ; // e.g, '1d', '3d', '1w' , 'weekly'\n\nexport type AggregationMethod = 'mean' | 'median' | 'sum' | 'min' | 'max';\n\n\nexport class TimeSeriesResampler {\n  window: Window;\n  timezone?: string;\n  method: AggregationMethod;\n  errorMethod: 'std' | 'sem' = 'sem'; // standard deviation or standard error of the mean\n  includeCalibrationUncertainty = true; // whether to include calibration uncertainty in the error propagation\n\n  constructor(\n    window: Window, \n    timezone: string = 'UTC', \n    method: AggregationMethod = 'mean',\n    errorMethod: 'std' | 'sem' = 'sem',\n    includeCalibrationUncertainty = true\n  ) {\n    console.log(\"Creating Grouper with window:\", window, \"timezone:\", timezone, \"method:\", method);\n    this.window = window;\n    this.timezone = timezone;\n    this.method = method;\n    this.errorMethod = errorMethod;\n    this.includeCalibrationUncertainty = includeCalibrationUncertainty;\n    if (includeCalibrationUncertainty) {\n      console.error('This may not handle NaN values in the errors correctly which can lead to Zero values for errors');\n    }\n  }\n  \n  private _getZonedDate(date: Date): Date {\n    return this.timezone ? toZonedTime(date, this.timezone) : date;\n  }\n\n  getGroupId(date: Date): string {\n    const zonedDate = this._getZonedDate(date);\n    const groupDate = new Date(zonedDate);\n    \n    // handle daily or multi-day\n    if (this.window.endsWith('d')) {\n      const days = parseInt(this.window.slice(0, -1));\n      const day = zonedDate.getDate();\n      const groupDay = Math.floor((day - 1) / days) * days + 1;\n      groupDate.setDate(groupDay);\n      groupDate.setHours(0, 0, 0, 0);\n      \n      // handle weekly\n    } else if (this.window === '1w' || this.window === 'weekly') {\n      const weekStart = getBeginningOfWeek(date, this.timezone);\n      return String(weekStart.getTime());\n      \n      // handly monthly\n    } else if (this.window === '1m' || this.window === 'monthly') {\n      groupDate.setDate(1);\n      groupDate.setHours(0, 0, 0, 0);\n      \n      // default to daily\n    } else {\n      groupDate.setHours(0, 0, 0, 0);\n    }\n    const utcMidnight = this.timezone ? fromZonedTime(groupDate, this.timezone) : groupDate;\n    return String(utcMidnight.getTime());\n  }\n  \n  groupData(timeseries: Prettify<TimeSeriesData>): TimeSeriesData {\n    console.log(\"Grouping data with window:\", this.window, \"and method:\", this.method);\n    // the data and the error are in the same order\n    const data = Object.values(timeseries.values); // AggValue[]\n    const error = Object.values(timeseries.errors); // DataPointError[] | undefined\n    \n    // colate the data and errors into groups (bins)\n    const groups: { [key: string]: { values: AggValue[]; errors: DataPointError[] } } = {};\n    data.forEach((d, idx) => {\n      const groupId = this.getGroupId(d.date);\n      if (!groups[groupId]) {\n        groups[groupId] = { values: [], errors: [] };\n      }\n      groups[groupId].values.push(d);\n      if (error) {\n        groups[groupId].errors.push(error[idx]);\n      }\n    });\n\n    // these will be the time-aggregated values\n    const values: Record<number, AggValue> = {};\n    const errors: Record<number, DataPointError> = {};\n    \n    // loop over the groups\n    for (const groupId in groups) {\n      const groupData = groups[groupId];\n      const timestamp = parseInt(groupId); // this is the UTC for the start of the group\n\n      const groupValues = groupData.values.map(d => d.value);\n      \n      // Prepare error arrays for aggregateData (using uppers since errors are symmetric)\n      const errorValues = this.includeCalibrationUncertainty && groupData.errors.length > 0\n        ? groupData.errors.map(e => e.upper)\n        : undefined;\n      \n      // Map error method from 'sem'/'std' to aggregateData's format\n      const errorFunc = this.errorMethod === 'sem' ? 'standardError' : 'stdev';\n      \n      // Use aggregateData (errors are symmetric, so we reuse the result)\n      const result = aggregateData(groupValues, errorValues, this.method, errorFunc);\n      \n      values[timestamp] = { value: result.value, date: new Date(timestamp) };\n      errors[timestamp] = { \n        lower: result.error, \n        upper: result.error \n      };\n      \n      // end of loop over groups\n    }\n    \n    return {\n      values,\n      errors,\n      locations: timeseries.locations,\n      geometryType: timeseries.geometryType\n    };\n  }\n}\n\n\n\n\n\nexport type FoldType = \n    // Original fold types\n    'hourOfDay' | \n    'dayOfWeek' | \n    'hourOfWeek'|\n    'dayOfWeekdayWeekend' |\n    // Hour-based bins\n    'hourOfWeek' |    // hour bins, folded over a week (0-167)\n    'hourOfMonth' |   // hour bins, folded over a month (0-743 max)\n    'hourOfYear' |    // hour bins, folded over a year (0-8783 max)\n    'hourOfSeason' |  // hour bins, folded over a season (0-2183 max)\n    // Day-based bins\n    'dayOfWeek' |     // day bins, folded over a week (0-6)\n    'dayOfMonth' |    // day bins, folded over a month (0-30 max)\n    'dayOfYear' |     // day bins, folded over a year (0-365)\n    'dayOfSeason' |   // day bins, folded over a season (0-91 max)\n    // Week-based bins\n    'weekOfMonth' |   // week bins, folded over a month (0-4 max)\n    'weekOfYear' |    // week bins, folded over a year (0-52)\n    'weekOfSeason' |  // week bins, folded over a season (0-13 max)\n    // Month-based bins\n    'monthOfYear' |   // month bins, folded over a year (0-11)\n    'monthOfSeason'|  // month bins, folded over a season (0-2)\n    // None-period bins (simple binning with dates, no folding)\n    'hourOfNone' |    // hour bins with no folding (x-axis shows dates)\n    'dayOfNone' |     // day bins with no folding (x-axis shows dates)\n    'weekOfNone' |    // week bins with no folding (x-axis shows dates)\n    'monthOfNone' |   // month bins with no folding (x-axis shows dates)\n    // Others\n    'hourOfWeekdayWeekend'; // shows hours of the weekday, and hour of the weekend\n\nexport interface FoldBinContent {\n  bin: number;\n  timestamps: number[];          // original UTC timestamps of samples contributing\n  binPhase: number[]\n  lowers: (number | null)[];    // original lower error values (may include nulls)\n  uppers: (number | null)[];    // original upper error values (may include nulls)\n  rawValues: (number | null)[];  // raw numeric values (may include nulls)\n}\n\n\n// functino to sort folded bin content by timestamps\nexport function sortfoldBinContent(bin: FoldBinContent): FoldBinContent {\n  const sorted = bin.binPhase\n    .map((bp, idx) => ({ bp, idx }))\n    .sort((a, b) =>a.bp - b.bp);\n  \n  const sortedIndices = sorted.map(item => item.idx);\n  function applySort<T>(arr: T[]): T[] {\n    return sortedIndices.map(i => arr[i]);\n  }\n  \n  return {\n    bin: bin.bin,\n    timestamps: applySort(bin.timestamps),\n    binPhase: sorted.map(item => item.bp),\n    rawValues: applySort(bin.rawValues),\n    lowers: applySort(bin.lowers),\n    uppers: applySort(bin.uppers)\n  };\n}\n\nfunction altFloorHour(date: Date): Date {\n  const msPerHour = 3600000; // milliseconds in an hour\n  return new Date(Math.round(date.getTime() / msPerHour) * msPerHour);\n}\n\nexport type Seasons = 'DJF' | 'MAM' | 'JJA' | 'SON'; // meteorological seasons\n\nexport interface FoldedAggValue {\n  value: number | null;\n  bin: number; // 023, 06, or 0167 depending on fold\n  date?: Date; // actual date for None-period bins (hourOfNone, dayOfNone, etc.)\n}\n\ninterface InternalBin {\n      bin: number;\n      timestamps: number[];\n      rawValues: (number | null)[];\n      numericValues: number[];           // non-null numeric values\n      calibrationErrors: DataPointError[]; // original per-sample errors\n    }\n\nexport interface FoldedTimeSeriesData {\n  foldType: FoldType;\n  values: Record<number, FoldedAggValue>;         // binIndex -> aggregated value\n  errors: Record<number, DataPointError>;         // binIndex -> aggregated error\n  bins: Record<number, FoldBinContent>;           // binIndex -> full raw bin content\n  locations: Array<{ x: number; y: number }>;\n  geometryType: 'rectangle' | 'point';\n}\n\n/** Class for folding data periodically \n * We want to control the periodicity and resolution\n*/\nexport class TimeSeriesFolder {\n  foldType: FoldType;\n  timezone: string;\n  method: AggregationMethod;\n  errorMethod: 'std' | 'sem';\n  includeCalibrationUncertainty: boolean;\n\n  constructor(\n    foldType: FoldType,\n    timezone: string = 'UTC',\n    method: AggregationMethod = 'mean',\n    errorMethod: 'std' | 'sem' = 'sem',\n    includeCalibrationUncertainty = true\n  ) {\n    this.foldType = foldType;\n    this.timezone = timezone;\n    this.method = method;\n    this.errorMethod = errorMethod;\n    this.includeCalibrationUncertainty = includeCalibrationUncertainty;\n  }\n  \n  private _getZonedDate(date: Date): Date {\n    return this.timezone ? toZonedTime(date, this.timezone) : date;\n  }\n\n  // convenience to get the number of bins\n  private _binCount(): number {\n    switch (this.foldType) {\n      // Hour-based bins\n      case 'hourOfDay': return 24;\n      case 'hourOfWeek': return 24 * 7;        // 168\n      case 'hourOfMonth': return 24 * 31;      // 744 (max for 31-day month)\n      case 'hourOfYear': return 24 * 366;      // 8784 (max for leap year)\n      case 'hourOfSeason': return 24 * 92;     // 2208 (max ~92 days)\n      \n      // Day-based bins\n      case 'dayOfWeek': return 7;\n      case 'dayOfMonth': return 31;            // max days in a month\n      case 'dayOfYear': return 366;            // max for leap year\n      case 'dayOfSeason': return 92;           // max ~92 days in a season\n      \n      // Week-based bins\n      case 'weekOfMonth': return 5;            // max ~5 weeks in a month\n      case 'weekOfYear': return 54;            // max 53 weeks in a year\n      case 'weekOfSeason': return 14;          // max ~14 weeks in a season\n      \n      // Month-based bins\n      case 'monthOfYear': return 12;\n      case 'monthOfSeason': return 3;          // 3 months per season\n      \n      // None-period bins (use timestamps as keys, so no fixed count)\n      case 'hourOfNone':\n      case 'dayOfNone':\n      case 'weekOfNone':\n      case 'monthOfNone':\n        return Infinity;  // no fixed bin count for None-period types\n      \n      // Special cases\n      case 'dayOfWeekdayWeekend': return 2;\n      case 'hourOfWeekdayWeekend': return 48; // 0-23 for weekday, 24-48 for weekend\n      \n      default:\n        console.error('Unknown fold type:', this.foldType);\n        return 1;\n    }\n  }\n  \n  // instead of a groupId we just need the bin index\n  private _binIndex(date: Date): number {\n    const z = this._getZonedDate(date);\n    \n    switch (this.foldType) {\n      // Hour-based bins\n      case 'hourOfDay': \n        return altFloorHour(z).getHours();                                    // 023\n      case 'hourOfWeek': \n        return z.getDay() * 24 + altFloorHour(z).getHours();                  // 0167\n      case 'hourOfMonth': \n        return (z.getDate() - 1) * 24 + altFloorHour(z).getHours();           // 0743\n      case 'hourOfYear': {\n        const yearStart = new Date(z.getFullYear(), 0, 1);\n        const dayOfYear = Math.floor((z.getTime() - yearStart.getTime()) / (1000 * 60 * 60 * 24));\n        return dayOfYear * 24 + altFloorHour(z).getHours();                   // 08783\n      }\n      case 'hourOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);       // 0-3 for DJF, MAM, JJA, SON\n        const seasonStartMonths = [11, 2, 5, 8];                // Dec, Mar, Jun, Sep\n        const yearOff = season === 0 ? 1 : 0;\n        const seasonStart = new Date(z.getFullYear() - yearOff, seasonStartMonths[season], 1);\n        const dayOfSeason = Math.floor((z.getTime() - seasonStart.getTime()) / (1000 * 60 * 60 * 24));\n        return dayOfSeason * 24 + altFloorHour(z).getHours();                 // 02207\n      }\n      \n      // Day-based bins\n      case 'dayOfWeek': \n        return z.getDay();                                      // 06\n      case 'dayOfMonth': \n        return z.getDate() - 1;                                 // 030\n      case 'dayOfYear': {\n        const yearStart = new Date(z.getFullYear(), 0, 1);\n        return Math.floor((z.getTime() - yearStart.getTime()) / (1000 * 60 * 60 * 24)); // 0365\n      }\n      case 'dayOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);\n        const seasonStartMonths = [11, 2, 5, 8];\n        const yearOff = season === 0 ? 1 : 0;\n        const seasonStart = new Date(z.getFullYear() - yearOff, seasonStartMonths[season], 1);\n        return Math.floor((z.getTime() - seasonStart.getTime()) / (1000 * 60 * 60 * 24)); // 091\n      }\n      \n      // Week-based bins\n      case 'weekOfMonth': {\n        const dayOfMonth = z.getDate();\n        return Math.floor((dayOfMonth - 1) / 7);                // 04\n      }\n      case 'weekOfYear': {\n        return getWeekOfYear(date); // this can be done approximately w/o the timezone\n        // i haven't tested, but in principle there could be some off-by one hour errors\n      }\n      \n      case 'weekOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);\n        const seasonStartMonths = [11, 2, 5, 8];\n        const yearOff = season === 0 ? 1 : 0;\n        const seasonStart = new Date(z.getFullYear() - yearOff, seasonStartMonths[season], 1);\n        const dayOfSeason = Math.floor((z.getTime() - seasonStart.getTime()) / (1000 * 60 * 60 * 24));\n        return Math.floor(dayOfSeason / 7);                     // 013\n      }\n      \n      // Month-based bins\n      case 'monthOfYear': \n        return z.getMonth();                                    // 011\n      case 'monthOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);\n        const seasonStartMonths = [11, 2, 5, 8];\n        const seasonStartMonth = seasonStartMonths[season];\n        // Calculate month offset within season\n        if (season === 0) { // DJF\n          return month === 11 ? 0 : month + 1;                  // Dec=0, Jan=1, Feb=2\n        } else {\n          return (month - seasonStartMonth + 12) % 12;          // 02\n        }\n      }\n      \n      // None-period bins (return timestamp of bin start, like resampler)\n      case 'hourOfNone': {\n        // const zBinStart = new Date(z);\n        // zBinStart.setMinutes(0, 0, 0);\n        const zBinStart = altFloorHour(z);\n        return (this.timezone ? fromZonedTime(zBinStart, this.timezone) : zBinStart).getTime();\n      }\n      case 'dayOfNone': {\n        const zBinStart = new Date(z);\n        zBinStart.setHours(0, 0, 0, 0);\n        return (this.timezone ? fromZonedTime(zBinStart, this.timezone) : zBinStart).getTime();\n      }\n      case 'weekOfNone': {\n        const weekStart = getBeginningOfWeek(date, this.timezone);\n        return weekStart.getTime();\n      }\n      case 'monthOfNone': {\n        const zBinStart = new Date(z);\n        zBinStart.setDate(1);\n        zBinStart.setHours(0, 0, 0, 0);\n        return (this.timezone ? fromZonedTime(zBinStart, this.timezone) : zBinStart).getTime();\n      }\n      \n      // Special cases\n      case 'dayOfWeekdayWeekend': \n        return (z.getDay() % 6 > 0) ? 0 : 1;                    // 1=weekend, 0=weekday\n        \n      case 'hourOfWeekdayWeekend': {\n        const isWeekend = (z.getDay() % 6 === 0);                // true if weekend\n        return isWeekend ? (24 + altFloorHour(z).getHours()) : altFloorHour(z).getHours();  // 0-23 for weekday, 24-47 for weekend\n      }\n      \n      default:\n        console.error('Unknown fold type:', this.foldType);\n        return 0;\n    }\n  }\n  \n  private _binPhase(date: Date): number {\n    const z = this._getZonedDate(date);\n    const minutes = z.getMinutes();\n    const seconds = z.getSeconds();\n    const milliseconds = z.getMilliseconds();\n    \n    switch (this.foldType) {\n      // Hour-based bins - return fraction of hour\n      case 'hourOfDay':\n      case 'hourOfWeek':\n      case 'hourOfMonth':\n      case 'hourOfYear':\n      case 'hourOfSeason':\n      case 'hourOfNone':\n        return -((minutes / 60 + seconds / 3600 + milliseconds / 3600000 ) - 0.5); // fraction of hour\n      \n      // Day-based bins - return fraction of day (as hours)\n      case 'dayOfWeek':\n      case 'dayOfMonth':\n      case 'dayOfYear':\n      case 'dayOfSeason':\n      case 'dayOfNone': {\n        const hourOfDay = z.getHours() + minutes / 60 + seconds / 3600;\n        return hourOfDay / 24; // fraction of day\n      }\n      \n      // Week-based bins - return fraction of week (as days)\n      case 'weekOfMonth':\n      case 'weekOfYear':\n      case 'weekOfSeason':\n      case 'weekOfNone': {\n        const dayOfWeek = z.getDay();\n        const hourOfDay = z.getHours() + minutes / 60 + seconds / 3600;\n        return (dayOfWeek + hourOfDay / 24) / 7; // fraction of week\n      }\n      \n      // Month-based bins - return fraction of month (as days)\n      case 'monthOfYear':\n      case 'monthOfSeason':\n      case 'monthOfNone': {\n        const dayOfMonth = z.getDate() - 1; // 0-based\n        const hourOfDay = z.getHours() + minutes / 60 + seconds / 3600;\n        const daysInMonth = new Date(z.getFullYear(), z.getMonth() + 1, 0).getDate();\n        return (dayOfMonth + hourOfDay / 24) / daysInMonth; // fraction of month\n      }\n      \n      // Special cases\n      case 'dayOfWeekdayWeekend': \n        return 0;  // binary choice, no phase\n        \n      case 'hourOfWeekdayWeekend': {\n        // Return fraction of hour (0-1) to match other hour-based bins\n        return minutes / 60 + seconds / 3600 + milliseconds / 3600000;\n      }\n      \n      default:\n        console.error('Unknown fold type:', this.foldType);\n        return 0;\n    }\n  }\n  \n  foldData(timeseries: Prettify<TimeSeriesData>): FoldedTimeSeriesData {\n    \n    const binCount = this._binCount();\n    const binsRecord: Record<number, Prettify<InternalBin>> = {};\n    \n    // bundle data and errors into bins\n    // it includes the timestamps, and raw/cleaned valued\n    Object.entries(timeseries.values).forEach(([ts,d]) => {\n      const binIndex = this._binIndex(d.date);\n      if (binIndex == null || binIndex < 0 || binIndex >= binCount) {\n        console.error('Invalid bin index', binIndex, 'for date', d.date, 'with fold type', this.foldType);\n        return;\n      }\n      if (!binsRecord[binIndex]) {\n        binsRecord[binIndex] = {\n          bin: binIndex,\n          timestamps: [],\n          rawValues: [],\n          numericValues: [],\n          calibrationErrors: []\n        };\n      }\n      \n      const bin = binsRecord[binIndex];\n      bin.timestamps.push(d.date.getTime());\n      bin.rawValues.push(d.value);\n      // get clean values\n      if (d.value !== null && !isNaN(d.value)) {\n        bin.numericValues.push(d.value);\n      }\n      \n      const err = timeseries.errors[ts];\n      if (err) {\n        bin.calibrationErrors.push(err);\n      } else {\n        console.error('No error found for timestamp', ts);\n      }\n      \n    });\n\n    // Check if this is a None-period fold type\n    const isNonePeriod = ['hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(this.foldType);\n\n    // these will be the time-aggregated values\n    const values: Record<number, FoldedAggValue> = {};\n    const errors: Record<number, DataPointError> = {};\n    const publicBins: Record<number, FoldBinContent> = {};\n\n    // loop over the groups and aggregate\n    Object.values(binsRecord).forEach(bin => {\n\n      const { bin: binIndex, numericValues, calibrationErrors, rawValues, timestamps } = bin;\n      \n      // Prepare error arrays for aggregateData (using uppers since errors are symmetric)\n      const errorValues = this.includeCalibrationUncertainty && calibrationErrors.length > 0\n        ? calibrationErrors.map(e => e.upper)\n        : undefined;\n      \n      // Map error method from 'sem'/'std' to aggregateData's format\n      const errorFunc = this.errorMethod === 'sem' ? 'standardError' : 'stdev';\n      \n      // Use aggregateData (errors are symmetric, so we reuse the result)\n      const result = aggregateData(rawValues, errorValues, this.method, errorFunc);\n      \n      // For None-period bins, binIndex is a timestamp, convert to Date\n      const binDate = isNonePeriod ? new Date(binIndex) : undefined;\n      \n      values[binIndex] = { \n        value: result.value, \n        bin: binIndex,\n        date: binDate\n      };\n      \n      errors[binIndex] = { \n        lower: result.error, \n        upper: result.error \n      };\n      \n      // expose the full bin contents\n      publicBins[binIndex] = {\n        bin: binIndex,\n        timestamps: [...timestamps],\n        binPhase: timestamps.map(t => this._binPhase(new Date(t))),\n        rawValues: [...rawValues].map(v => nan2null(v)),\n        lowers: calibrationErrors.map(e => e.lower).map(v => nan2null(v)),\n        uppers: calibrationErrors.map(e => e.upper).map(v => nan2null(v))\n      };\n      \n    });\n    \n    \n    return {\n      foldType: this.foldType,\n      values,\n      errors,\n      bins: publicBins,\n      locations: timeseries.locations,\n      geometryType: timeseries.geometryType\n    };\n  }\n}\n\n\nexport function hourOfWeekToDayHour(hourOfWeek: number): { day: number; hour: number } {\n  const day = Math.floor(hourOfWeek / 24);\n  const hour = hourOfWeek % 24;\n  return { day, hour };\n}","// Generated by Copilot, modified...\nimport type { Layout } from 'plotly.js-dist-min';\nimport type { FoldType } from '@/esri/services/aggregation';\n\n\n// Main style configuration for each fold type\nexport const foldTypeStyles: Record<FoldType, Partial<Layout>> = {\n  // Hour-based bins\n  'hourOfDay': {\n    xaxis: {\n      title: { text: 'Hour of Day (Local Time for Region)' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 3,\n      tickvals: [0, 3, 6, 9, 12, 15, 18, 21],\n      ticktext: ['12:00 AM', '3:00 AM', '6:00 AM', '9:00 AM', '12:00 PM', '3:00 PM', '6:00 PM', '9:00 PM'],\n      labelalias: {\n        '0': '12:00 AM',\n        '1': '1:00 AM',\n        '2': '2:00 AM',\n        '3': '3:00 AM',\n        '4': '4:00 AM',\n        '5': '5:00 AM',\n        '6': '6:00 AM',\n        '7': '7:00 AM',\n        '8': '8:00 AM',\n        '9': '9:00 AM',\n        '10': '10:00 AM',\n        '11': '11:00 AM',\n        '12': '12:00 PM',\n        '13': '1:00 PM',\n        '14': '2:00 PM',\n        '15': '3:00 PM',\n        '16': '4:00 PM',\n        '17': '5:00 PM',\n        '18': '6:00 PM',\n        '19': '7:00 PM',\n        '20': '8:00 PM',\n        '21': '9:00 PM',\n        '22': '10:00 PM',\n        '23': '11:00 PM'\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      } as any,\n    }\n  },\n  \n  'hourOfWeek': {\n    xaxis: {\n      title: { text: 'Hour of Week' },\n      tickmode: 'array',\n      tickvals: [0, 24, 48, 72, 96, 120, 144],\n      ticktext: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n    },\n  },\n  \n  'hourOfMonth': {\n    xaxis: {\n      title: { text: 'Hour of Month' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 24 * 5, // Every 5 days\n      tickformat: 'd'\n    }\n  },\n  \n  'hourOfYear': {\n    xaxis: {\n      title: { text: 'Day of Year' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 24 * 30, // Roughly monthly\n      tickformat: 'd',\n    }\n  },\n  \n  'hourOfSeason': {\n    xaxis: {\n      title: { text: 'Hour of Season' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 24 * 7, // Weekly\n      tickformat: 'd'\n    }\n  },\n  \n  // Day-based bins\n  'dayOfWeek': {\n    xaxis: {\n      title: { text: 'Day of Week' },\n      tickmode: 'array',\n      tickvals: [0, 1, 2, 3, 4, 5, 6],\n      ticktext: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    }\n  },\n  \n  'dayOfMonth': {\n    xaxis: {\n      title: { text: 'Day of Month' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 5,\n      tickformat: 'd'\n    }\n  },\n  \n  'dayOfYear': {\n    xaxis: {\n      title: { text: 'Day of Year' },\n      tickmode: 'array',\n      tickvals: [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334],\n      ticktext: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n    }\n  },\n  \n  'dayOfSeason': {\n    xaxis: {\n      title: { text: 'Day of Season' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 10,\n      tickformat: 'd'\n    }\n  },\n  \n  // Week-based bins\n  'weekOfMonth': {\n    xaxis: {\n      title: { text: 'Week of Month' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 1,\n      tickformat: 'd'\n    }\n  },\n  \n  'weekOfYear': {\n    xaxis: {\n      title: { text: 'Week of Year' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 4,\n      tickformat: 'd'\n    }\n  },\n  \n  'weekOfSeason': {\n    xaxis: {\n      title: { text: 'Week of Season' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 2,\n      tickformat: 'd'\n    }\n  },\n  \n  // Month-based bins\n  'monthOfYear': {\n    xaxis: {\n      title: { text: 'Month of Year' },\n      tickmode: 'array',\n      tickvals: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],\n      ticktext: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n    }\n  },\n  \n  'monthOfSeason': {\n    xaxis: {\n      title: { text: 'Month of Season' },\n      tickmode: 'array',\n      tickvals: [0, 1, 2],\n      ticktext: ['Month 1', 'Month 2', 'Month 3']\n    }\n  },\n  \n  // None-period bins (simple binning with dates)\n  'hourOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m-%d %H:%M'\n    }\n  },\n  \n  'dayOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m-%d'\n    }\n  },\n  \n  'weekOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m-%d'\n    }\n  },\n  \n  'monthOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m'\n    }\n  },\n  \n  // Special cases\n  'dayOfWeekdayWeekend': {\n    xaxis: {\n      title: { text: 'Day Type' },\n      tickmode: 'array',\n      tickvals: [0, 1],\n      ticktext: ['Weekday', 'Weekend']\n    }\n  },\n  \n  'hourOfWeekdayWeekend': {\n    xaxis: {\n      title: { text: 'Hour of Day' },\n      tickmode: 'array',\n      tickvals: [0, 6, 12, 18, 24, 30, 36, 42],\n      ticktext: ['0:00 WD', '6:00 WD', '12:00 WD', '18:00 WD', '0:00 WE', '6:00 WE', '12:00 WE', '18:00 WE']\n    }\n  }\n};\n\n/**\n * Get the Plotly layout styling for a specific fold type\n */\nexport function getFoldTypeStyle(foldType: FoldType): Partial<Layout> {\n  return foldTypeStyles[foldType];\n}\n\nexport function deepMerge(target: object, source: object): object {\n  for (const key in source) {\n    // if key has and non-array object, iterate recursively\n    if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n      target[key] = deepMerge(target[key] || {}, source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\n\n\nexport function mergeFoldTypeLayout(foldType: FoldType, customLayout?: Partial<Layout>): Partial<Layout> {\n  const foldStyle = getFoldTypeStyle(foldType);\n  return deepMerge(foldStyle , customLayout || {});\n}\n","\nimport type { PlotltGraphDataSet } from '../../types';\nimport { nanmean } from \"@/utils/array_operations/array_math\";\n\nfunction normalizeBadValue(v: number | null | undefined): number | null {\n  if (v === null || v === undefined || isNaN(v)) {\n    return null;\n  }\n  return v;\n}\n\nimport { deepMerge } from \"./plotly_styles\";\n\nexport function createErrorBands(data: PlotltGraphDataSet, color: string, datasetName: string, legendGroup: string, options: object = {}) {\n  if (!data.upper || !data.lower) return {lower: null, upper: null, max: 0, min: 0};\n      \n  const upperY: (number | null)[] = [];\n  const lowerY: (number | null)[] = [];\n  let max = 0;\n  let min = 0;\n    \n  data.y.forEach((y, idx) => {\n    if (y === null) {\n      lowerY.push(null);\n      upperY.push(null);\n      return;\n    }\n        \n    if (data.upper === undefined) {\n      upperY.push(null);\n    } else {\n      const high = y + (data.upper[idx] ?? nanmean(data.upper) ?? 0);\n      upperY.push(high);\n      max = Math.max(max, high !== null ? high : 0);\n    }\n        \n    if (data.lower === undefined) {\n      lowerY.push(null);\n    } else {\n      const low = y - (data.lower[idx] ?? nanmean(data.lower) ?? 0);\n      lowerY.push(low);\n      min = Math.min(min, low !== null ? low : 0);\n          \n    }\n        \n        \n  });\n  // console.log({lowerY, upperY});\n  const traceErrorOptions = {\n    x: data.x,\n    mode: \"lines\",\n    line: { width: 0 },\n    showlegend: false,\n    legendgroup: legendGroup,\n    name: datasetName,\n    marker: { color: color ?? 'red' },\n  };\n      \n  return {\n    lower:{\n      y: lowerY.map(normalizeBadValue),\n      ...deepMerge(traceErrorOptions, options),\n    },\n    upper:{\n      y: upperY.map(normalizeBadValue),\n      ...deepMerge(traceErrorOptions, options),\n      fill: \"tonexty\",\n    },\n    max,\n    min\n\n  };\n    \n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { onMounted, ref, watch, nextTick } from \"vue\";\nimport { v4 } from \"uuid\";\nimport Plotly, { PlotlyHTMLElement, newPlot, restyle, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\nimport type { PlotltGraphDataSet } from '../../types';\nimport { createErrorBands } from \"./plotly_graph_elements\";\n\n// https://stackoverflow.com/a/7616484\nexport interface PlotlyGraphProps {\n  datasets: PlotltGraphDataSet[];\n  colors?: string[];\n  showErrors?: boolean;\n  dataOptions?: Partial<Data>[];\n  errorBarStyles?: (Partial<Plotly.ErrorOptions> | null)[];\n  names?: string[];\n  layoutOptions?: Partial<Plotly.Layout>;\n  configOptions?: Partial<Plotly.Config>;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'PlotlyGraph',\n  props: {\n    datasets: {},\n    colors: {},\n    showErrors: { type: Boolean },\n    dataOptions: {},\n    errorBarStyles: {},\n    names: {},\n    layoutOptions: {},\n    configOptions: {}\n  },\n  emits: [\"click\"],\n  setup(__props: any, { emit: __emit }) {\n\n/* slint-disable @typescript-eslint/no-unused-vars */\nconst generateHash = (string) => {\n  let hash = 0;\n  for (const char of string) {\n    hash = (hash << 5) - hash + char.charCodeAt(0);\n    hash |= 0; // Constrain to 32bit integer\n  }\n  return hash;\n};\n\nconst hashDataset = (data: PlotltGraphDataSet) => {\n  const hash = JSON.stringify(data.x) + JSON.stringify(data.y); \n  //JSON.stringify(data.lower) + JSON.stringify(data.upper); // + JSON.stringify(data.errorType);\n  return generateHash(hash).toString();\n};\n\nconst props = __props;\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\n\nconst emit = __emit;\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst traceVisible = ref<Map<string, boolean>>(new Map());\n\n\nconst filterNulls = ref(true);  \nfunction filterNullValues(data: PlotltGraphDataSet): PlotltGraphDataSet {\n  // filter out any place where\n  // data.x or data.y is null or undefined or NaN\n  const filteredX: Datum[] = [];\n  const filteredY: number[] = [];\n  const filteredLower: (number | null)[] = [];\n  const filteredUpper: (number | null)[] = [];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const filteredCustomData: any[] = [];\n  data.x.forEach((x, idx) => {\n    const y = data.y[idx];\n    if (x !== null && x !== undefined && y !== null && y !== undefined && !isNaN(y)) {\n      filteredX.push(x);\n      filteredY.push(y);\n      filteredCustomData.push(data.datasetOptions?.customdata ? data.datasetOptions.customdata[idx] : null);\n      if (data.lower) {\n        filteredLower.push(data.lower[idx] ?? null); // keep length consistent \n      }\n      if (data.upper) {\n        filteredUpper.push(data.upper[idx] ?? null); // keep length consistent \n      }\n    }\n  });\n  const result: PlotltGraphDataSet = {\n    ...data,\n    datasetOptions: {\n      ...data.datasetOptions,\n      customdata: filteredCustomData,\n    },\n    x: filteredX,\n    y: filteredY,\n    name: data.name\n  };\n  if (data.lower) {\n    result.lower = filteredLower;\n  } \n  if (data.upper) {\n    result.upper = filteredUpper;\n  }\n  result.errorType = data.errorType;\n  \n  return result;\n}\n\nfunction renderPlot() {\n\n  errorTraces = [];\n  \n  const plotlyData: Data[] = [];\n  if (props.datasets.length === 0) {\n    console.error(\"No data provided for timeseries graph\");\n    return;\n  }\n  \n\n  let max = 0;\n  \n  props.datasets.forEach((data, index) => {\n    // create a hash from the data.x and data.y to be it's \"id\"\n    data = filterNulls.value ? filterNullValues(data) : data;\n    \n    // check x, and have same length y\n    if (!data.x || !data.y || data.x.length !== data.y.length) {\n      console.error(\"Invalid dataset, skipping\", data);\n      return;\n      // throw new Error(`Invalid dataset: x and y must be non-null and of same length. Lengths: x=${data.x?.length}, y=${data.y?.length}`);\n    }\n    \n    const id = hashDataset(data);\n    \n    max = Math.max(max, Math.max(...data.y.filter((v): v is number => v !== null)));\n\n    const legendGroup = v4();\n    if (!traceVisible.value.has(id)) {\n      traceVisible.value.set(id, true);\n    }\n    legendGroups[id] = legendGroup;\n    \n    \n    const errorOptions = {} as Record<'error_y',Plotly.ErrorBar>;\n    // https://plotly.com/javascript/error-bars/\n    if (props.showErrors && data.errorType === 'bar') {\n      const style = (props.errorBarStyles && props.errorBarStyles[index]) || {};\n      errorOptions['error_y'] = {\n        type: 'data',\n        symmetric: false,\n        array: data.upper as Datum[],\n        arrayminus: data.lower as Datum[] | undefined,\n        color: props.colors ? props.colors[index % props.colors.length] : 'red',\n\n        thickness: 1.5,\n        width: 0,\n        ...style,\n      };\n      \n    }\n    const datasetName = data.name || props.names?.[index] || `Dataset ${index + 1}`;\n    const dataTraceOptions = {\n      mode: \"lines+markers\",\n      legendgroup: legendGroup,\n      showlegend: true,\n      name: datasetName,\n      marker: { color: props.colors ? props.colors[index % props.colors.length] : 'red' },\n      visible: traceVisible.value.get(id) ? true : \"legendonly\",\n      ...errorOptions,\n      ...props.dataOptions?.[index],\n      ...(data.datasetOptions ?? {}), // allow per-dataset options override\n    };\n\n    plotlyData.push({\n      x: data.x,\n      y: data.y,\n      ...dataTraceOptions\n    } as Data);\n    \n    const hasErrors = data.lower && data.upper && data.lower.length === data.y.length && data.upper.length === data.y.length;\n    // double checking to have valid types\n    if (hasErrors && data.lower && data.upper && data.errorType == 'band' && props.showErrors) {\n      \n      const {lower, upper, max: newMax} = createErrorBands(\n        data,\n        props.colors ? props.colors[index % props.colors.length] : 'red',\n        datasetName,\n        legendGroup,\n      );\n\n      max = Math.max(max, newMax);\n\n      if (lower === null || upper === null) {\n        console.error(\"Error creating error bands for dataset\", index, data);\n        return;\n      }\n      \n      const errorBandsVisible = traceVisible.value.get(id) ? true : \"legendonly\";\n      lower['visible'] = errorBandsVisible;\n      upper['visible'] = errorBandsVisible;\n      \n      plotlyData.push(lower);\n      errorTraces.push(plotlyData.length - 1);\n\n      plotlyData.push(upper);\n      errorTraces.push(plotlyData.length - 1);\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const layout: Partial<Plotly.Layout> = {\n    yaxis: {\n      title: { text: \"Molecules / cm<sup>2</sup>\" },\n      range: [0, axisMax],\n    },\n    ...(props.layoutOptions || {}),\n  };\n\n  newPlot(graph.value ?? id, plotlyData, layout, {...props.configOptions}).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", {x: point.x, y: point.y as number, customdata: point.customdata} );\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plotlyData[data.curveNumber];\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (!group) { \n        console.error(\"No legend group for trace\", trace);\n        return true; \n      }\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (!dataId) { \n        console.error(\"Could not find data ID for legend group\", group);\n        return true; \n      }\n      const currentlyVisible = traceVisible.value.get(dataId) ?? true;\n      traceVisible.value.set(dataId, !currentlyVisible);\n      // if currently visible and errors are visible set stlye the error traces too\n      nextTick(() => { // next tick so that updated traceVisible is available\n        if (props.showErrors) {\n          updateErrorDisplay(!currentlyVisible, group);\n        }\n      });\n      return true;\n    });\n  });\n}\n\nfunction updateErrorDisplay(visible: boolean, legendGroup?: string) {\n  if (graph.value) {\n    errorTraces.forEach((traceIndex) => {\n      const trace = plot.value?.data[traceIndex];\n      if (!trace) return;\n      if (!graph.value) return;\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (group === undefined) return;\n      if (legendGroup && group !== legendGroup) return;\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (dataId && traceVisible.value.get(dataId)) {\n        restyle(graph.value, { visible: visible ? true : \"legendonly\" }, [traceIndex]);\n      } \n    });\n  }\n}\n\n\nonMounted(() => {\n  renderPlot();\n});\n\n\nwatch(() => props.showErrors, renderPlot);\n\nwatch(() => props.datasets, (_newData, _oldData) => {\n  console.log(\"Data prop changed, re-rendering plot\");\n  renderPlot();\n}, { deep: true });\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref_key: \"graph\",\n    ref: graph,\n    id: id,\n    class: \"timeseries\"\n  }, null, 512))\n}\n}\n\n})","<!-- eslint-disable @typescript-eslint/no-unused-vars -->\n<template>\n  <div\n    ref=\"graph\"\n    :id=\"id\"\n    class=\"timeseries\"\n  >\n  </div>\n</template>\n\n\n<script setup lang=\"ts\">\n/* slint-disable @typescript-eslint/no-unused-vars */\nimport { onMounted, ref, watch, nextTick } from \"vue\";\nimport { v4 } from \"uuid\";\nimport Plotly, { PlotlyHTMLElement, newPlot, restyle, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\nimport type { PlotltGraphDataSet } from '../../types';\nimport { createErrorBands } from \"./plotly_graph_elements\";\n\n// https://stackoverflow.com/a/7616484\nconst generateHash = (string) => {\n  let hash = 0;\n  for (const char of string) {\n    hash = (hash << 5) - hash + char.charCodeAt(0);\n    hash |= 0; // Constrain to 32bit integer\n  }\n  return hash;\n};\n\nconst hashDataset = (data: PlotltGraphDataSet) => {\n  const hash = JSON.stringify(data.x) + JSON.stringify(data.y); \n  //JSON.stringify(data.lower) + JSON.stringify(data.upper); // + JSON.stringify(data.errorType);\n  return generateHash(hash).toString();\n};\n\nexport interface PlotlyGraphProps {\n  datasets: PlotltGraphDataSet[];\n  colors?: string[];\n  showErrors?: boolean;\n  dataOptions?: Partial<Data>[];\n  errorBarStyles?: (Partial<Plotly.ErrorOptions> | null)[];\n  names?: string[];\n  layoutOptions?: Partial<Plotly.Layout>;\n  configOptions?: Partial<Plotly.Config>;\n}\n\nconst props = defineProps<PlotlyGraphProps>();\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\n\nconst emit = defineEmits<{\n  // Datum is from type of x in DataSet\n  (event: \"click\", value: {x: Datum, y: number, customdata: unknown}): void;\n}>();\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst traceVisible = ref<Map<string, boolean>>(new Map());\n\n\nconst filterNulls = ref(true);  \nfunction filterNullValues(data: PlotltGraphDataSet): PlotltGraphDataSet {\n  // filter out any place where\n  // data.x or data.y is null or undefined or NaN\n  const filteredX: Datum[] = [];\n  const filteredY: number[] = [];\n  const filteredLower: (number | null)[] = [];\n  const filteredUpper: (number | null)[] = [];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const filteredCustomData: any[] = [];\n  data.x.forEach((x, idx) => {\n    const y = data.y[idx];\n    if (x !== null && x !== undefined && y !== null && y !== undefined && !isNaN(y)) {\n      filteredX.push(x);\n      filteredY.push(y);\n      filteredCustomData.push(data.datasetOptions?.customdata ? data.datasetOptions.customdata[idx] : null);\n      if (data.lower) {\n        filteredLower.push(data.lower[idx] ?? null); // keep length consistent \n      }\n      if (data.upper) {\n        filteredUpper.push(data.upper[idx] ?? null); // keep length consistent \n      }\n    }\n  });\n  const result: PlotltGraphDataSet = {\n    ...data,\n    datasetOptions: {\n      ...data.datasetOptions,\n      customdata: filteredCustomData,\n    },\n    x: filteredX,\n    y: filteredY,\n    name: data.name\n  };\n  if (data.lower) {\n    result.lower = filteredLower;\n  } \n  if (data.upper) {\n    result.upper = filteredUpper;\n  }\n  result.errorType = data.errorType;\n  \n  return result;\n}\n\nfunction renderPlot() {\n\n  errorTraces = [];\n  \n  const plotlyData: Data[] = [];\n  if (props.datasets.length === 0) {\n    console.error(\"No data provided for timeseries graph\");\n    return;\n  }\n  \n\n  let max = 0;\n  \n  props.datasets.forEach((data, index) => {\n    // create a hash from the data.x and data.y to be it's \"id\"\n    data = filterNulls.value ? filterNullValues(data) : data;\n    \n    // check x, and have same length y\n    if (!data.x || !data.y || data.x.length !== data.y.length) {\n      console.error(\"Invalid dataset, skipping\", data);\n      return;\n      // throw new Error(`Invalid dataset: x and y must be non-null and of same length. Lengths: x=${data.x?.length}, y=${data.y?.length}`);\n    }\n    \n    const id = hashDataset(data);\n    \n    max = Math.max(max, Math.max(...data.y.filter((v): v is number => v !== null)));\n\n    const legendGroup = v4();\n    if (!traceVisible.value.has(id)) {\n      traceVisible.value.set(id, true);\n    }\n    legendGroups[id] = legendGroup;\n    \n    \n    const errorOptions = {} as Record<'error_y',Plotly.ErrorBar>;\n    // https://plotly.com/javascript/error-bars/\n    if (props.showErrors && data.errorType === 'bar') {\n      const style = (props.errorBarStyles && props.errorBarStyles[index]) || {};\n      errorOptions['error_y'] = {\n        type: 'data',\n        symmetric: false,\n        array: data.upper as Datum[],\n        arrayminus: data.lower as Datum[] | undefined,\n        color: props.colors ? props.colors[index % props.colors.length] : 'red',\n\n        thickness: 1.5,\n        width: 0,\n        ...style,\n      };\n      \n    }\n    const datasetName = data.name || props.names?.[index] || `Dataset ${index + 1}`;\n    const dataTraceOptions = {\n      mode: \"lines+markers\",\n      legendgroup: legendGroup,\n      showlegend: true,\n      name: datasetName,\n      marker: { color: props.colors ? props.colors[index % props.colors.length] : 'red' },\n      visible: traceVisible.value.get(id) ? true : \"legendonly\",\n      ...errorOptions,\n      ...props.dataOptions?.[index],\n      ...(data.datasetOptions ?? {}), // allow per-dataset options override\n    };\n\n    plotlyData.push({\n      x: data.x,\n      y: data.y,\n      ...dataTraceOptions\n    } as Data);\n    \n    const hasErrors = data.lower && data.upper && data.lower.length === data.y.length && data.upper.length === data.y.length;\n    // double checking to have valid types\n    if (hasErrors && data.lower && data.upper && data.errorType == 'band' && props.showErrors) {\n      \n      const {lower, upper, max: newMax} = createErrorBands(\n        data,\n        props.colors ? props.colors[index % props.colors.length] : 'red',\n        datasetName,\n        legendGroup,\n      );\n\n      max = Math.max(max, newMax);\n\n      if (lower === null || upper === null) {\n        console.error(\"Error creating error bands for dataset\", index, data);\n        return;\n      }\n      \n      const errorBandsVisible = traceVisible.value.get(id) ? true : \"legendonly\";\n      lower['visible'] = errorBandsVisible;\n      upper['visible'] = errorBandsVisible;\n      \n      plotlyData.push(lower);\n      errorTraces.push(plotlyData.length - 1);\n\n      plotlyData.push(upper);\n      errorTraces.push(plotlyData.length - 1);\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const layout: Partial<Plotly.Layout> = {\n    yaxis: {\n      title: { text: \"Molecules / cm<sup>2</sup>\" },\n      range: [0, axisMax],\n    },\n    ...(props.layoutOptions || {}),\n  };\n\n  newPlot(graph.value ?? id, plotlyData, layout, {...props.configOptions}).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", {x: point.x, y: point.y as number, customdata: point.customdata} );\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plotlyData[data.curveNumber];\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (!group) { \n        console.error(\"No legend group for trace\", trace);\n        return true; \n      }\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (!dataId) { \n        console.error(\"Could not find data ID for legend group\", group);\n        return true; \n      }\n      const currentlyVisible = traceVisible.value.get(dataId) ?? true;\n      traceVisible.value.set(dataId, !currentlyVisible);\n      // if currently visible and errors are visible set stlye the error traces too\n      nextTick(() => { // next tick so that updated traceVisible is available\n        if (props.showErrors) {\n          updateErrorDisplay(!currentlyVisible, group);\n        }\n      });\n      return true;\n    });\n  });\n}\n\nfunction updateErrorDisplay(visible: boolean, legendGroup?: string) {\n  if (graph.value) {\n    errorTraces.forEach((traceIndex) => {\n      const trace = plot.value?.data[traceIndex];\n      if (!trace) return;\n      if (!graph.value) return;\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (group === undefined) return;\n      if (legendGroup && group !== legendGroup) return;\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (dataId && traceVisible.value.get(dataId)) {\n        restyle(graph.value, { visible: visible ? true : \"legendonly\" }, [traceIndex]);\n      } \n    });\n  }\n}\n\n\nonMounted(() => {\n  renderPlot();\n});\n\n\nwatch(() => props.showErrors, renderPlot);\n\nwatch(() => props.datasets, (_newData, _oldData) => {\n  console.log(\"Data prop changed, re-rendering plot\");\n  renderPlot();\n}, { deep: true });\n\n</script>\n\n<style scoped>\n.js-plotly-plot  {\n  min-width: 30px;\n}\n\n</style>\n","import script from \"./PlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PlotlyGraph.vue?vue&type=style&index=0&id=52443555&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-52443555\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { computed } from 'vue';\nimport PlotlyGraph, { type PlotlyGraphProps } from './plotly/PlotlyGraph.vue';\nimport { mergeFoldTypeLayout } from './plotly/plotly_styles';\nimport type { FoldType } from '../esri/services/aggregation';\nimport type { Datum } from 'plotly.js-dist-min';\nimport { toZonedTime } from 'date-fns-tz';\n\ninterface FoldedPlotlyGraphProps extends PlotlyGraphProps {\n  foldType: FoldType;\n  timezones?: string | string[];\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'FoldedPlotlyGraph',\n  props: {\n    foldType: {},\n    timezones: {},\n    datasets: {},\n    colors: {},\n    showErrors: { type: Boolean },\n    dataOptions: {},\n    errorBarStyles: {},\n    names: {},\n    layoutOptions: {},\n    configOptions: {}\n  },\n  emits: [\"click\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst browserTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\nfunction cloneTimeFromLocalToBrowser(date: Date, timeZone: string): Date {\n  // Get the equivalent time in the target timezone\n  const zonedDate = toZonedTime(date, timeZone);\n  // Create a new date object in the local timezone with the same components\n  return new Date(\n    zonedDate.getFullYear(),\n    zonedDate.getMonth(),\n    zonedDate.getDate(),\n    zonedDate.getHours(),\n    zonedDate.getMinutes(),\n    zonedDate.getSeconds(),\n    zonedDate.getMilliseconds()\n  );\n}\n\nconst props = __props;\n\n// Detailed logging of dataset configuration -- log generated by Sonnet\n// props.datasets.forEach((dataset, index) => {\n//   const style = 'color: #ff0000; font-weight: bold;';\n//   // log the timezones\n//   console.log('%cBrowser Timezone: ' + browserTimeZone, style);\n//   if (props.timezones) {\n//     if (Array.isArray(props.timezones)) {\n//       console.log('%cDataset Timezones: ' + props.timezones.join(', '), style);\n//     } else {\n//       console.log('%cDataset Timezone: ' + props.timezones, style);\n//     }\n//   } else {\n//     console.log('%cNo dataset timezones provided', style);\n//   }\n//   console.log('%c\\n=== Dataset #' + (index + 1) + ' (' + dataset.name + ') ===', style);\n  \n//   console.log('%cBase Data:', style);\n//   console.log('%c  Array Lengths:', style);\n//   console.log('%c    x: ' + dataset.x?.length, style);\n//   console.log('%c    y: ' + dataset.y?.length, style);\n//   console.log('%c  Data Types:', style);\n//   console.log('%c    x: ' + (dataset.x?.[0] instanceof Date ? 'Date' : \n//     Array.isArray(dataset.x?.[0]) ? 'Array' : typeof dataset.x?.[0]), style);\n//   console.log('%c    y: ' + typeof dataset.y?.[0], style);\n//   console.log('%c  Sample Values:', style);\n//   console.log('%c    x: ' + JSON.stringify(dataset.x?.slice(0, 2)), style);\n//   console.log('%c    y: ' + JSON.stringify(dataset.y?.slice(0, 2)), style);\n//   console.log('%c  errorType: ' + (dataset.errorType ?? 'undefined'), style);\n  \n//   console.log('%cDataset Options:', style);\n//   if (dataset.datasetOptions) {\n//     console.log('%c  mode: ' + (dataset.datasetOptions.mode ?? 'undefined'), style);\n//     console.log('%c  hovertemplate: ' + (dataset.datasetOptions.hovertemplate ?? 'undefined'), style);\n    \n//     const customdata = dataset.datasetOptions.customdata;\n//     if (customdata) {\n//       console.log('%c  customdata:', style);\n//       console.log('%c    length: ' + customdata.length, style);\n//       console.log('%c    type: ' + (\n//         customdata[0] instanceof Date ? 'Date' : \n//           Array.isArray(customdata[0]) ? 'Array' : \n//             typeof customdata[0]\n//       ), style);\n//       console.log('%c    sample: ' + JSON.stringify(customdata.slice(0, 2)), style);\n//     } else {\n//       console.log('%c  customdata: undefined', style);\n//     }\n    \n//     // Log any other dataset options\n//     const otherOptions = { ...dataset.datasetOptions };\n//     delete otherOptions.mode;\n//     delete otherOptions.hovertemplate;\n//     delete otherOptions.customdata;\n//     if (Object.keys(otherOptions).length > 0) {\n//       console.log('%c  Other options:', style);\n//       console.log('%c    ' + JSON.stringify(otherOptions, null, 2).replace(/\\\\n/g, '\\n    '), style);\n//     }\n//   } else {\n//     console.log('%c  No dataset options defined', style);\n//   }\n// });\n\nconst rezonedDatasets = computed(() => {\n  // do nothing if the timeseries isn't usind Date object\n  if (props.datasets.length === 0 || !(props.datasets[0].x[0] instanceof Date) || !props.timezones) {\n    return props.datasets;\n  }\n  return props.datasets.map((dataset, index) => {\n    const timezone = Array.isArray(props.timezones) ? props.timezones[index] : props.timezones;\n    const newX = dataset.x.map((x) => {\n      if (x instanceof Date) {\n        return cloneTimeFromLocalToBrowser(x, timezone ?? browserTimeZone);\n      }\n      return x;\n    });\n    return {...dataset, x: newX};\n  });\n});\n\nconst emit = __emit;\n\n// Merge the fold-type specific layout with any custom layout options\nconst mergedLayoutOptions = computed(() => {\n  return mergeFoldTypeLayout(props.foldType, props.layoutOptions);\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(PlotlyGraph, {\n    datasets: rezonedDatasets.value,\n    colors: __props.colors,\n    \"show-errors\": __props.showErrors,\n    \"data-options\": __props.dataOptions,\n    \"error-bar-styles\": __props.errorBarStyles,\n    names: __props.names,\n    \"layout-options\": mergedLayoutOptions.value,\n    \"config-options\": __props.configOptions,\n    onClick: _cache[0] || (_cache[0] = (value) => emit('click', value))\n  }, null, 8, [\"datasets\", \"colors\", \"show-errors\", \"data-options\", \"error-bar-styles\", \"names\", \"layout-options\", \"config-options\"]))\n}\n}\n\n})","<template>\n  <plotly-graph\n    :datasets=\"rezonedDatasets\"\n    :colors=\"colors\"\n    :show-errors=\"showErrors\"\n    :data-options=\"dataOptions\"\n    :error-bar-styles=\"errorBarStyles\"\n    :names=\"names\"\n    :layout-options=\"mergedLayoutOptions\"\n    :config-options=\"configOptions\"\n    @click=\"(value) => emit('click', value)\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue';\nimport PlotlyGraph, { type PlotlyGraphProps } from './plotly/PlotlyGraph.vue';\nimport { mergeFoldTypeLayout } from './plotly/plotly_styles';\nimport type { FoldType } from '../esri/services/aggregation';\nimport type { Datum } from 'plotly.js-dist-min';\nimport { toZonedTime } from 'date-fns-tz';\n\nconst browserTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\nfunction cloneTimeFromLocalToBrowser(date: Date, timeZone: string): Date {\n  // Get the equivalent time in the target timezone\n  const zonedDate = toZonedTime(date, timeZone);\n  // Create a new date object in the local timezone with the same components\n  return new Date(\n    zonedDate.getFullYear(),\n    zonedDate.getMonth(),\n    zonedDate.getDate(),\n    zonedDate.getHours(),\n    zonedDate.getMinutes(),\n    zonedDate.getSeconds(),\n    zonedDate.getMilliseconds()\n  );\n}\n\ninterface FoldedPlotlyGraphProps extends PlotlyGraphProps {\n  foldType: FoldType;\n  timezones?: string | string[];\n}\n\nconst props = defineProps<FoldedPlotlyGraphProps>();\n\n// Detailed logging of dataset configuration -- log generated by Sonnet\n// props.datasets.forEach((dataset, index) => {\n//   const style = 'color: #ff0000; font-weight: bold;';\n//   // log the timezones\n//   console.log('%cBrowser Timezone: ' + browserTimeZone, style);\n//   if (props.timezones) {\n//     if (Array.isArray(props.timezones)) {\n//       console.log('%cDataset Timezones: ' + props.timezones.join(', '), style);\n//     } else {\n//       console.log('%cDataset Timezone: ' + props.timezones, style);\n//     }\n//   } else {\n//     console.log('%cNo dataset timezones provided', style);\n//   }\n//   console.log('%c\\n=== Dataset #' + (index + 1) + ' (' + dataset.name + ') ===', style);\n  \n//   console.log('%cBase Data:', style);\n//   console.log('%c  Array Lengths:', style);\n//   console.log('%c    x: ' + dataset.x?.length, style);\n//   console.log('%c    y: ' + dataset.y?.length, style);\n//   console.log('%c  Data Types:', style);\n//   console.log('%c    x: ' + (dataset.x?.[0] instanceof Date ? 'Date' : \n//     Array.isArray(dataset.x?.[0]) ? 'Array' : typeof dataset.x?.[0]), style);\n//   console.log('%c    y: ' + typeof dataset.y?.[0], style);\n//   console.log('%c  Sample Values:', style);\n//   console.log('%c    x: ' + JSON.stringify(dataset.x?.slice(0, 2)), style);\n//   console.log('%c    y: ' + JSON.stringify(dataset.y?.slice(0, 2)), style);\n//   console.log('%c  errorType: ' + (dataset.errorType ?? 'undefined'), style);\n  \n//   console.log('%cDataset Options:', style);\n//   if (dataset.datasetOptions) {\n//     console.log('%c  mode: ' + (dataset.datasetOptions.mode ?? 'undefined'), style);\n//     console.log('%c  hovertemplate: ' + (dataset.datasetOptions.hovertemplate ?? 'undefined'), style);\n    \n//     const customdata = dataset.datasetOptions.customdata;\n//     if (customdata) {\n//       console.log('%c  customdata:', style);\n//       console.log('%c    length: ' + customdata.length, style);\n//       console.log('%c    type: ' + (\n//         customdata[0] instanceof Date ? 'Date' : \n//           Array.isArray(customdata[0]) ? 'Array' : \n//             typeof customdata[0]\n//       ), style);\n//       console.log('%c    sample: ' + JSON.stringify(customdata.slice(0, 2)), style);\n//     } else {\n//       console.log('%c  customdata: undefined', style);\n//     }\n    \n//     // Log any other dataset options\n//     const otherOptions = { ...dataset.datasetOptions };\n//     delete otherOptions.mode;\n//     delete otherOptions.hovertemplate;\n//     delete otherOptions.customdata;\n//     if (Object.keys(otherOptions).length > 0) {\n//       console.log('%c  Other options:', style);\n//       console.log('%c    ' + JSON.stringify(otherOptions, null, 2).replace(/\\\\n/g, '\\n    '), style);\n//     }\n//   } else {\n//     console.log('%c  No dataset options defined', style);\n//   }\n// });\n\nconst rezonedDatasets = computed(() => {\n  // do nothing if the timeseries isn't usind Date object\n  if (props.datasets.length === 0 || !(props.datasets[0].x[0] instanceof Date) || !props.timezones) {\n    return props.datasets;\n  }\n  return props.datasets.map((dataset, index) => {\n    const timezone = Array.isArray(props.timezones) ? props.timezones[index] : props.timezones;\n    const newX = dataset.x.map((x) => {\n      if (x instanceof Date) {\n        return cloneTimeFromLocalToBrowser(x, timezone ?? browserTimeZone);\n      }\n      return x;\n    });\n    return {...dataset, x: newX};\n  });\n});\n\nconst emit = defineEmits<{\n  (event: \"click\", value: {x: Datum, y: number, customdata: unknown}): void;\n}>();\n\n// Merge the fold-type specific layout with any custom layout options\nconst mergedLayoutOptions = computed(() => {\n  return mergeFoldTypeLayout(props.foldType, props.layoutOptions);\n});\n</script>\n\n<style scoped>\n</style>\n","import script from \"./FoldedPlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FoldedPlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","export type TimeBinOptions = 'hour' | 'day' | 'week' | 'month';\nexport type FoldingPeriodOptions = 'day' | 'week' | 'month' | 'year' | 'weekdayWeekend' | 'none';\n\n\n\nconst validFoldingPeriodsForTimeBin: Record<TimeBinOptions, FoldingPeriodOptions[]> = {\n  'hour': ['day', 'week', 'month', 'year', 'weekdayWeekend', 'none'],\n  'day': ['week', 'month', 'year', 'weekdayWeekend', 'none'],\n  'week': ['month', 'year', 'none'],\n  'month': ['year', 'none'],\n};\n\n\nconst validTimeBinsForFoldingPeriod: Record<FoldingPeriodOptions, (keyof typeof validFoldingPeriodsForTimeBin)[]> = {\n  'day': ['hour'],\n  'week': ['hour', 'day'],\n  'month': ['hour', 'day', 'week'],\n  'year': ['hour', 'day', 'week', 'month'],\n  'weekdayWeekend': ['hour', 'day'],\n  'none': ['hour', 'day', 'week', 'month'],\n};\n\n\nexport function getValidFoldingPeriods(timeBin: TimeBinOptions): FoldingPeriodOptions[] {\n  return validFoldingPeriodsForTimeBin[timeBin] || [];\n}\n\n\nexport function getValidTimeBins(foldingPeriod: FoldingPeriodOptions): TimeBinOptions[] {\n  return validTimeBinsForFoldingPeriod[foldingPeriod] || [];\n}\n\nexport function isValidCombination(timeBin: TimeBinOptions, foldingPeriod: FoldingPeriodOptions): boolean {\n  return validTimeBinsForFoldingPeriod[foldingPeriod]?.includes(timeBin) ?? false;\n}\n\nexport function getFirstValidTimeBin(foldingPeriod: FoldingPeriodOptions): TimeBinOptions {\n  const validTimeBins = validTimeBinsForFoldingPeriod[foldingPeriod];\n  return validTimeBins[0];\n}\n\nexport function getFirstValidFoldingPeriod(timeBin: TimeBinOptions): FoldingPeriodOptions {\n  const validFoldingPeriods = validFoldingPeriodsForTimeBin[timeBin];\n  return validFoldingPeriods[0];\n}","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock, createCommentVNode as _createCommentVNode, unref as _unref } from \"vue\"\n\nconst _hoisted_1 = { class: \"explainer-text\" }\nconst _hoisted_2 = { key: 0 }\nconst _hoisted_3 = { key: 1 }\nconst _hoisted_4 = { key: 2 }\nconst _hoisted_5 = { key: 3 }\nconst _hoisted_6 = { class: \"selected-timezone-details d-flex mb-4\" }\nconst _hoisted_7 = { class: \"d-flex flex-row flex-wrap\" }\nconst _hoisted_8 = { class: \"text-caption\" }\nconst _hoisted_9 = { key: 0 }\nconst _hoisted_10 = { class: \"d-flex ga-2\" }\nconst _hoisted_11 = { style: {\"height\":\"calc(100% - 40px)\"} }\nconst _hoisted_12 = {\n  id: \"below-graph-stuff\",\n  class: \"mt-2 explainer-text\"\n}\nconst _hoisted_13 = {\n  key: 0,\n  id: \"aggregation-warning\"\n}\n\nimport { ref, computed, watch, nextTick } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from 'uuid';\nimport { TimeSeriesFolder, sortfoldBinContent } from '../esri/services/aggregation';\nimport FoldedPlotlyGraph from './FoldedPlotlyGraph.vue';\nimport type { Prettify, UserDataset, PlotltGraphDataSet, UnifiedRegion } from '../types';\nimport type { AggregationMethod, TimeSeriesData, FoldedTimeSeriesData , FoldType, FoldBinContent} from '../esri/services/aggregation';\nimport tz_lookup from '@photostructure/tz-lookup';\nimport { toZonedTime, fromZonedTime } from 'date-fns-tz';\nimport { useTempoStore } from '@/stores/app';\nimport {\n  TimeBinOptions,\n  FoldingPeriodOptions,\n  isValidCombination,\n  getFirstValidTimeBin\n} from '@/utils/foldingValidation';\n\ninterface DataFoldingProps {\n  selection: UserDataset | null;\n}\n\nconst MS_IN_HOUR = 3600000;\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DataFoldingAndBinning',\n  props: /*@__PURE__*/_mergeModels({\n    selection: {}\n  }, {\n    \"modelValue\": { type: Boolean, ...{ type: Boolean, required: true } },\n    \"modelModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"save\"], [\"update:modelValue\"]),\n  setup(__props: any, { emit: __emit }) {\n\n// eslint-disable @typescript-eslint/no-unused-vars */\nconst store = useTempoStore();\nconst {\n  debugMode,\n} = storeToRefs(store);\n\nconst props = __props;\n\nconst emit = __emit;\n\n// Dialog state\nconst dialogOpen = _useModel<boolean>(__props, 'modelValue');\n\nconst theColor = computed(() => {\n  return props.selection?.customColor ?? (props.selection?.region.color ?? 'blue');\n});\n\n\nconst MS_IN_DAY = MS_IN_HOUR * 24;\nconst MS_IN_WEEK = MS_IN_DAY * 7;\nconst MS_IN_MONTH = MS_IN_DAY * 28; // to avoid invalidating February\nconst MS_IN_YEAR = MS_IN_DAY * 365.25;\n\nconst timeBinDurations: Record<TimeBinOptions, number> = {\n  'hour': MS_IN_HOUR,\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month': MS_IN_MONTH, \n};\n\nconst foldingPeriodDurations: Record<FoldingPeriodOptions, number> = {\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month' : MS_IN_MONTH,\n  'year': MS_IN_YEAR,\n  'weekdayWeekend': MS_IN_WEEK, // weekend is part of week\n  'none': 0,\n};\n\nconst dataDuration = computed(() => {\n  if (!props.selection?.samples) return 0;\n  const timestamps = Object.values(props.selection.samples).map(s => s.date.getTime());\n  if (timestamps.length === 0) return 0;\n  // single loop to find min and max on unsorted array\n  // (but it may already be sorted, but we only need to do this once so it's fine)\n  const minMax = timestamps.reduce((acc, t) => {\n    return {\n      min: Math.min(acc.min, t),\n      max: Math.max(acc.max, t)\n    };\n  }, { min: Infinity, max: -Infinity });\n  return minMax.max - minMax.min;\n});\n\nfunction validTimeBinForData(timeBin: TimeBinOptions): boolean {\n  if (dataDuration.value === 0) return false;\n\n  return dataDuration.value >= timeBinDurations[timeBin];\n}\n\nfunction validFoldingForData(foldType: FoldingPeriodOptions): boolean {\n  if (dataDuration.value === 0) return false;\n  if (foldType === 'weekdayWeekend') {\n    return (props.selection?.samples && Object.values(props.selection?.samples).map(s => s.date.getDay()).some(d => d === 0 || d === 6)) as boolean; // has at least one weekend day\n  }\n  return dataDuration.value >= foldingPeriodDurations[foldType];\n}\n\nconst aggregationWarning = ref('');\n\n\n// Time bin and folding period options\nconst timeBinOptions: {title: string, value: TimeBinOptions}[] = [\n  { title: 'Hour', value: 'hour' },\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' }\n];\n\nconst allFoldingPeriodOptions: {title: string, value: FoldingPeriodOptions}[] = [\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' },\n  { title: 'Year', value: 'year' },\n  { title: 'Weekend/Weekday', value: 'weekdayWeekend' },\n  { title: 'None (Simple Binning)', value: 'none' },\n];\n\n\n\n// Computed property to filter valid folding periods based on selected time bin\nconst foldingPeriodOptions = computed(() => {\n  return allFoldingPeriodOptions;\n});\n\n\nconst methodOptions = [\n  { title: 'Mean', value: 'mean' },\n  { title: 'Median', value: 'median' },\n  { title: 'Min', value: 'min' },\n  { title: 'Max', value: 'max' }\n];\n\nconst timezoneOptions = [\n  { title: 'US/Eastern', value: 'US/Eastern' },\n  { title: 'US/Central', value: 'US/Central' },\n  { title: 'US/Mountain', value: 'US/Mountain' },\n  { title: 'US/Arizona', value: 'US/Arizona' },\n  { title: 'US/Pacific', value: 'US/Pacific' },\n  { title: 'UTC', value: 'UTC' }\n];\n\n// Reactive state\nconst selectedTimeBin = ref<TimeBinOptions>('hour');\nconst selectedFoldingPeriod = ref<FoldingPeriodOptions>('none');\nconst selectedMethod = ref<AggregationMethod>('mean');\nconst selectedTimezone = ref('US/Eastern');\nconst showErrors = ref(true);\nconst useSEM = ref(true);\nconst useErrorBars = ref(false);\n\nwatch(selectedFoldingPeriod, (newPeriod) => {\n  if (!isValidCombination(selectedTimeBin.value, newPeriod)) {\n    // Set to first valid option\n    const validTimeBin = getFirstValidTimeBin(newPeriod);\n    if (validTimeBin && validTimeBinForData(validTimeBin)) {\n      selectedTimeBin.value = validTimeBin;\n    } else {\n      selectedTimeBin.value = 'hour'; // default fallback\n    }\n  }\n});\n\n// Computed FoldType based on time bin and folding period selections\nconst selectedFoldType = computed<FoldType>(() => {\n  // Map the combination to the appropriate FoldType\n  const timeBin = selectedTimeBin.value;\n  const period = selectedFoldingPeriod.value;\n    \n  const foldType = `${timeBin}Of${period.charAt(0).toUpperCase()}${period.slice(1)}` as FoldType;\n  console.log('Computed FoldType:', foldType, 'from', timeBin, 'and', period);\n  return foldType;\n});\n\n\n\n\n// Check if we're using a None-period fold type (no actual folding)\nconst isNonePeriod = computed(() => {\n  return selectedFoldingPeriod.value === 'none';\n});\n\n// Check if we're using any hour-based fold type (which is always centered)\nconst isHourBinned = computed(() => {\n  return selectedTimeBin.value === 'hour';\n});\n\nconst includeBinPhase = ref(true);\n// const alignToBinCenter = ref(true);\nconst alignToBinCenter = computed(() => {\n  if (isNonePeriod.value) return true;\n  if (selectedFoldingPeriod.value === 'weekdayWeekend') return false;\n  if (includeBinPhase.value === false) return false;\n  if (isHourBinned.value) return true;\n  if (selectedTimeBin.value === 'week' && selectedFoldingPeriod.value === 'year') return false;\n  return true;\n});\n\nconst alignDataToBinCenters = computed({\n  get() {\n    return !includeBinPhase.value;\n  },\n  set(value: boolean) {\n    includeBinPhase.value = !value;\n  }\n});\n\n\nconst disableBinCenterCheckbox = computed(() => {\n  return !isNonePeriod.value && includeBinPhase.value && !isHourBinned.value;\n});\n\nconst disableIncludePhaseCheckbox = computed(() => {\n  return !isNonePeriod.value;\n});\n\n// Watch to ensure selected folding period is valid when time bin changes\nwatch(selectedTimeBin, () => {\n  const validPeriods = foldingPeriodOptions.value.map(opt => opt.value);\n  if (!validPeriods.includes(selectedFoldingPeriod.value)) {\n    // Set to first valid option\n    if (validPeriods.length > 0) {\n      selectedFoldingPeriod.value = validPeriods[0];\n    }\n  }\n});\n\n// Watch for None-period types and reset incompatible options\nwatch(isNonePeriod, (isNone) => {\n  if (isNone) {\n    includeBinPhase.value = true;\n    // alignToBinCenter.value = true;\n  }\n});\n\nconst regionCenter = computed(() => {\n  const region = props.selection?.region as UnifiedRegion;\n  \n  if (region && region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  }\n  \n  if (region && region.geometryType === 'rectangle') {\n    const { xmin, ymin, xmax, ymax } = region.geometryInfo;\n    return { lat: (ymin + ymax) / 2, lon: (xmin + xmax) / 2 };\n  }\n  \n  return { lat: 0, lon: 0 };\n});\n\n\n\nconst useTzCenter = ref(true);\nconst tzCenter = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n\nif (regionCenter.value.lat !== 0 || regionCenter.value.lon !== 0) {\n  const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n  if (tz && useTzCenter.value) {\n    selectedTimezone.value = tz;\n  }\n}\n\nwatch(useTzCenter, (newVal) => {\n  if (newVal && regionCenter.value.lat !== 0 && regionCenter.value.lon !== 0) {\n    const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n    if (tz) {\n      selectedTimezone.value = tz;\n    }\n  }\n});\n\n// Computed properties\nconst originalDataPointCount = computed(() => {\n  if (!props.selection?.samples) return 0;\n  return Object.keys(props.selection.samples).length;\n});\n\nconst foldedDataPointCount = computed(() => {\n  if (!foldedData.value) return 0;\n  return Object.keys(foldedData.value.values).length;\n});\n\nconst canSave = computed(() => {\n  return !!(props.selection && foldedData.value && foldedDataPointCount.value > 0);\n});\n\nconst foldedDatasetName = computed(() => {\n  if (!props.selection?.name) return 'Folded Data';\n  return `Folded ${props.selection.name ?? props.selection.region.name}`;// (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}, ${selectedMethod.value})`;\n});\n\n// Aggregated data\nconst foldedData = ref<FoldedTimeSeriesData | null>(null);\nconst foldedSelection = ref<null>(null);\n// Graph data for display - now a ref that gets manually updated\nconst graphData = ref<PlotltGraphDataSet[]>([]);\n\nwatch(foldedData, (newvValue) => {\n  // if there is only one bin present the user with an aggregation warning\n  if (newvValue && newvValue.bins && Object.keys(newvValue.bins).length <= 1) {\n    aggregationWarning.value = (\"Warning: This combination of time bin and folding period results \" +\n      \"in only one bin. Please select a smaller time bin \" + \n      \"or a different folding period if available. In most cases, it is recommend to select 'None' for the folding period.\");\n  } else {\n    aggregationWarning.value = '';\n  }\n});\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction timeseriesToDataSet(timeseries: TimeSeriesData): Omit<PlotltGraphDataSet, 'name'> {\n  const x: PlotltGraphDataSet['x'] = [];\n  const y: PlotltGraphDataSet['y'] = [];\n  const lower: PlotltGraphDataSet['lower'] = [];\n  const upper: PlotltGraphDataSet['upper'] = [];\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(timeseries.values).sort(([tsa, _a], [tsb, _b]) => parseInt(tsa) - parseInt(tsb));\n  // get the first timestamp\n  sortedEntries.forEach(([timestamp, aggValue]) => {\n    y.push(aggValue.value);\n    x.push(new Date(parseInt(timestamp)));\n    const error = timeseries.errors[timestamp];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper };\n}\n\nfunction foldedTimesSeriesToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotltGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([binIndex, _binContent]) => {\n    const idx = parseInt(binIndex);\n    const aggValue = foldedTimeSeries.values[idx];\n    \n    // Use date if available (for None-period types), otherwise use bin index\n    if (isNonePeriod && aggValue.date) {\n      // For None-period types with dates, center bins by adding half the bin width\n      if (alignToBinCenter.value) {\n        const date = new Date(aggValue.date);\n        switch (foldedTimeSeries.foldType) {\n        case 'hourOfNone':\n          date.setMinutes(30); // Center of hour\n          break;\n        case 'dayOfNone':\n          date.setHours(date.getHours() + 12); // local Noon\n          break;\n        case 'weekOfNone':\n          date.setDate(date.getDate() + 3); // Middle of week (approx)\n          date.setHours(date.getHours() + 12);\n          break;\n        case 'monthOfNone':\n          date.setDate(15); // Middle of month (approx)\n          break;\n        }\n        x.push(date);\n      } else {\n        x.push(aggValue.date);\n      }\n    } else {\n      if (foldedTimeSeries.foldType !== 'hourOfDay') {\n        x.push(idx + (alignToBinCenter.value ? 0.5 : 0));\n      } else {\n        x.push(idx);\n      }\n    }\n    \n    y.push(aggValue.value);\n    const error = foldedTimeSeries.errors[idx];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper, errorType: useErrorBars.value ? 'bar' : 'band' };\n}\n  \nfunction foldedTimeSeriesRawToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotltGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n  const customdata: Date[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([_binIndex, binContent]) => {\n    const sortedBinContent = sortfoldBinContent(binContent);\n    const bins = sortedBinContent as Prettify<FoldBinContent>;\n    \n    bins.rawValues.forEach((rv, index) => {\n      if (isNonePeriod) {\n        // For None-period types, use the actual timestamp\n        x.push(new Date(bins.timestamps[index]));\n      } else {\n        // For regular fold types, use bin index with optional phase\n        x.push(bins.bin + (includeBinPhase.value ? bins.binPhase[index] : 0));\n      }\n      customdata.push(toZonedTime(new Date(bins.timestamps[index]), selectedTimezone.value));\n      y.push(rv);\n    });\n    bins.lowers.forEach(low => {\n      lower.push(low ?? null);\n    });\n    bins.uppers.forEach(up => {\n      upper.push(up ?? null);\n    });\n  });\n  // the ascii +- symbol is this characher: \n  const hovertemplate = '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>';\n  \n  return { x, y, lower, upper, errorType: 'bar', datasetOptions: { customdata, hovertemplate } };\n}\n\n// Function to update graph data\nfunction updateGraphData() {\n  console.log(\"Updating graph data\");\n  if (!props.selection) {\n    graphData.value = [];\n    return;\n  }\n  \n  // const data = [timeseriesToDataSet(selectionToTimeseries(props.selection))]; // Original data\n  const data: PlotltGraphDataSet[] = [];\n  \n  if (foldedData.value) {\n    const t = foldedTimeSeriesRawToDataSet(foldedData.value); // Raw folded data\n    (t as PlotltGraphDataSet).name = props.selection.name || 'Original Data';\n    data.push(t as PlotltGraphDataSet); // Raw folded data\n    const f = foldedTimesSeriesToDataSet(foldedData.value); // Summary folded data\n    (f as PlotltGraphDataSet).name = foldedDatasetName.value;\n    data.push(f as PlotltGraphDataSet); // Summary folded data\n  }\n  console.log(\"Prepared graph data:\", data);\n  graphData.value = data;\n  console.log(\"Graph data updated with\", data.length, \"datasets\");\n}\n\n// Create a time range for the folded data\nfunction createFoldedTimeRange() {\n  if (!props.selection) {\n    throw new Error('No selection available');\n  }\n  \n  const originalRange = props.selection.timeRange.range;\n  const ranges = Array.isArray(originalRange) ? originalRange : [originalRange];\n  \n  return {\n    id: v4(),\n    name: `Folded (${selectedTimeBin.value} of ${selectedFoldingPeriod.value})`,\n    description: `Folded data (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}) ${selectedMethod.value}`,\n    range: ranges,\n    type: 'folded'\n  };\n}\n\n\n// Only recalculate when data-affecting parameters change\nwatch([selectedTimeBin, selectedFoldingPeriod, selectedMethod, selectedTimezone, useSEM], \n  updateAggregatedData, { immediate: true });\n\n// Handle display-only changes separately\nwatch([useErrorBars, alignToBinCenter, includeBinPhase], updateGraphData);\n\nfunction selectionToTimeseries(selection: UserDataset): TimeSeriesData {\n  return {\n    values: selection.samples || {},\n    errors: selection.errors || {},\n    locations: selection.locations || [],\n    geometryType: selection.region.geometryType || 'rectangle'\n  };\n}\n\n// Update folded data when parameters change\nfunction updateAggregatedData() {\n  console.log(\"Updating folded data with time bin:\", selectedTimeBin.value, \"folding period:\", selectedFoldingPeriod.value, \"fold type:\", selectedFoldType.value, \"method:\", selectedMethod.value, \"timezone:\", selectedTimezone.value);\n  if (!props.selection?.samples) {\n    foldedData.value = null;\n    return;\n  }\n  \n  try {\n    \n    // Convert the selection data to TimeSeriesData format\n    const timeSeriesData = selectionToTimeseries(props.selection);\n    \n    \n    const grouper = new TimeSeriesFolder(\n      selectedFoldType.value,  // Use the computed fold type\n      selectedTimezone.value, \n      selectedMethod.value, \n      useSEM.value ? 'sem' : 'std', true);\n    foldedData.value = grouper.foldData(timeSeriesData);\n    \n  } catch (error) {\n    console.error('Error aggregating data:', error);\n    foldedData.value = null;\n    foldedSelection.value = null;\n  }\n  \n  // Update graph data after folding\n  updateGraphData();\n  console.log(\"graphData after update:\", graphData.value);\n}\n\nfunction handlePointClick(value: {x: Plotly.Datum, y: number, customdata: unknown}) {\n  console.log(\"Point clicked:\", value);\n  console.log(\"Custom data Date:\", value.customdata ? value.customdata as Date: value.customdata);\n  // the from timezoned time is what we want to to send work with if we go back to esri stuff\n  console.log(\"fromZonedTime\", value.customdata ? fromZonedTime(value.customdata as Date, selectedTimezone.value) : value.customdata);\n  return;\n}\n\n// Save the folding\nfunction saveFolding() {\n  \n  if (!canSave.value || !props.selection || !foldedData.value) return;\n  \n  // const rawDataset = foldedTimeSeriesRawToDataSet(foldedData.value);\n  // (rawDataset as PlotltGraphDataSet).name = props.selection.name || 'Original Data';\n  // const summaryDataset = foldedTimesSeriesToDataSet(foldedData.value);\n  // (summaryDataset as PlotltGraphDataSet).name = foldedDatasetName.value;\n\n  const foldedSelection: UserDataset = {\n    id: v4(),\n    region: { ...props.selection.region, name: props.selection.region.name } as typeof props.selection.region,\n    timeRange: createFoldedTimeRange(),\n    molecule: props.selection.molecule,\n    customColor: '#333',\n    loading: false, // folded data is immediately available\n    // samples/errors intentionally omitted for folded since bins are synthetic; rely on plotlyDatasets\n    locations: foldedData.value.locations,\n    name: foldedDatasetName.value,\n    folded: {\n      timeBin: selectedTimeBin.value,\n      foldingPeriod: selectedFoldingPeriod.value,\n      foldType: selectedFoldType.value,\n      method: selectedMethod.value,\n      timezone: selectedTimezone.value,\n      useSEM: useSEM.value,\n      includeBinPhase: includeBinPhase.value,\n      alignToBinCenter: alignToBinCenter.value,\n      useErrorBars: useErrorBars.value,\n      raw: foldedData.value\n    },\n    plotlyDatasets: [\n      {\n        ...graphData.value[0],\n        datasetOptions: {\n          ...graphData.value[0].datasetOptions,\n          mode: 'markers',\n          // hovertemplate: '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>'\n        }\n      } as PlotltGraphDataSet,\n      {\n        ...graphData.value[1],\n        datasetOptions: {\n          mode: 'lines+markers'\n        }\n      } as PlotltGraphDataSet\n    ]\n  };\n  console.log(foldedSelection);\n  emit('save', foldedSelection);\n\n  closeDialog();\n}\n\n// Close dialog\nfunction closeDialog() {\n  dialogOpen.value = false;\n  // Reset state\n  nextTick(() => {\n    foldedData.value = null;\n  });\n}\n\n// Watch for selection changes\nwatch(() => props.selection, () => {\n  if (props.selection) {\n    updateAggregatedData();\n  }\n}, { immediate: true });\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_info_button = _resolveComponent(\"info-button\")!\n  const _component_v_chip = _resolveComponent(\"v-chip\")!\n  const _component_v_chip_group = _resolveComponent(\"v-chip-group\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_select = _resolveComponent(\"v-select\")!\n  const _component_v_card_subtitle = _resolveComponent(\"v-card-subtitle\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_col = _resolveComponent(\"v-col\")!\n  const _component_v_card_title = _resolveComponent(\"v-card-title\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_row = _resolveComponent(\"v-row\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, { id: \"data-aggregation-card\" }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_toolbar, {\n        density: \"compact\",\n        color: \"var(--info-background)\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_toolbar_title, null, {\n            default: _withCtx(() => [...(_cache[10] || (_cache[10] = [\n              _createTextVNode(\"Data Aggregation\", -1)\n            ]))]),\n            _: 1\n          }),\n          _createVNode(_component_v_spacer),\n          _createVNode(_component_v_btn, {\n            icon: \"mdi-close\",\n            onClick: closeDialog\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_v_card_text, { class: \"pa-4\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_col, {\n                cols: \"12\",\n                md: \"4\"\n              }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_card, {\n                    variant: \"outlined\",\n                    class: \"pa-3\"\n                  }, {\n                    default: _withCtx(() => [\n                      _createElementVNode(\"h3\", null, [\n                        _cache[12] || (_cache[12] = _createTextVNode(\" Folding Period \", -1)),\n                        _createVNode(_component_info_button, null, {\n                          default: _withCtx(() => [...(_cache[11] || (_cache[11] = [\n                            _createElementVNode(\"div\", { class: \"explainer-text\" }, [\n                              _createElementVNode(\"div\", null, \" Greyed out options are options which are either not able to applied to the current dataset (due to insufficient data), or which are incompatible with other selected options. \"),\n                              _createElementVNode(\"hr\"),\n                              _createElementVNode(\"strong\", { class: \"text-red\" }, \"FIX\"),\n                              _createTextVNode(\" We \\\"fold\\\" data, by stacking data re-aligning data based on a periodic cycle. For example, if we fold by \\\"Week\\\", then Select the period over which to fold the data. Selecting \\\"None\\\" will simply bin the data without folding. \")\n                            ], -1)\n                          ]))]),\n                          _: 1\n                        })\n                      ]),\n                      _createVNode(_component_v_chip_group, {\n                        modelValue: selectedFoldingPeriod.value,\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((selectedFoldingPeriod).value = $event)),\n                        column: \"\",\n                        class: \"mb-3\"\n                      }, {\n                        default: _withCtx(() => [\n                          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(foldingPeriodOptions.value, (option) => {\n                            return (_openBlock(), _createBlock(_component_v_chip, {\n                              key: option.value,\n                              value: option.value,\n                              color: \"#092088\",\n                              variant: option.value === selectedFoldingPeriod.value ? 'flat' : 'outlined',\n                              outline: \"\",\n                              density: \"compact\",\n                              disabled: !validFoldingForData(option.value as FoldingPeriodOptions)\n                            }, {\n                              default: _withCtx(() => [\n                                _createTextVNode(_toDisplayString(option.title), 1)\n                              ]),\n                              _: 2\n                            }, 1032, [\"value\", \"variant\", \"disabled\"]))\n                          }), 128))\n                        ]),\n                        _: 1\n                      }, 8, [\"modelValue\"]),\n                      _createElementVNode(\"h3\", null, [\n                        _cache[20] || (_cache[20] = _createTextVNode(\"Time Bin \", -1)),\n                        _createVNode(_component_info_button, null, {\n                          default: _withCtx(() => [\n                            _createElementVNode(\"div\", _hoisted_1, [\n                              _cache[17] || (_cache[17] = _createElementVNode(\"strong\", { class: \"text-red\" }, \"FIX\", -1)),\n                              _cache[18] || (_cache[18] = _createTextVNode(\" Select the time bin for which we will aggregate the data. When aggregating data, we take all of the data in a bin (say the 1pm bin) and computed a single (aggregated) value for it, such as a mean or a max value. \", -1)),\n                              _cache[19] || (_cache[19] = _createElementVNode(\"hr\", null, null, -1)),\n                              _createElementVNode(\"div\", null, [\n                                (selectedTimeBin.value === 'hour')\n                                  ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[13] || (_cache[13] = [\n                                      _createElementVNode(\"dt\", null, \"Hour\", -1),\n                                      _createElementVNode(\"dd\", null, \" Rounds data to the nearest hour. For example: Date from 12:30pm to 1:29pm will go into the 1pm bin. The binned point, shown in black is placed on the hour (e.g. at 1:00pm). \", -1)\n                                    ]))]))\n                                  : (selectedTimeBin.value === 'day')\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [...(_cache[14] || (_cache[14] = [\n                                        _createElementVNode(\"dt\", null, \"Day\", -1),\n                                        _createElementVNode(\"dd\", null, \"Bins all data within a date. For example, all data points occuring on Dec 5 2025, or on Aug 28 2024, etc. The binned point, shown in black is placed at local noon (12:00pm) of that day. \", -1)\n                                      ]))]))\n                                    : (selectedTimeBin.value === 'week')\n                                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [...(_cache[15] || (_cache[15] = [\n                                          _createElementVNode(\"dt\", null, \"Week\", -1),\n                                          _createElementVNode(\"dd\", null, \" Rounds data to the nearest week. Weeks start on Sunday. For example: Date from Sunday 12:00am to Saturday 11:59pm will go into the week bin. The binned point, shown in black is placed at local noon (12:00pm) on Wednesday of that week. \", -1)\n                                        ]))]))\n                                      : (selectedTimeBin.value === 'month')\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[16] || (_cache[16] = [\n                                            _createElementVNode(\"dt\", null, \"Month\", -1),\n                                            _createElementVNode(\"dd\", null, \" Rounds data to the nearest month. For example: Date from the 1st of the month 12:00am to the last day of the month 11:59pm will go into the month bin. The binned point, shown in black is placed at local noon (12:00pm) on the 15th of that month. \", -1)\n                                          ]))]))\n                                        : _createCommentVNode(\"\", true)\n                              ])\n                            ])\n                          ]),\n                          _: 1\n                        })\n                      ]),\n                      _createVNode(_component_v_chip_group, {\n                        modelValue: selectedTimeBin.value,\n                        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((selectedTimeBin).value = $event)),\n                        column: \"\",\n                        class: \"mb-3\"\n                      }, {\n                        default: _withCtx(() => [\n                          (_openBlock(), _createElementBlock(_Fragment, null, _renderList(timeBinOptions, (option) => {\n                            return _createVNode(_component_v_chip, {\n                              key: option.value,\n                              value: option.value,\n                              color: \"#092088\",\n                              variant: option.value === selectedTimeBin.value ? 'flat' : 'outlined',\n                              density: \"compact\",\n                              disabled: !validTimeBinForData(option.value as TimeBinOptions) || !_unref(isValidCombination)(option.value as TimeBinOptions, selectedFoldingPeriod.value)\n                            }, {\n                              default: _withCtx(() => [\n                                _createTextVNode(_toDisplayString(option.title), 1)\n                              ]),\n                              _: 2\n                            }, 1032, [\"value\", \"variant\", \"disabled\"])\n                          }), 64))\n                        ]),\n                        _: 1\n                      }, 8, [\"modelValue\"]),\n                      _createElementVNode(\"div\", _hoisted_6, [\n                        _createVNode(_component_v_checkbox, {\n                          modelValue: useTzCenter.value,\n                          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((useTzCenter).value = $event)),\n                          label: `Use timezone of region center: ${_unref(tzCenter)}`,\n                          density: \"compact\",\n                          \"hide-details\": \"\",\n                          class: \"mb-1\"\n                        }, null, 8, [\"modelValue\", \"label\"])\n                      ]),\n                      (!useTzCenter.value)\n                        ? (_openBlock(), _createBlock(_component_v_select, {\n                            key: 0,\n                            modelValue: selectedTimezone.value,\n                            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((selectedTimezone).value = $event)),\n                            items: timezoneOptions,\n                            label: \"Timezone\",\n                            density: \"compact\",\n                            variant: \"outlined\",\n                            \"hide-details\": \"\",\n                            class: \"mb-3\"\n                          }, null, 8, [\"modelValue\"]))\n                        : _createCommentVNode(\"\", true),\n                      _createVNode(_component_v_select, {\n                        modelValue: selectedMethod.value,\n                        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((selectedMethod).value = $event)),\n                        items: methodOptions,\n                        label: \"Aggregation Method\",\n                        density: \"compact\",\n                        variant: \"outlined\",\n                        \"hide-details\": \"\",\n                        class: \"mb-3\"\n                      }, null, 8, [\"modelValue\"]),\n                      _createElementVNode(\"div\", _hoisted_7, [\n                        _createVNode(_component_v_checkbox, {\n                          modelValue: showErrors.value,\n                          \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((showErrors).value = $event)),\n                          label: \"Show Errors\",\n                          density: \"compact\",\n                          disabled: selectedMethod.value == 'min' || selectedMethod.value == 'max',\n                          \"hide-details\": \"\",\n                          class: \"mb-3\"\n                        }, null, 8, [\"modelValue\", \"disabled\"]),\n                        _createVNode(_component_v_checkbox, {\n                          modelValue: useErrorBars.value,\n                          \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => ((useErrorBars).value = $event)),\n                          label: \"Use Error Bars\",\n                          density: \"compact\",\n                          \"hide-details\": \"\",\n                          class: \"mb-3\"\n                        }, null, 8, [\"modelValue\"]),\n                        _createVNode(_component_v_checkbox, {\n                          modelValue: useSEM.value,\n                          \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((useSEM).value = $event)),\n                          label: \"Use Standard Error of the Mean\",\n                          density: \"compact\",\n                          \"hide-details\": \"\",\n                          class: \"mb-3\"\n                        }, null, 8, [\"modelValue\"]),\n                        _createVNode(_component_v_checkbox, {\n                          modelValue: alignDataToBinCenters.value,\n                          \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((alignDataToBinCenters).value = $event)),\n                          label: \"Align Data to bins\",\n                          density: \"compact\",\n                          disabled: !disableIncludePhaseCheckbox.value,\n                          \"hide-details\": \"\",\n                          class: \"mb-3\"\n                        }, null, 8, [\"modelValue\", \"disabled\"]),\n                        false\n                          ? (_openBlock(), _createBlock(_component_v_checkbox, {\n                              key: 0,\n                              modelValue: alignToBinCenter.value,\n                              \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((alignToBinCenter).value = $event)),\n                              label: \"Center bins\",\n                              density: \"compact\",\n                              disabled: !disableBinCenterCheckbox.value,\n                              \"hide-details\": \"\",\n                              class: \"mb-3\"\n                            }, null, 8, [\"modelValue\", \"disabled\"]))\n                          : _createCommentVNode(\"\", true)\n                      ]),\n                      (_unref(debugMode))\n                        ? (_openBlock(), _createBlock(_component_v_card, {\n                            key: 1,\n                            height: \"fit-content\",\n                            variant: \"tonal\",\n                            class: \"pa-2 mb-3\"\n                          }, {\n                            default: _withCtx(() => [\n                              _createVNode(_component_v_card_subtitle, { class: \"pa-0\" }, {\n                                default: _withCtx(() => [...(_cache[21] || (_cache[21] = [\n                                  _createTextVNode(\"Preview\", -1)\n                                ]))]),\n                                _: 1\n                              }),\n                              _createElementVNode(\"div\", _hoisted_8, [\n                                _createElementVNode(\"div\", null, \"Original points: \" + _toDisplayString(originalDataPointCount.value), 1),\n                                _createElementVNode(\"div\", null, \"Aggregated points: \" + _toDisplayString(foldedDataPointCount.value), 1),\n                                _createElementVNode(\"div\", null, \"Time Bin: \" + _toDisplayString(selectedTimeBin.value), 1),\n                                _createElementVNode(\"div\", null, \"Folding Period: \" + _toDisplayString(selectedFoldingPeriod.value), 1),\n                                _createElementVNode(\"div\", null, \"Fold Type: \" + _toDisplayString(selectedFoldType.value), 1),\n                                _createElementVNode(\"div\", null, \"First bin: \" + _toDisplayString(foldedData.value && foldedData.value.bins ? Object.keys(foldedData.value.bins)[0] : 'N/A'), 1),\n                                (foldedData.value && foldedData.value.bins && foldedData.value.bins[Object.keys(foldedData.value.bins)[0]] && foldedData.value.values[Object.keys(foldedData.value.bins)[0]] && foldedData.value.values[Object.keys(foldedData.value.bins)[0]].date)\n                                  ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \" First bin time: \"))\n                                  : _createCommentVNode(\"\", true)\n                              ])\n                            ]),\n                            _: 1\n                          }))\n                        : _createCommentVNode(\"\", true),\n                      _createElementVNode(\"div\", _hoisted_10, [\n                        _createVNode(_component_v_btn, {\n                          color: \"primary\",\n                          onClick: saveFolding,\n                          disabled: !canSave.value,\n                          size: \"small\"\n                        }, {\n                          default: _withCtx(() => [...(_cache[22] || (_cache[22] = [\n                            _createTextVNode(\" Save Folding \", -1)\n                          ]))]),\n                          _: 1\n                        }, 8, [\"disabled\"]),\n                        _createVNode(_component_v_btn, {\n                          color: \"secondary\",\n                          variant: \"outlined\",\n                          onClick: closeDialog,\n                          size: \"small\"\n                        }, {\n                          default: _withCtx(() => [...(_cache[23] || (_cache[23] = [\n                            _createTextVNode(\" Cancel \", -1)\n                          ]))]),\n                          _: 1\n                        })\n                      ])\n                    ]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_v_col, {\n                cols: \"12\",\n                md: \"8\"\n              }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_card, {\n                    variant: \"outlined\",\n                    class: \"pa-3\",\n                    style: {\"height\":\"auto\"}\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_v_card_title, null, {\n                        default: _withCtx(() => [...(_cache[24] || (_cache[24] = [\n                          _createTextVNode(\" Time Series Comparison \", -1)\n                        ]))]),\n                        _: 1\n                      }),\n                      _createElementVNode(\"div\", _hoisted_11, [\n                        _createVNode(FoldedPlotlyGraph, {\n                          datasets: graphData.value,\n                          \"show-errors\": showErrors.value,\n                          \"fold-type\": selectedFoldType.value,\n                          colors: [theColor.value, '#333'],\n                          timezones: selectedTimezone.value,\n                          \"data-options\": [\n                    {mode: 'markers'}, // options for the original data\n                    {mode: 'lines+markers'} // options for the folded data\n                    ],\n                          \"error-bar-styles\": [\n                    {'thickness': 1, 'width': 0}, // original data error bar style\n                    { 'thickness': 3, 'width': 0 } // folded data error bar style\n                  ],\n                          \"config-options\": {responsive: true, modeBarButtonsToRemove: ['sendDataToCloud','lasso2d', 'resetScale2d', ]},\n                          onClick: handlePointClick,\n                          \"layout-options\": {legend: {y:1.15, orientation:'h',bordercolor: '#ccc', borderwidth:1}}\n                        }, null, 8, [\"datasets\", \"show-errors\", \"fold-type\", \"colors\", \"timezones\"])\n                      ]),\n                      _createElementVNode(\"div\", _hoisted_12, [\n                        (aggregationWarning.value)\n                          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, _toDisplayString(aggregationWarning.value), 1))\n                          : _createCommentVNode(\"\", true),\n                        _cache[26] || (_cache[26] = _createTextVNode(\" If you don't see any data, please press the \\\"Autoscale\\\" \", -1)),\n                        _createVNode(_component_v_icon, {\n                          size: \"1.2em\",\n                          style: {\"margin-top\":\"-0.1em\"}\n                        }, {\n                          default: _withCtx(() => [...(_cache[25] || (_cache[25] = [\n                            _createTextVNode(\"mdi-arrow-expand-all\", -1)\n                          ]))]),\n                          _: 1\n                        }),\n                        _cache[27] || (_cache[27] = _createTextVNode(\" button on the graph menu (visible when you hover over the graph), or try clicking the legend items to show/hide overlapping data. \", -1))\n                      ])\n                    ]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n  <!-- <v-dialog\n    v-model=\"dialogOpen\"\n    max-width=\"90vw\"\n    max-height=\"90vh\"\n    persistent\n    scrollable\n  > -->\n    <v-card id=\"data-aggregation-card\">\n      <v-toolbar\n        density=\"compact\"\n        color=\"var(--info-background)\"\n      >\n        <v-toolbar-title>Data Aggregation</v-toolbar-title>\n        <v-spacer></v-spacer>\n        <v-btn\n          icon=\"mdi-close\"\n          @click=\"closeDialog\"\n        ></v-btn>\n      </v-toolbar>\n      \n      <v-card-text class=\"pa-4\">\n        <v-row>\n          <!-- Left Panel: Folding Options -->\n          <v-col cols=\"12\" md=\"4\">\n            <v-card variant=\"outlined\" class=\"pa-3\">\n              \n              \n              <!-- Folding Period Selection -->\n              <h3>\n                Folding Period\n                <info-button>\n              <div class=\"explainer-text\">\n                <div >\n                Greyed out options are options which are either not able to applied to the current dataset (due to insufficient data), or \n                which are incompatible with other selected options. \n              </div>\n              <hr/>\n                <strong class=\"text-red\">FIX</strong>\n                We \"fold\" data, by stacking data re-aligning data based on a periodic cycle. For example, if we fold by \"Week\", then\n                \n                Select the period over which to fold the data. Selecting \"None\" will simply bin the data without folding.\n              </div>\n              </info-button>\n              </h3>\n              <v-chip-group\n                v-model=\"selectedFoldingPeriod\"\n                column\n                class=\"mb-3\"\n              >\n                <v-chip\n                  v-for=\"option in foldingPeriodOptions\"\n                  :key=\"option.value\"\n                  :value=\"option.value\"\n                  color=\"#092088\"\n                  :variant=\"option.value === selectedFoldingPeriod ? 'flat' : 'outlined'\"\n                  outline\n                  density=\"compact\"\n                  :disabled=\"!validFoldingForData(option.value as FoldingPeriodOptions)\"\n                >\n                  {{ option.title }}\n                </v-chip>\n              </v-chip-group> \n              \n              \n              \n              \n              <!-- Time Bin Selection -->\n              <!-- use chips for select -->\n              <h3>Time Bin\n                <info-button>\n              <div class=\"explainer-text\">\n                <strong class=\"text-red\">FIX</strong>\n                Select the time bin for which we will aggregate the data. \n                When aggregating data, we take all of the data in a bin (say the 1pm bin) and\n                computed a single (aggregated) value for it, such as a mean or a max value.\n                <hr/>\n                <div>\n                  <div v-if=\"selectedTimeBin === 'hour'\">\n                    <dt>Hour</dt>\n                    <dd>\n                      Rounds data to the nearest hour. For example: Date from 12:30pm to 1:29pm will go into the 1pm bin.\n                      The binned point, shown in black is placed on the hour (e.g. at 1:00pm).\n                    </dd>\n                  </div>\n                  <div v-else-if=\"selectedTimeBin === 'day'\">\n                    <dt>Day</dt>\n                    <dd>Bins all data within a date. For example, all data points occuring on Dec 5 2025, or on Aug 28 2024, etc.\n                      The binned point, shown in black is placed at local noon (12:00pm) of that day.\n                    </dd>\n                  </div>\n                  <div v-else-if=\"selectedTimeBin === 'week'\">\n                    <dt>Week</dt>\n                    <dd>\n                      Rounds data to the nearest week. Weeks start on Sunday. For example: Date from Sunday 12:00am to Saturday 11:59pm will go into the week bin.\n                      The binned point, shown in black is placed at local noon (12:00pm) on Wednesday of that week.\n                    </dd>\n                  </div>\n                  <div v-else-if=\"selectedTimeBin === 'month'\">\n                    <dt>Month</dt>\n                    <dd>\n                      Rounds data to the nearest month. \n                      For example: Date from the 1st of the month 12:00am to the last day of the month 11:59pm will go into the month bin.\n                      The binned point, shown in black is placed at local noon (12:00pm) on the 15th of that month.\n                    </dd>\n                  </div>\n                </div>\n                \n              </div>\n            </info-button>\n              </h3>\n              <v-chip-group\n                v-model=\"selectedTimeBin\"\n                column\n                class=\"mb-3\"\n              >\n                <v-chip\n                  v-for=\"option in timeBinOptions\"\n                  :key=\"option.value\"\n                  :value=\"option.value\"\n                  color=\"#092088\"\n                  :variant=\"option.value === selectedTimeBin ? 'flat' : 'outlined'\"    \n                  density=\"compact\"\n                  :disabled=\"!validTimeBinForData(option.value as TimeBinOptions) || !isValidCombination(option.value as TimeBinOptions, selectedFoldingPeriod)\"\n                >\n                  {{ option.title }}\n                </v-chip>\n              </v-chip-group> \n              \n              \n              \n\n              \n              \n              <!-- Timezone Selection -->\n              <div class=\"selected-timezone-details d-flex mb-4\">\n                  <v-checkbox\n                    v-model=\"useTzCenter\"\n                    :label=\"`Use timezone of region center: ${tzCenter}`\"\n                    density=\"compact\"\n                    hide-details\n                    class=\"mb-1\"\n                  />\n                </div>\n              <v-select\n                v-if=\"!useTzCenter\"\n                v-model=\"selectedTimezone\"\n                :items=\"timezoneOptions\"\n                label=\"Timezone\"\n                density=\"compact\"\n                variant=\"outlined\"\n                hide-details\n                class=\"mb-3\"\n              />\n              \n              <!-- Folding Method -->\n              <v-select\n                v-model=\"selectedMethod\"\n                :items=\"methodOptions\"\n                label=\"Aggregation Method\"\n                density=\"compact\"\n                variant=\"outlined\"\n                hide-details\n                class=\"mb-3\"\n              />\n              \n              <!-- Show Errors Toggle -->\n              <div class=\"d-flex flex-row flex-wrap\">\n              <v-checkbox\n                v-model=\"showErrors\"\n                label=\"Show Errors\"\n                density=\"compact\"\n                :disabled=\"selectedMethod == 'min' || selectedMethod == 'max'\"\n                hide-details\n                class=\"mb-3\"\n              />\n              \n              <v-checkbox\n                v-model=\"useErrorBars\"\n                label=\"Use Error Bars\"\n                density=\"compact\"\n                hide-details\n                class=\"mb-3\"\n              />\n              \n              <!-- Show Errors Toggle -->\n              <v-checkbox\n                v-model=\"useSEM\"\n                label=\"Use Standard Error of the Mean\"\n                density=\"compact\"\n                hide-details\n                class=\"mb-3\"\n              />\n              \n              <v-checkbox\n                v-model=\"alignDataToBinCenters\"\n                label=\"Align Data to bins\"\n                density=\"compact\"\n                :disabled=\"!disableIncludePhaseCheckbox\"\n                hide-details\n                class=\"mb-3\"\n              />\n              \n              <v-checkbox\n                v-if=\"false\"\n                v-model=\"alignToBinCenter\"\n                label=\"Center bins\"\n                density=\"compact\"\n                :disabled=\"!disableBinCenterCheckbox\"\n                hide-details\n                class=\"mb-3\"\n              />\n              </div>\n              <!-- Preview Info -->\n              <v-card v-if=\"debugMode\" height=\"fit-content\" variant=\"tonal\" class=\"pa-2 mb-3\">\n                <v-card-subtitle class=\"pa-0\">Preview</v-card-subtitle>\n                <div class=\"text-caption\">\n                  <div>Original points: {{ originalDataPointCount }}</div>\n                  <div>Aggregated points: {{ foldedDataPointCount }}</div>\n                  <div>Time Bin: {{ selectedTimeBin }}</div>\n                  <div>Folding Period: {{ selectedFoldingPeriod }}</div>\n                  <div>Fold Type: {{ selectedFoldType }}</div>\n                  <div>First bin: {{ foldedData && foldedData.bins ? Object.keys(foldedData.bins)[0] : 'N/A' }}</div>\n                  <!-- show first bins time in the local timezone if it's a date using toZonedTime -->\n                  <div v-if=\"foldedData && foldedData.bins && foldedData.bins[Object.keys(foldedData.bins)[0]] && foldedData.values[Object.keys(foldedData.bins)[0]] && foldedData.values[Object.keys(foldedData.bins)[0]].date\">\n                    First bin time: \n                    </div>\n                </div>\n              </v-card>\n              \n              <!-- Action Buttons -->\n              <div class=\"d-flex ga-2\">\n                <v-btn\n                  color=\"primary\"\n                  @click=\"saveFolding\"\n                  :disabled=\"!canSave\"\n                  size=\"small\"\n                >\n                  Save Folding\n                </v-btn>\n                <v-btn\n                  color=\"secondary\"\n                  variant=\"outlined\"\n                  @click=\"closeDialog\"\n                  size=\"small\"\n                >\n                  Cancel\n                </v-btn>\n              </div>\n            </v-card>\n          </v-col>\n          \n          <!-- Right Panel: Timeseries Graph -->\n          <v-col cols=\"12\" md=\"8\">\n            <v-card variant=\"outlined\" class=\"pa-3\" style=\"height: auto;\">\n              <v-card-title>\n                Time Series Comparison\n              </v-card-title>\n              <div style=\"height: calc(100% - 40px);\">\n                <folded-plotly-graph\n                  :datasets=\"graphData\"\n                  :show-errors=\"showErrors\"\n                  :fold-type=\"selectedFoldType\"\n                  :colors=\"[theColor, '#333']\"\n                  :timezones=\"selectedTimezone\"\n                  :data-options=\"[\n                    {mode: 'markers'}, // options for the original data\n                    {mode: 'lines+markers'} // options for the folded data\n                    ]\"\n                  :error-bar-styles=\"[\n                    {'thickness': 1, 'width': 0}, // original data error bar style\n                    { 'thickness': 3, 'width': 0 } // folded data error bar style\n                  ]\"\n                  :config-options=\"{responsive: true, modeBarButtonsToRemove: ['sendDataToCloud','lasso2d', 'resetScale2d', ]}\"\n                  @click=\"handlePointClick\"\n                  :layout-options=\"{legend: {y:1.15, orientation:'h',bordercolor: '#ccc', borderwidth:1}}\"\n                />\n              </div>\n            <div id=\"below-graph-stuff\" class=\"mt-2 explainer-text\">\n              <div v-if=\"aggregationWarning\" id=\"aggregation-warning\">\n                {{ aggregationWarning }}\n              </div>\n              If you don't see any data, please press the \"Autoscale\" \n              <v-icon size=\"1.2em\" style=\"margin-top:-0.1em;\">mdi-arrow-expand-all</v-icon> \n              button on the graph menu (visible when you hover over the graph), or try clicking the \n              legend items to show/hide overlapping data. \n            </div>\n            </v-card>\n          </v-col>\n        </v-row>\n      </v-card-text>\n    </v-card>\n  <!-- </v-dialog> -->\n</template>\n\n<script setup lang=\"ts\">\n// eslint-disable @typescript-eslint/no-unused-vars */\nimport { ref, computed, watch, nextTick } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from 'uuid';\nimport { TimeSeriesFolder, sortfoldBinContent } from '../esri/services/aggregation';\nimport FoldedPlotlyGraph from './FoldedPlotlyGraph.vue';\nimport type { Prettify, UserDataset, PlotltGraphDataSet, UnifiedRegion } from '../types';\nimport type { AggregationMethod, TimeSeriesData, FoldedTimeSeriesData , FoldType, FoldBinContent} from '../esri/services/aggregation';\nimport tz_lookup from '@photostructure/tz-lookup';\nimport { toZonedTime, fromZonedTime } from 'date-fns-tz';\nimport { useTempoStore } from '@/stores/app';\nconst store = useTempoStore();\nconst {\n  debugMode,\n} = storeToRefs(store);\n\nimport {\n  TimeBinOptions,\n  FoldingPeriodOptions,\n  isValidCombination,\n  getFirstValidTimeBin\n} from '@/utils/foldingValidation';\n\ninterface DataFoldingProps {\n  selection: UserDataset | null;\n}\n\nconst props = defineProps<DataFoldingProps>();\n\nconst emit = defineEmits<{\n  (event: 'save', foldedSelection: UserDataset): void;\n}>();\n\n// Dialog state\nconst dialogOpen = defineModel<boolean>('modelValue', { type: Boolean, required: true });\n\nconst theColor = computed(() => {\n  return props.selection?.customColor ?? (props.selection?.region.color ?? 'blue');\n});\n\n\nconst MS_IN_HOUR = 3600000;\nconst MS_IN_DAY = MS_IN_HOUR * 24;\nconst MS_IN_WEEK = MS_IN_DAY * 7;\nconst MS_IN_MONTH = MS_IN_DAY * 28; // to avoid invalidating February\nconst MS_IN_YEAR = MS_IN_DAY * 365.25;\n\nconst timeBinDurations: Record<TimeBinOptions, number> = {\n  'hour': MS_IN_HOUR,\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month': MS_IN_MONTH, \n};\n\nconst foldingPeriodDurations: Record<FoldingPeriodOptions, number> = {\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month' : MS_IN_MONTH,\n  'year': MS_IN_YEAR,\n  'weekdayWeekend': MS_IN_WEEK, // weekend is part of week\n  'none': 0,\n};\n\nconst dataDuration = computed(() => {\n  if (!props.selection?.samples) return 0;\n  const timestamps = Object.values(props.selection.samples).map(s => s.date.getTime());\n  if (timestamps.length === 0) return 0;\n  // single loop to find min and max on unsorted array\n  // (but it may already be sorted, but we only need to do this once so it's fine)\n  const minMax = timestamps.reduce((acc, t) => {\n    return {\n      min: Math.min(acc.min, t),\n      max: Math.max(acc.max, t)\n    };\n  }, { min: Infinity, max: -Infinity });\n  return minMax.max - minMax.min;\n});\n\nfunction validTimeBinForData(timeBin: TimeBinOptions): boolean {\n  if (dataDuration.value === 0) return false;\n\n  return dataDuration.value >= timeBinDurations[timeBin];\n}\n\nfunction validFoldingForData(foldType: FoldingPeriodOptions): boolean {\n  if (dataDuration.value === 0) return false;\n  if (foldType === 'weekdayWeekend') {\n    return (props.selection?.samples && Object.values(props.selection?.samples).map(s => s.date.getDay()).some(d => d === 0 || d === 6)) as boolean; // has at least one weekend day\n  }\n  return dataDuration.value >= foldingPeriodDurations[foldType];\n}\n\nconst aggregationWarning = ref('');\n\n\n// Time bin and folding period options\nconst timeBinOptions: {title: string, value: TimeBinOptions}[] = [\n  { title: 'Hour', value: 'hour' },\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' }\n];\n\nconst allFoldingPeriodOptions: {title: string, value: FoldingPeriodOptions}[] = [\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' },\n  { title: 'Year', value: 'year' },\n  { title: 'Weekend/Weekday', value: 'weekdayWeekend' },\n  { title: 'None (Simple Binning)', value: 'none' },\n];\n\n\n\n// Computed property to filter valid folding periods based on selected time bin\nconst foldingPeriodOptions = computed(() => {\n  return allFoldingPeriodOptions;\n});\n\n\nconst methodOptions = [\n  { title: 'Mean', value: 'mean' },\n  { title: 'Median', value: 'median' },\n  { title: 'Min', value: 'min' },\n  { title: 'Max', value: 'max' }\n];\n\nconst timezoneOptions = [\n  { title: 'US/Eastern', value: 'US/Eastern' },\n  { title: 'US/Central', value: 'US/Central' },\n  { title: 'US/Mountain', value: 'US/Mountain' },\n  { title: 'US/Arizona', value: 'US/Arizona' },\n  { title: 'US/Pacific', value: 'US/Pacific' },\n  { title: 'UTC', value: 'UTC' }\n];\n\n// Reactive state\nconst selectedTimeBin = ref<TimeBinOptions>('hour');\nconst selectedFoldingPeriod = ref<FoldingPeriodOptions>('none');\nconst selectedMethod = ref<AggregationMethod>('mean');\nconst selectedTimezone = ref('US/Eastern');\nconst showErrors = ref(true);\nconst useSEM = ref(true);\nconst useErrorBars = ref(false);\n\nwatch(selectedFoldingPeriod, (newPeriod) => {\n  if (!isValidCombination(selectedTimeBin.value, newPeriod)) {\n    // Set to first valid option\n    const validTimeBin = getFirstValidTimeBin(newPeriod);\n    if (validTimeBin && validTimeBinForData(validTimeBin)) {\n      selectedTimeBin.value = validTimeBin;\n    } else {\n      selectedTimeBin.value = 'hour'; // default fallback\n    }\n  }\n});\n\n// Computed FoldType based on time bin and folding period selections\nconst selectedFoldType = computed<FoldType>(() => {\n  // Map the combination to the appropriate FoldType\n  const timeBin = selectedTimeBin.value;\n  const period = selectedFoldingPeriod.value;\n    \n  const foldType = `${timeBin}Of${period.charAt(0).toUpperCase()}${period.slice(1)}` as FoldType;\n  console.log('Computed FoldType:', foldType, 'from', timeBin, 'and', period);\n  return foldType;\n});\n\n\n\n\n// Check if we're using a None-period fold type (no actual folding)\nconst isNonePeriod = computed(() => {\n  return selectedFoldingPeriod.value === 'none';\n});\n\n// Check if we're using any hour-based fold type (which is always centered)\nconst isHourBinned = computed(() => {\n  return selectedTimeBin.value === 'hour';\n});\n\nconst includeBinPhase = ref(true);\n// const alignToBinCenter = ref(true);\nconst alignToBinCenter = computed(() => {\n  if (isNonePeriod.value) return true;\n  if (selectedFoldingPeriod.value === 'weekdayWeekend') return false;\n  if (includeBinPhase.value === false) return false;\n  if (isHourBinned.value) return true;\n  if (selectedTimeBin.value === 'week' && selectedFoldingPeriod.value === 'year') return false;\n  return true;\n});\n\nconst alignDataToBinCenters = computed({\n  get() {\n    return !includeBinPhase.value;\n  },\n  set(value: boolean) {\n    includeBinPhase.value = !value;\n  }\n});\n\n\nconst disableBinCenterCheckbox = computed(() => {\n  return !isNonePeriod.value && includeBinPhase.value && !isHourBinned.value;\n});\n\nconst disableIncludePhaseCheckbox = computed(() => {\n  return !isNonePeriod.value;\n});\n\n// Watch to ensure selected folding period is valid when time bin changes\nwatch(selectedTimeBin, () => {\n  const validPeriods = foldingPeriodOptions.value.map(opt => opt.value);\n  if (!validPeriods.includes(selectedFoldingPeriod.value)) {\n    // Set to first valid option\n    if (validPeriods.length > 0) {\n      selectedFoldingPeriod.value = validPeriods[0];\n    }\n  }\n});\n\n// Watch for None-period types and reset incompatible options\nwatch(isNonePeriod, (isNone) => {\n  if (isNone) {\n    includeBinPhase.value = true;\n    // alignToBinCenter.value = true;\n  }\n});\n\nconst regionCenter = computed(() => {\n  const region = props.selection?.region as UnifiedRegion;\n  \n  if (region && region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  }\n  \n  if (region && region.geometryType === 'rectangle') {\n    const { xmin, ymin, xmax, ymax } = region.geometryInfo;\n    return { lat: (ymin + ymax) / 2, lon: (xmin + xmax) / 2 };\n  }\n  \n  return { lat: 0, lon: 0 };\n});\n\n\n\nconst useTzCenter = ref(true);\nconst tzCenter = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n\nif (regionCenter.value.lat !== 0 || regionCenter.value.lon !== 0) {\n  const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n  if (tz && useTzCenter.value) {\n    selectedTimezone.value = tz;\n  }\n}\n\nwatch(useTzCenter, (newVal) => {\n  if (newVal && regionCenter.value.lat !== 0 && regionCenter.value.lon !== 0) {\n    const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n    if (tz) {\n      selectedTimezone.value = tz;\n    }\n  }\n});\n\n// Computed properties\nconst originalDataPointCount = computed(() => {\n  if (!props.selection?.samples) return 0;\n  return Object.keys(props.selection.samples).length;\n});\n\nconst foldedDataPointCount = computed(() => {\n  if (!foldedData.value) return 0;\n  return Object.keys(foldedData.value.values).length;\n});\n\nconst canSave = computed(() => {\n  return !!(props.selection && foldedData.value && foldedDataPointCount.value > 0);\n});\n\nconst foldedDatasetName = computed(() => {\n  if (!props.selection?.name) return 'Folded Data';\n  return `Folded ${props.selection.name ?? props.selection.region.name}`;// (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}, ${selectedMethod.value})`;\n});\n\n// Aggregated data\nconst foldedData = ref<FoldedTimeSeriesData | null>(null);\nconst foldedSelection = ref<null>(null);\n// Graph data for display - now a ref that gets manually updated\nconst graphData = ref<PlotltGraphDataSet[]>([]);\n\nwatch(foldedData, (newvValue) => {\n  // if there is only one bin present the user with an aggregation warning\n  if (newvValue && newvValue.bins && Object.keys(newvValue.bins).length <= 1) {\n    aggregationWarning.value = (\"Warning: This combination of time bin and folding period results \" +\n      \"in only one bin. Please select a smaller time bin \" + \n      \"or a different folding period if available. In most cases, it is recommend to select 'None' for the folding period.\");\n  } else {\n    aggregationWarning.value = '';\n  }\n});\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction timeseriesToDataSet(timeseries: TimeSeriesData): Omit<PlotltGraphDataSet, 'name'> {\n  const x: PlotltGraphDataSet['x'] = [];\n  const y: PlotltGraphDataSet['y'] = [];\n  const lower: PlotltGraphDataSet['lower'] = [];\n  const upper: PlotltGraphDataSet['upper'] = [];\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(timeseries.values).sort(([tsa, _a], [tsb, _b]) => parseInt(tsa) - parseInt(tsb));\n  // get the first timestamp\n  sortedEntries.forEach(([timestamp, aggValue]) => {\n    y.push(aggValue.value);\n    x.push(new Date(parseInt(timestamp)));\n    const error = timeseries.errors[timestamp];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper };\n}\n\nfunction foldedTimesSeriesToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotltGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([binIndex, _binContent]) => {\n    const idx = parseInt(binIndex);\n    const aggValue = foldedTimeSeries.values[idx];\n    \n    // Use date if available (for None-period types), otherwise use bin index\n    if (isNonePeriod && aggValue.date) {\n      // For None-period types with dates, center bins by adding half the bin width\n      if (alignToBinCenter.value) {\n        const date = new Date(aggValue.date);\n        switch (foldedTimeSeries.foldType) {\n        case 'hourOfNone':\n          date.setMinutes(30); // Center of hour\n          break;\n        case 'dayOfNone':\n          date.setHours(date.getHours() + 12); // local Noon\n          break;\n        case 'weekOfNone':\n          date.setDate(date.getDate() + 3); // Middle of week (approx)\n          date.setHours(date.getHours() + 12);\n          break;\n        case 'monthOfNone':\n          date.setDate(15); // Middle of month (approx)\n          break;\n        }\n        x.push(date);\n      } else {\n        x.push(aggValue.date);\n      }\n    } else {\n      if (foldedTimeSeries.foldType !== 'hourOfDay') {\n        x.push(idx + (alignToBinCenter.value ? 0.5 : 0));\n      } else {\n        x.push(idx);\n      }\n    }\n    \n    y.push(aggValue.value);\n    const error = foldedTimeSeries.errors[idx];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper, errorType: useErrorBars.value ? 'bar' : 'band' };\n}\n  \nfunction foldedTimeSeriesRawToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotltGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n  const customdata: Date[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([_binIndex, binContent]) => {\n    const sortedBinContent = sortfoldBinContent(binContent);\n    const bins = sortedBinContent as Prettify<FoldBinContent>;\n    \n    bins.rawValues.forEach((rv, index) => {\n      if (isNonePeriod) {\n        // For None-period types, use the actual timestamp\n        x.push(new Date(bins.timestamps[index]));\n      } else {\n        // For regular fold types, use bin index with optional phase\n        x.push(bins.bin + (includeBinPhase.value ? bins.binPhase[index] : 0));\n      }\n      customdata.push(toZonedTime(new Date(bins.timestamps[index]), selectedTimezone.value));\n      y.push(rv);\n    });\n    bins.lowers.forEach(low => {\n      lower.push(low ?? null);\n    });\n    bins.uppers.forEach(up => {\n      upper.push(up ?? null);\n    });\n  });\n  // the ascii +- symbol is this characher: \n  const hovertemplate = '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>';\n  \n  return { x, y, lower, upper, errorType: 'bar', datasetOptions: { customdata, hovertemplate } };\n}\n\n// Function to update graph data\nfunction updateGraphData() {\n  console.log(\"Updating graph data\");\n  if (!props.selection) {\n    graphData.value = [];\n    return;\n  }\n  \n  // const data = [timeseriesToDataSet(selectionToTimeseries(props.selection))]; // Original data\n  const data: PlotltGraphDataSet[] = [];\n  \n  if (foldedData.value) {\n    const t = foldedTimeSeriesRawToDataSet(foldedData.value); // Raw folded data\n    (t as PlotltGraphDataSet).name = props.selection.name || 'Original Data';\n    data.push(t as PlotltGraphDataSet); // Raw folded data\n    const f = foldedTimesSeriesToDataSet(foldedData.value); // Summary folded data\n    (f as PlotltGraphDataSet).name = foldedDatasetName.value;\n    data.push(f as PlotltGraphDataSet); // Summary folded data\n  }\n  console.log(\"Prepared graph data:\", data);\n  graphData.value = data;\n  console.log(\"Graph data updated with\", data.length, \"datasets\");\n}\n\n// Create a time range for the folded data\nfunction createFoldedTimeRange() {\n  if (!props.selection) {\n    throw new Error('No selection available');\n  }\n  \n  const originalRange = props.selection.timeRange.range;\n  const ranges = Array.isArray(originalRange) ? originalRange : [originalRange];\n  \n  return {\n    id: v4(),\n    name: `Folded (${selectedTimeBin.value} of ${selectedFoldingPeriod.value})`,\n    description: `Folded data (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}) ${selectedMethod.value}`,\n    range: ranges,\n    type: 'folded'\n  };\n}\n\n\n// Only recalculate when data-affecting parameters change\nwatch([selectedTimeBin, selectedFoldingPeriod, selectedMethod, selectedTimezone, useSEM], \n  updateAggregatedData, { immediate: true });\n\n// Handle display-only changes separately\nwatch([useErrorBars, alignToBinCenter, includeBinPhase], updateGraphData);\n\nfunction selectionToTimeseries(selection: UserDataset): TimeSeriesData {\n  return {\n    values: selection.samples || {},\n    errors: selection.errors || {},\n    locations: selection.locations || [],\n    geometryType: selection.region.geometryType || 'rectangle'\n  };\n}\n\n// Update folded data when parameters change\nfunction updateAggregatedData() {\n  console.log(\"Updating folded data with time bin:\", selectedTimeBin.value, \"folding period:\", selectedFoldingPeriod.value, \"fold type:\", selectedFoldType.value, \"method:\", selectedMethod.value, \"timezone:\", selectedTimezone.value);\n  if (!props.selection?.samples) {\n    foldedData.value = null;\n    return;\n  }\n  \n  try {\n    \n    // Convert the selection data to TimeSeriesData format\n    const timeSeriesData = selectionToTimeseries(props.selection);\n    \n    \n    const grouper = new TimeSeriesFolder(\n      selectedFoldType.value,  // Use the computed fold type\n      selectedTimezone.value, \n      selectedMethod.value, \n      useSEM.value ? 'sem' : 'std', true);\n    foldedData.value = grouper.foldData(timeSeriesData);\n    \n  } catch (error) {\n    console.error('Error aggregating data:', error);\n    foldedData.value = null;\n    foldedSelection.value = null;\n  }\n  \n  // Update graph data after folding\n  updateGraphData();\n  console.log(\"graphData after update:\", graphData.value);\n}\n\nfunction handlePointClick(value: {x: Plotly.Datum, y: number, customdata: unknown}) {\n  console.log(\"Point clicked:\", value);\n  console.log(\"Custom data Date:\", value.customdata ? value.customdata as Date: value.customdata);\n  // the from timezoned time is what we want to to send work with if we go back to esri stuff\n  console.log(\"fromZonedTime\", value.customdata ? fromZonedTime(value.customdata as Date, selectedTimezone.value) : value.customdata);\n  return;\n}\n\n// Save the folding\nfunction saveFolding() {\n  \n  if (!canSave.value || !props.selection || !foldedData.value) return;\n  \n  // const rawDataset = foldedTimeSeriesRawToDataSet(foldedData.value);\n  // (rawDataset as PlotltGraphDataSet).name = props.selection.name || 'Original Data';\n  // const summaryDataset = foldedTimesSeriesToDataSet(foldedData.value);\n  // (summaryDataset as PlotltGraphDataSet).name = foldedDatasetName.value;\n\n  const foldedSelection: UserDataset = {\n    id: v4(),\n    region: { ...props.selection.region, name: props.selection.region.name } as typeof props.selection.region,\n    timeRange: createFoldedTimeRange(),\n    molecule: props.selection.molecule,\n    customColor: '#333',\n    loading: false, // folded data is immediately available\n    // samples/errors intentionally omitted for folded since bins are synthetic; rely on plotlyDatasets\n    locations: foldedData.value.locations,\n    name: foldedDatasetName.value,\n    folded: {\n      timeBin: selectedTimeBin.value,\n      foldingPeriod: selectedFoldingPeriod.value,\n      foldType: selectedFoldType.value,\n      method: selectedMethod.value,\n      timezone: selectedTimezone.value,\n      useSEM: useSEM.value,\n      includeBinPhase: includeBinPhase.value,\n      alignToBinCenter: alignToBinCenter.value,\n      useErrorBars: useErrorBars.value,\n      raw: foldedData.value\n    },\n    plotlyDatasets: [\n      {\n        ...graphData.value[0],\n        datasetOptions: {\n          ...graphData.value[0].datasetOptions,\n          mode: 'markers',\n          // hovertemplate: '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>'\n        }\n      } as PlotltGraphDataSet,\n      {\n        ...graphData.value[1],\n        datasetOptions: {\n          mode: 'lines+markers'\n        }\n      } as PlotltGraphDataSet\n    ]\n  };\n  console.log(foldedSelection);\n  emit('save', foldedSelection);\n\n  closeDialog();\n}\n\n// Close dialog\nfunction closeDialog() {\n  dialogOpen.value = false;\n  // Reset state\n  nextTick(() => {\n    foldedData.value = null;\n  });\n}\n\n// Watch for selection changes\nwatch(() => props.selection, () => {\n  if (props.selection) {\n    updateAggregatedData();\n  }\n}, { immediate: true });\n</script>\n\n<style scoped>\n\n#aggregation-warning {\n  color: red;\n  font-weight: bold;\n  margin-bottom: 0.5em;\n}\n\n\n\n</style>","import script from \"./DataFoldingAndBinning.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DataFoldingAndBinning.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DataFoldingAndBinning.vue?vue&type=style&index=0&id=7bdebfb9&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7bdebfb9\"]])\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx } from \"vue\"\n\nimport { ref } from 'vue';\nimport type { UserDataset } from '../types';\nimport NewDataGenericAggregation from './DataFoldingAndBinning.vue';\n\ninterface DataAggregationProps {\n  selection: UserDataset | null;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'AdvancedOperations',\n  props: /*@__PURE__*/_mergeModels({\n    selection: {}\n  }, {\n    \"modelValue\": { type: Boolean, ...{ type: Boolean, required: true } },\n    \"modelModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"save\"], [\"update:modelValue\"]),\n  setup(__props: any, { emit: __emit }) {\n\n\nconst dialogOpen = _useModel<boolean>(__props, 'modelValue');\n\n\nconst mode = ref<'aggregate' | 'fold' | 'new'>('new');\n\nconst emit = __emit;\n\n// Save the aggregation\n// function saveAggregation(selection: UserDataset) {\n//   emit('save', selection);\n// }\n\nfunction saveFolded(selection: UserDataset) {\n  // Reuse same save channel for folded selections\n  emit('save', selection);\n}\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_v_dialog, {\n    modelValue: dialogOpen.value,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((dialogOpen).value = $event)),\n    \"max-width\": \"90vw\",\n    \"max-height\": \"90vh\",\n    persistent: \"\",\n    scrollable: \"\"\n  }, {\n    default: _withCtx(() => [\n      (mode.value === 'new')\n        ? (_openBlock(), _createBlock(NewDataGenericAggregation, {\n            key: 0,\n            modelValue: dialogOpen.value,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((dialogOpen).value = $event)),\n            selection: __props.selection,\n            onSave: saveFolded\n          }, null, 8, [\"modelValue\", \"selection\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _: 1\n  }, 8, [\"modelValue\"]))\n}\n}\n\n})","<template>\n  <v-dialog\n    v-model=\"dialogOpen\"\n    max-width=\"90vw\"\n    max-height=\"90vh\"\n    persistent\n    scrollable\n  > \n    <new-data-generic-aggregation\n      v-if=\"mode === 'new'\"\n      v-model=\"dialogOpen\"\n      :selection=\"selection\"\n      @save=\"saveFolded\"\n    />\n  </v-dialog>\n\n  \n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\nimport type { UserDataset } from '../types';\nimport NewDataGenericAggregation from './DataFoldingAndBinning.vue';\n\ninterface DataAggregationProps {\n  selection: UserDataset | null;\n}\n\nconst { selection } = defineProps<DataAggregationProps>();\nconst dialogOpen = defineModel<boolean>('modelValue', { type: Boolean, required: true });\n\n\nconst mode = ref<'aggregate' | 'fold' | 'new'>('new');\n\nconst emit = defineEmits<{\n  (event: 'save', aggregatedSelection: UserDataset): void;\n}>();\n\n// Save the aggregation\n// function saveAggregation(selection: UserDataset) {\n//   emit('save', selection);\n// }\n\nfunction saveFolded(selection: UserDataset) {\n  // Reuse same save channel for folded selections\n  emit('save', selection);\n}\n\n\n\n</script>\n\n<style scoped>\n.v-card {\n  height: 100%;\n}\n\n.v-row {\n  height: 100%;\n}\n\n.v-col {\n  height: 100%;\n}\n</style>\n","import script from \"./AdvancedOperations.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AdvancedOperations.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AdvancedOperations.vue?vue&type=style&index=0&id=48bf2174&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-48bf2174\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys, mergeProps as _mergeProps, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { ref } from 'vue';\n\nexport default /*@__PURE__*/_defineComponent({\n  ...{ inheritAttrs: false },\n  __name: 'CTextField',\n  props: {\n    title: {},\n    label: {},\n    buttonColor: {},\n    confirmText: { default: 'Done' },\n    minWidth: { default: 300 },\n    width: { default: '50%' }\n  },\n  emits: [\"update:modelValue\", \"confirm\", \"cancel\"],\n  setup(__props: any, { emit: __emit }) {\n\n\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst props = __props;\n\n// const modelValue = defineModel('modelValue', { type: String, required: true });\n\nconst emit = __emit;\n\nconst local = ref('');\n// watch(modelValue, v => { \n//   if (v !== local.value) {\n//     local.value = v; \n//   }\n// });\n\n// don't update the model value\n// watch(local, v => emit('update:modelValue', v));\n\nfunction onConfirm() {\n  if (!local.value.trim()) return;\n  emit('confirm', local.value.trim());\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_card_title = _resolveComponent(\"v-card-title\")!\n  const _component_v_text_field = _resolveComponent(\"v-text-field\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_actions = _resolveComponent(\"v-card-actions\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, {\n    class: \"mx-auto px-3 py-2\",\n    \"min-width\": __props.minWidth,\n    width: __props.width\n  }, {\n    default: _withCtx(() => [\n      _renderSlot(_ctx.$slots, \"title\", {}, () => [\n        _createVNode(_component_v_card_title, null, {\n          default: _withCtx(() => [\n            _createTextVNode(_toDisplayString(__props.title), 1)\n          ]),\n          _: 1\n        })\n      ]),\n      _createVNode(_component_v_text_field, _mergeProps({ class: \"mb-2 px-2\" }, _ctx.$attrs, {\n        modelValue: local.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((local).value = $event)),\n        label: __props.label,\n        \"hide-details\": \"\",\n        autofocus: \"\",\n        onKeyup: _withKeys(onConfirm, [\"enter\"])\n      }), null, 16, [\"modelValue\", \"label\"]),\n      _createVNode(_component_v_card_actions, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_spacer),\n          _createVNode(_component_v_btn, {\n            variant: \"text\",\n            onClick: _cache[1] || (_cache[1] = ($event: any) => (emit('cancel')))\n          }, {\n            default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n              _createTextVNode(\"Cancel\", -1)\n            ]))]),\n            _: 1\n          }),\n          _createVNode(_component_v_btn, {\n            color: __props.buttonColor,\n            variant: \"flat\",\n            disabled: !local.value.trim(),\n            onClick: onConfirm\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(__props.confirmText), 1)\n            ]),\n            _: 1\n          }, 8, [\"color\", \"disabled\"])\n        ]),\n        _: 1\n      })\n    ]),\n    _: 3\n  }, 8, [\"min-width\", \"width\"]))\n}\n}\n\n})","<template>\n  <v-card \n    class=\"mx-auto px-3 py-2\" \n    :min-width=\"minWidth\" \n    :width=\"width\"\n    >\n    <slot name=\"title\">\n      <v-card-title>\n        {{ title }}\n      </v-card-title>\n    </slot>\n    <v-text-field\n      class=\"mb-2 px-2\"\n      v-bind=\"$attrs\"\n      v-model=\"local\"\n      :label=\"label\"\n      hide-details\n      autofocus\n      @keyup.enter=\"onConfirm\"\n    />\n    <v-card-actions>\n      <v-spacer />\n      <v-btn variant=\"text\" @click=\"emit('cancel')\">Cancel</v-btn>\n      <v-btn\n        :color=\"buttonColor\"\n        variant=\"flat\"\n        :disabled=\"!local.trim()\"\n        @click=\"onConfirm\"\n      >{{ confirmText }}</v-btn>\n    </v-card-actions>\n    \n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\ndefineOptions({ inheritAttrs: false });\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst props = withDefaults(defineProps<{\n  title?: string;\n  label?: string;\n  buttonColor?: string;\n  confirmText?: string;\n  minWidth?: string | number;\n  width?: string | number;\n}>(), {\n  confirmText: 'Done',\n  minWidth: 300,\n  width: '50%',\n});\n\n// const modelValue = defineModel('modelValue', { type: String, required: true });\n\nconst emit = defineEmits<{\n  (e:'update:modelValue', v:string): void;\n  (e:'confirm', v:string): void;\n  (e:'cancel'): void;\n}>();\n\nconst local = ref('');\n// watch(modelValue, v => { \n//   if (v !== local.value) {\n//     local.value = v; \n//   }\n// });\n\n// don't update the model value\n// watch(local, v => emit('update:modelValue', v));\n\nfunction onConfirm() {\n  if (!local.value.trim()) return;\n  emit('confirm', local.value.trim());\n}\n</script>","import script from \"./CTextField.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CTextField.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, resolveComponent as _resolveComponent, withModifiers as _withModifiers, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderSlot as _renderSlot, mergeProps as _mergeProps, createSlots as _createSlots, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"d-inline-block text-caption dataset-patttern-chip ma-2\"\n}\n\nimport { ref, computed } from \"vue\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\nimport type { UserDataset } from \"../types\";\nimport { useTempoStore } from \"../stores/app\";\nimport { moleculeName } from \"../esri/utils\";\n\n\ninterface DatasetCardProps {\n  datasets: UserDataset[];\n  turnOnSelection?: boolean;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DatasetCard',\n  props: /*@__PURE__*/_mergeModels({\n    datasets: {},\n    turnOnSelection: { type: Boolean }\n  }, {\n    \"selectedDatasets\": {\n  type: Array as () => string[],\n  default: () => [],\n},\n    \"selectedDatasetsModifiers\": {},\n  }),\n  emits: [\"update:selectedDatasets\"],\n  setup(__props: any) {\n\nconst store = useTempoStore();\n\n\n\n// create a selectedDatasets model, to hold selectedDatsets use (defineModel). should just store the dataset.id values\nconst selectedDatasets = _useModel<string[]>(__props, 'selectedDatasets');\n\nconst touchscreen = supportsTouchscreen();\n\n\nconst openGraphs = ref<Record<string,boolean>>({});\n\n\n\nconst datasetRowRefs = ref({});\n\nfunction isFolded(dataset: UserDataset): boolean {\n  return !!(dataset.timeRange && dataset.timeRange.type === 'folded');\n}\n\n\nconst datesetsWithNotFoldedFisrt = computed(() => {\n  return [...__props.datasets].sort((a, b) => {\n    const aFolded = isFolded(a) ? 1 : 0;\n    const bFolded = isFolded(b) ? 1 : 0;\n    return aFolded - bFolded;\n  });\n});\n\n\nfunction _removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_chip = _resolveComponent(\"v-chip\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_hover = _resolveComponent(\"v-hover\")!\n  const _component_v_list = _resolveComponent(\"v-list\")!\n\n  return (_openBlock(), _createBlock(_component_v_list, null, {\n    default: _withCtx(() => [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(datesetsWithNotFoldedFisrt.value, (dataset) => {\n        return (_openBlock(), _createBlock(_component_v_hover, {\n          key: dataset.id\n        }, {\n          default: _withCtx(({ isHovering, props }) => [\n            _createVNode(_component_v_list_item, _mergeProps({ ref_for: true }, props, {\n              ref_for: true,\n              ref: (el) => datasetRowRefs.value[dataset.id] = el,\n              class: \"selection-item my-2 rounded-lg\",\n              style: { 'background-color': isFolded(dataset) ? '#333' : '#999', 'color': isFolded(dataset) ? '#fff' : '#000' },\n              ripple: _unref(touchscreen),\n              lines: \"two\"\n            }), _createSlots({\n              default: _withCtx(() => [\n                _createElementVNode(\"div\", null, [\n                  _createVNode(_component_v_chip, {\n                    size: \"small\",\n                    elevation: \"1\",\n                    variant: \"flat\",\n                    color: dataset.customColor ?? dataset.region.color\n                  }, {\n                    default: _withCtx(() => [\n                      _createTextVNode(_toDisplayString(dataset.name ?? dataset.region.name), 1)\n                    ]),\n                    _: 2\n                  }, 1032, [\"color\"]),\n                  _createVNode(_component_v_chip, {\n                    size: \"small\",\n                    variant: \"flat\",\n                    style: _normalizeStyle((dataset.customColor === dataset.region.color) ? {border: '1px solid #ffffff61'} : {}),\n                    color: dataset.region.color\n                  }, {\n                    default: _withCtx(() => [\n                      _createTextVNode(\" Region: \" + _toDisplayString(dataset.region.name), 1)\n                    ]),\n                    _: 2\n                  }, 1032, [\"style\", \"color\"]),\n                  _createVNode(_component_v_chip, { size: \"small\" }, {\n                    default: _withCtx(() => [\n                      _createTextVNode(\" Mol: \" + _toDisplayString(_unref(moleculeName)(dataset.molecule)), 1)\n                    ]),\n                    _: 2\n                  }, 1024),\n                  (dataset.timeRange)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                        _createElementVNode(\"span\", null, _toDisplayString(dataset.timeRange.description), 1)\n                      ]))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                _renderSlot(_ctx.$slots, \"action-row\", {\n                  isHovering: isHovering,\n                  dataset: dataset\n                })\n              ]),\n              _: 2\n            }, [\n              (__props.turnOnSelection)\n                ? {\n                    name: \"prepend\",\n                    fn: _withCtx(() => [\n                      _createVNode(_component_v_checkbox, {\n                        modelValue: selectedDatasets.value,\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((selectedDatasets).value = $event)),\n                        value: dataset.id,\n                        onClick: _cache[1] || (_cache[1] = _withModifiers(() => {}, [\"stop\"])),\n                        \"hide-details\": \"\",\n                        density: \"compact\"\n                      }, null, 8, [\"modelValue\", \"value\"])\n                    ]),\n                    key: \"0\"\n                  }\n                : undefined\n            ]), 1040, [\"style\", \"ripple\"])\n          ]),\n          _: 2\n        }, 1024))\n      }), 128))\n    ]),\n    _: 3\n  }))\n}\n}\n\n})","<template>\n  <v-list>\n    <v-hover\n      v-slot=\"{ isHovering, props }\"\n      v-for=\"dataset in datesetsWithNotFoldedFisrt\"\n      :key=\"dataset.id\"\n    > \n      <!-- create a checkbox input that will -->\n    \n      <v-list-item\n        v-bind=\"props\"\n        :ref=\"(el) => datasetRowRefs[dataset.id] = el\"\n        class=\"selection-item my-2 rounded-lg\"\n        :style=\"{ 'background-color': isFolded(dataset) ? '#333' : '#999', 'color': isFolded(dataset) ? '#fff' : '#000' }\"\n        :ripple=\"touchscreen\"\n        lines=\"two\"\n      >\n        <template v-slot:prepend v-if=\"turnOnSelection\">\n          <v-checkbox\n            v-model=\"selectedDatasets\"\n            :value=\"dataset.id\"\n            @click.stop\n            hide-details\n            density=\"compact\"\n          />\n        </template>\n        <template #default>\n          <div>\n            <v-chip\n              size=\"small\" \n              elevation=\"1\"\n              variant=\"flat\"\n              :color=\"dataset.customColor ?? dataset.region.color\"\n              >\n              {{ dataset.name ?? dataset.region.name }}\n            </v-chip>\n            \n            <v-chip \n              size=\"small\" \n              variant=\"flat\"  \n              :style=\"(dataset.customColor === dataset.region.color) ? {border: '1px solid #ffffff61'} : {}\"\n              :color=\"dataset.region.color\"\n              >\n              Region: {{ dataset.region.name }}\n            </v-chip>\n            \n            <v-chip size=\"small\">\n              Mol: {{ moleculeName(dataset.molecule) }}\n            </v-chip>\n            \n            <div class=\"d-inline-block text-caption dataset-patttern-chip ma-2\"\n              v-if=\"dataset.timeRange\" \n              >\n              <span>{{ dataset.timeRange.description }}</span>\n            </div>\n            \n            <!-- <v-chip \n              v-if=\"dataset.timeRange\" \n              size=\"small\" \n              class=\"text-caption\"\n              >\n              {{ dataset.timeRange?.type ?? 'no type' }}\n            </v-chip> -->\n          </div>\n          <!-- this is where the actions will go -->\n          <slot name=\"action-row\" :isHovering=\"isHovering\" :dataset=\"dataset\">\n          </slot>\n        </template>\n      </v-list-item>\n    </v-hover>\n  </v-list>\n\n\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from \"vue\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\nimport type { UserDataset } from \"../types\";\nimport { useTempoStore } from \"../stores/app\";\nimport { moleculeName } from \"../esri/utils\";\n\n\nconst store = useTempoStore();\n\ninterface DatasetCardProps {\n  datasets: UserDataset[];\n  turnOnSelection?: boolean;\n}\nconst { datasets, turnOnSelection } = defineProps<DatasetCardProps>();\n\n// create a selectedDatasets model, to hold selectedDatsets use (defineModel). should just store the dataset.id values\nconst selectedDatasets = defineModel<string[]>('selectedDatasets', {\n  type: Array as () => string[],\n  default: () => [],\n});\n\nconst touchscreen = supportsTouchscreen();\n\n\nconst openGraphs = ref<Record<string,boolean>>({});\n\n\n\nconst datasetRowRefs = ref({});\n\nfunction isFolded(dataset: UserDataset): boolean {\n  return !!(dataset.timeRange && dataset.timeRange.type === 'folded');\n}\n\n\nconst datesetsWithNotFoldedFisrt = computed(() => {\n  return [...datasets].sort((a, b) => {\n    const aFolded = isFolded(a) ? 1 : 0;\n    const bFolded = isFolded(b) ? 1 : 0;\n    return aFolded - bFolded;\n  });\n});\n\n\nfunction _removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\n\n</script>\n\n<style scoped lang=\"less\">\n.dataset-patttern-chip {\n  text-wrap: auto;\n  background-color: #878787;\n  border-radius: 4px;\n  padding: 2px 6px;\n}\n.dataset-patttern-chip > span {\n  opacity: 1;\n  color: black;\n}\n</style>\n","import script from \"./DatasetCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DatasetCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DatasetCard.vue?vue&type=style&index=0&id=5ca8a900&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5ca8a900\"]])\n\nexport default __exports__","import type { \n  Prettify,\n  UserDataset, \n  PlotltGraphDataSet, \n  AggValue, \n  DataPointError, \n  RectangleSelection, \n  PointSelection \n} from '@/types';\nimport { toZonedTime } from 'date-fns-tz';\nimport tz_lookup from '@photostructure/tz-lookup';\n\nclass PlotlyDatasetBuilder {\n  private _x: Date[];\n  private _y: (number | null)[];\n  private _lower: (number | null)[] | undefined;\n  private _upper: (number | null)[] | undefined;\n  private _length: number = 0;\n  private _size: number;\n  private hasErrors: boolean;\n  public cleanOutput: boolean;\n  private _skippedPoints: number = 0;\n\n  constructor(size: number, hasErrors: boolean, cleanOutput: boolean = false) {\n    this._size = size;\n    this._x = new Array(size);\n    this._y = new Array(size);\n    this.hasErrors = hasErrors;\n    this.cleanOutput = cleanOutput;\n    if (hasErrors) {\n      this._lower = new Array(size);\n      this._upper = new Array(size);\n    }\n  }\n  \n  private get index() {return this._length;}\n  \n  private _addPointWithError(value: AggValue, error: DataPointError) {\n    \n    if (this.cleanOutput && value.value === null) {\n      this._skippedPoints++;\n      return;\n    }\n    \n    this._x[this.index] = value.date;\n    this._y[this.index] = value.value;\n    // use \"definite assignment assertion\" since we know hasErrors is true\n    this._lower![this.index] = error.lower;\n    this._upper![this.index] = error.upper;\n    this._length++;\n  }\n  \n  private _addPointNoError(value: AggValue) {\n    \n    if (this.cleanOutput && value.value === null) {\n      this._skippedPoints++;\n      return;\n    }\n    \n    this._x[this.index] = value.date;\n    this._y[this.index] = value.value;\n    this._length++;\n  }\n  \n  addPoint(value: AggValue, error?: DataPointError) {\n    if (this.hasErrors && error) {\n      this._addPointWithError(value, error);\n    } else {\n      this._addPointNoError(value);\n    }\n  }\n  \n  build(name: string, errorType: 'band' | 'bar' = 'bar'): PlotltGraphDataSet {\n    if (this._length !== (this._size - this._skippedPoints)) {\n      throw new Error(`Data length mismatch: expected ${this._size}, got only ${this._length}`);\n    }\n    const isFull = this._length === this._size;\n    \n    if (this.hasErrors) {\n      return {\n        x: isFull ? this._x : this._x.slice(0, this._length),\n        y: isFull ? this._y : this._y.slice(0, this._length),\n        lower: isFull ? this._lower : this._lower!.slice(0, this._length),\n        upper: isFull ? this._upper : this._upper!.slice(0, this._length),\n        errorType: errorType,\n        name\n      };\n    } else {\n      return {\n        x: this._x,\n        y: this._y,\n        name\n      };\n    }\n  }\n}\n\nfunction regionCenter(region: RectangleSelection | PointSelection): { lat: number; lon: number } {\n  if (region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  } else {\n    const lat = (region.geometryInfo.ymin + region.geometryInfo.ymax) / 2;\n    const lon = (region.geometryInfo.xmin + region.geometryInfo.xmax) / 2;\n    return { lat, lon };\n  }\n}\n\nexport function userDatasetToPlotly(selection: Prettify<UserDataset>, useLocalTime: boolean = false): PlotltGraphDataSet {\n  if (!selection.samples) {\n    return { x: [], y: [], name: '' };\n  }\n  \n  const data = selection.samples;\n  const hasErrors = !!selection.errors;\n  const errors = selection.errors ??  {}; // so errors[key] is valid or undefined instead of an error\n  const length = Object.keys(data).length;\n  \n  const plotlyBuilder = new PlotlyDatasetBuilder(length, hasErrors);\n  let useTz = (c) => c; // identity function if no timezone\n  \n  if (useLocalTime) {\n    const { lat, lon } = regionCenter(selection.region);\n    const tz = tz_lookup(lat, lon);\n    useTz = (d: Date) => toZonedTime(d, tz);\n  }\n  \n  Object.keys(data).sort((a, b) => +a - +b).forEach((key) => {\n    if (useLocalTime) {\n      const value = { ...data[+key], date: useTz(data[+key].date) };\n      plotlyBuilder.addPoint(value, errors[+key]);\n    } else {\n      plotlyBuilder.addPoint(data[+key], errors[+key]);\n    }\n  });\n\n  return plotlyBuilder.build(selection.name || 'Dataset', 'bar');\n}\n  \n  ","import { defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, unref as _unref, resolveComponent as _resolveComponent, createBlock as _createBlock, createElementVNode as _createElementVNode } from \"vue\"\n\nconst _hoisted_1 = { id: \"user-dataset-table-container\" }\nconst _hoisted_2 = {\n  key: 0,\n  id: \"utdc--error\"\n}\nconst _hoisted_3 = { id: \"utdc--samples\" }\nconst _hoisted_4 = {\n  key: 1,\n  id: \"utdc--folded\"\n}\n\nimport { computed } from 'vue';\nimport type { Prettify, UserDataset, UnifiedRegion } from '@/types';\nimport type { FoldedTimeSeriesData, } from '@/esri/services/aggregation';\nimport type { TimeBinOptions, FoldingPeriodOptions } from './DataFoldingAndBinning.vue';\n\n\nimport tz_lookup from '@photostructure/tz-lookup';\n\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'UserDatasetTable',\n  props: {\n    dataset: {}\n  },\n  emits: [\"rowClick\"],\n  setup(__props: any, { emit: __emit }) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nfunction regionCenter(region: UnifiedRegion): { lat: number; lon: number } {\n  if (region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  } else {\n    const lat = (region.geometryInfo.ymin + region.geometryInfo.ymax) / 2;\n    const lon = (region.geometryInfo.xmin + region.geometryInfo.xmax) / 2;\n    return { lat, lon };\n  }\n}\n\nconst props = __props;\n\nconst samples = props.dataset.samples;\nconst errors = props.dataset.errors;\nconst center = regionCenter(props.dataset.region);\nconst tz = tz_lookup(center.lat, center.lon);\n\nconst errorMessage = computed(() => {\n  if (samples === undefined) {\n    return 'No samples available in this dataset.';\n  }\n  if (Object.keys(samples).length === 0) {\n    return 'Samples has length 0 for this dataset';\n  }\n  return null;\n});\n\nconst toDate = (date: Date) => date.toLocaleDateString(undefined, {dateStyle: 'medium'});\nconst toTime = (date: Date) => date.toLocaleTimeString(undefined, {\n  hour12:true, hour:'numeric', minute: '2-digit', second:'2-digit',\n  timeZone: tz,\n});\n\nconst sampleHeaders = [\n  { \n    title: 'Date' , \n    key: 'date',\n    value: item => toDate(item.date),\n  },\n  { \n    title: 'Local Time', \n    key: 'localTime',\n    value: item => toTime(item.date) \n  },\n  { \n    title: 'Column Density (error)',\n    children: [{\n      title: '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => `${item.value ? (item.value / 1e14).toFixed(2) : 'N/A'} (${item.error ? (item.error / 1e14).toFixed(2) : 'N/A'})`,\n    }]\n  },\n];\nconst samplesItems = computed(() => {\n  if (!samples) {\n    return [];\n  }\n  return Object.entries(samples).map(([key, value]) => ({\n    date: value.date,\n    value: value.value,\n    error: errors ? errors[key]?.upper : undefined,\n  }));\n});\n\n\nconst folded = props.dataset.folded;\nconst timeBin = props.dataset.folded?.timeBin as TimeBinOptions | undefined; \nconst foldPeriod = props.dataset.folded?.foldPeriod as FoldingPeriodOptions | undefined;\nconst foldedData = props.dataset.folded?.raw as FoldedTimeSeriesData | undefined;\nconsole.log('foldedData', foldedData);  \n\n\nconst foldedHeaders = [\n  { \n    title: 'Bin' , \n    key: 'date',\n  },\n  { \n    title: 'Column Density (error)',\n    children: [{\n      title: '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => `${item.value ? (item.value / 1e14).toFixed(2) : 'N/A'} (${item.error ? (item.error / 1e14).toFixed(2) : 'N/A'})`,\n    }]\n  },\n];\nconst foldedItems = computed(() => {\n  if (!foldedData) {\n    return [];\n  }\n  return Object.entries(foldedData.values).map(([key, value]) => ({\n    date: value.bin,\n    value: value.value,\n    error: foldedData.errors ? foldedData.errors[key]?.upper : undefined,\n  }));\n});\n\nconst emits = __emit;\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_data_table = _resolveComponent(\"v-data-table\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (errorMessage.value)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString(errorMessage.value), 1))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", _hoisted_3, [\n      (_unref(samples) && Object.keys(_unref(samples)).length > 0)\n        ? (_openBlock(), _createBlock(_component_v_data_table, {\n            key: 0,\n            items: samplesItems.value,\n            headers: sampleHeaders,\n            \"onClick:row\": _cache[0] || (_cache[0] = ($event: any) => (emits('rowClick', $event.item)))\n          }, null, 8, [\"items\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    (_unref(folded))\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n          (_unref(folded))\n            ? (_openBlock(), _createBlock(_component_v_data_table, {\n                key: 0,\n                headers: foldedHeaders,\n                items: foldedItems.value,\n                \"onClick:row\": _cache[1] || (_cache[1] = ($event: any) => (emits('rowClick', $event.item)))\n              }, null, 8, [\"items\"]))\n            : _createCommentVNode(\"\", true)\n        ]))\n      : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","<template>\n  <div id=\"user-dataset-table-container\">\n    <div v-if=\"errorMessage\" id=\"utdc--error\">\n      {{ errorMessage }}\n    </div>\n    <div id=\"utdc--samples\">\n      <v-data-table\n        v-if=\"samples && Object.keys(samples).length > 0\"\n        :items=\"samplesItems\"\n        :headers=\"sampleHeaders\"\n        @click:row=\"emits('rowClick', $event.item)\"\n        />\n    </div>\n    <div v-if=\"folded\" id=\"utdc--folded\">\n      <v-data-table\n        v-if=\"folded\"\n        :headers=\"foldedHeaders\"\n        :items=\"foldedItems\"\n        @click:row=\"emits('rowClick', $event.item)\"\n        />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { computed } from 'vue';\nimport type { Prettify, UserDataset, UnifiedRegion } from '@/types';\nimport type { FoldedTimeSeriesData, } from '@/esri/services/aggregation';\nimport type { TimeBinOptions, FoldingPeriodOptions } from './DataFoldingAndBinning.vue';\n\n\nimport tz_lookup from '@photostructure/tz-lookup';\n\n\nfunction regionCenter(region: UnifiedRegion): { lat: number; lon: number } {\n  if (region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  } else {\n    const lat = (region.geometryInfo.ymin + region.geometryInfo.ymax) / 2;\n    const lon = (region.geometryInfo.xmin + region.geometryInfo.xmax) / 2;\n    return { lat, lon };\n  }\n}\n\nconst props = defineProps<{\n  dataset: Prettify<UserDataset>;\n}>();\n\nconst samples = props.dataset.samples;\nconst errors = props.dataset.errors;\nconst center = regionCenter(props.dataset.region);\nconst tz = tz_lookup(center.lat, center.lon);\n\nconst errorMessage = computed(() => {\n  if (samples === undefined) {\n    return 'No samples available in this dataset.';\n  }\n  if (Object.keys(samples).length === 0) {\n    return 'Samples has length 0 for this dataset';\n  }\n  return null;\n});\n\nconst toDate = (date: Date) => date.toLocaleDateString(undefined, {dateStyle: 'medium'});\nconst toTime = (date: Date) => date.toLocaleTimeString(undefined, {\n  hour12:true, hour:'numeric', minute: '2-digit', second:'2-digit',\n  timeZone: tz,\n});\n\nconst sampleHeaders = [\n  { \n    title: 'Date' , \n    key: 'date',\n    value: item => toDate(item.date),\n  },\n  { \n    title: 'Local Time', \n    key: 'localTime',\n    value: item => toTime(item.date) \n  },\n  { \n    title: 'Column Density (error)',\n    children: [{\n      title: '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => `${item.value ? (item.value / 1e14).toFixed(2) : 'N/A'} (${item.error ? (item.error / 1e14).toFixed(2) : 'N/A'})`,\n    }]\n  },\n];\nconst samplesItems = computed(() => {\n  if (!samples) {\n    return [];\n  }\n  return Object.entries(samples).map(([key, value]) => ({\n    date: value.date,\n    value: value.value,\n    error: errors ? errors[key]?.upper : undefined,\n  }));\n});\n\n\nconst folded = props.dataset.folded;\nconst timeBin = props.dataset.folded?.timeBin as TimeBinOptions | undefined; \nconst foldPeriod = props.dataset.folded?.foldPeriod as FoldingPeriodOptions | undefined;\nconst foldedData = props.dataset.folded?.raw as FoldedTimeSeriesData | undefined;\nconsole.log('foldedData', foldedData);  \n\n\nconst foldedHeaders = [\n  { \n    title: 'Bin' , \n    key: 'date',\n  },\n  { \n    title: 'Column Density (error)',\n    children: [{\n      title: '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => `${item.value ? (item.value / 1e14).toFixed(2) : 'N/A'} (${item.error ? (item.error / 1e14).toFixed(2) : 'N/A'})`,\n    }]\n  },\n];\nconst foldedItems = computed(() => {\n  if (!foldedData) {\n    return [];\n  }\n  return Object.entries(foldedData.values).map(([key, value]) => ({\n    date: value.bin,\n    value: value.value,\n    error: foldedData.errors ? foldedData.errors[key]?.upper : undefined,\n  }));\n});\n\nconst emits = defineEmits<{\n  (event: 'rowClick', value: { date: Date | number; value: number; error?: number }): void;\n}>();\n</script>","import script from \"./UserDatasetTable.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./UserDatasetTable.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, unref as _unref, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"user-dataset-editor\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"ude__label_input\"\n}\nconst _hoisted_3 = [\"placeholder\"]\nconst _hoisted_4 = {\n  key: 1,\n  class: \"ude__label_input\"\n}\nconst _hoisted_5 = { class: \"ude__button-container\" }\n\nimport { ref, watch, onUnmounted  } from 'vue';\nimport { useTempoStore } from \"../stores/app\";\nimport { UserDataset } from '@/types';\n\ntype Props = {\n  nameOnly?: boolean;\n  colorOnly?: boolean;\n};\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'UserDatasetEditor',\n  props: /*@__PURE__*/_mergeModels({\n    nameOnly: { type: Boolean, default: false },\n    colorOnly: { type: Boolean, default: false }\n  }, {\n    \"modelValue\": {\n  type: Object as () => UserDataset,\n  required: true,\n},\n    \"modelModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"complete\"], [\"update:modelValue\"]),\n  setup(__props: any, { emit: __emit }) {\n\nconst accentColor2 = useTempoStore().accentColor2;\n\nconst props = __props;\n\nconst model = _useModel(__props, \"modelValue\");\n\nconst emit = __emit;\n\nconst name = ref(model.value.name || '');\nconst color = ref(model.value.customColor || model.value.region.color || 'white');\nconst changed = ref(false);\n\nwatch(name, () => {\n  changed.value = true;\n});\nwatch(color, () => {\n  changed.value = true;\n});\n\nfunction save() {\n  if (model.value) {\n    model.value.name = name.value;\n    if (model.value.plotlyDatasets) {\n      model.value.plotlyDatasets[1].name = name.value;\n    }\n    model.value.customColor = color.value;\n  }\n  emit('complete');\n}\n\nfunction cancel() {\n  emit('complete');\n}\n\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Enter' && changed.value) {\n    save();\n  } else if (event.key === 'Escape') {\n    cancel();\n  }\n}\n\nwindow.addEventListener('keydown', globalKeydownHandler);\n\nfunction globalKeydownHandler(event: KeyboardEvent) {\n  const skipTags = ['INPUT', 'TEXTAREA', 'BUTTON', 'SELECT'];\n  if (\n    event.target && \n    skipTags.includes((event.target as HTMLElement).tagName)) {\n    return; \n  }\n  handleKeydown(event);\n}\nonUnmounted(() => {\n  window.removeEventListener('keydown', globalKeydownHandler);\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, {\n    width: \"fit-content\",\n    class: \"mx-auto\"\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_card_text, { class: \"pb-0\" }, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_1, [\n            (!props.colorOnly)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                  _cache[3] || (_cache[3] = _createElementVNode(\"label\", { for: \"ude-name\" }, \"Edit Name:\", -1)),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    id: \"ude-name\",\n                    type: \"text\",\n                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((name).value = $event)),\n                    placeholder: model.value.name ?? 'Dataset Name',\n                    minlength: \"3\",\n                    onKeydown: handleKeydown\n                  }, null, 40, _hoisted_3), [\n                    [_vModelText, name.value]\n                  ])\n                ]))\n              : _createCommentVNode(\"\", true),\n            (!props.nameOnly)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                  _cache[5] || (_cache[5] = _createElementVNode(\"label\", { for: \"ude-color\" }, \" Edit Color:\", -1)),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    id: \"ude-color\",\n                    type: \"color\",\n                    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((color).value = $event)),\n                    onKeydown: handleKeydown\n                  }, null, 544), [\n                    [_vModelText, color.value]\n                  ]),\n                  _createVNode(_component_v_btn, {\n                    class: \"use_reset-color\",\n                    variant: \"outlined\",\n                    color: model.value.region.color,\n                    size: \"small\",\n                    onClick: _cache[2] || (_cache[2] = ($event: any) => (color.value = model.value.region.color))\n                  }, {\n                    default: _withCtx(() => [\n                      _cache[4] || (_cache[4] = _createTextVNode(\" Reset \", -1)),\n                      _createElementVNode(\"div\", {\n                        class: \"ude_color-swatch\",\n                        style: _normalizeStyle({backgroundColor: model.value.region.color})\n                      }, null, 4)\n                    ]),\n                    _: 1\n                  }, 8, [\"color\"])\n                ]))\n              : _createCommentVNode(\"\", true)\n          ])\n        ]),\n        _: 1\n      }),\n      _createElementVNode(\"div\", _hoisted_5, [\n        _createVNode(_component_v_btn, {\n          variant: \"flat\",\n          size: \"small\",\n          onClick: cancel\n        }, {\n          default: _withCtx(() => [...(_cache[6] || (_cache[6] = [\n            _createTextVNode(\"Cancel\", -1)\n          ]))]),\n          _: 1\n        }),\n        _createVNode(_component_v_btn, {\n          color: _unref(accentColor2),\n          size: \"small\",\n          onClick: save,\n          disabled: !changed.value\n        }, {\n          default: _withCtx(() => [...(_cache[7] || (_cache[7] = [\n            _createTextVNode(\"Save\", -1)\n          ]))]),\n          _: 1\n        }, 8, [\"color\", \"disabled\"])\n      ])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<!-- eslint-disable @typescript-eslint/no-unused-vars -->\n<template>\n  <!-- not too wide, and center it -->\n  <v-card width=\"fit-content\" class=\"mx-auto\">\n    \n    <v-card-text class=\"pb-0\">\n      \n      <div class=\"user-dataset-editor\">\n        <div class=\"ude__label_input\" v-if=\"!props.colorOnly\">\n          <label for=\"ude-name\">Edit Name:</label>\n          <input id=\"ude-name\" type=\"text\" v-model=\"name\" :placeholder=\"model.name ?? 'Dataset Name'\" minlength=\"3\" @keydown=\"handleKeydown\"/>\n        </div>\n\n        <div class=\"ude__label_input\" v-if=\"!props.nameOnly\">\n          <label for=\"ude-color\"> Edit Color:</label>\n          <input id=\"ude-color\" type=\"color\" v-model=\"color\" @keydown=\"handleKeydown\"/>\n          <v-btn class=\"use_reset-color\" variant=\"outlined\" :color=\"model.region.color\"  size=\"small\" @click=\"color = model.region.color\">\n            <template #default>\n            Reset\n              <div \n                class=\"ude_color-swatch\" \n                :style=\"{backgroundColor: model.region.color}\"\n                > \n              </div>\n              </template>\n          </v-btn>\n        </div>\n      </div>\n      \n    </v-card-text>\n    \n    <div class=\"ude__button-container\">\n      <v-btn variant=\"flat\" size=\"small\" @click=\"cancel\">Cancel</v-btn>\n      <v-btn :color=\"accentColor2\" size=\"small\" @click=\"save\" :disabled=\"!changed\">Save</v-btn>\n    </div>\n\n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onUnmounted  } from 'vue';\nimport { useTempoStore } from \"../stores/app\";\nconst accentColor2 = useTempoStore().accentColor2;\n\nimport { UserDataset } from '@/types';\n\ntype Props = {\n  nameOnly?: boolean;\n  colorOnly?: boolean;\n};\n\nconst props = withDefaults(defineProps<Props>(),{\n  nameOnly: false,\n  colorOnly: false,\n});\n\nconst model = defineModel({\n  type: Object as () => UserDataset,\n  required: true,\n});\n\nconst emit = defineEmits<{\n  (e: 'complete'): void;\n}>();\n\nconst name = ref(model.value.name || '');\nconst color = ref(model.value.customColor || model.value.region.color || 'white');\nconst changed = ref(false);\n\nwatch(name, () => {\n  changed.value = true;\n});\nwatch(color, () => {\n  changed.value = true;\n});\n\nfunction save() {\n  if (model.value) {\n    model.value.name = name.value;\n    if (model.value.plotlyDatasets) {\n      model.value.plotlyDatasets[1].name = name.value;\n    }\n    model.value.customColor = color.value;\n  }\n  emit('complete');\n}\n\nfunction cancel() {\n  emit('complete');\n}\n\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Enter' && changed.value) {\n    save();\n  } else if (event.key === 'Escape') {\n    cancel();\n  }\n}\n\nwindow.addEventListener('keydown', globalKeydownHandler);\n\nfunction globalKeydownHandler(event: KeyboardEvent) {\n  const skipTags = ['INPUT', 'TEXTAREA', 'BUTTON', 'SELECT'];\n  if (\n    event.target && \n    skipTags.includes((event.target as HTMLElement).tagName)) {\n    return; \n  }\n  handleKeydown(event);\n}\nonUnmounted(() => {\n  window.removeEventListener('keydown', globalKeydownHandler);\n});\n\n</script>\n\n<style lang=\"less\" scoped>\ndiv.user-dataset-editor {\n  display: flex;\n  flex-direction: column;\n  gap: 1em;\n  margin-block: 1em;\n}\n\n.ude__label_input {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: 5px;\n}\n\nlabel {\n  font-size: 0.9em;\n  font-weight: bold;\n  width: 10ch; // bad: hack to get inputs aligned\n}\n\n.ude__button-container {\n  display: flex;\n  justify-content: flex-end;\n  padding: 0.5rem 1rem;\n  padding-bottom: 1rem;\n  gap: 1rem;\n}\n\n\n\ninput {\n  background-color: rgb(var(--v-theme-surface));\n  border: 1px solid rgb(var(--v-theme-on-surface));\n  border-radius: 5px;\n  color: rgb(var(--v-theme-on-surface));\n  padding-inline: 0.5rem;\n  font-size: 0.9em;\n}\n\n.ude_color-swatch {\n  display: inline-block;\n  width: 1em;\n  height: 1em;\n  border: 1px solid rgb(var(--v-theme-on-surface));\n  margin-left: 0.5em;\n  vertical-align: middle;\n}\n\n.use_reset-color {\n  text-transform: none;\n}\n</style>","import script from \"./UserDatasetEditor.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./UserDatasetEditor.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./UserDatasetEditor.vue?vue&type=style&index=0&id=f1f5caf2&lang=less&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f1f5caf2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createVNode as _createVNode, toDisplayString as _toDisplayString, isRef as _isRef, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives, normalizeStyle as _normalizeStyle, vShow as _vShow, normalizeClass as _normalizeClass, mergeProps as _mergeProps } from \"vue\"\n\nconst _hoisted_1 = { id: \"add-region-time\" }\nconst _hoisted_2 = { id: \"add-region-buttons\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"my-selections\",\n  style: {\"margin-top\":\"1em\"}\n}\nconst _hoisted_4 = {\n  key: 1,\n  class: \"my-selections\",\n  style: {\"margin-top\":\"1em\"}\n}\nconst _hoisted_5 = {\n  key: 0,\n  class: \"my-selections\",\n  style: {\"margin-top\":\"1em\"}\n}\nconst _hoisted_6 = {\n  key: 0,\n  class: \"dataset-loading\"\n}\nconst _hoisted_7 = { class: \"text-subtitle-2\" }\nconst _hoisted_8 = { key: 0 }\nconst _hoisted_9 = { class: \"selection-icons\" }\nconst _hoisted_10 = {\n  key: 1,\n  class: \"pa-2 mb-2 explainer-text\"\n}\nconst _hoisted_11 = { class: \"d-flex flex-wrap flex-row ma-2 align-center justify-center ga-1\" }\nconst _hoisted_12 = {\n  key: 3,\n  class: \"mixed-foldType-warning pa-2 ma-2 text-large text-red explainer-text\"\n}\n\nimport { computed, ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from \"uuid\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport type { MillisecondRange, TimeRange, UserDataset, UnifiedRegion } from \"../types\";\nimport { serializeTempoStore, useTempoStore } from \"../stores/app\";\nimport { MOLECULE_OPTIONS } from \"../esri/utils\";\nimport { areEquivalentTimeRanges, formatTimeRange } from \"../utils/timeRange\";\nimport { atleast1d } from \"../utils/atleast1d\";\n\nimport DateTimeRangeSelection from \"../date_time_range_selection/DateTimeRangeSelection.vue\";\nimport AdvancedOperations from \"./AdvancedOperations.vue\";\nimport { TimeRangeSelectionType } from \"@/types/datetime\";\nimport PlotlyGraph from \"./plotly/PlotlyGraph.vue\";\nimport FoldedPlotlyGraph from \"./FoldedPlotlyGraph.vue\";\nimport CTextField from \"./CTextField.vue\";\nimport DatasetCard from \"./DatasetCard.vue\";\nimport { toZonedTime } from \"date-fns-tz\";\nimport { allEqual } from \"@/utils/array_operations/array_math\";\nimport { userDatasetToPlotly } from \"@/utils/data_converters\";\nimport UserDatasetTable from \"./UserDatasetTable.vue\";\n\nimport UserDatasetEditor from \"./UserDatasetEditor.vue\";\ntype UnifiedRegionType = UnifiedRegion;\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DatasetControls',\n  setup(__props) {\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  backend,\n  regions,\n  datasets,\n  timeRanges,\n  singleDateSelected,\n  uniqueDays,\n  selectionActive,\n  focusRegion,\n  showSamplingPreviewMarkers,\n} = storeToRefs(store);\n\nconst cssVars = computed(() => {\n  return {\n    '--accent-color': accentColor.value,\n    '--accent-color-2': accentColor2.value,\n  };\n});\n\nfunction plotlyDragPredicate(element: HTMLElement): boolean {\n  return element.closest(\".plotly\") === null;\n}\n\nconst touchscreen = supportsTouchscreen();\n\nconst openPanels = ref<number[]>([0, 1, 2]);\nconst openGraphs = ref<Record<string,boolean>>({});\nconst openSelection = ref<string | null>(null);\nconst tableSelection = ref<UserDataset | null>(null);\nconst currentlyEditingDataset = ref<UserDataset | null>(null);\nconst showConfirmReset = ref(false);\n\nconst createTimeRangeActive = ref(false);\nconst createDatasetActive = ref(false);\nconst datasetRowRefs = ref({});\nconst sampleErrorID = ref<string | null>(null);\nconst loadingPointSample = ref<string | false>(false);\n\nconst showEditRegionNameDialog = ref(false);\nconst regionBeingEdited = ref<UnifiedRegionType | null>(null);\n\nconst aggregationDataset = ref<UserDataset | null>(null);\nconst showAggregationDialog = ref(false);\nfunction openAggregationDialog(selection: UserDataset) {\n  aggregationDataset.value = selection;\n  showAggregationDialog.value = true;\n}\nfunction handleAggregationSaved(aggregatedSelection: UserDataset) {\n  aggregatedSelection.name = `${aggregatedSelection.name} ${datasets.value.length + 1}`;\n  store.addDataset(aggregatedSelection, false); // no need to fetch anything\n  showAggregationDialog.value = false;\n  aggregationDataset.value = null;\n}\n\nfunction handleDatasetCreated(dataset: UserDataset) {\n  dataset.name = `Dataset ${datasets.value.length + 1}`; // give it a default name\n  store.addDataset(dataset);\n  createDatasetActive.value = false;\n}\n\nconst showDatasetEditor = ref(false);\nconst datasetEditorNameOnly = ref(false);\nfunction handleEditDataset(dataset: UserDataset, nameOnly = false) {\n  datasetEditorNameOnly.value = nameOnly;\n  currentlyEditingDataset.value = dataset;\n  showDatasetEditor.value = true;\n}\n\nfunction removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\nfunction handleDateTimeRangeSelectionChange(timeRanges: MillisecondRange[], selectionType: TimeRangeSelectionType, customName: string) {\n  if (!Array.isArray(timeRanges) || timeRanges.length === 0) {\n    console.error('No time ranges received from DateTimeRangeSelection');\n    return;\n  }\n  console.log(`Received ${timeRanges.length} time ranges of type ${selectionType} and name ${customName}`);\n  const normalized = atleast1d(timeRanges);\n  // No dedup tracking now\n  const tr: TimeRange = {\n    id: v4(),\n    name: customName,\n    description: customName,\n    range: normalized.length === 1 ? normalized[0] : normalized,\n    type: selectionType,\n  };\n  store.addTimeRange(tr);\n\n  createTimeRangeActive.value = false;\n  console.log(`Registered ${tr.name}: ${tr.description}`);\n}\n\nfunction editRegionName(region: UnifiedRegionType) {\n  console.log(`Editing ${region.geometryType}: ${region.name}`);\n  // Set the region to edit\n\n  // eslint-disable-next-line\n  // @ts-ignore it is not actually deep\n  const existing = (regions.value as UnifiedRegionType[]).find(r => r.id === region.id);\n  if (!existing) {\n    console.error(`Region with ID ${region.id} not found.`);\n    return;\n  }\n  regionBeingEdited.value = region;\n  // Open dialog for renaming\n  showEditRegionNameDialog.value = true;\n}\n\nfunction graphTitle(dataset: UserDataset): string {\n  const molecule = dataset.molecule;\n  const molTitle = MOLECULE_OPTIONS.find(m => m.value === molecule)?.title || '';\n  return `${molTitle} Time Series for ${dataset.region.name}`;\n}\n\nconst showNO2Graph = ref(false);\nconst no2GraphData = computed(() =>{\n  return datasets.value.filter(s => s.molecule.includes('no2') && store.datasetHasSamples(s));\n});\n\n// ozone version\nconst showO3Graph = ref(false);\nconst o3GraphData = computed(() =>{\n  return datasets.value.filter(s => s.molecule.includes('o3') && store.datasetHasSamples(s));\n});\n\n\n// formaldehyde version\nconst showHCHOGraph = ref(false);\nconst hchoGraphData = computed(() =>{\n  return datasets.value.filter(s => s.molecule.includes('hcho') && store.datasetHasSamples(s));\n});\n\nfunction _toZonedTime(date: number | Date | string, timezone): number | Date {\n  if (typeof date === 'number') {\n    date = new Date(date);\n  } else if (typeof date === 'string') {\n    date = new Date(date);\n  }\n  return toZonedTime(date, timezone);\n}\n\nconst allDatasetSelection = ref(false);\nconst selectedDatasets = ref<string[]>([]);\nwatch(allDatasetSelection, (newVal) => {\n  if (!newVal) {\n    selectedDatasets.value = [];\n  }\n});\nwatch(selectedDatasets, (newVal) => {\n  console.log('Selected datasets changed:', newVal);\n});\n\nconst showfoldedNO2Graph = ref(false);\nconst no2foldedGraphData = computed(() =>{\n  const validFoldedDatasets = datasets.value\n    .filter(\n      s => s.molecule.includes('no2') && \n      s.timeRange?.type === 'folded' && \n      s.plotlyDatasets && \n      s.plotlyDatasets.length > 0 &&\n      selectedDatasets.value.includes(s.id)\n    );\n  return validFoldedDatasets.map(s => {    \n    return {\n      ...s.plotlyDatasets![1],\n      foldType: s.folded?.foldType,\n      timezone: s.folded?.timezone,\n      color: s.customColor || s.region.color,\n    };\n  }); // \"!\" tells TS that we know it's not undefined\n});\n\nconst showfoldedO3Graph = ref(false);\nconst o3foldedGraphData = computed(() =>{\n  const validFoldedDatasets = datasets.value\n    .filter(\n      s => s.molecule.includes('o3') && \n      s.timeRange?.type === 'folded' && \n      s.plotlyDatasets && \n      s.plotlyDatasets.length > 0 &&\n      selectedDatasets.value.includes(s.id)\n    );\n  return validFoldedDatasets.map(s => {\n    return {\n      ...s.plotlyDatasets![1],\n      foldType: s.folded?.foldType,\n      timezone: s.folded?.timezone,\n      color: s.customColor || s.region.color,\n    };\n  }); // \"!\" tells TS that we know it's not undefined\n}); \n\nconst showfoldedHCHOGraph = ref(false);\nconst hchofoldedGraphData = computed(() =>{\n  const validFoldedDatasets = datasets.value\n    .filter(\n      s => s.molecule.includes('hcho') && \n      s.timeRange?.type === 'folded' && \n      s.plotlyDatasets && \n      s.plotlyDatasets.length > 0 &&\n      selectedDatasets.value.includes(s.id)\n    );\n  return validFoldedDatasets.map(s => {\n    return {\n      ...s.plotlyDatasets![1],\n      foldType: s.folded?.foldType,\n      timezone: s.folded?.timezone,\n      color: s.customColor || s.region.color,\n    };\n  }); // \"!\" tells TS that we know it's not undefined\n}); \n\nconst showErrorBands = ref(true);\n\nconst showUserDatasetTable = ref(false);\nwatch(tableSelection, (newVal) => {\n  if (newVal) {\n    console.log('Table selection changed:', newVal);\n    showUserDatasetTable.value = true;\n  }\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card_actions = _resolveComponent(\"v-card-actions\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_list = _resolveComponent(\"v-list\")!\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\")!\n  const _component_v_divider = _resolveComponent(\"v-divider\")!\n  const _component_selection_composer = _resolveComponent(\"selection-composer\")!\n  const _component_v_progress_linear = _resolveComponent(\"v-progress-linear\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_expand_transition = _resolveComponent(\"v-expand-transition\")!\n  const _component_cds_dialog = _resolveComponent(\"cds-dialog\")!\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\")!\n  const _directive_tooltip = _resolveDirective(\"tooltip\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: \"dataset-sections\",\n    style: _normalizeStyle(cssVars.value)\n  }, [\n    _cache[57] || (_cache[57] = _createElementVNode(\"h2\", null, \"Investigate Patterns with Time\", -1)),\n    (_unref(regions).length > 0 || _unref(timeRanges).length > 1)\n      ? (_openBlock(), _createBlock(_component_v_btn, {\n          key: 0,\n          color: _unref(accentColor2),\n          onClick: _cache[0] || (_cache[0] = ($event: any) => (showConfirmReset.value = true))\n        }, {\n          default: _withCtx(() => [...(_cache[40] || (_cache[40] = [\n            _createTextVNode(\" Delete ALL selections \", -1)\n          ]))]),\n          _: 1\n        }, 8, [\"color\"]))\n      : _createCommentVNode(\"\", true),\n    _createVNode(_component_v_dialog, {\n      modelValue: showConfirmReset.value,\n      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((showConfirmReset).value = $event)),\n      \"max-width\": \"35%\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_card, null, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_card_text, null, {\n              default: _withCtx(() => [...(_cache[41] || (_cache[41] = [\n                _createTextVNode(\" Are you sure you want to delete all of your selections? This will remove all of your regions, time ranges, and datasets, and cannot be undone. \", -1)\n              ]))]),\n              _: 1\n            }),\n            _createVNode(_component_v_card_actions, null, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_btn, {\n                  color: \"error\",\n                  onClick: _cache[1] || (_cache[1] = ($event: any) => (showConfirmReset.value = false))\n                }, {\n                  default: _withCtx(() => [...(_cache[42] || (_cache[42] = [\n                    _createTextVNode(\" No \", -1)\n                  ]))]),\n                  _: 1\n                }),\n                _createVNode(_component_v_btn, {\n                  color: \"success\",\n                  onClick: _cache[2] || (_cache[2] = () => {\n              _unref(store).reset();\n              _unref(serializeTempoStore)(_unref(store));\n              showConfirmReset.value = false;\n            })\n                }, {\n                  default: _withCtx(() => [...(_cache[43] || (_cache[43] = [\n                    _createTextVNode(\" Yes \", -1)\n                  ]))]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createElementVNode(\"div\", _hoisted_1, [\n      _cache[50] || (_cache[50] = _createElementVNode(\"p\", null, \" Select a Region, Time Range, and Molecule to create a dataset of your choice! \", -1)),\n      _createVNode(_component_v_expansion_panels, {\n        modelValue: openPanels.value,\n        \"onUpdate:modelValue\": _cache[12] || (_cache[12] = ($event: any) => ((openPanels).value = $event)),\n        variant: \"accordion\",\n        id: \"user-options-panels\",\n        multiple: \"\",\n        class: \"pl-3\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_expansion_panel, {\n            title: \"Regions\",\n            class: \"mt-3 h3-panel-titles\"\n          }, {\n            text: _withCtx(() => [\n              _createElementVNode(\"div\", _hoisted_2, [\n                _createVNode(_component_v_btn, {\n                  size: \"small\",\n                  active: _unref(selectionActive) === 'rectangle',\n                  disabled: _unref(selectionActive) === 'point',\n                  color: _unref(accentColor2),\n                  onClick: _cache[4] || (_cache[4] = () => {\n                  selectionActive.value = (_unref(selectionActive) === 'rectangle') ? null : 'rectangle';\n                })\n                }, {\n                  prepend: _withCtx(() => [\n                    (_unref(selectionActive) !== 'rectangle')\n                      ? (_openBlock(), _createBlock(_component_v_icon, {\n                          key: 0,\n                          icon: \"mdi-plus\"\n                        }))\n                      : _createCommentVNode(\"\", true)\n                  ]),\n                  default: _withCtx(() => [\n                    _createTextVNode(\" \" + _toDisplayString(_unref(selectionActive) === 'rectangle' ? \"Cancel\" : \"New Region\"), 1)\n                  ]),\n                  _: 1\n                }, 8, [\"active\", \"disabled\", \"color\"])\n              ]),\n              _createVNode(_component_v_checkbox, {\n                modelValue: _unref(showSamplingPreviewMarkers),\n                \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => (_isRef(showSamplingPreviewMarkers) ? (showSamplingPreviewMarkers).value = $event : null)),\n                label: \"Show sample points\",\n                density: \"compact\",\n                \"hide-details\": \"\"\n              }, null, 8, [\"modelValue\"]),\n              (_unref(regions).length>0)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                    _cache[44] || (_cache[44] = _createElementVNode(\"h4\", null, \"My Regions\", -1)),\n                    _createVNode(_component_v_list, null, {\n                      default: _withCtx(() => [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(regions), (region, index) => {\n                          return (_openBlock(), _createBlock(_component_v_list_item, {\n                            key: index,\n                            title: region.name,\n                            style: _normalizeStyle({ 'background-color': region.color }),\n                            onClick: () => focusRegion.value = region\n                          }, {\n                            append: _withCtx(() => [\n                              _withDirectives(_createVNode(_component_v_btn, {\n                                variant: \"plain\",\n                                icon: \"mdi-pencil\",\n                                color: \"white\",\n                                onClick: (event) => {\n                        editRegionName(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\n                              }, null, 8, [\"onClick\"]), [\n                                [_directive_tooltip, 'Edit Name']\n                              ]),\n                              (!_unref(store).regionHasDatasets(region as UnifiedRegionType))\n                                ? _withDirectives((_openBlock(), _createBlock(_component_v_btn, {\n                                    key: 0,\n                                    variant: \"plain\",\n                                    icon: \"mdi-delete\",\n                                    color: \"white\",\n                                    onClick: (event) => {\n                        _unref(store).deleteRegion(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\n                                  }, null, 8, [\"onClick\"])), [\n                                    [_directive_tooltip, 'Delete']\n                                  ])\n                                : _createCommentVNode(\"\", true)\n                            ]),\n                            _: 2\n                          }, 1032, [\"title\", \"style\", \"onClick\"]))\n                        }), 128))\n                      ]),\n                      _: 1\n                    })\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_expansion_panel, {\n            title: \"Time Ranges\",\n            class: \"mt-3 h3-panel-titles\"\n          }, {\n            text: _withCtx(() => [\n              _createVNode(_component_v_btn, {\n                size: \"small\",\n                active: createTimeRangeActive.value,\n                color: _unref(accentColor2),\n                onClick: _cache[6] || (_cache[6] = ($event: any) => (createTimeRangeActive.value = !createTimeRangeActive.value))\n              }, {\n                prepend: _withCtx(() => [\n                  (!createTimeRangeActive.value)\n                    ? (_openBlock(), _createBlock(_component_v_icon, {\n                        key: 0,\n                        icon: \"mdi-plus\"\n                      }))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                default: _withCtx(() => [\n                  _createTextVNode(\" \" + _toDisplayString(createTimeRangeActive.value ? \"Cancel\" : \"New Time Range\"), 1)\n                ]),\n                _: 1\n              }, 8, [\"active\", \"color\"]),\n              (createTimeRangeActive.value)\n                ? (_openBlock(), _createBlock(DateTimeRangeSelection, {\n                    key: 0,\n                    \"current-date\": _unref(singleDateSelected),\n                    \"allowed-dates\": _unref(uniqueDays),\n                    onRangesChange: handleDateTimeRangeSelectionChange\n                  }, null, 8, [\"current-date\", \"allowed-dates\"]))\n                : _createCommentVNode(\"\", true),\n              (_unref(timeRanges).length>0)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                    _cache[45] || (_cache[45] = _createElementVNode(\"h4\", null, \"My Time Ranges\", -1)),\n                    _createVNode(_component_v_list, null, {\n                      default: _withCtx(() => [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(timeRanges), (timeRange, index) => {\n                          return (_openBlock(), _createBlock(_component_v_list_item, {\n                            key: index,\n                            title: timeRange.name === 'Displayed Day' ? `Displayed Day: ${ _unref(formatTimeRange)(timeRange.range) }` : (timeRange.name ?? _unref(formatTimeRange)(timeRange.range)),\n                            style: {\"background-color\":\"#444444\"}\n                          }, {\n                            append: _withCtx(() => [\n                              (timeRange.id !== 'displayed-day' && !_unref(datasets).some(s => _unref(areEquivalentTimeRanges)(s.timeRange, timeRange)))\n                                ? _withDirectives((_openBlock(), _createBlock(_component_v_btn, {\n                                    key: 0,\n                                    variant: \"plain\",\n                                    icon: \"mdi-delete\",\n                                    color: \"white\",\n                                    onClick: () => _unref(store).deleteTimeRange(timeRange)\n                                  }, null, 8, [\"onClick\"])), [\n                                    [_directive_tooltip, 'Delete']\n                                  ])\n                                : _createCommentVNode(\"\", true)\n                            ]),\n                            _: 2\n                          }, 1032, [\"title\"]))\n                        }), 128))\n                      ]),\n                      _: 1\n                    })\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_divider, {\n            class: \"mt-3\",\n            opacity: \"1\"\n          }),\n          _createVNode(_component_v_expansion_panel, {\n            title: \"Datasets\",\n            class: \"mt-3 h3-panel-titles\"\n          }, {\n            text: _withCtx(() => [\n              _createVNode(_component_v_btn, {\n                size: \"small\",\n                active: createDatasetActive.value,\n                color: _unref(accentColor2),\n                onClick: _cache[7] || (_cache[7] = ($event: any) => (createDatasetActive.value = !createDatasetActive.value)),\n                class: \"mt-3\"\n              }, {\n                prepend: _withCtx(() => [\n                  (!createDatasetActive.value)\n                    ? (_openBlock(), _createBlock(_component_v_icon, {\n                        key: 0,\n                        icon: \"mdi-plus\"\n                      }))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                default: _withCtx(() => [\n                  _createTextVNode(\" \" + _toDisplayString(createDatasetActive.value ? \"Cancel\" : \"New Dataset\"), 1)\n                ]),\n                _: 1\n              }, 8, [\"active\", \"color\"]),\n              _withDirectives(_createVNode(_component_selection_composer, {\n                backend: _unref(backend),\n                \"time-ranges\": _unref(timeRanges),\n                regions: _unref(regions),\n                disabled: { region: _unref(selectionActive) === 'rectangle', point: _unref(selectionActive) === 'point', timeRange: createTimeRangeActive.value },\n                onCreate: handleDatasetCreated\n              }, null, 8, [\"backend\", \"time-ranges\", \"regions\", \"disabled\"]), [\n                [_vShow, createDatasetActive.value]\n              ]),\n              (_unref(datasets).length>0)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                    _cache[49] || (_cache[49] = _createElementVNode(\"h4\", null, \"My Datasets\", -1)),\n                    _createVNode(DatasetCard, {\n                      datasets: _unref(datasets),\n                      \"turn-on-selection\": allDatasetSelection.value,\n                      \"selected-datasets\": selectedDatasets.value,\n                      \"onUpdate:selectedDatasets\": _cache[10] || (_cache[10] = ($event: any) => ((selectedDatasets).value = $event))\n                    }, {\n                      \"action-row\": _withCtx(({ isHovering, dataset }) => [\n                        ((dataset.loading || !dataset.samples)  && !(dataset.timeRange?.type === 'folded' && dataset.plotlyDatasets))\n                          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                              _cache[47] || (_cache[47] = _createElementVNode(\"hr\", null, null, -1)),\n                              _createVNode(_component_v_progress_linear, {\n                                class: _normalizeClass(['dataset-loading-progress', !(dataset.loading && dataset.samples) ? 'dataset-loading-failed' : '']),\n                                active: dataset.loading || !dataset.samples,\n                                color: dataset.loading ? 'primary' : 'red',\n                                indeterminate: dataset.loading,\n                                value: !dataset.loading ? 100 : 0,\n                                striped: !dataset.loading,\n                                bottom: \"\",\n                                rounded: \"\",\n                                height: \"20\"\n                              }, {\n                                default: _withCtx(() => [\n                                  _createElementVNode(\"span\", _hoisted_7, _toDisplayString(dataset.loading ? 'Data Loading' : (!dataset.samples ? 'Error Loading Data' : '')), 1)\n                                ]),\n                                _: 2\n                              }, 1032, [\"class\", \"active\", \"color\", \"indeterminate\", \"value\", \"striped\"]),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Remove selection\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-trash-can\",\n                                    variant: \"plain\",\n                                    onClick: () => removeDataset(dataset)\n                                  }), null, 16, [\"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              (!(dataset.loading || dataset.samples || dataset.plotlyDatasets))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                                    _cache[46] || (_cache[46] = _createElementVNode(\"hr\", null, null, -1)),\n                                    _createVNode(_component_v_tooltip, {\n                                      text: \"Failure info\",\n                                      location: \"top\"\n                                    }, {\n                                      activator: _withCtx(({ props }) => [\n                                        _createVNode(_component_v_btn, _mergeProps(props, {\n                                          size: \"x-small\",\n                                          icon: \"mdi-help-circle\",\n                                          variant: \"plain\",\n                                          onClick: () => sampleErrorID.value = dataset.id\n                                        }), null, 16, [\"onClick\"])\n                                      ]),\n                                      _: 2\n                                    }, 1024),\n                                    _createVNode(_component_v_tooltip, {\n                                      text: \"Remove selection\",\n                                      location: \"top\"\n                                    }, {\n                                      activator: _withCtx(({ props }) => [\n                                        _createVNode(_component_v_btn, _mergeProps(props, {\n                                          size: \"x-small\",\n                                          icon: \"mdi-trash-can\",\n                                          variant: \"plain\",\n                                          onClick: () => removeDataset(dataset)\n                                        }), null, 16, [\"onClick\"])\n                                      ]),\n                                      _: 2\n                                    }, 1024)\n                                  ]))\n                                : _createCommentVNode(\"\", true)\n                            ]))\n                          : _createCommentVNode(\"\", true),\n                        _createVNode(_component_v_expand_transition, null, {\n                          default: _withCtx(() => [\n                            _withDirectives(_createElementVNode(\"div\", _hoisted_9, [\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Get Center Point Sample\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    loading: loadingPointSample.value === dataset.id,\n                                    icon: \"mdi-image-filter-center-focus\",\n                                    variant: \"plain\",\n                                    onClick: () => _unref(store).fetchCenterPointDataForDataset(dataset)\n                                  }), null, 16, [\"loading\", \"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Show table\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-table\",\n                                    disabled: !dataset.samples && !dataset.folded,\n                                    variant: \"plain\",\n                                    onClick: () => tableSelection.value = dataset\n                                  }), null, 16, [\"disabled\", \"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Show graph\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-chart-line\",\n                                    disabled: !(dataset.samples || dataset.plotlyDatasets),\n                                    variant: \"plain\",\n                                    onClick: () => openGraphs.value[dataset.id] = true\n                                  }), null, 16, [\"disabled\", \"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              (dataset.timeRange.type === 'pattern' || dataset.timeRange.type === 'daterange' || dataset.timeRange.type === 'monthrange')\n                                ? (_openBlock(), _createBlock(_component_v_tooltip, {\n                                    key: 0,\n                                    text: \"Aggregate Data\",\n                                    location: \"top\"\n                                  }, {\n                                    activator: _withCtx(({ props }) => [\n                                      _createVNode(_component_v_btn, _mergeProps(props, {\n                                        size: \"x-small\",\n                                        icon: \"mdi-chart-box\",\n                                        disabled: !dataset.samples,\n                                        variant: \"plain\",\n                                        onClick: () => openAggregationDialog(dataset)\n                                      }), null, 16, [\"disabled\", \"onClick\"])\n                                    ]),\n                                    _: 2\n                                  }, 1024))\n                                : _createCommentVNode(\"\", true),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Edit Dataset Name/Color\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-pencil\",\n                                    variant: \"plain\",\n                                    onClick: () => handleEditDataset(dataset)\n                                  }), null, 16, [\"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Remove selection\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-trash-can\",\n                                    variant: \"plain\",\n                                    onClick: () => removeDataset(dataset)\n                                  }), null, 16, [\"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024)\n                            ], 512), [\n                              [_vShow, (dataset.samples || dataset.plotlyDatasets) && (_unref(touchscreen) ? openSelection.value == dataset.id : isHovering)]\n                            ])\n                          ]),\n                          _: 2\n                        }, 1024),\n                        _createVNode(_component_cds_dialog, {\n                          title: graphTitle(dataset),\n                          modelValue: openGraphs.value[dataset.id],\n                          \"onUpdate:modelValue\": ($event: any) => ((openGraphs.value[dataset.id]) = $event),\n                          \"title-color\": \"#F44336\",\n                          draggable: \"\",\n                          persistent: \"\",\n                          scrim: false,\n                          modal: false,\n                          \"drag-predicate\": plotlyDragPredicate\n                        }, {\n                          default: _withCtx(() => [\n                            _createVNode(_component_v_checkbox, {\n                              modelValue: showErrorBands.value,\n                              \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((showErrorBands).value = $event)),\n                              label: \"Show Errors\",\n                              density: \"compact\",\n                              \"hide-details\": \"\"\n                            }, null, 8, [\"modelValue\"]),\n                            (dataset.timeRange.type === 'folded' && dataset.plotlyDatasets)\n                              ? (_openBlock(), _createBlock(FoldedPlotlyGraph, {\n                                  key: 0,\n                                  datasets: dataset.plotlyDatasets,\n                                  \"show-errors\": showErrorBands.value,\n                                  colors: [dataset.customColor ?? dataset.region.color, '#333'],\n                                  \"data-options\": [{mode: 'markers'}, {mode: 'lines+markers'}],\n                                  names: [`Original Data`, `Binned`],\n                                  \"layout-options\": {width: 600, height: 400},\n                                  \"fold-type\": dataset.folded?.foldType,\n                                  timezones: dataset.folded?.timezone\n                                }, null, 8, [\"datasets\", \"show-errors\", \"colors\", \"fold-type\", \"timezones\"]))\n                              : (_openBlock(), _createBlock(PlotlyGraph, {\n                                  key: 1,\n                                  datasets: dataset ? [_unref(userDatasetToPlotly)(dataset, true)] : [],\n                                  colors: [dataset.customColor || dataset.region.color],\n                                  \"show-errors\": \"\",\n                                  \"data-options\": [{mode: 'lines+markers'}],\n                                  names: dataset.name ? [dataset.name] : undefined,\n                                  \"layout-options\": {\n                            width: 600, \n                            height: 400,\n                            // https://plotly.com/javascript/reference/layout/xaxis/#layout-xaxis-title-text\n                            xaxis: {title: {text: 'Local Time for Region'}},\n                            }\n                                }, null, 8, [\"datasets\", \"colors\", \"names\"]))\n                          ]),\n                          _: 2\n                        }, 1032, [\"title\", \"modelValue\", \"onUpdate:modelValue\"]),\n                        _createVNode(_component_v_dialog, {\n                          \"model-value\": sampleErrorID.value !== null,\n                          \"max-width\": \"50%\"\n                        }, {\n                          default: _withCtx(() => [\n                            _createVNode(_component_v_card, null, {\n                              default: _withCtx(() => [\n                                _createVNode(_component_v_toolbar, { density: \"compact\" }, {\n                                  default: _withCtx(() => [\n                                    _createVNode(_component_v_toolbar_title, { text: \"Error Loading Data\" }),\n                                    _createVNode(_component_v_spacer),\n                                    _createVNode(_component_v_btn, {\n                                      icon: \"mdi-close\",\n                                      onClick: _cache[9] || (_cache[9] = ($event: any) => (sampleErrorID.value = null))\n                                    })\n                                  ]),\n                                  _: 1\n                                }),\n                                _createVNode(_component_v_card_text, null, {\n                                  default: _withCtx(() => [...(_cache[48] || (_cache[48] = [\n                                    _createTextVNode(\" There was an error loading data for this selection. Either there is no data for the region/time range/molecule combination that you selected, or there was an error loading data from the server. You can delete this selection and try making a new one. \", -1)\n                                  ]))]),\n                                  _: 1\n                                })\n                              ]),\n                              _: 1\n                            })\n                          ]),\n                          _: 1\n                        }, 8, [\"model-value\"])\n                      ]),\n                      _: 1\n                    }, 8, [\"datasets\", \"turn-on-selection\", \"selected-datasets\"])\n                  ]))\n                : _createCommentVNode(\"\", true),\n              (_unref(datasets).some(s => s.timeRange.type === 'folded'))\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \" Note: You can only overlay datasets with the same molecule and fold type. \"))\n                : _createCommentVNode(\"\", true),\n              _createVNode(_component_v_btn, {\n                color: \"#ffcc33\",\n                size: \"small\",\n                block: false,\n                onClick: _cache[11] || (_cache[11] = ($event: any) => (allDatasetSelection.value = !allDatasetSelection.value))\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(_toDisplayString(allDatasetSelection.value ? 'Cancel Selection' : 'Select Datasets to Graph'), 1)\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_11, [\n      (no2GraphData.value.length > 0)\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 0,\n            onClick: _cache[13] || (_cache[13] = ($event: any) => (showNO2Graph.value = true))\n          }, {\n            default: _withCtx(() => [...(_cache[51] || (_cache[51] = [\n              _createTextVNode(\" Show NO Graph \", -1)\n            ]))]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_cds_dialog, {\n        title: \"Nitrogen Dioxide Data\",\n        modelValue: showNO2Graph.value,\n        \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event: any) => ((showNO2Graph).value = $event)),\n        draggable: \"\",\n        persistent: \"\",\n        modal: false,\n        scrim: false,\n        \"drag-predicate\": plotlyDragPredicate\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_checkbox, {\n            modelValue: showErrorBands.value,\n            \"onUpdate:modelValue\": _cache[14] || (_cache[14] = ($event: any) => ((showErrorBands).value = $event)),\n            label: \"Show Errors\",\n            density: \"compact\",\n            \"hide-details\": \"\"\n          }, null, 8, [\"modelValue\"]),\n          _createVNode(PlotlyGraph, {\n            datasets: no2GraphData.value.map(d => _unref(userDatasetToPlotly)(d, true)),\n            colors: no2GraphData.value.map(d => d.customColor || d.region.color),\n            \"show-errors\": showErrorBands.value,\n            \"data-options\": no2GraphData.value.map(() => ({mode: 'lines+markers'})),\n            names: no2GraphData.value.map(d => d.name ?? ''),\n            \"layout-options\": {\n          width: 600, \n          height: 400,\n          xaxis: {title: {text: 'Local Time for Region'}},\n        }\n          }, null, 8, [\"datasets\", \"colors\", \"show-errors\", \"data-options\", \"names\"])\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"]),\n      (o3GraphData.value.length > 0)\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 1,\n            onClick: _cache[16] || (_cache[16] = ($event: any) => (showO3Graph.value = true))\n          }, {\n            default: _withCtx(() => [...(_cache[52] || (_cache[52] = [\n              _createTextVNode(\" Show Ozone Graph \", -1)\n            ]))]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_cds_dialog, {\n        title: \"Ozone Data\",\n        modelValue: showO3Graph.value,\n        \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event: any) => ((showO3Graph).value = $event)),\n        draggable: \"\",\n        persistent: \"\",\n        modal: false,\n        scrim: false,\n        \"drag-predicate\": plotlyDragPredicate\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_checkbox, {\n            modelValue: showErrorBands.value,\n            \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event: any) => ((showErrorBands).value = $event)),\n            label: \"Show Errors\",\n            density: \"compact\",\n            \"hide-details\": \"\"\n          }, null, 8, [\"modelValue\"]),\n          _createVNode(PlotlyGraph, {\n            datasets: o3GraphData.value.map(d => _unref(userDatasetToPlotly)(d, true)),\n            colors: o3GraphData.value.map(d => d.customColor || d.region.color),\n            \"show-errors\": showErrorBands.value,\n            \"data-options\": o3GraphData.value.map(() => ({mode: 'lines+markers'})),\n            names: o3GraphData.value.map(d => d.name ?? ''),\n            \"layout-options\": {\n          width: 600, \n          height: 400,\n          xaxis: {title: {text: 'Local Time for Region'}},\n        }\n          }, null, 8, [\"datasets\", \"colors\", \"show-errors\", \"data-options\", \"names\"])\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"]),\n      (hchoGraphData.value.length > 0)\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 2,\n            onClick: _cache[19] || (_cache[19] = ($event: any) => (showHCHOGraph.value = true))\n          }, {\n            default: _withCtx(() => [...(_cache[53] || (_cache[53] = [\n              _createTextVNode(\" Show Formaldehyde Graph \", -1)\n            ]))]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_cds_dialog, {\n        title: \"Formaldehyde Data\",\n        modelValue: showHCHOGraph.value,\n        \"onUpdate:modelValue\": _cache[21] || (_cache[21] = ($event: any) => ((showHCHOGraph).value = $event)),\n        draggable: \"\",\n        persistent: \"\",\n        modal: false,\n        scrim: false,\n        \"drag-predicate\": plotlyDragPredicate\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_checkbox, {\n            modelValue: showErrorBands.value,\n            \"onUpdate:modelValue\": _cache[20] || (_cache[20] = ($event: any) => ((showErrorBands).value = $event)),\n            label: \"Show Errors\",\n            density: \"compact\",\n            \"hide-details\": \"\"\n          }, null, 8, [\"modelValue\"]),\n          _createVNode(PlotlyGraph, {\n            datasets: hchoGraphData.value.map(d => _unref(userDatasetToPlotly)(d, true)),\n            colors: hchoGraphData.value.map(d => d.customColor || d.region.color),\n            \"show-errors\": showErrorBands.value,\n            \"data-options\": hchoGraphData.value.map(() => ({mode: 'lines+markers'})),\n            names: hchoGraphData.value.map(d => d.name ?? ''),\n            \"layout-options\": {\n          width: 600, \n          height: 400,\n          xaxis: {title: {text: 'Local Time for Region'}},\n        }\n          }, null, 8, [\"datasets\", \"colors\", \"show-errors\", \"data-options\", \"names\"])\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"]),\n      (!_unref(allEqual)(no2foldedGraphData.value.map(v => v.foldType)) || \n            !_unref(allEqual)(o3foldedGraphData.value.map(v => v.foldType)) || \n            !_unref(allEqual)(hchofoldedGraphData.value.map(v => v.foldType)))\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \" Warning: Be sure to only select datasets that have the same type of fold. It is not possible to overlay different FoldTypes. \"))\n        : _createCommentVNode(\"\", true),\n      (no2foldedGraphData.value.length > 0)\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 4,\n            onClick: _cache[22] || (_cache[22] = ($event: any) => (showfoldedNO2Graph.value = true))\n          }, {\n            default: _withCtx(() => [...(_cache[54] || (_cache[54] = [\n              _createTextVNode(\" Show Folded NO Data \", -1)\n            ]))]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_cds_dialog, {\n        title: \"Nitrogen Dioxide Data\",\n        modelValue: showfoldedNO2Graph.value,\n        \"onUpdate:modelValue\": _cache[24] || (_cache[24] = ($event: any) => ((showfoldedNO2Graph).value = $event)),\n        draggable: \"\",\n        persistent: \"\",\n        modal: false,\n        scrim: false,\n        \"drag-predicate\": plotlyDragPredicate\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_checkbox, {\n            modelValue: showErrorBands.value,\n            \"onUpdate:modelValue\": _cache[23] || (_cache[23] = ($event: any) => ((showErrorBands).value = $event)),\n            label: \"Show Errors\",\n            density: \"compact\",\n            \"hide-details\": \"\"\n          }, null, 8, [\"modelValue\"]),\n          _createVNode(FoldedPlotlyGraph, {\n            datasets: no2foldedGraphData.value.length > 0 ? no2foldedGraphData.value : [],\n            \"show-errors\": showErrorBands.value,\n            colors: no2foldedGraphData.value.map( v => v.color) ?? ['#FF5733', '#333'],\n            \"data-options\": [{mode: 'lines+markers'}, {mode: 'lines+markers'}],\n            \"layout-options\": {width: 600, height: 400},\n            \"fold-type\": no2foldedGraphData.value[0].foldType,\n            timezones: no2foldedGraphData.value.map(v => v.timezone) ?? 'UTC'\n          }, null, 8, [\"datasets\", \"show-errors\", \"colors\", \"fold-type\", \"timezones\"])\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"]),\n      (o3foldedGraphData.value.length > 0)\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 5,\n            onClick: _cache[25] || (_cache[25] = ($event: any) => (showfoldedO3Graph.value = true))\n          }, {\n            default: _withCtx(() => [...(_cache[55] || (_cache[55] = [\n              _createTextVNode(\" Show Folded O Data \", -1)\n            ]))]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_cds_dialog, {\n        title: \"Ozone Data\",\n        modelValue: showfoldedO3Graph.value,\n        \"onUpdate:modelValue\": _cache[27] || (_cache[27] = ($event: any) => ((showfoldedO3Graph).value = $event)),\n        draggable: \"\",\n        persistent: \"\",\n        modal: false,\n        scrim: false,\n        \"drag-predicate\": plotlyDragPredicate\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_checkbox, {\n            modelValue: showErrorBands.value,\n            \"onUpdate:modelValue\": _cache[26] || (_cache[26] = ($event: any) => ((showErrorBands).value = $event)),\n            label: \"Show Errors\",\n            density: \"compact\",\n            \"hide-details\": \"\"\n          }, null, 8, [\"modelValue\"]),\n          _createVNode(FoldedPlotlyGraph, {\n            datasets: o3foldedGraphData.value.length > 0 ? o3foldedGraphData.value : [],\n            \"show-errors\": showErrorBands.value,\n            colors: o3foldedGraphData.value.map( v => v.color) ?? ['#FF5733', '#333'],\n            \"data-options\": [{mode: 'lines+markers'}, {mode: 'lines+markers'}],\n            \"layout-options\": {width: 600, height: 400},\n            \"fold-type\": o3foldedGraphData.value[0].foldType,\n            timezones: o3foldedGraphData.value.map(v => v.timezone) ?? 'UTC'\n          }, null, 8, [\"datasets\", \"show-errors\", \"colors\", \"fold-type\", \"timezones\"])\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"]),\n      (hchofoldedGraphData.value.length > 0)\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 6,\n            onClick: _cache[28] || (_cache[28] = ($event: any) => (showfoldedHCHOGraph.value = true))\n          }, {\n            default: _withCtx(() => [...(_cache[56] || (_cache[56] = [\n              _createTextVNode(\" Show Folded HCHO Data \", -1)\n            ]))]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_cds_dialog, {\n        title: \"Formaldehyde Data\",\n        modelValue: showfoldedHCHOGraph.value,\n        \"onUpdate:modelValue\": _cache[30] || (_cache[30] = ($event: any) => ((showfoldedHCHOGraph).value = $event)),\n        draggable: \"\",\n        persistent: \"\",\n        modal: false,\n        scrim: false,\n        \"drag-predicate\": plotlyDragPredicate\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_checkbox, {\n            modelValue: showErrorBands.value,\n            \"onUpdate:modelValue\": _cache[29] || (_cache[29] = ($event: any) => ((showErrorBands).value = $event)),\n            label: \"Show Errors\",\n            density: \"compact\",\n            \"hide-details\": \"\"\n          }, null, 8, [\"modelValue\"]),\n          _createVNode(FoldedPlotlyGraph, {\n            datasets: hchofoldedGraphData.value.length > 0 ? hchofoldedGraphData.value : [],\n            \"show-errors\": showErrorBands.value,\n            colors: hchofoldedGraphData.value.map( v => v.color) ?? ['#FF5733', '#333'],\n            \"data-options\": [{mode: 'lines+markers'}, {mode: 'lines+markers'}],\n            \"layout-options\": {width: 600, height: 400},\n            \"fold-type\": hchofoldedGraphData.value[0].foldType,\n            timezones: hchofoldedGraphData.value.map(v => v.timezone) ?? 'UTC'\n          }, null, 8, [\"datasets\", \"show-errors\", \"colors\", \"fold-type\", \"timezones\"])\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"])\n    ]),\n    _createVNode(_component_v_dialog, {\n      modelValue: showEditRegionNameDialog.value,\n      \"onUpdate:modelValue\": _cache[33] || (_cache[33] = ($event: any) => ((showEditRegionNameDialog).value = $event))\n    }, {\n      default: _withCtx(() => [\n        _createVNode(CTextField, {\n          label: \"Region Name\",\n          title: \"Enter a new name for this region\",\n          \"hide-details\": \"\",\n          dense: \"\",\n          \"button-color\": _unref(accentColor),\n          onConfirm: _cache[31] || (_cache[31] = (name) => {\n            if (regionBeingEdited.value) {\n              _unref(store).setRegionName(regionBeingEdited.value as UnifiedRegionType, name);\n              showEditRegionNameDialog.value = false;\n            }\n          }),\n          onCancel: _cache[32] || (_cache[32] = () => {\n            showEditRegionNameDialog.value = false;\n            regionBeingEdited.value = null;\n          })\n        }, null, 8, [\"button-color\"])\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createVNode(_component_v_dialog, {\n      modelValue: showDatasetEditor.value,\n      \"onUpdate:modelValue\": _cache[36] || (_cache[36] = ($event: any) => ((showDatasetEditor).value = $event))\n    }, {\n      default: _withCtx(() => [\n        (currentlyEditingDataset.value !== null)\n          ? (_openBlock(), _createBlock(UserDatasetEditor, {\n              key: 0,\n              modelValue: currentlyEditingDataset.value,\n              \"onUpdate:modelValue\": _cache[34] || (_cache[34] = ($event: any) => ((currentlyEditingDataset).value = $event)),\n              \"name-only\": datasetEditorNameOnly.value,\n              onComplete: _cache[35] || (_cache[35] = () => {\n            showDatasetEditor.value = false;\n            currentlyEditingDataset.value = null;\n          })\n            }, null, 8, [\"modelValue\", \"name-only\"]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createVNode(AdvancedOperations, {\n      modelValue: showAggregationDialog.value,\n      \"onUpdate:modelValue\": _cache[37] || (_cache[37] = ($event: any) => ((showAggregationDialog).value = $event)),\n      selection: aggregationDataset.value,\n      onSave: handleAggregationSaved\n    }, null, 8, [\"modelValue\", \"selection\"]),\n    _createVNode(_component_v_dialog, {\n      modelValue: showUserDatasetTable.value,\n      \"onUpdate:modelValue\": _cache[39] || (_cache[39] = ($event: any) => ((showUserDatasetTable).value = $event)),\n      \"max-width\": \"800px\",\n      persistent: \"\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_card, null, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_toolbar, { density: \"compact\" }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_toolbar_title, { text: \"Dataset Table View\" }),\n                _createVNode(_component_v_spacer),\n                _createVNode(_component_v_btn, {\n                  icon: \"mdi-close\",\n                  onClick: _cache[38] || (_cache[38] = ($event: any) => {showUserDatasetTable.value = false; tableSelection.value = null})\n                })\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_v_card_text, null, {\n              default: _withCtx(() => [\n                (tableSelection.value !== null)\n                  ? (_openBlock(), _createBlock(UserDatasetTable, {\n                      key: 0,\n                      dataset: tableSelection.value\n                    }, null, 8, [\"dataset\"]))\n                  : _createCommentVNode(\"\", true)\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"])\n  ], 4))\n}\n}\n\n})","<template>\n  <div id=\"dataset-sections\" :style=\"cssVars\">\n    <h2>Investigate Patterns with Time</h2>\n    <v-btn\n      v-if=\"regions.length > 0 || timeRanges.length > 1\"\n      :color=\"accentColor2\"\n      @click=\"showConfirmReset = true\"\n    >\n      Delete ALL selections\n    </v-btn>\n    <v-dialog\n      v-model=\"showConfirmReset\"\n      max-width=\"35%\"\n    >\n      <v-card>\n        <v-card-text>\n          Are you sure you want to delete all of your selections? \n          This will remove all of your regions, time ranges, \n          and datasets, and cannot be undone.\n        </v-card-text>\n        <v-card-actions>\n          <v-btn\n            color=\"error\"\n            @click=\"showConfirmReset = false\"\n          >\n            No\n          </v-btn>\n          <v-btn\n            color=\"success\"\n            @click=\"() => {\n              store.reset();\n              serializeTempoStore(store);\n              showConfirmReset = false;\n            }\"\n          >\n            Yes\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n    <div id=\"add-region-time\">\n      <p>\n        Select a Region, Time Range, and Molecule to create a dataset of your choice!\n      </p>\n      <v-expansion-panels\n        v-model=\"openPanels\"\n        variant=\"accordion\"\n        id=\"user-options-panels\"\n        multiple\n        class=\"pl-3\"\n      > \n        <v-expansion-panel\n          title=\"Regions\"\n          class=\"mt-3 h3-panel-titles\"\n        >\n          <template #text>\n            <div id=\"add-region-buttons\">\n              <v-btn\n                size=\"small\"\n                :active=\"selectionActive === 'rectangle'\"\n                :disabled=\"selectionActive === 'point'\"\n                :color=\"accentColor2\"\n                @click=\"() => {\n                  selectionActive = (selectionActive === 'rectangle') ? null : 'rectangle';\n                }\"\n              >\n                <template #prepend>\n                  <v-icon v-if=\"selectionActive !== 'rectangle'\" icon=\"mdi-plus\"></v-icon>\n                </template>\n                {{ selectionActive === 'rectangle' ? \"Cancel\" : \"New Region\" }}\n              </v-btn>\n            </div>\n            <v-checkbox\n              v-model=\"showSamplingPreviewMarkers\"\n              label=\"Show sample points\"\n              density=\"compact\"\n              hide-details\n            ></v-checkbox>\n            <div class=\"my-selections\" v-if=\"regions.length>0\" style=\"margin-top: 1em;\">\n            <h4>My Regions</h4>                   \n              <v-list>\n                <v-list-item\n                  v-for=\"(region, index) in regions\"\n                  :key=\"index\"\n                  :title=\"region.name\"\n                  :style=\"{ 'background-color': region.color }\"\n                  @click=\"() => focusRegion = region\"\n                >\n                  <template #append>\n                    <!-- New: Edit Geometry button (disabled if any selection using region has samples) -->\n                    <!-- <v-btn\n                      variant=\"plain\"\n                      :icon=\"region.geometryType === 'rectangle' ? 'mdi-select' : 'mdi-plus'\"\n                      color=\"white\"\n                      :disabled=\"regionHasSamples(region as UnifiedRegionType)\"\n                      v-tooltip=\"regionHasSamples(region as UnifiedRegionType) ? 'Cannot edit geometry after samples are fetched for a selection using this region' : 'Edit Geometry'\"\n                      @click=\"() => editRegionGeometry(region as UnifiedRegionType)\"\n                    ></v-btn> -->\n                    <v-btn\n                      variant=\"plain\"\n                      v-tooltip=\"'Edit Name'\"\n                      icon=\"mdi-pencil\"\n                      color=\"white\"\n                      @click=\"(event: MouseEvent | KeyboardEvent) => {\n                        editRegionName(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\"\n                    ></v-btn>\n                    <v-btn\n                      v-if=\"!store.regionHasDatasets(region as UnifiedRegionType)\"\n                      variant=\"plain\"\n                      v-tooltip=\"'Delete'\"\n                      icon=\"mdi-delete\"\n                      color=\"white\"\n                      @click=\"(event: MouseEvent | KeyboardEvent) => {\n                        store.deleteRegion(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\"\n                    ></v-btn>\n                  </template>\n                </v-list-item>\n              </v-list>\n            </div>\n          </template>\n        </v-expansion-panel>\n        <v-expansion-panel\n          title=\"Time Ranges\"\n          class=\"mt-3 h3-panel-titles\"\n        >\n          <template #text>\n            <v-btn\n              size=\"small\"\n              :active=\"createTimeRangeActive\"\n              :color=\"accentColor2\"\n              @click=\"createTimeRangeActive = !createTimeRangeActive\"\n            >\n              <template #prepend>\n                <v-icon v-if=\"!createTimeRangeActive\" icon=\"mdi-plus\"></v-icon>\n              </template>\n              {{ createTimeRangeActive ? \"Cancel\" : \"New Time Range\" }}\n            </v-btn>\n            <date-time-range-selection\n              v-if=\"createTimeRangeActive\"\n              :current-date=\"singleDateSelected\"\n              :allowed-dates=\"uniqueDays\"\n              @ranges-change=\"handleDateTimeRangeSelectionChange\"\n            />\n            <div class=\"my-selections\" v-if=\"timeRanges.length>0\" style=\"margin-top: 1em;\">\n              <h4>My Time Ranges</h4>\n              <v-list>\n                <v-list-item\n                  v-for=\"(timeRange, index) in timeRanges\"\n                  :key=\"index\"\n                  :title=\"timeRange.name === 'Displayed Day' ? `Displayed Day: ${ formatTimeRange(timeRange.range) }` : (timeRange.name ?? formatTimeRange(timeRange.range))\"\n                  style=\"background-color: #444444\"\n                >\n\n                  <template #append>\n                    <v-btn\n                      v-if=\"timeRange.id !== 'displayed-day' && !datasets.some(s => areEquivalentTimeRanges(s.timeRange, timeRange))\"\n                      variant=\"plain\"\n                      v-tooltip=\"'Delete'\"\n                      icon=\"mdi-delete\"\n                      color=\"white\"\n                      @click=\"() => store.deleteTimeRange(timeRange)\"\n                    >\n                    </v-btn>\n                  </template>\n                </v-list-item>\n              </v-list>\n            </div>\n          </template>\n        </v-expansion-panel>\n\n        <v-divider\n          class=\"mt-3\"\n          opacity=\"1\"\n        >\n        </v-divider>\n\n        <v-expansion-panel\n          title=\"Datasets\"\n          class=\"mt-3 h3-panel-titles\"\n        >\n        <template #text>\n          <v-btn\n            size=\"small\"\n            :active=\"createDatasetActive\"\n            :color=\"accentColor2\"                    \n            @click=\"createDatasetActive = !createDatasetActive\"\n            class=\"mt-3\"\n          >\n            <template #prepend>\n              <v-icon v-if=\"!createDatasetActive\" icon=\"mdi-plus\"></v-icon>\n            </template>\n            {{ createDatasetActive ? \"Cancel\" : \"New Dataset\" }}\n          </v-btn>\n          <selection-composer\n            v-show=\"createDatasetActive\"\n            :backend=\"backend\"\n            :time-ranges=\"timeRanges\"\n            :regions=\"regions\"\n            :disabled=\"{ region: selectionActive === 'rectangle', point: selectionActive === 'point', timeRange: createTimeRangeActive }\"\n            @create=\"handleDatasetCreated\"\n          >\n          </selection-composer>\n          <div class=\"my-selections\" v-if=\"datasets.length>0\" style=\"margin-top: 1em;\">\n\n            <h4>My Datasets</h4>\n            \n            <dataset-card\n              :datasets=\"datasets\"\n              :turn-on-selection=\"allDatasetSelection\"\n              v-model:selected-datasets=\"selectedDatasets\"\n            >\n              <template #action-row=\"{ isHovering, dataset }\">\n                    <div\n                      v-if=\"(dataset.loading || !dataset.samples)  && !(dataset.timeRange?.type === 'folded' && dataset.plotlyDatasets)\"\n                      class=\"dataset-loading\"\n                    >\n                      <hr/>\n                      <v-progress-linear\n                        :class=\"['dataset-loading-progress', !(dataset.loading && dataset.samples) ? 'dataset-loading-failed' : '']\"\n                        :active=\"dataset.loading || !dataset.samples\"\n                        :color=\"dataset.loading ? 'primary' : 'red'\"\n                        :indeterminate=\"dataset.loading\"\n                        :value=\"!dataset.loading ? 100 : 0\"\n                        :striped=\"!dataset.loading\"\n                        bottom\n                        rounded\n                        height=\"20\"\n                      >\n                        <template #default>\n                          <span class=\"text-subtitle-2\">\n                            {{ dataset.loading ? 'Data Loading' : (!dataset.samples ? 'Error Loading Data' : '') }}\n                          </span>\n                        </template>\n                      </v-progress-linear>\n                      <v-tooltip\n                        text=\"Remove selection\"\n                        location=\"top\"\n                      >\n                        <template #activator=\"{ props }\">\n                          <v-btn\n                            v-bind=\"props\"\n                            size=\"x-small\"\n                            icon=\"mdi-trash-can\"\n                            variant=\"plain\"\n                            @click=\"() => removeDataset(dataset)\"\n                          ></v-btn>\n                        </template>\n                      </v-tooltip>\n                      <div v-if=\"!(dataset.loading || dataset.samples || dataset.plotlyDatasets)\">\n                        <hr/>\n                        <v-tooltip\n                          text=\"Failure info\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-help-circle\"\n                              variant=\"plain\"\n                              @click=\"() => sampleErrorID = dataset.id\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          text=\"Remove selection\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-trash-can\"\n                              variant=\"plain\"\n                              @click=\"() => removeDataset(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                      </div>\n                    </div>\n\n                    <v-expand-transition>\n                      <div\n                        class=\"selection-icons\"\n                        v-show=\"(dataset.samples || dataset.plotlyDatasets) && (touchscreen ? openSelection == dataset.id : isHovering)\"\n                      >\n                        <v-tooltip\n                          text=\"Get Center Point Sample\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              :loading=\"loadingPointSample === dataset.id\"\n                              icon=\"mdi-image-filter-center-focus\"\n                              variant=\"plain\"\n                              @click=\"() => store.fetchCenterPointDataForDataset(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip> \n                        <v-tooltip\n                          text=\"Show table\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-table\"\n                              :disabled=\"!dataset.samples && !dataset.folded\"\n                              variant=\"plain\"\n                              @click=\"() => tableSelection = dataset\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          text=\"Show graph\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-chart-line\"\n                              :disabled=\"!(dataset.samples || dataset.plotlyDatasets)\"\n                              variant=\"plain\"\n                              @click=\"() => openGraphs[dataset.id] = true\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          v-if=\"dataset.timeRange.type === 'pattern' || dataset.timeRange.type === 'daterange' || dataset.timeRange.type === 'monthrange'\"\n                          text=\"Aggregate Data\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-chart-box\"\n                              :disabled=\"!dataset.samples\"\n                              variant=\"plain\"\n                              @click=\"() => openAggregationDialog(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          text=\"Edit Dataset Name/Color\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-pencil\"\n                              variant=\"plain\"\n                              @click=\"() => handleEditDataset(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          text=\"Remove selection\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-trash-can\"\n                              variant=\"plain\"\n                              @click=\"() => removeDataset(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                      </div>\n                    </v-expand-transition>\n                    <cds-dialog\n                      :title=\"graphTitle(dataset)\"\n                      v-model=\"openGraphs[dataset.id]\"\n                      title-color=\"#F44336\"\n                      draggable\n                      persistent\n                      :scrim=\"false\"\n                      :modal=\"false\"\n                      :drag-predicate=\"plotlyDragPredicate\"\n                    >\n                      <v-checkbox\n                        v-model=\"showErrorBands\"\n                        label=\"Show Errors\"\n                        density=\"compact\"\n                        hide-details\n                      >\n                      </v-checkbox>\n                      <template v-if=\"dataset.timeRange.type === 'folded' && dataset.plotlyDatasets\">\n                        <folded-plotly-graph\n                          :datasets=\"dataset.plotlyDatasets\"\n                          :show-errors=\"showErrorBands\"\n                          :colors=\"[dataset.customColor ?? dataset.region.color, '#333']\"\n                          :data-options=\"[{mode: 'markers'}, {mode: 'lines+markers'}]\"\n                          :names=\"[`Original Data`, `Binned`]\"\n                          :layout-options=\"{width: 600, height: 400}\"\n                          :fold-type=\"dataset.folded?.foldType\"\n                          :timezones=\"dataset.folded?.timezone\"\n                        />\n                      </template>\n                      <template v-else>\n                        <plotly-graph\n                          :datasets=\"dataset ? [userDatasetToPlotly(dataset, true)] : []\"\n                          :colors=\"[dataset.customColor || dataset.region.color]\"\n                          show-errors\n                          :data-options=\"[{mode: 'lines+markers'}]\"\n                          :names=\"dataset.name ? [dataset.name] : undefined\"\n                          :layout-options=\"{\n                            width: 600, \n                            height: 400,\n                            // https://plotly.com/javascript/reference/layout/xaxis/#layout-xaxis-title-text\n                            xaxis: {title: {text: 'Local Time for Region'}},\n                            }\"\n                        />\n                          \n                      </template>\n                    </cds-dialog>\n                    <v-dialog\n                      :model-value=\"sampleErrorID !== null\"\n                      max-width=\"50%\"\n                    >\n                      <v-card>\n                        <v-toolbar\n                          density=\"compact\"\n                        >\n                          <v-toolbar-title text=\"Error Loading Data\"></v-toolbar-title>\n                          <v-spacer></v-spacer>\n                          <v-btn\n                            icon=\"mdi-close\"\n                            @click=\"sampleErrorID = null\"\n                          >\n                          </v-btn>\n                        </v-toolbar>\n                        <v-card-text>\n                          There was an error loading data for this selection. Either there is no data for the\n                          region/time range/molecule combination that you selected, or there was an error loading\n                          data from the server. You can delete this selection and try making a new one.\n                        </v-card-text>\n                      </v-card>\n                    </v-dialog>\n                  </template>\n            </dataset-card>\n          </div>\n          <div v-if=\"datasets.some(s => s.timeRange.type === 'folded')\" class=\"pa-2 mb-2 explainer-text\">\n            Note: You can only overlay datasets with the same molecule and fold type.\n          </div>\n          <v-btn color=\"#ffcc33\" size=\"small\" :block=\"false\" @click=\"allDatasetSelection = !allDatasetSelection\">\n            {{ allDatasetSelection ? 'Cancel Selection' : 'Select Datasets to Graph' }}\n          </v-btn>\n        </template>\n      </v-expansion-panel>\n    </v-expansion-panels>\n    </div>\n\n    <div class=\"d-flex flex-wrap flex-row ma-2 align-center justify-center ga-1\">\n    <v-btn v-if=\"no2GraphData.length > 0\" @click=\"showNO2Graph = true\">\n      Show NO Graph\n    </v-btn>\n    <cds-dialog\n      title=\"Nitrogen Dioxide Data\"\n      v-model=\"showNO2Graph\"\n      draggable\n      persistent\n      :modal=\"false\"\n      :scrim=\"false\"\n      :drag-predicate=\"plotlyDragPredicate\"\n    >\n      <v-checkbox\n        v-model=\"showErrorBands\"\n        label=\"Show Errors\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <plotly-graph\n        :datasets=\"no2GraphData.map(d => userDatasetToPlotly(d, true))\"\n        :colors=\"no2GraphData.map(d => d.customColor || d.region.color)\"\n        :show-errors=\"showErrorBands\"\n        :data-options=\"no2GraphData.map(() => ({mode: 'lines+markers'}))\"\n        :names=\"no2GraphData.map(d => d.name ?? '')\"\n        :layout-options=\"{\n          width: 600, \n          height: 400,\n          xaxis: {title: {text: 'Local Time for Region'}},\n        }\"\n      />\n    </cds-dialog>\n\n    <v-btn v-if=\"o3GraphData.length > 0\" @click=\"showO3Graph = true\">\n      Show Ozone Graph\n    </v-btn>\n    <cds-dialog\n      title=\"Ozone Data\"\n      v-model=\"showO3Graph\"\n      draggable\n      persistent\n      :modal=\"false\"\n      :scrim=\"false\"\n      :drag-predicate=\"plotlyDragPredicate\"\n    >\n      <v-checkbox\n        v-model=\"showErrorBands\"\n        label=\"Show Errors\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <plotly-graph\n        :datasets=\"o3GraphData.map(d => userDatasetToPlotly(d, true))\"\n        :colors=\"o3GraphData.map(d => d.customColor || d.region.color)\"\n        :show-errors=\"showErrorBands\"\n        :data-options=\"o3GraphData.map(() => ({mode: 'lines+markers'}))\"\n        :names=\"o3GraphData.map(d => d.name ?? '')\"\n        :layout-options=\"{\n          width: 600, \n          height: 400,\n          xaxis: {title: {text: 'Local Time for Region'}},\n        }\"\n      />\n    </cds-dialog>\n    \n    <v-btn v-if=\"hchoGraphData.length > 0\" @click=\"showHCHOGraph = true\">\n      Show Formaldehyde Graph\n    </v-btn>\n    <cds-dialog\n      title=\"Formaldehyde Data\"\n      v-model=\"showHCHOGraph\"\n      draggable\n      persistent\n      :modal=\"false\"\n      :scrim=\"false\"\n      :drag-predicate=\"plotlyDragPredicate\"\n    >\n      <v-checkbox\n        v-model=\"showErrorBands\"\n        label=\"Show Errors\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <plotly-graph\n        :datasets=\"hchoGraphData.map(d => userDatasetToPlotly(d, true))\"\n        :colors=\"hchoGraphData.map(d => d.customColor || d.region.color)\"\n        :show-errors=\"showErrorBands\"\n        :data-options=\"hchoGraphData.map(() => ({mode: 'lines+markers'}))\"\n        :names=\"hchoGraphData.map(d => d.name ?? '')\"\n        :layout-options=\"{\n          width: 600, \n          height: 400,\n          xaxis: {title: {text: 'Local Time for Region'}},\n        }\"\n      />\n    </cds-dialog>\n    \n    <div \n      v-if=\"!allEqual(no2foldedGraphData.map(v => v.foldType)) || \n            !allEqual(o3foldedGraphData.map(v => v.foldType)) || \n            !allEqual(hchofoldedGraphData.map(v => v.foldType))\"\n      class=\"mixed-foldType-warning pa-2 ma-2 text-large text-red explainer-text\"\n    >\n    Warning: Be sure to only select datasets that have the same type of fold. It is not possible to overlay different FoldTypes.\n    </div>\n    \n    <v-btn v-if=\"no2foldedGraphData.length > 0\" @click=\"showfoldedNO2Graph = true\">\n      Show Folded NO Data\n    </v-btn>\n    <cds-dialog\n      title=\"Nitrogen Dioxide Data\"\n      v-model=\"showfoldedNO2Graph\"\n      draggable\n      persistent\n      :modal=\"false\"\n      :scrim=\"false\"\n      :drag-predicate=\"plotlyDragPredicate\"\n    >\n      <v-checkbox\n        v-model=\"showErrorBands\"\n        label=\"Show Errors\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <folded-plotly-graph\n        :datasets=\"no2foldedGraphData.length > 0 ? no2foldedGraphData : []\"\n        :show-errors=\"showErrorBands\"\n        :colors=\"no2foldedGraphData.map( v => v.color) ?? ['#FF5733', '#333']\"\n        :data-options=\"[{mode: 'lines+markers'}, {mode: 'lines+markers'}]\"\n        :layout-options=\"{width: 600, height: 400}\"\n        :fold-type=\"no2foldedGraphData[0].foldType\"\n        :timezones=\"no2foldedGraphData.map(v => v.timezone) ?? 'UTC'\"\n      />\n    </cds-dialog>\n\n    <v-btn v-if=\"o3foldedGraphData.length > 0\" @click=\"showfoldedO3Graph = true\">\n      Show Folded O Data\n    </v-btn>\n    <cds-dialog\n      title=\"Ozone Data\"\n      v-model=\"showfoldedO3Graph\"\n      draggable\n      persistent\n      :modal=\"false\"\n      :scrim=\"false\"\n      :drag-predicate=\"plotlyDragPredicate\"\n    >\n      <v-checkbox\n        v-model=\"showErrorBands\"\n        label=\"Show Errors\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <folded-plotly-graph\n        :datasets=\"o3foldedGraphData.length > 0 ? o3foldedGraphData : []\"\n        :show-errors=\"showErrorBands\"\n        :colors=\"o3foldedGraphData.map( v => v.color) ?? ['#FF5733', '#333']\"\n        :data-options=\"[{mode: 'lines+markers'}, {mode: 'lines+markers'}]\"\n        :layout-options=\"{width: 600, height: 400}\"\n        :fold-type=\"o3foldedGraphData[0].foldType\"\n        :timezones=\"o3foldedGraphData.map(v => v.timezone) ?? 'UTC'\"\n      />\n    </cds-dialog>\n\n    <v-btn v-if=\"hchofoldedGraphData.length > 0\" @click=\"showfoldedHCHOGraph = true\">\n      Show Folded HCHO Data\n    </v-btn>\n    <cds-dialog\n      title=\"Formaldehyde Data\"\n      v-model=\"showfoldedHCHOGraph\"\n      draggable\n      persistent\n      :modal=\"false\"\n      :scrim=\"false\"\n      :drag-predicate=\"plotlyDragPredicate\"\n    >\n      <v-checkbox\n        v-model=\"showErrorBands\"\n        label=\"Show Errors\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <folded-plotly-graph\n        :datasets=\"hchofoldedGraphData.length > 0 ? hchofoldedGraphData : []\"\n        :show-errors=\"showErrorBands\"\n        :colors=\"hchofoldedGraphData.map( v => v.color) ?? ['#FF5733', '#333']\"\n        :data-options=\"[{mode: 'lines+markers'}, {mode: 'lines+markers'}]\"\n        :layout-options=\"{width: 600, height: 400}\"\n        :fold-type=\"hchofoldedGraphData[0].foldType\"\n        :timezones=\"hchofoldedGraphData.map(v => v.timezone) ?? 'UTC'\"\n      />\n    </cds-dialog>\n    </div>\n\n    <v-dialog\n      v-model=\"showEditRegionNameDialog\"\n    >\n      <!-- text field that requires a confirmation -->\n        <c-text-field\n          label=\"Region Name\"\n          title=\"Enter a new name for this region\"\n          hide-details\n          dense\n          :button-color=\"accentColor\"\n          @confirm=\"(name: string) => {\n            if (regionBeingEdited) {\n              store.setRegionName(regionBeingEdited as UnifiedRegionType, name);\n              showEditRegionNameDialog = false;\n            }\n          }\"\n          @cancel=\"() => {\n            showEditRegionNameDialog = false;\n            regionBeingEdited = null;\n          }\"\n        ></c-text-field>\n\n        </v-dialog>\n        \n      <v-dialog\n        v-model=\"showDatasetEditor\"\n      >\n        <user-dataset-editor\n          v-if=\"currentlyEditingDataset !== null\"\n          v-model=\"currentlyEditingDataset\" \n          :name-only=\"datasetEditorNameOnly\"\n          @complete=\"() => {\n            showDatasetEditor = false;\n            currentlyEditingDataset = null;\n          }\"\n          />\n        </v-dialog>\n        \n    <!-- Data Aggregation Dialog -->\n    <advanced-operations\n      v-model=\"showAggregationDialog\"\n      :selection=\"aggregationDataset\"\n      @save=\"handleAggregationSaved\"\n    />\n    \n    <v-dialog\n      v-model=\"showUserDatasetTable\"\n      max-width=\"800px\"\n      persistent\n    >\n      <v-card>\n        <v-toolbar\n          density=\"compact\"\n        >\n          <v-toolbar-title text=\"Dataset Table View\"></v-toolbar-title>\n          <v-spacer></v-spacer>\n          <v-btn\n            icon=\"mdi-close\"\n            @click=\"showUserDatasetTable = false; tableSelection = null\"\n          >\n          </v-btn>\n        </v-toolbar>\n        <v-card-text>\n          <user-dataset-table\n            v-if=\"tableSelection !== null\"\n            :dataset=\"tableSelection\"\n          />\n        </v-card-text>\n      </v-card>\n    </v-dialog>\n\n  </div>\n\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from \"uuid\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport type { MillisecondRange, TimeRange, UserDataset, UnifiedRegion } from \"../types\";\nimport { serializeTempoStore, useTempoStore } from \"../stores/app\";\nimport { MOLECULE_OPTIONS } from \"../esri/utils\";\nimport { areEquivalentTimeRanges, formatTimeRange } from \"../utils/timeRange\";\nimport { atleast1d } from \"../utils/atleast1d\";\n\nimport DateTimeRangeSelection from \"../date_time_range_selection/DateTimeRangeSelection.vue\";\nimport AdvancedOperations from \"./AdvancedOperations.vue\";\nimport { TimeRangeSelectionType } from \"@/types/datetime\";\nimport PlotlyGraph from \"./plotly/PlotlyGraph.vue\";\nimport FoldedPlotlyGraph from \"./FoldedPlotlyGraph.vue\";\nimport CTextField from \"./CTextField.vue\";\nimport DatasetCard from \"./DatasetCard.vue\";\nimport { toZonedTime } from \"date-fns-tz\";\nimport { allEqual } from \"@/utils/array_operations/array_math\";\nimport { userDatasetToPlotly } from \"@/utils/data_converters\";\nimport UserDatasetTable from \"./UserDatasetTable.vue\";\n\ntype UnifiedRegionType = UnifiedRegion;\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  backend,\n  regions,\n  datasets,\n  timeRanges,\n  singleDateSelected,\n  uniqueDays,\n  selectionActive,\n  focusRegion,\n  showSamplingPreviewMarkers,\n} = storeToRefs(store);\n\nconst cssVars = computed(() => {\n  return {\n    '--accent-color': accentColor.value,\n    '--accent-color-2': accentColor2.value,\n  };\n});\n\nfunction plotlyDragPredicate(element: HTMLElement): boolean {\n  return element.closest(\".plotly\") === null;\n}\n\nconst touchscreen = supportsTouchscreen();\n\nconst openPanels = ref<number[]>([0, 1, 2]);\nconst openGraphs = ref<Record<string,boolean>>({});\nconst openSelection = ref<string | null>(null);\nconst tableSelection = ref<UserDataset | null>(null);\nconst currentlyEditingDataset = ref<UserDataset | null>(null);\nconst showConfirmReset = ref(false);\n\nconst createTimeRangeActive = ref(false);\nconst createDatasetActive = ref(false);\nconst datasetRowRefs = ref({});\nconst sampleErrorID = ref<string | null>(null);\nconst loadingPointSample = ref<string | false>(false);\n\nconst showEditRegionNameDialog = ref(false);\nconst regionBeingEdited = ref<UnifiedRegionType | null>(null);\n\nconst aggregationDataset = ref<UserDataset | null>(null);\nconst showAggregationDialog = ref(false);\nfunction openAggregationDialog(selection: UserDataset) {\n  aggregationDataset.value = selection;\n  showAggregationDialog.value = true;\n}\nfunction handleAggregationSaved(aggregatedSelection: UserDataset) {\n  aggregatedSelection.name = `${aggregatedSelection.name} ${datasets.value.length + 1}`;\n  store.addDataset(aggregatedSelection, false); // no need to fetch anything\n  showAggregationDialog.value = false;\n  aggregationDataset.value = null;\n}\n\nfunction handleDatasetCreated(dataset: UserDataset) {\n  dataset.name = `Dataset ${datasets.value.length + 1}`; // give it a default name\n  store.addDataset(dataset);\n  createDatasetActive.value = false;\n}\n\nimport UserDatasetEditor from \"./UserDatasetEditor.vue\";\nconst showDatasetEditor = ref(false);\nconst datasetEditorNameOnly = ref(false);\nfunction handleEditDataset(dataset: UserDataset, nameOnly = false) {\n  datasetEditorNameOnly.value = nameOnly;\n  currentlyEditingDataset.value = dataset;\n  showDatasetEditor.value = true;\n}\n\nfunction removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\nfunction handleDateTimeRangeSelectionChange(timeRanges: MillisecondRange[], selectionType: TimeRangeSelectionType, customName: string) {\n  if (!Array.isArray(timeRanges) || timeRanges.length === 0) {\n    console.error('No time ranges received from DateTimeRangeSelection');\n    return;\n  }\n  console.log(`Received ${timeRanges.length} time ranges of type ${selectionType} and name ${customName}`);\n  const normalized = atleast1d(timeRanges);\n  // No dedup tracking now\n  const tr: TimeRange = {\n    id: v4(),\n    name: customName,\n    description: customName,\n    range: normalized.length === 1 ? normalized[0] : normalized,\n    type: selectionType,\n  };\n  store.addTimeRange(tr);\n\n  createTimeRangeActive.value = false;\n  console.log(`Registered ${tr.name}: ${tr.description}`);\n}\n\nfunction editRegionName(region: UnifiedRegionType) {\n  console.log(`Editing ${region.geometryType}: ${region.name}`);\n  // Set the region to edit\n\n  // eslint-disable-next-line\n  // @ts-ignore it is not actually deep\n  const existing = (regions.value as UnifiedRegionType[]).find(r => r.id === region.id);\n  if (!existing) {\n    console.error(`Region with ID ${region.id} not found.`);\n    return;\n  }\n  regionBeingEdited.value = region;\n  // Open dialog for renaming\n  showEditRegionNameDialog.value = true;\n}\n\nfunction graphTitle(dataset: UserDataset): string {\n  const molecule = dataset.molecule;\n  const molTitle = MOLECULE_OPTIONS.find(m => m.value === molecule)?.title || '';\n  return `${molTitle} Time Series for ${dataset.region.name}`;\n}\n\nconst showNO2Graph = ref(false);\nconst no2GraphData = computed(() =>{\n  return datasets.value.filter(s => s.molecule.includes('no2') && store.datasetHasSamples(s));\n});\n\n// ozone version\nconst showO3Graph = ref(false);\nconst o3GraphData = computed(() =>{\n  return datasets.value.filter(s => s.molecule.includes('o3') && store.datasetHasSamples(s));\n});\n\n\n// formaldehyde version\nconst showHCHOGraph = ref(false);\nconst hchoGraphData = computed(() =>{\n  return datasets.value.filter(s => s.molecule.includes('hcho') && store.datasetHasSamples(s));\n});\n\nfunction _toZonedTime(date: number | Date | string, timezone): number | Date {\n  if (typeof date === 'number') {\n    date = new Date(date);\n  } else if (typeof date === 'string') {\n    date = new Date(date);\n  }\n  return toZonedTime(date, timezone);\n}\n\nconst allDatasetSelection = ref(false);\nconst selectedDatasets = ref<string[]>([]);\nwatch(allDatasetSelection, (newVal) => {\n  if (!newVal) {\n    selectedDatasets.value = [];\n  }\n});\nwatch(selectedDatasets, (newVal) => {\n  console.log('Selected datasets changed:', newVal);\n});\n\nconst showfoldedNO2Graph = ref(false);\nconst no2foldedGraphData = computed(() =>{\n  const validFoldedDatasets = datasets.value\n    .filter(\n      s => s.molecule.includes('no2') && \n      s.timeRange?.type === 'folded' && \n      s.plotlyDatasets && \n      s.plotlyDatasets.length > 0 &&\n      selectedDatasets.value.includes(s.id)\n    );\n  return validFoldedDatasets.map(s => {    \n    return {\n      ...s.plotlyDatasets![1],\n      foldType: s.folded?.foldType,\n      timezone: s.folded?.timezone,\n      color: s.customColor || s.region.color,\n    };\n  }); // \"!\" tells TS that we know it's not undefined\n});\n\nconst showfoldedO3Graph = ref(false);\nconst o3foldedGraphData = computed(() =>{\n  const validFoldedDatasets = datasets.value\n    .filter(\n      s => s.molecule.includes('o3') && \n      s.timeRange?.type === 'folded' && \n      s.plotlyDatasets && \n      s.plotlyDatasets.length > 0 &&\n      selectedDatasets.value.includes(s.id)\n    );\n  return validFoldedDatasets.map(s => {\n    return {\n      ...s.plotlyDatasets![1],\n      foldType: s.folded?.foldType,\n      timezone: s.folded?.timezone,\n      color: s.customColor || s.region.color,\n    };\n  }); // \"!\" tells TS that we know it's not undefined\n}); \n\nconst showfoldedHCHOGraph = ref(false);\nconst hchofoldedGraphData = computed(() =>{\n  const validFoldedDatasets = datasets.value\n    .filter(\n      s => s.molecule.includes('hcho') && \n      s.timeRange?.type === 'folded' && \n      s.plotlyDatasets && \n      s.plotlyDatasets.length > 0 &&\n      selectedDatasets.value.includes(s.id)\n    );\n  return validFoldedDatasets.map(s => {\n    return {\n      ...s.plotlyDatasets![1],\n      foldType: s.folded?.foldType,\n      timezone: s.folded?.timezone,\n      color: s.customColor || s.region.color,\n    };\n  }); // \"!\" tells TS that we know it's not undefined\n}); \n\nconst showErrorBands = ref(true);\n\nconst showUserDatasetTable = ref(false);\nwatch(tableSelection, (newVal) => {\n  if (newVal) {\n    console.log('Table selection changed:', newVal);\n    showUserDatasetTable.value = true;\n  }\n});\n\n</script>\n\n<style scoped lang=\"less\">\n// prevent overflows of the content\n#add-region-time {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  gap: 5px;\n}\n\n.my-selections {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  gap: 5px;\n  padding: 0.5rem;\n  border-radius: 10px;\n  // background-color: #555555;\n}\n\n.h3-panel-titles .v-expansion-panel-title {\n  font-size: 1.17em;\n  font-weight: bold;\n}\n\n.explainer-text {\n  border-radius: 5px;\n  padding: 5px;\n  padding-inline-start: 10px;\n  background-color: rgb(var(--v-theme-background));\n  font-size: 0.8em;\n  color: rgb(var(--v-theme-on-surface));\n  \n}\n\n.explainer-text hr {\n  border: none;\n  border-top: 1px solid rgb(var(--v-theme-on-surface-light));\n  margin-inline: 0;\n  margin-block: 1em;\n}\n\n.explainer-text dt {\n  font-weight: bold;\n}\n\n.explainer-text dd {\n  margin-left: 0;\n  margin-bottom: 8px;\n}\n\n.dataset-loading {\n  display: flex;\n  align-items: center;\n}\n</style>\n","import script from \"./DatasetControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DatasetControls.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DatasetControls.vue?vue&type=style&index=0&id=20c8b2f6&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-20c8b2f6\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, isRef as _isRef } from \"vue\"\n\nconst _hoisted_1 = { class: \"comparison-data-controls\" }\n\nimport { storeToRefs } from \"pinia\";\nimport { useTempoStore } from \"@/stores/app\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'ComparisonDataControls',\n  setup(__props) {\n\nconst store = useTempoStore();\nconst {\n  maps,\n  showFieldOfRegard,\n} = storeToRefs(store);\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_layer_order_control = _resolveComponent(\"layer-order-control\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_power_plants_filter_control = _resolveComponent(\"power-plants-filter-control\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(maps), (map, index) => {\n      return (_openBlock(), _createElementBlock(\"div\", { key: index }, [\n        _createVNode(_component_layer_order_control, {\n          mapRef: map,\n          order: ['power-plants-heatmap', 'aqi-layer-aqi', 'esri-source']\n        }, null, 8, [\"mapRef\"]),\n        _createVNode(_component_v_checkbox, {\n          modelValue: _unref(showFieldOfRegard),\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => (_isRef(showFieldOfRegard) ? (showFieldOfRegard).value = $event : null)),\n          label: \"Show TEMPO field of regard\",\n          density: \"compact\",\n          \"hide-details\": \"\"\n        }, null, 8, [\"modelValue\"]),\n        _createVNode(_component_power_plants_filter_control, {\n          map: map,\n          \"layer-id\": \"power-plants-heatmap\"\n        }, null, 8, [\"map\"])\n      ]))\n    }), 128))\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"comparison-data-controls\">\n    <div\n      v-for=\"(map, index) in maps\"\n      :key=\"index\"\n    >\n      <layer-order-control\n        :mapRef=\"map\"\n        :order=\"['power-plants-heatmap', 'aqi-layer-aqi', 'esri-source']\"\n      >\n      </layer-order-control>\n      <v-checkbox\n        v-model=\"showFieldOfRegard\"\n        label=\"Show TEMPO field of regard\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <power-plants-filter-control\n        :map=\"map\"\n        layer-id=\"power-plants-heatmap\"\n      >\n      </power-plants-filter-control>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { storeToRefs } from \"pinia\";\nimport { useTempoStore } from \"@/stores/app\";\n\nconst store = useTempoStore();\nconst {\n  maps,\n  showFieldOfRegard,\n} = storeToRefs(store);\n</script>\n","import script from \"./ComparisonDataControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ComparisonDataControls.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { computed, toRef, ref, watch, type MaybeRef, onMounted } from \"vue\";\n\nimport { ESRI_URLS, getEsriTimesteps, MoleculeType } from \"../esri/utils\";\n\nconst timestepCache: Record<MoleculeType, number[]> = {};\n\nexport function useEsriTimesteps(initialMolecule: MaybeRef<MoleculeType>, updateOnMount=true) {\n  const molecule = toRef(initialMolecule);\n  const url = computed(() => ESRI_URLS[molecule.value].url);\n  const variable = computed(() => ESRI_URLS[molecule.value].variable);\n  const loadingTimesteps = ref(false);\n  const esriTimesteps = ref<number[]>([]);\n  const error = ref<string | null>(null);\n\n  async function updateEsriTimeSteps(): Promise<void> {\n    if (timestepCache[molecule.value]) {\n      esriTimesteps.value = timestepCache[molecule.value];\n      return;\n    }\n\n    loadingTimesteps.value = true;\n    return getEsriTimesteps(url.value, variable.value)\n      .then(timesteps => {\n        esriTimesteps.value = timesteps;\n      })\n      .catch((err: Error) => {\n        console.error(`Error fetching ESRI time steps: ${err}`);\n        error.value = err.message;\n      });\n  }\n\n  if (updateOnMount) {\n    onMounted(updateEsriTimeSteps);\n  }\n\n  watch(() => [url, variable], _newValues => {\n    updateEsriTimeSteps();\n  });\n\n  return {\n    molecule,\n    url,\n    variable,\n    loadingTimesteps,\n    esriTimesteps,\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = { class: \"time-chips-container\" }\nconst _hoisted_2 = { class: \"chips-grid\" }\nconst _hoisted_3 = [\"onClick\"]\nconst _hoisted_4 = { class: \"chip-content\" }\nconst _hoisted_5 = {\n  key: 0,\n  class: \"chip-date\"\n}\nconst _hoisted_6 = {\n  key: 1,\n  class: \"chip-time\"\n}\n\nimport { computed } from 'vue';\n\ninterface Props {\n  timestamps: number[]\n  selectedIndex?: number\n  reverse?: boolean,\n  useUtc?: boolean,\n  dateOnly?: boolean\n  hourOnly?: boolean\n}\n\ninterface Emits {\n  (e: 'select', payload: { value: number; index: number }): void\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'TimeChips',\n  props: {\n    timestamps: {},\n    selectedIndex: { default: -1 },\n    reverse: { type: Boolean, default: false },\n    useUtc: { type: Boolean, default: false },\n    dateOnly: { type: Boolean, default: false },\n    hourOnly: { type: Boolean, default: false }\n  },\n  emits: [\"select\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst props = __props;\n\nconst emit = __emit;\n\n\nconst formatDate = (timestamp: number): string => {\n  if (props.useUtc) {\n    const date = new Date(timestamp);\n    timestamp = date.getTime() + date.getTimezoneOffset() * 60*1000; // Adjust for UTC offset\n  }\n  const date = new Date(timestamp);\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    year: 'numeric'\n  });\n};\n\nconst formatTime = (timestamp: number): string => {\n  if (props.useUtc) {\n    const date = new Date(timestamp);\n    timestamp = date.getTime() + date.getTimezoneOffset() * 60*1000; // Adjust for UTC offset\n  }\n  const date = new Date(timestamp);\n  return date.toLocaleTimeString('en-US', {\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: true\n  });\n};\n\n\n\nconst timestampsComputed = computed(() => \n  props.reverse ? [...props.timestamps].sort((a,b) => b-a) : [...props.timestamps].sort((a,b) => a-b)\n);\n\nconst formattedDates = computed(() => \n  timestampsComputed.value.map(timestamp => formatDate(timestamp))\n);\n\nconst formattedTimes = computed(() => \n  timestampsComputed.value.map(timestamp => formatTime(timestamp))\n);\nconst handleChipClick = (value: number, index: number) => {\n  emit('select', { value, index });\n};\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(timestampsComputed.value, (timestamp, index) => {\n        return (_openBlock(), _createElementBlock(\"button\", {\n          key: timestamp,\n          class: _normalizeClass([\n          'time-chip',\n          { 'active': index === __props.selectedIndex }\n        ]),\n          onClick: ($event: any) => (handleChipClick(timestamp, index))\n        }, [\n          _createElementVNode(\"div\", _hoisted_4, [\n            (!__props.hourOnly)\n              ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, _toDisplayString(formattedDates.value[index]), 1))\n              : _createCommentVNode(\"\", true),\n            (!__props.dateOnly)\n              ? (_openBlock(), _createElementBlock(\"span\", _hoisted_6, _toDisplayString(formattedTimes.value[index]), 1))\n              : _createCommentVNode(\"\", true)\n          ])\n        ], 10, _hoisted_3))\n      }), 128))\n    ])\n  ]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport { computed } from 'vue';\n\ninterface Props {\n  timestamps: number[]\n  selectedIndex?: number\n  reverse?: boolean,\n  useUtc?: boolean,\n  dateOnly?: boolean\n  hourOnly?: boolean\n}\n\ninterface Emits {\n  (e: 'select', payload: { value: number; index: number }): void\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  selectedIndex: -1,\n  reverse: false,\n  useUtc: false,\n  dateOnly: false,\n  hourOnly: false\n});\n\nconst emit = defineEmits<Emits>();\n\n\nconst formatDate = (timestamp: number): string => {\n  if (props.useUtc) {\n    const date = new Date(timestamp);\n    timestamp = date.getTime() + date.getTimezoneOffset() * 60*1000; // Adjust for UTC offset\n  }\n  const date = new Date(timestamp);\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    year: 'numeric'\n  });\n};\n\nconst formatTime = (timestamp: number): string => {\n  if (props.useUtc) {\n    const date = new Date(timestamp);\n    timestamp = date.getTime() + date.getTimezoneOffset() * 60*1000; // Adjust for UTC offset\n  }\n  const date = new Date(timestamp);\n  return date.toLocaleTimeString('en-US', {\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: true\n  });\n};\n\n\n\nconst timestampsComputed = computed(() => \n  props.reverse ? [...props.timestamps].sort((a,b) => b-a) : [...props.timestamps].sort((a,b) => a-b)\n);\n\nconst formattedDates = computed(() => \n  timestampsComputed.value.map(timestamp => formatDate(timestamp))\n);\n\nconst formattedTimes = computed(() => \n  timestampsComputed.value.map(timestamp => formatTime(timestamp))\n);\nconst handleChipClick = (value: number, index: number) => {\n  emit('select', { value, index });\n};\n</script>\n\n<template>\n  <div class=\"time-chips-container\">\n    <div class=\"chips-grid\">\n      <button\n        v-for=\"(timestamp, index) in timestampsComputed\"\n        :key=\"timestamp\"\n        :class=\"[\n          'time-chip',\n          { 'active': index === selectedIndex }\n        ]\"\n        @click=\"handleChipClick(timestamp, index)\"\n      >\n        <div class=\"chip-content\">\n          <span \n            v-if=\"!hourOnly\"\n            class=\"chip-date\">{{ formattedDates[index] }}</span>\n          <span \n            v-if=\"!dateOnly\"\n            class=\"chip-time\">{{ formattedTimes[index] }}</span>\n        </div>\n      </button>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.time-chips-container {\n  width: 100%;\n  max-height: 300px;\n  background: transparent;\n  border-radius: 8px;\n  padding: 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  border: 1px solid #e5e7eb;\n  overflow: hidden;\n}\n\n.chips-grid {\n  /* display: grid; */\n  /* grid-template-columns: repeat(5, 1fr); */\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-evenly;\n  gap: 8px;\n  max-height: 276px;\n  overflow-y: auto;\n}\n\n\n\n.time-chip {\n  flex-basis: 15%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: fit-content;\n  padding: 8px;\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  color: #475569;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  outline: none;\n  user-select: none;\n}\n\n.time-chip:hover {\n  background: #8cc5ff;\n  border-color: #cbd5e1;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.time-chip:active {\n  background: #8cc5ff;\n}\n\n.time-chip.active {\n  background: #3b82f6;\n  border-color: #3b82f6;\n  color: #ffffff;\n  box-shadow: 0 2px 12px rgba(59, 130, 246, 0.3);\n}\n\n.time-chip.active:hover {\n  background: #2563eb;\n  border-color: #2563eb;\n}\n\n.chip-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 2px;\n  text-align: center;\n  line-height: 1.2;\n}\n\n.chip-date {\n  font-size: 11px;\n  font-weight: 600;\n  opacity: 0.9;\n}\n\n.chip-time {\n  font-size: 10px;\n  font-weight: 500;\n  opacity: 0.8;\n}\n\n.time-chip.active .chip-date,\n.time-chip.active .chip-time {\n  opacity: 1;\n}\n\n@media (max-width: 768px) {\n  .time-chips-container {\n    padding: 8px;\n    max-height: 250px;\n  }\n  \n  .chips-grid {\n    grid-template-columns: repeat(3, 1fr);\n    gap: 6px;\n    max-height: 234px;\n  }\n  \n  .time-chip {\n    height: 48px;\n    padding: 6px;\n  }\n  \n  .chip-date {\n    font-size: 10px;\n  }\n  \n  .chip-time {\n    font-size: 9px;\n  }\n}\n</style>","import script from \"./TimeChips.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TimeChips.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TimeChips.vue?vue&type=style&index=0&id=20cd57df&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-20cd57df\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, withKeys as _withKeys, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, mergeProps as _mergeProps, isRef as _isRef, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { id: \"map-view\" }\nconst _hoisted_2 = { class: \"mt-2\" }\nconst _hoisted_3 = { class: \"d-flex flex-row align-center\" }\nconst _hoisted_4 = [\"disabled\"]\nconst _hoisted_5 = { class: \"d-flex flex-row align-center my-2\" }\n\nimport { ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { DatePickerInstance } from \"@vuepic/vue-datepicker\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { MOLECULE_OPTIONS, type MoleculeType } from \"@/esri/utils\";\nimport { useTempoStore } from \"@/stores/app\";\nimport { useEsriTimesteps } from \"@/composables/useEsriTimesteps\";\n\nimport TimeChips from \"@/components/TimeChips.vue\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MapControls',\n  emits: [\"molecule\"],\n  setup(__props, { emit: __emit }) {\n\nconst store = useTempoStore();\nconst {\n  timestamps,\n  singleDateSelected,\n  uniqueDays,\n  selectedTimezone,\n  timezoneOptions,\n  timeIndex,\n  minIndex,\n  maxIndex,\n} = storeToRefs(store);\n\nconst emit = __emit;\n\nconst molecule = ref<MoleculeType>('no2');\nconst { esriTimesteps } = useEsriTimesteps(molecule);\n\nconst radio = ref<number | null>(null);\nconst touchscreen = supportsTouchscreen();\n\nconst calendar = ref<DatePickerInstance | null>(null);\n\nfunction handleEsriTimeSelected(ts: number, _index: number) {\n  const idx = timestamps.value.indexOf(ts);\n  console.log(`ESRI time selected: ${new Date(ts)} (nearest index ${idx})`);\n  if (idx >= 0) {\n    timeIndex.value = idx;\n  }\n  // We may need something like this when we get back the monthly average service.\n  //singleDateSelected.value = new Date(ts);\n}\n\nwatch(molecule, (newMol: MoleculeType) => {\n  emit(\"molecule\", newMol);\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_date_picker = _resolveComponent(\"date-picker\")!\n  const _component_v_radio_group = _resolveComponent(\"v-radio-group\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_select = _resolveComponent(\"v-select\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _cache[13] || (_cache[13] = _createElementVNode(\"h2\", null, \"Explore Map View\", -1)),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _cache[12] || (_cache[12] = _createElementVNode(\"h3\", null, \"Select a Date\", -1)),\n      _createElementVNode(\"div\", _hoisted_3, [\n        _createVNode(_component_v_radio_group, {\n          modelValue: radio.value,\n          \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((radio).value = $event))\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_date_picker, {\n              ref_key: \"calendar\",\n              ref: calendar,\n              \"model-value\": _unref(singleDateSelected),\n              onInternalModelChange: _cache[2] || (_cache[2] = (value) => {\n              if (value != null && value.getTime() != _unref(singleDateSelected).getTime()) {\n                radio.value = null;\n                singleDateSelected.value = value;\n                calendar.value?.closeMenu();\n              }\n            }),\n              \"allowed-dates\": _unref(uniqueDays),\n              clearable: false,\n              \"enable-time-picker\": false,\n              \"multi-dates\": false,\n              transitions: false,\n              format: (date) => date?.toDateString(),\n              \"preview-format\": (date) => date?.toDateString(),\n              \"no-today\": \"\",\n              dark: \"\",\n              \"year-range\": [_unref(uniqueDays)[0]?.getFullYear(), _unref(uniqueDays)[_unref(uniqueDays).length - 1]?.getFullYear()]\n            }, {\n              \"action-buttons\": _withCtx(() => [\n                _createElementVNode(\"button\", {\n                  class: \"dp__action_button dp__action-latest\",\n                  onClick: _cache[0] || (_cache[0] = () => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1]),\n                  onKeyup: _cache[1] || (_cache[1] = _withKeys(() => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1], [\"enter\"])),\n                  disabled: _unref(singleDateSelected) === _unref(uniqueDays)[_unref(uniqueDays).length - 1],\n                  elevation: \"0\",\n                  size: \"sm\"\n                }, \" Latest \", 40, _hoisted_4)\n              ]),\n              _: 1\n            }, 8, [\"model-value\", \"allowed-dates\", \"format\", \"preview-format\", \"year-range\"]),\n            (molecule.value.toLowerCase().includes('month'))\n              ? (_openBlock(), _createBlock(TimeChips, {\n                  key: 0,\n                  timestamps: _unref(esriTimesteps).slice(_unref(minIndex), _unref(maxIndex) + 1),\n                  onSelect: _cache[3] || (_cache[3] = ($event: any) => (handleEsriTimeSelected($event.value, $event.index))),\n                  \"selected-index\": _unref(timeIndex) - _unref(minIndex),\n                  \"use-utc\": molecule.value.toLowerCase().includes('month'),\n                  \"date-only\": molecule.value.toLowerCase().includes('month'),\n                  \"hour-only\": !molecule.value.toLowerCase().includes('month')\n                }, null, 8, [\"timestamps\", \"selected-index\", \"use-utc\", \"date-only\", \"hour-only\"]))\n              : _createCommentVNode(\"\", true)\n          ]),\n          _: 1\n        }, 8, [\"modelValue\"])\n      ]),\n      _createElementVNode(\"div\", _hoisted_5, [\n        _createVNode(_component_v_tooltip, {\n          disabled: _unref(touchscreen),\n          text: \"Previous Date\"\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createVNode(_component_v_btn, _mergeProps(props, {\n              class: \"rounded-icon-wrapper\",\n              onClick: _unref(store).moveBackwardOneDay,\n              onKeyup: _withKeys(_unref(store).moveBackwardOneDay, [\"enter\"]),\n              disabled: _unref(singleDateSelected) === _unref(uniqueDays)[0],\n              color: \"#009ade\",\n              variant: \"outlined\",\n              elevation: \"0\",\n              size: \"md\"\n            }), {\n              default: _withCtx(() => [\n                _createVNode(_component_v_icon, null, {\n                  default: _withCtx(() => [...(_cache[9] || (_cache[9] = [\n                    _createTextVNode(\"mdi-chevron-double-left\", -1)\n                  ]))]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }, 16, [\"onClick\", \"onKeyup\", \"disabled\"])\n          ]),\n          _: 1\n        }, 8, [\"disabled\"]),\n        _createVNode(_component_v_spacer),\n        _createVNode(_component_v_tooltip, {\n          disabled: _unref(touchscreen),\n          text: \"Get Data for latest available day\"\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createVNode(_component_v_btn, _mergeProps(props, {\n              style: {\"padding-inline\":\"4px\"},\n              onClick: _cache[5] || (_cache[5] = () => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1]),\n              onKeyup: _cache[6] || (_cache[6] = _withKeys(() => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1], [\"enter\"])),\n              disabled: _unref(singleDateSelected) === _unref(uniqueDays)[_unref(uniqueDays).length - 1],\n              color: \"#009ade\",\n              variant: \"outlined\",\n              elevation: \"0\",\n              size: \"md\"\n            }), {\n              default: _withCtx(() => [...(_cache[10] || (_cache[10] = [\n                _createTextVNode(\" Latest Data \", -1)\n              ]))]),\n              _: 1\n            }, 16, [\"disabled\"])\n          ]),\n          _: 1\n        }, 8, [\"disabled\"]),\n        _createVNode(_component_v_spacer),\n        _createVNode(_component_v_tooltip, {\n          disabled: _unref(touchscreen),\n          text: \"Next Date\"\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createVNode(_component_v_btn, _mergeProps(props, {\n              class: \"rounded-icon-wrapper\",\n              onClick: _unref(store).moveForwardOneDay,\n              onKeyup: _withKeys(_unref(store).moveForwardOneDay, [\"enter\"]),\n              disabled: _unref(singleDateSelected) === _unref(uniqueDays)[_unref(uniqueDays).length - 1],\n              color: \"#009ade\",\n              variant: \"outlined\",\n              elevation: \"0\",\n              size: \"md\"\n            }), {\n              default: _withCtx(() => [\n                _createVNode(_component_v_icon, null, {\n                  default: _withCtx(() => [...(_cache[11] || (_cache[11] = [\n                    _createTextVNode(\"mdi-chevron-double-right\", -1)\n                  ]))]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }, 16, [\"onClick\", \"onKeyup\", \"disabled\"])\n          ]),\n          _: 1\n        }, 8, [\"disabled\"])\n      ])\n    ]),\n    _createVNode(_component_v_select, {\n      modelValue: _unref(selectedTimezone),\n      \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => (_isRef(selectedTimezone) ? (selectedTimezone).value = $event : null)),\n      label: \"Timezone\",\n      items: _unref(timezoneOptions),\n      \"item-title\": \"name\",\n      \"item-value\": \"tz\",\n      \"hide-details\": \"\",\n      dense: \"\",\n      class: \"mt-3 pl-3\"\n    }, null, 8, [\"modelValue\", \"items\"]),\n    _createVNode(_component_v_select, {\n      modelValue: molecule.value,\n      \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((molecule).value = $event)),\n      items: _unref(MOLECULE_OPTIONS),\n      \"item-title\": \"title\",\n      \"item-value\": \"value\",\n      label: \"Molecule / Quantity\",\n      \"hide-details\": \"\",\n      dense: \"\",\n      class: \"mt-3 pl-3\"\n    }, null, 8, [\"modelValue\", \"items\"])\n  ]))\n}\n}\n\n})","<template>\n  <div id=\"map-view\">\n    <h2>Explore Map View</h2>\n    <div class=\"mt-2\">\n      <h3>Select a Date</h3>\n      <div class=\"d-flex flex-row align-center\">\n        <v-radio-group v-model=\"radio\">\n          <date-picker\n            ref=\"calendar\"\n            :model-value=\"singleDateSelected\"\n            @internal-model-change=\"(value: Date) => {\n              if (value != null && value.getTime() != singleDateSelected.getTime()) {\n                radio = null;\n                singleDateSelected = value;\n                calendar?.closeMenu();\n              }\n            }\"\n            :allowed-dates=\"uniqueDays\"\n            :clearable=\"false\"\n            :enable-time-picker=\"false\"\n            :multi-dates=\"false\"\n            :transitions=\"false\"\n            :format=\"(date: Date | null) => date?.toDateString()\"\n            :preview-format=\"(date: Date | null) => date?.toDateString()\"\n            no-today\n            dark\n            :year-range=\"[uniqueDays[0]?.getFullYear(), uniqueDays[uniqueDays.length - 1]?.getFullYear()]\"\n          >\n            <template #action-buttons>\n              <button\n                class=\"dp__action_button dp__action-latest\"\n                @click=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n                @keyup.enter=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n                :disabled=\"singleDateSelected === uniqueDays[uniqueDays.length - 1]\"\n                elevation=\"0\"\n                size=\"sm\"\n              >\n                Latest\n            </button>\n            </template>\n            <!-- <template #action-extra=\"{ selectCurrentDate }\">\n            \n            </template> -->\n          </date-picker>\n          <!-- time chips to select time specifically for esri times -->\n          <time-chips\n            v-if=\"molecule.toLowerCase().includes('month')\"\n            :timestamps=\"esriTimesteps.slice(minIndex, maxIndex + 1)\"\n            @select=\"handleEsriTimeSelected($event.value, $event.index)\"\n            :selected-index=\"timeIndex - minIndex\"\n            :use-utc=\"molecule.toLowerCase().includes('month')\"\n            :date-only=\"molecule.toLowerCase().includes('month')\"\n            :hour-only=\"!molecule.toLowerCase().includes('month')\"\n          />\n        </v-radio-group>\n      </div>        \n      <!-- add buttons to increment and decrement the singledateselected -->\n      <div class=\"d-flex flex-row align-center my-2\">\n        <v-tooltip :disabled=\"touchscreen\" text=\"Previous Date\">\n          <template v-slot:activator=\"{ props }\">\n            <v-btn\n              v-bind=\"props\"\n              class=\"rounded-icon-wrapper\"\n              @click=\"store.moveBackwardOneDay\"\n              @keyup.enter=\"store.moveBackwardOneDay\"\n              :disabled=\"singleDateSelected === uniqueDays[0]\"\n              color=\"#009ade\"\n              variant=\"outlined\"\n              elevation=\"0\"\n              size=\"md\"\n            >\n              <v-icon>mdi-chevron-double-left</v-icon>\n            </v-btn>\n          </template>\n        </v-tooltip>\n        <v-spacer></v-spacer>\n        <v-tooltip :disabled=\"touchscreen\" text=\"Get Data for latest available day\">\n          <template v-slot:activator=\"{ props }\">\n            <v-btn\n              v-bind=\"props\"\n              style=\"padding-inline: 4px;\"\n              @click=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n              @keyup.enter=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n              :disabled=\"singleDateSelected === uniqueDays[uniqueDays.length - 1]\"\n              color=\"#009ade\"\n              variant=\"outlined\"\n              elevation=\"0\"\n              size=\"md\"\n            >\n              Latest Data\n            </v-btn>\n          </template>\n        </v-tooltip>\n        <v-spacer></v-spacer>\n        <v-tooltip :disabled=\"touchscreen\" text=\"Next Date\">\n          <template v-slot:activator=\"{ props }\">\n            <v-btn\n              v-bind=\"props\"\n              class=\"rounded-icon-wrapper\"\n              @click=\"store.moveForwardOneDay\"\n              @keyup.enter=\"store.moveForwardOneDay\"\n              :disabled=\"singleDateSelected === uniqueDays[uniqueDays.length - 1]\"\n              color=\"#009ade\"\n              variant=\"outlined\"\n              elevation=\"0\"\n              size=\"md\"\n            >\n              <v-icon>mdi-chevron-double-right</v-icon>\n            </v-btn>\n          </template>\n        </v-tooltip>\n      </div>\n\n    </div>\n    <v-select\n      v-model=\"selectedTimezone\"\n      label=\"Timezone\"\n      :items=\"timezoneOptions\"\n      item-title=\"name\"\n      item-value=\"tz\"\n      hide-details\n      dense\n      class=\"mt-3 pl-3\"\n    ></v-select>\n    <v-select\n      v-model=\"molecule\"\n      :items=\"MOLECULE_OPTIONS\"\n      item-title=\"title\"\n      item-value=\"value\"\n      label=\"Molecule / Quantity\"\n      hide-details\n      dense\n      class=\"mt-3 pl-3\"\n    ></v-select>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { DatePickerInstance } from \"@vuepic/vue-datepicker\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { MOLECULE_OPTIONS, type MoleculeType } from \"@/esri/utils\";\nimport { useTempoStore } from \"@/stores/app\";\nimport { useEsriTimesteps } from \"@/composables/useEsriTimesteps\";\n\nimport TimeChips from \"@/components/TimeChips.vue\";\n\nconst store = useTempoStore();\nconst {\n  timestamps,\n  singleDateSelected,\n  uniqueDays,\n  selectedTimezone,\n  timezoneOptions,\n  timeIndex,\n  minIndex,\n  maxIndex,\n} = storeToRefs(store);\n\nconst emit = defineEmits<{\n  (event: \"molecule\", molecule: MoleculeType): void;\n}>();\n\nconst molecule = ref<MoleculeType>('no2');\nconst { esriTimesteps } = useEsriTimesteps(molecule);\n\nconst radio = ref<number | null>(null);\nconst touchscreen = supportsTouchscreen();\n\nconst calendar = ref<DatePickerInstance | null>(null);\n\nfunction handleEsriTimeSelected(ts: number, _index: number) {\n  const idx = timestamps.value.indexOf(ts);\n  console.log(`ESRI time selected: ${new Date(ts)} (nearest index ${idx})`);\n  if (idx >= 0) {\n    timeIndex.value = idx;\n  }\n  // We may need something like this when we get back the monthly average service.\n  //singleDateSelected.value = new Date(ts);\n}\n\nwatch(molecule, (newMol: MoleculeType) => {\n  emit(\"molecule\", newMol);\n});\n</script>\n","import script from \"./MapControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapControls.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import type { ColorMap } from \"./types\";\nimport { colormaps, type AllAvailableColorMaps } from \".\";\n\nfunction lerp(a: number, b: number, t: number): number {\n  return a + (b - a) * t;\n}\n\n// linear spline\nfunction spline( t: number, ...values: number[]): number {\n  if (t <= 0) return values[0] as number;\n  if (t >= 1) return values[values.length - 1] as number;\n  const n = values.length - 1;\n  const i = Math.floor(t * n);\n  const u = t * n - i;\n  return lerp(values[i], values[i + 1] ?? values[i], u);\n}\n\nfunction clamp(x: number, min: number, max: number): number {\n  return Math.min(Math.max(x, min), max);\n}\n\nexport function colormap(cmap: AllAvailableColorMaps, cmin: number, cmax: number, val: number): [number, number, number]\n{ \n  \n  let reversed = false;\n  if (cmap.endsWith('_r')) {\n    cmap = cmap.slice(0, -2) as AllAvailableColorMaps;\n    reversed = true;\n  }\n  if (!(cmap in colormaps)) {\n    throw new Error(`Colormap ${cmap} not found`);\n  }\n  \n  const { r: redValues, g: greenValues, b: blueValues } = colormaps[cmap] as ColorMap;\n\n  // const normalizedVal = clamp((val-cmin)/(cmax-cmin),0,1);\n  const normalizedVal = reversed ? clamp((cmax - val) / (cmax - cmin), 0, 1) : clamp((val - cmin) / (cmax - cmin), 0, 1);\n  const r = spline(normalizedVal, ...redValues);\n  const g = spline(normalizedVal, ...greenValues);\n  const b = spline(normalizedVal, ...blueValues);\n  return [Math.round(r*255),Math.round(g*255),Math.round(b*255)];\n}\n\nexport function sampleColormap(cmap: AllAvailableColorMaps, steps: number): number[][] {\n  const colors: number[][] = [];\n  for (let i = 0; i < steps; i++) {\n    const t = i / (steps - 1);\n    colors.push(colormap(cmap, 0, 1, t));\n  }\n  return colors;\n}\n\n// should return an array of values that is compatible with the \"heatmap-color\" property of a heatmap layer\n// So it will be an array like: [0, 'color1', 0.2, 'color2', 0.4, 'color3', ..., 1, 'colorN']\nexport function createHeatmapColorMap(colormapName: AllAvailableColorMaps = 'viridis', steps: number[] = [0.1, 0.2, 0.4, 0.6, 0.8, 1], transparentTo = 0): Array<number | string> {\n  const colors: Array<string | number> = [];\n  \n  // start with fully transparent\n  colors.push(0);\n  colors.push('rgba(0,0,0,0)'); \n  \n  let transparentAdded = false;\n  // then add colors from transparentTo to 1\n  for (const t of steps) {\n    const [r, g, b] = colormap(colormapName, 0, 1, t);\n    const c = `rgb(${r},${g},${b})`;\n    if (transparentTo < t && !transparentAdded) {\n      console.log('Adding transparent to color at', transparentTo, c);\n      colors.push(transparentTo);\n      colors.push(c);\n      transparentAdded = true;\n    }\n    colors.push(t);\n    colors.push(c);\n  }\n  return colors;\n  \n}\n\nexport function previewColormapInConsole(colormapName: AllAvailableColorMaps = 'viridis', steps: number[] = [0.1, 0.2, 0.4, 0.6, 0.8, 1], transparentTo = 0) {\n  // using console log stying appling hte color to a character\n  const colors = createHeatmapColorMap(colormapName, steps, transparentTo);\n  let str = '';\n  const style: string[] = [];\n  for (let i = 0; i < colors.length; i += 2) {\n    // const t = colors[i];\n    const c = colors[i + 1];\n    str += '%c';\n    style.push(`color: ${c}`);\n  }\n  console.log('%cColormap: ' + colormapName, 'font-weight: bold;');\n  console.log(str, ...style);\n}","import {Ref, ref, watch} from 'vue';\nimport M, {Marker} from 'maplibre-gl';\nimport { LatLngPair } from '@/types';\n\n\nexport interface MaplibreLocationMarker {\n  locationMarker: Ref<M.Marker | null>;\n  setMarker: (latlng: LatLngPair) => void;\n  removeMarker: () => void;\n  showLocationMarker: Ref<boolean>;\n}\n\nexport function useLocationMarker( map: Ref<M.Map | null>, show: boolean): MaplibreLocationMarker {\n  \n  const showLocationMarker = ref(show);\n  const locationMarker = ref<null | Marker>(null);\n  \n  \n  const addToMap = () => {\n    if (locationMarker.value !== null && map.value !== null) {\n      locationMarker.value.addTo(map.value);\n    }\n  };\n  \n  function setMarker(latlng: LatLngPair) {\n    if (!map.value) return ;\n    \n    const lnglat = [latlng[1], latlng[0]] as M.LngLatLike;\n    \n    if (locationMarker.value == null) {\n      \n      locationMarker.value = new M.Marker()\n        .setLngLat(lnglat);\n      \n    } else {\n      locationMarker.value.setLngLat(lnglat);\n    }\n    \n    if (showLocationMarker.value) {\n      addToMap();\n    }\n  }\n  \n  function removeMarker() {\n    locationMarker.value?.remove();\n  }\n  \n  watch(showLocationMarker, (show: boolean) => {\n    if (show) {\n      addToMap();\n    } else {\n      removeMarker();\n    }\n  });\n  \n  return {\n    locationMarker: locationMarker as Ref<M.Marker | null>,\n    setMarker,\n    removeMarker,\n    showLocationMarker\n  };\n}\n","import { onMounted, onUnmounted, toRef, watch } from \"vue\";\nimport { Map, MapMouseEvent } from \"maplibre-gl\";\n\nimport { UseSelectionOptions } from \"../../types\";\n\nexport function baseUseSelection<SelectionInfo>(\n  options: UseSelectionOptions<Map, MapMouseEvent, SelectionInfo>,\n) {\n\n  const { map, handler } = options;\n  const active = toRef(options.active ?? false);\n\n  onMounted(() => {\n    const mMap = map.value;\n    if (active.value && mMap) {\n      updateListeners(mMap, active.value);\n    }\n  });\n\n  function updateListeners(map: Map, active: boolean) {\n    if (active) {\n      map.dragPan.disable();\n      map.scrollZoom.disable();\n      if (handler.onMousedown) {\n        map.on(\"mousedown\", handler.onMousedown);\n      }\n      if (handler.onMouseup) {\n        map.on(\"mouseup\", handler.onMouseup);\n      }\n      if (handler.onMousemove) {\n        map.on(\"mousemove\", handler.onMousemove);\n      }\n    } else {\n      map.dragPan.enable();\n      map.scrollZoom.enable();\n      if (handler.onMousedown) {\n        map.off(\"mousedown\", handler.onMousedown);\n      }\n      if (handler.onMouseup) {\n        map.off(\"mouseup\", handler.onMouseup);\n      }\n      if (handler.onMousemove) {\n        map.off(\"mousemove\", handler.onMousemove);\n      }\n    }\n  }\n\n  watch(active, (nowActive: boolean) => {\n    const mMap = map.value;\n    if (mMap !== null) {\n      updateListeners(mMap, nowActive);\n      mMap.getCanvas().style.cursor = nowActive ? 'crosshair' : '';\n    }\n  });\n\n  // If we're going to take in the map as a ref,\n  // we might as well update if its value does\n  watch(map, (newMap: Map | null) => {\n    if (newMap !== null) {\n      updateListeners(newMap, active.value);\n    }\n  });\n\n  onUnmounted(() => {\n    // The map will probably be destroyed along with the component using this composable\n    // But if not, we should remove handlers\n    const mMap = map.value;\n    if (mMap !== null && active.value) {\n      updateListeners(mMap, false);\n    }\n  });\n\n  return {\n    active,\n    selectionInfo: handler.selectionInfo,\n  };\n\n}\n","import { ref, type MaybeRef, type Ref } from \"vue\";\nimport { GeoJSONSource, LngLat, Map, MapMouseEvent } from \"maplibre-gl\";\nimport { v4 } from \"uuid\";\n\nimport type { RectangleSelectionInfo, SelectionHandler } from \"../../types\";\nimport type { LayerType } from \"./utils\";\nimport { baseUseSelection } from \"./baseUseSelection\";\n\n\nexport function useRectangleSelection(\n  map: Ref<Map | null>,\n  interactColor: string = \"yellow\",\n  active: MaybeRef<boolean>,\n) {\n\n  let rectangleSource: GeoJSONSource | null = null;\n  let rectangleLayer: LayerType | undefined = undefined;\n  let startCoords: LngLat | null = null;\n  let geoJson: GeoJSON.FeatureCollection;\n  const uuid = v4();\n\n  const handler: SelectionHandler<MapMouseEvent, RectangleSelectionInfo> = {\n\n    selectionInfo: ref<RectangleSelectionInfo | null>(null),\n\n    onMousedown(event: MapMouseEvent) {\n      const mMap = map.value;\n      if (!mMap) {\n        return;\n      }\n\n      startCoords = event.lngLat;\n      geoJson = {\n        type: \"FeatureCollection\",\n        features: [{\n          type: \"Feature\",\n          geometry: {\n            type: \"Polygon\",\n            coordinates: [[\n              [startCoords.lng, startCoords.lat],\n              [startCoords.lng, startCoords.lat],\n              [startCoords.lng, startCoords.lat],\n              [startCoords.lng, startCoords.lat],\n            ]],\n          },\n          properties: {},\n        }],\n      };\n\n      mMap.addSource(uuid, {\n        type: \"geojson\",\n        data: geoJson,\n      });\n\n      const source = mMap.getSource(uuid);\n      if (!source) {\n        return;\n      }\n\n      rectangleSource = source as GeoJSONSource;\n\n      mMap.addLayer({\n        id: uuid,\n        type: \"line\",\n        source: uuid,\n        paint: {\n          \"line-color\": interactColor,\n          \"line-width\": 2,\n          \"line-dasharray\": [2, 1],\n        }\n      });\n\n      const layer = mMap.getLayer(uuid);\n      if (layer) {\n        rectangleLayer = layer;\n      }\n    },\n\n    onMouseup(event: MapMouseEvent) {\n      const mMap = map.value;\n      if (!mMap || startCoords === null) {\n        return;\n      }\n\n      const eventCoords = event.lngLat;\n      handler.selectionInfo.value = {\n        xmin: Math.min(startCoords.lng, eventCoords.lng),\n        ymin: Math.min(startCoords.lat, eventCoords.lat),\n        xmax: Math.max(startCoords.lng, eventCoords.lng),\n        ymax: Math.max(startCoords.lat, eventCoords.lat),\n      };\n\n      if (rectangleLayer) {\n        mMap.removeLayer(rectangleLayer.id);\n      }\n      if (rectangleSource) {\n        mMap.removeSource(rectangleSource.id);\n      }\n      startCoords = null;\n\n    },\n\n    onMousemove(event: MapMouseEvent) {\n      const mMap = map.value;\n      if (!mMap || (startCoords === null) || (!geoJson)) {\n        return;\n      }\n\n      const eventCoords = event.lngLat;\n      const coordinates = [[\n        [startCoords.lng, startCoords.lat],\n        [eventCoords.lng, startCoords.lat],\n        [eventCoords.lng, eventCoords.lat],\n        [startCoords.lng, eventCoords.lat],\n        [startCoords.lng, startCoords.lat],\n      ]];\n\n      geoJson.features[0] = {\n        ...geoJson.features[0],\n        geometry: {\n          type: \"Polygon\",\n          coordinates,\n        }\n      };\n\n      rectangleSource?.setData(geoJson);\n    }\n  };\n\n  return baseUseSelection({ map, handler, active });\n\n}\n","import { GeoJSONSource, LngLatBoundsLike, Map } from \"maplibre-gl\";\nimport { v4 } from \"uuid\";\n\nimport { RectangleSelectionInfo, PointSelectionInfo, UnifiedRegion } from \"../../types\";\n\nconst layerGetter = (m: Map, id: string) => m.getLayer(id);\nexport type LayerType = Exclude<ReturnType<typeof layerGetter>, undefined>;\n\nfunction createBounds(info: RectangleSelectionInfo) {\n  return [\n    [info.xmin, info.ymin],\n    [info.xmax, info.ymin],\n    [info.xmax, info.ymax],\n    [info.xmin, info.ymax],\n    [info.xmin, info.ymin],\n  ];\n}\n\n\nexport function addRectangleLayer(\n  map: Map,\n  info: RectangleSelectionInfo,\n  color: string,\n) {\n\n  const uuid = v4();\n  const geoJson: GeoJSON.FeatureCollection = {\n    type: \"FeatureCollection\",\n    features: [{\n      type: \"Feature\",\n      geometry: {\n        type: \"Polygon\",\n        coordinates: [\n          createBounds(info),\n        ],\n      },\n      properties: {},\n    }],\n  };\n\n  map.addSource(uuid, {\n    type: \"geojson\",\n    data: geoJson,\n  });\n  const source = map.getSource(uuid) as GeoJSONSource;\n\n  map.addLayer({\n    id: uuid,\n    type: \"fill\",\n    source: uuid,\n    paint: {\n      \"fill-color\": color,\n      \"fill-opacity\": 0.7,\n    }\n  });\n\n  return { layer: source };\n}\n\nexport function updateRectangleBounds(\n  source: GeoJSONSource,\n  info: RectangleSelectionInfo,\n) {\n  source.getData().then(data => {\n    const geoJson = data as GeoJSON.FeatureCollection;\n    geoJson.features[0] = {\n      ...geoJson.features[0],\n      geometry: {\n        type: \"Polygon\",\n        coordinates: [createBounds(info)],\n      }\n    };\n\n    source.setData(geoJson);\n  });\n}\n\nexport function removeRectangleLayer(\n  map: Map,\n  layer: LayerType,\n) {\n  map.removeLayer(layer.id);\n  map.removeSource(layer.id);\n}\n\n// Point layer utilities\nexport function addPointLayer(\n  map: Map,\n  info: PointSelectionInfo,\n  color: string,\n) {\n  const uuid = v4();\n  const geoJson: GeoJSON.FeatureCollection = {\n    type: \"FeatureCollection\",\n    features: [{\n      type: \"Feature\",\n      geometry: {\n        type: \"Point\",\n        coordinates: [info.x, info.y],\n      },\n      properties: {},\n    }],\n  };\n\n  map.addSource(uuid, {\n    type: \"geojson\",\n    data: geoJson,\n  });\n  const source = map.getSource(uuid) as GeoJSONSource;\n\n  map.addLayer({\n    id: uuid,\n    type: \"circle\",\n    source: uuid,\n    paint: {\n      \"circle-radius\": 8,\n      \"circle-color\": color,\n      \"circle-stroke-color\": \"white\",\n      \"circle-stroke-width\": 2,\n    }\n  });\n\n  return { layer: source };\n}\n\nexport function updatePointLocation(\n  source: GeoJSONSource,\n  info: PointSelectionInfo,\n) {\n  source.getData().then(data => {\n    const geoJson = data as GeoJSON.FeatureCollection;\n    geoJson.features[0] = {\n      ...geoJson.features[0],\n      geometry: {\n        type: \"Point\",\n        coordinates: [info.x, info.y],\n      }\n    };\n    source.setData(geoJson);\n  });\n}\n\nexport function removePointLayer(\n  map: Map,\n  layer: LayerType,\n) {\n  map.removeLayer(layer.id);\n  map.removeSource(layer.id);\n}\n\nexport function regionBounds(region: UnifiedRegion): [[number, number], [number, number]] {\n  const pointPadding = 1;\n  return region.geometryType == \"rectangle\" ?\n    [[region.geometryInfo.xmin, region.geometryInfo.ymin], [region.geometryInfo.xmax, region.geometryInfo.ymax]] :\n    [[region.geometryInfo.x - pointPadding, region.geometryInfo.y - pointPadding], [region.geometryInfo.x + pointPadding, region.geometryInfo.y + pointPadding]];\n}\n\nexport function fitBounds(map: Map, bounds: LngLatBoundsLike, _fly: boolean) {\n  map.fitBounds(bounds);\n}\n","import { ref, type MaybeRef, type Ref } from \"vue\";\nimport { Map, MapMouseEvent } from \"maplibre-gl\";\n\nimport type { PointSelectionInfo, SelectionHandler } from \"../../types\";\nimport { baseUseSelection } from \"./baseUseSelection\";\n\nexport function usePointSelection(\n  map: Ref<Map | null>,\n  active: MaybeRef<boolean>,\n) {\n  \n  const handler: SelectionHandler<MapMouseEvent, PointSelectionInfo> = {\n    selectionInfo: ref<PointSelectionInfo | null>(null),\n\n    onMouseup(event: MapMouseEvent) {\n      handler.selectionInfo.value = {\n        x: event.lngLat.lng,\n        y: event.lngLat.lat,\n      };\n    },\n  };\n\n  return baseUseSelection({ map, handler, active });\n}\n","export const paulTolMutedColorblindSafeColors = ['#CC6677', '#332288', '#117733', '#882255', '#44aa99', '#999933', '#aa4499',];\n\nexport const COLORS = [\n  ...paulTolMutedColorblindSafeColors, '#e6194b', '#3cb44b', '#4363d8', '#911eb4', '#46f0f0',\n  '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff', '#9a6324', '#fffac8',\n  '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#808080', '#ffffff',\n  '#000000'\n];\n","import { Ref } from 'vue';\nimport maplibregl from 'maplibre-gl';\n\nexport interface MultiMarkerOptions {\n  label?: string;\n  color?: string;\n  fillColor?: string;\n  fillOpacity?: number;\n  opacity?: number;\n  radius?: number;\n  outlineColor?: string;\n  paint?: maplibregl.CircleLayerSpecification['paint'];\n  layout?: maplibregl.CircleLayerSpecification['layout'];\n  shape?: 'circle' | 'marker';\n  scale?: 'world' | 'screen';\n}\n\n\nconst DEG_DEFAULT = 0.05; // example default: 0.05\nconst PX_DEFAULT  = 8;\n\n  \nfunction toGeoJSON(points: Array<{ x: number; y: number }>, radius_deg?: number): GeoJSON.FeatureCollection<GeoJSON.Point> {\n  return {\n    type: 'FeatureCollection',\n    features: points.map(pt => ({\n      type: 'Feature',\n      geometry: { type: 'Point', coordinates: [pt.x, pt.y] } as GeoJSON.Point,\n      properties: {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        radius_deg: radius_deg ?? DEG_DEFAULT,\n        // the below are unused, but useful if we want something different in the future\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        radius_px: PX_DEFAULT,\n        lat: pt.y,\n        lon: pt.x,\n      },\n    })),\n  };\n}\n\nexport function useMultiMarker(map: Ref<maplibregl.Map | null>, options: MultiMarkerOptions = {}) {\n  const sourceId = `${options.label ?? 'multi-marker'}-source`;\n  const layerId = `${options.label ?? 'multi-marker'}-layer`;\n  \n  options.scale = options.scale ?? 'screen';\n  \n  function optionsToPaint() {\n    return {\n      // 'circle-radius': options.radius ?? 8,\n      'circle-color': options.fillColor ?? options.color ?? '#ff0000',\n      'circle-opacity': options.fillOpacity ?? options.opacity ?? 0.8,\n      'circle-stroke-color': options.outlineColor ?? options.color ?? '#000',\n      'circle-stroke-width': 2\n    };\n  }\n\n  function addMarkers(points: Array<{ x: number; y: number }>) {\n    if (!map.value) return;\n    clearMarkers();\n    const geojson = toGeoJSON(points, options.scale === 'world' ? (options.radius ?? DEG_DEFAULT) : options.radius ?? PX_DEFAULT);\n    if (map.value.getSource(sourceId)) {\n      (map.value.getSource(sourceId) as maplibregl.GeoJSONSource).setData(geojson);\n    } else {\n      map.value.addSource(sourceId, {\n        type: 'geojson',\n        data: geojson,\n      });\n    }\n    if (!map.value.getLayer(layerId)) {\n      \n      const paint = {\n        ...optionsToPaint(),\n        ...(options.paint ?? {}),\n      };\n      \n      if (options.scale === 'screen') {\n        paint['circle-radius'] = options.radius ?? PX_DEFAULT;\n        paint['circle-pitch-scale'] = 'viewport'; // stays in screen pixels even when pitched\n      } else {\n        // use a maplibre expression to avoid js handlers. https://maplibre.org/maplibre-style-spec/expressions/#zoom\n\n        // conversion from degrees to pixels at equator at zoom = 0\n        // Explanation: at zoom = 0\n        // 360 degrees = 256 pixels @ equator. we will ignore latitude scaling.\n        // to include latitude scaling, multiply radius by cos(lat) where lat is in radians\n        // after testing, a slightly smaller factor seems to work better visually\n        const degreeToPixel = 512 / 360; // typically we would use 256 but maplibre-gl uses 2x the resolution\n        \n        paint['circle-radius'] = [\n          // pixel scale is dependent on zoom ~ 2^zoom\n          // https://leafletjs.com/examples/zoom-levels/ (zoom explainer from leaflet)\n          'interpolate', ['exponential', 2], ['zoom'],\n          // at zoom = 0, the pixel radius = radius in degrees * K\n          0,  ['*', ['get', 'radius_deg'], degreeToPixel],\n          // at zoom = 24  (or whatever max zoom your style uses)\n          24, ['*', ['get', 'radius_deg'], degreeToPixel * Math.pow(2, 24)]\n        ];\n        paint['circle-pitch-scale'] = 'viewport'; // stays in screen pixels even when pitched\n      }\n      \n      \n      \n      map.value.addLayer({\n        id: layerId,\n        type: 'circle',\n        source: sourceId,\n        paint: paint,\n        layout: options.layout ?? {\n          'visibility': 'visible',\n        },\n      } as maplibregl.CircleLayerSpecification);\n    }\n  }\n\n  function clearMarkers() {\n    if (!map.value) return;\n    if (map.value.getLayer(layerId)) {\n      map.value.removeLayer(layerId);\n    }\n    if (map.value.getSource(sourceId)) {\n      map.value.removeSource(sourceId);\n    }\n  }\n\n  return { addMarkers, clearMarkers };\n}","import type { Map } from \"maplibre-gl\";\n//\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction isNumeric(value: any): boolean {\n  return !isNaN(value - parseFloat(value));\n}\n\nexport function setLayerOpacity(map: Map, layerId: string, opacity: number) {\n  const layer = map.getLayer(layerId);\n  if (!layer) {\n    console.warn('Layer not found:', layerId);\n    return;\n  }\n\n  if (layer.type !== 'symbol') {\n    const paintProp = `${layer.type}-opacity`;\n    map.setPaintProperty(layerId, paintProp, opacity);\n  }\n  if (layer.type === 'circle') {\n    if (map.getPaintProperty(layerId, 'circle-opacity') !== undefined) {\n      map.setPaintProperty(layerId, 'circle-stroke-opacity', opacity);\n    }\n  }  \n  if (layer.type === 'symbol') {\n    // icon-opacity\n    if (map.getPaintProperty(layerId, 'icon-opacity') !== undefined) {\n      map.setPaintProperty(layerId, 'icon-opacity', opacity);\n    }\n    // text-opacity\n    if (map.getPaintProperty(layerId, 'text-opacity') !== undefined) {\n      map.setPaintProperty(layerId, 'text-opacity', opacity);\n    }\n  }\n}\n\nexport function getLayerOpacity(map: Map, layerId: string): number {\n  const layer = map.getLayer(layerId);\n  if (!layer) return 1;\n  \n  let op: unknown = 1;\n  \n  if (layer.type === 'symbol') {\n    op = map.getPaintProperty(layerId, 'icon-opacity');\n    if (isNaN(op as unknown as number)) {\n      op = map.getPaintProperty(layerId, 'text-opacity');\n    }\n  } else if (layer.type === 'circle') {\n    op = map.getPaintProperty(layerId, 'circle-opacity');\n    if (isNaN(op as unknown as number)) {\n      op = map.getPaintProperty(layerId, 'circle-stroke-opacity');\n    }\n  } else {\n    const paintProp = `${layer.type}-opacity`;\n    op = map.getPaintProperty(layerId, paintProp);\n  }\n  \n  return isNumeric(op) ? (op as unknown as number) : 1;\n} \n\nexport function getLayerVisibility(map: Map, layerId: string): boolean {\n  // NB: If this hasn't been explicitly set yet, the layer is visible but the\n  // value returned by `getLayoutProperty` is undefined, so we can't do `=== \"visible\"`\n  return map.getLayoutProperty(layerId, \"visibility\") !== \"none\";\n}\n\nexport function setLayerVisibility(map: Map, layerId: string, visible: boolean) {\n  map.setLayoutProperty(\n    layerId,\n    \"visibility\",\n    visible ? \"visible\" : \"none\",\n  );\n}\n","import { Ref, ref, onMounted, onUnmounted } from 'vue';\nimport M, { Map, AttributionControl } from 'maplibre-gl';\nimport { InitMapOptions, LatLngPair } from '@/types';\n\n\nconst scale = window.devicePixelRatio;\nconst retinaParam = scale > 1 ? '@2x' : '';\n\nexport interface MapLibreComposable {\n    map: Ref<M.Map | null>;\n    createMap: () => Ref<M.Map>;\n    setView: (latlng: LatLngPair, zoom: number) => void;\n    resetView: () => void;\n    cleanupMap: () => void;\n    getCenter: () => M.LngLat;\n  }\n  \n\n  \nexport function useMap(id=\"map\", options: InitMapOptions, _showRoads: Ref<boolean>, onReady?: (map: M.Map) => void): MapLibreComposable {\n  // Something to know about MatLibre it likes longitude, latitude as opposed\n  // to leaflet which uses latitude, longitude\n  // this is where our map will be\n  const map = ref<M.Map | null>(null);\n  \n  async function addStates(map: M.Map) {\n    fetch(\"states.geojson\")\n      .then(response => response.json())\n      .then(data => {\n        map.addSource('states-custom', {\n          'type': 'geojson',\n          'data': data\n        });\n        map.addLayer({\n          'id': 'states-custom',\n          'type': 'line',\n          'source': 'states-custom',\n          'paint': {\n            'line-color': 'black',\n            'line-width': 0.5,\n            'line-opacity': 0.8,\n          }\n        });\n      });\n  }\n  \n  async function addCoastlines(map: M.Map) {\n    fetch(\"coastlines.geojson\")\n      .then(response => response.json())\n      .then(data => {\n        map.addSource('coastline-custom', {\n          'type': 'geojson',\n          'data': data\n        });\n        map.addLayer({\n          'id': 'coastline-custom',\n          'type': 'line',\n          'source': 'coastline-custom',\n          'paint': {\n            'line-color': 'black',\n            'line-width': 1,\n            'line-opacity': 0.8,\n          }\n        });\n      });\n  }\n  \n  \n  \n  function addLabels(map: M.Map) {\n    map.addSource('stamen-toner-labels', {\n      type: 'raster',\n      tiles: [`https://tiles.stadiamaps.com/tiles/stamen_toner_labels/{z}/{x}/{y}${retinaParam}.png`],\n      tileSize: 256,\n    });\n\n    map.addLayer({\n      id: 'stamen-toner-labels',\n      type: 'raster',\n      source: 'stamen-toner-labels',\n      minzoom: 0,\n      maxzoom: 20\n    });\n    \n    map.moveLayer('stamen-toner-labels');\n  }\n  \n  function setupMap() {\n    if (map.value === null) return;\n    \n    // Need to use weird type assertion to avoid\n    // Type instantiation is excessively deep and possibly infinite.ts(2589)\n    // See discussion here https://github.com/mapbox/mapbox-gl-js/issues/13203#issuecomment-2634013147\n    const libreMap = map.value as unknown as M.Map;\n    \n\n    // libreMap.setProjection({\n    //   type: 'globe' // This activates the 3D globe view\n    // });\n\n    addCoastlines(libreMap);\n    addStates(libreMap);\n    addLabels(libreMap);\n    \n    \n    if (onReady !== undefined) {\n      onReady(libreMap);\n    }\n  }\n\n  function cleanupMap() {\n    if (map.value) {\n      map.value.remove();\n      map.value = null;\n    }\n  }\n  \n  // { MapLibre Demo Tiles\n  //   container: id,\n  //   style: 'https://demotiles.maplibre.org/style.json', // style URL\n  //   center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n  //   zoom: options.zoom ?? 1 // starting zoom\n  // }\n  \n  // { \n  //   container: id,\n  //   style: 'https://tiles.openfreemap.org/styles/liberty', // style URL\n  //   center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n  //   zoom: options.zoom ?? 1, // starting zoom,\n  //   attributionControl: false\n  // }\n  \n  // { CartoDB Positron\n  //   container: id,\n  //   style: 'https://{s}.basemaps.cartocdn.com/mapboxgl/style_tpl.json', // style URL\n  //   center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n  //   zoom: options.zoom ?? 1 // starting zoom\n  // }  \n  // https://github.com/CartoDB/basemap-styles other \"basemap\" styles\n  function createMap(): Ref<M.Map> {\n    const _map = new M.Map({\n      container: id,\n      // style: 'https://tiles.openfreemap.org/styles/liberty', // style URL\n      style: 'https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json',\n      center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n      zoom: options.zoom ?? 1, // starting zoom,\n      attributionControl: false,\n      \n    }).addControl(new AttributionControl({\n      compact: true,\n    }));\n    \n    _map.on('style.load', setupMap);\n    \n    map.value = _map;\n    return map as unknown as Ref<M.Map>;\n  }\n\n  function setView(latlng: LatLngPair, zoom: number) {\n    if (map.value) {\n      map.value.setCenter([latlng[1], latlng[0]]);\n      map.value.setZoom(zoom);\n    }\n  }\n  \n  function getCenter() {\n    if (map.value) {\n      return map.value.getCenter();\n    }\n  }\n  \n  // function getZoom() {\n  //   if (map.value) {\n  //     return map.value.getZoom();\n  //   }\n  // }\n  \n  function resetView() {\n    if (map.value) {\n      setView(options.loc, options.zoom);\n    }\n  }\n  \n  onMounted(() => {\n    \n  });\n\n  onUnmounted(() => {\n    cleanupMap();\n  });\n\n  return {\n    map: map as Ref<M.Map | null>,\n    createMap,\n    setView,\n    resetView,\n    cleanupMap,\n    getCenter\n  } as MapLibreComposable;\n}\n","import { IControl, Map } from \"maplibre-gl\";\nimport { LngLatPair } from \"@/types\";\n\nexport class CDSMaplibreHomeTool implements IControl {\n  private _container: HTMLElement | undefined;\n  private _button: HTMLButtonElement | undefined;\n  private _homeIcon: HTMLImageElement | undefined;\n  private _map: Map | undefined;\n  private _centerLonLat: [number, number];\n  private _zoom: number;\n  private _onHome: CallableFunction;\n    \n  constructor(centerLonLat: LngLatPair, zoom: number, onHome: CallableFunction ) {\n    this._centerLonLat = centerLonLat;\n    this._zoom = zoom;\n    this._onHome = onHome;\n  }\n    \n  onAdd(map: Map): HTMLElement {\n    \n    this._map = map;\n    this._container = document.createElement('div');\n    this._container.className = 'maplibregl-ctrl maplibregl-ctrl-group maplibre-control-cds-home';\n    \n    this._button = document.createElement('button');\n    this._button.className = 'maplibregl-ctrl-icon maplibre-control-cds-home-button';\n    this._button.type = 'button';\n    this._button.title = 'Home';\n    this._button.addEventListener('click', this._goHome.bind(this));\n    \n    this._homeIcon = document.createElement('img');\n    this._homeIcon.style.padding = '5px';\n    // SVG icon from Font Awesome https://fontawesome.com/icons/house?f=classic&s=solid (free one)\n    const svg = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d=\"M575.8 255.5c0 18-15 32.1-32 32.1l-32 0 .7 160.2c0 2.7-.2 5.4-.5 8.1l0 16.2c0 22.1-17.9 40-40 40l-16 0c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1L416 512l-24 0c-22.1 0-40-17.9-40-40l0-24 0-64c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32 14.3-32 32l0 64 0 24c0 22.1-17.9 40-40 40l-24 0-31.9 0c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2l-16 0c-22.1 0-40-17.9-40-40l0-112c0-.9 0-1.9 .1-2.8l0-69.7-32 0c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z\"/></svg>';\n    this._homeIcon.src = `data:image/svg+xml,${encodeURIComponent(svg)}`;\n    \n    this._button.appendChild(this._homeIcon);\n    this._container.appendChild(this._button);\n    \n    return this._container;\n  }\n  \n  onRemove(): void {\n    // remove the event listener & element\n    this._container?.removeEventListener('click', this._goHome);\n    if (this._container && this._container.parentNode) {\n      this._container.parentNode.removeChild(this._container);\n    }\n  }\n  \n  _goHome() {\n    if (this._map) {\n      this._map.flyTo({\n        center: this._centerLonLat,\n        zoom: this._zoom\n      });\n      this._onHome();\n    }\n  }\n    \n    \n}","import { Ref, ref, watch } from 'vue';\nimport { Map, NavigationControl } from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\nimport { CDSMaplibreHomeTool } from './MaplibreHomeTool';\nimport { LatLngPair, LngLatPair } from '@/types';\n\nexport function usezoomhome(map: Ref<Map | null>, home: LatLngPair, zoom: number, callback: CallableFunction = () => null) {\n\n  const startingCenter = [home[1], home[0]] as LngLatPair;\n  const zoomHome: Ref<null | CDSMaplibreHomeTool> = ref(null);\n  \n\n  \n  function createControl() {\n    const control = new CDSMaplibreHomeTool(startingCenter, zoom, callback);\n    return control;\n  }\n  \n  \n  if (map.value !== null) {\n    map.value.addControl(new NavigationControl({showCompass: false}), 'top-left');\n    zoomHome.value = createControl();\n    map.value.addControl(zoomHome.value, 'top-left');\n  }\n  \n  watch(map, (newValue) => {\n    if (newValue !== null) {\n      newValue.addControl(new NavigationControl({showCompass: false}), 'top-left');\n      zoomHome.value = createControl();\n      newValue.addControl(zoomHome.value, 'top-left');\n    }\n  });\n  \n  \n  return zoomHome.value;\n\n}\n","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { renderSlot as _renderSlot, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\n\nimport { ref, watch, onMounted, onBeforeUnmount } from \"vue\";\nimport { LatLngPair, InitMapOptions } from \"@/types\";\nimport type { PropType } from 'vue';\nimport type { Map, MapEventType, Listener } from 'maplibre-gl';\nimport { useMap } from \"@/composables/maplibre/useMap\";\nimport { usezoomhome } from '@/composables/maplibre/useZoomHome';\n\n\n// should be using a defined Prop type and widthDefaults, but \n// i could not get that to work with the center (LatLngPair is a weird type)\n// but apparently the old options syntax is still good\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MaplibreMap',\n  props: /*@__PURE__*/_mergeModels({\n  mapID: {\n    type: String as PropType<string>,\n    required: true\n  },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  }\n}, {\n    \"latitude\": {\n    default: 0\n  },\n    \"latitudeModifiers\": {},\n    \"longitude\": {\n    default: 0\n  },\n    \"longitudeModifiers\": {},\n    \"zoom\": {\n    default: 0\n  },\n    \"zoomModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"ready\", \"zoomhome\"], [\"update:latitude\", \"update:longitude\", \"update:zoom\"]),\n  setup(__props, { expose: __expose, emit: __emit }) {\n\nconst props = __props;\n\n// define model values that set and return the current map center and zoom\nconst latitude = _useModel<number>(\n  __props, 'latitude');\nconst longitude = _useModel<number>(\n  __props, 'longitude');\nconst zoom = _useModel<number>(\n  __props, 'zoom');\n\n\n\n\nconst showRoadsRef = ref(props.showRoads);\nwatch(() => props.showRoads, (value) => {\n  showRoadsRef.value = value;\n});\n\nconst emit = __emit;\n\n\n\n\n\n\nfunction attachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.on(evt, handler);\n  });\n}\n\nfunction detachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.off(evt, handler);\n  });\n}\n\nconst mapReady = ref(false);\n// https://stackoverflow.com/a/36072263/11594175\nlet promiseResolve: (value: Map) => void;\n// let promiseReject: (reason?: any) => void; // we won't use the reject\nconst whenMapReady: Promise<Map> = new Promise((resolve, _reject) => {\n  promiseResolve = resolve; /**   this is just javascript, so this pulls \n                                  the resolve function\n                                  out of the promise constructor and makes it \n                                  available for us to use\n                            **/\n  // promiseReject = reject;\n});\n\nconst onMapReady = (m: Map) => {\n  console.log(\"Map is ready\", m);\n  mapReady.value = true;\n  emit('ready', m);\n  promiseResolve(m);\n  attachAllEvents(m, props.events);\n};\n\nconst {\n  map,\n  createMap,\n  setView,\n  resetView,\n  getCenter,\n  cleanupMap\n} = useMap(props.mapID, props.initial ?? props.home, showRoadsRef, onMapReady);\n\nwatch(() => [latitude.value, longitude.value, zoom.value], ([newLat, newLng, newZoom]) => {\n  if (map.value && mapReady.value) {\n    setView([newLat, newLng] as LatLngPair, newZoom);\n  }\n});\n\nonMounted(() => {\n\n  const mMap = createMap(); // just use the return value instead of map.value. eases type checking\n  \n  usezoomhome(mMap, props.home.loc, props.home.zoom, () => {\n    emit('zoomhome');\n  });\n\n  mMap.value.on('moveend', () => {\n    if (map.value) {\n      const center = map.value.getCenter();\n      latitude.value = center.lat;\n      longitude.value = center.lng;\n      zoom.value = map.value.getZoom();\n    }\n  });\n  \n});\n\nonBeforeUnmount(() => {\n  if (map.value) {\n    detachAllEvents(map.value, props.events);\n    cleanupMap();\n  }\n});\n\n\n// provide only works downwards and i don't think we need it\n// const MAPLIBRE_PROVIDE_KEY = props.mapID;\n// provide(MAPLIBRE_PROVIDE_KEY, \nconst exposedMapApi = {\n  map,\n  setView,\n  resetView,\n  getCenter,\n  on: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.on(evt, handler);\n    }\n  },\n  off: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.off(evt, handler);\n    }\n  },\n  once: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.once(evt, handler);\n    }\n  },\n  mapReady,\n  onReady: whenMapReady\n};\n\n// we will also expose these on the template ref\n__expose(exposedMapApi);\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: __props.mapID,\n    class: \"tempo-map\",\n    style: _normalizeStyle({ '--width': __props.width, '--height': __props.height })\n  }, [\n    _renderSlot(_ctx.$slots, \"default\")\n  ], 12, _hoisted_1))\n}\n}\n\n})","<template>\n  <!-- this will automatically gets the class maplibregl-map added to it -->\n  <div :id=\"mapID\" class=\"tempo-map\" :style=\"{ '--width': width, '--height': height }\">\n    <slot></slot>\n  </div>\n</template>\n  \n<script setup lang=\"ts\">\nimport { ref, watch, onMounted, onBeforeUnmount, defineModel } from \"vue\";\nimport { LatLngPair, InitMapOptions } from \"@/types\";\nimport type { PropType } from 'vue';\nimport type { Map, MapEventType, Listener } from 'maplibre-gl';\nimport { useMap } from \"@/composables/maplibre/useMap\";\nimport { usezoomhome } from '@/composables/maplibre/useZoomHome';\n\n\n// should be using a defined Prop type and widthDefaults, but \n// i could not get that to work with the center (LatLngPair is a weird type)\n// but apparently the old options syntax is still good\nconst props = defineProps({\n  mapID: {\n    type: String as PropType<string>,\n    required: true\n  },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  }\n});\n\n// define model values that set and return the current map center and zoom\nconst latitude = defineModel<number>(\n  'latitude', \n  {\n    default: 0\n  });\nconst longitude = defineModel<number>(\n  'longitude', \n  {\n    default: 0\n  });\nconst zoom = defineModel<number>(\n  'zoom', \n  {\n    default: 0\n  });\n\n\n\n\nconst showRoadsRef = ref(props.showRoads);\nwatch(() => props.showRoads, (value) => {\n  showRoadsRef.value = value;\n});\n\nconst emit = defineEmits<{\n  (e: 'ready', map: Map): void;\n  (e: 'zoomhome'): void;\n}>();\n\n\n\n\n\n\nfunction attachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.on(evt, handler);\n  });\n}\n\nfunction detachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.off(evt, handler);\n  });\n}\n\nconst mapReady = ref(false);\n// https://stackoverflow.com/a/36072263/11594175\nlet promiseResolve: (value: Map) => void;\n// let promiseReject: (reason?: any) => void; // we won't use the reject\nconst whenMapReady: Promise<Map> = new Promise((resolve, _reject) => {\n  promiseResolve = resolve; /**   this is just javascript, so this pulls \n                                  the resolve function\n                                  out of the promise constructor and makes it \n                                  available for us to use\n                            **/\n  // promiseReject = reject;\n});\n\nconst onMapReady = (m: Map) => {\n  console.log(\"Map is ready\", m);\n  mapReady.value = true;\n  emit('ready', m);\n  promiseResolve(m);\n  attachAllEvents(m, props.events);\n};\n\nconst {\n  map,\n  createMap,\n  setView,\n  resetView,\n  getCenter,\n  cleanupMap\n} = useMap(props.mapID, props.initial ?? props.home, showRoadsRef, onMapReady);\n\nwatch(() => [latitude.value, longitude.value, zoom.value], ([newLat, newLng, newZoom]) => {\n  if (map.value && mapReady.value) {\n    setView([newLat, newLng] as LatLngPair, newZoom);\n  }\n});\n\nonMounted(() => {\n\n  const mMap = createMap(); // just use the return value instead of map.value. eases type checking\n  \n  usezoomhome(mMap, props.home.loc, props.home.zoom, () => {\n    emit('zoomhome');\n  });\n\n  mMap.value.on('moveend', () => {\n    if (map.value) {\n      const center = map.value.getCenter();\n      latitude.value = center.lat;\n      longitude.value = center.lng;\n      zoom.value = map.value.getZoom();\n    }\n  });\n  \n});\n\nonBeforeUnmount(() => {\n  if (map.value) {\n    detachAllEvents(map.value, props.events);\n    cleanupMap();\n  }\n});\n\n\n// provide only works downwards and i don't think we need it\n// const MAPLIBRE_PROVIDE_KEY = props.mapID;\n// provide(MAPLIBRE_PROVIDE_KEY, \nconst exposedMapApi = {\n  map,\n  setView,\n  resetView,\n  getCenter,\n  on: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.on(evt, handler);\n    }\n  },\n  off: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.off(evt, handler);\n    }\n  },\n  once: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.once(evt, handler);\n    }\n  },\n  mapReady,\n  onReady: whenMapReady\n};\n\n// we will also expose these on the template ref\ndefineExpose(exposedMapApi);\n\n\n\n</script>\n  \n<style lang=\"less\">\n\n.tempo-map {\n  width: var(--width);\n  height: var(--height);\n}\n\n.tempo-map canvas.maplibregl-canvas {\n  background-color: whitesmoke;\n}\n\n</style>\n\n","import script from \"./MaplibreMap.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MaplibreMap.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MaplibreMap.vue?vue&type=style&index=0&id=73e25502&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { ref, watch, Ref, MaybeRef, toRef, nextTick, computed } from 'vue';\nimport { renderingRule, stretches, colorramps, RenderingRuleOptions, ColorRamps } from '../ImageLayerConfig';\nimport { Map, type MapSourceDataEvent } from 'maplibre-gl';\nimport { validate as uuidValidate } from \"uuid\";\n\nimport { ImageService } from 'mapbox-gl-esri-sources';\nimport { useEsriTimesteps } from '../../composables/useEsriTimesteps';\nimport { MoleculeType } from '../utils';\n\n\ninterface UseEsriLayer {\n  esriImageSource: Ref<maplibregl.RasterTileSource | null>;\n  opacity: Ref<number>;\n  noEsriData: Ref<boolean>;\n  loadingEsriTimeSteps: Ref<boolean>;\n  esriTimesteps: Ref<number[]>;\n  updateEsriOpacity: (value?: number | null | undefined) => void;\n  updateEsriTimeRange: () => void;\n  addEsriSource: (map: Map) => void;\n  renderOptions: Ref<RenderingRuleOptions>;\n}\n\nexport function useEsriLayer(initialMolecule: MaybeRef<MoleculeType>,\n  timestamp: Ref<number | null>,\n  opacity: MaybeRef<number>,\n  fetchOnMount=true): UseEsriLayer {\n\n  const esriLayerId = 'esri-source';\n  const esriImageSource = ref<maplibregl.RasterTileSource | null>(null);\n  const map = ref<Map | null>(null);\n  const molecule = toRef(initialMolecule);\n\n  const { url, variable, esriTimesteps } = useEsriTimesteps(molecule, fetchOnMount);\n\n  const opacityRef = toRef(opacity);\n  const noEsriData = ref(false);\n  const loadingEsriTimeSteps = ref(false);\n  const renderOptions = ref<RenderingRuleOptions>({\n    range: stretches[variable.value],\n    colormap: colorramps[variable.value],\n  });\n\n  \n  const options = computed(() => {\n    return  {\n      'format': 'png',\n      'pixelType': 'U8',\n      'size': '256,256',\n      'transparent': true,\n      'bboxSR': 3857,\n      'imageSR': 3857,\n      'bbox': '{bbox-epsg-3857}',\n      'interpolation': 'RSP_NearestNeighbor',\n      'renderingRule': renderingRule(renderOptions.value.range, renderOptions.value.colormap),\n    };\n  });\n  // const _esriImageOptions = Object.entries(options).map(([key, value]) => `${key}=${value}`).join('&');\n  \n  function addLayer(map: Map | null | undefined) {\n\n    if (map && !map.getLayer(esriLayerId)) {\n      map.addLayer({\n        id: esriLayerId,\n        type: 'raster',\n        source: esriLayerId,\n        paint: {\n          'raster-resampling': 'nearest',\n          'raster-opacity': opacityRef.value ?? 0.8,\n        },\n      });\n      let index = -1;\n      for (const [idx, layer] of Object.entries(map.getStyle().layers)) {\n        if (uuidValidate(layer.id)) {\n          index = Number(idx) - 1;\n        }\n      }\n      if (index >= 0) {\n        map.moveLayer(esriLayerId, map.getStyle().layers[index].id);\n      }\n    }\n  }\n  \n  function removeLayer(map: Map | null | undefined) {\n    if (map && map.getLayer(esriLayerId)) {\n      map.removeLayer(esriLayerId);\n    }\n  }\n  \n  const dynamicMapService = ref<ImageService | null>(null);\n  \n  function onSourceLoad(e: MapSourceDataEvent) {\n    // console.log('Source data event: ', e.sourceId, e.isSourceLoaded);\n    if (e.sourceId === esriLayerId && e.isSourceLoaded && map.value?.getSource(esriLayerId)) {\n      console.log('ESRI source loaded with time', new Date(timestamp.value ?? 0 ));\n      esriImageSource.value = map.value?.getSource(esriLayerId) as maplibregl.RasterTileSource;\n      updateEsriOpacity();\n      updateEsriTimeRange();\n      map.value?.off('sourcedata', onSourceLoad);\n    }\n  }\n  \n  function createImageService(map: Map, url: string, options) {\n    return new ImageService(\n      esriLayerId,\n      map,\n      {\n        url: url,\n        ...options\n      },\n      {\n        tileSize: 256,\n      }\n    );\n    \n  }\n\n  function addEsriSource(mMap: Map) {\n    if (!mMap) return;\n    map.value = mMap;\n    \n    dynamicMapService.value = createImageService(mMap, url.value, options.value);\n\n    addLayer(mMap);\n    // this event will run until the source is loaded\n    mMap.on('sourcedata', onSourceLoad);\n  }\n  \n  function hasEsriSource() {\n    return map.value?.getSource(esriLayerId) !== undefined;\n  }\n\n  \n  function updateEsriTimeRange() {\n    if (!map.value) return;\n    if (timestamp.value === null) return;\n    const time = timestamp.value;\n\n    const nearest = esriTimesteps.value.length > 0 \n      ? esriTimesteps.value.reduce((a, b) => Math.abs(b - time) < Math.abs(a - time) ? b : a)\n      : time - 1000 * 60 * 15; \n    noEsriData.value = Math.abs((nearest - time) / (1000 * 60)) > 60;\n    // noEsriData.value = nearest > 1752595200000; // Example condition (July 15, 2025 12pm ET for testing)\n    if (noEsriData.value) {\n      console.error('No ESRI data available for the selected time');\n    }\n\n    if (dynamicMapService.value && !noEsriData.value) {\n      dynamicMapService.value.setDate(new Date(nearest), new Date(nearest * 2));\n    } else if (!noEsriData.value) {\n      // if there is esri coverage, then this is the issue\n      console.error('Dynamic Map Service is not initialized');\n    }\n  }\n\n  watch(esriTimesteps, _timesteps => {\n    nextTick(updateEsriTimeRange);\n  });\n\n\n  watch(timestamp, (_value) => {\n    console.log('esri imageset timestamp set to ', _value ? new Date(_value) : null);\n    if ( hasEsriSource() ) {\n      updateEsriTimeRange();\n    } else {\n      console.error('ESRI source not yet available');\n    }\n  });\n  \n  \n  function updateEsriOpacity(value: number | null | undefined = undefined) {\n    if (map.value) {\n      map.value.setPaintProperty(esriLayerId, 'raster-opacity', value ?? opacityRef.value ?? 0.8);\n    }\n  }\n\n  watch(molecule, (_newMol: MoleculeType) => {\n    dynamicMapService.value.esriServiceOptions.url = url.value;\n    dynamicMapService.value.setRenderingRule(renderingRule(renderOptions.value.range, renderOptions.value.colormap));\n  });\n  \n  function updateStretch(vmin: number, vmax: number) {\n    if (dynamicMapService.value) {\n      dynamicMapService.value.setRenderingRule(renderingRule([vmin, vmax], renderOptions.value.colormap));\n    }\n  }\n  \n  function updateColormap(colormap: ColorRamps) {\n    if (dynamicMapService.value) {\n      dynamicMapService.value.setRenderingRule(renderingRule(renderOptions.value.range, colormap));\n    }\n  }\n  \n  watch(() => renderOptions.value.range, (newRange) => {\n    console.log('Range changed to ', newRange);\n    updateStretch(newRange[0], newRange[1]);\n  });\n  watch(() => renderOptions.value.colormap, (newColormap) => {\n    console.log('Colormap changed to ', newColormap);\n    updateColormap(newColormap);\n  });\n  \n  watch(variable, () => {\n    renderOptions.value.range = stretches[variable.value];\n    renderOptions.value.colormap = colorramps[variable.value];\n  });\n\n  watch(opacityRef, (_value: number) => {\n    updateEsriOpacity(_value);\n  });\n\n  watch(noEsriData, (value: boolean) => {\n    if (value) {\n      updateEsriOpacity(0);\n      removeLayer(map.value as Map | null);\n    } else {\n      addLayer(map.value as Map | null);\n    }\n  });\n\n  return {\n    esriImageSource,\n    opacity: opacityRef,\n    noEsriData,\n    esriTimesteps,\n    loadingEsriTimeSteps,\n    updateEsriOpacity,\n    updateEsriTimeRange,\n    addEsriSource,\n    renderOptions,\n  } as UseEsriLayer;\n}\n\n\n","import {ref, watch, Ref, onUnmounted} from 'vue';\n\n\nimport fieldOfRegard from \"@/assets/TEMPO_FOR.json\";\nimport augustFieldOfRegard from \"@/assets/august_for.json\";\n\n\nimport M from 'maplibre-gl';\n\nexport interface MaplibreFieldOfRegardComposable {\n  addFieldOfRegard: () => void;\n  showFieldOfRegard: Ref<boolean>;\n  updateFieldOfRegard: () => void;\n  fieldOfRegardLayer: Ref<M.GeoJSONSource | null>;\n}\n\nexport function useFieldOfRegard(\n  date: Ref<Date | null>,\n  map: Ref<M.Map | null>\n): MaplibreFieldOfRegardComposable {\n\n  const showFieldOfRegard = ref(true);\n  let usingAugust = true as boolean | null;\n  const fieldOfRegardLayer = ref<M.GeoJSONSource | null>(null);\n  const fieldOfRegardLayerId = 'field-of-regard';\n\n\n  function createFoRLayer() {\n    if (!map.value) {\n      console.warn(\"Map is not initialized, cannot create Field of Regard layer.\");\n      return;\n    }\n    // Create the Source if it doesn't exist\n    let source = map.value.getSource(fieldOfRegardLayerId);\n    if (source === undefined) {\n      map.value.addSource(fieldOfRegardLayerId, {\n        'type': 'geojson',\n        data: fieldOfRegard as GeoJSON.GeometryCollection,\n      });\n\n      source = map.value.getSource(fieldOfRegardLayerId);\n    }\n\n    // Create the layer if it doesn't exist\n    let layer = map.value.getLayer(fieldOfRegardLayerId);\n    if (layer === undefined) {\n      map.value.addLayer({\n        id: fieldOfRegardLayerId,\n        type: 'line',\n        source: fieldOfRegardLayerId,\n        paint: {\n          \"line-color\": \"#c10124\",\n          \"line-width\": 1,\n          \"line-opacity\": 0.8,\n        }\n      });\n\n      layer = map.value.getLayer(fieldOfRegardLayerId);\n    }\n\n    if (source) {\n      fieldOfRegardLayer.value = source as M.GeoJSONSource;\n    }\n  }\n\n  function clearFoR() {\n    if (fieldOfRegardLayer.value) {\n      if (fieldOfRegardLayer.value.map.getLayer(fieldOfRegardLayerId)) {\n        fieldOfRegardLayer.value.map\n          .removeLayer(fieldOfRegardLayerId)\n          .removeSource(fieldOfRegardLayerId);\n      }\n    }\n  }\n\n\n  function updateFieldOfRegard() {\n\n    if (date.value !== null && date.value.getUTCFullYear() === 2023 && date.value.getUTCMonth() === 7) {\n      fieldOfRegardLayer.value?.setData(augustFieldOfRegard as GeoJSON.GeometryCollection);\n      usingAugust = true;\n    } else {\n      if (usingAugust) { // only want this to run if it has to\n        fieldOfRegardLayer.value?.setData(fieldOfRegard as GeoJSON.GeometryCollection);\n        usingAugust = false;\n      }\n    }\n  }\n\n  function addFieldOfRegard() {\n    if (showFieldOfRegard.value && map.value) {\n      if (map.value.loaded()) {\n        createFoRLayer();\n      } else {\n        // style.load as already fired depending on where this is placed\n        // so we use 'load' event of the map itself\n        map.value.on('load', () => {\n          createFoRLayer();\n        });\n      }\n    }\n  }\n\n  watch(showFieldOfRegard, (show: boolean) => {\n    if (show) {\n      createFoRLayer();\n    } else if (map.value) {\n      clearFoR();\n    }\n  });\n\n  watch(date, updateFieldOfRegard);\n\n\n  onUnmounted(() => {\n    if (map.value) {\n      clearFoR();\n    }\n  });\n\n  return {\n    addFieldOfRegard,\n    showFieldOfRegard,\n    updateFieldOfRegard,\n    fieldOfRegardLayer: fieldOfRegardLayer as Ref<M.GeoJSONSource | null>,\n  };\n}\n","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, renderSlot as _renderSlot, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"d-flex flex-column align-center justify-center ga-2\" }\n\nimport { ref, watch, toRef, computed, type Ref, useTemplateRef, onMounted } from 'vue';\nimport type { PropType } from 'vue';\nimport type { Map } from 'maplibre-gl';\nimport MaplibreMap from './MaplibreMap.vue';\nimport { useEsriLayer } from '@/esri/maplibre/useEsriImageLayer';\nimport { useFieldOfRegard } from '@/composables/maplibre/useFieldOfRegard';\nimport { type MoleculeType } from '@/esri/utils';\nimport type { InitMapOptions, LatLngPair } from '@/types';\nimport type { MapEventType, Listener } from 'maplibre-gl';\nimport type { AvailableColorMaps } from \"@/colormaps\";\n\nimport { useTempoStore } from \"@/stores/app\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'EsriMap',\n  props: /*@__PURE__*/_mergeModels({\n  mapID: { type: String, required: true },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions | null>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    required: false,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  // ESRI-specific props\n  timestamp: { \n    type: Number as PropType<number | null>, \n    required: false, \n    default: null \n  },\n  molecule: { \n    type: String as PropType<MoleculeType>, \n    required: true \n  },\n  opacity: { \n    type: Number, \n    required: false, \n    default: 0.9 \n  },\n  showFieldOfRegard: { \n    type: Boolean, \n    required: false, \n    default: true \n  }\n}, {\n    \"latitude\": { default: 0 },\n    \"latitudeModifiers\": {},\n    \"longitude\": { default: 0 },\n    \"longitudeModifiers\": {},\n    \"zoom\": { default: 0 },\n    \"zoomModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"ready\", \"zoomhome\", \"colormap\", \"esri-timesteps-loaded\"], [\"update:latitude\", \"update:longitude\", \"update:zoom\"]),\n  setup(__props, { expose: __expose, emit: __emit }) {\n\nconst store = useTempoStore();\n\nconst props = __props;\n\nconst emit = __emit;\n\n// Reference to inner MaplibreMap exposed API\nconst innerMap = useTemplateRef<InstanceType<typeof MaplibreMap> | null>(\"innerMap\");\nconst map = ref<Map | null>(null);\n\n// Pass-through models for view state\nconst latitude = _useModel<number>(__props, 'latitude');\nconst longitude = _useModel<number>(__props, 'longitude');\nconst zoom = _useModel<number>(__props, 'zoom');\n\n// add a watcher to console log the lat/long/zoom changes\nwatch([latitude, longitude, zoom], ([newLat, newLng, newZoom]) => {\n  console.log(`Map view changed: lat=${newLat}, lng=${newLng}, zoom=${newZoom}`);\n});\n\n// Internal readiness tracking: single concept (base map ready)\nconst mapReady = ref(false);              // Underlying Maplibre map style loaded\nlet promiseResolve: (value: Map) => void;\nconst onReady: Promise<Map> = new Promise((resolve) => { promiseResolve = resolve; });\n\nconst molecule = computed(() => props.molecule);\n\n//https://vuejs.org/api/reactivity-utilities#toref (two-way)\n// can also do toRef(()=>props.timestamp) in v 3.3+\nconst timestampRef = toRef(props, 'timestamp');\nconst opacityRef = toRef(props, 'opacity');\n\n// ESRI layer composable\nconst { loadingEsriTimeSteps, addEsriSource, esriTimesteps, renderOptions } = useEsriLayer(\n  molecule,\n  timestampRef,\n  opacityRef\n);\n\nwatch(esriTimesteps, (newSteps, old) => {\n  if (newSteps.length > 0 && newSteps !== old) {\n    emit('esri-timesteps-loaded', newSteps);\n  }\n});\n\nwatch(() => renderOptions.value.colormap, cmap => emit(\"colormap\", cmap));\n\nwatch(map, (newMap, oldMap) => {\n  if (oldMap) {\n    store.deregisterMap(oldMap);\n  }\n  if (newMap) {\n    store.registerMap(newMap);\n  }\n});\n\nconst singleDateSelected = computed(() => {\n  // a date object with the current day\n  if (props.timestamp) {\n    const dt = new Date(props.timestamp);\n    return new Date(dt.getFullYear(), dt.getMonth(), dt.getDate());\n  }\n  return null;\n});\n// Field of Regard handling\nconst { \n  addFieldOfRegard, \n  showFieldOfRegard: internalShowFieldOfRegard, \n  updateFieldOfRegard \n} = useFieldOfRegard(singleDateSelected, map as Ref<Map | null>);\n  \ninternalShowFieldOfRegard.value = props.showFieldOfRegard;\nwatch(() => props.showFieldOfRegard, (val) => {\n  internalShowFieldOfRegard.value = val;\n});\n\nfunction onInnerMapReady(m: Map) {\n  // Resolve base map readiness immediately\n  mapReady.value = true;\n  promiseResolve(m);\n  console.log('onReady promise on ref exposed API resolved');\n  map.value = m;\n  // Attach ESRI source right after base readiness (microtask keeps UI snappy)\n  addEsriSource(m);\n  console.log('ESRI source added to map');\n  emit('ready', m);\n  console.log('map ready event emitted');\n}\n\nonMounted(() => {\n  if (internalShowFieldOfRegard.value) {\n    updateFieldOfRegard();\n    addFieldOfRegard();\n  }\n});\n\n// Forward selected parts of inner MaplibreMap API after it's ready\nconst exposedApi = {\n  map,\n  mapReady,\n  onReady, // Promise resolves when base map ready\n  // Forwarded methods\n  setView: (center: LatLngPair, zoom: number) => innerMap.value?.setView(center, zoom),\n  resetView: () => innerMap.value?.resetView(),\n  getCenter: () => innerMap.value?.getCenter(),\n  on: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.on(type, listener),\n  off: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.off(type, listener),\n  once: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.once(type, listener),\n  // ESRI specifics\n  esriTimesteps,\n  loadingEsriTimeSteps,\n  renderOptions,\n};\n\n__expose(exposedApi);\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_progress_circular = _resolveComponent(\"v-progress-circular\")!\n  const _component_v_overlay = _resolveComponent(\"v-overlay\")!\n\n  return (_openBlock(), _createBlock(MaplibreMap, {\n    mapID: __props.mapID,\n    home: __props.home,\n    initial: __props.initial,\n    \"show-roads\": __props.showRoads,\n    events: __props.events,\n    width: __props.width,\n    height: __props.height,\n    latitude: latitude.value,\n    longitude: longitude.value,\n    zoom: zoom.value,\n    \"onUpdate:latitude\": _cache[0] || (_cache[0] = (v)=> latitude.value = v),\n    \"onUpdate:longitude\": _cache[1] || (_cache[1] = (v)=> longitude.value = v),\n    \"onUpdate:zoom\": _cache[2] || (_cache[2] = (v)=> zoom.value = v),\n    ref_key: \"innerMap\",\n    ref: innerMap,\n    onReady: onInnerMapReady,\n    onZoomhome: _cache[3] || (_cache[3] = ($event: any) => (_ctx.$emit('zoomhome')))\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_overlay, {\n        \"model-value\": _unref(loadingEsriTimeSteps),\n        style: {\"z-index\":\"1000\"},\n        class: \"align-center justify-center\",\n        contained: \"\",\n        opacity: \".8\"\n      }, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_1, [\n            _cache[4] || (_cache[4] = _createElementVNode(\"label\", { class: \"text-white\" }, \"Fetching time steps from NASA Earthdata GIS service...\", -1)),\n            _createVNode(_component_v_progress_circular, {\n              size: 80,\n              width: 12,\n              indeterminate: _unref(loadingEsriTimeSteps),\n              color: \"#092088\"\n            }, null, 8, [\"indeterminate\"])\n          ])\n        ]),\n        _: 1\n      }, 8, [\"model-value\"]),\n      _renderSlot(_ctx.$slots, \"default\")\n    ]),\n    _: 3\n  }, 8, [\"mapID\", \"home\", \"initial\", \"show-roads\", \"events\", \"width\", \"height\", \"latitude\", \"longitude\", \"zoom\"]))\n}\n}\n\n})","<template>\n  <MaplibreMap\n    :mapID=\"mapID\"\n    :home=\"home\"\n    :initial=\"initial\"\n    :show-roads=\"showRoads\"\n    :events=\"events\"\n    :width=\"width\"\n    :height=\"height\"\n    :latitude=\"latitude\"\n    :longitude=\"longitude\"\n    :zoom=\"zoom\"\n    @update:latitude=\"(v:number)=> latitude = v\"\n    @update:longitude=\"(v:number)=> longitude = v\"\n    @update:zoom=\"(v:number)=> zoom = v\"\n    ref=\"innerMap\"\n    @ready=\"onInnerMapReady\"\n    @zoomhome=\"$emit('zoomhome')\"\n  >\n    <!-- Loading overlay while fetching ESRI time steps -->\n    <v-overlay\n      :model-value=\"loadingEsriTimeSteps\"\n      style=\"z-index: 1000;\"\n      class=\"align-center justify-center\"\n      contained\n      opacity=\".8\"\n    >\n      <div class=\"d-flex flex-column align-center justify-center ga-2\">\n        <label class=\"text-white\">Fetching time steps from NASA Earthdata GIS service...</label>\n        <v-progress-circular\n          :size=\"80\"\n          :width=\"12\"\n          :indeterminate=\"loadingEsriTimeSteps\"\n          color=\"#092088\"\n        />\n      </div>\n    </v-overlay>\n    <slot />\n  </MaplibreMap>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, toRef, computed, defineExpose, type Ref, useTemplateRef, onMounted, defineModel } from 'vue';\nimport type { PropType } from 'vue';\nimport type { Map } from 'maplibre-gl';\nimport MaplibreMap from './MaplibreMap.vue';\nimport { useEsriLayer } from '@/esri/maplibre/useEsriImageLayer';\nimport { useFieldOfRegard } from '@/composables/maplibre/useFieldOfRegard';\nimport { type MoleculeType } from '@/esri/utils';\nimport type { InitMapOptions, LatLngPair } from '@/types';\nimport type { MapEventType, Listener } from 'maplibre-gl';\nimport type { AvailableColorMaps } from \"@/colormaps\";\n\nimport { useTempoStore } from \"@/stores/app\";\n\nconst store = useTempoStore();\n\nconst props = defineProps({\n  mapID: { type: String, required: true },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions | null>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    required: false,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  // ESRI-specific props\n  timestamp: { \n    type: Number as PropType<number | null>, \n    required: false, \n    default: null \n  },\n  molecule: { \n    type: String as PropType<MoleculeType>, \n    required: true \n  },\n  opacity: { \n    type: Number, \n    required: false, \n    default: 0.9 \n  },\n  showFieldOfRegard: { \n    type: Boolean, \n    required: false, \n    default: true \n  }\n});\n\nconst emit = defineEmits<{\n  // Single, simplified ready event: base map (Maplibre) is ready.\n  (e:'ready', map: Map): void; \n  (e:'zoomhome'): void; \n  (e: 'colormap', colormap: AvailableColorMaps): void;\n  // Timesteps loaded (can fire multiple times e.g., molecule switch)\n  (e:'esri-timesteps-loaded', steps: number[]): void;\n}>();\n\n// Reference to inner MaplibreMap exposed API\nconst innerMap = useTemplateRef<InstanceType<typeof MaplibreMap> | null>(\"innerMap\");\nconst map = ref<Map | null>(null);\n\n// Pass-through models for view state\nconst latitude = defineModel<number>('latitude', { default: 0 });\nconst longitude = defineModel<number>('longitude', { default: 0 });\nconst zoom = defineModel<number>('zoom', { default: 0 });\n\n// add a watcher to console log the lat/long/zoom changes\nwatch([latitude, longitude, zoom], ([newLat, newLng, newZoom]) => {\n  console.log(`Map view changed: lat=${newLat}, lng=${newLng}, zoom=${newZoom}`);\n});\n\n// Internal readiness tracking: single concept (base map ready)\nconst mapReady = ref(false);              // Underlying Maplibre map style loaded\nlet promiseResolve: (value: Map) => void;\nconst onReady: Promise<Map> = new Promise((resolve) => { promiseResolve = resolve; });\n\nconst molecule = computed(() => props.molecule);\n\n//https://vuejs.org/api/reactivity-utilities#toref (two-way)\n// can also do toRef(()=>props.timestamp) in v 3.3+\nconst timestampRef = toRef(props, 'timestamp');\nconst opacityRef = toRef(props, 'opacity');\n\n// ESRI layer composable\nconst { loadingEsriTimeSteps, addEsriSource, esriTimesteps, renderOptions } = useEsriLayer(\n  molecule,\n  timestampRef,\n  opacityRef\n);\n\nwatch(esriTimesteps, (newSteps, old) => {\n  if (newSteps.length > 0 && newSteps !== old) {\n    emit('esri-timesteps-loaded', newSteps);\n  }\n});\n\nwatch(() => renderOptions.value.colormap, cmap => emit(\"colormap\", cmap));\n\nwatch(map, (newMap, oldMap) => {\n  if (oldMap) {\n    store.deregisterMap(oldMap);\n  }\n  if (newMap) {\n    store.registerMap(newMap);\n  }\n});\n\nconst singleDateSelected = computed(() => {\n  // a date object with the current day\n  if (props.timestamp) {\n    const dt = new Date(props.timestamp);\n    return new Date(dt.getFullYear(), dt.getMonth(), dt.getDate());\n  }\n  return null;\n});\n// Field of Regard handling\nconst { \n  addFieldOfRegard, \n  showFieldOfRegard: internalShowFieldOfRegard, \n  updateFieldOfRegard \n} = useFieldOfRegard(singleDateSelected, map as Ref<Map | null>);\n  \ninternalShowFieldOfRegard.value = props.showFieldOfRegard;\nwatch(() => props.showFieldOfRegard, (val) => {\n  internalShowFieldOfRegard.value = val;\n});\n\nfunction onInnerMapReady(m: Map) {\n  // Resolve base map readiness immediately\n  mapReady.value = true;\n  promiseResolve(m);\n  console.log('onReady promise on ref exposed API resolved');\n  map.value = m;\n  // Attach ESRI source right after base readiness (microtask keeps UI snappy)\n  addEsriSource(m);\n  console.log('ESRI source added to map');\n  emit('ready', m);\n  console.log('map ready event emitted');\n}\n\nonMounted(() => {\n  if (internalShowFieldOfRegard.value) {\n    updateFieldOfRegard();\n    addFieldOfRegard();\n  }\n});\n\n// Forward selected parts of inner MaplibreMap API after it's ready\nconst exposedApi = {\n  map,\n  mapReady,\n  onReady, // Promise resolves when base map ready\n  // Forwarded methods\n  setView: (center: LatLngPair, zoom: number) => innerMap.value?.setView(center, zoom),\n  resetView: () => innerMap.value?.resetView(),\n  getCenter: () => innerMap.value?.getCenter(),\n  on: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.on(type, listener),\n  off: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.off(type, listener),\n  once: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.once(type, listener),\n  // ESRI specifics\n  esriTimesteps,\n  loadingEsriTimeSteps,\n  renderOptions,\n};\n\ndefineExpose(exposedApi);\n\n</script>\n\n<style scoped lang=\"less\">\n#map-legend {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n  background: rgba(255,255,255,0.85);\n  padding: 4px 8px;\n  font-size: 0.8rem;\n  border-radius: 4px;\n  z-index: 500;\n  pointer-events: none;\n}\n.line-legend {\n  border: none;\n  border-top: 2px solid #c10124;\n  margin: 0 0 2px 0;\n}\n</style>\n","import script from \"./EsriMap.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EsriMap.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EsriMap.vue?vue&type=style&index=0&id=94ab086e&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-94ab086e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock, renderSlot as _renderSlot, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  style: {\"text-align\":\"center\"}\n}\nconst _hoisted_2 = [\"innerHTML\"]\nconst _hoisted_3 = { class: \"unit-label\" }\nconst _hoisted_4 = {\n  key: 1,\n  style: {\"text-align\":\"center\"}\n}\nconst _hoisted_5 = [\"innerHTML\"]\nconst _hoisted_6 = {\n  key: 0,\n  style: {\"text-align\":\"center\"}\n}\nconst _hoisted_7 = [\"innerHTML\"]\nconst _hoisted_8 = { class: \"unit-label\" }\nconst _hoisted_9 = {\n  key: 1,\n  style: {\"text-align\":\"center\"}\n}\nconst _hoisted_10 = [\"innerHTML\"]\n\nimport { computed } from \"vue\";\n\ninterface Props {\n  horizontal: boolean;\n  currentColormap: (x: number) => string;\n  colorMap: string;\n  startValue: number;\n  endValue: number;\n  moleculeLabel: string; // can contain html\n  cbarScale: number;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MapColorbarWrap',\n  props: {\n    horizontal: { type: Boolean },\n    currentColormap: { type: Function },\n    colorMap: {},\n    startValue: {},\n    endValue: {},\n    moleculeLabel: {},\n    cbarScale: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\n\nconst scalePower = computed(() => {\n  const p = Math.log10(props.cbarScale);\n  return Number.isFinite(p) ? p : 0;\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_colorbar_horizontal = _resolveComponent(\"colorbar-horizontal\")!\n  const _component_colorbar = _resolveComponent(\"colorbar\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([__props.horizontal ? 'map-colorbar-wrap-horizontal' : 'map-colorbar-wrap'])\n  }, [\n    (__props.horizontal)\n      ? (_openBlock(), _createBlock(_component_colorbar_horizontal, {\n          key: 0,\n          backgroundColor: \"transparent\",\n          nsteps: 255,\n          cmap: __props.currentColormap,\n          cmapName: __props.colorMap,\n          \"start-value\": __props.startValue,\n          \"end-value\": __props.endValue,\n          extend: true\n        }, {\n          label: _withCtx(() => [\n            (scalePower.value !== 0)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                  _cache[4] || (_cache[4] = _createTextVNode(\" Amount of \", -1)),\n                  _createElementVNode(\"span\", { innerHTML: __props.moleculeLabel }, null, 8, _hoisted_2),\n                  _createElementVNode(\"span\", _hoisted_3, [\n                    _cache[0] || (_cache[0] = _createTextVNode(\"(10\", -1)),\n                    _createElementVNode(\"sup\", null, _toDisplayString(scalePower.value), 1),\n                    _cache[1] || (_cache[1] = _createTextVNode(\" mol/cm\", -1)),\n                    _cache[2] || (_cache[2] = _createElementVNode(\"sup\", null, \"2\", -1)),\n                    _cache[3] || (_cache[3] = _createTextVNode(\")\", -1))\n                  ])\n                ]))\n              : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                  _cache[5] || (_cache[5] = _createTextVNode(\" Amount of \", -1)),\n                  _createElementVNode(\"span\", { innerHTML: __props.moleculeLabel }, null, 8, _hoisted_5),\n                  _cache[6] || (_cache[6] = _createElementVNode(\"span\", { class: \"unit-label\" }, [\n                    _createTextVNode(\" molecules/cm\"),\n                    _createElementVNode(\"sup\", null, \"2\")\n                  ], -1))\n                ]))\n          ]),\n          _: 1\n        }, 8, [\"cmap\", \"cmapName\", \"start-value\", \"end-value\"]))\n      : _createCommentVNode(\"\", true),\n    _renderSlot(_ctx.$slots, \"default\"),\n    (!__props.horizontal)\n      ? (_openBlock(), _createBlock(_component_colorbar, {\n          key: 1,\n          backgroundColor: \"transparent\",\n          nsteps: 255,\n          cmap: __props.currentColormap,\n          cmapName: __props.colorMap,\n          \"start-value\": __props.startValue,\n          \"end-value\": __props.endValue,\n          extend: true\n        }, {\n          label: _withCtx(() => [\n            (scalePower.value !== 0)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                  _cache[11] || (_cache[11] = _createTextVNode(\" Amount of \", -1)),\n                  _createElementVNode(\"span\", { innerHTML: __props.moleculeLabel }, null, 8, _hoisted_7),\n                  _createElementVNode(\"span\", _hoisted_8, [\n                    _cache[7] || (_cache[7] = _createTextVNode(\"(10\", -1)),\n                    _createElementVNode(\"sup\", null, _toDisplayString(scalePower.value), 1),\n                    _cache[8] || (_cache[8] = _createTextVNode(\" mol/cm\", -1)),\n                    _cache[9] || (_cache[9] = _createElementVNode(\"sup\", null, \"2\", -1)),\n                    _cache[10] || (_cache[10] = _createTextVNode(\")\", -1))\n                  ])\n                ]))\n              : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                  _cache[12] || (_cache[12] = _createTextVNode(\" Amount of \", -1)),\n                  _createElementVNode(\"span\", { innerHTML: __props.moleculeLabel }, null, 8, _hoisted_10),\n                  _cache[13] || (_cache[13] = _createElementVNode(\"span\", { class: \"unit-label\" }, [\n                    _createTextVNode(\"(molecules/cm\"),\n                    _createElementVNode(\"sup\", null, \"2\"),\n                    _createTextVNode(\")\")\n                  ], -1))\n                ]))\n          ]),\n          _: 1\n        }, 8, [\"cmap\", \"cmapName\", \"start-value\", \"end-value\"]))\n      : _createCommentVNode(\"\", true)\n  ], 2))\n}\n}\n\n})","<template>\n  <div :class=\"[horizontal ? 'map-colorbar-wrap-horizontal' : 'map-colorbar-wrap']\">\n    <colorbar-horizontal\n      v-if=\"horizontal\"\n      backgroundColor=\"transparent\"\n      :nsteps=\"255\"\n      :cmap=\"currentColormap\"\n      :cmapName=\"colorMap\"\n      :start-value=\"startValue\"\n      :end-value=\"endValue\"\n      :extend=\"true\"\n    >\n      <template v-slot:label>\n        <div v-if=\"scalePower !== 0\" style=\"text-align: center;\">\n          Amount of <span v-html=\"moleculeLabel\"></span>\n          <span class=\"unit-label\">(10<sup>{{ scalePower }}</sup> mol/cm<sup>2</sup>)</span>\n        </div>\n        <div v-else style=\"text-align: center;\">\n          Amount of <span v-html=\"moleculeLabel\"></span>\n          <span class=\"unit-label\"> molecules/cm<sup>2</sup></span>\n        </div>\n      </template>\n    </colorbar-horizontal>\n\n    <slot />\n\n    <colorbar\n      v-if=\"!horizontal\"\n      backgroundColor=\"transparent\"\n      :nsteps=\"255\"\n      :cmap=\"currentColormap\"\n      :cmapName=\"colorMap\"\n      :start-value=\"startValue\"\n      :end-value=\"endValue\"\n      :extend=\"true\"\n    >\n      <template v-slot:label>\n        <div v-if=\"scalePower !== 0\" style=\"text-align: center;\">\n          Amount of <span v-html=\"moleculeLabel\"></span>\n          <span class=\"unit-label\">(10<sup>{{ scalePower }}</sup> mol/cm<sup>2</sup>)</span>\n        </div>\n        <div v-else style=\"text-align: center;\">\n          Amount of <span v-html=\"moleculeLabel\"></span>\n          <span class=\"unit-label\">(molecules/cm<sup>2</sup>)</span>\n        </div>\n      </template>\n    </colorbar>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from \"vue\";\n\ninterface Props {\n  horizontal: boolean;\n  currentColormap: (x: number) => string;\n  colorMap: string;\n  startValue: number;\n  endValue: number;\n  moleculeLabel: string; // can contain html\n  cbarScale: number;\n}\nconst props = defineProps<Props>();\n\nconst scalePower = computed(() => {\n  const p = Math.log10(props.cbarScale);\n  return Number.isFinite(p) ? p : 0;\n});\n</script>\n\n<style lang=\"less\">\n\n// hopefully unobtrusive wrapper \n.map-colorbar-wrap {\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  height: 100%;\n}\n.map-colorbar-wrap-horizontal {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n}\n\n\n// the main colorbar containers\n.colorbar-container {\n  flex-grow: 0;\n  flex-shrink: 1;\n\n  .unit-label {\n    font-size: .95em;\n  }\n}\n\n.colorbar-container-horizontal {\n  margin-top: 1rem;\n  margin-bottom: 0.5rem;\n  z-index: 5000;\n  --height: 0.75rem;\n}\n\n// fix the sub/sup alignment in the colorbar labels\n.colorbar-container sub {\n  vertical-align: sub !important;\n  line-height: 1.25 !important;\n}\n\n.colorbar-container sup {\n  vertical-align: super !important;\n  line-height: 1.25 !important;\n}\n\n.colorbar-container sub,\n.colorbar-container sup {\n  top: 0 !important;\n}\n\n</style>\n","import script from \"./MapColorbarWrap.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapColorbarWrap.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapColorbarWrap.vue?vue&type=style&index=0&id=26099026&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { ref, type Ref } from \"vue\";\nimport { Map, Popup, type GeoJSONSource } from \"maplibre-gl\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { createHeatmapColorMap, previewColormapInConsole } from \"@/colormaps/utils\";\n\n\n\n// const steps = Array.from({ length: 20 }, (_, i) => i / 19);\n// console.log('Heatmap colors:', createHeatmapColorMap('svs', steps, 0.05));\n// previewColormapInConsole('svs', steps, 0.05);\n\n\nexport function addPowerPlants(map: Ref<Map | null> | null) {\n  const powerPlantsLayerId = \"power-plants-layer\";\n  const powerPlantsHeatmapLayerId = \"power-plants-heatmap\";\n  const powerPlantsSourceId = \"power-plants-source\";\n  const powerPlantsVisible = ref(true);\n  const loading = ref(false);\n  let loadPromise: Promise<GeoJSON.FeatureCollection> | null = null;\n  // let usingHeatmap = false;\n\n  function togglePowerPlants(vis?: boolean | undefined) {\n    if (!map || !map.value) return;\n    const layerIDs = [powerPlantsLayerId, powerPlantsHeatmapLayerId];\n    layerIDs.forEach(id => {\n      if (!map.value || !map.value!.getLayer(id)) return;\n      \n      if (vis !== undefined) {\n        powerPlantsVisible.value = vis;\n        map.value.setLayoutProperty(id, \"visibility\", vis ? \"visible\" : \"none\");\n        return;\n      }\n      \n      const visibility = map.value.getLayoutProperty(\n        id,\n        \"visibility\"\n      );\n      if (visibility === \"visible\") {\n        map.value.setLayoutProperty(id, \"visibility\", \"none\");\n        powerPlantsVisible.value = false;\n      } else {\n        map.value.setLayoutProperty(id, \"visibility\", \"visible\");\n        powerPlantsVisible.value = true;\n      }\n    });\n  }\n  \n  function isValidMap(map: Ref<Map | null> | null): map is Ref<Map> {\n    return map !== null && map.value !== null;\n  }\n\n  // asynchronously load the heavy GeoJSON chunk and update the source when ready\n  function ensureDataLoaded() {\n    if (loadPromise) return loadPromise;\n    loading.value = true;\n    loadPromise = import(\"@/assets/power_plants\")\n      .then((mod) => mod.powerPlantsGeoJSON as GeoJSON.FeatureCollection)\n      .then((data) => {\n        if (isValidMap(map)) {\n          const src = map.value.getSource(powerPlantsSourceId) as GeoJSONSource | undefined;\n          if (src) src.setData(data);\n        }\n        return data;\n      })\n      .finally(() => {\n        loading.value = false;\n      });\n    return loadPromise;\n  }\n\n  function addSource() {\n    if (!isValidMap(map)) return;\n    \n    if (!map.value.getSource(powerPlantsSourceId)) {\n      map.value.addSource(powerPlantsSourceId, {\n        type: \"geojson\",\n        data: { type: \"FeatureCollection\", features: [] },\n      });\n    }\n    // kick off loading in the background; do not await\n    ensureDataLoaded();\n  }\n\n  function addLayer(op = {minzoom: 0}) {\n    if (!isValidMap(map)) return;\n    \n    addSource();\n\n    if (map.value.getLayer(powerPlantsLayerId)) {\n      console.error(\"Power plants layer already exists.\");\n      return;\n    }\n    \n    // Create a popup, but don't add it to the map yet.\n    //https://maplibre.org/maplibre-gl-js/docs/examples/display-a-popup-on-hover/\n    const popup = new Popup({\n      closeButton: true,\n      closeOnClick: false,\n      className: 'powerplant-popup'\n    });\n\n\n    // add a point layer for power plants\n    map.value.addLayer({\n      id: powerPlantsLayerId,\n      type: \"circle\",\n      source: powerPlantsSourceId,\n      minzoom: op.minzoom || 0,\n      paint: {\n        \"circle-radius\": 6,\n        \"circle-color\": [\n          \"match\",\n          [\"get\", \"PrimSource\"],\n          \n          // Traditional Sources (Black, Gray, Brown)\n          'coal',          '#1f2937', // Very Dark Slate/Black\n          'petroleum',     '#4b5563', // Dark Gray (Keeping Dark Gray for Petroleum)\n          'natural gas',   '#6b7280', // Medium Gray\n          \n          // Renewable Sources (Bright & Cool Hues)\n          'solar',         '#facc15', // Bright Amber/Gold ( Sunnier Color)\n          'wind',          '#34d399', // Bright Cyan/Teal\n          'hydroelectric', '#1e40af', // Deep Blue (Water)\n          'geothermal',    '#047857', // Dark Teal\n          'biomass',       '#92400e', // Dark Brown (Reassigned)\n          \n          // Storage & Unique Sources (Magenta, Purple, Light Blue)\n          'nuclear',       '#d946ef', // Bright Magenta\n          'batteries',     '#a78bfa', // Medium Purple\n          'pumped storage', '#60a5fa', // Light Blue\n          \n          // Fallback\n          /* other */ '#e5e7eb' // Lightest Gray\n          \n        ],\n        \"circle-opacity\": 1,\n        \"circle-stroke-width\": 1,\n        \"circle-stroke-color\": \"#ffffff\"\n      },\n    });\n    //\n    \n    let currentFeatureCoordinates = undefined;\n    \n    map.value.on('mouseenter', powerPlantsLayerId, () => {\n      map.value.getCanvas().style.cursor = 'pointer';\n    });\n    \n    map.value.on('click', powerPlantsLayerId, (e) => {\n      if (!e.features || e.features.length === 0) {\n        return;\n      }\n      // eslint-disable-next-line\n      // @ts-ignore\n      const featureCoordinates = e.features[0].geometry.coordinates.toString();\n      if (currentFeatureCoordinates !== featureCoordinates) {\n        currentFeatureCoordinates = featureCoordinates;\n\n        // Change the cursor style as a UI indicator.\n        map.value.getCanvas().style.cursor = 'pointer';\n        \n        // eslint-disable-next-line\n        // @ts-ignore\n        const coordinates = e.features[0].geometry.coordinates.slice();\n        // Plant_Name, PrimSource, Total_MW\n        const description = e.features[0].properties.Plant_Name + '<br/>' +\n          'Primary Source: ' + e.features[0].properties.PrimSource + '<br/>' +\n          'Installed MW: ' + e.features[0].properties.Install_MW;\n\n        // Ensure that if the map is zoomed out such that multiple\n        // copies of the feature are visible, the popup appears\n        // over the copy being pointed to.\n        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n          coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n        }\n\n        // Populate the popup and set its coordinates\n        // based on the feature found.\n        popup.setLngLat(coordinates).setHTML(description).addTo(map.value);\n      }\n    });\n\n    map.value.on('mouseleave', powerPlantsLayerId, () => {\n      currentFeatureCoordinates = undefined;\n      map.value.getCanvas().style.cursor = '';\n      popup.remove();\n    });\n    \n    \n    \n    \n    ////\n  }\n\n    \n  function addheatmapLayer() {\n    if (!isValidMap(map)) return;\n    \n    addSource();\n    \n    // get screen pixel ratio\n    const pixelRatio = window.devicePixelRatio || 1;\n    \n    map.value.addLayer( {\n      id: powerPlantsHeatmapLayerId,\n      type: 'heatmap',\n      source: powerPlantsSourceId,\n      // maxzoom: 5,\n      paint: {\n        \"heatmap-radius\": [\n          'interpolate',\n          ['linear'],\n          ['zoom'],\n          0, // zoom = 0\n          4 / pixelRatio, // radius = 1 @ zoom = 0\n          9, // zoom = 9\n          40 / pixelRatio // radius = 20 @ zoom = 9\n        ],\n        \"heatmap-intensity\": 1,\n        \"heatmap-weight\": [\n          'interpolate',\n          ['linear'],\n          ['get', 'Install_MW'],\n          0, // \n          0, // density is 0 at 0 MW\n          1000,\n          1, // densitity = 1 @ 1 GW\n        ],\n        \"heatmap-color\": [\n          'interpolate',\n          ['linear'],\n          ['heatmap-density'],\n          // 0.0, 'rgb(0,0,0,0)',\n          // 0.05, 'rgb(37,52,148)',\n          // 0.1, 'rgb(37,52,148)',\n          // 0.2, 'rgb(44,127,184)',\n          // 0.4, 'rgb(65,182,196)',\n          // 0.6, 'rgb(127,205,187)',\n          // 0.8, 'rgb(199,233,180)',\n          // 1.0, 'rgb(255,255,204)',\n          // ...[\n          //   0, \"rgba(0,0,0,0)\",\n          //   0.1, \"rgb(7,4,13)\",\n          //   0.125, \"rgb(91,21,124)\",\n          //   0.25, \"rgb(223,79,103)\",\n          //   0.375, \"rgb(254,156,84)\",\n          //   0.5, \"rgb(254,232,161)\",\n          //   0.625,\"rgb(252,250,189)\",\n          //   0.75, \"rgb(181,220,168)\",\n          //   0.875, \"rgb(118,196,173)\",\n          //   1.0, \"rgb(64,157,191)\",\n          // ]\n          ...createHeatmapColorMap('viridis', [0.1, 0.2, 0.4, 0.6, 0.8, 1], 0.05) // aweful by default\n        ],\n        // only fade at the zoom limit\n        \"heatmap-opacity\": 0.8,\n        // \"heatmap-opacity\": [\n        //   'interpolate',\n        //   ['linear'],\n        //   ['zoom'],\n        //   4.9, // zoom = 4.9\n        //   1, // opacity = 1 @ zoom = 4.9\n        //   5, // zoom = 5\n        //   0 // opacity = 0 @ zoom = 5\n        // ],\n      }\n\n    });\n    \n    // addLayer({minzoom: 5}); // add the point layer on top of the heatmap\n    \n    // usingHeatmap = true;\n    \n    /** we don't need to sync visibility, we will handle these two independently **/\n    // map.value.on('idle', () => {\n    //   if (!isValidMap(map)) return;\n    //   if (usingHeatmap) {\n    //     if (map.value.getLayer(powerPlantsLayerId) && map.value.getLayer(powerPlantsHeatmapLayerId)) {\n    //       const heatmapVis = map.value.getLayoutProperty(powerPlantsHeatmapLayerId, 'visibility');\n    //       map.value.setLayoutProperty(powerPlantsLayerId, 'visibility', heatmapVis);\n          \n    //     }\n    //   }\n      \n    // }); \n    \n  }\n  \n  function removeLayer() {\n    if (!map || !map.value) return;\n    [powerPlantsLayerId, powerPlantsHeatmapLayerId].forEach(id => {\n      if (!map || !map.value) return;\n      \n      if (map.value.getLayer(id)) {\n        map.value.removeLayer(id);\n      }\n\n      if (map.value.getSource(id)) {\n        map.value.removeSource(id);\n      }\n    });\n  }\n\n  return {\n    addLayer,\n    removeLayer,\n    addheatmapLayer,\n    togglePowerPlants,\n    powerPlantsVisible,\n    loading, // expose loading state\n  };\n}","/* eslint-disable @typescript-eslint/no-unused-vars */\n// Copyright (c) 2016 Mapbox All rights reserved.\n// \"Redistribution and use in source and binary forms, with or without modification, are permitted provided\"\n// Full notice is contained below\n// This has been modified from the original to\n// 1) Update to use const/let as appropriate\n// 2) Add support for extraTags option to include additional tags (e.g., aqi) in properties\nexport default (function () {\n  'use strict';\n  \n  let extraTagsOption = ['aqi'];\n  const excludeDirectChildren = new Set([\n    'name','address','description','timespan','timestamp','extendeddata','visibility',\n    'styleurl','linestyle','polystyle',\n    'multigeometry','multitrack','track','gx:track',\n    'point','linestring','polygon'\n  ]);\n  const removeSpace = /\\s*/g,\n    trimSpace = /^\\s*|\\s*$/g,\n    splitSpace = /\\s+/;\n  // generate a short, numeric hash of a string\n  function okhash(x) {\n    let h;\n    if (!x || !x.length) return 0;\n    for (let i = 0; i < x.length; i++) {\n      h = ((h << 5) - h) + x.charCodeAt(i) | 0;\n    } \n    return h;\n  }\n  // all Y children of X\n  function get(x, y) { return x.getElementsByTagName(y); }\n  function attr(x, y) { return x.getAttribute(y); }\n  function attrf(x, y) { return parseFloat(attr(x, y)); }\n  // one Y child of X, if any, otherwise null\n  function get1(x, y) { const n = get(x, y); return n.length ? n[0] : null; }\n  // https://developer.mozilla.org/en-US/docs/Web/API/Node.normalize\n  function norm(el) { if (el.normalize) { el.normalize(); } return el; }\n  // cast array x into numbers\n  function numarray(x) {\n    const o = [];\n    for (let j = 0; j < x.length; j++) { o[j] = parseFloat(x[j]); }\n    return o;\n  }\n  // get the content of a text node, if any\n  function nodeVal(x) {\n    if (x) { norm(x); }\n    return (x && x.textContent) || '';\n  }\n  // get the contents of multiple text nodes, if present\n  function getMulti(x, ys) {\n    const o = {};\n    let n, k;\n    for (k = 0; k < ys.length; k++) {\n      n = get1(x, ys[k]);\n      if (n) o[ys[k]] = nodeVal(n);\n    }\n    return o;\n  }\n  // add properties of Y to X, overwriting if present in both\n  function extend(x, y) { for (const k in y) x[k] = y[k]; }\n  // get one coordinate from a coordinate array, if any\n  function coord1(v) { return numarray(v.replace(removeSpace, '').split(',')); }\n  // get all coordinates from a coordinate array as [[],[]]\n  function coord(v) {\n    const coords = v.replace(trimSpace, '').split(splitSpace),\n      o = [];\n    for (let i = 0; i < coords.length; i++) {\n      o.push(coord1(coords[i]));\n    }\n    return o;\n  }\n  function coordPair(x) {\n    const ll = [attrf(x, 'lon'), attrf(x, 'lat')],\n      ele = get1(x, 'ele'),\n      // handle namespaced attribute in browser\n      heartRate = get1(x, 'gpxtpx:hr') || get1(x, 'hr'),\n      time = get1(x, 'time');\n    let e;\n    if (ele) {\n      e = parseFloat(nodeVal(ele));\n      if (!isNaN(e)) {\n        ll.push(e);\n      }\n    }\n    return {\n      coordinates: ll,\n      time: time ? nodeVal(time) : null,\n      heartRate: heartRate ? parseFloat(nodeVal(heartRate)) : null\n    };\n  }\n\n  // create a new feature collection parent object\n  function fc() {\n    return {\n      type: 'FeatureCollection',\n      features: []\n    };\n  }\n\n  let serializer;\n  if (typeof XMLSerializer !== 'undefined') {\n    /* istanbul ignore next */\n    serializer = new XMLSerializer();\n  } else {\n    // const isNodeEnv = false; //(typeof process === 'object' && !process.browser);\n    // const isTitaniumEnv = false; //(typeof Titanium === 'object');\n    // if (typeof exports === 'object' && (isNodeEnv || isTitaniumEnv)) {\n    //   serializer = new (require('@xmldom/xmldom').XMLSerializer)();\n    // } else {\n    //   throw new Error('Unable to initialize serializer');\n    // }\n    throw new Error('Unable to initialize serializer');\n  }\n  function xml2str(str) {\n    // IE9 will create a new XMLSerializer but it'll crash immediately.\n    // This line is ignored because we don't run coverage tests in IE9\n    /* istanbul ignore next */\n    if (str.xml !== undefined) return str.xml;\n    return serializer.serializeToString(str);\n  }\n\n  const t = {\n    // Accept an optional options object, e.g., { styles: true, extraTags: ['aqi'] | 'auto' | true }\n    kml: function (doc, options = {}) {\n\n      const gj = fc(),\n        // styleindex keeps track of hashed styles in order to match features\n        styleIndex = {}, styleByHash = {},\n        // stylemapindex keeps track of style maps to expose in properties\n        styleMapIndex = {},\n        // atomic geospatial types supported by KML - MultiGeometry is\n        // handled separately\n        geotypes = ['Polygon', 'LineString', 'Point', 'Track', 'gx:Track'],\n        // all root placemarks in the file\n        placemarks = get(doc, 'Placemark'),\n        styles = get(doc, 'Style'),\n        styleMaps = get(doc, 'StyleMap');\n\n      for (let k = 0; k < styles.length; k++) {\n        const hash = okhash(xml2str(styles[k])).toString(16);\n        styleIndex['#' + attr(styles[k], 'id')] = hash;\n        styleByHash[hash] = styles[k];\n      }\n      for (let l = 0; l < styleMaps.length; l++) {\n        styleIndex['#' + attr(styleMaps[l], 'id')] = okhash(xml2str(styleMaps[l])).toString(16);\n        const pairs = get(styleMaps[l], 'Pair');\n        const pairsMap = {};\n        for (let m = 0; m < pairs.length; m++) {\n          pairsMap[nodeVal(get1(pairs[m], 'key'))] = nodeVal(get1(pairs[m], 'styleUrl'));\n        }\n        styleMapIndex['#' + attr(styleMaps[l], 'id')] = pairsMap;\n\n      }\n      \n      \n      for (let j = 0; j < placemarks.length; j++) {\n        gj.features = gj.features.concat(getPlacemark(placemarks[j]));\n      }\n\n      // Helper to collect extra tags into properties\n      // added from here\n      extraTagsOption = options.extraTags ?? ['aqi'];\n      \n      function addExtraTags(root, properties) {\n        // Array mode: pick selected tags\n        if (Array.isArray(extraTagsOption)) {\n          for (const tag of extraTagsOption) {\n            const el = get1(root, tag);\n            if (el) {\n              const key = tag; // keep as-is (e.g., 'aqi')\n              if (properties[key] === undefined) properties[key] = nodeVal(el);\n            }\n          }\n          return;\n        }\n        // Auto mode: include all unhandled direct child elements\n        if (extraTagsOption === 'auto' || extraTagsOption === true) {\n          for (let i = 0; i < root.childNodes.length; i++) {\n            const node = root.childNodes[i];\n            if (node.nodeType === 1) {\n              const local = node.localName ? node.localName.toLowerCase() : (node.nodeName || '').toLowerCase();\n              if (!excludeDirectChildren.has(local) && properties[local] === undefined) {\n                properties[local] = nodeVal(node);\n              }\n            }\n          }\n        }\n      }\n      // to here\n      \n      function kmlColor(v) {\n        let color, opacity;\n        v = v || '';\n        if (v.substr(0, 1) === '#') { v = v.substr(1); }\n        if (v.length === 6 || v.length === 3) { color = v; }\n        if (v.length === 8) {\n          opacity = parseInt(v.substr(0, 2), 16) / 255;\n          color = '#' + v.substr(6, 2) +\n            v.substr(4, 2) +\n            v.substr(2, 2);\n        }\n        return [color, isNaN(opacity) ? undefined : opacity];\n      }\n      function gxCoord(v) { return numarray(v.split(' ')); }\n      function gxCoords(root) {\n        let elems = get(root, 'coord', 'gx');\n        const coords = [], times = [];\n        if (elems.length === 0) elems = get(root, 'gx:coord');\n        for (let i = 0; i < elems.length; i++) coords.push(gxCoord(nodeVal(elems[i])));\n        const timeElems = get(root, 'when');\n        for (let j = 0; j < timeElems.length; j++) times.push(nodeVal(timeElems[j]));\n        return {\n          coords: coords,\n          times: times\n        };\n      }\n      function getGeometry(root) {\n        let geomNode, geomNodes, i, j, k;\n        const geoms = [], coordTimes = [];\n        if (get1(root, 'MultiGeometry')) { return getGeometry(get1(root, 'MultiGeometry')); }\n        if (get1(root, 'MultiTrack')) { return getGeometry(get1(root, 'MultiTrack')); }\n        if (get1(root, 'gx:MultiTrack')) { return getGeometry(get1(root, 'gx:MultiTrack')); }\n        for (i = 0; i < geotypes.length; i++) {\n          geomNodes = get(root, geotypes[i]);\n          if (geomNodes) {\n            for (j = 0; j < geomNodes.length; j++) {\n              geomNode = geomNodes[j];\n              if (geotypes[i] === 'Point') {\n                const coordsText = nodeVal(get1(geomNode, 'coordinates'));\n                if (coordsText && coordsText.trim().length) {\n                  geoms.push({\n                    type: 'Point',\n                    coordinates: coord1(coordsText)\n                  });\n                }\n              } else if (geotypes[i] === 'LineString') {\n                const coordsText = nodeVal(get1(geomNode, 'coordinates'));\n                if (coordsText && coordsText.trim().length) {\n                  geoms.push({\n                    type: 'LineString',\n                    coordinates: coord(coordsText)\n                  });\n                }\n              } else if (geotypes[i] === 'Polygon') {\n                const rings = get(geomNode, 'LinearRing'),\n                  coords = [];\n                for (k = 0; k < rings.length; k++) {\n                  const ringCoordsText = nodeVal(get1(rings[k], 'coordinates'));\n                  if (ringCoordsText && ringCoordsText.trim().length) {\n                    coords.push(coord(ringCoordsText));\n                  }\n                }\n                if (coords.length) {\n                  geoms.push({\n                    type: 'Polygon',\n                    coordinates: coords\n                  });\n                }\n              } else if (geotypes[i] === 'Track' ||\n                geotypes[i] === 'gx:Track') {\n                const track = gxCoords(geomNode);\n                geoms.push({\n                  type: 'LineString',\n                  coordinates: track.coords\n                });\n                if (track.times.length) coordTimes.push(track.times);\n              }\n            }\n          }\n        }\n        return {\n          geoms: geoms,\n          coordTimes: coordTimes\n        };\n      }\n      \n      \n      function getPlacemark(root) {\n        let i, styleUrl = nodeVal(get1(root, 'styleUrl')),\n          lineStyle = get1(root, 'LineStyle'),\n          polyStyle = get1(root, 'PolyStyle');\n        const geomsAndTimes = getGeometry(root), properties = {},\n          name = nodeVal(get1(root, 'name')),\n          address = nodeVal(get1(root, 'address')),\n          description = nodeVal(get1(root, 'description')),\n          timeSpan = get1(root, 'TimeSpan'),\n          timeStamp = get1(root, 'TimeStamp'),\n          extendedData = get1(root, 'ExtendedData'),\n          visibility = get1(root, 'visibility');\n\n        if (!geomsAndTimes.geoms.length) return [];\n        if (name) properties.name = name;\n        if (address) properties.address = address;\n        if (styleUrl) {\n          if (styleUrl[0] !== '#') {\n            styleUrl = '#' + styleUrl;\n          }\n\n          properties.styleUrl = styleUrl;\n          if (styleIndex[styleUrl]) {\n            properties.styleHash = styleIndex[styleUrl];\n          }\n          if (styleMapIndex[styleUrl]) {\n            properties.styleMapHash = styleMapIndex[styleUrl];\n            properties.styleHash = styleIndex[styleMapIndex[styleUrl].normal];\n          }\n          // Try to populate the lineStyle or polyStyle since we got the style hash\n          const style = styleByHash[properties.styleHash];\n          if (style) {\n            if (!lineStyle) lineStyle = get1(style, 'LineStyle');\n            if (!polyStyle) polyStyle = get1(style, 'PolyStyle');\n            const iconStyle = get1(style, 'IconStyle');\n            if (iconStyle) {\n              const icon = get1(iconStyle, 'Icon');\n              if (icon) {\n                const href = nodeVal(get1(icon, 'href'));\n                if (href) properties.icon = href;\n              }\n            }\n          }\n        }\n        if (description) properties.description = description;\n        if (timeSpan) {\n          const begin = nodeVal(get1(timeSpan, 'begin'));\n          const end = nodeVal(get1(timeSpan, 'end'));\n          properties.timespan = { begin: begin, end: end };\n        }\n        if (timeStamp) {\n          properties.timestamp = nodeVal(get1(timeStamp, 'when'));\n        }\n        if (lineStyle) {\n          const linestyles = kmlColor(nodeVal(get1(lineStyle, 'color'))),\n            color = linestyles[0],\n            opacity = linestyles[1],\n            width = parseFloat(nodeVal(get1(lineStyle, 'width')));\n          if (color) properties.stroke = color;\n          if (!isNaN(opacity)) properties['stroke-opacity'] = opacity;\n          if (!isNaN(width)) properties['stroke-width'] = width;\n        }\n        if (polyStyle) {\n          const polystyles = kmlColor(nodeVal(get1(polyStyle, 'color'))),\n            pcolor = polystyles[0],\n            popacity = polystyles[1],\n            fill = nodeVal(get1(polyStyle, 'fill')),\n            outline = nodeVal(get1(polyStyle, 'outline'));\n          if (pcolor) properties.fill = pcolor;\n          if (!isNaN(popacity)) properties['fill-opacity'] = popacity;\n          if (fill) properties['fill-opacity'] = fill === '1' ? properties['fill-opacity'] || 1 : 0;\n          if (outline) properties['stroke-opacity'] = outline === '1' ? properties['stroke-opacity'] || 1 : 0;\n        }\n        \n        // After known properties, add extra tags (e.g., aqi)\n        addExtraTags(root, properties);\n\n        if (extendedData) {\n          const datas = get(extendedData, 'Data'),\n            simpleDatas = get(extendedData, 'SimpleData');\n\n          for (i = 0; i < datas.length; i++) {\n            properties[datas[i].getAttribute('name')] = nodeVal(get1(datas[i], 'value'));\n          }\n          for (i = 0; i < simpleDatas.length; i++) {\n            properties[simpleDatas[i].getAttribute('name')] = nodeVal(simpleDatas[i]);\n          }\n        }\n        if (visibility) {\n          properties.visibility = nodeVal(visibility);\n        }\n        if (geomsAndTimes.coordTimes.length) {\n          properties.coordTimes = (geomsAndTimes.coordTimes.length === 1) ?\n            geomsAndTimes.coordTimes[0] : geomsAndTimes.coordTimes;\n        }\n        const feature = {\n          type: 'Feature',\n          geometry: (geomsAndTimes.geoms.length === 1) ? geomsAndTimes.geoms[0] : {\n            type: 'GeometryCollection',\n            geometries: geomsAndTimes.geoms\n          },\n          properties: properties\n        };\n        if (attr(root, 'id')) feature.id = attr(root, 'id');\n        return [feature];\n      }\n      return gj;\n    },\n    gpx: function (doc) {\n      let i, feature;\n      const tracks = get(doc, 'trk'),\n        routes = get(doc, 'rte'),\n        waypoints = get(doc, 'wpt'),\n        // a feature collection\n        gj = fc();\n      for (i = 0; i < tracks.length; i++) {\n        feature = getTrack(tracks[i]);\n        if (feature) gj.features.push(feature);\n      }\n      for (i = 0; i < routes.length; i++) {\n        feature = getRoute(routes[i]);\n        if (feature) gj.features.push(feature);\n      }\n      for (i = 0; i < waypoints.length; i++) {\n        gj.features.push(getPoint(waypoints[i]));\n      }\n      function initializeArray(arr, size) {\n        for (let h = 0; h < size; h++) {\n          arr.push(null);\n        }\n        return arr;\n      }\n      function getPoints(node, pointname) {\n        const pts = get(node, pointname),\n          line = [],\n          times = [],\n          heartRates = [],\n          l = pts.length;\n        if (l < 2) {\n          console.error('toGeoJSON: a line must have at least two points');\n          return {};  // Invalid line in GeoJSON\n        }\n        for (let i = 0; i < l; i++) {\n          const c = coordPair(pts[i]);\n          line.push(c.coordinates);\n          if (c.time) times.push(c.time);\n          if (c.heartRate || heartRates.length) {\n            if (!heartRates.length) initializeArray(heartRates, i);\n            heartRates.push(c.heartRate || null);\n          }\n        }\n        return {\n          line: line,\n          times: times,\n          heartRates: heartRates\n        };\n      }\n      function getTrack(node) {\n        let line;\n        const segments = get(node, 'trkseg'),\n          track = [],\n          times = [],\n          heartRates = [];\n        for (let i = 0; i < segments.length; i++) {\n          line = getPoints(segments[i], 'trkpt');\n          if (line) {\n            if (line.line) track.push(line.line);\n            if (line.times && line.times.length) times.push(line.times);\n            if (heartRates.length || (line.heartRates && line.heartRates.length)) {\n              if (!heartRates.length) {\n                for (let s = 0; s < i; s++) {\n                  heartRates.push(initializeArray([], track[s].length));\n                }\n              }\n              if (line.heartRates && line.heartRates.length) {\n                heartRates.push(line.heartRates);\n              } else {\n                heartRates.push(initializeArray([], line.line.length || 0));\n              }\n            }\n          }\n        }\n        if (track.length === 0) return;\n        const properties = getProperties(node);\n        extend(properties, getLineStyle(get1(node, 'extensions')));\n        if (times.length) properties.coordTimes = track.length === 1 ? times[0] : times;\n        if (heartRates.length) properties.heartRates = track.length === 1 ? heartRates[0] : heartRates;\n        return {\n          type: 'Feature',\n          properties: properties,\n          geometry: {\n            type: track.length === 1 ? 'LineString' : 'MultiLineString',\n            coordinates: track.length === 1 ? track[0] : track\n          }\n        };\n      }\n      function getRoute(node) {\n        const line = getPoints(node, 'rtept');\n        if (!line.line) return;\n        const prop = getProperties(node);\n        extend(prop, getLineStyle(get1(node, 'extensions')));\n        const routeObj = {\n          type: 'Feature',\n          properties: prop,\n          geometry: {\n            type: 'LineString',\n            coordinates: line.line\n          }\n        };\n        return routeObj;\n      }\n      function getPoint(node) {\n        const prop = getProperties(node);\n        extend(prop, getMulti(node, ['sym']));\n        return {\n          type: 'Feature',\n          properties: prop,\n          geometry: {\n            type: 'Point',\n            coordinates: coordPair(node).coordinates\n          }\n        };\n      }\n      function getLineStyle(extensions) {\n        const style = {};\n        if (extensions) {\n          const lineStyle = get1(extensions, 'line');\n          if (lineStyle) {\n            const color = nodeVal(get1(lineStyle, 'color')),\n              opacity = parseFloat(nodeVal(get1(lineStyle, 'opacity'))),\n              width = parseFloat(nodeVal(get1(lineStyle, 'width')));\n            if (color) style.stroke = color;\n            if (!isNaN(opacity)) style['stroke-opacity'] = opacity;\n            // GPX width is in mm, convert to px with 96 px per inch\n            if (!isNaN(width)) style['stroke-width'] = width * 96 / 25.4;\n          }\n        }\n        return style;\n      }\n      function getProperties(node) {\n        const prop = getMulti(node, ['name', 'cmt', 'desc', 'type', 'time', 'keywords']),\n          links = get(node, 'link');\n        if (links.length) prop.links = [];\n        for (let i = 0, link; i < links.length; i++) {\n          link = { href: attr(links[i], 'href') };\n          extend(link, getMulti(links[i], ['text', 'type']));\n          prop.links.push(link);\n        }\n        return prop;\n      }\n      return gj;\n    }\n  };\n  return t;\n})();\n\n// if (typeof module !== 'undefined') module.exports = toGeoJSON;\n\n\n// Copyright (c) 2016 Mapbox All rights reserved.\n// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n// 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, \n// INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, \n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; \n// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF \n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n","import { ref } from 'vue';\n\n\n/** composeable\n * @description \n * A composable providing an abortable fetch function using the AbortController API.\n * \n * Usage:\n * ```\n * const { loading, error, abortController, abortableFetch, abort } = useAbortableFetch();\n * ```\n * - `loading`: provides access to current loading state\n * - `error`: provides access to non-abort errors encountered during fetch (all errors are thrown, include abort)\n * - `abortController`: provides access to the current AbortController, if any\n * - `abort(msg)`: aborts the current fetch request and clears the controller (set to null)\n * \n * adapted from https://stackoverflow.com/a/62992971/11594175\n */\nexport function useAbortableFetch() {\n  const loading = ref(false);\n  const error = ref<Error | null>(null);\n  const abortController = ref<AbortController | null>(null);\n\n\n  function abortableFetch(input: string | Request | URL, init?: RequestInit): Promise<Response> {\n    const controller = new AbortController();\n    const signal = controller.signal;\n    abortController.value = controller;\n\n    loading.value = true;\n    error.value = null;\n    \n\n    return fetch(input, { ...init, signal: signal })\n      .then((response) => response) // directly return the response. Handle HTTP errors when calling it\n      .catch((err: Error) => { // rethrow the error to avoid returning Promise<void>\n        if (err.name === 'AbortError') {\n          console.error('useKML: Fetch aborted with message:', err.message);\n        } else {\n          error.value = err;\n        }\n        throw err;\n      })\n      .finally(() => {\n        loading.value = false;\n        abortController.value = null;\n      });\n  }\n\n  function abort(msg: string = 'Fetch aborted by Abort Controller'): void {\n    if (abortController.value) {\n      abortController.value.abort(msg);\n      abortController.value = null;\n    }\n  }\n\n  return {\n    loading,\n    error,\n    abortController,\n    abortableFetch,\n    abort,\n  };\n}","import { ref, type Ref, onBeforeUnmount } from 'vue';\nimport toGeoJSON from '../togeojson.js';\nimport { useAbortableFetch } from './useAbortableFetch';\n\n\nexport interface KMLResource {\n  kmlUrl: Ref<string>\n  geoJsonData: Ref<GeoJSON.FeatureCollection | null>\n  loading: Ref<boolean>\n  error: Ref<Error | null>\n  setUrl: (newUrl: string) => Promise<void>\n  loadKML: () => Promise<unknown>\n  cleanUp: () => void\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString#error_handling\nfunction parseXML(xmlString: string): Document | null {\n  const parser = new DOMParser();\n\n  const doc = parser.parseFromString(xmlString, \"application/xml\");\n  const errorNode = doc.querySelector(\"parsererror\");\n  if (errorNode) {\n    return null;\n  } else {\n    return doc;\n  }\n}\n\nexport function useKML(url: string): KMLResource {\n  const { loading, error, abortController, abortableFetch, abort } = useAbortableFetch();\n  const kmlUrl = ref(url);\n  const geoJsonData = ref<GeoJSON.FeatureCollection | null>(null);\n\n  // Convert KML to GeoJSON\n  const _convertKmlToGeoJson = (kmlContent: string): GeoJSON.FeatureCollection => {\n    \n    const kmlDoc = parseXML(kmlContent);\n    if (!kmlDoc) {\n      throw new Error('Invalid KML format');\n    }\n    // Convert using local togeojson library\n    const geoJson = toGeoJSON.kml(kmlDoc, { styles: true }) as GeoJSON.FeatureCollection;\n    \n    // Debug: Log the parsed GeoJSON structure\n    console.log('=== KML PARSING DEBUG ===');\n    console.log('URL:', kmlUrl.value);\n    console.log('Total features:', geoJson.features.length);\n    console.log('First few features with properties:', geoJson.features.slice(0, 3).map(f => ({\n      geometry: f.geometry,\n      properties: f.properties\n    })));\n\n    \n    return geoJson;\n      \n  };\n\n\n  // Load KML from URL\n  async function loadKML() {\n    \n    const requestedUrl = kmlUrl.value;\n    console.log('Starting KML load for URL:', requestedUrl);\n\n    // Abort any in-flight request\n    if (abortController.value) {\n      abort('Aborting previous KML fetch due to new request');\n    }\n    \n\n    console.log('Loading KML from:', requestedUrl);\n    return abortableFetch(requestedUrl).then((response) => {\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return response;\n      \n    })\n      .then((response) => response.text())\n      .then((kmlContent) => {\n        console.log('KML fetched successfully, size:', kmlContent.length);\n        \n        // short-circuit lengthy processing if URL changed\n        if (requestedUrl !== kmlUrl.value) {\n          console.warn('KML URL changed during fetch, ignoring this result');\n          return;\n        }\n        \n        // convert Kml to GeoJSON and save to ref\n        const geoJson = _convertKmlToGeoJson(kmlContent);\n        if (requestedUrl !== kmlUrl.value) {\n          console.warn('KML URL changed during KML parsing, ignoring this result');\n          return;\n        }\n        if (geoJson) {\n          geoJsonData.value = geoJson;\n          console.log('KML loaded successfully:', geoJson.features.length, 'features');\n        }\n        \n        return kmlContent;\n      })\n      .catch((err) => {\n        // only error if not abort\n        if (err.name === 'AbortError') {\n          console.warn('KML fetch aborted:', err.message);\n        } else {\n          console.error('Error fetching KML:', err);\n        }\n      });\n    \n  }\n\n\n  // Change URL and refresh layer\n  async function setUrl(newUrl: string) {\n    const next = (newUrl || '').trim();\n    // right now lets avoid loops.\n    if (next !== kmlUrl.value) {\n      console.log('KML URL changing from', kmlUrl.value, 'to', next);\n      kmlUrl.value = next;\n    } // avoid loops\n\n    // Abort any in-flight fetch before switching\n    if (abortController.value) {\n      console.log('useKML: Aborting previous fetch due to URL change');\n      abort('Aborting previous KML fetch due to URL change');\n    }\n    \n    console.log('useKML: reset data and error state');\n    geoJsonData.value = null;\n    error.value = null;\n  }\n\n  // Watch for URL changes to auto-reload (will be idempotent due to early return)\n  // watch(kmlUrl, (newUrl) => {\n  //   console.log('KML URL changed, reloading:', kmlUrl.value);\n  //   setUrl(newUrl);\n  // });\n\n  // Remove from map\n  function cleanUp() {\n    // Abort any in-flight fetch\n    if (abortController.value) {\n      abort('Aborting KML fetch due to layer removal');\n    }\n  }\n  \n  onBeforeUnmount(() => {\n    cleanUp();\n  });\n  return {\n    geoJsonData,\n    loadKML,\n    loading,\n    error,\n    kmlUrl,\n    setUrl,\n    cleanUp,\n  };\n}","import { ref, watch, computed, type WritableComputedRef, type Ref, onBeforeUnmount } from 'vue';\nimport M from 'maplibre-gl';\nimport { Popup } from 'maplibre-gl';\nimport { useKML } from './useKML';\n\n// AQI styleUrl -> color mapping (hex), derived from the\n// legend here https://gispub.epa.gov/airnow/?tab=archive\nconst AQI_STYLE_COLORS: Record<string, string> = {\n  '#undefined': '#D9D9D9',\n  '#normalstateundefined': '#D9D9D9',\n  '#highlightstateundefined': '#D9D9D9',\n  '#legendicon': '#D9D9D9',\n\n  '#good': '#00E400',\n  '#normalstategood': '#00E400',\n  '#highlightstategood': '#00E400',\n\n  '#moderate': '#FFFF00',\n  '#normalstatemoderate': '#FFFF00',\n  '#highlightstatemoderate': '#FFFF00',\n\n  '#unhealthysg': '#FF7E00',\n  '#normalstateunhealthysg': '#FF7E00',\n  '#highlightstateunhealthysg': '#FF7E00',\n\n  '#unhealthy': '#FF0000',\n  '#normalstateunhealthy': '#FF0000',\n  '#highlightstateunhealthy': '#FF0000',\n\n  '#veryunhealthy': '#8F3F97',\n  '#normalstateveryunhealthy': '#8F3F97',\n  '#highlightstateveryunhealthy': '#8F3F97',\n\n  '#hazardous': '#7E0023',\n  '#normalstatehazardous': '#7E0023',\n  '#highlightstatehazardous': '#7E0023'\n};\n\n// Normalize and resolve a styleUrl to an AQI color\nfunction getAqiColorFromStyleUrl(styleUrlRaw: string | null | undefined): string {\n  const key = (styleUrlRaw || '').trim();\n  if (!key) return '#D9D9D9';\n  // ensure hash prefix and lowercase for lookup\n  const normalized = (key.startsWith('#') ? key : `#${key}`).toLowerCase();\n  return AQI_STYLE_COLORS[normalized] || '#D9D9D9';\n}\n\nexport type InternalMapLayerEventType = M.MapMouseEvent & {features?: M.MapGeoJSONFeature[];};\nexport type InternalMapLayerEventTypeHandler = (e: InternalMapLayerEventType) => void;\n\nexport interface AQILayer {\n  addToMap: (map: M.Map) => Promise<void>\n  removeFromMap: (map: M.Map) => void\n  geoJsonData: Ref<GeoJSON.FeatureCollection | null>\n  loading: Ref<boolean>\n  error: Ref<Error | null>\n  layerVisible: WritableComputedRef<boolean>\n  toggleAQIVisibility: (vis?: boolean | undefined) => void\n  setUrl: (newUrl: string) => Promise<void>\n}\n\n// Optional settings for labels\nexport interface UseKMLOptions {\n  propertyToShow?: string | null;   // e.g., 'aqi'. If null/undefined, no labels are shown.\n  labelMinZoom?: number;            // min zoom at which labels appear\n  layerName?: string;               // custom id base for source/layers, e.g. 'aqi'\n  showPopup?: boolean;            // whether to show popup on click/hover\n  showLabel?: boolean;           // whether to show labels\n  visible?: boolean;              // initial visibility state; defaults to true\n}\n\n\n\nexport function addQUI(url: string, options: UseKMLOptions = {}): AQILayer {\n  const { kmlUrl, geoJsonData, loading, error, setUrl: internalSetUrl, loadKML, cleanUp } = useKML(url);\n\n  const propertyToShow = options.propertyToShow ?? null;\n  const labelMinZoom = options.labelMinZoom ?? 8;\n  const showPopup = options.showPopup ?? true;\n  const showLabel = options.showLabel ?? true;\n\n  // Store runtime state in refs (avoid caching on the function)\n  const mapRef = ref<M.Map | null>(null);\n  const idBase = options.layerName ? options.layerName : '';\n  const sourceId = idBase ? `aqi-source-${idBase}` : 'aqi-source';\n  const layerId = idBase ? `aqi-layer-${idBase}` : 'aqi-layer';\n  const labelLayerId = layerId + '-label';\n\n  const popupRef = ref<Popup | null>(null);\n  const onEnterRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onMoveRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onLeaveRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onStyleDataRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n\n  // Track the last known layer visibility across URL changes (persisted)\n  const lastKnownVisible = ref<boolean>(options.visible ?? true); \n\n  // layerVisible reflects actual map state; falls back to lastKnownVisible if layer missing\n  const layerVisible = computed<boolean>({\n    get() {\n      const map = mapRef.value;\n      if (!map) {\n        console.warn(`AQI: Tried to get ${layerId} but map is not set`);\n        return lastKnownVisible.value;\n      }\n      if (!map.getLayer(layerId)) {\n        console.warn(`AQI: Tried to get ${layerId} but layer is not present on map`);\n        return lastKnownVisible.value;\n      }\n      \n      const vis = map.getLayoutProperty(layerId, 'visibility');\n      console.log(`AQI: Layer ${layerId} visibility is`, vis);\n      return vis === 'visible';\n    },\n    set(val: boolean) {\n      lastKnownVisible.value = val;\n      const map = mapRef.value;\n      if (!map) {\n        console.warn(`AQI: Tried to get ${layerId} but map is not set`);\n        return lastKnownVisible.value;\n      }\n      if (!map.getLayer(layerId)) {\n        console.warn(`AQI: Tried to get ${layerId} but layer is not present on map`);\n        return lastKnownVisible.value;\n      }\n      \n      const vis = val ? 'visible' : 'none';\n      map.setLayoutProperty(layerId, 'visibility', vis);\n      if (map.getLayer(labelLayerId)) {\n        map.setLayoutProperty(labelLayerId, 'visibility', vis);\n      }\n    }\n  });\n\n  \n\n  // Post-process GeoJSON to apply styleUrl-based AQI coloring\n  const postProcessGeoJson = (geoJson: GeoJSON.FeatureCollection): GeoJSON.FeatureCollection => {\n    const processedFeatures = geoJson.features.map((feature) => {\n      const processedFeature = { ...feature };\n      const props = processedFeature.properties || {};\n      const styleUrl = props.styleUrl ?? props.styleURL ?? null;\n      const color = getAqiColorFromStyleUrl(styleUrl);\n      processedFeature.properties = {\n        ...props,\n        'marker-color': color\n      };\n      return processedFeature;\n    });\n\n    return {\n      ...geoJson,\n      features: processedFeatures\n    };\n  };\n\n  \n  function setupLayerPopup(propertyToShow: string, map: M.Map, layerId: string) {\n    const popup = new Popup({ closeButton: false, closeOnClick: false, maxWidth: '200px' });\n    const valueProp = propertyToShow || 'aqi';\n    const onEnter = (e: InternalMapLayerEventType) => {\n      map.getCanvas().style.cursor = 'pointer';\n      const f = e.features && e.features[0];\n      const val = f?.properties?.[valueProp];\n      if (val !== undefined && val !== null && `${val}` !== '') {\n        const desc = `<div style=\"font:12px sans-serif;color:#000\">AQI: ${val}</div>`;\n        popup\n          .setLngLat(e.lngLat)\n          .setHTML(desc)\n          .addTo(map);\n      }\n    };\n    const onMove = (e: InternalMapLayerEventType) => {\n      popup.setLngLat(e.lngLat);\n      const f = e.features && e.features[0];\n      const val = f?.properties?.[valueProp];\n      if (val !== undefined && val !== null && `${val}` !== '') {\n        const desc = `<div style=\"font:12px sans-serif;color:#000\">AQI: ${val}</div>`;\n        popup.setHTML(desc);\n      }\n    };\n    const onLeave = () => {\n      map.getCanvas().style.cursor = '';\n      popup.remove();\n    };\n    \n    map.on('mouseenter', layerId, () => {\n      map.getCanvas().style.cursor = 'pointer';\n    });\n    map.on('click', layerId, onEnter);\n    map.on('mousemove', layerId, onMove);\n    map.on('mouseleave', layerId, onLeave);\n\n    // Store state in refs (not on function)\n    popupRef.value = popup;\n    onEnterRef.value = onEnter;\n    onMoveRef.value = onMove;\n    onLeaveRef.value = onLeave;\n  }\n\n  function setupVisibilitySync(map: M.Map) {\n    // Keep label visibility equal to main layer & sync external visibility changes\n    const syncLabelVisibility = () => {\n      if (!map.getLayer(layerId)) return;\n      const mainVis = (map.getLayoutProperty(layerId, 'visibility') as string) || 'visible';\n      const isVisible = mainVis === 'visible';\n      if (lastKnownVisible.value !== isVisible) {\n        lastKnownVisible.value = isVisible;\n      }\n      if (map.getLayer(labelLayerId)) {\n        const labelVis = (map.getLayoutProperty(labelLayerId, 'visibility') as string) || 'visible';\n        if (labelVis !== mainVis) {\n          map.setLayoutProperty(labelLayerId, 'visibility', mainVis);\n        }\n      }\n    };\n    \n    syncLabelVisibility();\n    // idle takes a bit longer than styledata, and the user can tell\n    // but idle would be less frequent i think\n    map.on('styledata', syncLabelVisibility); \n    onStyleDataRef.value = syncLabelVisibility;\n  }\n\n\n  // Add GeoJSON to map\n  const addToMap = async (map: M.Map): Promise<void> => {\n    // Always store map first so subsequent retries have a reference\n    mapRef.value = map;\n    \n    // Load KML if not already loaded\n    if (!geoJsonData.value) {\n      // console.log('AQI: No GeoJSON data, loading KML from URL:', kmlUrl.value);\n      await loadKML();\n    }\n    if (!geoJsonData.value) {\n      throw new Error('No GeoJSON data available');\n    }\n\n    // Remove existing layer and source if they exist\n    if (map.getLayer(layerId)) {\n      map.removeLayer(layerId);\n    }\n    if (labelLayerId && map.getLayer(labelLayerId)) {\n      map.removeLayer(labelLayerId);\n    }\n    if (map.getSource(sourceId)) {\n      map.removeSource(sourceId);\n    }\n\n    // Add new source and layer\n    map.addSource(sourceId, {\n      type: 'geojson',\n      data: postProcessGeoJson(geoJsonData.value)\n    });\n\n    // Add point layer colored by 'marker-color'\n    map.addLayer({\n      id: layerId,\n      type: 'circle',\n      source: sourceId,\n      layout: {\n        visibility: lastKnownVisible.value ? 'visible' : 'none'\n      },\n      paint: {\n        'circle-radius': [\n          'interpolate', ['linear'], ['zoom'],\n          0, 1,\n          5, 8,\n          20, 12\n        ],\n        'circle-color': [\n          'case',\n          ['has', 'marker-color'],\n          ['get', 'marker-color'],\n          '#808080'\n        ],\n        'circle-stroke-color': '#969696ff',\n        'circle-stroke-width': 1,\n        'circle-opacity': 0.8\n      },\n      filter: ['==', '$type', 'Point']\n    });\n\n    // Conditionally add text labels\n    if (propertyToShow && showLabel) {\n      map.addLayer({\n        id: labelLayerId,\n        type: 'symbol',\n        source: sourceId,\n        minzoom: labelMinZoom,\n        layout: {\n          'text-field': ['coalesce', ['to-string', ['get', propertyToShow]], ''],\n          'text-size': 10,\n          'text-offset': [0, 0],\n          'visibility': lastKnownVisible.value ? 'visible' : 'none'\n        },\n        paint: {\n          'text-color': '#1a1a1a',\n          'text-opacity': 1, // needs to be set so we can detect if we change it\n          'text-halo-color': '#ffffff',\n          'text-halo-width': 1\n        },\n        filter: ['==', '$type', 'Point']\n      });\n\n      \n      // Add popup/handlers if it hasn't been added yet\n      if (showPopup && popupRef.value === null) {\n        setupLayerPopup(propertyToShow, map, layerId);\n      }\n    }\n    // Even without labels still sync visibility (for external toggles)\n    if (onStyleDataRef.value === null) {\n      setupVisibilitySync(map);\n\n    }\n\n    // Apply last known visibility after layers are added\n    // const vis = lastKnownVisible.value ? 'visible' : 'none';\n    // map.setLayoutProperty(layerId, 'visibility', vis);\n    // if (map.getLayer(labelLayerId)) {\n    //   map.setLayoutProperty(labelLayerId, 'visibility', vis);\n    // }\n\n    console.log('AQI: Successfully added KML layer to map');\n      \n    \n  };\n  \n  \n  // Optional: debug logging\n  // watch(layerVisible, (newVis) => {\n  //   console.log('AQI layer visibility changed to:', newVis);\n  // });\n\n  // Toggle visibility for main and label layers using the computed setter\n  const toggleAQIVisibility = (val?: boolean | undefined): void => {\n    const next = val ?? !layerVisible.value;\n    layerVisible.value = next;\n  };\n\n  // Change URL and refresh layer\n  const setUrl = async (newUrl: string): Promise<void> => {\n    console.log('AQI: Setting new KML URL:', newUrl);\n    internalSetUrl(newUrl) // will automatically load new and abort prior\n      .then(() => {\n        const map = mapRef.value;\n\n        if (map) {\n          addToMap(map as never);\n        }\n      }).catch((err) => {\n        console.error('AQI: Error setting new KML URL:', err);\n      });\n  };\n\n  // Watch for URL changes to auto-reload (will be idempotent due to early return)\n  watch(kmlUrl, (newUrl) => {\n    setUrl(newUrl).catch(err => {\n      console.error('AQI: Error reloading KML after URL change:', err);\n    });\n  });\n\n  // Remove from map\n  const removeFromMap = (map: M.Map): void => {\n    cleanUp();\n    \n    // Remove hover handlers and popup\n    if (onEnterRef.value) map.off('click', layerId, onEnterRef.value);\n    if (onMoveRef.value) map.off('mousemove', layerId, onMoveRef.value);\n    if (onLeaveRef.value) map.off('mouseleave', layerId, onLeaveRef.value);\n    if (popupRef.value) popupRef.value.remove();\n    if (onStyleDataRef.value) map.off('styledata', onStyleDataRef.value);\n    // if (onStyleDataRef.value) map.off('idle', onStyleDataRef.value); \n\n    // Remove layers and source\n    if (map.getLayer(labelLayerId)) {\n      map.removeLayer(labelLayerId);\n    }\n    if (map.getLayer(layerId)) {\n      map.removeLayer(layerId);\n    }\n    if (map.getSource(sourceId)) {\n      map.removeSource(sourceId);\n    }\n\n    // Clear stored handlers/popup; keep mapRef so we can re-add later\n    popupRef.value = null;\n    onEnterRef.value = null;\n    onMoveRef.value = null;\n    onLeaveRef.value = null;\n  };\n  \n  onBeforeUnmount(() => {\n    const map = mapRef.value;\n    if (map) {\n      removeFromMap(map as never);\n      mapRef.value = null;\n    }\n  });\n  \n  return {\n    addToMap,\n    removeFromMap,\n    geoJsonData,\n    loading,\n    error,\n    layerVisible,\n    toggleAQIVisibility,\n    setUrl\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, mergeProps as _mergeProps, withCtx as _withCtx, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, isRef as _isRef } from \"vue\"\n\nconst _hoisted_1 = { class: \"map-container\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"map-legend\"\n}\nconst _hoisted_3 = { class: \"location-and-sharing\" }\nconst _hoisted_4 = { class: \"slider-row mx-16 mt-12\" }\nconst _hoisted_5 = { class: \"thumb-label\" }\nconst _hoisted_6 = { class: \"d-flex flex-row\" }\n\nimport { computed, ref, toRaw, useTemplateRef, watch, type Ref, type WritableComputedRef } from \"vue\";\nimport { useDisplay } from 'vuetify';\nimport { storeToRefs } from \"pinia\";\nimport { MapBoxFeature, MapBoxFeatureCollection, MapBoxFeatureType, MapBoxForwardGeocodingOptions, geocodingInfoForSearch } from \"@cosmicds/vue-toolkit\";\nimport { Map, GeoJSONSource, type StyleLayer } from \"maplibre-gl\";\nimport { getTimezoneOffset } from \"date-fns-tz\";\nimport { v4 } from \"uuid\";\n\nimport type { LatLngPair, PointSelectionInfo, RectangleSelectionInfo, SelectionType } from \"@/types\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"@/esri/utils\";\nimport { colorbarOptions } from \"@/esri/ImageLayerConfig\";\nimport { colormap } from \"@/colormaps/utils\";\nimport { useTempoStore } from \"@/stores/app\";\nimport { useLocationMarker } from \"@/composables/maplibre/useMarker\";\nimport { useRectangleSelection } from \"@/composables/maplibre/useRectangleSelection\";\nimport { addRectangleLayer, addPointLayer, regionBounds, fitBounds, removeRectangleLayer, removePointLayer } from \"@/composables/maplibre/utils\";\nimport { usePointSelection } from \"@/composables/maplibre/usePointSelection\";\nimport { COLORS } from \"@/utils/color\";\nimport { EsriSampler } from \"@/esri/services/sampling\";\nimport { useMultiMarker } from '@/composables/maplibre/useMultiMarker';\n\nimport { setLayerVisibility } from \"@/maplibre_controls\";\n\nimport EsriMap from \"@/components/EsriMap.vue\";\nimport MapColorbarWrap from \"@/components/MapColorbarWrap.vue\";\n\nimport { addPowerPlants } from \"@/composables/addPowerPlants\";\nimport { MaplibreLayersControl } from \"@/MaplibreLayerControl\";\n\nimport { addQUI } from '@/composables/addAQI';\n\n// base it of singleDateSelected\ntype MapType = Map | null;\ntype MapTypeRef = Ref<MapType>;\ntype Timeout = ReturnType<typeof setTimeout>;\n\ntype UnifiedRegionType = typeof regions.value[number];\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MapWithControls',\n  setup(__props) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst maplibreMap = useTemplateRef<InstanceType<typeof EsriMap>>(\"maplibreMap\");\nconst map = ref<MapType>(null);\n\nconst mapID = `map-${v4().replace(\"-\", \"\")}`;\n\nconst store = useTempoStore();\nconst {\n  regions,\n  timestamp,\n  timeIndex,\n  minIndex,\n  maxIndex,\n  date,\n  selectedTimezone,\n  timeSliderUsedCount,\n  playButtonClickedCount,\n  timestamps,\n  timestampsLoaded,\n  selectionActive,\n  regionsCreatedCount,\n  maxSampleCount,\n  focusRegion,\n  initState,\n  homeState,\n  showFieldOfRegard,\n  showRoads,\n  showSamplingPreviewMarkers,\n} = storeToRefs(store);\n\nconst molecule = ref<MoleculeType>(\"no2\");\nconst colorMap = computed(() => colorbarOptions[molecule.value].colormap.toLowerCase());\nconst currentTempoDataService = computed(() => store.getTempoDataService(molecule.value));\n\nfunction createSelectionComputed(selection: SelectionType): WritableComputedRef<boolean> {\n  return computed({\n    get() {\n      return selectionActive.value === selection;\n    },\n    set(value: boolean) {\n      if (value === (selectionActive.value !== selection)) {\n        selectionActive.value = value ? selection : null;\n      }\n    },\n  });\n}\n\nconst pointSelectionActive = createSelectionComputed(\"point\");\nconst rectangleSelectionActive = createSelectionComputed(\"rectangle\");\n\nconst { selectionInfo: rectangleInfo } = useRectangleSelection(map as MapTypeRef, \"red\", rectangleSelectionActive);\nconst { selectionInfo: pointInfo } = usePointSelection(map as MapTypeRef, pointSelectionActive);\n\nconst display = useDisplay();\n\nconst pp = addPowerPlants(map as Ref<Map | null> | null);\nconst airQualityUrl = computed(() => {\n  const date = store.singleDateSelected;\n  if (!date) {\n    return 'https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/2025/20250914/KMLPointMaps_PM2.5-24hr.kml';\n  }\n\n  const year = date.getUTCFullYear();\n  const month = (date.getUTCMonth() + 1).toString().padStart(2, '0');\n  const day = date.getUTCDate().toString().padStart(2, '0');\n  return `https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/${year}/${year}${month}${day}/KMLPointMaps_PM2.5-24hr.kml`;\n});\nconst aqiLayer = addQUI(airQualityUrl.value, { \n  propertyToShow: 'aqi', \n  labelMinZoom: 5, \n  layerName: 'aqi', \n  visible: true,\n  showLabel: true, \n  showPopup: true\n});\n\n// Ensure date/url changes trigger a reload, even if initial load failed\nwatch(airQualityUrl, (newUrl) => {\n  aqiLayer.setUrl(newUrl).catch(() => {/* ignore */});\n});\n\n\nconst onMapReady = (m: Map) => {\n  console.log('Map ready event received');\n  map.value = m; // ESRI source already added by EsriMap\n  pp.addheatmapLayer();\n  // pp.togglePowerPlants(false);\n  aqiLayer.addToMap(m);\n  // Only move if target layer exists (avoid errors if initial KML load failed)\n  try {\n    if (m.getLayer('kml-layer-aqi')) {\n      m.moveLayer('states-custom','kml-layer-aqi');\n    }\n  } catch {\n    // ignore\n  }\n  \n  aqiLayer.layerVisible.value = false;\n  pp.togglePowerPlants(false);\n  updateRegionLayers(regions.value);\n};\n\nconst showLocationMarker = ref(true);\nconst {\n  setMarker,\n  removeMarker,\n  locationMarker,\n} = useLocationMarker(map as Ref<Map | null>, showLocationMarker.value);\n\nconst opacity = ref(0.9);\nconst playing = ref(false);\nconst playInterval = ref<Timeout | null>(null);\n\n\nconst searchOpen = ref(true);\nconst searchErrorMessage = ref<string | null>(null);\nfunction activateRectangleSelectionMode() {\n  rectangleSelectionActive.value = !rectangleSelectionActive.value;\n}\n\nfunction activatePointSelectionMode() {\n  pointSelectionActive.value = !pointSelectionActive.value;\n}\n\nconst regionLayers: Record<string, GeoJSONSource> = {};\n\nconst currentColormap = computed(() => {\n  return (x: number): string => {\n    const rgb = colormap(colorMap.value, 0, 1, x);\n    return `rgba(${rgb[0]}, ${rgb[1]}, ${rgb[2]},1)`;\n  };\n});\n\nconst mapTitle = computed(() => {\n  const currentMolecule = MOLECULE_OPTIONS.find(m => m.value === molecule.value);\n  if (!currentMolecule) {\n    return '';\n  }\n  return currentMolecule.title;\n});\n\n// TODO: Maybe there's a built-in Date function to get this formatting?\nconst thumbLabel = computed(() => {\n  if (date.value === null || timestamp.value === null) {\n    return '';\n  }\n  const offset = getTimezoneOffset(selectedTimezone.value, date.value);\n  const dateObj = new Date(timestamp.value + offset);\n  const hours = dateObj.getUTCHours();\n  const amPm = hours >= 12 ? \"PM\" : \"AM\";\n  let hourValue = hours % 12;\n  if (hourValue === 0) {\n    hourValue = 12;\n  }\n  return `${date.value.getUTCMonth() + 1}/${dateObj.getUTCDate()}/${dateObj.getUTCFullYear()} ${hourValue}:${dateObj.getUTCMinutes().toString().padStart(2, '0')} ${amPm}`;\n});\n\nconst defaultMapboxOptions = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  types: [\"place\", \"postcode\"] as MapBoxFeatureType[],\n  countries: [\"US\", \"CA\", \"MX\", \"CU\", \"BM\", \"HT\", \"DO\"],\n  limit: 5,\n};\nasync function geocodingInfoForSearchLimited(searchText: string, options?: MapBoxForwardGeocodingOptions): Promise<MapBoxFeatureCollection | null> {\n  const token = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const opts = options ?? { ...defaultMapboxOptions, access_token: token ?? \"\" };\n  return geocodingInfoForSearch(searchText, opts).catch(_err => null);\n}\n\nfunction setLocationFromSearch(items: [MapBoxFeature | null, string]) {\n  const [feature, text] = items;\n  if (feature !== null) {\n    // Latitude, Longitude order\n    const coordinates: LatLngPair = [feature.center[1], feature.center[0]] as LatLngPair;\n    maplibreMap.value?.setView(coordinates, 12);\n    setMarker(coordinates);\n    store.userSelectedLocations.push(text);\n  }\n}\n\nfunction onZoomhome() {\n  if (locationMarker.value !== null) {\n    removeMarker();\n  }\n}\n\nconst currentUrl = ref(window.location.href);\nfunction updateURL() {\n  if (map.value) {\n    const center = map.value.getCenter();\n    let stateObj = null as Record<string, string> | null;\n    stateObj = {\n      lat: `${center.lat.toFixed(4)}`,\n      lon: `${center.lng.toFixed(4)}`,\n      zoom: `${map.value.getZoom()}`,\n      t: `${timestamp.value}`\n    };\n    const url = new URL(location.origin);\n    const searchParams = new URLSearchParams(stateObj ?? {});\n    // const hash = window.location.hash;\n    // url.hash = hash;\n    url.pathname = location.pathname;\n    window.history.replaceState(null, '', url.toString());\n    url.search = searchParams.toString();\n    currentUrl.value = url.toString();\n    // window.history.replaceState(stateObj, '', url);\n  }\n}\n\n// ESRI timesteps arrive from EsriMap component; store directly in timestamps\nfunction onEsriTimestepsLoaded(steps: number[]) {\n  if (!Array.isArray(steps) || steps.length === 0) return;\n  const sorted = steps.slice().sort();\n  timestamps.value = sorted;\n  if (timeIndex.value >= sorted.length) {\n    timeIndex.value = 0;\n  }\n  timestampsLoaded.value = true;\n}\n\nwatch(playing, (val: boolean) => {\n  if (val) {\n    play();\n    playButtonClickedCount.value += 1;\n  } else {\n    pause();\n  }\n});\n\nfunction play() {\n  playInterval.value = setInterval(() => {\n    if (timeIndex.value >= maxIndex.value) {\n      if (playInterval.value) {\n        // clearInterval(this.playInterval);\n        // this.playInterval = null;\n        // let it loop\n        timeIndex.value = minIndex.value;\n      }\n    } else {\n      timeIndex.value += 1;\n    }\n  }, 1000);\n}\n\n\nfunction pause() {\n  if (playInterval.value) {\n    clearInterval(playInterval.value);\n  }\n}\n\nfunction rectangleIsDegenerate(info: RectangleSelectionInfo): boolean {\n  return info.xmax === info.xmin || info.ymax === info.ymin;\n}\n\nfunction addLayer(\n  info: RectangleSelectionInfo | PointSelectionInfo,\n  geometryType: \"rectangle\" | \"point\",\n  color: string,\n): { layer: GeoJSONSource } {\n  const isRect = geometryType === 'rectangle';\n  const layerInfo = isRect ?\n    addRectangleLayer((map.value as MapType)!, info as RectangleSelectionInfo, color) :\n    addPointLayer((map.value as MapType)!, info as PointSelectionInfo, color);\n  map.value?.moveLayer(layerInfo.layer.id);\n  return layerInfo;\n}\n\nfunction removeLayer(\n  layer: StyleLayer,\n  geometryType: \"rectangle\" | \"point\",\n) {\n  const isRect = geometryType === 'rectangle';\n  if (isRect) {\n    removeRectangleLayer((map.value as MapType)!, layer);\n  } else {\n    removePointLayer((map.value as MapType)!, layer);\n  }\n}\n\nfunction createRegion(info: RectangleSelectionInfo | PointSelectionInfo, geometryType: \"rectangle\" | \"point\"): UnifiedRegionType {\n  const color = COLORS[regionsCreatedCount.value % COLORS.length];\n  regionsCreatedCount.value += 1;\n\n  const id = v4();\n  const { layer } = addLayer(info, geometryType, color);\n  regionLayers[id] = layer;\n  return {\n    id,\n    name: `${geometryType === \"rectangle\" ? 'Region' : 'Point'} ${regionsCreatedCount.value}`,\n    geometryInfo: toRaw(info),\n    geometryType: geometryType,\n    color,\n  };\n}\n\nfunction getRegionsDifference(arr1: UnifiedRegionType[], arr2: UnifiedRegionType[]): UnifiedRegionType[] {\n  const ids2 = arr2.map(r => r.id);\n  return arr1.filter(element => !ids2.includes(element.id));\n}\n\nlet existingRegions: UnifiedRegionType[] = [];\nfunction updateRegionLayers(newRegions: UnifiedRegionType[]) {\n  const added = getRegionsDifference(newRegions, existingRegions);\n  const removed = getRegionsDifference(existingRegions, newRegions);\n  added.forEach(region => {\n    if (map.value && !regionLayers[region.id]) {\n      const { layer } = addLayer(region.geometryInfo, region.geometryType, region.color);\n      regionLayers[region.id] = layer;\n    }\n  });\n\n  removed.forEach(region => {\n    if (map.value && regionLayers[region.id]) {\n      removeLayer(regionLayers[region.id] as unknown as StyleLayer, region.geometryType);\n      delete regionLayers[region.id];\n    }\n  });\n  existingRegions = [...newRegions];\n}\n\nwatch(regions, updateRegionLayers, { deep: true });\n\nwatch(rectangleInfo, (info: RectangleSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    rectangleSelectionActive.value = false;\n    return;\n  }\n  if (rectangleIsDegenerate(info)) {\n    // make it a point selection instead\n    // TODO: only implement when we have a solution to only do this on a double-click\n    // pointInfo.value = {\n    //   x: info.xmin,\n    //   y: info.ymin\n    // };\n    rectangleSelectionActive.value = false;\n    return;\n  }\n\n  const newRegion = createRegion(info, \"rectangle\");\n  store.addRegion(newRegion);\n  rectangleSelectionActive.value = false;\n  \n  // do not permit editing a region on a selection\n  // handleSelectionRegionEdit(info);\n  \n\n});\n\n// Add watcher for point selection\nwatch(pointInfo, (info: PointSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    pointSelectionActive.value = false;\n    return;\n  }\n  const newRegion = createRegion(info, \"point\"); \n  store.addRegion(newRegion);\n  pointSelectionActive.value = false;\n});\n\nconst samplingPreviewMarkers = useMultiMarker(map as MapTypeRef , {\n  shape: 'circle',\n  color: '#0000ff',\n  fillColor: '#0000ff',\n  fillOpacity: 0.5,\n  opacity: 1,\n  radius: 0.02 / 2, // degrees\n  scale: 'world',\n  outlineColor: '#0000ff',\n  label: 'predicted-samples-locations'\n});\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nconst sampler = ref<EsriSampler>(null);\ncurrentTempoDataService.value.withMetadataCache().then(meta => {\n  sampler.value = new EsriSampler(meta);\n});\n\nwatch([showSamplingPreviewMarkers, regions, ()=> regions.value.length], (newVal) => {\n  const tempoDataService = currentTempoDataService.value;\n  const show = newVal[0];\n  const regs = newVal[1];\n  samplingPreviewMarkers.clearMarkers();\n  let locations: {x: number, y:number}[] = [];\n  if (sampler.value && show && regs.length > 0) {\n    regs.forEach(r => {\n      if (r.geometryType === 'rectangle') {\n        sampler.value.setGeometry(r.geometryInfo);\n        if (tempoDataService.meta) {\n          sampler.value.setMetadata(tempoDataService.meta);\n        }\n        locations = [...locations, ...sampler.value.getSampleLocationsGrid(maxSampleCount.value)];\n        // samplingPreviewMarkers.addMarkers(locations);\n      }\n    });\n    samplingPreviewMarkers.addMarkers(locations);\n  }\n});\n\n// TODO: This may need to be revisited when there are two maps\nwatch(focusRegion, region => {\n  if (region !== null) {\n    const bounds = regionBounds(region);\n    fitBounds(map.value, bounds, true);\n    focusRegion.value = null;\n  }\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_location_search = _resolveComponent(\"location-search\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_slider = _resolveComponent(\"v-slider\")!\n  const _component_icon_button = _resolveComponent(\"icon-button\")!\n  const _component_map_controls = _resolveComponent(\"map-controls\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(MapColorbarWrap, {\n      horizontal: _unref(display).width.value <= 750,\n      \"current-colormap\": currentColormap.value,\n      \"color-map\": colorMap.value,\n      \"start-value\": _unref(colorbarOptions)[molecule.value].stretch[0] / _unref(colorbarOptions)[molecule.value].cbarScale,\n      \"end-value\": _unref(colorbarOptions)[molecule.value].stretch[1] / _unref(colorbarOptions)[molecule.value].cbarScale,\n      \"molecule-label\": _unref(colorbarOptions)[molecule.value].label,\n      \"cbar-scale\": _unref(colorbarOptions)[molecule.value].cbarScale\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_card, {\n          class: \"map-contents\",\n          style: {\"width\":\"100%\",\"height\":\"100%\"}\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_toolbar, {\n              density: \"compact\",\n              color: \"var(--info-background)\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_toolbar_title, {\n                  text: `TEMPO Data Viewer: ${mapTitle.value}`\n                }, null, 8, [\"text\"]),\n                _createVNode(_component_v_tooltip, {\n                  text: _unref(selectionActive) === 'rectangle' ? 'Cancel selection' : 'Select a region'\n                }, {\n                  activator: _withCtx(({ props }) => [\n                    _createVNode(_component_v_btn, _mergeProps(props, {\n                      icon: \"mdi-select\",\n                      color: _unref(selectionActive) === 'rectangle' ? 'info' : 'default',\n                      variant: _unref(selectionActive) === 'rectangle' ? 'tonal' : 'text',\n                      disabled: _unref(selectionActive) === 'point',\n                      onClick: activateRectangleSelectionMode\n                    }), null, 16, [\"color\", \"variant\", \"disabled\"])\n                  ]),\n                  _: 1\n                }, 8, [\"text\"]),\n                _createVNode(_component_v_tooltip, {\n                  text: _unref(selectionActive) === 'point' ? 'Cancel selection' : 'Select a point'\n                }, {\n                  activator: _withCtx(({ props }) => [\n                    _createVNode(_component_v_btn, _mergeProps(props, {\n                      icon: \"mdi-plus\",\n                      color: _unref(selectionActive) === 'point' ? 'info' : 'default',\n                      variant: _unref(selectionActive) === 'point' ? 'tonal' : 'text',\n                      disabled: _unref(selectionActive) === 'rectangle',\n                      onClick: activatePointSelectionMode\n                    }), null, 16, [\"color\", \"variant\", \"disabled\"])\n                  ]),\n                  _: 1\n                }, 8, [\"text\"])\n              ]),\n              _: 1\n            }),\n            _createVNode(EsriMap, {\n              mapID: mapID,\n              initial: _unref(initState),\n              home: _unref(homeState),\n              \"show-roads\": _unref(showRoads),\n              events: {\n            'moveend': updateURL,\n            'zoomend': updateURL,\n          },\n              timestamp: _unref(timestamp),\n              molecule: molecule.value,\n              opacity: opacity.value,\n              \"show-field-of-regard\": _unref(showFieldOfRegard),\n              onZoomhome: onZoomhome,\n              onReady: onMapReady,\n              onEsriTimestepsLoaded: onEsriTimestepsLoaded,\n              ref_key: \"maplibreMap\",\n              ref: maplibreMap,\n              width: \"100%\",\n              height: \"450px\"\n            }, null, 8, [\"initial\", \"home\", \"show-roads\", \"events\", \"timestamp\", \"molecule\", \"opacity\", \"show-field-of-regard\"]),\n            (_unref(showFieldOfRegard))\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[6] || (_cache[6] = [\n                  _createElementVNode(\"hr\", { class: \"line-legend\" }, null, -1),\n                  _createTextVNode(\"TEMPO Field of Regard\", -1)\n                ]))]))\n              : _createCommentVNode(\"\", true),\n            _createElementVNode(\"div\", _hoisted_3, [\n              _createVNode(_component_location_search, {\n                modelValue: searchOpen.value,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((searchOpen).value = $event)),\n                small: \"\",\n                \"stay-open\": \"\",\n                buttonSize: \"xl\",\n                \"persist-selected\": \"\",\n                \"search-provider\": geocodingInfoForSearchLimited,\n                onSetLocation: setLocationFromSearch,\n                onError: _cache[1] || (_cache[1] = (error) => searchErrorMessage.value = error)\n              }, null, 8, [\"modelValue\"])\n            ])\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"horizontal\", \"current-colormap\", \"color-map\", \"start-value\", \"end-value\", \"molecule-label\", \"cbar-scale\"]),\n    _createElementVNode(\"div\", _hoisted_4, [\n      _createVNode(_component_v_slider, {\n        class: \"time-slider\",\n        modelValue: _unref(timeIndex),\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => (_isRef(timeIndex) ? (timeIndex).value = $event : null)),\n        min: _unref(minIndex),\n        max: _unref(maxIndex),\n        step: 1,\n        color: \"#068ede95\",\n        \"thumb-label\": \"always\",\n        \"track-size\": 10,\n        \"show-ticks\": \"always\",\n        \"hide-details\": \"\",\n        onEnd: _cache[3] || (_cache[3] = () => {\n          timeSliderUsedCount.value += 1;\n          if (map.value) {\n            _unref(setLayerVisibility)(map.value as Map, 'esri-source', true);\n          }\n        })\n      }, {\n        \"thumb-label\": _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_5, _toDisplayString(thumbLabel.value), 1)\n        ]),\n        _: 1\n      }, 8, [\"modelValue\", \"min\", \"max\"]),\n      _createVNode(_component_icon_button, {\n        class: \"play-pause\",\n        \"fa-icon\": playing.value ? 'pause' : 'play',\n        \"fa-size\": \"sm\",\n        onActivate: _cache[4] || (_cache[4] = ($event: any) => (playing.value = !playing.value))\n      }, null, 8, [\"fa-icon\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_6, [\n      _createVNode(_component_map_controls, {\n        class: \"flex-grow-1\",\n        onMolecule: _cache[5] || (_cache[5] = (mol) => {\n          molecule.value = mol;\n          if (map.value) {\n            _unref(setLayerVisibility)(map.value as Map, 'esri-source', true);\n          }\n        })\n      })\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"map-container\">\n    <map-colorbar-wrap\n      :horizontal=\"display.width.value <= 750\"\n      :current-colormap=\"currentColormap\"\n      :color-map=\"colorMap\"\n      :start-value=\"colorbarOptions[molecule].stretch[0] / colorbarOptions[molecule].cbarScale\"\n      :end-value=\"colorbarOptions[molecule].stretch[1] / colorbarOptions[molecule].cbarScale\"\n      :molecule-label=\"colorbarOptions[molecule].label\"\n      :cbar-scale=\"colorbarOptions[molecule].cbarScale\"\n    >\n      <v-card class=\"map-contents\" style=\"width:100%; height: 100%;\">\n        <v-toolbar\n          density=\"compact\"\n          color=\"var(--info-background)\"\n        >\n          <v-toolbar-title :text=\"`TEMPO Data Viewer: ${mapTitle}`\"></v-toolbar-title>\n          <!-- switch for preview points -->\n          <v-tooltip :text=\"selectionActive === 'rectangle' ? 'Cancel selection' : 'Select a region'\">\n            <template #activator=\"{ props }\">\n              <v-btn\n                v-bind=\"props\"\n                icon=\"mdi-select\"\n                :color=\"selectionActive === 'rectangle' ? 'info' : 'default'\"\n                :variant=\"selectionActive === 'rectangle' ? 'tonal' : 'text'\"\n                :disabled=\"selectionActive === 'point'\"\n                @click=\"activateRectangleSelectionMode\"\n              ></v-btn>\n            </template>\n          </v-tooltip>\n          <v-tooltip :text=\"selectionActive === 'point' ? 'Cancel selection' : 'Select a point'\">\n            <template #activator=\"{ props }\">\n              <v-btn\n                v-bind=\"props\"\n                icon=\"mdi-plus\"\n                :color=\"selectionActive === 'point' ? 'info' : 'default'\"\n                :variant=\"selectionActive === 'point' ? 'tonal' : 'text'\"\n                :disabled=\"selectionActive === 'rectangle'\"\n                @click=\"activatePointSelectionMode\"\n              ></v-btn>\n            </template>\n          </v-tooltip>\n        </v-toolbar>\n        <EsriMap\n          :mapID=\"mapID\"\n          :initial=\"initState\"\n          :home=\"homeState\"\n          :show-roads=\"showRoads\"\n          :events=\"{\n            'moveend': updateURL,\n            'zoomend': updateURL,\n          }\"\n          :timestamp=\"timestamp\"\n          :molecule=\"molecule\"\n          :opacity=\"opacity\"\n          :show-field-of-regard=\"showFieldOfRegard\"\n          @zoomhome=\"onZoomhome\"\n          @ready=\"onMapReady\"\n          @esri-timesteps-loaded=\"onEsriTimestepsLoaded\"\n          ref=\"maplibreMap\"\n          width=\"100%\"\n          height=\"450px\"\n        />\n\n        <div v-if=\"showFieldOfRegard\" class=\"map-legend\"><hr class=\"line-legend\">TEMPO Field of Regard</div>\n        <!-- show hide cloud data, disable if none is available -->\n\n        <div class=\"location-and-sharing\">\n          <location-search\n            v-model=\"searchOpen\"\n            small\n            stay-open\n            buttonSize=\"xl\"\n            persist-selected\n            :search-provider=\"geocodingInfoForSearchLimited\"\n            @set-location=\"setLocationFromSearch\"\n            @error=\"(error: string) => searchErrorMessage = error\"\n          ></location-search>\n        </div>\n      </v-card>\n    </map-colorbar-wrap>\n    <div class=\"slider-row mx-16 mt-12\">\n      <v-slider\n        class=\"time-slider\"\n        v-model=\"timeIndex\"\n        :min=\"minIndex\"\n        :max=\"maxIndex\"\n        :step=\"1\"\n        color=\"#068ede95\"\n        thumb-label=\"always\"\n        :track-size=\"10\"\n        show-ticks=\"always\"\n        hide-details\n        @end=\"() => {\n          timeSliderUsedCount += 1;\n          if (map) {\n            setLayerVisibility(map as Map, 'esri-source', true);\n          }\n        }\"\n      >\n        <template v-slot:thumb-label>\n          <div class=\"thumb-label\">\n            {{ thumbLabel }}\n          </div>\n        </template>\n      </v-slider>\n      <icon-button\n        class=\"play-pause\"\n        :fa-icon=\"playing ? 'pause' : 'play'\"\n        fa-size=\"sm\"\n        @activate=\"playing = !playing\"\n      ></icon-button>\n    </div>\n    <div class=\"d-flex flex-row\">\n      <map-controls\n        class=\"flex-grow-1\"\n        @molecule=\"(mol: MoleculeType) => {\n          molecule = mol;\n          if (map) {\n            setLayerVisibility(map as Map, 'esri-source', true);\n          }\n        }\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { computed, ref, toRaw, useTemplateRef, watch, type Ref, type WritableComputedRef } from \"vue\";\nimport { useDisplay } from 'vuetify';\nimport { storeToRefs } from \"pinia\";\nimport { MapBoxFeature, MapBoxFeatureCollection, MapBoxFeatureType, MapBoxForwardGeocodingOptions, geocodingInfoForSearch } from \"@cosmicds/vue-toolkit\";\nimport { Map, GeoJSONSource, type StyleLayer } from \"maplibre-gl\";\nimport { getTimezoneOffset } from \"date-fns-tz\";\nimport { v4 } from \"uuid\";\n\nimport type { LatLngPair, PointSelectionInfo, RectangleSelectionInfo, SelectionType } from \"@/types\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"@/esri/utils\";\nimport { colorbarOptions } from \"@/esri/ImageLayerConfig\";\nimport { colormap } from \"@/colormaps/utils\";\nimport { useTempoStore } from \"@/stores/app\";\nimport { useLocationMarker } from \"@/composables/maplibre/useMarker\";\nimport { useRectangleSelection } from \"@/composables/maplibre/useRectangleSelection\";\nimport { addRectangleLayer, addPointLayer, regionBounds, fitBounds, removeRectangleLayer, removePointLayer } from \"@/composables/maplibre/utils\";\nimport { usePointSelection } from \"@/composables/maplibre/usePointSelection\";\nimport { COLORS } from \"@/utils/color\";\nimport { EsriSampler } from \"@/esri/services/sampling\";\nimport { useMultiMarker } from '@/composables/maplibre/useMultiMarker';\n\nimport { setLayerVisibility } from \"@/maplibre_controls\";\n\nimport EsriMap from \"@/components/EsriMap.vue\";\nimport MapColorbarWrap from \"@/components/MapColorbarWrap.vue\";\n\ntype MapType = Map | null;\ntype MapTypeRef = Ref<MapType>;\nconst maplibreMap = useTemplateRef<InstanceType<typeof EsriMap>>(\"maplibreMap\");\nconst map = ref<MapType>(null);\n\ntype Timeout = ReturnType<typeof setTimeout>;\n\nconst mapID = `map-${v4().replace(\"-\", \"\")}`;\n\nconst store = useTempoStore();\nconst {\n  regions,\n  timestamp,\n  timeIndex,\n  minIndex,\n  maxIndex,\n  date,\n  selectedTimezone,\n  timeSliderUsedCount,\n  playButtonClickedCount,\n  timestamps,\n  timestampsLoaded,\n  selectionActive,\n  regionsCreatedCount,\n  maxSampleCount,\n  focusRegion,\n  initState,\n  homeState,\n  showFieldOfRegard,\n  showRoads,\n  showSamplingPreviewMarkers,\n} = storeToRefs(store);\n\nconst molecule = ref<MoleculeType>(\"no2\");\nconst colorMap = computed(() => colorbarOptions[molecule.value].colormap.toLowerCase());\nconst currentTempoDataService = computed(() => store.getTempoDataService(molecule.value));\n\nfunction createSelectionComputed(selection: SelectionType): WritableComputedRef<boolean> {\n  return computed({\n    get() {\n      return selectionActive.value === selection;\n    },\n    set(value: boolean) {\n      if (value === (selectionActive.value !== selection)) {\n        selectionActive.value = value ? selection : null;\n      }\n    },\n  });\n}\n\nconst pointSelectionActive = createSelectionComputed(\"point\");\nconst rectangleSelectionActive = createSelectionComputed(\"rectangle\");\n\nconst { selectionInfo: rectangleInfo } = useRectangleSelection(map as MapTypeRef, \"red\", rectangleSelectionActive);\nconst { selectionInfo: pointInfo } = usePointSelection(map as MapTypeRef, pointSelectionActive);\n\ntype UnifiedRegionType = typeof regions.value[number];\n\nconst display = useDisplay();\n\nimport { addPowerPlants } from \"@/composables/addPowerPlants\";\nimport { MaplibreLayersControl } from \"@/MaplibreLayerControl\";\n\nconst pp = addPowerPlants(map as Ref<Map | null> | null);\nimport { addQUI } from '@/composables/addAQI';\n\n// base it of singleDateSelected\nconst airQualityUrl = computed(() => {\n  const date = store.singleDateSelected;\n  if (!date) {\n    return 'https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/2025/20250914/KMLPointMaps_PM2.5-24hr.kml';\n  }\n\n  const year = date.getUTCFullYear();\n  const month = (date.getUTCMonth() + 1).toString().padStart(2, '0');\n  const day = date.getUTCDate().toString().padStart(2, '0');\n  return `https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/${year}/${year}${month}${day}/KMLPointMaps_PM2.5-24hr.kml`;\n});\nconst aqiLayer = addQUI(airQualityUrl.value, { \n  propertyToShow: 'aqi', \n  labelMinZoom: 5, \n  layerName: 'aqi', \n  visible: true,\n  showLabel: true, \n  showPopup: true\n});\n\n// Ensure date/url changes trigger a reload, even if initial load failed\nwatch(airQualityUrl, (newUrl) => {\n  aqiLayer.setUrl(newUrl).catch(() => {/* ignore */});\n});\n\n\nconst onMapReady = (m: Map) => {\n  console.log('Map ready event received');\n  map.value = m; // ESRI source already added by EsriMap\n  pp.addheatmapLayer();\n  // pp.togglePowerPlants(false);\n  aqiLayer.addToMap(m);\n  // Only move if target layer exists (avoid errors if initial KML load failed)\n  try {\n    if (m.getLayer('kml-layer-aqi')) {\n      m.moveLayer('states-custom','kml-layer-aqi');\n    }\n  } catch {\n    // ignore\n  }\n  \n  aqiLayer.layerVisible.value = false;\n  pp.togglePowerPlants(false);\n  updateRegionLayers(regions.value);\n};\n\nconst showLocationMarker = ref(true);\nconst {\n  setMarker,\n  removeMarker,\n  locationMarker,\n} = useLocationMarker(map as Ref<Map | null>, showLocationMarker.value);\n\nconst opacity = ref(0.9);\nconst playing = ref(false);\nconst playInterval = ref<Timeout | null>(null);\n\n\nconst searchOpen = ref(true);\nconst searchErrorMessage = ref<string | null>(null);\nfunction activateRectangleSelectionMode() {\n  rectangleSelectionActive.value = !rectangleSelectionActive.value;\n}\n\nfunction activatePointSelectionMode() {\n  pointSelectionActive.value = !pointSelectionActive.value;\n}\n\nconst regionLayers: Record<string, GeoJSONSource> = {};\n\nconst currentColormap = computed(() => {\n  return (x: number): string => {\n    const rgb = colormap(colorMap.value, 0, 1, x);\n    return `rgba(${rgb[0]}, ${rgb[1]}, ${rgb[2]},1)`;\n  };\n});\n\nconst mapTitle = computed(() => {\n  const currentMolecule = MOLECULE_OPTIONS.find(m => m.value === molecule.value);\n  if (!currentMolecule) {\n    return '';\n  }\n  return currentMolecule.title;\n});\n\n// TODO: Maybe there's a built-in Date function to get this formatting?\nconst thumbLabel = computed(() => {\n  if (date.value === null || timestamp.value === null) {\n    return '';\n  }\n  const offset = getTimezoneOffset(selectedTimezone.value, date.value);\n  const dateObj = new Date(timestamp.value + offset);\n  const hours = dateObj.getUTCHours();\n  const amPm = hours >= 12 ? \"PM\" : \"AM\";\n  let hourValue = hours % 12;\n  if (hourValue === 0) {\n    hourValue = 12;\n  }\n  return `${date.value.getUTCMonth() + 1}/${dateObj.getUTCDate()}/${dateObj.getUTCFullYear()} ${hourValue}:${dateObj.getUTCMinutes().toString().padStart(2, '0')} ${amPm}`;\n});\n\nconst defaultMapboxOptions = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  types: [\"place\", \"postcode\"] as MapBoxFeatureType[],\n  countries: [\"US\", \"CA\", \"MX\", \"CU\", \"BM\", \"HT\", \"DO\"],\n  limit: 5,\n};\nasync function geocodingInfoForSearchLimited(searchText: string, options?: MapBoxForwardGeocodingOptions): Promise<MapBoxFeatureCollection | null> {\n  const token = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const opts = options ?? { ...defaultMapboxOptions, access_token: token ?? \"\" };\n  return geocodingInfoForSearch(searchText, opts).catch(_err => null);\n}\n\nfunction setLocationFromSearch(items: [MapBoxFeature | null, string]) {\n  const [feature, text] = items;\n  if (feature !== null) {\n    // Latitude, Longitude order\n    const coordinates: LatLngPair = [feature.center[1], feature.center[0]] as LatLngPair;\n    maplibreMap.value?.setView(coordinates, 12);\n    setMarker(coordinates);\n    store.userSelectedLocations.push(text);\n  }\n}\n\nfunction onZoomhome() {\n  if (locationMarker.value !== null) {\n    removeMarker();\n  }\n}\n\nconst currentUrl = ref(window.location.href);\nfunction updateURL() {\n  if (map.value) {\n    const center = map.value.getCenter();\n    let stateObj = null as Record<string, string> | null;\n    stateObj = {\n      lat: `${center.lat.toFixed(4)}`,\n      lon: `${center.lng.toFixed(4)}`,\n      zoom: `${map.value.getZoom()}`,\n      t: `${timestamp.value}`\n    };\n    const url = new URL(location.origin);\n    const searchParams = new URLSearchParams(stateObj ?? {});\n    // const hash = window.location.hash;\n    // url.hash = hash;\n    url.pathname = location.pathname;\n    window.history.replaceState(null, '', url.toString());\n    url.search = searchParams.toString();\n    currentUrl.value = url.toString();\n    // window.history.replaceState(stateObj, '', url);\n  }\n}\n\n// ESRI timesteps arrive from EsriMap component; store directly in timestamps\nfunction onEsriTimestepsLoaded(steps: number[]) {\n  if (!Array.isArray(steps) || steps.length === 0) return;\n  const sorted = steps.slice().sort();\n  timestamps.value = sorted;\n  if (timeIndex.value >= sorted.length) {\n    timeIndex.value = 0;\n  }\n  timestampsLoaded.value = true;\n}\n\nwatch(playing, (val: boolean) => {\n  if (val) {\n    play();\n    playButtonClickedCount.value += 1;\n  } else {\n    pause();\n  }\n});\n\nfunction play() {\n  playInterval.value = setInterval(() => {\n    if (timeIndex.value >= maxIndex.value) {\n      if (playInterval.value) {\n        // clearInterval(this.playInterval);\n        // this.playInterval = null;\n        // let it loop\n        timeIndex.value = minIndex.value;\n      }\n    } else {\n      timeIndex.value += 1;\n    }\n  }, 1000);\n}\n\n\nfunction pause() {\n  if (playInterval.value) {\n    clearInterval(playInterval.value);\n  }\n}\n\nfunction rectangleIsDegenerate(info: RectangleSelectionInfo): boolean {\n  return info.xmax === info.xmin || info.ymax === info.ymin;\n}\n\nfunction addLayer(\n  info: RectangleSelectionInfo | PointSelectionInfo,\n  geometryType: \"rectangle\" | \"point\",\n  color: string,\n): { layer: GeoJSONSource } {\n  const isRect = geometryType === 'rectangle';\n  const layerInfo = isRect ?\n    addRectangleLayer((map.value as MapType)!, info as RectangleSelectionInfo, color) :\n    addPointLayer((map.value as MapType)!, info as PointSelectionInfo, color);\n  map.value?.moveLayer(layerInfo.layer.id);\n  return layerInfo;\n}\n\nfunction removeLayer(\n  layer: StyleLayer,\n  geometryType: \"rectangle\" | \"point\",\n) {\n  const isRect = geometryType === 'rectangle';\n  if (isRect) {\n    removeRectangleLayer((map.value as MapType)!, layer);\n  } else {\n    removePointLayer((map.value as MapType)!, layer);\n  }\n}\n\nfunction createRegion(info: RectangleSelectionInfo | PointSelectionInfo, geometryType: \"rectangle\" | \"point\"): UnifiedRegionType {\n  const color = COLORS[regionsCreatedCount.value % COLORS.length];\n  regionsCreatedCount.value += 1;\n\n  const id = v4();\n  const { layer } = addLayer(info, geometryType, color);\n  regionLayers[id] = layer;\n  return {\n    id,\n    name: `${geometryType === \"rectangle\" ? 'Region' : 'Point'} ${regionsCreatedCount.value}`,\n    geometryInfo: toRaw(info),\n    geometryType: geometryType,\n    color,\n  };\n}\n\nfunction getRegionsDifference(arr1: UnifiedRegionType[], arr2: UnifiedRegionType[]): UnifiedRegionType[] {\n  const ids2 = arr2.map(r => r.id);\n  return arr1.filter(element => !ids2.includes(element.id));\n}\n\nlet existingRegions: UnifiedRegionType[] = [];\nfunction updateRegionLayers(newRegions: UnifiedRegionType[]) {\n  const added = getRegionsDifference(newRegions, existingRegions);\n  const removed = getRegionsDifference(existingRegions, newRegions);\n  added.forEach(region => {\n    if (map.value && !regionLayers[region.id]) {\n      const { layer } = addLayer(region.geometryInfo, region.geometryType, region.color);\n      regionLayers[region.id] = layer;\n    }\n  });\n\n  removed.forEach(region => {\n    if (map.value && regionLayers[region.id]) {\n      removeLayer(regionLayers[region.id] as unknown as StyleLayer, region.geometryType);\n      delete regionLayers[region.id];\n    }\n  });\n  existingRegions = [...newRegions];\n}\n\nwatch(regions, updateRegionLayers, { deep: true });\n\nwatch(rectangleInfo, (info: RectangleSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    rectangleSelectionActive.value = false;\n    return;\n  }\n  if (rectangleIsDegenerate(info)) {\n    // make it a point selection instead\n    // TODO: only implement when we have a solution to only do this on a double-click\n    // pointInfo.value = {\n    //   x: info.xmin,\n    //   y: info.ymin\n    // };\n    rectangleSelectionActive.value = false;\n    return;\n  }\n\n  const newRegion = createRegion(info, \"rectangle\");\n  store.addRegion(newRegion);\n  rectangleSelectionActive.value = false;\n  \n  // do not permit editing a region on a selection\n  // handleSelectionRegionEdit(info);\n  \n\n});\n\n// Add watcher for point selection\nwatch(pointInfo, (info: PointSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    pointSelectionActive.value = false;\n    return;\n  }\n  const newRegion = createRegion(info, \"point\"); \n  store.addRegion(newRegion);\n  pointSelectionActive.value = false;\n});\n\nconst samplingPreviewMarkers = useMultiMarker(map as MapTypeRef , {\n  shape: 'circle',\n  color: '#0000ff',\n  fillColor: '#0000ff',\n  fillOpacity: 0.5,\n  opacity: 1,\n  radius: 0.02 / 2, // degrees\n  scale: 'world',\n  outlineColor: '#0000ff',\n  label: 'predicted-samples-locations'\n});\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nconst sampler = ref<EsriSampler>(null);\ncurrentTempoDataService.value.withMetadataCache().then(meta => {\n  sampler.value = new EsriSampler(meta);\n});\n\nwatch([showSamplingPreviewMarkers, regions, ()=> regions.value.length], (newVal) => {\n  const tempoDataService = currentTempoDataService.value;\n  const show = newVal[0];\n  const regs = newVal[1];\n  samplingPreviewMarkers.clearMarkers();\n  let locations: {x: number, y:number}[] = [];\n  if (sampler.value && show && regs.length > 0) {\n    regs.forEach(r => {\n      if (r.geometryType === 'rectangle') {\n        sampler.value.setGeometry(r.geometryInfo);\n        if (tempoDataService.meta) {\n          sampler.value.setMetadata(tempoDataService.meta);\n        }\n        locations = [...locations, ...sampler.value.getSampleLocationsGrid(maxSampleCount.value)];\n        // samplingPreviewMarkers.addMarkers(locations);\n      }\n    });\n    samplingPreviewMarkers.addMarkers(locations);\n  }\n});\n\n// TODO: This may need to be revisited when there are two maps\nwatch(focusRegion, region => {\n  if (region !== null) {\n    const bounds = regionBounds(region);\n    fitBounds(map.value, bounds, true);\n    focusRegion.value = null;\n  }\n});\n\n</script>\n\n<style lang=\"less\">\n.map-container {\n  width: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n\n  .location-and-sharing {\n    position: absolute;\n    bottom: 0;\n    z-index: 1000;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n    width: fit-content;\n  }\n\n  .forward-geocoding-container {\n    width: 250px;\n    border: 2px solid black;\n  }\n\n  .map-show-hide-controls {\n    z-index: 1000;\n    position: absolute;\n    top: calc(48px + 1rem);\n    right: 80px;\n  }\n\n  .map-legend {\n    position: absolute;\n    top: 48px;\n    right: 80px;\n    width: fit-content;\n    z-index: 1000;\n\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n\n    color: black;\n    background-color: #fff5;\n    padding-left: 0.5rem;\n    padding-right: 0.25rem;\n\n    backdrop-filter: blur(5px);\n\n    hr.line-legend {\n      display: inline-block;\n      border: 0.5px solid #c10124;\n      width: 3rem;\n    }\n  }\n\n  .controls-card {\n    padding: 1rem;\n    border: 1px solid #068ede;\n  }\n\n  .slider-row {\n    display: flex;\n    flex-direction: row;\n    padding-left: 0;\n  }\n\n  >.play-pause {\n    height: fit-content;\n    align-self: center;\n    padding-inline: 0.5rem;\n    margin-left: 0.75rem;\n    width: 2.5rem;\n    color: var(--accent-color);\n    border: 2px solid var(--accent-color);\n  }\n\n  .play-pause[disabled] {\n    filter: grayscale(100%);\n    cursor: progress;\n    cursor: not-allowed;\n  }\n\n  .icon-wrapper {\n    padding-inline: 0.5rem !important;\n  }\n}\n\n.time-slider {\n\n  .v-slider-thumb {\n\n    .v-slider-thumb__surface::after {\n      background-image: url(\"@/assets/smithsonian.png\");\n      background-size: 30px 30px;\n      height: 30px;\n      width: 30px;\n    }\n\n    .v-slider-thumb__label {\n      background-color: var(--accent-color-2);\n      border: 0.25rem solid var(--accent-color);\n      width: max-content;\n      height: 2.5rem;\n      font-size: 1rem;\n\n      &::before {\n        color: var(--accent-color);\n      }\n    }\n  }\n\n  .v-slider-track__tick {\n    background-color: var(--accent-color);\n    /* Change color */\n    height: 15px;\n    /* Change size */\n    width: 4px;\n    margin-top: 0 !important;\n    // top: -10%;\n  }\n\n  .v-slider {\n\n    .v-slider.v-input--horizontal {\n      grid-template-rows: auto 0px;\n    }\n\n    .v-slider.v-input--horizontal .v-slider-thumb__label {\n      // top: calc(var(--v-slider-thumb-size) * 1.5);\n      z-index: 2000;\n    }\n\n    .v-slider.v-input--horizontal .v-slider-thumb__label::before {\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-bottom: 6px solid transparent;\n      border-top: 6px solid currentColor;\n      bottom: -15px;\n    }\n  }\n}\n\n#opacity-slider-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  padding-left: 7%;\n  padding-right: 7%;\n  gap: 2px;\n\n  .v-slider {\n    margin-right: 0;\n    width: 100%;\n  }\n\n  #opacity-slider-label {\n    opacity: 0.7;\n    width: fit-content;\n  }\n}\n\n@import \"@/styles/maplibre-layer-control.css\";\n</style>\n","import script from \"./MapWithControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapWithControls.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapWithControls.vue?vue&type=style&index=0&id=6b9718f5&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, mergeProps as _mergeProps, renderSlot as _renderSlot, toDisplayString as _toDisplayString, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\ninterface Props {\n  infoText: string;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'PopupInfoButton',\n  props: {\n    infoText: {}\n  },\n  setup(__props: any) {\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_menu = _resolveComponent(\"v-menu\")!\n\n  return (_openBlock(), _createBlock(_component_v_menu, { \"open-on-hover\": \"\" }, {\n    activator: _withCtx(({ props }) => [\n      _createVNode(_component_v_btn, _mergeProps({ icon: \"\" }, props, { density: \"compact\" }), {\n        default: _withCtx(() => [\n          _createVNode(_component_v_icon, null, {\n            default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n              _createTextVNode(\"mdi-information-variant-circle-outline\", -1)\n            ]))]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 16)\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_component_v_card, { class: \"info-card\" }, {\n        default: _withCtx(() => [\n          _renderSlot(_ctx.$slots, \"info\", {}, () => [\n            _createVNode(_component_v_card_text, null, {\n              default: _withCtx(() => [\n                _createTextVNode(_toDisplayString(__props.infoText), 1)\n              ]),\n              _: 1\n            })\n          ])\n        ]),\n        _: 3\n      })\n    ]),\n    _: 3\n  }))\n}\n}\n\n})","<template>\n  <v-menu open-on-hover>\n    <template #activator=\"{ props }\">\n      <v-btn\n        icon\n        v-bind=\"props\"\n        density=\"compact\"\n      >\n        <v-icon>mdi-information-variant-circle-outline</v-icon>\n      </v-btn>\n    </template>\n    <v-card class=\"info-card\">\n      <slot name=\"info\">\n        <v-card-text>{{ infoText }}</v-card-text>\n      </slot>\n    </v-card>\n  </v-menu>\n</template>\n\n<script setup lang=\"ts\">\ninterface Props {\n  infoText: string;\n}\n\ndefineProps<Props>();\n</script>\n\n<style scoped>\n.info-card {\n  padding: 10px;\n  border-radius: 5px;\n}\n</style>\n","import script from \"./PopupInfoButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PopupInfoButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PopupInfoButton.vue?vue&type=style&index=0&id=5836b27e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5836b27e\"]])\n\nexport default __exports__","\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { type Ref, type MaybeRef, ref, toRef, watch, computed, onBeforeUnmount } from 'vue';\nimport M from 'maplibre-gl';\n\nfunction checkArrayEquality<T>(arr1: T[], arr2: T[]) {\n  if (arr1.length !== arr2.length) return false;\n  return arr1.map((v, i) => v === arr2[i]).every(v => v);\n}\n\nfunction isSubset<T>(subset: T[], superset: T[]) {\n  return subset.every(v => superset.includes(v));\n}\n\n/** \n * Make the element at fromIndex be at toIndex, shifting other elements as needed\n * Does not mutate the original array, returns a new array\n * Throws error if fromIndex or toIndex are out of bounds\n */\nfunction arrayMove<T>(arr: T[], fromIndex: number, toIndex: number) {\n  if (fromIndex < 0 || fromIndex >= arr.length) {\n    throw new Error('fromIndex out of bounds');\n  }\n  if (toIndex < 0 || toIndex >= arr.length) {\n    throw new Error('toIndex out of bounds');\n  }\n  \n  const newArr = [...arr];\n  \n  if (fromIndex === toIndex) return newArr;\n  \n  // remove the element from fromIndex and insert it at toIndex\n  const element = newArr.splice(fromIndex, 1)[0];\n  newArr.splice(toIndex, 0, element);\n   \n  \n  return newArr;\n  \n}\n\ninterface Options {\n  keepAtTop?: boolean;\n}\n\nclass PsuedoEvent {\n  private listeners: Record<string, Array<() => void>> = {};\n  \n  addEventListener(event: string, handler: () => void) {\n    if (!this.listeners[event]) {\n      this.listeners[event] = [];\n    }\n    this.listeners[event].push(handler);\n  }\n  \n  removeEventListener(event: string, handler: () => void) {\n    if (!this.listeners[event]) return;\n    this.listeners[event] = this.listeners[event].filter(h => h !== handler);\n  }\n  \n  dispatchEvent(event: string) {\n    if (!this.listeners[event]) return;\n    this.listeners[event].forEach(handler => handler());\n  }\n  \n  cleanup() {\n    this.listeners = {};\n  }\n}\n\ntype MaplibreLayerOrderControlEvent = 'layer-order-changed';\n// higher index = higher layer\nexport class MaplibreLayerOrderControl extends PsuedoEvent {\n  private map: M.Map;\n  private desiredLayerOrder: string[]; // bottom to top \n  private keepAtTop: boolean;\n  private initialized = false;\n  private eventHandlers: [string, () => void][] = [];\n  \n  constructor(map: M.Map, initialOrder: string[], options: Options = {}) {\n    super();\n    this.desiredLayerOrder = initialOrder;\n    console.log('Creating MaplibreLayerOrderControl with initial order', initialOrder, 'and options', options);\n    this.map = map;\n    this.keepAtTop = options.keepAtTop ?? false;\n    \n    const idleListener = () => {\n      this.orderLayers();\n      this.initialized = true;\n      this.watchForChanges();\n      this.map.off('idle', idleListener);\n    };\n    // wait for map to be ready\n    this.map.on('idle',idleListener);\n    \n  }\n  \n  on(event: MaplibreLayerOrderControlEvent, handler: () => void) {\n    this.addEventListener(event, handler);\n  }\n  \n  \n  \n  \n  \n\n  get desiredLayerAvailability() {\n    return this.desiredLayerOrder.reduce((acc, layer) => {\n      acc[layer] = this.hasLayer(layer);\n      return acc;\n    }, {} as Record<string, boolean>);\n  }\n  \n  get availableDesiredOrder() {\n    return this.desiredLayerOrder.filter(l => this.hasLayer(l));\n  }\n  \n  get currentlyManagedLayerOrder() {\n    return this.map.\n      getLayersOrder().\n      filter(l => this.desiredLayerOrder.includes(l));\n  }\n  \n  \n  private orderLayers() {\n    if (this.keepAtTop) {\n      // moves top-most managed available layer to the top\n      this.startAtTop(); \n    }\n    \n    for (let i = this.desiredLayerOrder.length - 1; i > 0; i--) {\n      const bottomLayer = this.desiredLayerOrder[i-1];\n      const topLayer = this.desiredLayerOrder[i];\n      this.safeMoveLayerBelow(bottomLayer, topLayer);\n    }\n    this.dispatchEvent('layer-order-changed');\n  }\n  \n  private maintainOrder() {\n    if (!checkArrayEquality(this.availableDesiredOrder, this.currentlyManagedLayerOrder)) {\n      this.orderLayers();\n    }\n  }\n  \n  private watchForChanges() {\n    const onStyleData = () => this.maintainOrder();\n    this.map.on('styledata', () => {\n      console.log('watchForChanges styledata event');\n      onStyleData();\n    });\n    this.eventHandlers.push(['styledata', onStyleData]);\n  }\n  \n  destroy() {\n    this.cleanup();\n    \n    this.eventHandlers.forEach(([event, handler]) => {\n      this.map.off(event, handler);\n    });\n    this.eventHandlers = [];\n  }\n  \n  private moveLayer(layer: string, newIndex: number) {\n    const currentOrder = this.desiredLayerOrder;\n    const currentLayerIndex = currentOrder.indexOf(layer);\n    \n    // if it's not there, ignore it\n    if (currentLayerIndex === -1) {\n      console.error(`Layer ${layer} not found in current managed layers`);\n      return;\n    }\n    \n    const newLayerOrder = arrayMove(this.desiredLayerOrder, currentLayerIndex, newIndex);\n    this.desiredLayerOrder = newLayerOrder;\n    \n    this.maintainOrder();\n  }\n  \n  moveActualLayerByIndex(fromIndex: number, toIndex: number, maintainOrder = true) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    if (fromIndex < 0 || fromIndex >= currentOrder.length) {\n      throw new Error(`fromIndex out of bounds. Got ${fromIndex} for ${currentOrder.length} available layers ${currentOrder}`);\n    }\n    if (toIndex < 0 || toIndex >= currentOrder.length) {\n      throw new Error(`toIndex out of bounds. Got ${toIndex} for ${currentOrder.length} available layers ${currentOrder}`);\n    }\n    \n    const layer = currentOrder[fromIndex];\n    this.moveActualLayer(layer, toIndex, maintainOrder);\n  }\n  \n  moveActualLayer(layer: string, newIndex: number, maintainOrder = true) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    const currentLayerIndex = currentOrder.indexOf(layer);\n    \n    // if it's not there, ignore it\n    if (currentLayerIndex === -1) {\n      console.error(`Layer ${layer} not found in current managed layers`);\n      return;\n    }\n    \n    const layerAtNewIndex = currentOrder[newIndex];\n    if (!layerAtNewIndex) {\n      throw new Error(`Must provide a valid new index correpsonding to the available layers. Got ${newIndex} for ${currentOrder.length} available layers ${currentOrder}`);\n    }\n    \n    // get layerAtNewIndex's index in the full layer order\n    const oldLayerOrderIndex = this.desiredLayerOrder.indexOf(layer);\n    const newLayerOrderIndex = this.desiredLayerOrder.indexOf(layerAtNewIndex);\n    \n    const newLayerOrder = arrayMove(this.desiredLayerOrder, oldLayerOrderIndex, newLayerOrderIndex);\n    this.desiredLayerOrder = newLayerOrder;\n    \n    if (maintainOrder) {\n      this.maintainOrder();\n    }\n  }\n  \n  moveToFront(layer: string) {\n    const topIndex = this.desiredLayerOrder.length - 1;\n    this.moveLayer(layer, topIndex);\n  }\n  \n  moveToBack(layer: string) {\n    this.moveLayer(layer, 0);\n  }\n  \n  moveUp(layer: string) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    const index = currentOrder.indexOf(layer);\n    if (index === -1 || index === currentOrder.length - 1) return;\n    this.moveActualLayer(layer, index + 1);\n  }\n  \n  moveDown(layer: string) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    const index = currentOrder.indexOf(layer);\n    if (index <= 0) return;\n    this.moveActualLayer(layer, index - 1);\n  }\n  \n  \n  \n  setOrder(order: string[]) {\n    this.desiredLayerOrder = [...order];\n    if (this.initialized) this.maintainOrder();\n  }\n  \n  setKeepAtTop(keepAtTop: boolean) {\n    this.keepAtTop = keepAtTop;\n    if (this.initialized) this.maintainOrder();\n  }\n  \n  hasLayer(layer: string) {\n    return this.map.getLayer(layer) !== undefined;\n  }\n  \n  get reverseLayerOrder() {\n    // create copy to avoid mutating the original\n    return this.currentlyManagedLayerOrder.slice().reverse();\n  }\n  \n  // easy accessor for the top layer\n  startAtTop() {\n    const currentOrder = this.map.getLayersOrder();\n    for (const layer of this.reverseLayerOrder) {\n      if (currentOrder.includes(layer)) {\n        this.map.moveLayer(layer);\n        return;\n      }\n    }\n    console.error('None of layers you wanted sorted was found');\n  }\n  \n  \n  safeMoveLayerBelow(layerToMove: string, layerItShouldBeBelow: string): boolean {\n    const hasLayer = this.hasLayer(layerToMove);\n    if (!hasLayer) {\n      return false;\n    }\n    \n    if (!this.hasLayer(layerItShouldBeBelow)) {\n      // if it doesn't have this layer, try the next one above it\n      const nextIndex = this.desiredLayerOrder.indexOf(layerItShouldBeBelow) + 1;\n      if (nextIndex < this.desiredLayerOrder.length) {\n        return this.safeMoveLayerBelow(layerToMove, this.desiredLayerOrder[nextIndex]);\n      }\n      return false;\n    }\n    this.map.moveLayer(layerToMove, layerItShouldBeBelow);\n    return true;\n  }\n  \n  safeMoveLayerAbove(layerToMove: string, layerItShouldBeAbove: string): boolean {\n    const hasLayer = this.hasLayer(layerToMove);\n    if (!hasLayer) {\n      // console.warn(`Layer ${layer} not found`);\n      return false;\n    }\n\n    if (!this.hasLayer(layerItShouldBeAbove)) {\n      // if it doesn't have this layer, try the next one below it\n      const nextIndex = this.desiredLayerOrder.indexOf(layerToMove) - 1;\n      if (nextIndex >= 0) {\n        return this.safeMoveLayerAbove(layerToMove, this.desiredLayerOrder[nextIndex]);\n      }\n      return false;\n    }\n    // to move above a layer, move that layer below this one\n    this.map.moveLayer(layerItShouldBeAbove, layerToMove);\n    return true;\n  }\n\n  setManagedOrder(newManagedOrder: string[]) {\n    if (!isSubset(newManagedOrder, this.desiredLayerOrder)) {\n      throw new Error('New managed order must be a subset of the original managed layers');\n    }\n    \n    if (checkArrayEquality(newManagedOrder, this.availableDesiredOrder)) return;\n    \n    // merge the order. when a layer comes back, i don't want\n    // to be surprised that it is suddenly on the bottom of the\n    // stack\n    \n    // hashmap!!\n    const managedLayerMap = new Map<string, number>();\n    newManagedOrder.forEach((layer, index) => {\n      managedLayerMap.set(layer, index);\n    });\n    \n    const newDesiredOrder: string[] = [];\n    let managedIndex = 0;\n    \n    for (const layer of this.desiredLayerOrder) {\n      if (managedLayerMap.has(layer)) {\n        newDesiredOrder.push(newManagedOrder[managedIndex]);\n        managedIndex++;\n      } else {\n        newDesiredOrder.push(layer);\n      }\n    }\n    \n    this.desiredLayerOrder = newDesiredOrder;\n    this.maintainOrder();\n    \n  }\n    \n  \n}\n  \ninterface UseMaplibreLayerOrderControlReturn {\n  desiredOrder: Ref<string[]>;\n  currentOrder: Ref<string[]>;\n  controller: MaplibreLayerOrderControl | null;\n}\n\nexport function useMaplibreLayerOrderControl(\n  map: Ref<M.Map | null>,\n  initialOrder: string[] = [],\n  moveToTop: boolean = true,\n): UseMaplibreLayerOrderControlReturn {\n  \n\n  const desiredOrder = ref<string[]>(initialOrder);\n  const currentOrder = ref<string[]>([]);\n  let controller: MaplibreLayerOrderControl | null = null;\n  let initialized = false;\n  \n  // Initialize the controller when the map is ready\n  function init(mapValue: M.Map | null) {\n    console.log(\"running init\", mapValue, controller);\n    if (mapValue && !controller && !initialized) {\n      console.log(\"Creating controller with desired order\", desiredOrder.value);\n      controller = new MaplibreLayerOrderControl(mapValue, desiredOrder.value, {keepAtTop: moveToTop});\n      controller.on('layer-order-changed', () => {\n        console.log('Layer order changed event received',currentOrder.value, controller?.currentlyManagedLayerOrder);\n        if (controller && !checkArrayEquality(currentOrder.value, controller.currentlyManagedLayerOrder ?? [])) {\n          console.log('Updating current order to', controller.currentlyManagedLayerOrder);\n          currentOrder.value = controller?.currentlyManagedLayerOrder ?? [];\n        }\n      });\n      currentOrder.value = controller.currentlyManagedLayerOrder;\n      initialized = true;\n    }\n  }\n  init(map.value);\n  watch(map, (newValue) => {\n    if (newValue && !controller && !initialized) {\n      console.log('Map changed, re-initializing controller', newValue);\n      init(newValue);\n    } else if (!newValue && controller) {\n      console.log('Map is now null, destroying controller');\n      controller.destroy();\n      controller = null;\n      initialized = false;\n      currentOrder.value = [];\n    }\n  });\n  \n  watch(desiredOrder, (newOrder) => {\n    console.log('Desired order changed to', newOrder);\n  }, {deep: true});\n  \n  watch(currentOrder, (newOrder) => {\n    console.log('Current order changed to', newOrder);\n  }, {deep: true});\n  \n  \n  onBeforeUnmount(() => {\n    controller?.destroy();\n  });\n  \n  \n  return {\n    desiredOrder,\n    currentOrder,\n    controller,\n  };\n  \n  \n  \n  \n}\n","export function capitalizeWords(text: string): string {\n  return text.replace(/\\b(\\w)/g, function(match) {\n    return match.toUpperCase();\n  });\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withCtx as _withCtx } from \"vue\"\n\nconst _hoisted_1 = { class: \"layer-order-row\" }\nconst _hoisted_2 = { key: 0 }\n\nimport { computed, type MaybeRef, toValue, toRef } from 'vue';\nimport draggable from 'vuedraggable';\nimport M from 'maplibre-gl';\n\nimport { useMaplibreLayerOrderControl } from \"@/composables/useMaplibreLayerOrderControl\";\nimport { capitalizeWords } from \"@/utils/names\";\n\ninterface Props {\n  mapRef: M.Map | null;\n  order: MaybeRef<string[]>;\n}\n\ninterface Emits {\n  (e: 'change', newOrder: string[]): void;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'LayerOrderControl',\n  props: {\n    mapRef: {},\n    order: {}\n  },\n  emits: [\"change\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst props = __props;\nconst mapRef = toRef(() => props.mapRef);\n\n// https://vuejs.org/guide/typescript/composition-api.html#typing-component-emits\n\nconst _emit = __emit;\nconsole.log('LayerOrderControl props:', props);\nconst { \n  currentOrder, \n  controller \n} = useMaplibreLayerOrderControl(mapRef, toValue(props.order), true);\n\nconst displayOrder = computed({\n  get(): string[] {\n    return currentOrder.value.slice().reverse();\n  },\n  set(value: string[]) {\n    controller?.setManagedOrder(value.slice().reverse());\n  }\n});\n\nconst layerNames: Record<string, string | undefined> = {\n  \"esri-source\": \"TEMPO Data\",\n  \"aqi-layer-aqi\": \"Air Quality Index\",\n  \"power-plants-heatmap\": \"Power Plants\",\n};\n\nconst layerInfo: Record<string, string | undefined> = {\n  \"aqi-layer-aqi\": 'From <a href=\"https://www.airnow.gov/aqi/aqi-basics/\">EPA</a>; taken once per day',\n};\n\nfunction displayNameTransform(layerId: string): string {\n  return layerNames[layerId] ?? capitalizeWords(layerId.replace(/-/g, \" \"));\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_layer_control_item = _resolveComponent(\"layer-control-item\")!\n\n  return (_openBlock(), _createElementBlock(\"ul\", null, [\n    _createVNode(_unref(draggable), {\n      modelValue: displayOrder.value,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((displayOrder).value = $event)),\n      handle: \".drag-handle\"\n    }, {\n      item: _withCtx(({ element, index }) => [\n        _createElementVNode(\"div\", null, [\n          _createElementVNode(\"div\", _hoisted_1, [\n            _cache[1] || (_cache[1] = _createElementVNode(\"span\", { class: \"drag-handle\" }, \"\", -1)),\n            _createVNode(_component_layer_control_item, {\n              map: mapRef.value,\n              \"layer-id\": element,\n              info: layerInfo[element],\n              \"display-name\": displayNameTransform(element)\n            }, null, 8, [\"map\", \"layer-id\", \"info\", \"display-name\"])\n          ]),\n          (index != _unref(currentOrder).length - 1)\n            ? (_openBlock(), _createElementBlock(\"hr\", _hoisted_2))\n            : _createCommentVNode(\"\", true)\n        ])\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"])\n  ]))\n}\n}\n\n})","<template>\n  <ul>\n    <draggable \n      v-model=\"displayOrder\" \n      handle=\".drag-handle\"\n    >\n      <template #item=\"{ element, index }\">\n        <div>\n          <div class=\"layer-order-row\">\n            <span class=\"drag-handle\"></span>\n            <layer-control-item\n              :map=\"mapRef\"\n              :layer-id=\"element\"\n              :info=\"layerInfo[element]\"\n              :display-name=\"displayNameTransform(element)\"\n            >\n            </layer-control-item>\n          </div>\n          <hr v-if=\"index != currentOrder.length - 1\" />\n        </div>\n      </template>\n    </draggable>\n  </ul>\n</template>\n\n\n<script setup lang=\"ts\">\nimport { computed, type MaybeRef, toValue, toRef } from 'vue';\nimport draggable from 'vuedraggable';\nimport M from 'maplibre-gl';\n\nimport { useMaplibreLayerOrderControl } from \"@/composables/useMaplibreLayerOrderControl\";\nimport { capitalizeWords } from \"@/utils/names\";\n\ninterface Props {\n  mapRef: M.Map | null;\n  order: MaybeRef<string[]>;\n}\n\nconst props = defineProps<Props>();\nconst mapRef = toRef(() => props.mapRef);\n\n// https://vuejs.org/guide/typescript/composition-api.html#typing-component-emits\n\ninterface Emits {\n  (e: 'change', newOrder: string[]): void;\n}\nconst _emit = defineEmits<Emits>();\nconsole.log('LayerOrderControl props:', props);\nconst { \n  currentOrder, \n  controller \n} = useMaplibreLayerOrderControl(mapRef, toValue(props.order), true);\n\nconst displayOrder = computed({\n  get(): string[] {\n    return currentOrder.value.slice().reverse();\n  },\n  set(value: string[]) {\n    controller?.setManagedOrder(value.slice().reverse());\n  }\n});\n\nconst layerNames: Record<string, string | undefined> = {\n  \"esri-source\": \"TEMPO Data\",\n  \"aqi-layer-aqi\": \"Air Quality Index\",\n  \"power-plants-heatmap\": \"Power Plants\",\n};\n\nconst layerInfo: Record<string, string | undefined> = {\n  \"aqi-layer-aqi\": 'From <a href=\"https://www.airnow.gov/aqi/aqi-basics/\">EPA</a>; taken once per day',\n};\n\nfunction displayNameTransform(layerId: string): string {\n  return layerNames[layerId] ?? capitalizeWords(layerId.replace(/-/g, \" \"));\n}\n</script>\n\n\n<style scoped>\nul {\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n  margin-left: 1rem;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  height: fit-content;\n}\nli {\n  padding: 8px 12px;\n  border-bottom: 1px solid #eee;\n  cursor: move;\n  margin: 10px 0;\n}\n\n.drag-handle {\n  font-size: 20pt;\n\n  &:hover {\n    cursor: grab;\n  }\n}\n\n.layer-order-row {\n  display: flex;\n  flex-direction: row;\n  gap: 5px;\n}\n</style>\n","import script from \"./LayerOrderControl.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LayerOrderControl.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LayerOrderControl.vue?vue&type=style&index=0&id=6bca68ab&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6bca68ab\"]])\n\nexport default __exports__","import { Map } from \"maplibre-gl\";\nimport { ref, watch } from \"vue\";\n\nimport { getLayerOpacity, setLayerOpacity } from \"@/maplibre_controls\";\n\nexport function useMaplibreLayerOpacity(\n  map: Map,\n  layerId: string,\n  initialOpacity?: number,\n) {\n  const opacity = ref(initialOpacity ?? getLayerOpacity(map, layerId));\n  watch(opacity, (value: number) => setLayerOpacity(map, layerId, value), { immediate: true });\n  map.on(\"styledata\", () => {\n    opacity.value = getLayerOpacity(map, layerId);\n  });\n\n  return {\n    opacity,\n  };\n}\n","import { Map } from \"maplibre-gl\";\nimport { ref, watch } from \"vue\";\n\nimport { getLayerVisibility, setLayerVisibility } from \"@/maplibre_controls\";\n\nexport function useMaplibreLayerVisibility(\n  map: Map,\n  layerId: string,\n  initialVisibility?: boolean,\n) {\n  const visible = ref(initialVisibility ?? getLayerVisibility(map, layerId));\n  watch(visible, (value: boolean) => setLayerVisibility(map, layerId, value), { immediate: true });\n  map.on(\"styledata\", () => {\n    visible.value = getLayerVisibility(map, layerId);\n  });\n\n  return {\n    visible,\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, resolveComponent as _resolveComponent, isRef as _isRef, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderSlot as _renderSlot, normalizeClass as _normalizeClass, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\nconst _hoisted_2 = { class: \"mlc-layer-item-checkbox-label-container\" }\nconst _hoisted_3 = [\"for\"]\nconst _hoisted_4 = [\"innerHTML\"]\nconst _hoisted_5 = { class: \"mlc-layer-item-opacity-label-container\" }\nconst _hoisted_6 = [\"for\"]\n\nimport { watch } from \"vue\";\nimport type { Map } from \"maplibre-gl\";\nimport { useMaplibreLayerOpacity } from \"@/composables/useMaplibreLayerOpacity\";\nimport { useMaplibreLayerVisibility } from \"@/composables/useMaplibreLayerVisibility\";\n\ninterface Props {\n  layerId: string;\n  map: Map;\n  displayName?: string;\n  info?: string;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MaplibreLayerControlItem',\n  props: {\n    layerId: {},\n    map: {},\n    displayName: {},\n    info: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\nlet { opacity } = useMaplibreLayerOpacity(props.map, props.layerId);\nlet { visible } = useMaplibreLayerVisibility(props.map, props.layerId);\n\n// NB: If the props update, we need to make sure that the refs that we're using are still tracking the same layer\n// In particular, if the layer ID changes, without this the component can end up manipulating the wrong layer!\nwatch(() => [props.map, props.layerId],\n  ([map, layerId]: [Map, string]) => {\n    opacity = useMaplibreLayerOpacity(map, layerId).opacity;\n    visible = useMaplibreLayerVisibility(map, layerId).visible;\n  });\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_popup_info_button = _resolveComponent(\"popup-info-button\")!\n  const _component_v_slider = _resolveComponent(\"v-slider\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: `mlc-layer-item-${__props.layerId}`,\n    class: _normalizeClass(['mlc-layer-item', `mlc-layer-item-${_unref(visible) ? 'visible' : 'none'}`])\n  }, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(_component_v_checkbox, {\n        modelValue: _unref(visible),\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => (_isRef(visible) ? (visible).value = $event : visible = $event)),\n        id: `mlc-${__props.layerId}-visibility-checkbox`,\n        class: \"mlc-layer-item-checkbox\",\n        density: \"compact\",\n        \"hide-details\": \"\",\n        color: \"primary\"\n      }, null, 8, [\"modelValue\", \"id\"]),\n      _createElementVNode(\"label\", {\n        class: \"mlc-layer-item-label\",\n        for: `mlc-${__props.layerId}-visibility-checkbox`\n      }, _toDisplayString(__props.displayName ?? __props.layerId), 9, _hoisted_3),\n      (__props.info)\n        ? (_openBlock(), _createBlock(_component_popup_info_button, {\n            key: 0,\n            \"info-text\": __props.info\n          }, {\n            info: _withCtx(() => [\n              _createElementVNode(\"div\", { innerHTML: __props.info }, null, 8, _hoisted_4)\n            ]),\n            _: 1\n          }, 8, [\"info-text\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _renderSlot(_ctx.$slots, \"actions\"),\n    _createElementVNode(\"div\", _hoisted_5, [\n      _createElementVNode(\"label\", {\n        for: `mlc-${__props.layerId}-opacity-slider`\n      }, \" Transparency: \", 8, _hoisted_6),\n      _createVNode(_component_v_slider, {\n        modelValue: _unref(opacity),\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => (_isRef(opacity) ? (opacity).value = $event : opacity = $event)),\n        modelModifiers: { number: true },\n        id: `mlc-${__props.layerId}-opacity-slider`,\n        class: \"mlc-layer-opacity-slider\",\n        min: 0,\n        max: 1,\n        step: 0.01,\n        title: \"Adjust layer opacity\",\n        color: \"primary\"\n      }, null, 8, [\"modelValue\", \"id\"])\n    ])\n  ], 10, _hoisted_1))\n}\n}\n\n})","<template>\n  <div\n    :id=\"`mlc-layer-item-${layerId}`\"\n    :class=\"['mlc-layer-item', `mlc-layer-item-${visible ? 'visible' : 'none'}`]\"\n  >\n    <div\n      class=\"mlc-layer-item-checkbox-label-container\"\n    >\n      <v-checkbox\n        v-model=\"visible\"\n        :id=\"`mlc-${layerId}-visibility-checkbox`\"\n        class=\"mlc-layer-item-checkbox\"\n        density=\"compact\"\n        hide-details\n        color=\"primary\"\n      ></v-checkbox>\n      <label\n        class=\"mlc-layer-item-label\"\n        :for=\"`mlc-${layerId}-visibility-checkbox`\"\n      >\n        {{ displayName ?? layerId }}\n      </label>\n      <popup-info-button\n        v-if=\"info\"\n        :info-text=\"info\"\n      >\n        <template #info>\n          <div v-html=\"info\"></div>\n        </template>\n      </popup-info-button>\n    </div>\n    <slot name=\"actions\"></slot>\n    <div\n      class=\"mlc-layer-item-opacity-label-container\"\n    >\n      <label\n        :for=\"`mlc-${layerId}-opacity-slider`\"\n      >\n        Transparency: \n      </label>\n      <v-slider\n        v-model.number=\"opacity\"\n        :id=\"`mlc-${layerId}-opacity-slider`\"\n        class=\"mlc-layer-opacity-slider\"\n        :min=\"0\"\n        :max=\"1\"\n        :step=\"0.01\"\n        title=\"Adjust layer opacity\"\n        color=\"primary\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { watch } from \"vue\";\nimport type { Map } from \"maplibre-gl\";\nimport { useMaplibreLayerOpacity } from \"@/composables/useMaplibreLayerOpacity\";\nimport { useMaplibreLayerVisibility } from \"@/composables/useMaplibreLayerVisibility\";\n\ninterface Props {\n  layerId: string;\n  map: Map;\n  displayName?: string;\n  info?: string;\n}\n\nconst props = defineProps<Props>();\nlet { opacity } = useMaplibreLayerOpacity(props.map, props.layerId);\nlet { visible } = useMaplibreLayerVisibility(props.map, props.layerId);\n\n// NB: If the props update, we need to make sure that the refs that we're using are still tracking the same layer\n// In particular, if the layer ID changes, without this the component can end up manipulating the wrong layer!\nwatch(() => [props.map, props.layerId],\n  ([map, layerId]: [Map, string]) => {\n    opacity = useMaplibreLayerOpacity(map, layerId).opacity;\n    visible = useMaplibreLayerVisibility(map, layerId).visible;\n  });\n</script>\n\n<style scoped>\n.mlc-layer-item-checkbox-label-container {\n  padding: 5px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n</style>\n","import script from \"./MaplibreLayerControlItem.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MaplibreLayerControlItem.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MaplibreLayerControlItem.vue?vue&type=style&index=0&id=621d770b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-621d770b\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"global-filters\" }\n\nimport { ref, watch, onMounted } from \"vue\";\nimport type { LayerSpecification, Map } from \"maplibre-gl\";\n\nimport { \n  PrimSource,\n  RenewableSources,\n  TraditionalSources,\n} from \"@/assets/power_plants\";\n\ninterface Props {\n  map: Map;\n  layerId: string;\n}\n\ntype PlantCategory = typeof PLANT_CATEGORIES[number];\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'PowerPlantsFilterControl',\n  props: {\n    map: {},\n    layerId: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\n\nconst PLANT_CATEGORIES = [\"Renewables\", \"Fossil Fuels\", \"Other\"] as const;\nconst selectedSources = ref<PrimSource[]>(Object.values(PrimSource));\n\nconst SOURCES_BY_CATEGORY: Record<PlantCategory, readonly PrimSource[]> = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Renewables: RenewableSources,\n  \"Fossil Fuels\": TraditionalSources,\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Other: Object.values(PrimSource).filter(source => \n    !((RenewableSources as unknown as PrimSource[]).includes(source) || \n      (TraditionalSources as unknown as PrimSource[]).includes(source))\n  ),\n};\n\nfunction handleGlobalSelect(value: boolean) {\n  selectedSources.value = value ? [...Object.values(PrimSource)] : [];\n}\n\nfunction handleCategoryGlobalSelect(category: PlantCategory, value: boolean) {\n  if (value) {\n    // We could update the ref directly and use a deep watcher, but we don't need\n    // to trigger UI updates on each push here - better to do it all at the end\n    const sources = [...selectedSources.value];\n    SOURCES_BY_CATEGORY[category].forEach(source => {\n      if (!sources.includes(source)) {\n        sources.push(source);\n      }\n    });\n    selectedSources.value = sources;\n  } else {\n    selectedSources.value = selectedSources.value.filter(item => !SOURCES_BY_CATEGORY[category].includes(item));\n  }\n}\n\nlet layers: LayerSpecification[] = [];\n\nfunction onLayersChanged(newLayers: LayerSpecification[]) {\n  layers = newLayers;\n  applyPrimSourceFilter(selectedSources.value);\n}\n\n\nonMounted(() => {\n  props.map.on(\"styledata\", () => {\n    // check if layers changed\n    // console.log('Style data event received');\n    const newLayerIds = new Set((props.map.getStyle().layers || []).map(l => l.id));\n    const oldLayerIds = new Set(layers.map(l => l.id));\n    const hasNewLayers = newLayerIds.size !== oldLayerIds.size || [...newLayerIds].some(id => !oldLayerIds.has(id));\n    if (hasNewLayers) {\n      // console.log('Style data changed, updating layer list');\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n    // check layer visibility changes\n    const visibilityChanged = layers.some(oldLayer => {\n      const newLayer = props.map.getStyle().layers?.find(l => l.id === oldLayer.id);\n      return newLayer && oldLayer.layout?.visibility !== newLayer.layout?.visibility;\n    });\n    if (visibilityChanged) {\n      console.log('Layer visibility changed, updating layer list');\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n  });\n\n  applyPrimSourceFilter(selectedSources.value);\n});\n\nwatch(selectedSources, applyPrimSourceFilter);\n\nfunction applyPrimSourceFilter(sources: PrimSource[]) {\n  const layerIds = [\"power-plants-layer\", \"power-plants-heatmap\"];\n  layerIds.forEach(id => {\n    if (!props.map.getLayer(id)) { return; }\n  \n    if (sources.length === 0) {\n      props.map.setFilter(id, false);\n    } else if (sources.length === Object.values(PrimSource).length) {\n      props.map.setFilter(id, null);\n    } else {\n      props.map.setFilter(id, [\"in\", [\"get\", \"PrimSource\"], [\"literal\", sources]]);\n    }\n  });\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\")!\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\")!\n\n  return (_openBlock(), _createBlock(_component_v_expansion_panels, {\n    class: \"power-plant-filter-controls\",\n    multiple: \"\"\n  }, {\n    default: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_1, [\n        _cache[5] || (_cache[5] = _createElementVNode(\"div\", null, \"Global Filters\", -1)),\n        _createVNode(_component_v_btn, {\n          onClick: _cache[0] || (_cache[0] = ($event: any) => (handleGlobalSelect(true)))\n        }, {\n          default: _withCtx(() => [...(_cache[3] || (_cache[3] = [\n            _createTextVNode(\"All\", -1)\n          ]))]),\n          _: 1\n        }),\n        _createVNode(_component_v_btn, {\n          onClick: _cache[1] || (_cache[1] = ($event: any) => (handleGlobalSelect(false)))\n        }, {\n          default: _withCtx(() => [...(_cache[4] || (_cache[4] = [\n            _createTextVNode(\"None\", -1)\n          ]))]),\n          _: 1\n        })\n      ]),\n      (_openBlock(), _createElementBlock(_Fragment, null, _renderList(PLANT_CATEGORIES, (category, index) => {\n        return _createVNode(_component_v_expansion_panel, {\n          key: index,\n          title: category\n        }, {\n          text: _withCtx(() => [\n            _createVNode(_component_v_btn, {\n              onClick: ($event: any) => (handleCategoryGlobalSelect(category, true))\n            }, {\n              default: _withCtx(() => [...(_cache[6] || (_cache[6] = [\n                _createTextVNode(\"All\", -1)\n              ]))]),\n              _: 1\n            }, 8, [\"onClick\"]),\n            _createVNode(_component_v_btn, {\n              onClick: ($event: any) => (handleCategoryGlobalSelect(category, false))\n            }, {\n              default: _withCtx(() => [...(_cache[7] || (_cache[7] = [\n                _createTextVNode(\"None\", -1)\n              ]))]),\n              _: 1\n            }, 8, [\"onClick\"]),\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(SOURCES_BY_CATEGORY[category], (source) => {\n              return (_openBlock(), _createBlock(_component_v_checkbox, {\n                label: source,\n                key: source,\n                value: source,\n                modelValue: selectedSources.value,\n                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((selectedSources).value = $event)),\n                density: \"compact\",\n                \"hide-details\": \"\"\n              }, null, 8, [\"label\", \"value\", \"modelValue\"]))\n            }), 128))\n          ]),\n          _: 2\n        }, 1032, [\"title\"])\n      }), 64))\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n  <v-expansion-panels\n    class=\"power-plant-filter-controls\"\n    multiple\n  >\n    <div class=\"global-filters\">\n      <div>Global Filters</div>\n      <v-btn\n       @click=\"handleGlobalSelect(true)\"\n      >All</v-btn>\n      <v-btn\n        @click=\"handleGlobalSelect(false)\"\n      >None</v-btn>\n    </div>\n    <v-expansion-panel\n      v-for=\"(category, index) in PLANT_CATEGORIES\"\n      :key=\"index\"\n      :title=\"category\"\n    >\n      <template #text>\n        <v-btn\n          @click=\"handleCategoryGlobalSelect(category, true)\"\n        >All</v-btn>\n        <v-btn\n          @click=\"handleCategoryGlobalSelect(category, false)\"\n        >None</v-btn>\n        <v-checkbox\n          v-for=\"source in SOURCES_BY_CATEGORY[category]\"\n          :label=\"source\"\n          :key=\"source\"\n          :value=\"source\"\n          v-model=\"selectedSources\"\n          density=\"compact\"\n          hide-details\n        ></v-checkbox>\n      </template>\n    </v-expansion-panel>\n  </v-expansion-panels>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onMounted } from \"vue\";\nimport type { LayerSpecification, Map } from \"maplibre-gl\";\n\nimport { \n  PrimSource,\n  RenewableSources,\n  TraditionalSources,\n} from \"@/assets/power_plants\";\n\ninterface Props {\n  map: Map;\n  layerId: string;\n}\n\nconst props = defineProps<Props>();\n\nconst PLANT_CATEGORIES = [\"Renewables\", \"Fossil Fuels\", \"Other\"] as const;\ntype PlantCategory = typeof PLANT_CATEGORIES[number];\n\nconst selectedSources = ref<PrimSource[]>(Object.values(PrimSource));\n\nconst SOURCES_BY_CATEGORY: Record<PlantCategory, readonly PrimSource[]> = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Renewables: RenewableSources,\n  \"Fossil Fuels\": TraditionalSources,\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Other: Object.values(PrimSource).filter(source => \n    !((RenewableSources as unknown as PrimSource[]).includes(source) || \n      (TraditionalSources as unknown as PrimSource[]).includes(source))\n  ),\n};\n\nfunction handleGlobalSelect(value: boolean) {\n  selectedSources.value = value ? [...Object.values(PrimSource)] : [];\n}\n\nfunction handleCategoryGlobalSelect(category: PlantCategory, value: boolean) {\n  if (value) {\n    // We could update the ref directly and use a deep watcher, but we don't need\n    // to trigger UI updates on each push here - better to do it all at the end\n    const sources = [...selectedSources.value];\n    SOURCES_BY_CATEGORY[category].forEach(source => {\n      if (!sources.includes(source)) {\n        sources.push(source);\n      }\n    });\n    selectedSources.value = sources;\n  } else {\n    selectedSources.value = selectedSources.value.filter(item => !SOURCES_BY_CATEGORY[category].includes(item));\n  }\n}\n\nlet layers: LayerSpecification[] = [];\n\nfunction onLayersChanged(newLayers: LayerSpecification[]) {\n  layers = newLayers;\n  applyPrimSourceFilter(selectedSources.value);\n}\n\n\nonMounted(() => {\n  props.map.on(\"styledata\", () => {\n    // check if layers changed\n    // console.log('Style data event received');\n    const newLayerIds = new Set((props.map.getStyle().layers || []).map(l => l.id));\n    const oldLayerIds = new Set(layers.map(l => l.id));\n    const hasNewLayers = newLayerIds.size !== oldLayerIds.size || [...newLayerIds].some(id => !oldLayerIds.has(id));\n    if (hasNewLayers) {\n      // console.log('Style data changed, updating layer list');\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n    // check layer visibility changes\n    const visibilityChanged = layers.some(oldLayer => {\n      const newLayer = props.map.getStyle().layers?.find(l => l.id === oldLayer.id);\n      return newLayer && oldLayer.layout?.visibility !== newLayer.layout?.visibility;\n    });\n    if (visibilityChanged) {\n      console.log('Layer visibility changed, updating layer list');\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n  });\n\n  applyPrimSourceFilter(selectedSources.value);\n});\n\nwatch(selectedSources, applyPrimSourceFilter);\n\nfunction applyPrimSourceFilter(sources: PrimSource[]) {\n  const layerIds = [\"power-plants-layer\", \"power-plants-heatmap\"];\n  layerIds.forEach(id => {\n    if (!props.map.getLayer(id)) { return; }\n  \n    if (sources.length === 0) {\n      props.map.setFilter(id, false);\n    } else if (sources.length === Object.values(PrimSource).length) {\n      props.map.setFilter(id, null);\n    } else {\n      props.map.setFilter(id, [\"in\", [\"get\", \"PrimSource\"], [\"literal\", sources]]);\n    }\n  });\n}\n</script>\n\n<style scoped lang=\"less\">\n.power-plant-filter-controls {\n  border: 1px solid white;\n  border-radius: 5px;\n  margin: 5px;\n  width: unset;\n}\n\n.global-filters {\n  padding: 5px 0;\n}\n</style>\n","import script from \"./PowerPlantsFilterControl.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PowerPlantsFilterControl.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PowerPlantsFilterControl.vue?vue&type=style&index=0&id=076bfe59&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-076bfe59\"]])\n\nexport default __exports__","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport Vue, { createApp } from \"vue\";\n\nimport { FundingAcknowledgement, IconButton, CreditLogos } from \"@cosmicds/vue-toolkit\";\nimport LocationSearch from \"./components/LocationSearch.vue\";\nimport TempoLab from \"./TempoLab.vue\";\nimport Colorbar from './components/ColorBar.vue';\nimport ColorBarHorizontal from \"./components/ColorBarHorizontal.vue\";\nimport InfoButton from \"./components/InfoButton.vue\";\nimport vuetify from \"../plugins/vuetify\";\nimport SnackbarAlert from \"./components/SnackbarAlert.vue\";\nimport ShareButton from \"./components/ShareButton.vue\";\nimport CDSDialog from \"./components/CDSDialog.vue\";\nimport MarqeeAlert from \"./components/MarqeeAlert.vue\";\nimport TimeseriesGraph from \"./components/TimeseriesGraph.vue\";\nimport SelectionComposer from \"./components/SelectionComposer.vue\";\nimport HeaderBar from \"./components/HeaderBar.vue\";\nimport DatasetControls from \"./components/DatasetControls.vue\";\nimport ComparisonDataControls from \"./components/ComparisonDataControls.vue\";\nimport MapControls from \"./components/MapControls.vue\";\nimport MapWithControls from \"./components/MapWithControls.vue\";\nimport PopupInfoButton from \"./components/PopupInfoButton.vue\";\nimport LayerOrderControl from \"./components/LayerOrderControl.vue\";\nimport MaplibreLayerControlItem from \"./components/MaplibreLayerControlItem.vue\";\nimport PowerPlantsFilterControl from \"./components/PowerPlantsFilterControl.vue\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport {\n  faBookOpen,\n  faPlay,\n  faPause,\n  faTimes,\n  faVideo,\n  faMagnifyingGlass,\n  faCircleXmark,\n  faSquareXmark,\n  faHome,\n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport VueDatePicker from \"@vuepic/vue-datepicker\";\nimport '@vuepic/vue-datepicker/dist/main.css';\nimport { UseClipboard } from \"@vueuse/components\";\n\nimport { createPinia } from \"pinia\";\n\nlibrary.add(faBookOpen);\nlibrary.add(faPlay);\nlibrary.add(faPause);\nlibrary.add(faTimes);\nlibrary.add(faVideo);\nlibrary.add(faMagnifyingGlass);\nlibrary.add(faCircleXmark);\nlibrary.add(faSquareXmark);\nlibrary.add(faHome);\n\n// TODO: This doesn't work. Why??\n// import \"golden-layout/dist/css/goldenlayout-base.css\";\n// import \"golden-layout/dist/css/themes/goldenlayout-dark-theme.css\";\n\n/** v-hide directive taken from https://www.ryansouthgate.com/2020/01/30/vue-js-v-hide-element-whilst-keeping-occupied-space/ */\n// Extract the function out, up here, so I'm not writing it twice\nconst update = (el: HTMLElement, binding: Vue.DirectiveBinding) => el.style.visibility = (binding.value) ? \"hidden\" : \"\";\n\nconst pinia = createPinia();\n\ncreateApp(TempoLab, {})\n\n  // Plugins\n  .use(vuetify)\n  .use(pinia)\n\n  // Directives\n  .directive(\n    /**\n    * Hides an HTML element, keeping the space it would have used if it were visible (css: Visibility)\n    */\n    \"hide\", {\n      // Run on initialisation (first render) of the directive on the element\n      beforeMount(el, binding, _vnode, _prevVnode) {\n        update(el, binding);\n      },\n      // Run on subsequent updates to the value supplied to the directive\n      updated(el, binding, _vnode, _prevVnode) {\n        update(el, binding);\n      }\n    })\n\n  // Components\n  .component('font-awesome-icon', FontAwesomeIcon)\n  .component('icon-button', IconButton)\n  .component('funding-acknowledgement', FundingAcknowledgement)\n  .component('credit-logos', CreditLogos)\n  .component('colorbar', Colorbar)\n  .component('location-search', LocationSearch)\n  .component('info-button', InfoButton)\n  .component('colorbar-horizontal', ColorBarHorizontal)\n  .component('date-picker', VueDatePicker)\n  .component('use-clipboard', UseClipboard as Vue.Component)\n  .component('snackbar-alert', SnackbarAlert)\n  .component('share-button', ShareButton)\n  .component('cds-dialog', CDSDialog)\n  .component('marquee-alert', MarqeeAlert)\n  .component('timeseries-graph', TimeseriesGraph)\n  .component('selection-composer', SelectionComposer)\n  .component('dataset-controls', DatasetControls)\n  .component('comparison-data-controls', ComparisonDataControls)\n  .component('map-controls', MapControls)\n  .component('map-with-controls', MapWithControls)\n  .component('header-bar', HeaderBar)\n  .component('popup-info-button', PopupInfoButton)\n  .component('layer-control-item', MaplibreLayerControlItem)\n  .component('layer-order-control', LayerOrderControl)\n  .component('power-plants-filter-control', PowerPlantsFilterControl)\n\n  // Mount\n  .mount(\"#app\");\n","/* eslint-disable @typescript-eslint/naming-convention */\n// Type Generated with \"Paste JSON as Code\" extension for VSCode\nexport interface PowerPlants {\n  X:               number;\n  Y:               number;\n  OBJECTID:        number;\n  Plant_Code:      number;\n  Plant_Name:      string;\n  Utility_ID:      number;\n  Utility_Name?:   string;\n  sector_name:     SectorName;\n  Street_Address?: string;\n  City?:           string;\n  County?:         string;\n  State:           State;\n  Zip?:            number;\n  PrimSource:      PrimSource;\n  source_desc:     string;\n  tech_desc:       string;\n  Install_MW:      number;\n  Total_MW?:       number;\n  Hydro_MW?:       number;\n  Source:          Source;\n  Period:          number;\n  Longitude:       number;\n  Latitude:        number;\n  Coal_MW?:        number;\n  NG_MW?:          number;\n  Crude_MW?:       number;\n  Nuclear_MW?:     number;\n  HydroPS_MW?:     number;\n  Bat_MW?:         number;\n  Solar_MW?:       number;\n  Geo_MW?:         number;\n  Bio_MW?:         number;\n  Wind_MW?:        number;\n  Other_MW?:       number;\n}\n\n\n// custom groups for green and traditional sources\nexport enum RenewableSource {\n  Biomass = \"biomass\",\n  Geothermal = \"geothermal\",\n  Hydroelectric = \"hydroelectric\",\n  Solar = \"solar\",\n  Wind = \"wind\",\n}\n\nexport enum TraditionalSource {\n  Coal = \"coal\",\n  NaturalGas = \"natural gas\",\n  Petroleum = \"petroleum\",\n}\n\nexport enum PrimSource {\n  Batteries = \"batteries\",\n  Biomass = \"biomass\",\n  Coal = \"coal\",\n  Geothermal = \"geothermal\",\n  Hydroelectric = \"hydroelectric\",\n  NaturalGas = \"natural gas\",\n  Nuclear = \"nuclear\",\n  Other = \"other\",\n  Petroleum = \"petroleum\",\n  PumpedStorage = \"pumped storage\",\n  Solar = \"solar\",\n  Wind = \"wind\",\n}\n\nexport const TraditionalSources = [PrimSource.Coal, PrimSource.NaturalGas, PrimSource.Petroleum] as const;\nexport const RenewableSources = [PrimSource.Biomass, PrimSource.Geothermal, PrimSource.Hydroelectric, PrimSource.Solar, PrimSource.Wind] as const;\n\nexport enum Source {\n  EIA860EIA860MAndEIA923 = \"EIA-860, EIA-860M and EIA-923\",\n}\n\nexport enum State {\n  Alabama = \"Alabama\",\n  Alaska = \"Alaska\",\n  Arizona = \"Arizona\",\n  Arkansas = \"Arkansas\",\n  California = \"California\",\n  Colorado = \"Colorado\",\n  Connecticut = \"Connecticut\",\n  Delaware = \"Delaware\",\n  Florida = \"Florida\",\n  Georgia = \"Georgia\",\n  Hawaii = \"Hawaii\",\n  Idaho = \"Idaho\",\n  Illinois = \"Illinois\",\n  Indiana = \"Indiana\",\n  Iowa = \"Iowa\",\n  Kansas = \"Kansas\",\n  Kentucky = \"Kentucky\",\n  Louisiana = \"Louisiana\",\n  Maine = \"Maine\",\n  Maryland = \"Maryland\",\n  Massachusetts = \"Massachusetts\",\n  Michigan = \"Michigan\",\n  Minnesota = \"Minnesota\",\n  Mississippi = \"Mississippi\",\n  Missouri = \"Missouri\",\n  Montana = \"Montana\",\n  Nebraska = \"Nebraska\",\n  Nevada = \"Nevada\",\n  NewHampshire = \"New Hampshire\",\n  NewJersey = \"New Jersey\",\n  NewMexico = \"New Mexico\",\n  NewYork = \"New York\",\n  NorthCarolina = \"North Carolina\",\n  NorthDakota = \"North Dakota\",\n  Ohio = \"Ohio\",\n  Oklahoma = \"Oklahoma\",\n  Oregon = \"Oregon\",\n  Pennsylvania = \"Pennsylvania\",\n  PuertoRico = \"Puerto Rico\",\n  RhodeIsland = \"Rhode Island\",\n  SouthCarolina = \"South Carolina\",\n  SouthDakota = \"South Dakota\",\n  Tennessee = \"Tennessee\",\n  Texas = \"Texas\",\n  Utah = \"Utah\",\n  Vermont = \"Vermont\",\n  Virginia = \"Virginia\",\n  Washington = \"Washington\",\n  WestVirginia = \"West Virginia\",\n  Wisconsin = \"Wisconsin\",\n  Wyoming = \"Wyoming\",\n}\n\nexport enum SectorName {\n  CommercialCHP = \"Commercial CHP\",\n  CommercialNonCHP = \"Commercial Non-CHP\",\n  ElectricUtility = \"Electric Utility\",\n  IPPChp = \"IPP CHP\",\n  IPPNonCHP = \"IPP Non-CHP\",\n  IndustrialCHP = \"Industrial CHP\",\n  IndustrialNonCHP = \"Industrial Non-CHP\",\n}\n\n\n\n// import from the \"Power_Plants_records.json\"\nimport powerPlantsData from './Power_Plants_records.json' assert { type: 'json' };\n\n// Cast the imported data to the PowerPlants array type\nexport const powerPlants: PowerPlants[] = powerPlantsData as PowerPlants[];\n\nexport const powerPlantsGeoJSON: GeoJSON.FeatureCollection = {\n  type: \"FeatureCollection\",\n  features: powerPlants.map(plant => ({\n    type: \"Feature\",\n    geometry: {\n      type: \"Point\",\n      coordinates: [plant.Longitude, plant.Latitude],\n    },\n    properties: { ...plant },\n  })),\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunk_cosmicds_tempo_lite\"] = self[\"webpackChunk_cosmicds_tempo_lite\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], () => (__webpack_require__(2393)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_font_awesome_icon","class","style","cssStyles","locationJustUpdated","small","modelValue","searchText","$event","setLocationFromSearchFeature","items","searchResults","features","textForMapboxFeature","bgColor","label","density","solo","color","accentColor","performForwardGeocodingSearch","searchErrorMessage","focusCombobox","onFocusChange","ref","menu","menuOpen","append","icon","size","searchOpen","buttonSize","toggleSearch","closeSearch","stayOpen","_","RELEVANT_FEATURE_TYPES","NA_COUNTRIES","NA_ABBREVIATIONS","feature","pieces","text","push","context","forEach","item","itemType","id","split","includes","shortCode","short_code","some","abbr","startsWith","substring","itemText","join","name","emits","props","searchProvider","type","Function","default","Boolean","required","String","theme","persistSelected","data","this","locationUpdatedText","comboFocused","computed","methods","console","log","length","then","info","$emit","focused","blurCombobox","input","$refs","searchInput","blur","focus","undefined","place_name","slice","timedJustUpdatedLocation","clearSearchData","setTimeout","watch","value","__exports__","isComputedRef","effect","magma","r","g","b","inferno","plasma","viridis","cividis","gray","svs_nitrogen_dioxide","svsColorRamp","sargassum","sargassumColorRamp","haline","colormaps","nonEsriColormaps","rgb","esriColorRamp","_stretchRule","min","max","ResamplingTypeEnum","stretches","colorramps","colorbarOptions","stretch","cbarScale","colormap","_colorMapRule","colorRamp","Object","keys","toLowerCase","_resampleRule","resamplingType","composeRasterRules","baseRule","additionalRules","currentRule","i","nextOuterRule","rasterFunctionArguments","Raster","renderingRule","range","resamplineRule","Math","fetchEsriTimeSteps","Promise","esriUrl","variableName","dimensionName","url","format","multidimensionalDefinition","params","f","JSON","stringify","fetchURL","URL","search","URLSearchParams","toString","fetch","res","json","extractTimeSteps","slices","timesteps","map","values","reduce","acc","val","Array","isArray","concat","ESRI_URLS","variable","MOLECULE_OPTIONS","title","moleculeName","molecule","find","m","getEsriTimesteps","rectangleToGeometry","rect","xmin","ymin","xmax","ymax","rings","spatialReference","wkid","pointToGeometry","point","x","y","isBad","v","isNaN","nan2null","_getValidData","arr","validArr","sum","a","mean","nanmean","_arr","difference","diff","result","variance","diffs","stdev","sqrt","standardError","s","median","sorted","sort","mid","floor","mad","med","absDevs","abs","arrayMax","current","arrayMin","nanmin","returnIndex","idx","index","nanmax","sumOfSquares","meanOfSquares","rootMeanSquare","ms","allEqual","first","every","serviceMetaData","geometry","metadata","serviceBounds","fullExtent","pixelXSize","pixelSizeX","pixelYSize","pixelSizeY","serviceXsize","serviceYsize","setGeometry","Error","setMetadata","latSize","lonSize","getSampleDistance","sampleCount","geometryArea","getSampleCount","sampleDistance","calculateActualSampleCount","initialSampleCount","pixelSize","nx","round","geometryXsize","ny","geometryYsize","actualSampleCount","getSamplingSpecificationFromSamplingDistance","count","distance","lats","lons","getSamplingSpecificationFromSampleCount","permitOversampling","adjustedSampleCount","getSampleLocations","spec","delta","sign","j","getSampleLocationsGrid","locations","points","timezone","getOffsetMs","timestamp","Date","offsetRange","utcRange","offsetMs","start","localStart","localEnd","end","offsetRanges","utcRanges","crossesDSTBoundary","startOffset","endOffset","splitRangeAtDSTBoundary","warn","offsetRangesWithDSTHandling","splitRanges","splitRange","safeParseNumber","parsed","parseFloat","stringifyEsriGetSamplesParameters","geometryType","mosaicRule","returnFirstValueOnly","interpolation","outFields","sliceID","time","options","timeStr","t","getTime","metadataCache","_loadingMetadata","_getServiceMetadata","response","ok","status","catch","error","updateMetadataCache","getMetadata","withMetadataCache","resolve","waitForCache","timeInfo","timeExtent","extent","clippedToTimeExtent","timeRange","serviceTimeRange","clipped","baseUrl","_baseUrls","requestUrl","metas","Map","baseUrlArray","set","ImageServiceServiceMetadata","setVariable","getVariable","setBaseUrl","getBaseUrl","fetchSample","esriGeometry","isRectBounds","timeString","urlWithParams","code","message","details","processedSamples","samples","sample","location","attributes","StdTime","date","locationId","totalSamples","fetchSamples","timeRanges","promises","tr","all","results","validResults","filter","flat","aggregateByTime","grouped","has","get","errors","sampleValues","calculateMean","calculateError","seen","Set","key","add","getTimeSeriesStatistics","jsonData","uniqueLocations","uniqueLatitudes","uniqueLongitudes","valuesPerLocation","locString","totalValues","numUniqueLocations","latitudeSpacing","longitudeSpacing","getRegionCenter","lat","lon","fetchTimeseriesData","centerLat","centerLon","toFixed","offsetter","TimeRangeOffsetter","timeRangesArray","localTimeRanges","meta","sampler","EsriSampler","rawData","stats","fetchCenterPointData","rectangle","center","validSamples","lower","upper","squaredDiffs","pow","squaredSEM","ONEDAYMS","useUniqueTimeSelection","timestamps","timeIndex","singleDateSelected","minIndex","maxIndex","mode","initialTimeSelection","getOneDaysTimestamps","mod","ts","getAllDaysTimestamps","setNearestDate","offset","uniqueDays","easternDates","days","getUTCFullYear","getUTCMonth","getUTCDate","unique","from","uniqueDaysIndex","e","indexOf","getUniqueDayIndex","findIndex","day","moveBackwardOneDay","currentIndex","moveForwardOneDay","nextIndex","nearestDate","nearestDateIndex","newTimestamps","immediate","useTimezone","selectedTimezone","toTimezone","utcDate","fromTimezone","setToMidnight","zonedDate","setHours","setToEndOfDay","formatTimeLong","timeZone","formatDuration","startUtc","endUtc","startZoned","endZoned","startTime","toLocaleTimeString","hour","minute","hour12","endTime","formatTimezoneRange","startDate","toLocaleDateString","month","formatUTCRange","formatTime","Number","formatDateDisplay","toDateString","timezoneInfo","toLocaleString","timeZoneName","pop","isDST","standardOffset","currentOffset","timezoneOptions","dateIsDST","tz","atleast1d","formatSingleRange","startString","endString","formatTimeRange","ranges","allStarts","allEnds","minStart","maxEnd","rangeForSingleDay","dayUTC","areEquivalentMsRanges","second","areEquivalentTimeRanges","array","firstRange","rg","createTempoStore","backend","debugMode","regions","datasets","timestampsLoaded","tempoDataServices","backendRef","maxSampleCount","sampleErrors","regionsCreatedCount","userSelectedCalendarDates","userSelectedTimezones","userSelectedLocations","userSelectedNotableEvents","shareButtonClickedCount","playButtonClickedCount","timeSliderUsedCount","opacitySliderUsedCount","maps","selectionActive","focusRegion","showFieldOfRegard","showRoads","showSamplingPreviewMarkers","tzOptions","displayedDayTimeRange","description","accentColor2","tempoRed","getTempoDataService","service","TempoDataService","addTimeRange","deleteTimeRange","splice","_newDate","oldDate","oldRange","displayedDateSelections","sel","formatted","oldTimeRange","v4","zoomScale","urlParams","window","initLat","initLon","initZoom","initTime","initState","loc","zoom","homeLat","homeLon","homeZoom","homeState","addRegion","region","deleteDataset","dataset","addDataset","fetchDataForDataset","markDatasetUpdated","ds","setRegionName","newName","trim","existing","loading","geometryInfo","fetchCenterPointDataForDataset","datasetHasSamples","regionHasDatasets","deleteRegion","registerMap","deregisterMap","reset","loaded","useTempoStore","isDateLikeString","test","deserializeTempoStore","parse","entry","plotlyDatasets","plotlyDataset","datasetOptions","customdata","d","OMIT","serializeTempoStore","store","state","entries","$state","layer","stringified","postDeserializeTempoStore","infoColor","localStorageKey","__name","setup","__props","root","mapTargets","sidePanelTarget","tab","query","VUE_APP_TEMPO_LAB_DEBUG","cssVars","mapConfig","componentType","draggable","width","addMapPanel","layout","config","row","rootItem","addItem","removeMapPanel","contentItems","remove","storedState","localStorage","getItem","$patch","rootEl","registerComponentFactoryFunction","container","element","classList","target","settings","hasHeaders","responsiveMode","content","resizeWithContainerAutomatically","loadLayout","addEventListener","document","visibilityState","setItem","_component_header_bar","_component_map_with_controls","_component_dataset_controls","_component_comparison_data_controls","ref_key","to","_hoisted_1","_hoisted_2","backgroundColor","startValue","endValue","cmapName","nsteps","cmap","extend","mounted","colorbarGradient","random","triangles","showStartTriangle","showEndTriangle","cssLinearGradientFromCmap","n","colors","co","colorbar","querySelector","firstChild","removeChild","div","createElement","className","background","height","appendChild","styleDownTriangle","styleUpTriangle","offsetWidth","offsetHeight","borderLeft","borderRight","borderBottom","borderTop","styleLeftTriangle","styleRightTriangle","styleColorbarChunk","flexGrow","flexShrink","dialogVisible","activator","activatorProps","tooltipTextValue","disabled","showTooltip","elevation","handleKeydown","helpText","tooltipText","event","icons","defaultSet","aliases","sets","mdi","locale","fallback","messages","en","defaultTheme","hide","hideButton","onClick","openDialog","prepend","snackbar","$attrs","role","timeout","actions","tabindex","variant","closeDialog","msg","$nextTick","snackbarMessage","$el","_component_use_clipboard","source","copy","tooltipDisabled","alert","transition","buttonColor","rounded","iconColor","getElementRect","rectPromise","_reject","resolveRectPromise","observer","IntersectionObserver","boundingClientRect","disconnect","observe","useDraggableDialog","dialogSelector","scrimSelector","dragInfo","mousedown","mouseup","mousemove","removeListeners","removeEventListener","setupDraggable","dragging","dragPredicate","cursor","closestDialog","closest","button","boundingRect","el","mouseStartX","clientX","mouseStartY","clientY","elStartX","left","elStartY","top","overlays","querySelectorAll","oldTransition","margin","position","innerWidth","innerHeight","overlay","display","resizeObserver","ResizeObserver","dialogs","dialog","parseInt","body","newRoot","titleColor","shortTitle","scrim","persistent","modal","__emit","emit","card","showDialog","displayedShortTitle","cardRoot","attrs","updateRoot","close","stopPropagation","replace","isVisible","showErrors","sampleKeyCounts","plot","graph","datumToDate","datum","legendGroups","errorTraces","traceVisible","renderPlot","plotlyData","len","regionColor","dataT","dataV","legendGroup","legendgroup","showlegend","marker","visible","errs","valueLower","valueHigher","low","high","line","fill","paddingFactor","axisMax","yaxis","newPlot","on","traceIndex","curveNumber","trace","group","dataId","currentlyVisible","updateErrorDisplay","restyle","newCounts","oldCounts","different","newData","oldData","selectedTimeRange","draftUserDataset","availableMolecules","o","creationProgress","percent","setDraftSelectionRegion","setDraftSelectionMolecule","setDraftSelectionTimeRange","composeSelection","draft","newRegions","exists","rid","selection","loader","indeterminate","html","highlight","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","href","rel","currentUrl","showChanges","showAboutData","showCredits","touchscreen","supportsTouchscreen","smallSize","smAndDown","mobile","_component_cds_dialog","_component_share_button","src","alt","changes","change","useDateTimeSelector","currentDate","utcTimezone","selectionType","selectedDayOfWeek","selectedTime","instancesBack","timePlusMinus","selectedDays","selectedTimes","hasManualWeekdayStartDate","weekdayStartDateTimestamp","endDate","weekdayStartDate","toISOString","setWeekdayStartTimestamp","dayNames","monthNames","selectedMonths","getMonth","selectedYears","getFullYear","generateMillisecondRanges","generatePatternRanges","generateSingleDateRange","generateMonthRanges","generateDateRangeRanges","parsedTime","year","parcelLongRanges","generateWeekdayRanges","baseTimestamp","baseDate","targetDayOfWeek","currentDay","getDay","daysDifference","setDate","getDate","rangeDate","originalDay","originalTime","deduped","startMs","endMs","chunckSize","currentStart","currentEnd","oneDayMs","singleDate","setSingleDateTimestamp","midnightTs","initialParentTs","newCurrentDate","setStartTimestamp","setEndTimestamp","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","defaultStartDate","defaultEndDate","allowedDates","validTimes","currentDateRef","timezoneRef","setStartTimestampInternal","setEndTimestampInternal","weekdayCalendar","singleDateCalendar","weekdayStartDateObj","startDateObj","endDateObj","singleDateObj","timeOptions","h","padStart","possibleYears","dates","years","dayOptions","instanceRules","customTimeRangeName","dayNamesSelected","timesSelected","monthNamesSelected","yearsSelected","updateCustomRange","currentRanges","handleWeekdayDateChange","closeMenu","handleStartDateChange","handleEndDateChange","dateRangeArray","dateRangeCalendar","handleDateRangeChange","changed","handleSingleDateChange","normalizeTimes","normalized","ampmMatch","match","suffix","mm","today","newDate","newDateString","newTs","newTimestamp","teleport","dark","multiple","chips","hint","for","rules","clearable","aggregateData","aggFunc","errorFunc","aggY","aggE","cleanY","cleanE","calE","finalError","START_WEEK_ON_MONDAY","getBeginningOfWeek","weekStart","dayOfYear","oneDay","getWeekOfYearSundayStart","currentDayOfYear","januaryFirst","dayOfYearStart","getWeekOfYearMondayStart","getWeekOfYear","daysInMonth","getDaysInYear","altFloorHour","msPerHour","floorWeekendWeekday","_date","isWeekday","MS_IN_SECOND","setMilliseconds","setSeconds","MS_IN_MINUTE","MS_IN_HOUR","MS_IN_DAY","MS_IN_WEEK","method","errorMethod","includeCalibrationUncertainty","_getZonedDate","getGroupId","groupDate","endsWith","groupDay","utcMidnight","groupData","timeseries","groups","groupId","groupValues","errorValues","sortfoldBinContent","bin","binPhase","bp","sortedIndices","applySort","rawValues","lowers","uppers","foldType","_binCount","Infinity","_binIndex","z","getHours","yearStart","season","seasonStartMonths","yearOff","seasonStart","dayOfSeason","dayOfMonth","seasonStartMonth","zBinStart","isWeekend","_binPhase","minutes","getMinutes","seconds","getSeconds","milliseconds","getMilliseconds","hourOfDay","dayOfWeek","foldData","binCount","binsRecord","binIndex","numericValues","calibrationErrors","err","isNonePeriod","publicBins","binDate","bins","foldTypeStyles","xaxis","tickmode","tick0","dtick","tickvals","ticktext","labelalias","tickformat","getFoldTypeStyle","deepMerge","mergeFoldTypeLayout","customLayout","foldStyle","normalizeBadValue","createErrorBands","datasetName","upperY","lowerY","traceErrorOptions","dataOptions","errorBarStyles","names","layoutOptions","configOptions","generateHash","string","hash","char","charCodeAt","hashDataset","filterNulls","filterNullValues","filteredX","filteredY","filteredLower","filteredUpper","filteredCustomData","errorType","errorOptions","symmetric","arrayminus","thickness","dataTraceOptions","hasErrors","newMax","errorBandsVisible","_newData","_oldData","deep","timezones","browserTimeZone","Intl","DateTimeFormat","resolvedOptions","cloneTimeFromLocalToBrowser","rezonedDatasets","newX","mergedLayoutOptions","validTimeBinsForFoldingPeriod","isValidCombination","timeBin","foldingPeriod","getFirstValidTimeBin","validTimeBins","dialogOpen","theColor","customColor","MS_IN_MONTH","MS_IN_YEAR","timeBinDurations","foldingPeriodDurations","dataDuration","minMax","validTimeBinForData","validFoldingForData","aggregationWarning","timeBinOptions","allFoldingPeriodOptions","foldingPeriodOptions","methodOptions","selectedTimeBin","selectedFoldingPeriod","selectedMethod","useSEM","useErrorBars","newPeriod","validTimeBin","selectedFoldType","period","charAt","toUpperCase","isHourBinned","includeBinPhase","alignToBinCenter","alignDataToBinCenters","disableIncludePhaseCheckbox","validPeriods","opt","isNone","regionCenter","useTzCenter","tzCenter","newVal","originalDataPointCount","foldedDataPointCount","foldedData","canSave","foldedDatasetName","foldedSelection","graphData","foldedTimesSeriesToDataSet","foldedTimeSeries","sortedEntries","binIndexa","binIndexb","aggValue","setMinutes","foldedTimeSeriesRawToDataSet","binContent","sortedBinContent","rv","up","hovertemplate","updateGraphData","createFoldedTimeRange","originalRange","selectionToTimeseries","updateAggregatedData","timeSeriesData","grouper","TimeSeriesFolder","handlePointClick","saveFolding","folded","raw","newvValue","_component_info_button","cols","md","column","option","outline","saveFolded","scrollable","inheritAttrs","confirmText","minWidth","local","onConfirm","autofocus","turnOnSelection","selectedDatasets","datasetRowRefs","isFolded","datesetsWithNotFoldedFisrt","aFolded","bFolded","isHovering","ref_for","ripple","lines","fn","cleanOutput","_length","_skippedPoints","_size","_x","_y","_lower","_upper","_addPointWithError","_addPointNoError","addPoint","build","isFull","userDatasetToPlotly","useLocalTime","plotlyBuilder","PlotlyDatasetBuilder","useTz","c","errorMessage","toDate","dateStyle","toTime","sampleHeaders","children","samplesItems","foldPeriod","foldedHeaders","foldedItems","headers","nameOnly","colorOnly","model","save","cancel","globalKeydownHandler","skipTags","tagName","placeholder","minlength","plotlyDragPredicate","openPanels","openGraphs","openSelection","tableSelection","currentlyEditingDataset","showConfirmReset","createTimeRangeActive","createDatasetActive","sampleErrorID","loadingPointSample","showEditRegionNameDialog","regionBeingEdited","aggregationDataset","showAggregationDialog","openAggregationDialog","handleAggregationSaved","aggregatedSelection","handleDatasetCreated","showDatasetEditor","datasetEditorNameOnly","handleEditDataset","removeDataset","handleDateTimeRangeSelectionChange","customName","editRegionName","graphTitle","molTitle","showNO2Graph","no2GraphData","showO3Graph","o3GraphData","showHCHOGraph","hchoGraphData","allDatasetSelection","showfoldedNO2Graph","no2foldedGraphData","validFoldedDatasets","showfoldedO3Graph","o3foldedGraphData","showfoldedHCHOGraph","hchofoldedGraphData","showErrorBands","showUserDatasetTable","_component_selection_composer","active","opacity","striped","bottom","block","dense","_component_layer_order_control","_component_power_plants_filter_control","mapRef","order","timestepCache","useEsriTimesteps","initialMolecule","updateOnMount","loadingTimesteps","esriTimesteps","updateEsriTimeSteps","_newValues","selectedIndex","reverse","useUtc","dateOnly","hourOnly","formatDate","getTimezoneOffset","timestampsComputed","formattedDates","formattedTimes","handleChipClick","radio","calendar","handleEsriTimeSelected","_index","newMol","_component_date_picker","transitions","lerp","spline","u","clamp","cmin","cmax","reversed","redValues","greenValues","blueValues","normalizedVal","createHeatmapColorMap","colormapName","steps","transparentTo","transparentAdded","useLocationMarker","show","showLocationMarker","locationMarker","addToMap","addTo","setMarker","latlng","lnglat","setLngLat","removeMarker","baseUseSelection","handler","updateListeners","dragPan","disable","scrollZoom","onMousedown","onMouseup","onMousemove","enable","off","mMap","nowActive","getCanvas","newMap","selectionInfo","useRectangleSelection","interactColor","geoJson","rectangleSource","rectangleLayer","startCoords","uuid","lngLat","coordinates","lng","properties","addSource","getSource","addLayer","paint","getLayer","eventCoords","removeLayer","removeSource","setData","createBounds","addRectangleLayer","removeRectangleLayer","addPointLayer","removePointLayer","regionBounds","pointPadding","fitBounds","bounds","_fly","usePointSelection","paulTolMutedColorblindSafeColors","COLORS","DEG_DEFAULT","PX_DEFAULT","toGeoJSON","radius_deg","pt","radius_px","useMultiMarker","sourceId","layerId","optionsToPaint","fillColor","fillOpacity","outlineColor","addMarkers","clearMarkers","geojson","scale","radius","degreeToPixel","isNumeric","setLayerOpacity","paintProp","setPaintProperty","getPaintProperty","getLayerOpacity","op","getLayerVisibility","getLayoutProperty","setLayerVisibility","setLayoutProperty","devicePixelRatio","retinaParam","useMap","_showRoads","onReady","addStates","addCoastlines","addLabels","tiles","tileSize","minzoom","maxzoom","moveLayer","setupMap","libreMap","cleanupMap","createMap","_map","attributionControl","addControl","AttributionControl","compact","setView","setCenter","setZoom","getCenter","resetView","centerLonLat","onHome","_centerLonLat","_zoom","_onHome","onAdd","_container","_button","_goHome","bind","_homeIcon","padding","svg","encodeURIComponent","onRemove","parentNode","flyTo","usezoomhome","home","callback","startingCenter","zoomHome","createControl","control","CDSMaplibreHomeTool","NavigationControl","showCompass","newValue","mapID","initial","events","__expose","latitude","longitude","showRoadsRef","attachAllEvents","handlers","evt","detachAllEvents","promiseResolve","mapReady","whenMapReady","onMapReady","newLat","newLng","newZoom","getZoom","exposedMapApi","once","useEsriLayer","fetchOnMount","esriLayerId","esriImageSource","opacityRef","noEsriData","loadingEsriTimeSteps","renderOptions","getStyle","layers","dynamicMapService","onSourceLoad","isSourceLoaded","updateEsriOpacity","updateEsriTimeRange","createImageService","ImageService","addEsriSource","hasEsriSource","nearest","updateStretch","vmin","vmax","setRenderingRule","updateColormap","_timesteps","_value","_newMol","esriServiceOptions","newRange","newColormap","useFieldOfRegard","usingAugust","fieldOfRegardLayer","fieldOfRegardLayerId","createFoRLayer","clearFoR","updateFieldOfRegard","addFieldOfRegard","innerMap","timestampRef","newSteps","old","oldMap","dt","internalShowFieldOfRegard","onInnerMapReady","exposedApi","listener","contained","horizontal","currentColormap","colorMap","moleculeLabel","scalePower","p","log10","isFinite","_component_colorbar_horizontal","_component_colorbar","addPowerPlants","powerPlantsLayerId","powerPlantsHeatmapLayerId","powerPlantsSourceId","powerPlantsVisible","loadPromise","togglePowerPlants","vis","layerIDs","visibility","isValidMap","ensureDataLoaded","powerPlantsGeoJSON","finally","popup","Popup","closeButton","closeOnClick","currentFeatureCoordinates","featureCoordinates","Plant_Name","PrimSource","Install_MW","setHTML","addheatmapLayer","pixelRatio","extraTagsOption","excludeDirectChildren","removeSpace","trimSpace","splitSpace","okhash","getElementsByTagName","attr","getAttribute","attrf","get1","norm","normalize","numarray","nodeVal","textContent","getMulti","ys","k","coord1","coord","coords","coordPair","ll","ele","heartRate","fc","serializer","XMLSerializer","xml2str","str","xml","serializeToString","kml","doc","gj","styleIndex","styleByHash","styleMapIndex","geotypes","placemarks","styles","styleMaps","l","pairs","pairsMap","getPlacemark","addExtraTags","tag","childNodes","node","nodeType","localName","nodeName","kmlColor","substr","gxCoord","gxCoords","elems","times","timeElems","getGeometry","geomNode","geomNodes","geoms","coordTimes","coordsText","ringCoordsText","track","styleUrl","lineStyle","polyStyle","geomsAndTimes","address","timeSpan","timeStamp","extendedData","styleHash","styleMapHash","normal","iconStyle","begin","timespan","linestyles","stroke","polystyles","pcolor","popacity","datas","simpleDatas","geometries","extraTags","gpx","tracks","routes","waypoints","getTrack","getRoute","getPoint","initializeArray","getPoints","pointname","pts","heartRates","segments","getProperties","getLineStyle","prop","routeObj","extensions","links","link","useAbortableFetch","abortController","abortableFetch","init","controller","AbortController","signal","abort","parseXML","xmlString","parser","DOMParser","parseFromString","errorNode","useKML","kmlUrl","geoJsonData","_convertKmlToGeoJson","kmlContent","kmlDoc","loadKML","requestedUrl","setUrl","newUrl","next","cleanUp","AQI_STYLE_COLORS","getAqiColorFromStyleUrl","styleUrlRaw","addQUI","internalSetUrl","propertyToShow","labelMinZoom","showPopup","showLabel","idBase","layerName","labelLayerId","popupRef","onEnterRef","onMoveRef","onLeaveRef","onStyleDataRef","lastKnownVisible","layerVisible","postProcessGeoJson","processedFeatures","processedFeature","styleURL","setupLayerPopup","maxWidth","valueProp","onEnter","desc","onMove","onLeave","setupVisibilitySync","syncLabelVisibility","mainVis","labelVis","toggleAQIVisibility","removeFromMap","maplibreMap","currentTempoDataService","createSelectionComputed","pointSelectionActive","rectangleSelectionActive","rectangleInfo","pointInfo","pp","airQualityUrl","aqiLayer","updateRegionLayers","playing","playInterval","activateRectangleSelectionMode","activatePointSelectionMode","regionLayers","mapTitle","currentMolecule","thumbLabel","dateObj","hours","getUTCHours","amPm","hourValue","getUTCMinutes","defaultMapboxOptions","types","countries","limit","geocodingInfoForSearchLimited","token","opts","access_token","geocodingInfoForSearch","_err","setLocationFromSearch","onZoomhome","updateURL","stateObj","origin","searchParams","pathname","history","replaceState","onEsriTimestepsLoaded","play","setInterval","pause","clearInterval","rectangleIsDegenerate","isRect","layerInfo","createRegion","getRegionsDifference","arr1","arr2","ids2","existingRegions","added","removed","newRegion","samplingPreviewMarkers","shape","tempoDataService","regs","_component_location_search","_component_icon_button","_component_map_controls","step","mol","infoText","checkArrayEquality","isSubset","subset","superset","arrayMove","fromIndex","toIndex","newArr","listeners","dispatchEvent","cleanup","initialOrder","initialized","eventHandlers","desiredLayerOrder","keepAtTop","idleListener","orderLayers","watchForChanges","hasLayer","getLayersOrder","startAtTop","bottomLayer","topLayer","safeMoveLayerBelow","maintainOrder","availableDesiredOrder","currentlyManagedLayerOrder","onStyleData","destroy","newIndex","currentOrder","currentLayerIndex","newLayerOrder","moveActualLayerByIndex","moveActualLayer","layerAtNewIndex","oldLayerOrderIndex","newLayerOrderIndex","moveToFront","topIndex","moveToBack","moveUp","moveDown","setOrder","setKeepAtTop","reverseLayerOrder","layerToMove","layerItShouldBeBelow","safeMoveLayerAbove","layerItShouldBeAbove","setManagedOrder","newManagedOrder","managedLayerMap","newDesiredOrder","managedIndex","PsuedoEvent","useMaplibreLayerOrderControl","moveToTop","desiredOrder","mapValue","MaplibreLayerOrderControl","newOrder","capitalizeWords","displayOrder","layerNames","displayNameTransform","_component_layer_control_item","handle","useMaplibreLayerOpacity","initialOpacity","useMaplibreLayerVisibility","initialVisibility","displayName","_component_popup_info_button","modelModifiers","PLANT_CATEGORIES","selectedSources","SOURCES_BY_CATEGORY","Renewables","Other","handleGlobalSelect","handleCategoryGlobalSelect","category","onLayersChanged","newLayers","applyPrimSourceFilter","sources","layerIds","setFilter","newLayerIds","oldLayerIds","hasNewLayers","visibilityChanged","oldLayer","newLayer","update","binding","TempoLab","use","vuetify","directive","beforeMount","_vnode","_prevVnode","updated","component","IconButton","FundingAcknowledgement","CreditLogos","LocationSearch","InfoButton","ColorBarHorizontal","SnackbarAlert","ShareButton","CDSDialog","MarqeeAlert","TimeseriesGraph","SelectionComposer","DatasetControls","ComparisonDataControls","MapControls","MapWithControls","HeaderBar","PopupInfoButton","MaplibreLayerControlItem","LayerOrderControl","PowerPlantsFilterControl","mount","RenewableSource","TraditionalSource","Source","State","SectorName","TraditionalSources","Coal","NaturalGas","Petroleum","RenewableSources","Biomass","Geothermal","Hydroelectric","Solar","Wind","powerPlants","plant","Longitude","Latitude","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","deferred","O","chunkIds","priority","notFulfilled","fulfilled","getter","__esModule","definition","defineProperty","enumerable","globalThis","obj","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}