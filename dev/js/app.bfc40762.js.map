{"version":3,"file":"js/app.bfc40762.js","mappings":"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,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,KAAO,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACv9EC,EAAG,CAAC,OAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,MAAQ,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC19EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,KAAO,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UCHj9EC,EAAoB,CAC/BH,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACj+EC,EAAG,CAAC,OAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACl+EC,EAAG,CAAC,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,UCHp9EE,EAAmB,CAC9BJ,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC/9EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAU,OAAU,OAAU,OAAU,OAAU,OAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,SAC/9EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,MAAQ,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UCH98EG,EAAoB,CAC/BL,EAAG,CAAC,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,KAAO,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,SAC59EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,KAAO,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,SAC59EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UCH59EI,EAAoB,CAC/BN,EAAG,CAAC,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,IAAM,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC52EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SACv9EC,EAAG,CAAC,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,MAAQ,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,UCHh9EK,EAAiB,CAC5BP,EAAG,CAAC,EAAK,mBAAqB,mBAAqB,oBAAsB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,GAAK,iBAAmB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,GAAK,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,GACh/JC,EAAG,CAAC,EAAK,mBAAqB,mBAAqB,oBAAsB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,GAAK,iBAAmB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,GAAK,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,GACh/JC,EAAG,CAAC,EAAK,mBAAqB,mBAAqB,oBAAsB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,kBAAoB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,GAAK,iBAAmB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,GAAK,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,ICFr+JM,EAAiC,CAC5CR,EAAG,CAAC,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,SAC79EC,EAAG,CAAC,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,SACjiFC,EAAG,CAAC,SAAW,QAAU,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,SAAW,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,GAAK,GAAK,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,OAAS,OAAS,OAAS,OAAS,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,OAAS,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,QAAU,UAIn9EO,EAAe,CAC1B,KAAQ,YACR,WAAc,CACZ,CACE,KAAQ,cACR,UAAa,CACX,EACA,EACA,GACA,KAEF,QAAW,CACT,GACA,EACA,GACA,KAEF,UAAa,sBACb,MAAS,EACT,KAAQ,qBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,EACA,GACA,KAEF,QAAW,CACT,GACA,GACA,GACA,KAEF,UAAa,sBACb,MAAS,oBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,GACA,KAEF,QAAW,CACT,GACA,GACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,GACA,KAEF,QAAW,CACT,GACA,GACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,GACA,KAEF,QAAW,CACT,GACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,GACA,IACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,IACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,GACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,GACA,IACA,IACA,KAEF,QAAW,CACT,GACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,KCnYDC,EAAsB,CACjCV,EAAG,CAAC,kBAAoB,mBAAqB,iBAAmB,GAAK,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,GAAK,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,GAAK,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBACh8JC,EAAG,CAAC,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,GAAK,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,GAAK,iBAAmB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,GAAK,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,k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EV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,GACA,EACA,KAEF,UAAa,sBACb,MAAS,oBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,GACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,GACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,GACA,EACA,KAEF,QAAW,CACT,IACA,IACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,EACA,KAEF,QAAW,CACT,IACA,IACA,EACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,EACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,oBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,mBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,GACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,GACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,mBAEV,CACE,KAAQ,cACR,UAAa,CACX,IACA,IACA,IACA,KAEF,QAAW,CACT,IACA,IACA,IACA,KAEF,UAAa,sBACb,MAAS,kBACT,KAAQ,KClYDC,EAAmB,CAC9BZ,EAAG,CAAC,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,iBAAmB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,oBAAsB,mBAAqB,mBAAqB,mBAAqB,oBAAsB,mBAAqB,mBAAqB,oBAAsB,mBAAqB,oBAAsB,kBAAoB,iBAAmB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,iBAAmB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,gBAAkB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,iBAAmB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,iBAAmB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,gBAAkB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,gBAAkB,kBAAoB,gBAAkB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAC3lKC,EAAG,CAAC,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,gBAAkB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,gBAAkB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,iBAAmB,kBAAoB,iBAAmB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,mBACjhKC,EAAG,CAAC,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,gBAAkB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,mBAAqB,kBAAoB,kBAAoB,kBAAo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,EAAMuS,QAAQ,kBAAmB,SAASA,QAAQ,QAAS,SAAAi4C,GAAK,OAAAA,EAAElF,aAAF,EACzE,EAzGA,SAAK0vB,GACH,wBACA,kDACA,8CACA,0DACA,8DACA,gEACA,sDACA,kCACA,sCACA,mDACA,mCACA,mCACA,2CACA,qCACA,+BACA,2CACA,2CACA,qDACA,+DACA,2CACA,qDACA,iDACA,6CACA,qCACA,qDACA,mEACA,yCACA,2DACA,2DACA,iDACA,uCACA,+CACA,mDACA,2DACA,uDACA,iDACA,uDACA,yDACA,yDACA,uDACA,mEACA,yCACA,uCACA,mCACA,uCACA,mDACA,yCACA,iDACA,uCACA,mCACA,+CACA,2CACA,uCACA,mFACA,mDACA,2CACA,mDACA,yDACA,2DACA,qDACA,yEACA,2CACA,uCACA,mCACA,+CACA,+CACA,+CACA,+CACA,uDACA,qCACA,mCACA,+BACA,uDACA,iDACA,mDACA,uDACA,mEACA,yEACA,yDACA,6CACA,6CACA,uDACA,+CACA,6DACA,mDACA,uDACA,6DACA,2BACA,6CACA,6DACA,uCACA,2CACA,mCACA,+CACA,iDACA,iDACA,+CACA,qCACD,EAnGD,CAAKA,KAAAA,GAAgB,KCCd,IAAME,GAAiB,SAACtnE,GAC7B,IAAKA,EAAG,OAAO,KACf,IAAMnC,EAAImC,EAAEgF,MAAM,sBAClB,IAAKnH,EAAG,OAAO,KACT,eAAkBA,EAAC,GAAhBkxC,EAAM,KAAEw4B,EAAG,KACd5oE,EAAIyG,SAASmiE,EAAI3yE,UAAU,EAAG,IAC9BkS,EAAI1B,SAASmiE,EAAI3yE,UAAU,IAC3B4yE,EAAU,IAAIt+D,KAAKvK,EAAG,EAAGmI,GAAGqF,mBAAmB,QAAS,CAAEC,MAAO,QAASsS,IAAK,UAAW2hB,KAAM,YAEtG,OAAOrgC,EAAE2E,QAAQ9G,EAAE,GAAIkxC,EAASy4B,EAClC,EAIaC,GAAmB,SAACznE,GAC/B,IAAKA,EAAG,OAAO,KACf,IAAMnC,EAAImC,EAAEgF,MAAM,sBAClB,IAAKnH,EAAG,OAAOmC,EACT,eAAqBnC,EAAC,GAAnB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","sources":["webpack://@cosmicds/tempo-lab/./src/assets/power_plants.ts","webpack://@cosmicds/tempo-lab/./src/components/LocationSearch.vue?5288","webpack://@cosmicds/tempo-lab/./src/components/LocationSearch.vue","webpack://@cosmicds/tempo-lab/./src/mapbox.ts","webpack://@cosmicds/tempo-lab/./src/components/LocationSearch.vue?99f6","webpack://@cosmicds/tempo-lab/./src/utils/vue.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/magma.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/inferno.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/plasma.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/viridis.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/cividis.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/gray.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/svs_nitrogen_dioxide.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/sargassum.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/cmo_haline.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_red_from_black.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_blue_from_black.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_green_from_black.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_cyan_from_black.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_yellow_from_black.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_magenta_from_black.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_red_from_white.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_blue_from_white.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_green_from_white.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_cyan_from_white.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_yellow_from_white.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/custom_magenta_from_white.ts","webpack://@cosmicds/tempo-lab/./src/colormaps/index.ts","webpack://@cosmicds/tempo-lab/./src/esri/ImageLayerConfig.ts","webpack://@cosmicds/tempo-lab/./src/esri/utils.ts","webpack://@cosmicds/tempo-lab/./src/esri/geometry.ts","webpack://@cosmicds/tempo-lab/./src/utils/array_operations/array_math.ts","webpack://@cosmicds/tempo-lab/./src/esri/services/sampling.ts","webpack://@cosmicds/tempo-lab/./src/utils/parse_time_strings.ts","webpack://@cosmicds/tempo-lab/./src/utils/array_operations/cyclic.ts","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/date_time_range_generators.ts","webpack://@cosmicds/tempo-lab/./src/esri/services/TimeRangeOffsetter.ts","webpack://@cosmicds/tempo-lab/./src/esri/services/TempoDataService.ts","webpack://@cosmicds/tempo-lab/./src/composables/useUniqueTimeSelection.ts","webpack://@cosmicds/tempo-lab/./src/composables/useTimezone.ts","webpack://@cosmicds/tempo-lab/./src/utils/atleast1d.ts","webpack://@cosmicds/tempo-lab/./src/utils/timeRange.ts","webpack://@cosmicds/tempo-lab/./src/stores/app.ts","webpack://@cosmicds/tempo-lab/./src/TempoLab.vue","webpack://@cosmicds/tempo-lab/./src/TempoLab.vue?9a16","webpack://@cosmicds/tempo-lab/./src/TempoLab.vue?d70b","webpack://@cosmicds/tempo-lab/./src/components/ColorBar.vue?15b2","webpack://@cosmicds/tempo-lab/./src/components/ColorBar.vue","webpack://@cosmicds/tempo-lab/./src/components/ColorBar.vue?632f","webpack://@cosmicds/tempo-lab/./src/components/ColorBarHorizontal.vue?6293","webpack://@cosmicds/tempo-lab/./src/components/ColorBarHorizontal.vue","webpack://@cosmicds/tempo-lab/./src/components/ColorBarHorizontal.vue?6f32","webpack://@cosmicds/tempo-lab/./src/components/InfoButton.vue?df3d","webpack://@cosmicds/tempo-lab/./src/components/InfoButton.vue","webpack://@cosmicds/tempo-lab/./src/components/InfoButton.vue?de13","webpack://@cosmicds/tempo-lab/./plugins/vuetify.ts","webpack://@cosmicds/tempo-lab/./src/components/SnackbarAlert.vue?dde0","webpack://@cosmicds/tempo-lab/./src/components/SnackbarAlert.vue","webpack://@cosmicds/tempo-lab/./src/components/SnackbarAlert.vue?3716","webpack://@cosmicds/tempo-lab/./src/components/ShareButton.vue?f44e","webpack://@cosmicds/tempo-lab/./src/components/ShareButton.vue","webpack://@cosmicds/tempo-lab/./src/components/ShareButton.vue?a5b6","webpack://@cosmicds/tempo-lab/./src/utils/dom.ts","webpack://@cosmicds/tempo-lab/./src/composables/useDraggableDialog.ts","webpack://@cosmicds/tempo-lab/./src/components/CDSDialog.vue?f933","webpack://@cosmicds/tempo-lab/./src/components/CDSDialog.vue","webpack://@cosmicds/tempo-lab/./src/components/CDSDialog.vue?51b6","webpack://@cosmicds/tempo-lab/./src/components/MarqeeAlert.vue?b891","webpack://@cosmicds/tempo-lab/./src/components/MarqeeAlert.vue","webpack://@cosmicds/tempo-lab/./src/components/MarqeeAlert.vue?852b","webpack://@cosmicds/tempo-lab/./src/components/TimeseriesGraph.vue?a88f","webpack://@cosmicds/tempo-lab/./src/components/TimeseriesGraph.vue","webpack://@cosmicds/tempo-lab/./src/components/TimeseriesGraph.vue?a5cc","webpack://@cosmicds/tempo-lab/./src/components/SelectionComposer.vue?63bd","webpack://@cosmicds/tempo-lab/./src/components/SelectionComposer.vue","webpack://@cosmicds/tempo-lab/./src/components/SelectionComposer.vue?525e","webpack://@cosmicds/tempo-lab/./src/changes.ts","webpack://@cosmicds/tempo-lab/./src/components/HeaderBar.vue?c32b","webpack://@cosmicds/tempo-lab/./src/components/HeaderBar.vue","webpack://@cosmicds/tempo-lab/./src/components/HeaderBar.vue?482e","webpack://@cosmicds/tempo-lab/./src/utils/draggable.ts","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DateRangePicker.vue?9901","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DateRangePicker.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DateRangePicker.vue?e2f6","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DaysPicker.vue?a561","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DaysPicker.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DaysPicker.vue?ade6","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DayPatterns.vue?022d","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DayPatterns.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DayPatterns.vue?4969","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/MonthsPicker.vue?62e1","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/MonthsPicker.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/MonthsPicker.vue?6db5","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/YearsPicker.vue?6da5","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/YearsPicker.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/YearsPicker.vue?a2e4","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DaysPreview.vue?0e41","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DaysPreview.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DaysPreview.vue?8c5d","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/SpecificTimesSelector.vue?113b","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/SpecificTimesSelector.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/SpecificTimesSelector.vue?afb0","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/TimelineVisualization.vue?81b9","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/TimelineVisualization.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/TimelineVisualization.vue?851f","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/filter_ranges.ts","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DateTimeRangeSelection.vue?5777","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DateTimeRangeSelection.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/DateTimeRangeSelection.vue?5987","webpack://@cosmicds/tempo-lab/./src/utils/array_operations/aggregator.ts","webpack://@cosmicds/tempo-lab/./src/utils/calendar_utils.ts","webpack://@cosmicds/tempo-lab/./src/esri/services/aggregation.ts","webpack://@cosmicds/tempo-lab/./src/components/plotly/plotly_styles.ts","webpack://@cosmicds/tempo-lab/./src/components/plotly/plotly_graph_elements.ts","webpack://@cosmicds/tempo-lab/./src/components/plotly/defaults.ts","webpack://@cosmicds/tempo-lab/./src/components/plotly/PlotlyGraph.vue?e433","webpack://@cosmicds/tempo-lab/./src/components/plotly/PlotlyGraph.vue","webpack://@cosmicds/tempo-lab/./src/components/plotly/PlotlyGraph.vue?0a73","webpack://@cosmicds/tempo-lab/./src/components/FoldedPlotlyGraph.vue?0cbd","webpack://@cosmicds/tempo-lab/./src/components/FoldedPlotlyGraph.vue","webpack://@cosmicds/tempo-lab/./src/components/FoldedPlotlyGraph.vue?2617","webpack://@cosmicds/tempo-lab/./src/components/AggregationControls.vue?d931","webpack://@cosmicds/tempo-lab/./src/components/AggregationControls.vue","webpack://@cosmicds/tempo-lab/./src/components/AggregationControls.vue?976d","webpack://@cosmicds/tempo-lab/./src/utils/foldingValidation.ts","webpack://@cosmicds/tempo-lab/./src/components/DataFoldingAndBinning.vue?6043","webpack://@cosmicds/tempo-lab/./src/components/DataFoldingAndBinning.vue","webpack://@cosmicds/tempo-lab/./src/components/DataFoldingAndBinning.vue?1cea","webpack://@cosmicds/tempo-lab/./src/components/AdvancedOperations.vue?7006","webpack://@cosmicds/tempo-lab/./src/components/AdvancedOperations.vue","webpack://@cosmicds/tempo-lab/./src/components/AdvancedOperations.vue?a53d","webpack://@cosmicds/tempo-lab/./src/components/CTextField.vue?3472","webpack://@cosmicds/tempo-lab/./src/components/CTextField.vue","webpack://@cosmicds/tempo-lab/./src/components/CTextField.vue?1cb1","webpack://@cosmicds/tempo-lab/./src/components/DatasetCard.vue?c956","webpack://@cosmicds/tempo-lab/./src/components/DatasetCard.vue","webpack://@cosmicds/tempo-lab/./src/components/DatasetCard.vue?03d4","webpack://@cosmicds/tempo-lab/./src/utils/text.ts","webpack://@cosmicds/tempo-lab/./src/utils/folded_bin_processor.ts","webpack://@cosmicds/tempo-lab/./src/utils/data_converters.ts","webpack://@cosmicds/tempo-lab/./src/components/SaveCSV.vue?803e","webpack://@cosmicds/tempo-lab/./src/components/SaveCSV.vue","webpack://@cosmicds/tempo-lab/./src/components/SaveCSV.vue?5f7a","webpack://@cosmicds/tempo-lab/./src/components/UserDatasetTable.vue?f0de","webpack://@cosmicds/tempo-lab/./src/components/UserDatasetTable.vue","webpack://@cosmicds/tempo-lab/./src/components/UserDatasetTable.vue?047f","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/TimeRangeCard.vue?7511","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/TimeRangeCard.vue","webpack://@cosmicds/tempo-lab/./src/date_time_range_selection/TimeRangeCard.vue?6869","webpack://@cosmicds/tempo-lab/./src/components/plotly/MultiDatasetPlot.vue?c91f","webpack://@cosmicds/tempo-lab/./src/components/plotly/MultiDatasetPlot.vue","webpack://@cosmicds/tempo-lab/./src/components/plotly/MultiDatasetPlot.vue?1413","webpack://@cosmicds/tempo-lab/./src/components/plotly/UserDatasetPlot.vue?53b8","webpack://@cosmicds/tempo-lab/./src/components/plotly/UserDatasetPlot.vue","webpack://@cosmicds/tempo-lab/./src/components/plotly/UserDatasetPlot.vue?38ad","webpack://@cosmicds/tempo-lab/./src/components/plotly/MultiMoleculePlot.vue?e8da","webpack://@cosmicds/tempo-lab/./src/components/plotly/MultiMoleculePlot.vue","webpack://@cosmicds/tempo-lab/./src/components/plotly/MultiMoleculePlot.vue?6c4e","webpack://@cosmicds/tempo-lab/./src/components/UserDatasetEditor.vue?c4c0","webpack://@cosmicds/tempo-lab/./src/components/UserDatasetEditor.vue","webpack://@cosmicds/tempo-lab/./src/components/UserDatasetEditor.vue?c384","webpack://@cosmicds/tempo-lab/./src/components/DatasetControls.vue?731f","webpack://@cosmicds/tempo-lab/./src/components/DatasetControls.vue","webpack://@cosmicds/tempo-lab/./src/components/DatasetControls.vue?d58e","webpack://@cosmicds/tempo-lab/./src/components/ComparisonDataControls.vue?3088","webpack://@cosmicds/tempo-lab/./src/components/ComparisonDataControls.vue","webpack://@cosmicds/tempo-lab/./src/components/ComparisonDataControls.vue?ed95","webpack://@cosmicds/tempo-lab/./src/components/MapControls.vue?90e0","webpack://@cosmicds/tempo-lab/./src/components/MapControls.vue","webpack://@cosmicds/tempo-lab/./src/components/MapControls.vue?552a","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/useMarker.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/baseUseSelection.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/useRectangleSelection.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/utils.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/usePointSelection.ts","webpack://@cosmicds/tempo-lab/./src/utils/color.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/useMultiMarker.ts","webpack://@cosmicds/tempo-lab/./src/maplibre_controls.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/useMap.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/MaplibreHomeTool.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/useZoomHome.ts","webpack://@cosmicds/tempo-lab/./src/components/MaplibreMap.vue?df5a","webpack://@cosmicds/tempo-lab/./src/components/MaplibreMap.vue","webpack://@cosmicds/tempo-lab/./src/components/MaplibreMap.vue?d3f0","webpack://@cosmicds/tempo-lab/./src/esri/ImageServiceLayer/utils.js","webpack://@cosmicds/tempo-lab/./src/esri/ImageServiceLayer/ImageService.js","webpack://@cosmicds/tempo-lab/./src/composables/useEsriTimesteps.ts","webpack://@cosmicds/tempo-lab/./src/esri/maplibre/useTempoImageLayer.ts","webpack://@cosmicds/tempo-lab/./src/composables/maplibre/useFieldOfRegard.ts","webpack://@cosmicds/tempo-lab/./src/components/EsriMap.vue?2726","webpack://@cosmicds/tempo-lab/./src/components/EsriMap.vue","webpack://@cosmicds/tempo-lab/./src/components/EsriMap.vue?e24d","webpack://@cosmicds/tempo-lab/./src/utils/canvas_downloader.ts","webpack://@cosmicds/tempo-lab/./src/components/MaplibreDownloadButton.vue?8f85","webpack://@cosmicds/tempo-lab/./src/components/MaplibreDownloadButton.vue","webpack://@cosmicds/tempo-lab/./src/components/MaplibreDownloadButton.vue?99f0","webpack://@cosmicds/tempo-lab/./src/colormaps/utils.ts","webpack://@cosmicds/tempo-lab/./src/composables/addPowerPlants.ts","webpack://@cosmicds/tempo-lab/./src/togeojson.js","webpack://@cosmicds/tempo-lab/./src/composables/useAbortableFetch.ts","webpack://@cosmicds/tempo-lab/./src/composables/useKML.ts","webpack://@cosmicds/tempo-lab/./src/utils/glcc.ts","webpack://@cosmicds/tempo-lab/./src/composables/addHMSFire.ts","webpack://@cosmicds/tempo-lab/./src/composables/addAQI.ts","webpack://@cosmicds/tempo-lab/./src/composables/useEsriMapLayer.ts","webpack://@cosmicds/tempo-lab/./src/composables/addPopulationDensity.ts","webpack://@cosmicds/tempo-lab/./src/composables/addLandUse.ts","webpack://@cosmicds/tempo-lab/./src/components/MapWithControls.vue?1f2a","webpack://@cosmicds/tempo-lab/./src/components/MapWithControls.vue","webpack://@cosmicds/tempo-lab/./src/components/MapWithControls.vue?3721","webpack://@cosmicds/tempo-lab/./src/components/PopupInfoButton.vue?baf3","webpack://@cosmicds/tempo-lab/./src/components/PopupInfoButton.vue","webpack://@cosmicds/tempo-lab/./src/components/PopupInfoButton.vue?a321","webpack://@cosmicds/tempo-lab/./src/composables/useMaplibreLayerOrderControl.ts","webpack://@cosmicds/tempo-lab/./src/utils/names.ts","webpack://@cosmicds/tempo-lab/./src/components/NarrowExpansionPanel.vue?113e","webpack://@cosmicds/tempo-lab/./src/components/NarrowExpansionPanel.vue","webpack://@cosmicds/tempo-lab/./src/components/NarrowExpansionPanel.vue?b819","webpack://@cosmicds/tempo-lab/./src/components/LegendBase.vue?8bb9","webpack://@cosmicds/tempo-lab/./src/components/LegendBase.vue","webpack://@cosmicds/tempo-lab/./src/components/LegendBase.vue?7449","webpack://@cosmicds/tempo-lab/./src/components/LandUseLegend.vue?72ea","webpack://@cosmicds/tempo-lab/./src/components/LandUseLegend.vue","webpack://@cosmicds/tempo-lab/./src/components/LandUseLegend.vue?5336","webpack://@cosmicds/tempo-lab/./src/components/AQILegend.vue?020f","webpack://@cosmicds/tempo-lab/./src/components/AQILegend.vue","webpack://@cosmicds/tempo-lab/./src/components/AQILegend.vue?d144","webpack://@cosmicds/tempo-lab/./src/components/MiniLegend.vue?e858","webpack://@cosmicds/tempo-lab/./src/components/MiniLegend.vue","webpack://@cosmicds/tempo-lab/./src/components/MiniLegend.vue?8aa2","webpack://@cosmicds/tempo-lab/./src/components/PopDensLegend.vue?64e0","webpack://@cosmicds/tempo-lab/./src/components/PopDensLegend.vue","webpack://@cosmicds/tempo-lab/./src/components/PopDensLegend.vue?6245","webpack://@cosmicds/tempo-lab/./src/components/LayerOrderControl.vue?488e","webpack://@cosmicds/tempo-lab/./src/components/LayerOrderControl.vue","webpack://@cosmicds/tempo-lab/./src/components/LayerOrderControl.vue?a836","webpack://@cosmicds/tempo-lab/./src/composables/useMaplibreLayerOpacity.ts","webpack://@cosmicds/tempo-lab/./src/composables/useMaplibreLayerVisibility.ts","webpack://@cosmicds/tempo-lab/./src/components/MaplibreLayerControlItem.vue?fae7","webpack://@cosmicds/tempo-lab/./src/components/MaplibreLayerControlItem.vue","webpack://@cosmicds/tempo-lab/./src/components/MaplibreLayerControlItem.vue?697e","webpack://@cosmicds/tempo-lab/./src/components/PowerPlantsFilterControl.vue?d562","webpack://@cosmicds/tempo-lab/./src/components/PowerPlantsFilterControl.vue","webpack://@cosmicds/tempo-lab/./src/components/PowerPlantsFilterControl.vue?f078","webpack://@cosmicds/tempo-lab/./src/components/IconCheckbox.vue?ac16","webpack://@cosmicds/tempo-lab/./src/components/IconCheckbox.vue","webpack://@cosmicds/tempo-lab/./src/components/IconCheckbox.vue?bd66","webpack://@cosmicds/tempo-lab/./src/components/SaveState.vue?3117","webpack://@cosmicds/tempo-lab/./src/components/SaveState.vue","webpack://@cosmicds/tempo-lab/./src/components/SaveState.vue?6348","webpack://@cosmicds/tempo-lab/./src/components/SidePlaceholder.vue?fd78","webpack://@cosmicds/tempo-lab/./src/components/SidePlaceholder.vue","webpack://@cosmicds/tempo-lab/./src/components/SidePlaceholder.vue?b780","webpack://@cosmicds/tempo-lab/./src/main.ts","webpack://@cosmicds/tempo-lab/webpack/bootstrap","webpack://@cosmicds/tempo-lab/webpack/runtime/chunk loaded","webpack://@cosmicds/tempo-lab/webpack/runtime/compat get default export","webpack://@cosmicds/tempo-lab/webpack/runtime/define property getters","webpack://@cosmicds/tempo-lab/webpack/runtime/global","webpack://@cosmicds/tempo-lab/webpack/runtime/hasOwnProperty shorthand","webpack://@cosmicds/tempo-lab/webpack/runtime/make namespace object","webpack://@cosmicds/tempo-lab/webpack/runtime/publicPath","webpack://@cosmicds/tempo-lab/webpack/runtime/jsonp chunk loading","webpack://@cosmicds/tempo-lab/webpack/startup"],"sourcesContent":["// https://gis-fema.hub.arcgis.com/datasets/b063316fac7345dba4bae96eaa813b2f/explore?location=42.846684%2C-88.200094%2C9.54&showTable=true\n// https://gis-fema.hub.arcgis.com/datasets/b063316fac7345dba4bae96eaa813b2f/about\n// Captured Octo 16 2025\n/* eslint-disable @typescript-eslint/naming-convention */\n// Type Generated with \"Paste JSON as Code\" extension for VSCode\nexport interface PowerPlants {\n  X:               number;\n  Y:               number;\n  OBJECTID:        number;\n  Plant_Code:      number;\n  Plant_Name:      string;\n  Utility_ID:      number;\n  Utility_Name?:   string;\n  sector_name:     SectorName;\n  Street_Address?: string;\n  City?:           string;\n  County?:         string;\n  State:           State;\n  Zip?:            number;\n  PrimSource:      PrimSource;\n  source_desc:     string;\n  tech_desc:       string;\n  Install_MW:      number;\n  Total_MW?:       number;\n  Hydro_MW?:       number;\n  Source:          Source;\n  Period:          number;\n  Longitude:       number;\n  Latitude:        number;\n  Coal_MW?:        number;\n  NG_MW?:          number;\n  Crude_MW?:       number;\n  Nuclear_MW?:     number;\n  HydroPS_MW?:     number;\n  Bat_MW?:         number;\n  Solar_MW?:       number;\n  Geo_MW?:         number;\n  Bio_MW?:         number;\n  Wind_MW?:        number;\n  Other_MW?:       number;\n}\n\n\n// custom groups for green and traditional sources\nexport enum RenewableSource {\n  Biomass = \"biomass\",\n  Geothermal = \"geothermal\",\n  Hydroelectric = \"hydroelectric\",\n  Solar = \"solar\",\n  Wind = \"wind\",\n}\n\nexport enum TraditionalSource {\n  Coal = \"coal\",\n  NaturalGas = \"natural gas\",\n  Petroleum = \"petroleum\",\n}\n\nexport enum PrimSource {\n  Batteries = \"batteries\",\n  Biomass = \"biomass\",\n  Coal = \"coal\",\n  Geothermal = \"geothermal\",\n  Hydroelectric = \"hydroelectric\",\n  NaturalGas = \"natural gas\",\n  Nuclear = \"nuclear\",\n  Other = \"other\",\n  Petroleum = \"petroleum\",\n  PumpedStorage = \"pumped storage\",\n  Solar = \"solar\",\n  Wind = \"wind\",\n}\n\nexport const TraditionalSources = [PrimSource.Coal, PrimSource.NaturalGas, PrimSource.Petroleum] as const;\nexport const RenewableSources = [PrimSource.Biomass, PrimSource.Geothermal, PrimSource.Hydroelectric, PrimSource.Solar, PrimSource.Wind] as const;\n\nexport enum Source {\n  EIA860EIA860MAndEIA923 = \"EIA-860, EIA-860M and EIA-923\",\n}\n\nexport enum State {\n  Alabama = \"Alabama\",\n  Alaska = \"Alaska\",\n  Arizona = \"Arizona\",\n  Arkansas = \"Arkansas\",\n  California = \"California\",\n  Colorado = \"Colorado\",\n  Connecticut = \"Connecticut\",\n  Delaware = \"Delaware\",\n  Florida = \"Florida\",\n  Georgia = \"Georgia\",\n  Hawaii = \"Hawaii\",\n  Idaho = \"Idaho\",\n  Illinois = \"Illinois\",\n  Indiana = \"Indiana\",\n  Iowa = \"Iowa\",\n  Kansas = \"Kansas\",\n  Kentucky = \"Kentucky\",\n  Louisiana = \"Louisiana\",\n  Maine = \"Maine\",\n  Maryland = \"Maryland\",\n  Massachusetts = \"Massachusetts\",\n  Michigan = \"Michigan\",\n  Minnesota = \"Minnesota\",\n  Mississippi = \"Mississippi\",\n  Missouri = \"Missouri\",\n  Montana = \"Montana\",\n  Nebraska = \"Nebraska\",\n  Nevada = \"Nevada\",\n  NewHampshire = \"New Hampshire\",\n  NewJersey = \"New Jersey\",\n  NewMexico = \"New Mexico\",\n  NewYork = \"New York\",\n  NorthCarolina = \"North Carolina\",\n  NorthDakota = \"North Dakota\",\n  Ohio = \"Ohio\",\n  Oklahoma = \"Oklahoma\",\n  Oregon = \"Oregon\",\n  Pennsylvania = \"Pennsylvania\",\n  PuertoRico = \"Puerto Rico\",\n  RhodeIsland = \"Rhode Island\",\n  SouthCarolina = \"South Carolina\",\n  SouthDakota = \"South Dakota\",\n  Tennessee = \"Tennessee\",\n  Texas = \"Texas\",\n  Utah = \"Utah\",\n  Vermont = \"Vermont\",\n  Virginia = \"Virginia\",\n  Washington = \"Washington\",\n  WestVirginia = \"West Virginia\",\n  Wisconsin = \"Wisconsin\",\n  Wyoming = \"Wyoming\",\n}\n\nexport enum SectorName {\n  CommercialCHP = \"Commercial CHP\",\n  CommercialNonCHP = \"Commercial Non-CHP\",\n  ElectricUtility = \"Electric Utility\",\n  IPPChp = \"IPP CHP\",\n  IPPNonCHP = \"IPP Non-CHP\",\n  IndustrialCHP = \"Industrial CHP\",\n  IndustrialNonCHP = \"Industrial Non-CHP\",\n}\n\n\n\n// import from the \"Power_Plants_records.json\"\nimport powerPlantsData from './Power_Plants_records.json' assert { type: 'json' };\n\n// Cast the imported data to the PowerPlants array type\nexport const powerPlants: PowerPlants[] = powerPlantsData as PowerPlants[];\n\nexport const powerPlantsGeoJSON: GeoJSON.FeatureCollection = {\n  type: \"FeatureCollection\",\n  features: powerPlants.map(plant => ({\n    type: \"Feature\",\n    geometry: {\n      type: \"Point\",\n      coordinates: [plant.Longitude, plant.Latitude],\n    },\n    properties: { ...plant },\n  })),\n};\n","import { resolveComponent as _resolveComponent, createVNode as _createVNode, renderSlot as _renderSlot, vShow as _vShow, withDirectives as _withDirectives, withKeys as _withKeys, normalizeClass as _normalizeClass, withCtx as _withCtx, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_font_awesome_icon = _resolveComponent(\"font-awesome-icon\")!\n  const _component_v_combobox = _resolveComponent(\"v-combobox\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"forward-geocoding-container\",\n    style: _normalizeStyle(_ctx.cssStyles)\n  }, [\n    _withDirectives(_createVNode(_component_v_combobox, {\n      class: _normalizeClass(['forward-geocoding-input', _ctx.locationJustUpdated ? 'geocode-success' : '', _ctx.small ? 'forward-geocoding-input-small' : '']),\n      modelValue: _ctx.searchText,\n      \"onUpdate:modelValue\": [\n        _cache[0] || (_cache[0] = ($event: any) => ((_ctx.searchText) = $event)),\n        _ctx.setLocationFromSearchFeature\n      ],\n      items: _ctx.searchResults ? _ctx.searchResults.features : [],\n      \"item-title\": _ctx.textForMapboxFeature,\n      \"bg-color\": _ctx.bgColor,\n      label: \"Enter city or zip\",\n      density: _ctx.small ? 'compact' : 'default',\n      \"hide-details\": \"\",\n      solo: \"\",\n      color: _ctx.accentColor,\n      onInput: () => {},\n      onKeydown: [\n        _withKeys(_ctx.performForwardGeocodingSearch, [\"enter\"]),\n        _cache[1] || (_cache[1] = _withKeys(($event: any) => (_ctx.searchResults = null), [\"esc\"]))\n      ],\n      \"error-messages\": _ctx.searchErrorMessage,\n      \"onClick:append\": _ctx.focusCombobox,\n      \"onUpdate:focused\": _cache[2] || (_cache[2] = ($event: any) => (_ctx.onFocusChange($event))),\n      ref: \"searchInput\",\n      menu: _ctx.menuOpen,\n      \"onUpdate:menu\": _cache[3] || (_cache[3] = ($event: any) => (_ctx.menuOpen = $event))\n    }, {\n      append: _withCtx(() => [\n        _createVNode(_component_font_awesome_icon, {\n          class: \"geocoding-search-icon\",\n          icon: \"magnifying-glass\",\n          size: _ctx.searchOpen ? 'xl' : _ctx.buttonSize,\n          color: \"gray\",\n          onClick: _ctx.toggleSearch\n        }, null, 8, [\"size\", \"onClick\"]),\n        _renderSlot(_ctx.$slots, \"append-icon\", { class: \"geocode-icon\" }),\n        _withDirectives(_createVNode(_component_font_awesome_icon, {\n          class: \"geocoding-close-icon\",\n          icon: \"circle-xmark\",\n          size: _ctx.searchOpen ? 'xl' : '1x',\n          color: \"gray\",\n          onClick: _ctx.closeSearch\n        }, null, 8, [\"size\", \"onClick\"]), [\n          [_vShow, _ctx.searchOpen && !_ctx.stayOpen]\n        ])\n      ]),\n      _: 3\n    }, 8, [\"class\", \"modelValue\", \"items\", \"item-title\", \"bg-color\", \"density\", \"color\", \"onUpdate:modelValue\", \"onKeydown\", \"error-messages\", \"onClick:append\", \"menu\"]), [\n      [_vShow, _ctx.searchOpen]\n    ]),\n    _withDirectives(_createVNode(_component_font_awesome_icon, {\n      class: \"geocoding-search-icon\",\n      icon: \"magnifying-glass\",\n      size: _ctx.searchOpen ? 'xl' : _ctx.buttonSize,\n      color: \"gray\",\n      onClick: _withModifiers(_ctx.toggleSearch, [\"prevent\"])\n    }, null, 8, [\"size\", \"onClick\"]), [\n      [_vShow, !_ctx.searchOpen && !_ctx.stayOpen]\n    ])\n  ], 4))\n}","<template>\n  <div class=\"forward-geocoding-container\" :style=\"cssStyles\">\n    <v-combobox\n      v-show=\"searchOpen\"\n      :class=\"['forward-geocoding-input', locationJustUpdated ? 'geocode-success' : '', small ? 'forward-geocoding-input-small' : '']\"\n      v-model=\"searchText\"\n      :items=\"searchResults ? searchResults.features : []\"\n      :item-title=\"textForMapboxFeature\"\n      :bg-color=\"bgColor\"\n      label=\"Enter city or zip\"\n      :density=\"small ? 'compact' : 'default'\"\n      hide-details\n      solo\n      :color=\"accentColor\"\n      @input=\"() => {}\"\n      @update:model-value=\"setLocationFromSearchFeature\"\n      @keydown.enter=\"performForwardGeocodingSearch\"\n      @keydown.esc=\"searchResults = null\"\n      :error-messages=\"searchErrorMessage\"\n      @click:append=\"focusCombobox\"\n      @update:focused=\"onFocusChange($event)\"\n      ref=\"searchInput\"\n      :menu=\"menuOpen\"\n      @update:menu=\"menuOpen = $event\"\n    >\n    <template v-slot:append>\n      <font-awesome-icon\n        class=\"geocoding-search-icon\"\n        icon=\"magnifying-glass\"\n        :size=\"searchOpen ? 'xl' : buttonSize\"\n        color=\"gray\"\n        @click=\"toggleSearch\"\n      ></font-awesome-icon>\n\n      <slot name=\"append-icon\" class=\"geocode-icon\"></slot>\n\n      <font-awesome-icon\n        class=\"geocoding-close-icon\"\n        v-show=\"searchOpen && !stayOpen\"\n        icon=\"circle-xmark\"\n        :size=\"searchOpen ? 'xl' : '1x'\"\n        color=\"gray\"\n        @click=\"closeSearch\"\n      ></font-awesome-icon>\n    </template>\n  </v-combobox>\n  <font-awesome-icon\n      v-show=\"!searchOpen && !stayOpen\"\n      class=\"geocoding-search-icon\"\n      icon=\"magnifying-glass\"\n      :size=\"searchOpen ? 'xl' : buttonSize\"\n      color=\"gray\"\n      @click.prevent=\"toggleSearch\"\n    ></font-awesome-icon>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { MapBoxFeatureCollection, MapBoxFeature, textForMapboxFeature } from \"@/mapbox\";\n\ntype SearchProvider = (searchText: string) => Promise<MapBoxFeatureCollection | null>;\n\nexport default defineComponent({\n  name: 'LocationSearch',\n\n  emits: ['update:modelValue', 'set-location', 'error', 'geolocate'],\n\n  props: {\n    searchProvider: {\n      type: Function as PropType<SearchProvider>,\n      default: () => {}\n    },\n    modelValue: {\n      type: Boolean,\n      default: true,\n      required: false,\n    },\n    stayOpen: {\n      type: Boolean,\n      default: false,\n    },\n    accentColor: {\n      type: String,\n      default: 'white',\n    },\n    small: {\n      type: Boolean,\n      default: false,\n    },\n    theme: {\n      type: String,\n      default: 'dark',\n    },\n    buttonSize: {\n      type: String,\n      default: '1x',\n    },\n    \n    bgColor: {\n      type: String,\n      default: 'white',\n    },\n    \n    persistSelected: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  \n  data() {\n    return {\n      searchOpen: this.modelValue || this.stayOpen,\n      searchText: null as string | null,\n      searchResults: null as MapBoxFeatureCollection | null,\n      searchErrorMessage: null as string | null,\n      locationJustUpdated: false,\n      locationUpdatedText: 'Location updated',\n      comboFocused: false,\n      menuOpen: false,\n    };\n  },\n\n  computed: {\n    cssStyles() {\n      return {\n        '--accent-color': this.accentColor,\n        '--bg-color': this.bgColor,\n        '--fg-container-padding': this.searchOpen ? (this.small ? '0px 5px 0px 0px' : '5px 10px 12px 10px') : '0px',\n        '--border-radius': this.searchOpen ? '7px' : '20px',\n      };\n    },\n  },\n  \n  \n  \n\n  \n  methods: {\n    performForwardGeocodingSearch() {\n      console.log('performForwardGeocodingSearch', this.searchText);\n      if (this.searchText === null || this.searchText.length < 3) {\n        return;\n      }\n      this.searchProvider(this.searchText).then((info) => {\n        if (info !== null && info.features?.length === 1) {\n          this.setLocationFromSearchFeature(info.features[0]);\n        } else if (info !== null && info.features?.length == 0) {\n          this.searchErrorMessage = \"No matching places were found\";\n          console.log('No matching places were found');\n          this.$emit('error', this.searchErrorMessage);\n        } else {\n          this.searchResults = info;\n        }\n      });\n    },\n    \n    textForMapboxFeature(feature: MapBoxFeature) {\n      if (typeof feature === 'string') {\n        return;\n      }\n      return textForMapboxFeature(feature);\n    },\n    \n       \n    onFocusChange(focused: boolean) {\n      console.log('focus change', focused);\n      this.comboFocused = focused;\n      // if (!focused && this.searchResults === null) {\n      //   this.searchText = null;\n      // }\n    },\n    \n    blurCombobox() {\n      console.log('blurring');\n      const input = this.$refs.searchInput as HTMLInputElement;\n      console.log(input);\n      input.blur();\n    },\n    \n    focusCombobox() {\n      const input = this.$refs.searchInput as HTMLInputElement;\n      input.focus();\n    },\n    \n    setLocationFromSearchFeature(feature: MapBoxFeature | string) {\n      // if it's a string do nothing\n      if (typeof feature === 'string') {\n        return;\n      }\n      console.log('setting location');\n      if (feature === null) { return; }\n      const name = this.textForMapboxFeature(feature);\n      if (name !== undefined) {\n        this.locationUpdatedText = name;\n      } else {\n        this.locationUpdatedText = feature.place_name.split(',').slice(0, 2).join(', ');\n      }\n      \n      // blur (defocus) the v-combobox\n      this.blurCombobox();\n      this.timedJustUpdatedLocation();\n      this.clearSearchData();\n      this.$emit('set-location', [feature, this.locationUpdatedText]);\n    },\n\n    toggleSearch() {\n      console.log('toggleSearch', this.searchOpen, this.searchText);\n      if (this.searchOpen) {\n        this.performForwardGeocodingSearch();\n        // this.$nextTick(() => this.focusCombobox());\n        this.menuOpen = true;\n        this.focusCombobox();\n      } else {\n        this.searchOpen = true;\n      }\n    },\n\n    closeSearch() {\n      this.searchOpen = false;\n      this.clearSearchData();\n    },\n\n    clearSearchData() {\n      this.searchResults = null;\n      this.searchText = null;\n      this.searchErrorMessage = null;\n    },\n    \n    timedJustUpdatedLocation() {\n      this.locationJustUpdated = true;\n      setTimeout(() => {\n        this.locationJustUpdated = this.persistSelected;\n      }, 5000);\n    },\n  },\n  \n  watch: {\n    \n    modelValue(value: boolean) {\n      this.searchOpen = value;\n    },\n    \n    searchOpen(value: boolean) {\n      this.$emit('update:modelValue', value);\n    },\n    \n    searchText(text: string | null) {\n      if (this.searchErrorMessage) {\n        this.searchErrorMessage = null;\n      }\n      if (!text || text.length === 0) {\n        this.searchResults = null;\n      }\n    },\n  }\n  \n});\n\n</script>\n\n\n<style lang=\"less\">\n\n// https://vue-loader.vuejs.org/guide/scoped-css.html#deep-selectors\n.forward-geocoding-container {\n  --border-radius: 20px;\n  position: relative;\n  color: var(--accent-color);\n  background-color: rgba(255, 255, 255, 0.4);\n  border-radius: var(--border-radius);\n  margin-left: 0.25rem;\n  margin-bottom: 0.25rem;\n  padding: var(--fg-container-padding);\n  backdrop-filter: blur(2px);\n\n  .v-field {\n    background-color: transparent !important;\n  }\n\n  // there are two separate labels, we want the 2nd one to be large. the first is the small floating label\n  .v-field > .v-field__field > .v-label.v-field-label:nth-child(2) {\n    font-size: 1.2rem;\n  }\n\n  // .v-input--horizontal .v-input__append {\n  //   margin-inline-start: 0;\n  // }\n  \n  .v-text-field {\n    min-width: 150px;\n  }\n  \n  .v-field--variant-filled.v-field--has-background .v-field__overlay {\n    border-top-right-radius: 0px;\n}\n\n  .forward-geocoding-input > .v-input__control > .v-field {\n    border-radius: var(--border-radius);\n  }\n  \n  .forward-geocoding-input.geocode-success label {\n    opacity: 1;\n  }\n  \n  .forward-geocoding-input-small label {\n    // .v-label sets default to 1rem\n    font-size: 0.8rem;\n  }\n\n  .forward-geocoding-input-row {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-around;\n    gap: 10px;\n    align-items: center;\n  }\n  \n  .geocoding-search-icon {\n    padding-inline: calc(0.3 * var(--default-line-height));\n    padding-block: calc(0.4 * var(--default-line-height));\n  }\n\n  .geocoding-search-icon:hover, #geocoding-close-icon:hover {\n    cursor: pointer;\n  }\n\n}\n</style>\n","export interface MapBoxContextItem {\n  id: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  mapbox_id: string;\n  text: string;\n  wikidata: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  short_code?: string;\n}\n\n// The field names here come from MapBox\nexport interface MapBoxFeature {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  place_type: string[];\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  place_name: string;\n  text?: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  properties: { short_code: string; };\n  center: [number, number];\n  context: MapBoxContextItem[];\n}\n\nexport interface MapBoxFeatureCollection {\n  type: \"FeatureCollection\";\n  features: MapBoxFeature[];\n}\n\n// TODO: Add more options as we need them\n// See https://docs.mapbox.com/api/search/geocoding-v6/#forward-geocoding-with-search-text-input\nexport interface MapBoxForwardGeocodingOptions {\n  // For countries, use the ISO 3166-1 alpha-2 country codes:\n  // https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2\n  countries?: string[];\n  types?: string[];\n  limit?: number;\n}\n\nconst RELEVANT_FEATURE_TYPES = [\"postcode\", \"place\", \"region\", \"country\"];\nconst NA_COUNTRIES = [\"United States\", \"Canada\", \"Mexico\"];\nconst NA_ABBREVIATIONS = [\"US-\", \"CA-\", \"MX-\"];\n\nexport function findBestFeature(collection: MapBoxFeatureCollection): MapBoxFeature | null {\n  const relevantFeatures = collection.features.filter(feature => RELEVANT_FEATURE_TYPES.some(type => feature.place_type.includes(type)));\n  const placeFeature = relevantFeatures.find(feature => feature.place_type.includes(\"place\")) ?? (relevantFeatures.find(feature => feature.place_type.includes(\"postcode\")) ?? undefined);\n  if (placeFeature !== undefined) {\n    return placeFeature;\n  }\n  const regionFeature = relevantFeatures.find(feature => feature.place_type.includes(\"region\"));\n  if (regionFeature !== undefined) {\n    return regionFeature;\n  }\n  const countryFeature = relevantFeatures.find(feature => feature.place_type.includes(\"country\"));\n  if (countryFeature !== undefined) {\n    return countryFeature;\n  }\n  return null;\n}\n\nexport function textForMapboxFeature(feature: MapBoxFeature): string {\n  const pieces: string[] = [];\n  if (feature.text) {\n    pieces.push(feature.text);\n  }\n  feature.context.forEach(item => {\n    const itemType = item.id.split(\".\")[0];\n    if (!RELEVANT_FEATURE_TYPES.includes(itemType)) {\n      return;\n    }\n    let text = null as string | null;\n    const shortCode = item.short_code;\n    if (itemType === \"region\" && shortCode != null) {\n      if (NA_ABBREVIATIONS.some(abbr => shortCode.startsWith(abbr))) {\n        text = shortCode.substring(3);\n      }\n    } else if (itemType === \"country\") {\n      const itemText = item.text;\n      if (!NA_COUNTRIES.includes(itemText)) {\n        text = itemText; \n      }\n    }\n    if (text !== null) {\n      pieces.push(text);\n    }\n  });\n  return pieces.join(\", \");\n}\n\nexport function textForMapboxResults(results: MapBoxFeatureCollection): string {\n  const feature = findBestFeature(results);\n  return feature !== null ? textForMapboxFeature(feature) : \"\";\n}\n\nexport async function textForLocation(longitudeDeg: number, latitudeDeg: number): Promise<string> {\n  const accessToken = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${longitudeDeg},${latitudeDeg}.json?access_token=${accessToken}`;\n  return fetch(url)\n    .then(response => response.json())\n    .then((result: MapBoxFeatureCollection) => {\n      if (result.features.length === 0) {\n        const ns = latitudeDeg >= 0 ? 'N' : 'S';\n        const ew = longitudeDeg >= 0 ? 'E' : 'W';\n        const lat = Math.abs(latitudeDeg).toFixed(3);\n        const lon = Math.abs(longitudeDeg).toFixed(3);\n        return `${lat} ${ns}, ${lon} ${ew}`;\n      }\n      return textForMapboxResults(result);\n    });\n}\n\nexport async function geocodingInfoForSearch(searchText: string, options?: MapBoxForwardGeocodingOptions): Promise<MapBoxFeatureCollection> {\n  const accessToken = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  const search = new URLSearchParams();\n  search.set(\"access_token\", accessToken ?? \"\");\n  const types = (options?.types ?? [\"place\", \"postcode\"]).join(\",\");\n  search.set(\"types\", types);\n  if (options?.countries) {\n    search.set(\"country\", options.countries.join(\",\"));\n  }\n  search.set(\"limit\", options?.limit?.toString() ?? \"5\");\n  const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${searchText}.json?${search.toString()}`;\n  return fetch(url).then(response => response.json());\n}\n","import { render } from \"./LocationSearch.vue?vue&type=template&id=19e84937&ts=true\"\nimport script from \"./LocationSearch.vue?vue&type=script&lang=ts\"\nexport * from \"./LocationSearch.vue?vue&type=script&lang=ts\"\n\nimport \"./LocationSearch.vue?vue&type=style&index=0&id=19e84937&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { isRef, type ComputedRef } from \"vue\";\n\nexport function isComputedRef(ref: unknown): ref is ComputedRef {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-expect-error A general `Ref` won't have `effect`\n  return isRef(ref) && !!ref.effect;\n}\n","\nimport type { ColorMap } from \"./types\";\n\nexport const magma: ColorMap = {\n  r: [0.001462, 0.002258, 0.003279, 0.004512, 0.00595, 0.007588, 0.009426, 0.011465, 0.013708, 0.016156, 0.018815, 0.021692, 0.024792, 0.028123, 0.031696, 0.03552, 0.039608, 0.04383, 0.048062, 0.05232, 0.056615, 0.060949, 0.06533, 0.069764, 0.074257, 0.078815, 0.083446, 0.088155, 0.092949, 0.097833, 0.102815, 0.107899, 0.113094, 0.118405, 0.123833, 0.12938, 0.135053, 0.140858, 0.146785, 0.152839, 0.159018, 0.165308, 0.171713, 0.178212, 0.184801, 0.19146, 0.198177, 0.204935, 0.211718, 0.218512, 0.225302, 0.232077, 0.238826, 0.245543, 0.25222, 0.258857, 0.265447, 0.271994, 0.278493, 0.284951, 0.291366, 0.29774, 0.304081, 0.310382, 0.316654, 0.322899, 0.329114, 0.335308, 0.341482, 0.347636, 0.353773, 0.359898, 0.366012, 0.372116, 0.378211, 0.384299, 0.390384, 0.396467, 0.402548, 0.408629, 0.414709, 0.420791, 0.426877, 0.432967, 0.439062, 0.445163, 0.451271, 0.457386, 0.463508, 0.46964, 0.47578, 0.481929, 0.488088, 0.494258, 0.500438, 0.506629, 0.512831, 0.519045, 0.52527, 0.531507, 0.537755, 0.544015, 0.550287, 0.556571, 0.562866, 0.569172, 0.57549, 0.581819, 0.588158, 0.594508, 0.600868, 0.607238, 0.613617, 0.620005, 0.626401, 0.632805, 0.639216, 0.645633, 0.652056, 0.658483, 0.664915, 0.671349, 0.677786, 0.684224, 0.690661, 0.697098, 0.703532, 0.709962, 0.716387, 0.722805, 0.729216, 0.735616, 0.742004, 0.748378, 0.754737, 0.761077, 0.767398, 0.773695, 0.779968, 0.786212, 0.792427, 0.798608, 0.804752, 0.810855, 0.816914, 0.822926, 0.828886, 0.834791, 0.840636, 0.846416, 0.852126, 0.857763, 0.86332, 0.868793, 0.874176, 0.879464, 0.884651, 0.889731, 0.8947, 0.899552, 0.904281, 0.908884, 0.913354, 0.917689, 0.921884, 0.925937, 0.929845, 0.933606, 0.937221, 0.940687, 0.944006, 0.94718, 0.95021, 0.953099, 0.955849, 0.958464, 0.960949, 0.96331, 0.965549, 0.967671, 0.96968, 0.971582, 0.973381, 0.975082, 0.97669, 0.97821, 0.979645, 0.981, 0.982279, 0.983485, 0.984622, 0.985693, 0.9867, 0.987646, 0.988533, 0.989363, 0.990138, 0.990871, 0.991558, 0.992196, 0.992785, 0.993326, 0.993834, 0.994309, 0.994738, 0.995122, 0.99548, 0.99581, 0.996096, 0.996341, 0.99658, 0.996775, 0.996925, 0.997077, 0.997186, 0.997254, 0.997325, 0.997351, 0.997351, 0.997341, 0.997285, 0.997228, 0.997138, 0.997019, 0.996898, 0.996727, 0.996571, 0.996369, 0.996162, 0.995932, 0.99568, 0.995424, 0.995131, 0.994851, 0.994524, 0.994222, 0.993866, 0.993545, 0.99317, 0.992831, 0.99244, 0.992089, 0.991688, 0.991332, 0.99093, 0.99057, 0.990175, 0.989815, 0.989434, 0.989077, 0.988717, 0.988367, 0.988033, 0.987691, 0.987387, 0.987053],\n  g: [0.000466, 0.001295, 0.002305, 0.00349, 0.004843, 0.006356, 0.008022, 0.009828, 0.011771, 0.01384, 0.016026, 0.01832, 0.020715, 0.023201, 0.025765, 0.028397, 0.03109, 0.03383, 0.036607, 0.039407, 0.04216, 0.044794, 0.047318, 0.049726, 0.052017, 0.054184, 0.056225, 0.058133, 0.059904, 0.061531, 0.06301, 0.064335, 0.065492, 0.066479, 0.067295, 0.067935, 0.068391, 0.068654, 0.068738, 0.068637, 0.068354, 0.067911, 0.067305, 0.066576, 0.065732, 0.064818, 0.063862, 0.062907, 0.061992, 0.061158, 0.060445, 0.059889, 0.059517, 0.059352, 0.059415, 0.059706, 0.060237, 0.060994, 0.061978, 0.063168, 0.064553, 0.066117, 0.067835, 0.069702, 0.07169, 0.073782, 0.075972, 0.078236, 0.080564, 0.082946, 0.085373, 0.087831, 0.090314, 0.092816, 0.095332, 0.097855, 0.100379, 0.102902, 0.10542, 0.10793, 0.110431, 0.11292, 0.115395, 0.117855, 0.120298, 0.122724, 0.125132, 0.127522, 0.129893, 0.132245, 0.134577, 0.136891, 0.139186, 0.141462, 0.143719, 0.145958, 0.148179, 0.150383, 0.152569, 0.154739, 0.156894, 0.159033, 0.161158, 0.163269, 0.165368, 0.167454, 0.16953, 0.171596, 0.173652, 0.175701, 0.177743, 0.179779, 0.181811, 0.18384, 0.185867, 0.187893, 0.189921, 0.191952, 0.193986, 0.196027, 0.198075, 0.200133, 0.202203, 0.204286, 0.206384, 0.208501, 0.210638, 0.212797, 0.214982, 0.217194, 0.219437, 0.221713, 0.224025, 0.226377, 0.228772, 0.231214, 0.233705, 0.236249, 0.238851, 0.241514, 0.244242, 0.24704, 0.249911, 0.252861, 0.255895, 0.259016, 0.262229, 0.26554, 0.268953, 0.272473, 0.276106, 0.279857, 0.283729, 0.287728, 0.291859, 0.296125, 0.30053, 0.305079, 0.309773, 0.314616, 0.31961, 0.324755, 0.330052, 0.3355, 0.341098, 0.346844, 0.352734, 0.358764, 0.364929, 0.371224, 0.377643, 0.384178, 0.39082, 0.397563, 0.4044, 0.411324, 0.418323, 0.42539, 0.432519, 0.439703, 0.446936, 0.45421, 0.46152, 0.468861, 0.476226, 0.483612, 0.491014, 0.498428, 0.505851, 0.51328, 0.520713, 0.528148, 0.535582, 0.543015, 0.550446, 0.557873, 0.565296, 0.572706, 0.580107, 0.587502, 0.594891, 0.602275, 0.609644, 0.616999, 0.62435, 0.631696, 0.639027, 0.646344, 0.653659, 0.660969, 0.668256, 0.675541, 0.682828, 0.690088, 0.697349, 0.704611, 0.711848, 0.719089, 0.726324, 0.733545, 0.740772, 0.747981, 0.75519, 0.762398, 0.769591, 0.776795, 0.783977, 0.791167, 0.798348, 0.805527, 0.812706, 0.819875, 0.827052, 0.834213, 0.841387, 0.84854, 0.855711, 0.862859, 0.870024, 0.877168, 0.88433, 0.89147, 0.898627, 0.905763, 0.912915, 0.920049, 0.927196, 0.934329, 0.94147, 0.948604, 0.955742, 0.962878, 0.970012, 0.977154, 0.984288, 0.991438],\n  b: [0.013866, 0.018331, 0.023708, 0.029965, 0.03713, 0.044973, 0.052844, 0.06075, 0.068667, 0.076603, 0.084584, 0.09261, 0.100676, 0.108787, 0.116965, 0.125209, 0.133515, 0.141886, 0.150327, 0.158841, 0.167446, 0.176129, 0.184892, 0.193735, 0.20266, 0.211667, 0.220755, 0.229922, 0.239164, 0.248477, 0.257854, 0.267289, 0.276784, 0.286321, 0.295879, 0.305443, 0.315, 0.324538, 0.334011, 0.343404, 0.352688, 0.361816, 0.370771, 0.379497, 0.387973, 0.396152, 0.404009, 0.411514, 0.418647, 0.425392, 0.431742, 0.437695, 0.443256, 0.448436, 0.453248, 0.45771, 0.46184, 0.46566, 0.46919, 0.472451, 0.475462, 0.478243, 0.480812, 0.483186, 0.48538, 0.487408, 0.489287, 0.491024, 0.492631, 0.494121, 0.495501, 0.496778, 0.49796, 0.499053, 0.500067, 0.501002, 0.501864, 0.502658, 0.503386, 0.504052, 0.504662, 0.505215, 0.505714, 0.50616, 0.506555, 0.506901, 0.507198, 0.507448, 0.507652, 0.507809, 0.507921, 0.507989, 0.508011, 0.507988, 0.50792, 0.507806, 0.507648, 0.507443, 0.507192, 0.506895, 0.506551, 0.506159, 0.505719, 0.50523, 0.504692, 0.504105, 0.503466, 0.502777, 0.502035, 0.501241, 0.500394, 0.499492, 0.498536, 0.497524, 0.496456, 0.495332, 0.49415, 0.49291, 0.491611, 0.490253, 0.488836, 0.487358, 0.485819, 0.484219, 0.482558, 0.480835, 0.479049, 0.477201, 0.47529, 0.473316, 0.471279, 0.46918, 0.467018, 0.464794, 0.462509, 0.460162, 0.457755, 0.455289, 0.452765, 0.450184, 0.447543, 0.444848, 0.442102, 0.439305, 0.436461, 0.433573, 0.430644, 0.427671, 0.424666, 0.421631, 0.418573, 0.415496, 0.412403, 0.409303, 0.406205, 0.403118, 0.400047, 0.397002, 0.393995, 0.391037, 0.388137, 0.385308, 0.382563, 0.379915, 0.377376, 0.374959, 0.372677, 0.370541, 0.368567, 0.366762, 0.365136, 0.363701, 0.362468, 0.361438, 0.360619, 0.360014, 0.35963, 0.359469, 0.359529, 0.35981, 0.360311, 0.36103, 0.361965, 0.363111, 0.364466, 0.366025, 0.367783, 0.369734, 0.371874, 0.374198, 0.376698, 0.379371, 0.38221, 0.38521, 0.388365, 0.391671, 0.395122, 0.398714, 0.402441, 0.406299, 0.410283, 0.41439, 0.418613, 0.42295, 0.427397, 0.431951, 0.436607, 0.441361, 0.446213, 0.45116, 0.456192, 0.461314, 0.466526, 0.471811, 0.477182, 0.482635, 0.488154, 0.493755, 0.499428, 0.505167, 0.510983, 0.516859, 0.522806, 0.528821, 0.534892, 0.541039, 0.547233, 0.553499, 0.55982, 0.566202, 0.572645, 0.57914, 0.585701, 0.592307, 0.598983, 0.605696, 0.612482, 0.619299, 0.626189, 0.633109, 0.640099, 0.647116, 0.654202, 0.661309, 0.668481, 0.675675, 0.682926, 0.690198, 0.697519, 0.704863, 0.712242, 0.719649, 0.727077, 0.734536, 0.742002, 0.749504]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const inferno: ColorMap = {\n  r: [0.001462, 0.002267, 0.003299, 0.004547, 0.006006, 0.007676, 0.009561, 0.011663, 0.013995, 0.016561, 0.019373, 0.022447, 0.025793, 0.029432, 0.033385, 0.037668, 0.042253, 0.046915, 0.051644, 0.056449, 0.06134, 0.066331, 0.071429, 0.076637, 0.081962, 0.087411, 0.09299, 0.098702, 0.104551, 0.110536, 0.116656, 0.122908, 0.129285, 0.135778, 0.142378, 0.149073, 0.15585, 0.162689, 0.169575, 0.176493, 0.183429, 0.190367, 0.197297, 0.204209, 0.211095, 0.217949, 0.224763, 0.231538, 0.238273, 0.244967, 0.25162, 0.258234, 0.26481, 0.271347, 0.27785, 0.284321, 0.290763, 0.297178, 0.303568, 0.309935, 0.316282, 0.32261, 0.328921, 0.335217, 0.3415, 0.347771, 0.354032, 0.360284, 0.366529, 0.372768, 0.379001, 0.385228, 0.391453, 0.397674, 0.403894, 0.410113, 0.416331, 0.422549, 0.428768, 0.434987, 0.441207, 0.447428, 0.453651, 0.459875, 0.4661, 0.472328, 0.478558, 0.484789, 0.491022, 0.497257, 0.503493, 0.50973, 0.515967, 0.522206, 0.528444, 0.534683, 0.54092, 0.547157, 0.553392, 0.559624, 0.565854, 0.572081, 0.578304, 0.584521, 0.590734, 0.59694, 0.603139, 0.60933, 0.615513, 0.621685, 0.627847, 0.633998, 0.640135, 0.64626, 0.652369, 0.658463, 0.66454, 0.670599, 0.676638, 0.682656, 0.688653, 0.694627, 0.700576, 0.7065, 0.712396, 0.718264, 0.724103, 0.729909, 0.735683, 0.741423, 0.747127, 0.752794, 0.758422, 0.76401, 0.769556, 0.775059, 0.780517, 0.785929, 0.791293, 0.796607, 0.801871, 0.807082, 0.812239, 0.817341, 0.822386, 0.827372, 0.832299, 0.837165, 0.841969, 0.846709, 0.851384, 0.855992, 0.860533, 0.865006, 0.869409, 0.873741, 0.878001, 0.882188, 0.886302, 0.890341, 0.894305, 0.898192, 0.902003, 0.905735, 0.90939, 0.912966, 0.916462, 0.919879, 0.923215, 0.92647, 0.929644, 0.932737, 0.935747, 0.938675, 0.941521, 0.944285, 0.946965, 0.949562, 0.952075, 0.954506, 0.956852, 0.959114, 0.961293, 0.963387, 0.965397, 0.967322, 0.969163, 0.970919, 0.97259, 0.974176, 0.975677, 0.977092, 0.978422, 0.979666, 0.980824, 0.981895, 0.982881, 0.983779, 0.984591, 0.985315, 0.985952, 0.986502, 0.986964, 0.987337, 0.987622, 0.987819, 0.987926, 0.987945, 0.987874, 0.987714, 0.987464, 0.987124, 0.986694, 0.986175, 0.985566, 0.984865, 0.984075, 0.983196, 0.982228, 0.981173, 0.980032, 0.978806, 0.977497, 0.976108, 0.974638, 0.973088, 0.971468, 0.969783, 0.968041, 0.966243, 0.964394, 0.962517, 0.960626, 0.95872, 0.956834, 0.954997, 0.953215, 0.951546, 0.950018, 0.948683, 0.947594, 0.946809, 0.946392, 0.946403, 0.946903, 0.947937, 0.949545, 0.95174, 0.954529, 0.957896, 0.961812, 0.966249, 0.971162, 0.976511, 0.982257, 0.988362],\n  g: [0.000466, 0.00127, 0.002249, 0.003392, 0.004692, 0.006136, 0.007713, 0.009417, 0.011225, 0.013136, 0.015133, 0.017199, 0.019331, 0.021503, 0.023702, 0.025921, 0.028139, 0.030324, 0.032474, 0.034569, 0.03659, 0.038504, 0.040294, 0.041905, 0.043328, 0.044556, 0.045583, 0.046402, 0.047008, 0.047399, 0.047574, 0.047536, 0.047293, 0.046856, 0.046242, 0.045468, 0.044559, 0.043554, 0.042489, 0.041402, 0.040329, 0.039309, 0.0384, 0.037632, 0.03703, 0.036615, 0.036405, 0.036405, 0.036621, 0.037055, 0.037705, 0.038571, 0.039647, 0.040922, 0.042353, 0.043933, 0.045644, 0.04747, 0.049396, 0.051407, 0.05349, 0.055634, 0.057827, 0.06006, 0.062325, 0.064616, 0.066925, 0.069247, 0.071579, 0.073915, 0.076253, 0.078591, 0.080927, 0.083257, 0.08558, 0.087896, 0.090203, 0.092501, 0.09479, 0.097069, 0.099338, 0.101597, 0.103848, 0.106089, 0.108322, 0.110547, 0.112764, 0.114974, 0.117179, 0.119379, 0.121575, 0.123769, 0.12596, 0.12815, 0.130341, 0.132534, 0.134729, 0.136929, 0.139134, 0.141346, 0.143567, 0.145797, 0.148039, 0.150294, 0.152563, 0.154848, 0.157151, 0.159474, 0.161817, 0.164184, 0.166575, 0.168992, 0.171438, 0.173914, 0.176421, 0.178962, 0.181539, 0.184153, 0.186807, 0.189501, 0.192239, 0.195021, 0.197851, 0.200728, 0.203656, 0.206636, 0.20967, 0.212759, 0.215906, 0.219112, 0.222378, 0.225706, 0.229097, 0.232554, 0.236077, 0.239667, 0.243327, 0.247056, 0.250856, 0.254728, 0.258674, 0.262692, 0.266786, 0.270954, 0.275197, 0.279517, 0.283913, 0.288385, 0.292933, 0.297559, 0.30226, 0.307038, 0.311892, 0.316822, 0.321827, 0.326906, 0.33206, 0.337287, 0.342586, 0.347957, 0.353399, 0.358911, 0.364492, 0.37014, 0.375856, 0.381636, 0.387481, 0.393389, 0.399359, 0.405389, 0.411479, 0.417627, 0.423831, 0.430091, 0.436405, 0.442772, 0.449191, 0.45566, 0.462178, 0.468744, 0.475356, 0.482014, 0.488716, 0.495462, 0.502249, 0.509078, 0.515946, 0.522853, 0.529798, 0.53678, 0.543798, 0.55085, 0.557937, 0.565057, 0.572209, 0.579392, 0.586606, 0.593849, 0.601122, 0.608422, 0.61575, 0.623105, 0.630485, 0.63789, 0.64532, 0.652773, 0.66025, 0.667748, 0.675267, 0.682807, 0.690366, 0.697944, 0.70554, 0.713153, 0.720782, 0.728427, 0.736087, 0.743758, 0.751442, 0.759135, 0.766837, 0.774545, 0.782258, 0.789974, 0.797692, 0.805409, 0.813122, 0.820825, 0.828515, 0.836191, 0.843848, 0.851476, 0.859069, 0.866624, 0.874129, 0.881569, 0.888942, 0.896226, 0.903409, 0.910473, 0.917399, 0.924168, 0.930761, 0.937159, 0.943348, 0.949318, 0.955063, 0.960587, 0.965896, 0.971003, 0.975924, 0.980678, 0.985282, 0.989753, 0.994109, 0.998364],\n  b: [0.013866, 0.01857, 0.024239, 0.030909, 0.038558, 0.046836, 0.055143, 0.06346, 0.071862, 0.080282, 0.088767, 0.097327, 0.10593, 0.114621, 0.123397, 0.132232, 0.141141, 0.150164, 0.159254, 0.168414, 0.177642, 0.186962, 0.196354, 0.205799, 0.215289, 0.224813, 0.234358, 0.243904, 0.25343, 0.262912, 0.272321, 0.281624, 0.290788, 0.299776, 0.308553, 0.317085, 0.325338, 0.333277, 0.340874, 0.348111, 0.354971, 0.361447, 0.367535, 0.373238, 0.378563, 0.383522, 0.388129, 0.3924, 0.396353, 0.400007, 0.403378, 0.406485, 0.409345, 0.411976, 0.414392, 0.416608, 0.418637, 0.420491, 0.422182, 0.423721, 0.425116, 0.426377, 0.427511, 0.428524, 0.429425, 0.430217, 0.430906, 0.431497, 0.431994, 0.4324, 0.432719, 0.432955, 0.433109, 0.433183, 0.433179, 0.433098, 0.432943, 0.432714, 0.432412, 0.432039, 0.431594, 0.43108, 0.430498, 0.429846, 0.429125, 0.428334, 0.427475, 0.426548, 0.425552, 0.424488, 0.423356, 0.422156, 0.420887, 0.419549, 0.418142, 0.416667, 0.415123, 0.413511, 0.411829, 0.410078, 0.408258, 0.406369, 0.404411, 0.402385, 0.40029, 0.398125, 0.395891, 0.393589, 0.391219, 0.388781, 0.386276, 0.383704, 0.381065, 0.378359, 0.375586, 0.372748, 0.369846, 0.366879, 0.363849, 0.360757, 0.357603, 0.354388, 0.351113, 0.347777, 0.344383, 0.340931, 0.337424, 0.333861, 0.330245, 0.326576, 0.322856, 0.319085, 0.315266, 0.311399, 0.307485, 0.303526, 0.299523, 0.295477, 0.29139, 0.287264, 0.283099, 0.278898, 0.274661, 0.27039, 0.266085, 0.26175, 0.257383, 0.252988, 0.248564, 0.244113, 0.239636, 0.235133, 0.230606, 0.226055, 0.221482, 0.216886, 0.212268, 0.207628, 0.202968, 0.198286, 0.193584, 0.18886, 0.184116, 0.17935, 0.174563, 0.169755, 0.164924, 0.16007, 0.155193, 0.150292, 0.145367, 0.140417, 0.13544, 0.130438, 0.125409, 0.120354, 0.115272, 0.110164, 0.105031, 0.099874, 0.094695, 0.089499, 0.084289, 0.079073, 0.073859, 0.068659, 0.063488, 0.058367, 0.053324, 0.048392, 0.043618, 0.03905, 0.034931, 0.031409, 0.028508, 0.02625, 0.024661, 0.02377, 0.023606, 0.024202, 0.025592, 0.027814, 0.030908, 0.034916, 0.039886, 0.045581, 0.05175, 0.058329, 0.065257, 0.072489, 0.07999, 0.087731, 0.095694, 0.103863, 0.112229, 0.120785, 0.129527, 0.138453, 0.147565, 0.156863, 0.166353, 0.176037, 0.185923, 0.196018, 0.206332, 0.216877, 0.227658, 0.238686, 0.249972, 0.261534, 0.273391, 0.285546, 0.29801, 0.31082, 0.323974, 0.337475, 0.351369, 0.365627, 0.380271, 0.395289, 0.410665, 0.426373, 0.442367, 0.458592, 0.47497, 0.491426, 0.50786, 0.524203, 0.540361, 0.556275, 0.571925, 0.587206, 0.602154, 0.61676, 0.631017, 0.644924]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const plasma: ColorMap = {\n  r: [0.050383, 0.063536, 0.075353, 0.086222, 0.096379, 0.10598, 0.115124, 0.123903, 0.132381, 0.140603, 0.148607, 0.156421, 0.16407, 0.171574, 0.17895, 0.186213, 0.193374, 0.200445, 0.207435, 0.21435, 0.221197, 0.227983, 0.234715, 0.241396, 0.248032, 0.254627, 0.261183, 0.267703, 0.274191, 0.280648, 0.287076, 0.293478, 0.299855, 0.30621, 0.312543, 0.318856, 0.32515, 0.331426, 0.337683, 0.343925, 0.35015, 0.356359, 0.362553, 0.368733, 0.374897, 0.381047, 0.387183, 0.393304, 0.399411, 0.405503, 0.41158, 0.417642, 0.423689, 0.429719, 0.435734, 0.441732, 0.447714, 0.453677, 0.459623, 0.46555, 0.471457, 0.477344, 0.48321, 0.489055, 0.494877, 0.500678, 0.506454, 0.512206, 0.517933, 0.523633, 0.529306, 0.534952, 0.54057, 0.546157, 0.551715, 0.557243, 0.562738, 0.568201, 0.573632, 0.579029, 0.584391, 0.589719, 0.595011, 0.600266, 0.605485, 0.610667, 0.615812, 0.620919, 0.625987, 0.631017, 0.636008, 0.640959, 0.645872, 0.650746, 0.65558, 0.660374, 0.665129, 0.669845, 0.674522, 0.67916, 0.683758, 0.688318, 0.69284, 0.697324, 0.701769, 0.706178, 0.710549, 0.714883, 0.719181, 0.723444, 0.72767, 0.731862, 0.736019, 0.740143, 0.744232, 0.748289, 0.752312, 0.756304, 0.760264, 0.764193, 0.76809, 0.771958, 0.775796, 0.779604, 0.783383, 0.787133, 0.790855, 0.794549, 0.798216, 0.801855, 0.805467, 0.809052, 0.812612, 0.816144, 0.819651, 0.823132, 0.826588, 0.830018, 0.833422, 0.836801, 0.840155, 0.843484, 0.846788, 0.850066, 0.853319, 0.856547, 0.85975, 0.862927, 0.866078, 0.869203, 0.872303, 0.875376, 0.878423, 0.881443, 0.884436, 0.887402, 0.89034, 0.89325, 0.896131, 0.898984, 0.901807, 0.904601, 0.907365, 0.910098, 0.9128, 0.915471, 0.918109, 0.920714, 0.923287, 0.925825, 0.928329, 0.930798, 0.933232, 0.93563, 0.93799, 0.940313, 0.942598, 0.944844, 0.947051, 0.949217, 0.951344, 0.953428, 0.95547, 0.957469, 0.959424, 0.961336, 0.963203, 0.965024, 0.966798, 0.968526, 0.970205, 0.971835, 0.973416, 0.974947, 0.976428, 0.977856, 0.979233, 0.980556, 0.981826, 0.983041, 0.984199, 0.985301, 0.986345, 0.987332, 0.98826, 0.989128, 0.989935, 0.990681, 0.991365, 0.991985, 0.992541, 0.993032, 0.993456, 0.993814, 0.994103, 0.994324, 0.994474, 0.994553, 0.994561, 0.994495, 0.994355, 0.994141, 0.993851, 0.993482, 0.993033, 0.992505, 0.991897, 0.991209, 0.990439, 0.989587, 0.988648, 0.987621, 0.986509, 0.985314, 0.984031, 0.982653, 0.98119, 0.979644, 0.977995, 0.976265, 0.974443, 0.97253, 0.970533, 0.968443, 0.966271, 0.964021, 0.961681, 0.959276, 0.956808, 0.954287, 0.951726, 0.949151, 0.946602, 0.944152, 0.941896, 0.940015],\n  g: [0.029803, 0.028426, 0.027206, 0.026125, 0.025165, 0.024309, 0.023556, 0.022878, 0.022258, 0.021687, 0.021154, 0.020651, 0.020171, 0.019706, 0.019252, 0.018803, 0.018354, 0.017902, 0.017442, 0.016973, 0.016497, 0.016007, 0.015502, 0.014979, 0.014439, 0.013882, 0.013308, 0.012716, 0.012109, 0.011488, 0.010855, 0.010213, 0.009561, 0.008902, 0.008239, 0.007576, 0.006915, 0.006261, 0.005618, 0.004991, 0.004382, 0.003798, 0.003243, 0.002724, 0.002245, 0.001814, 0.001434, 0.001114, 0.000859, 0.000678, 0.000577, 0.000564, 0.000646, 0.000831, 0.001127, 0.00154, 0.00208, 0.002755, 0.003574, 0.004545, 0.005678, 0.00698, 0.00846, 0.010127, 0.01199, 0.014055, 0.016333, 0.018833, 0.021563, 0.024532, 0.027747, 0.031217, 0.03495, 0.038954, 0.043136, 0.047331, 0.051545, 0.055778, 0.060028, 0.064296, 0.068579, 0.072878, 0.07719, 0.081516, 0.085854, 0.090204, 0.094564, 0.098934, 0.103312, 0.107699, 0.112092, 0.116492, 0.120898, 0.125309, 0.129725, 0.134144, 0.138566, 0.142992, 0.147419, 0.151848, 0.156278, 0.160709, 0.165141, 0.169573, 0.174005, 0.178437, 0.182868, 0.187299, 0.191729, 0.196158, 0.200586, 0.205013, 0.209439, 0.213864, 0.218288, 0.222711, 0.227133, 0.231555, 0.235976, 0.240396, 0.244817, 0.249237, 0.253658, 0.258078, 0.2625, 0.266922, 0.271345, 0.27577, 0.280197, 0.284626, 0.289057, 0.293491, 0.297928, 0.302368, 0.306812, 0.311261, 0.315714, 0.320172, 0.324635, 0.329105, 0.33358, 0.338062, 0.342551, 0.347048, 0.351553, 0.356066, 0.360588, 0.365119, 0.36966, 0.374212, 0.378774, 0.383347, 0.387932, 0.392529, 0.397139, 0.401762, 0.406398, 0.411048, 0.415712, 0.420392, 0.425087, 0.429797, 0.434524, 0.439268, 0.444029, 0.448807, 0.453603, 0.458417, 0.463251, 0.468103, 0.472975, 0.477867, 0.48278, 0.487712, 0.492667, 0.497642, 0.502639, 0.507658, 0.512699, 0.517763, 0.52285, 0.52796, 0.533093, 0.53825, 0.543431, 0.548636, 0.553865, 0.559118, 0.564396, 0.5697, 0.575028, 0.580382, 0.585761, 0.591165, 0.596595, 0.602051, 0.607532, 0.613039, 0.618572, 0.624131, 0.629718, 0.63533, 0.640969, 0.646633, 0.652325, 0.658043, 0.663787, 0.669558, 0.675355, 0.681179, 0.68703, 0.692907, 0.69881, 0.704741, 0.710698, 0.716681, 0.722691, 0.728728, 0.734791, 0.74088, 0.746995, 0.753137, 0.759304, 0.765499, 0.77172, 0.777967, 0.784239, 0.790537, 0.796859, 0.803205, 0.809579, 0.815978, 0.822401, 0.828846, 0.835315, 0.841812, 0.848329, 0.854866, 0.861432, 0.868016, 0.874622, 0.88125, 0.887896, 0.894564, 0.901249, 0.90795, 0.914672, 0.921407, 0.928152, 0.934908, 0.941671, 0.948435, 0.95519, 0.961916, 0.96859, 0.975158],\n  b: [0.527975, 0.533124, 0.538007, 0.542658, 0.547103, 0.551368, 0.555468, 0.559423, 0.56325, 0.566959, 0.570562, 0.574065, 0.577478, 0.580806, 0.584054, 0.587228, 0.59033, 0.593364, 0.596333, 0.599239, 0.602083, 0.604867, 0.607592, 0.610259, 0.612868, 0.615419, 0.617911, 0.620346, 0.622722, 0.625038, 0.627295, 0.62949, 0.631624, 0.633694, 0.6357, 0.63764, 0.639512, 0.641316, 0.643049, 0.64471, 0.646298, 0.64781, 0.649245, 0.650601, 0.651876, 0.653068, 0.654177, 0.655199, 0.656133, 0.656977, 0.65773, 0.65839, 0.658956, 0.659425, 0.659797, 0.660069, 0.66024, 0.66031, 0.660277, 0.660139, 0.659897, 0.659549, 0.659095, 0.658534, 0.657865, 0.657088, 0.656202, 0.655209, 0.654109, 0.652901, 0.651586, 0.650165, 0.64864, 0.64701, 0.645277, 0.643443, 0.641509, 0.639477, 0.637349, 0.635126, 0.632812, 0.630408, 0.627917, 0.625342, 0.622686, 0.619951, 0.61714, 0.614257, 0.611305, 0.608287, 0.605205, 0.602065, 0.598867, 0.595617, 0.592317, 0.588971, 0.585582, 0.582154, 0.578688, 0.575189, 0.57166, 0.568103, 0.564522, 0.560919, 0.557296, 0.553657, 0.550004, 0.546338, 0.542663, 0.538981, 0.535293, 0.531601, 0.527908, 0.524216, 0.520524, 0.516834, 0.513149, 0.509468, 0.505794, 0.502126, 0.498465, 0.494813, 0.491171, 0.487539, 0.483918, 0.480307, 0.476706, 0.473117, 0.469538, 0.465971, 0.462415, 0.45887, 0.455338, 0.451816, 0.448306, 0.444806, 0.441316, 0.437836, 0.434366, 0.430905, 0.427455, 0.424013, 0.420579, 0.417153, 0.413734, 0.410322, 0.406917, 0.403519, 0.400126, 0.396738, 0.393355, 0.389976, 0.3866, 0.383229, 0.37986, 0.376494, 0.37313, 0.369768, 0.366407, 0.363047, 0.359688, 0.356329, 0.35297, 0.34961, 0.346251, 0.34289, 0.339529, 0.336166, 0.332801, 0.329435, 0.326067, 0.322697, 0.319325, 0.315952, 0.312575, 0.309197, 0.305816, 0.302433, 0.299049, 0.295662, 0.292275, 0.288883, 0.28549, 0.282096, 0.278701, 0.275305, 0.271909, 0.268513, 0.265118, 0.261721, 0.258325, 0.254931, 0.25154, 0.248151, 0.244767, 0.241387, 0.238013, 0.234646, 0.231287, 0.227937, 0.224595, 0.221265, 0.217948, 0.214648, 0.211364, 0.2081, 0.204859, 0.201642, 0.198453, 0.195295, 0.19217, 0.189084, 0.186041, 0.183043, 0.180097, 0.177208, 0.174381, 0.171622, 0.168938, 0.166335, 0.163821, 0.161404, 0.159092, 0.156891, 0.154808, 0.152855, 0.151042, 0.149377, 0.14787, 0.146529, 0.145357, 0.144363, 0.143557, 0.142945, 0.142528, 0.142303, 0.142279, 0.142453, 0.142808, 0.143351, 0.144061, 0.144923, 0.145919, 0.147014, 0.14818, 0.14937, 0.15052, 0.151566, 0.152409, 0.152921, 0.152925, 0.152178, 0.150328, 0.146861, 0.140956, 0.131326]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const viridis: ColorMap = {\n  r: [0.267004, 0.26851, 0.269944, 0.271305, 0.272594, 0.273809, 0.274952, 0.276022, 0.277018, 0.277941, 0.278791, 0.279566, 0.280267, 0.280894, 0.281446, 0.281924, 0.282327, 0.282656, 0.28291, 0.283091, 0.283197, 0.283229, 0.283187, 0.283072, 0.282884, 0.282623, 0.28229, 0.281887, 0.281412, 0.280868, 0.280255, 0.279574, 0.278826, 0.278012, 0.277134, 0.276194, 0.275191, 0.274128, 0.273006, 0.271828, 0.270595, 0.269308, 0.267968, 0.26658, 0.265145, 0.263663, 0.262138, 0.260571, 0.258965, 0.257322, 0.255645, 0.253935, 0.252194, 0.250425, 0.248629, 0.246811, 0.244972, 0.243113, 0.241237, 0.239346, 0.237441, 0.235526, 0.233603, 0.231674, 0.229739, 0.227802, 0.225863, 0.223925, 0.221989, 0.220057, 0.21813, 0.21621, 0.214298, 0.212395, 0.210503, 0.208623, 0.206756, 0.204903, 0.203063, 0.201239, 0.19943, 0.197636, 0.19586, 0.1941, 0.192357, 0.190631, 0.188923, 0.187231, 0.185556, 0.183898, 0.182256, 0.180629, 0.179019, 0.177423, 0.175841, 0.174274, 0.172719, 0.171176, 0.169646, 0.168126, 0.166617, 0.165117, 0.163625, 0.162142, 0.160665, 0.159194, 0.157729, 0.15627, 0.154815, 0.153364, 0.151918, 0.150476, 0.149039, 0.147607, 0.14618, 0.144759, 0.143343, 0.141935, 0.140536, 0.139147, 0.13777, 0.136408, 0.135066, 0.133743, 0.132444, 0.131172, 0.129933, 0.128729, 0.127568, 0.126453, 0.125394, 0.124395, 0.123463, 0.122606, 0.121831, 0.121148, 0.120565, 0.120092, 0.119738, 0.119512, 0.119423, 0.119483, 0.119699, 0.120081, 0.120638, 0.12138, 0.122312, 0.123444, 0.12478, 0.126326, 0.128087, 0.130067, 0.132268, 0.134692, 0.137339, 0.14021, 0.143303, 0.146616, 0.150148, 0.153894, 0.157851, 0.162016, 0.166383, 0.170948, 0.175707, 0.180653, 0.185783, 0.19109, 0.196571, 0.202219, 0.20803, 0.214, 0.220124, 0.226397, 0.232815, 0.239374, 0.24607, 0.252899, 0.259857, 0.266941, 0.274149, 0.281477, 0.288921, 0.296479, 0.304148, 0.311925, 0.319809, 0.327796, 0.335885, 0.344074, 0.35236, 0.360741, 0.369214, 0.377779, 0.386433, 0.395174, 0.404001, 0.412913, 0.421908, 0.430983, 0.440137, 0.449368, 0.458674, 0.468053, 0.477504, 0.487026, 0.496615, 0.506271, 0.515992, 0.525776, 0.535621, 0.545524, 0.555484, 0.565498, 0.575563, 0.585678, 0.595839, 0.606045, 0.616293, 0.626579, 0.636902, 0.647257, 0.657642, 0.668054, 0.678489, 0.688944, 0.699415, 0.709898, 0.720391, 0.730889, 0.741388, 0.751884, 0.762373, 0.772852, 0.783315, 0.79376, 0.804182, 0.814576, 0.82494, 0.83527, 0.845561, 0.85581, 0.866013, 0.876168, 0.886271, 0.89632, 0.906311, 0.916242, 0.926106, 0.935904, 0.945636, 0.9553, 0.964894, 0.974417, 0.983868, 0.993248],\n  g: [0.004874, 0.009605, 0.014625, 0.019942, 0.025563, 0.031497, 0.037752, 0.044167, 0.050344, 0.056324, 0.062145, 0.067836, 0.073417, 0.078907, 0.08432, 0.089666, 0.094955, 0.100196, 0.105393, 0.110553, 0.11568, 0.120777, 0.125848, 0.130895, 0.13592, 0.140926, 0.145912, 0.150881, 0.155834, 0.160771, 0.165693, 0.170599, 0.17549, 0.180367, 0.185228, 0.190074, 0.194905, 0.199721, 0.20452, 0.209303, 0.214069, 0.218818, 0.223549, 0.228262, 0.232956, 0.237631, 0.242286, 0.246922, 0.251537, 0.25613, 0.260703, 0.265254, 0.269783, 0.27429, 0.278775, 0.283237, 0.287675, 0.292092, 0.296485, 0.300855, 0.305202, 0.309527, 0.313828, 0.318106, 0.322361, 0.326594, 0.330805, 0.334994, 0.339161, 0.343307, 0.347432, 0.351535, 0.355619, 0.359683, 0.363727, 0.367752, 0.371758, 0.375746, 0.379716, 0.38367, 0.387607, 0.391528, 0.395433, 0.399323, 0.403199, 0.407061, 0.41091, 0.414746, 0.41857, 0.422383, 0.426184, 0.429975, 0.433756, 0.437527, 0.44129, 0.445044, 0.448791, 0.45253, 0.456262, 0.459988, 0.463708, 0.467423, 0.471133, 0.474838, 0.47854, 0.482237, 0.485932, 0.489624, 0.493313, 0.497, 0.500685, 0.504369, 0.508051, 0.511733, 0.515413, 0.519093, 0.522773, 0.526453, 0.530132, 0.533812, 0.537492, 0.541173, 0.544853, 0.548535, 0.552216, 0.555899, 0.559582, 0.563265, 0.566949, 0.570633, 0.574318, 0.578002, 0.581687, 0.585371, 0.589055, 0.592739, 0.596422, 0.600104, 0.603785, 0.607464, 0.611141, 0.614817, 0.61849, 0.622161, 0.625828, 0.629492, 0.633153, 0.636809, 0.640461, 0.644107, 0.647749, 0.651384, 0.655014, 0.658636, 0.662252, 0.665859, 0.669459, 0.67305, 0.676631, 0.680203, 0.683765, 0.687316, 0.690856, 0.694384, 0.6979, 0.701402, 0.704891, 0.708366, 0.711827, 0.715272, 0.718701, 0.722114, 0.725509, 0.728888, 0.732247, 0.735588, 0.73891, 0.742211, 0.745492, 0.748751, 0.751988, 0.755203, 0.758394, 0.761561, 0.764704, 0.767822, 0.770914, 0.77398, 0.777018, 0.780029, 0.783011, 0.785964, 0.788888, 0.791781, 0.794644, 0.797475, 0.800275, 0.803041, 0.805774, 0.808473, 0.811138, 0.813768, 0.816363, 0.818921, 0.821444, 0.823929, 0.826376, 0.828786, 0.831158, 0.833491, 0.835785, 0.838039, 0.840254, 0.84243, 0.844566, 0.846661, 0.848717, 0.850733, 0.852709, 0.854645, 0.856542, 0.8584, 0.860219, 0.861999, 0.863742, 0.865448, 0.867117, 0.868751, 0.87035, 0.871916, 0.873449, 0.874951, 0.876424, 0.877868, 0.879285, 0.880678, 0.882046, 0.883393, 0.88472, 0.886029, 0.887322, 0.888601, 0.889868, 0.891125, 0.892374, 0.893616, 0.894855, 0.896091, 0.89733, 0.89857, 0.899815, 0.901065, 0.902323, 0.90359, 0.904867, 0.906157],\n  b: [0.329415, 0.335427, 0.341379, 0.347269, 0.353093, 0.358853, 0.364543, 0.370164, 0.375715, 0.381191, 0.386592, 0.391917, 0.397163, 0.402329, 0.407414, 0.412415, 0.417331, 0.42216, 0.426902, 0.431554, 0.436115, 0.440584, 0.44496, 0.449241, 0.453427, 0.457517, 0.46151, 0.465405, 0.469201, 0.472899, 0.476498, 0.479997, 0.483397, 0.486697, 0.489898, 0.493001, 0.496005, 0.498911, 0.501721, 0.504434, 0.507052, 0.509577, 0.512008, 0.514349, 0.516599, 0.518762, 0.520837, 0.522828, 0.524736, 0.526563, 0.528312, 0.529983, 0.531579, 0.533103, 0.534556, 0.535941, 0.53726, 0.538516, 0.539709, 0.540844, 0.541921, 0.542944, 0.543914, 0.544834, 0.545706, 0.546532, 0.547314, 0.548053, 0.548752, 0.549413, 0.550038, 0.550627, 0.551184, 0.55171, 0.552206, 0.552675, 0.553117, 0.553533, 0.553925, 0.554294, 0.554642, 0.554969, 0.555276, 0.555565, 0.555836, 0.556089, 0.556326, 0.556547, 0.556753, 0.556944, 0.55712, 0.557282, 0.55743, 0.557565, 0.557685, 0.557792, 0.557885, 0.557965, 0.55803, 0.558082, 0.558119, 0.558141, 0.558148, 0.55814, 0.558115, 0.558073, 0.558013, 0.557936, 0.55784, 0.557724, 0.557587, 0.55743, 0.55725, 0.557049, 0.556823, 0.556572, 0.556295, 0.555991, 0.555659, 0.555298, 0.554906, 0.554483, 0.554029, 0.553541, 0.553018, 0.552459, 0.551864, 0.551229, 0.550556, 0.549841, 0.549086, 0.548287, 0.547445, 0.546557, 0.545623, 0.544641, 0.543611, 0.54253, 0.5414, 0.540218, 0.538982, 0.537692, 0.536347, 0.534946, 0.533488, 0.531973, 0.530398, 0.528763, 0.527068, 0.525311, 0.523491, 0.521608, 0.519661, 0.517649, 0.515571, 0.513427, 0.511215, 0.508936, 0.506589, 0.504172, 0.501686, 0.499129, 0.496502, 0.493803, 0.491033, 0.488189, 0.485273, 0.482284, 0.479221, 0.476084, 0.472873, 0.469588, 0.466226, 0.462789, 0.459277, 0.455688, 0.452024, 0.448284, 0.444467, 0.440573, 0.436601, 0.432552, 0.428426, 0.424223, 0.419943, 0.415586, 0.411152, 0.40664, 0.402049, 0.397381, 0.392636, 0.387814, 0.382914, 0.377939, 0.372886, 0.367757, 0.362552, 0.357269, 0.35191, 0.346476, 0.340967, 0.335384, 0.329727, 0.323998, 0.318195, 0.312321, 0.306377, 0.300362, 0.294279, 0.288127, 0.281908, 0.275626, 0.269281, 0.262877, 0.256415, 0.249897, 0.243329, 0.236712, 0.230052, 0.223353, 0.21662, 0.209861, 0.203082, 0.196293, 0.189503, 0.182725, 0.175971, 0.169257, 0.162603, 0.156029, 0.149561, 0.143228, 0.137064, 0.131109, 0.125405, 0.120005, 0.114965, 0.110347, 0.106217, 0.102646, 0.099702, 0.097452, 0.095953, 0.09525, 0.095374, 0.096335, 0.098125, 0.100717, 0.104071, 0.108131, 0.112838, 0.118128, 0.123941, 0.130215, 0.136897, 0.143936]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const cividis: ColorMap = {\n  r: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003602, 0.017852, 0.03211, 0.046205, 0.058378, 0.068968, 0.078624, 0.087465, 0.095645, 0.103401, 0.110658, 0.117612, 0.124291, 0.130669, 0.13683, 0.142852, 0.148638, 0.154261, 0.159733, 0.165113, 0.170362, 0.17549, 0.180503, 0.185453, 0.190303, 0.195057, 0.199764, 0.204385, 0.208926, 0.213431, 0.217863, 0.222264, 0.226598, 0.230871, 0.23512, 0.239312, 0.243485, 0.247605, 0.251675, 0.255731, 0.25974, 0.263738, 0.267693, 0.271639, 0.275513, 0.279411, 0.28324, 0.287065, 0.290884, 0.294669, 0.298421, 0.302169, 0.305886, 0.309601, 0.313287, 0.316941, 0.320595, 0.32425, 0.327875, 0.331474, 0.335073, 0.338673, 0.342246, 0.345793, 0.349341, 0.352892, 0.356418, 0.359916, 0.363446, 0.366923, 0.37043, 0.373884, 0.377371, 0.38083, 0.384268, 0.387705, 0.391151, 0.394568, 0.397991, 0.401418, 0.40482, 0.408226, 0.411607, 0.414992, 0.418383, 0.421748, 0.42512, 0.428462, 0.431817, 0.435168, 0.438504, 0.44181, 0.445148, 0.448447, 0.451759, 0.455072, 0.458366, 0.461616, 0.464947, 0.468254, 0.471501, 0.474812, 0.478186, 0.481622, 0.485141, 0.488697, 0.492278, 0.495913, 0.499552, 0.503185, 0.506866, 0.51054, 0.514226, 0.51792, 0.521643, 0.525348, 0.529086, 0.532829, 0.536553, 0.540307, 0.544069, 0.54784, 0.551612, 0.555393, 0.559181, 0.562972, 0.566802, 0.570607, 0.574417, 0.578236, 0.582087, 0.585916, 0.589753, 0.593622, 0.597469, 0.601354, 0.605211, 0.609105, 0.612977, 0.616852, 0.620765, 0.624654, 0.628576, 0.632506, 0.636412, 0.640352, 0.64427, 0.648222, 0.652178, 0.656114, 0.660082, 0.664055, 0.668008, 0.671991, 0.675981, 0.679979, 0.68395, 0.687957, 0.691971, 0.695985, 0.700008, 0.704037, 0.708067, 0.712105, 0.716177, 0.720222, 0.724274, 0.728334, 0.732422, 0.736488, 0.740589, 0.744664, 0.748772, 0.752886, 0.756975, 0.761096, 0.765223, 0.769353, 0.773486, 0.777651, 0.781795, 0.785965, 0.790116, 0.794298, 0.79848, 0.802667, 0.806859, 0.811054, 0.815274, 0.819499, 0.823729, 0.827959, 0.832192, 0.836429, 0.840693, 0.844957, 0.849223, 0.853515, 0.857809, 0.862105, 0.866421, 0.870717, 0.875057, 0.879378, 0.88372, 0.888081, 0.89244, 0.896818, 0.901195, 0.905589, 0.91, 0.914407, 0.918828, 0.923279, 0.927724, 0.93218, 0.93666, 0.941147, 0.945654, 0.950178, 0.954725, 0.959284, 0.963872, 0.968469, 0.973114, 0.97778, 0.982497, 0.987293, 0.992218, 0.994847, 0.995249, 0.995503, 0.995737],\n  g: [0.135112, 0.138068, 0.141013, 0.143951, 0.146877, 0.149791, 0.152673, 0.155377, 0.157932, 0.160495, 0.163058, 0.165621, 0.168204, 0.1708, 0.17342, 0.176082, 0.178802, 0.18161, 0.18455, 0.186915, 0.188769, 0.19095, 0.193366, 0.195911, 0.198528, 0.201199, 0.203903, 0.206629, 0.209372, 0.212122, 0.214879, 0.217643, 0.220406, 0.22317, 0.225935, 0.228697, 0.231458, 0.234216, 0.236972, 0.239724, 0.242475, 0.245221, 0.247965, 0.250707, 0.253444, 0.25618, 0.258914, 0.261644, 0.264372, 0.267099, 0.269823, 0.272546, 0.275266, 0.277985, 0.280702, 0.283419, 0.286134, 0.288848, 0.291562, 0.294274, 0.296986, 0.299698, 0.302409, 0.30512, 0.307831, 0.310542, 0.313253, 0.315965, 0.318677, 0.32139, 0.324103, 0.326816, 0.329531, 0.332247, 0.334963, 0.337681, 0.340399, 0.34312, 0.345842, 0.348565, 0.351289, 0.354016, 0.356744, 0.359474, 0.362206, 0.364939, 0.367676, 0.370414, 0.373153, 0.375896, 0.378641, 0.381388, 0.384139, 0.38689, 0.389646, 0.392404, 0.395164, 0.397928, 0.400694, 0.403464, 0.406236, 0.409011, 0.41179, 0.414572, 0.417357, 0.420145, 0.422937, 0.425733, 0.428531, 0.431334, 0.43414, 0.43695, 0.439763, 0.44258, 0.445402, 0.448226, 0.451053, 0.453887, 0.456718, 0.459552, 0.462405, 0.465241, 0.468083, 0.47096, 0.473832, 0.476699, 0.479573, 0.482451, 0.485318, 0.488198, 0.491076, 0.49396, 0.496851, 0.499743, 0.502643, 0.505546, 0.508454, 0.511367, 0.514285, 0.517207, 0.520135, 0.523067, 0.526005, 0.528948, 0.531895, 0.534849, 0.537807, 0.540771, 0.543741, 0.546715, 0.549695, 0.552682, 0.555673, 0.55867, 0.561674, 0.564682, 0.567697, 0.570718, 0.573743, 0.576777, 0.579816, 0.582861, 0.585913, 0.58897, 0.592034, 0.595104, 0.59818, 0.601264, 0.604354, 0.60745, 0.610553, 0.613664, 0.61678, 0.619904, 0.623034, 0.626171, 0.629316, 0.632468, 0.635626, 0.638793, 0.641966, 0.645145, 0.648334, 0.651529, 0.654731, 0.657942, 0.66116, 0.664384, 0.667618, 0.670859, 0.674107, 0.677364, 0.680629, 0.6839, 0.687181, 0.69047, 0.693766, 0.697071, 0.700384, 0.703705, 0.707035, 0.710373, 0.713719, 0.717074, 0.720438, 0.72381, 0.72719, 0.73058, 0.733978, 0.737385, 0.740801, 0.744226, 0.747659, 0.751101, 0.754553, 0.758014, 0.761483, 0.764962, 0.76845, 0.771947, 0.775454, 0.778969, 0.782494, 0.786028, 0.789572, 0.793125, 0.796687, 0.800258, 0.803839, 0.80743, 0.81103, 0.814639, 0.818257, 0.821885, 0.825522, 0.829168, 0.832822, 0.836486, 0.840159, 0.843841, 0.84753, 0.851228, 0.854933, 0.858646, 0.862365, 0.866089, 0.869819, 0.87355, 0.877281, 0.881008, 0.884718, 0.888385, 0.892954, 0.898384, 0.903866, 0.909344],\n  b: [0.304751, 0.311105, 0.317579, 0.323982, 0.330479, 0.337065, 0.343704, 0.3505, 0.357521, 0.364534, 0.371608, 0.378769, 0.385902, 0.3931, 0.400353, 0.407577, 0.414764, 0.421859, 0.428802, 0.435532, 0.439563, 0.441085, 0.441561, 0.441564, 0.441248, 0.440785, 0.440196, 0.439531, 0.438863, 0.438105, 0.437342, 0.436593, 0.43579, 0.435067, 0.434308, 0.433547, 0.43284, 0.432148, 0.431404, 0.430752, 0.43012, 0.429528, 0.428908, 0.428325, 0.42779, 0.427299, 0.426788, 0.426329, 0.425924, 0.425497, 0.425126, 0.424809, 0.42448, 0.424206, 0.423914, 0.423678, 0.423498, 0.423304, 0.423167, 0.423014, 0.422917, 0.422873, 0.422814, 0.42281, 0.422789, 0.422821, 0.422837, 0.422979, 0.423031, 0.423211, 0.423373, 0.423517, 0.423716, 0.423973, 0.424213, 0.424512, 0.42479, 0.42512, 0.425512, 0.425889, 0.42625, 0.42667, 0.427144, 0.427605, 0.428053, 0.428559, 0.429127, 0.429685, 0.430226, 0.430823, 0.431501, 0.432075, 0.432796, 0.433428, 0.434209, 0.43489, 0.435653, 0.436475, 0.437305, 0.438096, 0.438986, 0.439848, 0.440708, 0.441642, 0.44257, 0.443577, 0.444578, 0.44556, 0.44664, 0.447692, 0.448864, 0.449982, 0.451134, 0.452341, 0.453659, 0.454885, 0.456264, 0.457582, 0.458976, 0.460457, 0.461969, 0.463395, 0.464908, 0.466357, 0.467681, 0.468845, 0.469767, 0.470384, 0.471008, 0.471453, 0.471751, 0.472032, 0.472305, 0.472432, 0.47255, 0.47264, 0.472707, 0.472639, 0.47266, 0.472543, 0.472401, 0.472352, 0.472163, 0.471947, 0.471704, 0.471439, 0.471147, 0.470829, 0.470488, 0.469988, 0.469593, 0.469172, 0.468724, 0.468118, 0.467618, 0.46709, 0.466401, 0.465821, 0.465074, 0.464441, 0.463638, 0.46295, 0.462237, 0.461351, 0.460583, 0.459641, 0.458668, 0.457818, 0.456791, 0.455886, 0.454801, 0.453689, 0.452702, 0.451534, 0.450338, 0.44927, 0.448018, 0.446736, 0.445424, 0.444251, 0.442886, 0.441491, 0.440072, 0.438624, 0.437147, 0.435647, 0.434117, 0.432386, 0.430805, 0.429194, 0.427554, 0.425717, 0.424028, 0.422131, 0.420393, 0.418448, 0.416472, 0.414659, 0.412638, 0.410587, 0.408516, 0.406422, 0.404112, 0.401966, 0.399613, 0.397423, 0.395016, 0.392597, 0.390153, 0.387684, 0.385198, 0.382504, 0.379785, 0.377043, 0.374292, 0.371529, 0.368747, 0.365746, 0.362741, 0.359729, 0.3565, 0.353259, 0.350011, 0.346571, 0.343333, 0.339685, 0.336241, 0.332599, 0.32877, 0.324968, 0.320982, 0.317021, 0.312889, 0.308594, 0.304348, 0.29996, 0.295244, 0.290611, 0.28588, 0.280876, 0.275815, 0.270532, 0.265085, 0.259365, 0.253563, 0.247445, 0.24131, 0.234677, 0.227954, 0.220878, 0.213336, 0.205468, 0.203445, 0.207561, 0.21237, 0.217772]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const gray: ColorMap = {\n  r: [0.0, 0.00392156862745098, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.0196078431372549, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.03529411764705882, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.054901960784313725, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.12156862745098039, 0.12549019607843137, 0.12941176470588234, 0.13333333333333333, 0.13725490196078433, 0.1411764705882353, 0.14509803921568626, 0.14901960784313725, 0.15294117647058825, 0.1568627450980392, 0.16078431372549018, 0.16470588235294117, 0.16862745098039217, 0.17254901960784313, 0.1764705882352941, 0.1803921568627451, 0.1843137254901961, 0.18823529411764706, 0.19215686274509802, 0.19607843137254902, 0.2, 0.20392156862745098, 0.20784313725490194, 0.21176470588235294, 0.21568627450980393, 0.2196078431372549, 0.22352941176470587, 0.22745098039215686, 0.23137254901960785, 0.23529411764705882, 0.2392156862745098, 0.24313725490196078, 0.24705882352941178, 0.25098039215686274, 0.2549019607843137, 0.2588235294117647, 0.2627450980392157, 0.26666666666666666, 0.27058823529411763, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.2901960784313725, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.3058823529411765, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.32156862745098036, 0.3254901960784314, 0.32941176470588235, 0.3333333333333333, 0.33725490196078434, 0.3411764705882353, 0.34509803921568627, 0.34901960784313724, 0.3529411764705882, 0.3568627450980392, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.37254901960784315, 0.3764705882352941, 0.3803921568627451, 0.38431372549019605, 0.38823529411764707, 0.39215686274509803, 0.396078431372549, 0.4, 0.403921568627451, 0.40784313725490196, 0.4117647058823529, 0.4156862745098039, 0.4196078431372549, 0.4235294117647059, 0.42745098039215684, 0.43137254901960786, 0.43529411764705883, 0.4392156862745098, 0.44313725490196076, 0.44705882352941173, 0.45098039215686275, 0.4549019607843137, 0.4588235294117647, 0.4627450980392157, 0.4666666666666667, 0.47058823529411764, 0.4745098039215686, 0.4784313725490196, 0.4823529411764706, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.4980392156862745, 0.5019607843137255, 0.5058823529411764, 0.5098039215686274, 0.5137254901960784, 0.5176470588235293, 0.5215686274509804, 0.5254901960784314, 0.5294117647058824, 0.5333333333333333, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5490196078431373, 0.5529411764705883, 0.5568627450980392, 0.5607843137254902, 0.5647058823529412, 0.5686274509803921, 0.5725490196078431, 0.5764705882352941, 0.580392156862745, 0.5843137254901961, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6039215686274509, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6431372549019607, 0.6470588235294118, 0.6509803921568628, 0.6549019607843137, 0.6588235294117647, 0.6627450980392157, 0.6666666666666666, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6901960784313725, 0.6941176470588235, 0.6980392156862745, 0.7019607843137254, 0.7058823529411764, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7254901960784313, 0.7294117647058823, 0.7333333333333333, 0.7372549019607844, 0.7411764705882353, 0.7450980392156863, 0.7490196078431373, 0.7529411764705882, 0.7568627450980392, 0.7607843137254902, 0.7647058823529411, 0.7686274509803921, 0.7725490196078432, 0.7764705882352941, 0.7803921568627451, 0.7843137254901961, 0.788235294117647, 0.792156862745098, 0.796078431372549, 0.8, 0.803921568627451, 0.807843137254902, 0.8117647058823529, 0.8156862745098039, 0.8196078431372549, 0.8235294117647058, 0.8274509803921568, 0.8313725490196078, 0.8352941176470589, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8901960784313725, 0.8941176470588235, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9568627450980391, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9921568627450981, 0.996078431372549, 1.0],\n  g: [0.0, 0.00392156862745098, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.0196078431372549, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.03529411764705882, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.054901960784313725, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.12156862745098039, 0.12549019607843137, 0.12941176470588234, 0.13333333333333333, 0.13725490196078433, 0.1411764705882353, 0.14509803921568626, 0.14901960784313725, 0.15294117647058825, 0.1568627450980392, 0.16078431372549018, 0.16470588235294117, 0.16862745098039217, 0.17254901960784313, 0.1764705882352941, 0.1803921568627451, 0.1843137254901961, 0.18823529411764706, 0.19215686274509802, 0.19607843137254902, 0.2, 0.20392156862745098, 0.20784313725490194, 0.21176470588235294, 0.21568627450980393, 0.2196078431372549, 0.22352941176470587, 0.22745098039215686, 0.23137254901960785, 0.23529411764705882, 0.2392156862745098, 0.24313725490196078, 0.24705882352941178, 0.25098039215686274, 0.2549019607843137, 0.2588235294117647, 0.2627450980392157, 0.26666666666666666, 0.27058823529411763, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.2901960784313725, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.3058823529411765, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.32156862745098036, 0.3254901960784314, 0.32941176470588235, 0.3333333333333333, 0.33725490196078434, 0.3411764705882353, 0.34509803921568627, 0.34901960784313724, 0.3529411764705882, 0.3568627450980392, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.37254901960784315, 0.3764705882352941, 0.3803921568627451, 0.38431372549019605, 0.38823529411764707, 0.39215686274509803, 0.396078431372549, 0.4, 0.403921568627451, 0.40784313725490196, 0.4117647058823529, 0.4156862745098039, 0.4196078431372549, 0.4235294117647059, 0.42745098039215684, 0.43137254901960786, 0.43529411764705883, 0.4392156862745098, 0.44313725490196076, 0.44705882352941173, 0.45098039215686275, 0.4549019607843137, 0.4588235294117647, 0.4627450980392157, 0.4666666666666667, 0.47058823529411764, 0.4745098039215686, 0.4784313725490196, 0.4823529411764706, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.4980392156862745, 0.5019607843137255, 0.5058823529411764, 0.5098039215686274, 0.5137254901960784, 0.5176470588235293, 0.5215686274509804, 0.5254901960784314, 0.5294117647058824, 0.5333333333333333, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5490196078431373, 0.5529411764705883, 0.5568627450980392, 0.5607843137254902, 0.5647058823529412, 0.5686274509803921, 0.5725490196078431, 0.5764705882352941, 0.580392156862745, 0.5843137254901961, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6039215686274509, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6431372549019607, 0.6470588235294118, 0.6509803921568628, 0.6549019607843137, 0.6588235294117647, 0.6627450980392157, 0.6666666666666666, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6901960784313725, 0.6941176470588235, 0.6980392156862745, 0.7019607843137254, 0.7058823529411764, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7254901960784313, 0.7294117647058823, 0.7333333333333333, 0.7372549019607844, 0.7411764705882353, 0.7450980392156863, 0.7490196078431373, 0.7529411764705882, 0.7568627450980392, 0.7607843137254902, 0.7647058823529411, 0.7686274509803921, 0.7725490196078432, 0.7764705882352941, 0.7803921568627451, 0.7843137254901961, 0.788235294117647, 0.792156862745098, 0.796078431372549, 0.8, 0.803921568627451, 0.807843137254902, 0.8117647058823529, 0.8156862745098039, 0.8196078431372549, 0.8235294117647058, 0.8274509803921568, 0.8313725490196078, 0.8352941176470589, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8901960784313725, 0.8941176470588235, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9568627450980391, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9921568627450981, 0.996078431372549, 1.0],\n  b: [0.0, 0.00392156862745098, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.0196078431372549, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.03529411764705882, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.054901960784313725, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.12156862745098039, 0.12549019607843137, 0.12941176470588234, 0.13333333333333333, 0.13725490196078433, 0.1411764705882353, 0.14509803921568626, 0.14901960784313725, 0.15294117647058825, 0.1568627450980392, 0.16078431372549018, 0.16470588235294117, 0.16862745098039217, 0.17254901960784313, 0.1764705882352941, 0.1803921568627451, 0.1843137254901961, 0.18823529411764706, 0.19215686274509802, 0.19607843137254902, 0.2, 0.20392156862745098, 0.20784313725490194, 0.21176470588235294, 0.21568627450980393, 0.2196078431372549, 0.22352941176470587, 0.22745098039215686, 0.23137254901960785, 0.23529411764705882, 0.2392156862745098, 0.24313725490196078, 0.24705882352941178, 0.25098039215686274, 0.2549019607843137, 0.2588235294117647, 0.2627450980392157, 0.26666666666666666, 0.27058823529411763, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.2901960784313725, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.3058823529411765, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.32156862745098036, 0.3254901960784314, 0.32941176470588235, 0.3333333333333333, 0.33725490196078434, 0.3411764705882353, 0.34509803921568627, 0.34901960784313724, 0.3529411764705882, 0.3568627450980392, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.37254901960784315, 0.3764705882352941, 0.3803921568627451, 0.38431372549019605, 0.38823529411764707, 0.39215686274509803, 0.396078431372549, 0.4, 0.403921568627451, 0.40784313725490196, 0.4117647058823529, 0.4156862745098039, 0.4196078431372549, 0.4235294117647059, 0.42745098039215684, 0.43137254901960786, 0.43529411764705883, 0.4392156862745098, 0.44313725490196076, 0.44705882352941173, 0.45098039215686275, 0.4549019607843137, 0.4588235294117647, 0.4627450980392157, 0.4666666666666667, 0.47058823529411764, 0.4745098039215686, 0.4784313725490196, 0.4823529411764706, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.4980392156862745, 0.5019607843137255, 0.5058823529411764, 0.5098039215686274, 0.5137254901960784, 0.5176470588235293, 0.5215686274509804, 0.5254901960784314, 0.5294117647058824, 0.5333333333333333, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5490196078431373, 0.5529411764705883, 0.5568627450980392, 0.5607843137254902, 0.5647058823529412, 0.5686274509803921, 0.5725490196078431, 0.5764705882352941, 0.580392156862745, 0.5843137254901961, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6039215686274509, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6431372549019607, 0.6470588235294118, 0.6509803921568628, 0.6549019607843137, 0.6588235294117647, 0.6627450980392157, 0.6666666666666666, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6901960784313725, 0.6941176470588235, 0.6980392156862745, 0.7019607843137254, 0.7058823529411764, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7254901960784313, 0.7294117647058823, 0.7333333333333333, 0.7372549019607844, 0.7411764705882353, 0.7450980392156863, 0.7490196078431373, 0.7529411764705882, 0.7568627450980392, 0.7607843137254902, 0.7647058823529411, 0.7686274509803921, 0.7725490196078432, 0.7764705882352941, 0.7803921568627451, 0.7843137254901961, 0.788235294117647, 0.792156862745098, 0.796078431372549, 0.8, 0.803921568627451, 0.807843137254902, 0.8117647058823529, 0.8156862745098039, 0.8196078431372549, 0.8235294117647058, 0.8274509803921568, 0.8313725490196078, 0.8352941176470589, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8901960784313725, 0.8941176470588235, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9568627450980391, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9921568627450981, 0.996078431372549, 1.0]\n};\n","\nimport type { ColorMap } from \"./types\";\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const svs_nitrogen_dioxide: ColorMap = {\n  r: [0.027451, 0.027451, 0.0313726, 0.0313726, 0.0313726, 0.0352941, 0.0392157, 0.0392157, 0.0431373, 0.0431373, 0.0470588, 0.0509804, 0.0509804, 0.054902, 0.054902, 0.0588235, 0.0627451, 0.0627451, 0.0666667, 0.0666667, 0.0705882, 0.0745098, 0.0745098, 0.0784314, 0.0823529, 0.0823529, 0.0862745, 0.0901961, 0.0901961, 0.0941176, 0.0941176, 0.0980392, 0.101961, 0.101961, 0.105882, 0.109804, 0.113725, 0.117647, 0.121569, 0.12549, 0.133333, 0.137255, 0.145098, 0.14902, 0.156863, 0.164706, 0.172549, 0.180392, 0.188235, 0.196078, 0.207843, 0.215686, 0.223529, 0.231373, 0.239216, 0.25098, 0.258824, 0.266667, 0.278431, 0.286275, 0.294118, 0.301961, 0.313726, 0.321569, 0.329412, 0.337255, 0.345098, 0.356863, 0.364706, 0.372549, 0.380392, 0.388235, 0.4, 0.407843, 0.415686, 0.427451, 0.435294, 0.443137, 0.45098, 0.462745, 0.470588, 0.478431, 0.490196, 0.501961, 0.509804, 0.521569, 0.529412, 0.541176, 0.552941, 0.564706, 0.576471, 0.584314, 0.6, 0.607843, 0.619608, 0.631373, 0.639216, 0.654902, 0.662745, 0.67451, 0.686275, 0.694118, 0.705882, 0.713726, 0.72549, 0.737255, 0.745098, 0.756863, 0.764706, 0.772549, 0.784314, 0.792157, 0.803922, 0.811765, 0.819608, 0.827451, 0.835294, 0.847059, 0.85098, 0.858824, 0.870588, 0.87451, 0.882353, 0.890196, 0.898039, 0.905882, 0.909804, 0.917647, 0.92549, 0.929412, 0.937255, 0.941176, 0.94902, 0.952941, 0.960784, 0.964706, 0.972549, 0.976471, 0.980392, 0.984314, 0.988235, 0.988235, 0.992157, 0.992157, 0.992157, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 0.996078, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.996078, 0.996078, 0.996078, 0.992157, 0.992157, 0.988235, 0.984314, 0.980392, 0.976471, 0.972549, 0.968627, 0.964706, 0.956863, 0.94902, 0.945098, 0.933333, 0.92549, 0.917647, 0.905882, 0.898039, 0.886275, 0.87451, 0.858824, 0.847059, 0.835294, 0.819608, 0.803922, 0.788235, 0.772549, 0.760784, 0.741176, 0.72549, 0.705882, 0.690196, 0.67451, 0.65098, 0.635294, 0.615686, 0.596078, 0.580392, 0.556863, 0.541176, 0.521569, 0.501961, 0.486275, 0.466667, 0.45098, 0.427451, 0.411765, 0.396078, 0.376471, 0.364706, 0.345098, 0.329412, 0.317647, 0.298039, 0.286275, 0.270588, 0.258824, 0.247059, 0.235294, 0.227451, 0.219608, 0.211765, 0.211765, 0.207843, 0.207843, 0.211765, 0.211765, 0.215686, 0.223529, 0.227451, 0.231373],\n  g: [0.0156863, 0.0156863, 0.0156863, 0.0196078, 0.0196078, 0.0196078, 0.0235294, 0.0235294, 0.0235294, 0.0235294, 0.027451, 0.027451, 0.027451, 0.0313726, 0.0313726, 0.0313726, 0.0352941, 0.0352941, 0.0352941, 0.0352941, 0.0392157, 0.0392157, 0.0392157, 0.0431373, 0.0431373, 0.0431373, 0.0470588, 0.0470588, 0.0470588, 0.0509804, 0.0509804, 0.0509804, 0.0509804, 0.054902, 0.054902, 0.054902, 0.0588235, 0.0588235, 0.0588235, 0.0588235, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0627451, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0666667, 0.0705882, 0.0705882, 0.0705882, 0.0745098, 0.0745098, 0.0784314, 0.0823529, 0.0823529, 0.0862745, 0.0901961, 0.0941176, 0.0980392, 0.101961, 0.105882, 0.105882, 0.109804, 0.113725, 0.117647, 0.121569, 0.12549, 0.129412, 0.133333, 0.137255, 0.141176, 0.141176, 0.145098, 0.14902, 0.152941, 0.156863, 0.160784, 0.164706, 0.168627, 0.172549, 0.176471, 0.180392, 0.184314, 0.188235, 0.192157, 0.196078, 0.2, 0.203922, 0.207843, 0.211765, 0.215686, 0.219608, 0.223529, 0.227451, 0.231373, 0.235294, 0.239216, 0.247059, 0.25098, 0.254902, 0.258824, 0.262745, 0.270588, 0.27451, 0.282353, 0.290196, 0.294118, 0.301961, 0.309804, 0.321569, 0.329412, 0.337255, 0.34902, 0.356863, 0.368627, 0.376471, 0.388235, 0.396078, 0.407843, 0.415686, 0.427451, 0.435294, 0.447059, 0.458824, 0.466667, 0.482353, 0.494118, 0.505882, 0.517647, 0.529412, 0.545098, 0.556863, 0.572549, 0.584314, 0.6, 0.615686, 0.627451, 0.643137, 0.654902, 0.670588, 0.686275, 0.698039, 0.709804, 0.721569, 0.733333, 0.74902, 0.756863, 0.772549, 0.780392, 0.792157, 0.803922, 0.811765, 0.823529, 0.831373, 0.843137, 0.85098, 0.862745, 0.870588, 0.878431, 0.890196, 0.898039, 0.905882, 0.913725, 0.921569, 0.929412, 0.937255, 0.941176, 0.94902, 0.952941, 0.960784, 0.964706, 0.968627, 0.972549, 0.976471, 0.976471, 0.980392, 0.980392, 0.980392, 0.980392, 0.976471, 0.976471, 0.972549, 0.968627, 0.964706, 0.960784, 0.956863, 0.952941, 0.945098, 0.941176, 0.937255, 0.929412, 0.92549, 0.917647, 0.913725, 0.905882, 0.901961, 0.894118, 0.886275, 0.882353, 0.878431, 0.870588, 0.866667, 0.858824, 0.854902, 0.847059, 0.839216, 0.835294, 0.827451, 0.823529, 0.815686, 0.807843, 0.8, 0.792157, 0.788235, 0.780392, 0.768627, 0.760784, 0.752941, 0.741176, 0.733333, 0.721569, 0.709804, 0.698039, 0.686275, 0.67451, 0.662745, 0.65098, 0.635294, 0.623529, 0.607843, 0.592157, 0.580392, 0.564706, 0.552941, 0.541176, 0.529412, 0.517647, 0.501961, 0.494118, 0.486275, 0.47451, 0.470588, 0.462745],\n  b: [0.0509804, 0.054902, 0.0588235, 0.0627451, 0.0666667, 0.0745098, 0.0784314, 0.0862745, 0.0901961, 0.0941176, 0.101961, 0.109804, 0.113725, 0.121569, 0.12549, 0.133333, 0.141176, 0.145098, 0.152941, 0.156863, 0.164706, 0.172549, 0.180392, 0.184314, 0.192157, 0.196078, 0.203922, 0.211765, 0.215686, 0.223529, 0.227451, 0.235294, 0.243137, 0.247059, 0.254902, 0.262745, 0.266667, 0.27451, 0.282353, 0.286275, 0.294118, 0.301961, 0.309804, 0.317647, 0.32549, 0.333333, 0.341176, 0.352941, 0.360784, 0.368627, 0.376471, 0.384314, 0.396078, 0.403922, 0.411765, 0.419608, 0.427451, 0.435294, 0.443137, 0.45098, 0.454902, 0.462745, 0.466667, 0.470588, 0.47451, 0.478431, 0.482353, 0.486275, 0.486275, 0.490196, 0.490196, 0.490196, 0.494118, 0.494118, 0.494118, 0.498039, 0.498039, 0.498039, 0.498039, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.501961, 0.498039, 0.498039, 0.498039, 0.494118, 0.494118, 0.494118, 0.490196, 0.490196, 0.490196, 0.486275, 0.486275, 0.482353, 0.482353, 0.478431, 0.47451, 0.47451, 0.470588, 0.466667, 0.462745, 0.458824, 0.454902, 0.45098, 0.447059, 0.443137, 0.439216, 0.435294, 0.431373, 0.431373, 0.423529, 0.423529, 0.419608, 0.415686, 0.411765, 0.407843, 0.403922, 0.4, 0.4, 0.396078, 0.392157, 0.388235, 0.384314, 0.380392, 0.376471, 0.368627, 0.364706, 0.360784, 0.352941, 0.34902, 0.341176, 0.337255, 0.329412, 0.32549, 0.321569, 0.317647, 0.313726, 0.313726, 0.313726, 0.313726, 0.317647, 0.321569, 0.32549, 0.333333, 0.337255, 0.34902, 0.356863, 0.364706, 0.376471, 0.384314, 0.392157, 0.403922, 0.411765, 0.423529, 0.431373, 0.443137, 0.45098, 0.462745, 0.47451, 0.482353, 0.498039, 0.505882, 0.517647, 0.533333, 0.54902, 0.564706, 0.576471, 0.592157, 0.611765, 0.623529, 0.643137, 0.654902, 0.670588, 0.686275, 0.694118, 0.709804, 0.717647, 0.72549, 0.733333, 0.737255, 0.741176, 0.745098, 0.745098, 0.741176, 0.737255, 0.729412, 0.72549, 0.717647, 0.705882, 0.698039, 0.686275, 0.678431, 0.670588, 0.658824, 0.65098, 0.643137, 0.639216, 0.631373, 0.627451, 0.627451, 0.627451, 0.627451, 0.627451, 0.631373, 0.631373, 0.635294, 0.639216, 0.643137, 0.65098, 0.654902, 0.658824, 0.662745, 0.662745, 0.666667, 0.670588, 0.670588, 0.67451, 0.67451, 0.67451, 0.67451, 0.67451, 0.67451, 0.678431, 0.678431, 0.682353, 0.686275, 0.686275, 0.690196, 0.698039, 0.701961, 0.709804, 0.713726, 0.717647, 0.72549, 0.733333, 0.737255, 0.745098, 0.74902, 0.756863, 0.760784, 0.764706, 0.768627, 0.772549, 0.772549, 0.776471, 0.776471, 0.776471, 0.776471, 0.776471, 0.776471, 0.776471],\n};\n\n\nexport const svsColorRamp = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        7,\n        4,\n        13,\n        255\n      ],\n      \"toColor\": [\n        13,\n        7,\n        29,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 0.047619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        13,\n        7,\n        29,\n        255\n      ],\n      \"toColor\": [\n        20,\n        11,\n        49,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.047619047619047616,\n      \"stop\": 0.09523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        20,\n        11,\n        49,\n        255\n      ],\n      \"toColor\": [\n        29,\n        14,\n        68,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.09523809523809523,\n      \"stop\": 0.14285714285714285\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        29,\n        14,\n        68,\n        255\n      ],\n      \"toColor\": [\n        49,\n        16,\n        93,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.14285714285714285,\n      \"stop\": 0.19047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        49,\n        16,\n        93,\n        255\n      ],\n      \"toColor\": [\n        76,\n        17,\n        117,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.19047619047619047,\n      \"stop\": 0.23809523809523808\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        76,\n        17,\n        117,\n        255\n      ],\n      \"toColor\": [\n        103,\n        26,\n        126,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.23809523809523808,\n      \"stop\": 0.2857142857142857\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        103,\n        26,\n        126,\n        255\n      ],\n      \"toColor\": [\n        133,\n        36,\n        128,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.2857142857142857,\n      \"stop\": 0.3333333333333333\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        133,\n        36,\n        128,\n        255\n      ],\n      \"toColor\": [\n        167,\n        49,\n        123,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.3333333333333333,\n      \"stop\": 0.38095238095238093\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        167,\n        49,\n        123,\n        255\n      ],\n      \"toColor\": [\n        197,\n        61,\n        113,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.38095238095238093,\n      \"stop\": 0.42857142857142855\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        197,\n        61,\n        113,\n        255\n      ],\n      \"toColor\": [\n        223,\n        80,\n        102,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.42857142857142855,\n      \"stop\": 0.47619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        223,\n        80,\n        102,\n        255\n      ],\n      \"toColor\": [\n        244,\n        110,\n        89,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.47619047619047616,\n      \"stop\": 0.5238095238095237\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        244,\n        110,\n        89,\n        255\n      ],\n      \"toColor\": [\n        253,\n        148,\n        81,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5238095238095237,\n      \"stop\": 0.5714285714285714\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        148,\n        81,\n        255\n      ],\n      \"toColor\": [\n        253,\n        190,\n        107,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5714285714285714,\n      \"stop\": 0.6190476190476191\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        190,\n        107,\n        255\n      ],\n      \"toColor\": [\n        253,\n        221,\n        144,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6190476190476191,\n      \"stop\": 0.6666666666666666\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        221,\n        144,\n        255\n      ],\n      \"toColor\": [\n        254,\n        245,\n        185,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6666666666666666,\n      \"stop\": 0.7142857142857142\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        254,\n        245,\n        185,\n        255\n      ],\n      \"toColor\": [\n        245,\n        247,\n        177,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7142857142857142,\n      \"stop\": 0.7619047619047619\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        245,\n        247,\n        177,\n        255\n      ],\n      \"toColor\": [\n        214,\n        232,\n        160,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7619047619047619,\n      \"stop\": 0.8095238095238095\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        214,\n        232,\n        160,\n        255\n      ],\n      \"toColor\": [\n        163,\n        213,\n        170,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8095238095238095,\n      \"stop\": 0.8571428571428571\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        163,\n        213,\n        170,\n        255\n      ],\n      \"toColor\": [\n        106,\n        189,\n        175,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8571428571428571,\n      \"stop\": 0.9047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        106,\n        189,\n        175,\n        255\n      ],\n      \"toColor\": [\n        60,\n        151,\n        192,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9047619047619047,\n      \"stop\": 0.9523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        60,\n        151,\n        192,\n        255\n      ],\n      \"toColor\": [\n        59,\n        117,\n        198,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9523809523809523,\n      \"stop\": 1.0\n    }\n  ]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const sargassum: ColorMap = {\n  r: [0.3843137254901961, 0.38823529411764707, 0.396078431372549, 0.4, 0.40784313725490196, 0.41568627450980394, 0.42745098039215684, 0.43529411764705883, 0.44313725490196076, 0.4549019607843137, 0.4666666666666667, 0.4745098039215686, 0.48627450980392156, 0.49411764705882355, 0.5058823529411764, 0.5137254901960784, 0.5254901960784314, 0.5333333333333333, 0.5450980392156862, 0.5529411764705883, 0.5647058823529412, 0.5725490196078431, 0.5843137254901961, 0.592156862745098, 0.6039215686274509, 0.615686274509804, 0.6235294117647059, 0.6352941176470588, 0.6431372549019608, 0.6549019607843137, 0.6627450980392157, 0.6745098039215687, 0.6823529411764706, 0.6901960784313725, 0.7019607843137254, 0.7098039215686275, 0.7215686274509804, 0.7294117647058823, 0.7372549019607844, 0.7490196078431373, 0.7568627450980392, 0.7686274509803922, 0.7764705882352941, 0.788235294117647, 0.796078431372549, 0.803921568627451, 0.8156862745098039, 0.8235294117647058, 0.8313725490196079, 0.8392156862745098, 0.8470588235294118, 0.8509803921568627, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8862745098039215, 0.8901960784313725, 0.8941176470588236, 0.8980392156862745, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9058823529411765, 0.9098039215686274, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9490196078431372, 0.9529411764705882, 0.9529411764705882, 0.9568627450980393, 0.9607843137254902, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9686274509803922, 0.9725490196078431, 0.9725490196078431, 0.9764705882352941, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.984313725490196, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9921568627450981, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.984313725490196, 0.984313725490196, 0.984313725490196, 0.984313725490196, 0.9803921568627451, 0.9803921568627451, 0.9803921568627451, 0.9803921568627451, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9764705882352941, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9725490196078431, 0.9686274509803922, 0.9686274509803922, 0.9647058823529412, 0.9647058823529412, 0.9607843137254902, 0.9529411764705882, 0.9490196078431372, 0.9411764705882353, 0.9333333333333333, 0.9254901960784314, 0.9137254901960784, 0.9058823529411765, 0.8941176470588236, 0.8862745098039215, 0.8745098039215686, 0.8666666666666667, 0.8549019607843137, 0.8470588235294118, 0.8392156862745098, 0.8274509803921568, 0.8196078431372549, 0.807843137254902, 0.8, 0.788235294117647, 0.7803921568627451, 0.7686274509803922, 0.7568627450980392, 0.7450980392156863, 0.7372549019607844, 0.7254901960784313, 0.7137254901960784, 0.7058823529411765, 0.6941176470588235, 0.6823529411764706, 0.6745098039215687, 0.6627450980392157, 0.6509803921568628, 0.6392156862745098, 0.6313725490196078, 0.6196078431372549, 0.6078431372549019, 0.6, 0.5882352941176471, 0.5764705882352941, 0.5686274509803921, 0.5568627450980392, 0.5450980392156862, 0.5333333333333333, 0.5215686274509804, 0.5098039215686274, 0.5019607843137255, 0.49019607843137253, 0.4823529411764706, 0.4745098039215686, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.4745098039215686, 0.47843137254901963, 0.48627450980392156, 0.49411764705882355, 0.5019607843137255, 0.5137254901960784, 0.5254901960784314, 0.5372549019607843, 0.5450980392156862, 0.5568627450980392, 0.5686274509803921, 0.5803921568627451, 0.592156862745098, 0.6039215686274509, 0.615686274509804, 0.6235294117647059, 0.6352941176470588, 0.6470588235294118, 0.6588235294117647, 0.6705882352941176, 0.6823529411764706, 0.6941176470588235, 0.7058823529411765, 0.7137254901960784, 0.7254901960784313, 0.7372549019607844, 0.7490196078431373, 0.7607843137254902, 0.7725490196078432, 0.7843137254901961, 0.792156862745098, 0.803921568627451, 0.8156862745098039, 0.8235294117647058, 0.8352941176470589, 0.8470588235294118, 0.8549019607843137, 0.8666666666666667, 0.8784313725490196, 0.8901960784313725, 0.8980392156862745, 0.9098039215686274, 0.9215686274509803, 0.9294117647058824, 0.9411764705882353, 0.9490196078431372, 0.9568627450980393, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9725490196078431],\n  g: [0.07058823529411765, 0.07058823529411765, 0.07450980392156863, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.10196078431372549, 0.10588235294117647, 0.11372549019607843, 0.11764705882352941, 0.12549019607843137, 0.13333333333333333, 0.13725490196078433, 0.1450980392156863, 0.14901960784313725, 0.1568627450980392, 0.1607843137254902, 0.16470588235294117, 0.17254901960784313, 0.17647058823529413, 0.1843137254901961, 0.18823529411764706, 0.19607843137254902, 0.2, 0.20784313725490197, 0.21176470588235294, 0.21568627450980393, 0.2235294117647059, 0.22745098039215686, 0.23529411764705882, 0.23921568627450981, 0.24705882352941178, 0.25098039215686274, 0.25882352941176473, 0.2627450980392157, 0.26666666666666666, 0.27450980392156865, 0.2784313725490196, 0.2823529411764706, 0.28627450980392155, 0.29411764705882354, 0.2980392156862745, 0.30196078431372547, 0.30980392156862746, 0.3137254901960784, 0.3176470588235294, 0.3254901960784314, 0.32941176470588235, 0.33725490196078434, 0.3411764705882353, 0.34901960784313724, 0.35294117647058826, 0.3607843137254902, 0.36470588235294116, 0.3686274509803922, 0.3764705882352941, 0.3803921568627451, 0.38823529411764707, 0.39215686274509803, 0.4, 0.403921568627451, 0.4117647058823529, 0.41568627450980394, 0.4235294117647059, 0.42745098039215684, 0.43529411764705883, 0.4392156862745098, 0.4470588235294118, 0.45098039215686275, 0.4588235294117647, 0.4627450980392157, 0.47058823529411764, 0.4745098039215686, 0.47843137254901963, 0.48627450980392156, 0.49019607843137253, 0.49411764705882355, 0.5019607843137255, 0.5058823529411764, 0.5137254901960784, 0.5176470588235295, 0.5254901960784314, 0.5294117647058824, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5529411764705883, 0.5568627450980392, 0.5647058823529412, 0.5686274509803921, 0.5764705882352941, 0.5803921568627451, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6392156862745098, 0.6431372549019608, 0.6470588235294118, 0.6470588235294118, 0.6509803921568628, 0.6509803921568628, 0.6509803921568628, 0.6549019607843137, 0.6549019607843137, 0.6588235294117647, 0.6588235294117647, 0.6627450980392157, 0.6627450980392157, 0.6666666666666666, 0.6666666666666666, 0.6705882352941176, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6862745098039216, 0.6901960784313725, 0.6901960784313725, 0.6941176470588235, 0.6941176470588235, 0.6980392156862745, 0.6980392156862745, 0.7019607843137254, 0.7019607843137254, 0.7019607843137254, 0.7058823529411765, 0.7058823529411765, 0.7098039215686275, 0.7098039215686275, 0.7137254901960784, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7215686274509804, 0.7254901960784313, 0.7254901960784313, 0.7294117647058823, 0.7294117647058823, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7294117647058823, 0.7254901960784313, 0.7254901960784313, 0.7254901960784313, 0.7254901960784313, 0.7215686274509804, 0.7215686274509804, 0.7215686274509804, 0.7215686274509804, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7176470588235294, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7137254901960784, 0.7098039215686275, 0.7098039215686275, 0.7098039215686275, 0.7058823529411765, 0.7058823529411765, 0.7058823529411765, 0.7058823529411765, 0.7058823529411765, 0.7019607843137254, 0.7019607843137254, 0.7019607843137254, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.6980392156862745, 0.7019607843137254, 0.7019607843137254, 0.7058823529411765, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7294117647058823, 0.7372549019607844, 0.7411764705882353, 0.7490196078431373, 0.7529411764705882, 0.7607843137254902, 0.7647058823529411, 0.7725490196078432, 0.7803921568627451, 0.7843137254901961, 0.792156862745098, 0.8, 0.803921568627451, 0.8117647058823529, 0.8156862745098039, 0.8235294117647058, 0.8313725490196079, 0.8352941176470589, 0.8431372549019608, 0.8470588235294118, 0.8549019607843137, 0.8588235294117647, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8823529411764706, 0.8862745098039215, 0.8941176470588236, 0.8980392156862745, 0.9058823529411765, 0.9098039215686274, 0.9176470588235294, 0.9254901960784314, 0.9294117647058824, 0.9372549019607843, 0.9411764705882353, 0.9490196078431372, 0.9529411764705882, 0.9568627450980393, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.9803921568627451, 0.9882352941176471],\n  b: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.00392156862745098, 0.0, 0.0, 0.0, 0.0, 0.00392156862745098, 0.00392156862745098, 0.00784313725490196, 0.00784313725490196, 0.011764705882352941, 0.01568627450980392, 0.023529411764705882, 0.027450980392156862, 0.03137254901960784, 0.0392156862745098, 0.043137254901960784, 0.047058823529411764, 0.050980392156862744, 0.058823529411764705, 0.06274509803921569, 0.06666666666666667, 0.07058823529411765, 0.0784313725490196, 0.08235294117647059, 0.08627450980392157, 0.09019607843137255, 0.09411764705882353, 0.09803921568627451, 0.10196078431372549, 0.10588235294117647, 0.10980392156862745, 0.11372549019607843, 0.11764705882352941, 0.11764705882352941, 0.12156862745098039, 0.12156862745098039, 0.12549019607843137, 0.12549019607843137, 0.12941176470588237, 0.12941176470588237, 0.13333333333333333, 0.13333333333333333, 0.13333333333333333, 0.13725490196078433, 0.13725490196078433, 0.13725490196078433, 0.1411764705882353, 0.1411764705882353, 0.1411764705882353, 0.1450980392156863, 0.1450980392156863, 0.1450980392156863, 0.1450980392156863, 0.14901960784313725, 0.14901960784313725, 0.14901960784313725, 0.14901960784313725, 0.14901960784313725, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.15294117647058825, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1568627450980392, 0.1607843137254902, 0.1607843137254902, 0.1607843137254902, 0.1607843137254902, 0.16470588235294117, 0.16470588235294117, 0.16470588235294117, 0.16470588235294117, 0.16862745098039217, 0.16862745098039217, 0.17254901960784313, 0.17647058823529413, 0.1803921568627451, 0.18823529411764706, 0.19607843137254902, 0.20392156862745098, 0.21568627450980393, 0.23137254901960785, 0.24705882352941178, 0.2627450980392157, 0.2784313725490196, 0.29411764705882354, 0.30980392156862746, 0.3254901960784314, 0.3411764705882353, 0.35294117647058826, 0.3686274509803922, 0.3843137254901961, 0.396078431372549, 0.4117647058823529, 0.4235294117647059, 0.4392156862745098, 0.45098039215686275, 0.4666666666666667, 0.47843137254901963, 0.49019607843137253, 0.5019607843137255, 0.5137254901960784, 0.5254901960784314, 0.5411764705882353, 0.5529411764705883, 0.5647058823529412, 0.5764705882352941, 0.5882352941176471, 0.6, 0.611764705882353, 0.6235294117647059, 0.6352941176470588, 0.6470588235294118, 0.6549019607843137, 0.6666666666666666, 0.6784313725490196, 0.6901960784313725, 0.7019607843137254, 0.7137254901960784, 0.7254901960784313, 0.7372549019607844, 0.7490196078431373, 0.7568627450980392, 0.7686274509803922, 0.7803921568627451, 0.788235294117647, 0.8, 0.807843137254902, 0.8196078431372549, 0.8274509803921568, 0.8313725490196079, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8862745098039215, 0.8901960784313725, 0.8941176470588236, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9529411764705882, 0.9568627450980393, 0.9607843137254902, 0.9647058823529412, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9882352941176471, 0.9882352941176471, 0.9921568627450981, 0.9921568627450981],\n};\n\n\nexport const sargassumColorRamp = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        98,\n        18,\n        0,\n        255\n      ],\n      \"toColor\": [\n        124,\n        32,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 0.047619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        124,\n        32,\n        1,\n        255\n      ],\n      \"toColor\": [\n        154,\n        50,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.047619047619047616,\n      \"stop\": 0.09523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        154,\n        50,\n        0,\n        255\n      ],\n      \"toColor\": [\n        184,\n        67,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.09523809523809523,\n      \"stop\": 0.14285714285714285\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        184,\n        67,\n        0,\n        255\n      ],\n      \"toColor\": [\n        213,\n        83,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.14285714285714285,\n      \"stop\": 0.19047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        213,\n        83,\n        1,\n        255\n      ],\n      \"toColor\": [\n        225,\n        101,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.19047619047619047,\n      \"stop\": 0.23809523809523808\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        225,\n        101,\n        1,\n        255\n      ],\n      \"toColor\": [\n        233,\n        119,\n        1,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.23809523809523808,\n      \"stop\": 0.2857142857142857\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        233,\n        119,\n        1,\n        255\n      ],\n      \"toColor\": [\n        242,\n        137,\n        15,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.2857142857142857,\n      \"stop\": 0.3333333333333333\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        242,\n        137,\n        15,\n        255\n      ],\n      \"toColor\": [\n        249,\n        153,\n        28,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.3333333333333333,\n      \"stop\": 0.38095238095238093\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        249,\n        153,\n        28,\n        255\n      ],\n      \"toColor\": [\n        253,\n        165,\n        34,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.38095238095238093,\n      \"stop\": 0.42857142857142855\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        253,\n        165,\n        34,\n        255\n      ],\n      \"toColor\": [\n        252,\n        170,\n        38,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.42857142857142855,\n      \"stop\": 0.47619047619047616\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        252,\n        170,\n        38,\n        255\n      ],\n      \"toColor\": [\n        249,\n        177,\n        40,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.47619047619047616,\n      \"stop\": 0.5238095238095237\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        249,\n        177,\n        40,\n        255\n      ],\n      \"toColor\": [\n        248,\n        183,\n        42,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5238095238095237,\n      \"stop\": 0.5714285714285714\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        248,\n        183,\n        42,\n        255\n      ],\n      \"toColor\": [\n        233,\n        186,\n        70,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.5714285714285714,\n      \"stop\": 0.6190476190476191\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        233,\n        186,\n        70,\n        255\n      ],\n      \"toColor\": [\n        204,\n        184,\n        115,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6190476190476191,\n      \"stop\": 0.6666666666666666\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        204,\n        184,\n        115,\n        255\n      ],\n      \"toColor\": [\n        171,\n        182,\n        153,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.6666666666666666,\n      \"stop\": 0.7142857142857142\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        171,\n        182,\n        153,\n        255\n      ],\n      \"toColor\": [\n        138,\n        178,\n        188,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7142857142857142,\n      \"stop\": 0.7619047619047619\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        138,\n        178,\n        188,\n        255\n      ],\n      \"toColor\": [\n        122,\n        181,\n        215,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.7619047619047619,\n      \"stop\": 0.8095238095238095\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        122,\n        181,\n        215,\n        255\n      ],\n      \"toColor\": [\n        155,\n        199,\n        226,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8095238095238095,\n      \"stop\": 0.8571428571428571\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        155,\n        199,\n        226,\n        255\n      ],\n      \"toColor\": [\n        190,\n        218,\n        236,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.8571428571428571,\n      \"stop\": 0.9047619047619047\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        190,\n        218,\n        236,\n        255\n      ],\n      \"toColor\": [\n        223,\n        236,\n        245,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9047619047619047,\n      \"stop\": 0.9523809523809523\n    },\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        223,\n        236,\n        245,\n        255\n      ],\n      \"toColor\": [\n        248,\n        252,\n        253,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.9523809523809523,\n      \"stop\": 1.0\n    }\n  ]\n};\n","\nimport type { ColorMap } from \"./types\";\n\nexport const haline: ColorMap = {\n  r: [0.1629529545569048, 0.16481011306381138, 0.16661616674455051, 0.16836623940471737, 0.17005470631768066, 0.1716750780810942, 0.17321986700170694, 0.1746804342417165, 0.17604336542541646, 0.17729823332351538, 0.17843229662509333, 0.17942266920100228, 0.180254232712636, 0.180897536581308, 0.1813298273265454, 0.1815069308605479, 0.18139595590863708, 0.1809499433760711, 0.18011665240948918, 0.17884195577310877, 0.17707513448329337, 0.1747764954226868, 0.17192558838006158, 0.1685302279919113, 0.164637354379816, 0.16031416565937215, 0.15565394557274276, 0.15073735679779035, 0.14564275779798264, 0.1404368075255881, 0.13517265040893509, 0.12989065618077872, 0.12462051256931497, 0.11938590047805706, 0.11422949121970527, 0.10914049113753677, 0.10414385842443263, 0.09926304855671816, 0.0944951258080505, 0.08986951574154733, 0.08539285840535987, 0.08106756674391194, 0.0769441893273207, 0.07300703739422579, 0.06927650669442811, 0.06578801445169752, 0.06255595479554787, 0.059592051819134705, 0.05691772151374492, 0.05455347307306369, 0.05251889627870444, 0.050838773472474307, 0.04951454037014189, 0.04855490408104566, 0.047963691562250284, 0.04773946305380069, 0.047875451814151544, 0.0483598472050416, 0.049176387574113, 0.05030518671680884, 0.05172369283691292, 0.05340767549062541, 0.05533215100674955, 0.05747218306369887, 0.05980352430527091, 0.06230309069250609, 0.06494927925026378, 0.06772215122553368, 0.0706035074778493, 0.07357840396611612, 0.07663101364217326, 0.07974739830752586, 0.08291580548873803, 0.08612580955679122, 0.08936817980172057, 0.09263475301781654, 0.09591831391237074, 0.09921323508992197, 0.10251396146531713, 0.10581448535228527, 0.1091104131658914, 0.11239784950892981, 0.11567333621600695, 0.11893417013803154, 0.12217818929740112, 0.12540189437459884, 0.1286031296249826, 0.13177997116656254, 0.13493070192214515, 0.1380549051543558, 0.1411501069188545, 0.1442150210041466, 0.14724858201038377, 0.15024993416559976, 0.15321920226797617, 0.15615458635588805, 0.15905548258963134, 0.16192138547473778, 0.1647524478987732, 0.1675482630437003, 0.17030806884524888, 0.173031724594995, 0.17571936649681574, 0.17837165032593938, 0.18098781677618211, 0.18356807194166253, 0.1861127112291279, 0.18862304058887, 0.19109852514864226, 0.19353972277173262, 0.19594728833405683, 0.1983227076664062, 0.20066603425074547, 0.20297813604786474, 0.20526004447420448, 0.2075134652380221, 0.20973894946144023, 0.21193776912721762, 0.21411134378441182, 0.2162615771757636, 0.21838952862057853, 0.2204969036245258, 0.22258552726351216, 0.22465736600629022, 0.22671413523001882, 0.22875791756964453, 0.23079086796822001, 0.2328150701112509, 0.23483285614219046, 0.23684664957075507, 0.2388588283644082, 0.24087168222405414, 0.24288806087225434, 0.24491067596723043, 0.24694202909654656, 0.24898467028821447, 0.251041844633167, 0.2531164830585315, 0.2552111567013787, 0.2573286340449816, 0.25947244473861586, 0.2616456589963801, 0.2638509342960792, 0.26609108289659433, 0.2683698467163787, 0.27069035099494715, 0.2730554221838173, 0.2754676310512872, 0.2779309010023177, 0.28044833184082757, 0.2830229969716622, 0.28565699250220966, 0.2883543502639873, 0.29111809079756673, 0.2939511790083493, 0.29685621314189514, 0.2998362114418811, 0.30289439617634056, 0.3060335830069556, 0.30925653734539094, 0.3125659486948475, 0.3159647522698377, 0.3194556489243874, 0.32304124427931485, 0.3267240985578744, 0.33050707514885924, 0.33439297391994083, 0.3383839618515475, 0.3424824761777381, 0.34669092650509575, 0.351011700367143, 0.3554477481971079, 0.3600022066505756, 0.36467644578419367, 0.3694728210602396, 0.3743936915522128, 0.3794414259131371, 0.38461840795578295, 0.38992704160225383, 0.3953697549145613, 0.4009508646485599, 0.40667140195994433, 0.4125334807152799, 0.41853956675270404, 0.4246921350385853, 0.4309936593663836, 0.43744659753040943, 0.4440533711015542, 0.45081633883461397, 0.4577377626480225, 0.46481976504714334, 0.4720642768256656, 0.4794729738954752, 0.48704720218658354, 0.49478788975543747, 0.502695445574845, 0.5107722312752203, 0.519017580722989, 0.527427047659408, 0.5359974387485315, 0.5447242959015132, 0.5536017493685389, 0.5626223858732353, 0.5717801732913298, 0.5810619798273547, 0.5904522695833789, 0.59993630566992, 0.6094978370184863, 0.6191178753985616, 0.6287753075069072, 0.6384515865712357, 0.6481275660781143, 0.6577845458065525, 0.667404707037929, 0.6769617561788033, 0.6864487597795673, 0.69585443145648, 0.7051685608468115, 0.71438302722636, 0.7234917624309317, 0.7324906484647774, 0.7413773645706981, 0.7501511992657797, 0.758812842117251, 0.7673641682613402, 0.7758080262912036, 0.7841480375461038, 0.7923777293356836, 0.800497630396886, 0.8085242857272323, 0.8164630734789561, 0.8243194501554684, 0.8320860387263339, 0.8397544323444477, 0.8473543986252204, 0.8548913210362115, 0.8623409541601502, 0.8697191661117473, 0.877047948076314, 0.8843061388708379, 0.8914967901846199, 0.898650661869968, 0.9057328617844135, 0.9127681739145864, 0.9197719823668247, 0.9266999503758118, 0.9336093927737403, 0.9404610328906413, 0.9472803518326599, 0.9540659681238263, 0.9608049809199471, 0.9675287370768705, 0.9741967269037245, 0.9808627042040826, 0.9874684104099173, 0.9940805805099583],\n  g: [0.09521591660747855, 0.0963511590972791, 0.09744967053737302, 0.09851521320092249, 0.09955275459284393, 0.10056873145593648, 0.10157135702513853, 0.10257097334218751, 0.10356584027704996, 0.10458024676581804, 0.1056380265564063, 0.10674165621081344, 0.10793563466790623, 0.10923866406414962, 0.11070429246224553, 0.1123613365530294, 0.1142804413027346, 0.11652515301133853, 0.1191682999758128, 0.12228861049996234, 0.1259620672997293, 0.13024864459406924, 0.1351768519397535, 0.14073088183460164, 0.14684331943301, 0.15340748473917706, 0.16029117959242076, 0.16736888953134454, 0.17452933124088685, 0.1816841459042555, 0.1887688275072176, 0.19573985804384908, 0.2025703385486159, 0.20924466230343952, 0.2157456284251405, 0.22208312061819008, 0.22825465182827054, 0.23426097673881258, 0.24011399581702425, 0.24581471938893312, 0.2513729453557033, 0.256799705029183, 0.2620915612909199, 0.2672655035330154, 0.2723273008096985, 0.2772789491245567, 0.2821282390686886, 0.2868831717247525, 0.29154887162812176, 0.2961302536799314, 0.30063184093875434, 0.3050562292020493, 0.3094102218220906, 0.3136977658751047, 0.3179225992994974, 0.3220882581897951, 0.3261980852298422, 0.3302552388254388, 0.3342627026038174, 0.33822329503101706, 0.34213967896327, 0.34601437099898574, 0.3498497505368459, 0.35364806847548513, 0.35741145551306436, 0.3611419300223894, 0.36484140549022287, 0.36851169751907215, 0.37215453039677776, 0.3757710087912915, 0.37936299913099886, 0.38293223649328834, 0.38648014137990283, 0.39000806896659534, 0.39351731349892055, 0.39700911235508674, 0.4004846497947374, 0.4039446967979293, 0.407390264684531, 0.4108228877965505, 0.41424356901188075, 0.41765327256964846, 0.4210529263321469, 0.4244432161011251, 0.42782466919265655, 0.43119871063381826, 0.4345661396549307, 0.4379277275711909, 0.44128421897143094, 0.4446356900078315, 0.44798348190176723, 0.45132831167041504, 0.45467082457551683, 0.4580115969309521, 0.46135071307922276, 0.46468936526295607, 0.4680281092699005, 0.47136747964858944, 0.47470770262422896, 0.478049331937957, 0.4813931150452206, 0.484739501366448, 0.48808883039949774, 0.49144122896414794, 0.4947975030047193, 0.49815801614320204, 0.5015231101060642, 0.5048927132825591, 0.5082675669534004, 0.5116479477164066, 0.5150341080561434, 0.5184259856373716, 0.5218241099237965, 0.5252286912572144, 0.5286398903414566, 0.5320576287402744, 0.535482279322358, 0.5389139515314046, 0.5423527133674996, 0.5457984712571944, 0.5492514494924778, 0.5527116487772891, 0.5561790393438252, 0.5596535532346759, 0.5631352211554989, 0.5666239548700177, 0.5701196510565367, 0.5736222405040751, 0.577131576635999, 0.5806474896434284, 0.5841698333340916, 0.5876984999166237, 0.5912331932277819, 0.5947736703172153, 0.598319767629138, 0.6018713111492172, 0.6054278820406325, 0.6089891735215488, 0.6125550130731925, 0.6161251617120728, 0.6196990932330638, 0.6232764459181283, 0.6268570181766053, 0.630440554670746, 0.634026414751126, 0.6376141889650659, 0.6412035896296302, 0.6447944545228799, 0.6483859905965969, 0.6519777450281342, 0.6555692556652558, 0.6591606030439278, 0.6627507929293074, 0.6663393219020087, 0.6699256847308839, 0.673509649075136, 0.6770906951012129, 0.680668005929282, 0.684241027807421, 0.6878091952372648, 0.6913723055472414, 0.6949295261702347, 0.6984800979280559, 0.7020233920397538, 0.7055587631720374, 0.7090857414439621, 0.7126036449951605, 0.7161115318028217, 0.7196086676710338, 0.7230942938245446, 0.7265676248366645, 0.7300279237012575, 0.7334743741555847, 0.7369059239634065, 0.7403216514270206, 0.7437205957454258, 0.7471017539541064, 0.7504640777072077, 0.7538064699246834, 0.7571277813375661, 0.760426747786949, 0.7637021069222052, 0.7669525443587899, 0.7701766751192416, 0.7733730477083216, 0.7765401418648604, 0.7796763669997492, 0.7827800615723168, 0.7858494937119429, 0.7888828634531383, 0.7918783070193569, 0.7948339036614173, 0.7977476856267914, 0.8006176519006482, 0.8034417864099652, 0.8062180814071851, 0.8089441566688712, 0.8116180108735556, 0.8142382455983396, 0.8168032862890818, 0.819311801237797, 0.8217627673204915, 0.8241555398979113, 0.8264893011624767, 0.828764813194564, 0.8309836316507101, 0.8331474672067843, 0.8352587020450518, 0.837320741926722, 0.8393379672623437, 0.8413146218129587, 0.843255556919926, 0.8451659780810963, 0.8470513147981416, 0.848919836337816, 0.850774894928254, 0.8526212799355241, 0.8544637256207057, 0.8563065614925247, 0.8581536540348341, 0.860008371786031, 0.8618735721244006, 0.8637516069265696, 0.8656443435632366, 0.8675531974405399, 0.8694791724028597, 0.8714229056785223, 0.8733886508286131, 0.8753781889640524, 0.8773871783186646, 0.8794151844938148, 0.8814616081475757, 0.8835308362945183, 0.8856278479633188, 0.8877421380157633, 0.8898726582646793, 0.8920307544658761, 0.8942111604773197, 0.8964055876253053, 0.8986242192828277, 0.9008669432468145, 0.9031210853874222, 0.9054032588350297, 0.9077032841253238, 0.9100148294768658, 0.9123594905222979, 0.9147111822755605, 0.9170893351552456, 0.9194825361628594, 0.9218921210725944, 0.9243252266483534, 0.9267668902399696, 0.929238214203635, 0.9317124815536733, 0.9342202886448684, 0.9367275819156851],\n  b: [0.42257292476430436, 0.43184596598336555, 0.4412064832719169, 0.4506510991070379, 0.4601751103492679, 0.46977222082107756, 0.4794342308257477, 0.4891506793097687, 0.49894160120778436, 0.5087715885336103, 0.5186108302832771, 0.5284836071020165, 0.5383245681077662, 0.5481352134375516, 0.5578435355461391, 0.5674471854200234, 0.5768505865319291, 0.5859821014031293, 0.5947494236872949, 0.6030366129604394, 0.6107077426144937, 0.6176174300439591, 0.6236290832033221, 0.6286357211183263, 0.6325796572366661, 0.6354701889106298, 0.6373742153046679, 0.6383989700654712, 0.638668756905635, 0.6383089542091028, 0.6374350053971095, 0.636146985204408, 0.6345282558695404, 0.6326478270215731, 0.6305768690676523, 0.6283455167242665, 0.6259979600528258, 0.6235717761795677, 0.621081667645192, 0.6185591936304666, 0.616016629522781, 0.6134596708213713, 0.6109238301118911, 0.6083965011432549, 0.6058873223830183, 0.60341417524383, 0.6009787922718963, 0.5985797542127682, 0.596221496217621, 0.5939076044300872, 0.5916414807294642, 0.5894315315373579, 0.5872714908845412, 0.5851627302038015, 0.5831062484926558, 0.5811027291021745, 0.5791525884087009, 0.5772560174768573, 0.5754130176762239, 0.5736234310853615, 0.5718869664041402, 0.5702032209969471, 0.5685716996038682, 0.5669918301827848, 0.5654629772812437, 0.5639844532816007, 0.5625555278152573, 0.5611754356007422, 0.5598433829250934, 0.5585612898846837, 0.5573268773673928, 0.5561380319387883, 0.5549938581786431, 0.5538934528024704, 0.5528359060062189, 0.5518203023495192, 0.5508457212473491, 0.549913365431319, 0.5490228475752887, 0.5481703859285302, 0.5473550236322454, 0.5465757987301746, 0.5458317432175193, 0.5451231873866257, 0.5444513010684173, 0.5438113725374379, 0.5432023919026625, 0.5426233385794481, 0.5420731800699918, 0.5415550926551251, 0.5410638066180113, 0.540597926876092, 0.5401563599016087, 0.5397383042732707, 0.5393460827274305, 0.5389744586257711, 0.5386222668134233, 0.5382883230992108, 0.5379733478625169, 0.5376757027790604, 0.5373922894579649, 0.5371218460871988, 0.5368636833242294, 0.536618361299776, 0.5363817525707026, 0.5361525222751042, 0.5359293193132266, 0.5357133548543864, 0.5355003101591437, 0.5352887824024628, 0.5350773667248226, 0.5348665525352745, 0.5346528031121535, 0.5344345169358407, 0.5342102605335537, 0.5339799959048033, 0.5337406085215398, 0.5334905459074958, 0.5332283775266504, 0.5329535750363619, 0.5326634150194081, 0.5323564832742772, 0.5320314302436226, 0.5316870266023981, 0.5313212748929952, 0.5309328290550865, 0.5305203252817071, 0.5300820599240353, 0.5296167282704776, 0.5291230766564496, 0.5285995915811124, 0.5280443921862177, 0.5274567814051943, 0.5268356212312693, 0.5261791312000029, 0.5254854952988165, 0.5247545535679302, 0.5239852980594518, 0.5231756545447472, 0.5223239185167129, 0.5214304767886039, 0.5204944566826074, 0.5195136536074572, 0.5184861377534478, 0.5174130230514244, 0.5162935692788782, 0.5151259285643696, 0.513906976489259, 0.5126390269795514, 0.5113214639163841, 0.5099537040511894, 0.5085297306531971, 0.5070537569679475, 0.5055253556302098, 0.5039440536705715, 0.5023062065413991, 0.5006109626120457, 0.49886092205559446, 0.4970557164988521, 0.49519500358009544, 0.49327320043306105, 0.49129274764094805, 0.4892553378582481, 0.4871607422199747, 0.4850087606010108, 0.48279556264598117, 0.4805201317683439, 0.4781864627637871, 0.4757945201032026, 0.47334431361562507, 0.47083590349003773, 0.4682667163182039, 0.46563433316514585, 0.46294412957653946, 0.4601965063235069, 0.4573919681273961, 0.45453113947832696, 0.45161478329337396, 0.4486438228496627, 0.4456193674826628, 0.4425380639654961, 0.4394056497009877, 0.4362249727525225, 0.4329983295596442, 0.42972840805534807, 0.42641834706043324, 0.4230718037095968, 0.4196930295353452, 0.4162869557148225, 0.41285928778106906, 0.4094166097874234, 0.4059664974607166, 0.40251763925076683, 0.39907996334425494, 0.39566476762665204, 0.3922848482216537, 0.3889513459863399, 0.38568043413774905, 0.3824934902796896, 0.3794106529717773, 0.3764539238160732, 0.373647073460407, 0.3710154595070918, 0.36858304535734304, 0.36637986074596723, 0.36443633829693634, 0.3627802030453921, 0.3614380620192426, 0.36043549828900656, 0.3597956834322973, 0.35953617653436143, 0.35967076687063276, 0.3602086612732602, 0.3611542742755426, 0.3625096347273936, 0.36426656411016184, 0.36641546843198697, 0.36894367860467714, 0.37183581727406156, 0.37507449518178715, 0.37864099375401244, 0.38251589762619864, 0.3866796514151401, 0.39111302579861484, 0.3957974875667233, 0.40071547599054824, 0.405850593321366, 0.4111824877427081, 0.41669355606115976, 0.4223760515178233, 0.4282186311869483, 0.4342112747863317, 0.44033584973804246, 0.44657231853713225, 0.45293066342084337, 0.4594053245849991, 0.46596504038120606, 0.4726125804953009, 0.47935960153209206, 0.48617718269199267, 0.4930589607663434, 0.5000298200873778, 0.5070444917818385, 0.5141229319104883, 0.5212774789419143, 0.5284479861571415, 0.535698951997222, 0.5429753047678268, 0.5503044468166357, 0.5576799909240343, 0.5650790057480892, 0.572541386344326, 0.5800041593344547, 0.5875425838151492, 0.5950648878797101, 0.6026699962989522],\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [0.0, 1.0],\n  g: [0.0, 0.0],\n  b: [0.0, 0.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        0,\n        0,\n        0,\n        255\n      ],\n      \"toColor\": [\n        255,\n        0,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [0.0, 0.0],\n  g: [0.0, 0.0],\n  b: [0.0, 1.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        0,\n        0,\n        0,\n        255\n      ],\n      \"toColor\": [\n        0,\n        0,\n        255,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [0.0, 0.0],\n  g: [0.0, 1.0],\n  b: [0.0, 0.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        0,\n        0,\n        0,\n        255\n      ],\n      \"toColor\": [\n        0,\n        255,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [0.0, 0.0],\n  g: [0.0, 1.0],\n  b: [0.0, 1.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        0,\n        0,\n        0,\n        255\n      ],\n      \"toColor\": [\n        0,\n        255,\n        255,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [0.0, 1.0],\n  g: [0.0, 1.0],\n  b: [0.0, 0.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        0,\n        0,\n        0,\n        255\n      ],\n      \"toColor\": [\n        255,\n        255,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [0.0, 1.0],\n  g: [0.0, 0.0],\n  b: [0.0, 1.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        0,\n        0,\n        0,\n        255\n      ],\n      \"toColor\": [\n        255,\n        0,\n        255,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [1.0, 1.0],\n  g: [1.0, 0.0],\n  b: [1.0, 0.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        255,\n        255,\n        255,\n        255\n      ],\n      \"toColor\": [\n        255,\n        0,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [1.0, 0.0],\n  g: [1.0, 0.0],\n  b: [1.0, 1.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        255,\n        255,\n        255,\n        255\n      ],\n      \"toColor\": [\n        0,\n        0,\n        255,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [1.0, 0.0],\n  g: [1.0, 1.0],\n  b: [1.0, 0.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        255,\n        255,\n        255,\n        255\n      ],\n      \"toColor\": [\n        0,\n        255,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [1.0, 0.0],\n  g: [1.0, 1.0],\n  b: [1.0, 1.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        255,\n        255,\n        255,\n        255\n      ],\n      \"toColor\": [\n        0,\n        255,\n        255,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [1.0, 1.0],\n  g: [1.0, 1.0],\n  b: [1.0, 0.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        255,\n        255,\n        255,\n        255\n      ],\n      \"toColor\": [\n        255,\n        255,\n        0,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","import type { ColorMap } from \"./types.js\";\n\nconst colormap: ColorMap = {\n  r: [1.0, 1.0],\n  g: [1.0, 0.0],\n  b: [1.0, 1.0],\n};\n\nconst esri = {\n  \"type\": \"multipart\",\n  \"colorRamps\": [\n    {\n      \"type\": \"algorithmic\",\n      \"fromColor\": [\n        255,\n        255,\n        255,\n        255\n      ],\n      \"toColor\": [\n        255,\n        0,\n        255,\n        255\n      ],\n      \"algorithm\": \"esriCIELabAlgorithm\",\n      \"start\": 0.0,\n      \"stop\": 1.0\n    }\n  ]\n};\n\nexport default {\n  colormap,\n  esri,\n};\n","\nimport { magma } from \"./magma\";\nimport { inferno } from \"./inferno\";\nimport { plasma } from \"./plasma\";\nimport { viridis } from \"./viridis\";\nimport { cividis } from \"./cividis\";\nimport { gray } from \"./gray\";\nimport { svs_nitrogen_dioxide, svsColorRamp } from \"./svs_nitrogen_dioxide\";\nimport { sargassum, sargassumColorRamp } from \"./sargassum\";\nimport { haline } from \"./cmo_haline\";\nimport redfromblack from \"./custom_red_from_black\";\nimport bluefromblack from \"./custom_blue_from_black\";\nimport greenfromblack from \"./custom_green_from_black\";\nimport cyanfromblack from \"./custom_cyan_from_black\";\nimport yellowfromblack from \"./custom_yellow_from_black\";\nimport magentafromblack from \"./custom_magenta_from_black\";\nimport redfromwhite from \"./custom_red_from_white\";\nimport bluefromwhite from \"./custom_blue_from_white\";\nimport greenfromwhite from \"./custom_green_from_white\";\nimport cyanfromwhite from \"./custom_cyan_from_white\";\nimport yellowfromwhite from \"./custom_yellow_from_white\";\nimport magentafromwhite from \"./custom_magenta_from_white\";\n\n\nimport type { ColorMaps } from \"./types\";\n\nexport const colormaps: ColorMaps = {\n  \"magma\": magma,\n  \"inferno\": inferno,\n  \"plasma\": plasma,\n  \"viridis\": viridis,\n  \"cividis\": cividis,\n  \"svs\": svs_nitrogen_dioxide,\n  \"sargassum\": sargassum,\n  \"gray\": gray,\n  \"haline\": haline,\n  \"redfromblack\": redfromblack.colormap,\n  \"bluefromblack\": bluefromblack.colormap,\n  \"greenfromblack\": greenfromblack.colormap,\n  \"cyanfromblack\": cyanfromblack.colormap,\n  \"yellowfromblack\": yellowfromblack.colormap,\n  \"magentafromblack\": magentafromblack.colormap,\n  \"redfromwhite\": redfromwhite.colormap,\n  \"bluefromwhite\": bluefromwhite.colormap,\n  \"greenfromwhite\": greenfromwhite.colormap,\n  \"cyanfromwhite\": cyanfromwhite.colormap,\n  \"yellowfromwhite\": yellowfromwhite.colormap,\n  \"magentafromwhite\": magentafromwhite.colormap,\n} as const;\n\n// add custom colormaps here\nexport const nonEsriColormaps = {\n  'svs': {rgb: svs_nitrogen_dioxide, esriColorRamp: svsColorRamp},\n  'sargassum': {rgb: sargassum, esriColorRamp: sargassumColorRamp},\n  'redfromblack': {rgb: redfromblack.colormap, esriColorRamp: redfromblack.esri},\n  'bluefromblack': {rgb: bluefromblack.colormap, esriColorRamp: bluefromblack.esri},\n  'greenfromblack': {rgb: greenfromblack.colormap, esriColorRamp: greenfromblack.esri},\n  'cyanfromblack': {rgb: cyanfromblack.colormap, esriColorRamp: cyanfromblack.esri},\n  'yellowfromblack': {rgb: yellowfromblack.colormap, esriColorRamp: yellowfromblack.esri},\n  'magentafromblack': {rgb: magentafromblack.colormap, esriColorRamp: magentafromblack.esri},\n  'redfromwhite': {rgb: redfromwhite.colormap, esriColorRamp: redfromwhite.esri},\n  'bluefromwhite': {rgb: bluefromwhite.colormap, esriColorRamp: bluefromwhite.esri},\n  'greenfromwhite': {rgb: greenfromwhite.colormap, esriColorRamp: greenfromwhite.esri},\n  'cyanfromwhite': {rgb: cyanfromwhite.colormap, esriColorRamp: cyanfromwhite.esri},\n  'yellowfromwhite': {rgb: yellowfromwhite.colormap, esriColorRamp: yellowfromwhite.esri},\n  'magentafromwhite': {rgb: magentafromwhite.colormap, esriColorRamp: magentafromwhite.esri},\n} as const;\n\nexport type AvailableColorMaps = 'magma' | 'inferno' | 'plasma' | 'viridis' | 'cividis' | 'svs' | 'gray' | 'sargassum' | 'haline' | 'redfromblack' | 'bluefromblack' | 'greenfromblack' | 'cyanfromblack' | 'yellowfromblack' | 'magentafromblack' | 'redfromwhite' | 'bluefromwhite' | 'greenfromwhite' | 'cyanfromwhite' | 'yellowfromwhite' | 'magentafromwhite';\nexport type AvailableReverseColorMaps = `${AvailableColorMaps}_r`;\nexport type AllAvailableColorMaps = AvailableColorMaps \n  | AvailableReverseColorMaps \n  | Lowercase<AvailableColorMaps> \n  | Lowercase<AvailableReverseColorMaps> \n  | Capitalize<AvailableColorMaps>\n  | Capitalize<AvailableReverseColorMaps>\n  | 'None' | 'none';\n","/* eslint-disable @typescript-eslint/naming-convention */\n\n\n// const earthdataRestSerivceURL = \"https://gis.earthdata.nasa.gov/image/rest/services/C2930763263-LARC_CLOUD/TEMPO_NO2_L3_V03_HOURLY_TROPOSPHERIC_VERTICAL_COLUMN/ImageServer\";\nimport { Variables } from './types';\nimport { AllAvailableColorMaps } from '@/colormaps';\n\nexport type ColorRamps = \"Magma\" | \"Inferno\" | \"Plasma\" | \"Viridis\" | \"Gray\" | \"Hillshade\" | \"Cividis\" | AllAvailableColorMaps;\n\ntype PixelType = \"C128\" | \"C64\" | \"F32\" | \"F64\" | \"S16\" | \"S32\" | \"S8\" | \"U1\" | \"U16\" | \"U2\" | \"U32\" | \"U4\" | \"U8\" | \"UNKNOWN\";\n\ninterface RasterFunctionObject {\n  rasterFunction: string;\n  variableName?: string; // Optional, as it might be implied or set by composition\n  rasterFunctionArguments?: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    [key: string]: any;\n    Raster?: RasterFunctionObject | { variableName: string }; // Input can be another function or the base 'Raster'\n  };\n  outputPixelType?: PixelType;\n}\n\n// https://developers.arcgis.com/rest/services-reference/enterprise/raster-function-objects/\n// https://developers.arcgis.com/rest/services-reference/enterprise/raster-function-objects/#resample\n// https://pro.arcgis.com/en/pro-app/latest/help/analysis/raster-functions/stretch-function.htm\nexport function _stretchRule(min: number, max: number, reverse: boolean): RasterFunctionObject {\n  return {\n    'rasterFunction': 'Stretch',\n    'outputPixelType': 'U8' as PixelType,\n    'variableName': 'Raster',\n    'rasterFunctionArguments': {\n      'StretchType': 5,\n      'Statistics': [[\n        min, // max\n        max, // min\n        0, 0\n      ]],\n      'DRA': false,\n      'UseGamma': false,\n      'Gamma': [1],\n      'ComputeGamma': true,\n      'Min': reverse ? 255 : 0,\n      'Max': reverse ? 0 : 255,\n    },\n  };\n}\n\n//https://pro.arcgis.com/en/pro-app/latest/arcpy/spatial-analyst/convolution.html\n//https://developers.arcgis.com/rest/services-reference/enterprise/raster-function-objects/#convolution\nexport function _convolutionRule(size: 3 | 5): RasterFunctionObject {\n  return {\n    'rasterFunction': 'Convolution',\n    'rasterFunctionArguments': {\n      \"Type\": size === 3 ? 11 : size === 5 ? 12 : 11,\n    },\n    'variableName': 'Raster',\n  };\n}\n\nexport const stretches = {\n  'NO2_Troposphere': [0, 15_000_000_000_000_000],\n  'Ozone_Column_Amount': [250, 430], // +- 2 sigma\n  'HCHO': [1_000_000_000_000_000, 30_000_000_000_000_000],\n} as Record<Variables, [number, number]>;\nexport const colorramps = {\n  'NO2_Troposphere': 'Magma_r',\n  'Ozone_Column_Amount': 'Cividis_r', \n  'HCHO': 'Viridis_r',\n} as Record<Variables, ColorRamps>;\n\nexport const rgbstretches = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  'NO2_Troposphere': [0, 7_500_000_000_000_000],\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  'Ozone_Column_Amount': [250, 430], // +- 2 sigma\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  'HCHO': [1_000_000_000_000_000, 15_000_000_000_000_000],\n} as Record<string, [number, number]>;\nexport const rgbcolorramps = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  'NO2_Troposphere': 'redfromwhite',\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  'Ozone_Column_Amount': 'greenfromwhite', \n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  'HCHO': 'bluefromwhite',\n} as Record<string, ColorRamps>;\n\nexport const colorbarOptions = {\n  'no2': {\n    stretch: stretches['NO2_Troposphere'], \n    rgbstretch: rgbstretches['NO2_Troposphere'], \n    cbarScale: 1e14, \n    colormap: colorramps['NO2_Troposphere'], \n    rgbcolormap: rgbcolorramps['NO2_Troposphere'],\n    label:'NO<sub>2</sub>',\n    unit: \"mol/cm<sup>2</sup>\",\n  },\n  'no2Monthly': {\n    stretch: stretches['NO2_Troposphere'], \n    rgbstretch: rgbstretches['NO2_Troposphere'], \n    cbarScale: 1e14, \n    colormap: colorramps['NO2_Troposphere'], \n    rgbcolormap: rgbcolorramps['NO2_Troposphere'],\n    label: 'NO<sub>2</sub>',\n    unit: \"mol/cm<sup>2</sup>\",\n  },\n  'no2DailyMax': {\n    stretch: stretches['NO2_Troposphere'], \n    rgbstretch: rgbstretches['NO2_Troposphere'], \n    cbarScale: 1e14, \n    colormap: colorramps['NO2_Troposphere'], \n    rgbcolormap: rgbcolorramps['NO2_Troposphere'],\n    label: 'NO<sub>2</sub>',\n    unit: \"mol/cm<sup>2</sup>\",\n  },\n  'o3': {\n    stretch: stretches['Ozone_Column_Amount'], \n    rgbstretch: rgbstretches['Ozone_Column_Amount'], \n    cbarScale: 1, \n    colormap: colorramps['Ozone_Column_Amount'], \n    rgbcolormap: rgbcolorramps['Ozone_Column_Amount'],\n    label: 'Ozone',\n    unit: \"Dobson Units\",\n  },\n  'hcho': {\n    stretch: stretches['HCHO'], \n    rgbstretch: rgbstretches['HCHO'], \n    cbarScale: 1e14, \n    colormap: colorramps['HCHO'], \n    rgbcolormap: rgbcolorramps['HCHO'],\n    label: 'Formaldehyde',\n    unit: \"mol/cm<sup>2</sup>\",\n  },\n  'hchoMonthly': {\n    stretch: stretches['HCHO'], \n    rgbstretch: rgbstretches['HCHO'], \n    cbarScale: 1e14, \n    colormap: colorramps['HCHO'], \n    rgbcolormap: rgbcolorramps['HCHO'],\n    label: 'Formaldehyde',\n    unit: \"mol/cm<sup>2</sup>\",\n  },\n  'hchoDailyMax': {\n    stretch: stretches['HCHO'], \n    rgbstretch: rgbstretches['HCHO'], \n    cbarScale: 1e14, \n    colormap: colorramps['HCHO'], \n    rgbcolormap: rgbcolorramps['HCHO'],\n    label: 'Formaldehyde',\n    unit: \"mol/cm<sup>2</sup>\",\n  },\n};\n\nimport { nonEsriColormaps } from '@/colormaps';\n\n\nexport function _colorMapRule(colorRamp: ColorRamps): RasterFunctionObject {\n  if (Object.keys(nonEsriColormaps).includes((colorRamp as string).toLowerCase())) {\n    // console.log('using non esri colormap:', colorRamp);\n    return {\n      'rasterFunction': 'Colormap',\n      'variableName': 'Raster',\n      'rasterFunctionArguments': {\n        'colorramp': nonEsriColormaps[colorRamp.toLowerCase()].esriColorRamp,\n      },\n    };\n  }\n  // console.log('using esri colormap:', colorRamp);\n  return {\n    'rasterFunction': 'Colormap',\n    'variableName': 'Raster',\n    'rasterFunctionArguments': {\n      'ColormapName': colorRamp,\n    },\n  };\n}\n\nexport type ResamplingType = '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' ; \n//0=NearestNeighbor, 1=Bilinear, 2=Cubic, 3=Majority, 4=BilinearInterpolationPlus, 5=BilinearGaussBlur, 6=BilinearGaussBlurPlus, 7=Average, 8=Minimum, 9=Maximum\n\nexport enum ResamplingTypeEnum {\n  NearestNeighbor = '0',\n  Bilinear = '1',\n  Cubic = '2',\n  Majority = '3',\n  BilinearInterpolationPlus = '4',\n  BilinearGaussBlur = '5',\n  BilinearGaussBlurPlus = '6',\n  Average = '7',\n  Minimum = '8',\n  Maximum = '9'\n}\n\n\n\nexport function _resampleRule(resamplingType: keyof typeof ResamplingTypeEnum): RasterFunctionObject {\n  return {\n    'rasterFunction': 'Resample',\n    'variableName': 'Raster',\n    'rasterFunctionArguments': {\n      'ResamplingType': ResamplingTypeEnum[resamplingType], // Convert string to enum value\n    },\n  };\n}\n\n\nexport function composeRasterRules(\n  ...rules: RasterFunctionObject[]\n): RasterFunctionObject {\n  if (rules.length === 0) {\n    throw new Error('composeRasterRules requires at least one rule');\n  }\n\n  if (rules.length === 1) {\n    return { ...rules[0] };\n  }\n\n  let currentRule: RasterFunctionObject = { ...rules[0] };\n\n  for (let i = 1; i < rules.length; i++) {\n    const nextOuterRule = { ...rules[i] }; // Copy to avoid modifying original rule objects\n\n    // Ensure rasterFunctionArguments exists\n    if (!nextOuterRule.rasterFunctionArguments) {\n      nextOuterRule.rasterFunctionArguments = {};\n    }\n\n    // Assign the current (inner) rule as the 'Raster' input to the next outer rule.\n    nextOuterRule.rasterFunctionArguments.Raster = currentRule;\n\n    currentRule = nextOuterRule; // The newly composed rule becomes the current one for the next iteration\n  }\n\n  return currentRule;\n}\n\nexport const renderingRule = (range: [number, number], colormap: ColorRamps, _resamplineRule: keyof typeof ResamplingTypeEnum = 'NearestNeighbor'): RasterFunctionObject => {\n  let reverse = false;\n  let colormapName = colormap;\n  if (colormap.endsWith('_r')) {\n    reverse = true;\n    colormapName = colormap.slice(0, -2) as ColorRamps;\n  }\n  return composeRasterRules(\n    _stretchRule(Math.min(...range), Math.max(...range), reverse), \n    _colorMapRule(colormapName), \n  );\n};\n\nexport interface RenderingRuleOptions {\n  range: [number, number];\n  colormap: ColorRamps;\n}\n\ninterface MultidimensionalDefinition {\n  variableName: string;\n  dimensionName: string;\n  values: number[] | Array<number[]>;\n}\n\n\n\nexport interface EsriSlice {\n  sliceId: number;\n  multidimensionalDefinition: MultidimensionalDefinition[];\n}\n\nexport interface EsriSliceResponse {\n  slices: EsriSlice[];\n}\n\n\nexport type VariableNames = 'NO2_Troposphere' | 'Ozone_Column_Amount' | 'HCHO';\n\nexport async function fetchEsriTimeSteps(esriUrl: string, variableName: VariableNames, dimensionName = \"StdTime\"): Promise<EsriSliceResponse> {\n  const url = esriUrl + '/slices';\n  const format = \"json\";\n  const multidimensionalDefinition = { variableName: variableName, dimensionName: dimensionName };\n  const params = { f: format, multidimensionalDefinition: JSON.stringify(multidimensionalDefinition) };\n  const fetchURL = new URL(url);\n  fetchURL.search = new URLSearchParams(params).toString();\n  return fetch(fetchURL).then(res => {\n    return res.json();\n  });\n}\n\nexport function extractTimeSteps(data: EsriSliceResponse): number[] {\n  const slices = data.slices;\n  const timesteps = slices.map(slice => slice.multidimensionalDefinition[0].values[0]);\n  // check if timesteps are arrays or numbers. if arrays take first element of each\n\n\n  return timesteps.reduce((acc: number[], val) => {\n    if (Array.isArray(val)) {\n      return acc.concat(val[0]);\n    } else {\n      acc.push(val);\n      return acc;\n    }\n  }, []);\n}\n","import { extractTimeSteps, fetchEsriTimeSteps, VariableNames } from \"./ImageLayerConfig\";\n\nimport type { MoleculeType } from \"@/types\";\nexport type { MoleculeType } from \"@/types\";\n\n// The two data set versions cover different time periods (V03 is earlier than V04)\n\nexport const ESRI_URLS_V03: Record<MoleculeType, { url: string; variable: VariableNames }> = {\n  'no2': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C2930763263-LARC_CLOUD/TEMPO_NO2_L3_V03_HOURLY_TROPOSPHERIC_VERTICAL_COLUMN/ImageServer\",\n    variable: \"NO2_Troposphere\",\n  },\n  // 'no2Monthly': {\n  //   url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_NO2_L3_V03_Monthly_Mean/ImageServer\",\n  //   variable: \"NO2_Troposphere\",\n  // },\n  // 'no2DailyMax' : {\n  //   url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_NO2_L3_V03_Daily_Maximum/ImageServer\",\n  //   variable: \"NO2_Troposphere\",\n  // },\n  'o3': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C2930764281-LARC_CLOUD/TEMPO_O3TOT_L3_V03_HOURLY_OZONE_COLUMN_AMOUNT/ImageServer\",\n    variable: \"Ozone_Column_Amount\",\n  },\n  'hcho': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C2930761273-LARC_CLOUD/TEMPO_HCHO_L3_V03_HOURLY_VERTICAL_COLUMN/ImageServer\",\n    variable: \"HCHO\",\n  },\n  // 'hchoMonthly': {\n  //   url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_HCHO_L3_V03_Monthly_Mean/ImageServer\",\n  //   variable: \"HCHO\",\n  // },\n  // 'hchoDailyMax': {\n  //   url: \"https://gis.earthdata.nasa.gov/gp/rest/services/Hosted/TEMPO_HCHO_L3_V03_Daily_Maximum/ImageServer\",\n  //   variable: \"HCHO\",\n  // },\n} as const;\n\nexport const ESRI_URLS_V04: Record<MoleculeType, { url: string; variable: VariableNames }> = {\n  'no2': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C3685896708-LARC_CLOUD/TEMPO_NO2_L3_V04_HOURLY_TROPOSPHERIC_VERTICAL_COLUMN/ImageServer\",\n    variable: \"NO2_Troposphere\",\n  },\n  'o3': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C3685896625-LARC_CLOUD/TEMPO_O3TOT_L3_V04_HOURLY_OZONE_COLUMN_AMOUNT/ImageServer\",\n    variable: \"Ozone_Column_Amount\",\n  },\n  'hcho': {\n    url: \"https://gis.earthdata.nasa.gov/image/rest/services/C3685897141-LARC_CLOUD/TEMPO_HCHO_L3_V04_HOURLY_VERTICAL_COLUMN/ImageServer\",\n    variable: \"HCHO\",\n  },\n} as const;\n\nexport const ESRI_URL_LIST = [ESRI_URLS_V03, ESRI_URLS_V04]; // in chronological order\n\nexport const MOLECULE_OPTIONS: {title: string, value: MoleculeType }[] = [\n  { title: 'NO', value: 'no2' },\n  // { title: 'Monthly Mean NO', value: 'no2Monthly' },\n  // { title: 'Daily Max NO', value: 'no2DailyMax' },\n  { title: 'O', value: 'o3' },\n  { title: 'HCHO', value: 'hcho' },\n  // { title: 'Monthly Mean HCHO', value: 'hchoMonthly' },\n  // { title: 'Daily Max HCHO', value: 'hchoDailyMax' },\n] as const;\n\nexport interface MoleculeDescriptor {\n    fullName: {text: string, html: string},\n    shortName: {text: string, html: string},\n    unit: {text: string, html: string},\n    shortUnit: {text: string, html: string},\n  }\n\n/**\n * @type Record<MoleculeType, MoleculeDescriptor>\n */\nexport const MOLECULE_NAMES: Record<MoleculeType, MoleculeDescriptor>  = {\n  no2: {\n    fullName: {text: 'Nitrogen Dioxide', html: 'Nitrogen Dioxide'},\n    shortName: {text: 'NO', html: 'NO<sub>2</sub>'},\n    unit: {text: 'molecules/cm', html: \"Molecules / cm<sup>2</sup>\"},\n    shortUnit: {text: 'mol./cm', html: \"mol./cm<sup>2</sup>\"},\n  },\n  o3: {\n    fullName: {text: 'Ozone', html: 'Ozone'},\n    shortName: {text: 'O', html: 'O<sub>3</sub>'},\n    unit: {text: 'Dobson Units', html: 'Dobson Units'},\n    shortUnit: {text: 'DU', html: 'DU'},\n  },\n  hcho: {\n    fullName: {text: 'Formaldehyde', html: 'Formaldehyde'},\n    shortName: {text: 'HCHO', html: 'HCHO'},\n    unit: {text: 'molecules/cm', html: \"Molecules / cm<sup>2</sup>\"},\n    shortUnit: {text: 'mol./cm', html: \"mol./cm<sup>2</sup>\"},\n  }, \n} as const;\n\nexport function moleculeDescriptor(molecule: MoleculeType): MoleculeDescriptor {\n  if (molecule && molecule.toLowerCase() in MOLECULE_NAMES) {\n    return MOLECULE_NAMES[molecule.toLowerCase()];\n  }\n  throw new Error(`Unknown molecule type: ${molecule}`);\n}\n\n\nexport function moleculeName(molecule: MoleculeType): string {\n  return MOLECULE_OPTIONS.find(m => m.value == molecule)?.title ?? \"\";\n}\n\nexport async function getEsriTimesteps(url: string, variable: VariableNames): Promise<number[]> {\n  return fetchEsriTimeSteps(url, variable).then(extractTimeSteps);\n}\n","export type EsriGeometryType = 'esriGeometryPoint' | 'esriGeometryMultipoint' | 'esriGeometryPolyline' | 'esriGeometryPolygon' | 'esriGeometryEnvelope';\n\nexport type RectBounds = {\n  xmin: number;\n  ymin: number;\n  xmax: number;\n  ymax: number;\n};\n\nexport type PointBounds = {\n  x: number;\n  y: number;\n};\nexport function rectangleToGeometry(rect: RectBounds) {\n  const { xmin, ymin, xmax, ymax } = rect;\n  return {\n    rings: [[\n      [xmin, ymin],\n      [xmin, ymax],\n      [xmax, ymax],\n      [xmax, ymin],\n      [xmin, ymin]\n    ]],\n    spatialReference: { wkid: 4326 } // Assuming WGS 84\n    // spatialReference: { wkid: 3857 } // Web Mercator. idk if this really matters for points\n  };\n}\n\nexport function pointToGeometry(point: PointBounds) {\n  const { x, y } = point;\n  return {\n    x: x,\n    y: y,\n    spatialReference: { wkid: 4326 } // Assuming WGS 84\n    // spatialReference: { wkid: 3857 } // Web Mercator. idk if this really matters for points\n  };\n}","export function isBad(v: number | null | undefined): v is null | undefined {\n  return v === null || v === undefined || isNaN(v);\n}\n\nexport function nan2null(v: number | null): number | null {\n  return isBad(v) ? null : v;\n}\n\n\n// typeof NaN is 'number'. Just included here \ntype DirtyNumberArray = Array<number | null | typeof NaN | undefined>;\n\nfunction _getValidData(arr: DirtyNumberArray) {\n  const validArr: number[] = [];\n  let sum = 0;\n  for (const v of arr) {\n    if (!isBad(v)) {\n      validArr.push(v);\n      sum += v;\n    }\n  }\n  return { validArr, sum, length: validArr.length };\n}\n\nfunction _length(arr: DirtyNumberArray): number {\n  return arr.length;\n}\n\nfunction _nanLength(arr: DirtyNumberArray): number {\n  return arr.filter(v => !isBad(v)).length;\n}\n\nexport function sum(arr: DirtyNumberArray): number | null {\n  if (arr.length === 0 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  return (arr as number[]).reduce((a, b) => a + b, 0);\n}\n\nexport function nansum(arr: DirtyNumberArray): number {\n  const { sum } = _getValidData(arr);\n  return sum;\n}\n\nexport function mean(arr: DirtyNumberArray): number | null {\n  // filter nan, null, undefined\n  if (arr.length === 0 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  const sum = (arr as number[]).reduce((a, b) => a + b, 0);\n  return sum / arr.length;\n}\n\nexport function nanmean(_arr: DirtyNumberArray): number | null {\n  const { sum, length } = _getValidData(_arr);\n  if (length === 0) return null;\n  return sum / length;\n}\n\nexport function difference(a: number | null | undefined, b: number | null | undefined): number | null {\n  if (isBad(a) || isBad(b)) return null;\n  return a - b;\n}\n\nexport function diff(arr: DirtyNumberArray): (number | null)[] {\n  const result: (number | null)[] = [];\n  for (let i = 1; i < arr.length; i++) {\n    result.push(difference(arr[i],arr[i - 1]));\n  }\n  return result;\n}\n\n\nexport function variance(arr: DirtyNumberArray): number | null {\n  if (arr.length < 2 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  const m = mean(arr);\n  if (m === null) return null;\n  const diffs = (arr as number[]).map(v => (v - m) * (v - m));\n  return mean(diffs); // mean = sum(diffs) / n\n}\n\nexport function stdev(arr: DirtyNumberArray): number | null {\n  const v = variance(arr);\n  if (v === null) return null;\n  return Math.sqrt(v);\n}\n\nexport function standardError(arr: DirtyNumberArray): number | null {\n  const s = stdev(arr);\n  return s ? s / Math.sqrt(arr.length) : null;\n}\n\nexport function nanvariance(arr: DirtyNumberArray): number | null {\n  const { validArr, length } = _getValidData(arr);\n  if (length < 2) {\n    return null;\n  }\n  const m = nanmean(validArr);\n  if (m === null) return null;\n  const diffs = validArr.map(v => (v - m) * (v - m));\n  const result = nanmean(diffs);\n  return result;\n}\n\n\nexport function nanstdev(arr: DirtyNumberArray): number | null {\n  const v = nanvariance(arr);\n  if (v === null) return null;\n  return Math.sqrt(v);\n}\n\nexport function nanstandardError(arr: DirtyNumberArray): number | null {\n  const stdev = nanstdev(arr);\n  const length = _nanLength(arr);\n  if (stdev === null || length === 0) return null;\n  return stdev / Math.sqrt(length);\n}\n\nexport function median(arr: DirtyNumberArray): number | null {\n  if (arr.length === 0 || arr.some(v => isBad(v))) {\n    return null;\n  }\n  const sorted = [...(arr as number[])].sort((a, b) => a - b);\n  const mid = Math.floor(sorted.length / 2);\n  \n  if (sorted.length % 2 === 0) {\n    return (sorted[mid - 1] + sorted[mid]) / 2;\n  } else {\n    return sorted[mid];\n  }\n}\n\nexport function nanmedian(arr: DirtyNumberArray): number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  return median(validArr);\n}\n\nexport function nanmedianAbsoluteDeviation(arr: DirtyNumberArray): number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  const med = median(validArr);\n  if (med === null) return null;\n  const absDevs = validArr.map(v => Math.abs(v - med));\n  return median(absDevs);\n}\n\nexport function mad(arr: number[]): number;\nexport function mad(arr: DirtyNumberArray): number | null {\n  const med = median(arr);\n  if (med === null) return null;\n  const absDevs = (arr as number[]).map(v => Math.abs(v - med));\n  return median(absDevs);\n}\n\nexport function nanmad(arr: DirtyNumberArray): number | null {\n  return nanmedianAbsoluteDeviation(arr);\n}\n\n\nexport function arrayMax(arr: number[]): number | null {\n  if (arr.length === 0) {\n    return null;\n  }\n\n  return arr.reduce((max, current) => {\n    return current > max ? current : max;\n  });\n}\n\nexport function arrayMin(arr: number[]): number | null {\n  if (arr.length === 0) {\n    return null;\n  }\n\n  return arr.reduce((min, current) => {\n    return current < min ? current : min;\n  });\n}\n\nexport function nanmin(arr: DirtyNumberArray, returnIndex: true): { value: number, index: number } | null;\nexport function nanmin(arr: DirtyNumberArray, returnIndex?: false): number | null;\nexport function nanmin(arr: DirtyNumberArray, returnIndex = false): { value: number, index: number } | number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  if (!returnIndex) {\n    return arrayMin(validArr);\n  } else {\n    const r = validArr.reduce((min, val, idx) => val < min.value ? { value: val, index: idx } : min, { value: validArr[0], index: 0 });\n    return r;\n  }\n}\n\nexport function nanmax(arr: DirtyNumberArray, returnIndex: true): { value: number, index: number } | null;\nexport function nanmax(arr: DirtyNumberArray, returnIndex?: false): number | null;\nexport function nanmax(arr: DirtyNumberArray, returnIndex = false): { value: number, index: number } | number | null {\n  const { validArr } = _getValidData(arr);\n  if (validArr.length === 0) return null;\n  if (!returnIndex) {\n    return arrayMax(validArr);\n  } else {\n    const r = validArr.reduce((max, val, idx) => val > max.value ? { value: val, index: idx } : max, { value: validArr[0], index: 0 });\n    return r;\n  }\n}\n\n\n\n// Combining errors in quadrature\nexport function sumOfSquares(arr: number[]): number {\n  return arr.reduce((acc, val) => acc + val * val, 0);\n}\n\nexport function nanSumOfSquares(arr: DirtyNumberArray): number {\n  const { validArr } = _getValidData(arr);\n  return sumOfSquares(validArr);\n}\n\nexport function meanOfSquares(arr: DirtyNumberArray): number | null {\n  const { validArr, length } = _getValidData(arr);\n  if (length === 0) return null;\n  return sumOfSquares(validArr) / length;\n}\nexport function nanMeanOfSquares(arr: DirtyNumberArray): number | null {\n  const { validArr, length } = _getValidData(arr);\n  if (length === 0) return null;\n  return sumOfSquares(validArr) / length;\n}\n\nexport function rootMeanSquare(arr: DirtyNumberArray): number | null{\n  const ms = meanOfSquares(arr);\n  if (ms === null) return null;\n  return Math.sqrt(ms);\n}\n\nexport function nanRootMeanSquare(arr: DirtyNumberArray): number | null {\n  const ms = nanMeanOfSquares(arr);\n  if (ms === null) return null;\n  return Math.sqrt(ms);\n}\n\nexport function weightedMean(values: DirtyNumberArray, errors: DirtyNumberArray): {mean: number | null, error: number | null} {\n  if (values.length === 0 || values.length !== errors.length) {\n    return {mean: null, error: null};\n  }\n  let weightedSum = 0;\n  let weightTotal = 0;\n  for (let i = 0; i < values.length; i++) {\n    const v = values[i];\n    const e = errors[i];\n    if (isBad(v) || isBad(e) || e === 0) {\n      continue; // skip bad values or zero error\n    }\n    const weight = 1 / (e * e);\n    weightedSum += v * weight;\n    weightTotal += weight;\n  }\n  if (weightTotal === 0) return {mean: null, error: null};\n  return {mean: weightedSum / weightTotal, error: Math.sqrt(1 / weightTotal)};\n} \n\nexport function clip(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\nexport function allEqual<T>(arr: T[]): boolean {\n  if (arr.length === 0) return true;\n  const first = arr[0];\n  return arr.every(v => v === first);\n}\n\nexport function arraysEqual<T>(arr1: T[] | undefined, arr2: T[] | undefined): boolean {\n  /* if either or both are undefined, then not equal */\n  // if (arr1 === undefined && arr2 === undefined) return true; /* ignore: both undefined is equal */\n  if (arr1 === undefined || arr2 === undefined) return false;\n  if (arr1.length !== arr2.length) return false; /* check lengths first */\n  /* single pass element comparison */\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) return false;\n  }\n  return true;\n}\n\n\nexport function cycleIndex<T>(index: number, arr: T[] | undefined | null): number {\n  return (arr && index < arr.length) ? index : (index % (arr?.length || 1));\n}  \n\nexport function cycle<T>(index: number, arr: T[] | undefined | null): T | null {\n  if (!arr || arr.length === 0) return null;\n  return arr[cycleIndex(index, arr)];\n}","// algorithm to predict how esri will sample the region\nimport { RectBounds } from \"../geometry\";\nimport { EsriImageServiceSpec } from \"../types\";\n\nexport class EsriSampler {\n  public metadata: EsriImageServiceSpec | undefined;\n  public geometry: RectBounds | undefined;\n  public serviceBounds: RectBounds;\n  public pixelXSize: number;\n  public pixelYSize: number;\n  private serviceXsize: number;\n  private serviceYsize: number;\n  \n    \n  constructor(\n    serviceMetaData: EsriImageServiceSpec, \n    geometry?: RectBounds\n  ) {\n    this.metadata = serviceMetaData;\n    this.geometry = geometry;\n    \n    this.serviceBounds = {\n      xmin: serviceMetaData.fullExtent.xmin,\n      ymin: serviceMetaData.fullExtent.ymin,\n      xmax: serviceMetaData.fullExtent.xmax,\n      ymax: serviceMetaData.fullExtent.ymax\n    };\n    \n    this.pixelXSize = serviceMetaData.pixelSizeX;\n    this.pixelYSize = serviceMetaData.pixelSizeY;\n    this.serviceXsize = this.serviceBounds.xmax - this.serviceBounds.xmin;\n    this.serviceYsize = this.serviceBounds.ymax - this.serviceBounds.ymin;\n  }\n  \n  setGeometry(geometry: RectBounds) {\n    // this.geometry = {\n    //   xmin: Math.min(geometry.xmin, geometry.xmax),\n    //   ymin: Math.min(geometry.ymin, geometry.ymax),\n    //   xmax: Math.max(geometry.xmin, geometry.xmax),\n    //   ymax: Math.max(geometry.ymin, geometry.ymax)\n    // };\n    this.geometry = geometry; // we need to maintain the orientation\n    // the orientation affects the sampling locations.\n  }\n  \n  // not the geometry X and Y size are signed. \n  // It is not garunteed that xmax > xmin or ymax > ymin\n  // The Esri Image ser\n  get geometryXsize(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    return (this.geometry.xmax - this.geometry.xmin);\n  }\n  \n  get geometryYsize(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    return (this.geometry.ymax - this.geometry.ymin);\n  }\n  \n  setMetadata(serviceMetaData: EsriImageServiceSpec) {\n    this.metadata = serviceMetaData;\n    this.serviceBounds = {\n      xmin: serviceMetaData.fullExtent.xmin,\n      ymin: serviceMetaData.fullExtent.ymin,\n      xmax: serviceMetaData.fullExtent.xmax,\n      ymax: serviceMetaData.fullExtent.ymax\n    }  ;\n    this.pixelXSize = serviceMetaData.pixelSizeX;\n    this.pixelYSize = serviceMetaData.pixelSizeY;\n    this.serviceXsize = this.serviceBounds.xmax - this.serviceBounds.xmin;\n    this.serviceYsize = this.serviceBounds.ymax - this.serviceBounds.ymin;\n  }  \n  \n  get geometryAspectRatio(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    const latSize = Math.abs(this.geometry.ymax - this.geometry.ymin);\n    const lonSize = Math.abs(this.geometry.xmax - this.geometry.xmin);\n    return lonSize / latSize;\n  }\n  \n  get geometryArea(): number {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n    const latSize = Math.abs(this.geometry.ymax - this.geometry.ymin);\n    const lonSize = Math.abs(this.geometry.xmax - this.geometry.xmin);\n    return latSize * lonSize;\n  }\n  \n  getSampleDistance(sampleCount: number): number {\n    return Math.sqrt(this.geometryArea) / Math.sqrt(sampleCount);\n  }\n  \n  getSampleCount(sampleDistance: number): number {\n    return this.geometryArea / (sampleDistance * sampleDistance);\n  }\n  \n  get pixelSize(): number {\n    return Math.sqrt(this.pixelXSize * this.pixelYSize);\n  }\n  \n  calculateActualSampleCount(initialSampleCount: number): number {\n    let sampleDistance = this.getSampleDistance(initialSampleCount);\n    \n    if (sampleDistance < this.pixelSize) {\n      sampleDistance = this.pixelSize;\n    }\n\n    const nx = Math.round(Math.abs(this.geometryXsize) / sampleDistance);\n    const ny = Math.round(Math.abs(this.geometryYsize) / sampleDistance);\n    const actualSampleCount = nx * ny;\n    return actualSampleCount;\n  }\n  \n  getSamplingSpecificationFromSamplingDistance(sampleDistance: number) {\n    const nx = Math.round(Math.abs(this.geometryXsize) / sampleDistance);\n    const ny = Math.round(Math.abs(this.geometryYsize) / sampleDistance);\n    const count = nx * ny;\n    return {\n      count,\n      distance: sampleDistance,\n      lats: ny,\n      lons: nx\n    };\n  }\n  \n  getSamplingSpecificationFromSampleCount(initialSampleCount: number, permitOversampling: boolean = false) {\n    let sampleDistance = this.getSampleDistance(initialSampleCount);\n    \n    if ((sampleDistance < this.pixelSize) && !permitOversampling) {\n      const adjustedSampleCount = this.getSamplingSpecificationFromSamplingDistance(this.pixelSize).count;\n      sampleDistance = this.getSampleDistance(adjustedSampleCount);\n    }\n\n    return this.getSamplingSpecificationFromSamplingDistance(sampleDistance);\n    \n  }\n  \n  \n  /** \n  Predict the sampling locations based on the geometry and metadata\n  Returns an object with x and y arrays of sampling locations\n  \n  Esri seems to always sample starting from the upper-left corner.\n  **/\n  getSampleLocations(sampleCount: number) {\n    if (!this.geometry) {\n      throw new Error('Geometry not set');\n    }\n\n    const spec = this.getSamplingSpecificationFromSampleCount(sampleCount);\n    const lats: number[] = [];\n    const lons: number[] = [];\n    const _ysign = Math.sign(this.geometryXsize);\n    const _xsign = Math.sign(this.geometryXsize);\n    \n    // spacing function for each sample\n    const delta = (i: number) => i * spec.distance + spec.distance / 2;\n\n    for (let i = 0; i < spec.lats; i++) {\n      lats.push(Math.max(this.geometry.ymin, this.geometry.ymax) - delta(i));\n    }\n    for (let j = 0; j < spec.lons; j++) {\n      lons.push(Math.min(this.geometry.xmin, this.geometry.xmax) + delta(j));\n    }\n    return {x: lons, y: lats, spec: spec};\n    \n  }\n  \n  getSampleLocationsGrid(sampleCount: number) {\n    const locations = this.getSampleLocations(sampleCount);\n    const points: {x: number, y: number}[] = [];\n    for (let i = 0; i < locations.x.length; i++) {\n      for (let j = 0; j < locations.y.length; j++) {\n        points.push({x: locations.x[i], y: locations.y[j]});\n      }\n    }\n    return points;\n  }\n  \n}","export type HMFormatterFunction = (hour: number, minute: number, ampm?: boolean) => string;\n\n\n/**\n * Parse a string to a timme. Support H, H:MM, HH, HH:MM, and am/pm\n * \n */\nexport function parseTimeString(timeString: string): { hour: number; minute: number } | null {\n  \n  // get a lower case version, and remove spaces\n  const lower = timeString.toLowerCase().replace(/\\s+/g, '');\n\n  // Defeine regexes\n  // Match the hour part (1 or 2 digits)\n  const hourRegex = /^(\\d{1,2})/; \n  // Match the minute part (optional, preceded by a colon)\n  const minuteRegex = /(?::(\\d{1,2}))/; \n  // Matches the am/pm suffix, required\n  const ampmRegex = /(am|pm)$/; \n  \n  \n  const ampmMatch = lower.match(new RegExp(`${hourRegex.source}${minuteRegex.source}?${ampmRegex.source}`));\n  if (ampmMatch) {\n    let hour = parseInt(ampmMatch[1], 10);\n    const minute = ampmMatch[2] ? parseInt(ampmMatch[2], 10) : 0;\n    const suffix = ampmMatch[3];\n    if (suffix === 'pm' && hour < 12) hour += 12;\n    if (suffix === 'am' && hour === 12) hour = 0;\n    return { hour, minute };\n  }\n  \n  const m = lower.match(new RegExp(`${hourRegex.source}${minuteRegex.source}?`));\n  if (!m) return null;\n  const h = parseInt(m[1], 10);\n  const mm = m[2] ? parseInt(m[2], 10) : 0;\n  if (isNaN(h) || h < 0 || h > 23) return null;\n  if (isNaN(mm) || mm < 0 || mm > 59) return null;\n  return { hour: h, minute: mm }; \n}\n\n\nexport function formatTimeHHMM24(time: {hour: number, minute: number}): string {\n  return `${String(time.hour).padStart(2, '0')}:${String(time.minute).padStart(2, '0')}`;\n}\n\n\nexport function normalizeTimeRange(timeRangeStr: string, formatter: HMFormatterFunction): string | null {\n  const parts = timeRangeStr.split('-').map(p => p.trim());\n  if (parts.length !== 2) return null;\n  let startParsed = parseTimeString(parts[0]);\n  let endParsed = parseTimeString(parts[1]);\n  if (!startParsed || !endParsed) return null;\n  const endEarlier = (endParsed.hour + endParsed.minute / 60) < (startParsed.hour + startParsed.minute / 60);\n  if (endEarlier) {\n    /* Situations where due to user errorr end time is earlier than start time:\n    1. hours are equal, swap -> just swap them\n    2. start <= 12 and end < 12 -> end is pm\n    */\n    if (startParsed.hour === endParsed.hour) {\n      // swap\n      [startParsed, endParsed] = [endParsed, startParsed];\n    } else if (startParsed.hour <= 12 && endParsed.hour < 12) {\n      endParsed.hour += 12;\n    } else if (startParsed.hour > 12 && endParsed.hour <= 12) {\n      [startParsed, endParsed] = [endParsed, startParsed];\n    } else {\n      throw new Error(`Cannot parse time range: ${timeRangeStr} with start ${startParsed} and end ${endParsed}`);\n    }\n  }\n  const startStr = formatter(startParsed.hour, startParsed.minute, true);\n  const endStr = formatter(endParsed.hour, endParsed.minute, true);\n  return [startStr, endStr].join('-');\n}\n\n// Normalize entered times to HH:MM 24h (flexible entry via copilot)\nexport function _normalizeTimes(values: string[], formatter: HMFormatterFunction): string[] {\n  const normalized = values\n    .map(v => String(v).trim())\n    .map(v => {\n      if (v.includes('-')) {\n        console.log('parsing range', v);\n        const range = normalizeTimeRange(v, formatter);\n        return range;\n      }\n      const parsed = parseTimeString(v);\n      if (!parsed) return null;\n      return formatter(parsed.hour, parsed.minute, true);\n    })\n    .filter((v): v is string => !!v);\n  // Deduplicate\n  return normalized;\n\n}","function diff(arr: number[]): number[] {\n  const result: number[] = [];\n  for (let i = 1; i < arr.length; i++) {\n    result.push(arr[i] - arr[i - 1]);\n  }\n  return result;\n}\n\n\n// function ringAccessor<T>(arr: T[], n: number): T {\n//   return arr[n % arr.length];\n// }\n\nfunction isLinearConsecutive(arr: number[], validDiffs = [1]): boolean {\n  return diff(arr).every(d => validDiffs.includes(d));\n}\n\nfunction getIndices<T>(arr: T[], order: T[]): number[] {\n  return arr.map(a => order.indexOf(a));\n}\n\n\n/**\n * Check if the elements in arr are consecutive in a ring defined by order\n * @param arr Array of elements to check\n * @param order The order that defines the ring\n * @returns Object with properties:\n *  - consecutive: boolean indicating if arr is consecutive in the ring\n *  - start: the starting element of the consecutive sequence\n *  - end: the ending element of the consecutive sequence\n * \n * This is an ineffienct implementation. A better way would be \n * Example using days of the week:\n * arr = ['Friday', 'Saturday', 'Sunday', 'Monday'], \n * order = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']\n * Here, arr is consecutive\n */\nexport function isRingConsecutive<T>(arr: T[], order: T[], sorted=false): {consecutive: boolean, start: T, end: T} {\n  console.log('Checking ring consecutiveness for arr:', arr, 'with order:', order);\n  const newArr = arr.slice();\n  if (!sorted) newArr.sort((a, b) => order.indexOf(a) - order.indexOf(b));\n  console.log('Sorted arr for ring check:', newArr);\n  const indices = getIndices(newArr, order);\n  const isL = isLinearConsecutive(indices);\n  if (isL) {\n    return {\n      consecutive: isL,\n      start: newArr[0],\n      end: newArr[newArr.length-1],\n    };\n  }\n  // on the ring branch\n  const n = order.length;\n  const rolledOrder = order.slice();\n  // this is bad because it is O(n^2) \n  for (let i = 0; i < n; i++ ) {\n    rolledOrder.push(rolledOrder.shift()!);\n    newArr.push(newArr.shift()!);\n    const ind = getIndices(newArr, rolledOrder);\n    const isL = isLinearConsecutive(ind); // << our inner loop :)\n    if (isL) {\n      return {\n        consecutive: isL,\n        start: newArr[0],\n        end: newArr[newArr.length-1]\n      };\n    }\n  }\n  return {\n    consecutive: false,\n    start: arr[0],\n    end: arr[arr.length-1],\n  };\n}\n","\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { TimeSeriesFolder } from \"@/esri/services/aggregation\";\nimport { MillisecondRange, TimeRangeSelectionType} from \"@/types/datetime\";\nimport { parseTimeString, _normalizeTimes, formatTimeHHMM24 } from \"@/utils/parse_time_strings\";\nimport { isRingConsecutive } from \"@/utils/array_operations/cyclic\";\n\n// \"as const\" is required to use typeof inference later\nexport const DAYS = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'] as const;\nexport const MONTHS = [\n  'January', 'February', 'March', 'April', 'May', 'June',\n  'July', 'August', 'September', 'October', 'November', 'December'\n] as const;\nconst MS_IN_HOUR = 60 * 60 * 1000;\nconst MS_IN_DAY = 24 * MS_IN_HOUR;\n\n// Tolerance constants for time ranges [before, after] in hours\nexport const DEFAULT_TOLERANCE: [number, number] = [0.5, 0.5];\nexport const ALL_DAY_TOLERANCE: [number, number] = [12, 12];\n\nexport type DayType = typeof DAYS[number];\nexport type MonthType = typeof MONTHS[number];\n\nexport type TimeRangeCreationMode = 'single' | 'multiple';\n\nexport interface TimeRangeConfigSingle {\n  type: Extract<TimeRangeCreationMode, 'single'>; // Ensures 'type' is strictly 'single'\n  singleDate: Date; // UTC timestamp\n}\n\n// we use \" | undefined\" to force optional values to be explicitly set to undefined if not used\nexport interface TimeRangeConfigMultiple {\n  type: Extract<TimeRangeCreationMode, 'multiple'>; // Ensures 'type' is strictly 'multiple'\n  dateRange: {\n      start: Date; // UTC timestamp\n      end: Date;   // UTC timestamp\n  },\n  years: number[] | undefined;\n  months: MonthType[] | undefined; // 0-11\n  weekdays: DayType[] | undefined; // 0 (Sun) - 6 (Sat)\n  times: string[] | undefined; // 'HH:MM' format\n  toleranceHours: [number, number] | undefined; // [before, after] tolerance in hours around each time\n  parcel?: boolean; // Whether to split long ranges into smaller parcels\n  parcelSize?: number; // Maximum parcel size in milliseconds\n}\n\nexport type TimeRangeConfig = TimeRangeConfigSingle | TimeRangeConfigMultiple;\n\n/**\n * Parcels a long time range into smaller ranges. \n * \n * This should only be applied after all other time range filtering has been done.\n */\nexport function parcelLongRange(range: MillisecondRange, maxParcelSize: number): MillisecondRange[] {\n  const parcels: MillisecondRange[] = [];\n  let currentStart = range.start;\n  if (range.end - range.start <= maxParcelSize) {\n    return [range];\n  }\n\n  while (currentStart < range.end) {\n    const currentEnd = Math.min(currentStart + maxParcelSize, range.end);\n    parcels.push({ start: currentStart, end: currentEnd - 1 });\n    currentStart = currentEnd;\n  }\n\n  return parcels;\n}\n\nexport function parcelRanges(ranges: MillisecondRange[], maxParcelSize: number): MillisecondRange[] {\n  const allParcels: MillisecondRange[] = [];\n  for (const range of ranges) {\n    const parcels = parcelLongRange(range, maxParcelSize);\n    allParcels.push(...parcels);\n  }\n  return allParcels;\n}\n\nfunction parseTimeStringToHoursMinutes(timeStr: string): { hours: number; minutes: number } {\n  const {hour: hours, minute: minutes} = parseTimeString(timeStr) || {hour: NaN, minute: NaN};\n  if (isNaN(hours) || isNaN(minutes) || hours < 0 || hours > 23 || minutes < 0 || minutes > 59) {\n    throw new Error(`Invalid time values in: ${timeStr}. Hours must be 0-23 and minutes must be 0-59.`);\n  }\n  \n  return { hours, minutes };\n}\n\nfunction genOneDayRange(date: number): MillisecondRange {\n  const start = new Date(date);\n  start.setUTCHours(0, 0, 0, 0);\n  const end = new Date(date);\n  end.setUTCHours(23, 59, 59, 999);\n  return { start: start.getTime(), end: end.getTime() };\n}\n\nfunction genOneYearRange(date: number): MillisecondRange {\n  const start = new Date(date);\n  start.setUTCMonth(0, 1); // January 1st\n  start.setUTCHours(0, 0, 0, 0);\n  const end = new Date(date);\n  end.setUTCMonth(11, 31); // December 31st\n  end.setUTCHours(23, 59, 59, 999);\n  return { start: start.getTime(), end: end.getTime() };\n}\n\nfunction genOneMonthRange(date: number): MillisecondRange {\n  const start = new Date(date);\n  start.setUTCDate(1); // first day of month\n  start.setUTCHours(0, 0, 0, 0);\n  const end = new Date(date);\n  end.setUTCMonth(end.getUTCMonth() + 1);\n  end.setUTCDate(0); // last day of previous month\n  end.setUTCHours(23, 59, 59, 999);\n  return { start: start.getTime(), end: end.getTime() };\n}\n\nfunction mergeOverlappingOrConsecutiveRanges(ranges: MillisecondRange[], adjacentOnly: boolean = false): MillisecondRange[] {\n  if (ranges.length <= 1) {\n    return ranges;\n  }\n  \n  const merged: MillisecondRange[] = [];\n  let current = ranges[0];\n  \n  for (let i = 1; i < ranges.length; i++) {\n    const next = ranges[i];\n    \n    // Check if ranges overlap or are adjacent\n    // Overlap: next.start <= current.end + 1\n    // Adjacent: next.start === current.end + 1\n    const merge = adjacentOnly ? (next.start === current.end + 1) : (next.start <= current.end + 1);\n    if (merge) {\n      current = {\n        start: current.start,\n        end: Math.max(current.end, next.end)\n      };\n    } else {\n      merged.push(current);\n      current = next;\n    }\n  }\n  merged.push(current);\n  return merged;\n}\n\n/** \nGenerate all of the hour ranges for a single day.\n\nIf no times are provided, return the full day range.\n\nOtherwise, each time generates a range range that is {time - toleranceMs, time + toleranceMs}.\nThe range will be left-inclusive, right-exclusive: [start, end)\n\nMultiple time ranges that overlap or are adjacent will be merged into continuous ranges.\n*/\nfunction genHoursForOneDay(date: number, times: string[] | undefined, toleranceMs: [number, number] = [DEFAULT_TOLERANCE[0] * MS_IN_HOUR, DEFAULT_TOLERANCE[1] * MS_IN_HOUR]): MillisecondRange[] {\n  const ranges: MillisecondRange[] = [];\n  if (!times || times.length === 0) {\n    return [genOneDayRange(date)];\n  }\n  \n  const [toleranceMsBefore, toleranceMsAfter] = toleranceMs;\n  \n  // for each time, generate the appropriate range. by default +/- 30 minutes\n  for (const timeStr of times) {\n    if (timeStr.includes('-')) {\n      const [startStr, endStr] = timeStr.split('-').map(s => s.trim());\n      const { hours: startHours, minutes: startMinutes } = parseTimeStringToHoursMinutes(startStr);\n      const { hours: endHours, minutes: endMinutes } = parseTimeStringToHoursMinutes(endStr);\n      const start = new Date(date);\n      start.setUTCHours(startHours, startMinutes, 0, 0);\n      const end = new Date(date);\n      end.setUTCHours(endHours, endMinutes, 59, 999);\n      ranges.push({ start: start.getTime(), end: end.getTime() - 1 });\n    } else {\n      const { hours, minutes } = parseTimeStringToHoursMinutes(timeStr);\n      const start = new Date(date);\n      start.setUTCHours(hours, minutes, 0, 0);\n      ranges.push({ start: start.getTime() - toleranceMsBefore, end: start.getTime() + toleranceMsAfter - 1 });\n    }\n  }\n  \n  // Sort ranges by start time and merge overlapping/adjacent ranges\n  ranges.sort((a, b) => a.start - b.start);\n  \n  const merged = mergeOverlappingOrConsecutiveRanges(ranges, false);\n  \n  return merged;\n}\n\nfunction advanceDateToNextMonth(date: Date): Date {\n  const newDate = new Date(date);\n  const newMonth = newDate.getUTCMonth() + 1;\n  newDate.setUTCMonth(newMonth);\n  newDate.setUTCDate(1);\n  newDate.setUTCHours(0, 0, 0, 0);\n  return newDate;\n}\n\nfunction advanceDateToNextYear(date: Date): Date {\n  const newDate = new Date(date);\n  newDate.setUTCFullYear(newDate.getUTCFullYear() + 1);\n  newDate.setUTCMonth(0);\n  newDate.setUTCDate(1);\n  newDate.setUTCHours(0, 0, 0, 0);\n  return newDate;\n}\n\n\n/**\n * Merges consecutive/adjacent ranges when appropriate based on the filter configuration.\n */\nfunction mergeConsecutiveRanges(ranges: MillisecondRange[], shouldMerge: boolean): MillisecondRange[] {\n  if (ranges.length <= 1 || !shouldMerge) {\n    return ranges;\n  }\n  \n  const merged = mergeOverlappingOrConsecutiveRanges(ranges, true);\n  \n  return merged;\n}\n\n\nfunction generatePatternedRanges(config: TimeRangeConfigMultiple): MillisecondRange[] {\n  const ranges: MillisecondRange[] = [];\n  \n  // loop every day\n  // use a while loop so we can easily increment by day or month or \n  if (!config.dateRange) {\n    throw new Error('dateRange is required for multiple time range generation.');\n  }\n  \n  if (config.dateRange.start >= config.dateRange.end) {\n    // swap them\n    const temp = config.dateRange.start;\n    config.dateRange.start = config.dateRange.end;\n    config.dateRange.end = temp;\n  }\n  \n  const startDate = new Date(config.dateRange.start);\n  startDate.setUTCHours(0, 0, 0, 0);\n  const endDate = new Date(config.dateRange.end);\n  endDate.setUTCHours(23, 59, 59, 999);\n  \n  let currentDate = new Date(startDate);\n      \n  // are we splitting on month, year, weekday, or time. \n  // if we split on times or weekdays  then we need to generate daily ranges\n  // other wise we just pull the the largest time range we can\n  const filterOnTimes = config.times;// && config.times.length > 0;\n  const filterOnWeekdays = config.weekdays && config.weekdays.length !== DAYS.length;\n  const filterOnMonths = config.months && config.months.length !== MONTHS.length;\n  const filterOnYears = config.years;// && config.years.length > 0;\n  \n  // boolearns to determine if we need finer filtering\n  const needsFinerThanYears = filterOnMonths || filterOnWeekdays || filterOnTimes;\n  const needsFinerThanMonths = filterOnWeekdays || filterOnTimes;\n  const needsFinerThanWeekdays = filterOnTimes;\n  \n  // If no filters are applied, return the full range\n  if (!filterOnTimes && !filterOnWeekdays && !filterOnMonths && !filterOnYears) {\n    return [ { start: config.dateRange.start.getTime(), end: config.dateRange.end.getTime() } ];\n  }\n  \n  \n  \n  \n  \n  // The way this loop works is to incrementally advance the currentDate pointer\n  // depending on how fine of a filter is required. The goal to to produce the\n  // largest possible time ranges (so no having daily time ranges if we can do monthly ranges).\n  // If no filters we applied, then, then the full range was already returned above.\n  // Here we check from largest to smallest filter.\n  // So if year filter is applied, we check that first\n  // Then, if we don't need any finer filtering, we grab the whole year and advance to next year\n  // short-circuiting the rest of the checks.\n  // Getting data for a single day already allows for time filtering if needed, so we don't need\n  // the extra check for finer filters\n  while (currentDate <= endDate) {\n\n    \n    // check year filter\n    const currentYear = currentDate.getUTCFullYear();\n    if (config.years && !config.years.includes(currentYear)) {\n      currentDate = advanceDateToNextYear(currentDate); // advances to beginning of next year\n      continue;\n    }\n    \n    // the year is fine. \n    // if we don't need any finer filtering, just grab the whole year, and then go to the next year\n    if (!needsFinerThanYears) { \n      const yearRange = genOneYearRange(currentDate.getTime());\n      if (yearRange.end > endDate.getTime()) {\n        yearRange.end = endDate.getTime();\n      }\n      ranges.push(yearRange);\n      currentDate = advanceDateToNextYear(currentDate);\n      continue;\n    }\n    \n    // check month filter\n    const currentMonth = currentDate.toLocaleDateString('en-US', { month: 'long', timeZone: 'UTC' }) as MonthType;\n    if (config.months && !config.months.includes(currentMonth)) {\n      currentDate = advanceDateToNextMonth(currentDate); // advances to beginning of next month\n      continue;\n    }\n    \n    // the month is fine.\n    // if we don't need any finer filtering, just grab the whole month, and then go to the next month\n    if (!needsFinerThanMonths) { \n      const monthRange = genOneMonthRange(currentDate.getTime());\n      if (monthRange.end > endDate.getTime()) {\n        monthRange.end = endDate.getTime();\n      }\n      ranges.push(monthRange);\n      currentDate = advanceDateToNextMonth(currentDate);\n      continue;\n    }\n    \n    // check weekday filter\n    const currentWeekday = currentDate.toLocaleDateString('en-US', { weekday: 'long', timeZone: 'UTC' }) as DayType;\n    if (config.weekdays && !config.weekdays.includes(currentWeekday)) {\n      // advance to next day\n      currentDate.setUTCDate(currentDate.getUTCDate() + 1);\n      continue;\n    }\n    \n    // \n    \n    // generate time ranges for this day\n    const toleranceHours = config.toleranceHours ?? DEFAULT_TOLERANCE;\n    const toleranceMs: [number, number] = [toleranceHours[0] * MS_IN_HOUR, toleranceHours[1] * MS_IN_HOUR];\n    const dailyRanges = genHoursForOneDay(currentDate.getTime(), config.times, toleranceMs);\n    ranges.push(...dailyRanges);\n    \n    // advance to next day\n    currentDate.setUTCDate(currentDate.getUTCDate() + 1);\n  }\n  \n  \n  // Determine if we should merge consecutive ranges\n  // We merge if:\n  // 1. We're at year or month granularity (no finer filters), OR\n  // 2. The filtered months/weekdays are cyclically consecutive (wrapping around)\n  let shouldMerge = !needsFinerThanYears || !needsFinerThanMonths;\n  \n  // Check for cyclically consecutive months (e.g., Nov, Dec, Jan, Feb)\n  if (filterOnMonths && config.months && !needsFinerThanMonths) {\n    const monthCheck = isRingConsecutive(config.months, [...MONTHS], false);\n    if (monthCheck.consecutive) {\n      // console.log(`Detected cyclically consecutive months: ${monthCheck.start} to ${monthCheck.end}`);\n      shouldMerge = true;\n    }\n  }\n  \n  // Check for cyclically consecutive weekdays (e.g., Sat, Sun, Mon)\n  if (filterOnWeekdays && config.weekdays && !needsFinerThanWeekdays) {\n    const weekdayCheck = isRingConsecutive(config.weekdays, [...DAYS], false);\n    if (weekdayCheck.consecutive) {\n      // console.log(`Detected cyclically consecutive weekdays: ${weekdayCheck.start} to ${weekdayCheck.end}`);\n      shouldMerge = true;\n    }\n  }\n  \n  const mergedRanges = mergeConsecutiveRanges(ranges, shouldMerge);\n  if (mergedRanges.length < ranges.length) {\n    // console.log(`Merged ${ranges.length - mergedRanges.length} consecutive ranges. Now ${mergedRanges.length} ranges.`);\n  }\n  \n  return mergedRanges;\n}\n    \n\n\nexport function generateTimeRanges(config: TimeRangeConfig, parcel: boolean = false): MillisecondRange[] {\n  const ranges: MillisecondRange[] = [];\n  \n  if (config.type === 'single') {\n    return [genOneDayRange(config.singleDate.getTime())];\n  }\n  \n  if (config.type === 'multiple') {\n    const range = generatePatternedRanges(config, );\n    const shouldParcel = config.parcel ?? parcel;\n    const parcelSizeMs = config.parcelSize ?? 7 * MS_IN_DAY;\n    return shouldParcel ? parcelRanges(range, parcelSizeMs) : range;\n  }\n    \n    \n  return ranges;\n}\n\n\nfunction dateInRange(date: number, start: Date, end: Date): boolean {\n  return (date >= start.getTime()) && (date <= end.getTime());\n}\n\n\n/**\n * Validate a range that should match a time point with tolerance\n * (e.g., \"14:00\" with 0.5h tolerance)\n * Since we merge contiguous/overlappying ranges, we will check if \n * the desired configured time point (with tolerance) overlaps within the range.\n * \n */\nfunction validateTimePointRange(\n  range: MillisecondRange, \n  configuredTime: string, \n  toleranceMs: [number, number]\n): boolean {\n  // Parse the configured time to get the center point\n  const parsed = parseTimeString(configuredTime);\n  if (!parsed) return false;\n  \n  const { hour, minute } = parsed;\n  \n  // Get the date from the range start (they should be on the same day)\n  const rangeStartDate = new Date(range.start);\n  const targetDate = new Date(rangeStartDate);\n  targetDate.setUTCHours(hour, minute, 0, 0);\n  const targetTime = targetDate.getTime();\n  \n  // Check if the target time (with tolerance) is within  the range\n  // The configured time point should be within the range when accounting for tolerance\n  const targetWithToleranceStart = targetTime - toleranceMs[0];\n  const targetWithToleranceEnd = targetTime + toleranceMs[1] - 1;\n  \n  // Check for overlap: target time range overlaps with the actual range\n  // const overlaps = targetWithToleranceStart <= range.end && targetWithToleranceEnd >= range.start;\n  const within = targetWithToleranceStart >= range.start && targetWithToleranceEnd <= range.end;\n  return within;\n}\n\n/**\n * Validate a range that should match a time range specification\n * (e.g., \"09:00-17:00\")\n */\nfunction validateTimeRangeSpec(\n  range: MillisecondRange,\n  configuredTimeRange: string\n): boolean {\n  const [startStr, endStr] = configuredTimeRange.split('-').map(s => s.trim())\n    .map(s => formatTimeHHMM24(parseTimeString(s)!));\n  \n  \n  \n  const startDate = new Date(range.start);\n  const endDate = new Date(range.end);\n  \n  const rangeStartTimeStr = startDate.toLocaleTimeString('en-US', {\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: false,\n    timeZone: 'UTC'\n  }).replace(/^24/, '00');\n  \n  const rangeEndTimeStr = endDate.toLocaleTimeString('en-US', {\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: false,\n    timeZone: 'UTC'\n  }).replace(/^24/, '00');\n  \n  return rangeStartTimeStr === startStr && rangeEndTimeStr === endStr;\n}\n\ninterface TimeRangeValidation {\n  valid: boolean\n  errors: string[]\n  badRanges?: MillisecondRange[]\n}\n\n  \nexport function validateRanges(ranges: MillisecondRange[], config: TimeRangeConfig): TimeRangeValidation {\n  let valid = true;\n  const errors: string[] = [];\n  const badRanges: MillisecondRange[] = [];\n  \n  if (config.type === 'single') {\n    const singleDate = config.singleDate.toLocaleDateString(undefined, { timeZone: 'UTC' });\n    let count = 0;\n    \n    // check that all ranges fall within the single date\n    ranges.forEach(r => {\n      if (singleDate !== new Date(r.start).toLocaleDateString(undefined, { timeZone: 'UTC' })) {\n        valid = false;\n        count += 1;\n        badRanges.push(r);\n      }\n    });\n    if (count > 0) {\n      errors.push(`Found ${count} ranges outside Single Date Value.`);\n    }\n  }\n  \n  \n  if (config.type === 'multiple') {\n    const startDate = config.dateRange.start;\n    const endDate = config.dateRange.end;\n    let count = 0;\n    \n    // check that all ranges fall within the date range\n    ranges.forEach(r => {\n      if (!dateInRange(r.start, startDate, endDate) || !dateInRange(r.end, startDate, endDate)) {\n        // console.log('Range out of date range:', r, 'Date Range:', startDate, endDate);\n        valid = false;\n        count += 1;\n        badRanges.push(r);\n      }\n    });\n    if (count > 0) {\n      errors.push(`Found ${count} ranges outside Date Range Values.`);\n    }\n    \n    // check for each year filter\n    if (config.years && config.years.length > 0) {\n      let yearCount = 0;\n      ranges.forEach(r => {\n        const startYear = new Date(r.start).getUTCFullYear();\n        const endYear = new Date(r.end).getUTCFullYear();\n        if (!config.years!.includes(startYear) || !config.years!.includes(endYear)) {\n          valid = false;\n          yearCount += 1;\n          badRanges.push(r);\n        }\n      });\n      if (yearCount > 0) {\n        errors.push(`Found ${yearCount} ranges outside Year Values.`);\n      }\n    }\n    \n    // check for each month filter\n    if (config.months && config.months.length > 0) {\n      let monthCount = 0;\n      ranges.forEach(r => {\n        const startMonth = new Date(r.start).toLocaleDateString('en-US', { month: 'long', timeZone: 'UTC' }) as MonthType;\n        const endMonth = new Date(r.end).toLocaleDateString('en-US', { month: 'long', timeZone: 'UTC' }) as MonthType;\n        if (!config.months!.includes(startMonth) || !config.months!.includes(endMonth)) {\n          valid = false;\n          monthCount += 1;\n          badRanges.push(r);\n        }\n      });\n      if (monthCount > 0) {\n        errors.push(`Found ${monthCount} ranges outside Month Values.`);\n      }\n    } \n    \n    // check for each weekday filter\n    if (config.weekdays && config.weekdays.length > 0) {\n      let weekdayCount = 0;\n      ranges.forEach(r => {\n        const startWeekday = new Date(r.start).toLocaleDateString('en-US', { weekday: 'long', timeZone: 'UTC' }) as DayType;\n        const endWeekday = new Date(r.end).toLocaleDateString('en-US', { weekday: 'long', timeZone: 'UTC' }) as DayType;\n        if (!config.weekdays!.includes(startWeekday) || !config.weekdays!.includes(endWeekday)) {\n          valid = false;\n          weekdayCount += 1;\n          badRanges.push(r);\n        }\n      });\n      if (weekdayCount > 0) {\n        errors.push(`Found ${weekdayCount} ranges outside Weekday Values.`);\n      }\n    }\n    \n    // check for each time filter\n    if (config.times && config.times.length > 0) {\n      let timeCount = 0;\n      const toleranceHours = config.toleranceHours ?? DEFAULT_TOLERANCE;\n      const toleranceMs: [number, number] = [toleranceHours[0] * MS_IN_HOUR, toleranceHours[1] * MS_IN_HOUR];\n      \n      ranges.forEach(r => {\n        // Check if this range matches any of the configured times\n        let matchesAnyTime = false;\n        \n        for (const configuredTime of config.times!) {\n          let isValid = false;\n          if (configuredTime.includes('-')) {\n            // This is a time range specification (e.g., \"09:00-17:00\")\n            isValid = validateTimeRangeSpec(r, configuredTime);\n          } else {\n            // This is a time point with tolerance (e.g., \"14:00\"  toleranceMs)\n            isValid = validateTimePointRange(r, configuredTime, toleranceMs);\n          }\n          \n          if (isValid) {\n            matchesAnyTime = true;\n            break;\n          }\n        }\n        \n        if (!matchesAnyTime) {\n          valid = false;\n          timeCount += 1;\n          badRanges.push(r);\n          // console.log('Range time not in configured times:', r);\n        }\n      });\n      \n      if (timeCount > 0) {\n        errors.push(`Found ${timeCount} ranges outside Time Values.`);\n      }\n    }\n  }\n  \n  \n  \n  return {\n    valid,\n    errors,\n    badRanges\n  };\n  \n}","// Generated by Copilot\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { getTimezoneOffset } from 'date-fns-tz';\nimport type { MillisecondRange } from '../../types';\n\n/**\n * TimeRangeOffsetter class for converting UTC time ranges to local time ranges\n * based on a specified timezone.\n * \n * Purpose: Time ranges are defined in UTC (e.g., \"12pm every Monday UTC\").\n * When fetching data for a specific region, we need to offset these ranges\n * to local time so that \"12pm\" corresponds to 12pm in the region's timezone\n * (e.g., 12pm ET, 12pm PT, etc.).\n */\nexport class TimeRangeOffsetter {\n  private timezone: string;\n\n  constructor(timezone: string) {\n    this.timezone = timezone;\n  }\n\n\n  private getOffsetMs(timestamp: number): number {\n    return getTimezoneOffset(this.timezone, new Date(timestamp));\n  }\n\n  \n  offsetRange(utcRange: MillisecondRange): MillisecondRange {\n\n    const offsetMs = this.getOffsetMs(utcRange.start);\n    // this is gonna be a problem if the range crosses a DST boundary ~ doop dee doo for now we ignore that\n    // TODO: handle DST boundary crossing\n    const localStart = utcRange.start - offsetMs;\n    const localEnd = utcRange.end - offsetMs;\n\n    return {\n      start: localStart,\n      end: localEnd\n    };\n  }\n\n  offsetRanges(utcRanges: MillisecondRange[]): MillisecondRange[] {\n    return utcRanges.map(range => this.offsetRange(range));\n  }\n\n  crossesDSTBoundary(range: MillisecondRange): boolean {\n    const startOffset = this.getOffsetMs(range.start);\n    const endOffset = this.getOffsetMs(range.end);\n    return startOffset !== endOffset;\n  }\n\n  splitRangeAtDSTBoundary(range: MillisecondRange): MillisecondRange[] {\n    // Future implementation: Binary search to find the exact DST transition point\n    // For now, just return the original range\n    console.warn('DST boundary crossing detected but not yet handled. Range:', range);\n    return [range];\n  }\n\n\n  offsetRangesWithDSTHandling(utcRanges: MillisecondRange[]): MillisecondRange[] {\n    const result: MillisecondRange[] = [];\n\n    for (const range of utcRanges) {\n      if (this.crossesDSTBoundary(range)) {\n        // Split and offset each part\n        const splitRanges = this.splitRangeAtDSTBoundary(range);\n        splitRanges.forEach(splitRange => {\n          result.push(this.offsetRange(splitRange));\n        });\n      } else {\n        // Offset the whole range\n        result.push(this.offsetRange(range));\n      }\n    }\n\n    return result;\n  }\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { rectangleToGeometry, pointToGeometry } from '../geometry';\nimport type { RectBounds, PointBounds, EsriGeometryType } from '../geometry';\nimport type { \n  EsriGetSamplesReturn, \n  EsriGetSamplesReturnError, \n  EsriGetSamplesSample, \n  Variables, \n  EsriInterpolationMethod, \n  CEsriTimeseries, \n  EsriImageServiceSpec,\n} from '../types';\nimport type { AggValue, DataPointError, MillisecondRange } from \"../../types\";\nimport {nanmean, diff} from '../../utils/array_operations/array_math';\nimport { EsriSampler } from './sampling';\nimport { parcelRanges } from '@/date_time_range_selection/date_time_range_generators';\nimport { getEsriTimesteps } from '../utils';\n\nimport { TimeRangeOffsetter } from './TimeRangeOffsetter';\nimport tz_lookup from '@photostructure/tz-lookup';\n\n\nfunction _isRectBounds(geometry: RectBounds | PointBounds): geometry is RectBounds {\n  return 'xmin' in geometry && 'xmax' in geometry && 'ymin' in geometry && 'ymax' in geometry;\n}\n  \n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport type ParcelingMode = 'none' | 'default' | 'smart';\n\nexport interface RequestSummary {\n  totalRequests: number;\n  successCount: number;\n  failedCount: number;\n  retrievedSamples?: number;\n  timeseriesLength?: number;\n  urlList?: string[];\n}\n\nexport interface RequestStats {\n  // HTTP status\n  httpStatus: 'success' | 'error';\n  httpStatusCode: number;\n  httpErrorMessage?: string; // HTTP error message if applicable\n  // ESRI status\n  status: 'success' | 'error';\n  statusCode: number | null;\n  errorMessage?: string; // Error message for debugging\n  // Request details\n  sampleCount: number; // number of samples returned\n  \n  retried: boolean; // Was this retried\n  succeedAfter503?: boolean | null; // Track if this was a retried 503 that succeeded\n  timestamp: number;\n  timeRange: MillisecondRange;\n  url: string;\n}\n\nexport interface FetchOptions {\n  sampleCount?: number;\n  interpolation?: EsriInterpolationMethod;\n  returnFirstValueOnly?: boolean;\n  outFields?: string | string[];\n  sliceID?: string | number;\n  onProgress?: (stats: RequestStats, completed: number, total: number) => void;\n  dryRun?: boolean; // Skip actual requests, just generate URLs\n  numRetries?: number; // Override number of retries for this request\n  wasRetried503?: boolean; // Track if this is a retry from a 503\n}\n\n\nexport type TimeRanges = MillisecondRange | MillisecondRange[];\n\nexport interface RawSampleData {\n  samples: CEsriTimeseries[];\n  metadata: {\n    totalSamples: number;\n    timeRange: MillisecondRange | MillisecondRange[];\n    geometry: RectBounds | PointBounds;\n    geometryType: 'rectangle' | 'point';\n  };\n}\n\nexport interface RawSampleDataWithStats extends RawSampleData {\n  stats?: RequestStats; // Added for individual request tracking\n  requestSummary?: RequestSummary; // Summary across multiple requests\n  expectedTotalSamples?: number; // Added for smart parceling\n  actualTotalSamples?: number; // Added for smart parceling\n}\n\nfunction emptyRawSampleData(\n  geometry: RectBounds | PointBounds, \n  timeRange: MillisecondRange,\n  url: string,\n): RawSampleDataWithStats {\n  return {\n    samples: [],\n    metadata: {\n      totalSamples: 0,\n      timeRange: timeRange,\n      geometry,\n      geometryType: _isRectBounds(geometry) ? 'rectangle' : 'point'\n    },\n    stats: {\n      httpStatus: 'success',\n      httpStatusCode: 200,\n      status: 'success',\n      statusCode: null,\n      sampleCount: 0,\n      retried: false,\n      timestamp: Date.now(),\n      timeRange: timeRange,\n      url: url\n    }\n  };\n}\n  \n\nexport interface TimeSeriesData {\n  values: Record<number, AggValue>;\n  errors: Record<number, DataPointError>;\n  locations: Array<{ x: number; y: number }>;\n  geometryType: 'rectangle' | 'point';\n}\n\nexport interface TimeSeriesDataWithStats extends TimeSeriesData {\n  summary?: RequestSummary; // Simplified summary for production\n  expectedTotalSamples?: number; // Expected total samples (for smart parceling)\n  actualTotalSamples?: number; // Actual total samples fetched\n}\n  \n\n// ============================================================================\n// UTILITY FUNCTIONS\n// ============================================================================\n\nfunction safeParseNumber(value: string | null | undefined): number | null {\n  if (value === null || value === '' || value === undefined) return null;\n  const parsed = parseFloat(value);\n  return isNaN(parsed) ? null : parsed;\n}\n\nconst delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\nfunction stringifyEsriGetSamplesParameters(params: {\n  geometry: ReturnType<typeof rectangleToGeometry> | ReturnType<typeof pointToGeometry>;\n  geometryType: EsriGeometryType;\n  sampleDistance?: number;\n  sampleCount?: number;\n  mosaicRule?: string | Record<string, unknown>;\n  pixelSize?: number;\n  returnFirstValueOnly?: boolean;\n  interpolation: EsriInterpolationMethod;\n  outFields?: string | string[];\n  sliceID?: string | number;\n  time?: string | [number, number] | [Date, Date];\n  f: 'pjson';\n}): URLSearchParams {\n  const {\n    geometry,\n    geometryType,\n    sampleDistance,\n    sampleCount,\n    mosaicRule,\n    pixelSize,\n    returnFirstValueOnly,\n    interpolation,\n    outFields,\n    sliceID,\n    time,\n  } = params;\n  \n  const options: Record<string, string> = {\n    f: 'pjson',\n    geometry: JSON.stringify(geometry),\n    geometryType: geometryType,\n    interpolation: interpolation,\n  };\n\n  if (sampleDistance) options.sampleDistance = sampleDistance.toString();\n  if (sampleCount) options.sampleCount = sampleCount.toString();\n  if (mosaicRule) options.mosaicRule = JSON.stringify(mosaicRule);\n  if (pixelSize) options.pixelSize = pixelSize.toString();\n  if (returnFirstValueOnly !== undefined) options.returnFirstValueOnly = returnFirstValueOnly.toString();\n  if (outFields) options.outFields = Array.isArray(outFields) ? outFields.join(',') : outFields;\n  if (sliceID !== undefined) options.sliceID = sliceID.toString();\n  if (time) {\n    const timeStr = Array.isArray(time)\n      ? time.map((t) => (t instanceof Date ? t.getTime() : t)).join(',')\n      : time;\n    options.time = timeStr;\n  }\n\n  return new URLSearchParams(options);\n}\n\n\nclass ImageServiceServiceMetadata {\n  url: string;\n  metadataCache: EsriImageServiceSpec | null = null;\n  private _loadingMetadata: boolean = false;\n  \n  constructor(url: string) {\n    this.url = url;\n  }\n  \n  private async _getServiceMetadata(): Promise<EsriImageServiceSpec> {\n    const url = `${this.url}?f=json`;\n    return fetch(url)\n      .then((response) => {\n        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);\n        return response.json();\n      })\n      .catch((error) => {\n        console.error('Error fetching service metadata:', error);\n        throw error;\n      });\n  }\n  \n  async updateMetadataCache() {\n    // in general we really should invalidate the cache when the URL changes\n    // however, we know that for this purpose, the grid is identical for all\n    // the various services we may access, so ease of use, we will always have a metaDataCache\n    // available. \n    // this.metadataCache = null; // Invalidate cache\n    this._loadingMetadata = true;\n    this.metadataCache = await this._getServiceMetadata();\n    this._loadingMetadata = false;\n    return this.metadataCache;\n  }\n  \n  getMetadata(): EsriImageServiceSpec {\n    if (!this.metadataCache) {\n      if (this._loadingMetadata) {\n        throw new Error('Metadata is currently loading. Please wait and try again.');\n      }\n      throw new Error('Metadata not loaded yet. Call updateMetadataCache() first.');\n    }\n    return this.metadataCache;\n  }\n  \n  get meta(): EsriImageServiceSpec | null {\n    return this.metadataCache;\n  }\n  \n  async withMetadataCache(): Promise<EsriImageServiceSpec> {\n    if (this.metadataCache) {\n      return this.metadataCache;\n    }\n    if (this._loadingMetadata) {\n      // Wait until loading is done. Check eveery 100ms\n      while (this._loadingMetadata) {\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      }\n      if (this.metadataCache) {\n        return this.metadataCache;\n      } else {\n        throw new Error('Failed to load metadata.');\n      }\n    }\n    return this.updateMetadataCache();\n  }\n  \n  async waitForCache(): Promise<ImageServiceServiceMetadata> {\n    await this.withMetadataCache();\n    return this;\n  }\n  \n  \n  get timeRange(): [number, number] | null {\n    if (this.metadataCache && this.metadataCache.timeInfo && this.metadataCache.timeInfo.timeExtent) {\n      return [this.metadataCache.timeInfo.timeExtent[0], this.metadataCache.timeInfo.timeExtent[1]];\n    }\n    return null;\n  }\n  \n  get extent(): RectBounds | null {\n    if (this.metadataCache && this.metadataCache.extent) {\n      return {\n        xmin: this.metadataCache.extent.xmin,\n        ymin: this.metadataCache.extent.ymin,\n        xmax: this.metadataCache.extent.xmax,\n        ymax: this.metadataCache.extent.ymax,\n      };\n    }\n    return null;\n  } \n  \n  get spatialReference(): number | null {\n    if (this.metadataCache && this.metadataCache.spatialReference) {\n      return this.metadataCache.spatialReference.wkid || null;\n    }\n    return null;\n  }\n  \n  clippedToTimeExtent(timeRange: MillisecondRange): [MillisecondRange, boolean] {\n    const serviceTimeRange = this.timeRange;\n    if (!serviceTimeRange) return [timeRange, false];\n    const start = Math.max(timeRange.start, serviceTimeRange[0]);\n    const end = Math.min(timeRange.end, serviceTimeRange[1]);\n    const clipped = start !== timeRange.start || end !== timeRange.end;\n    return [{ start, end }, clipped];\n  }\n  \n  // \n}\n\n\n// ============================================================================\n// TEMPO DATA SERVICE\n// ============================================================================\n\nexport class TempoDataService {\n  private _baseUrls: string | string[] = [];\n  private variable: Variables | string;\n  private metas = new Map<string, ImageServiceServiceMetadata>();\n  private rateLimitMs: number = 50; // Delay between requests in milliseconds\n  private maxRetries503: number = 1; // Maximum number of retries for 503 errors\n  \n  // Smart parceling configuration\n  private maxSamplesPerRequest: number = 5000; // ESRI service limit\n  private safetyMargin: number = 0.9; // Use 90% of limit to avoid edge cases\n  private parcelingMode: ParcelingMode = 'smart'; // Parceling mode: 'none', 'default', or 'smart'\n  private defaultParcelSize: number = 7 * 24 * 60 * 60 * 1000; // Default parcel size (1 week in ms)\n  private availableTimestamps: number[] = []; // Cached timestamps from service\n  \n  private dryRun: boolean = false; //  run mode\n  private timestepsCache = new Map<string, number[]>();\n  private _boundaries: Array<{ url: string; start: number; end: number }> | null = null; // Cached version boundaries\n  \n  constructor(baseUrl: string | string[], variable: Variables | string = \"NO2_Troposphere\", rateLimitMs: number = 50, maxRetries503: number = 1) {\n    // console.error(`TemoiDataService constructor called with variable: ${variable} and baseUrl: ${baseUrl}`);\n    this._baseUrls = baseUrl;\n    this.rateLimitMs = rateLimitMs;\n    this.maxRetries503 = maxRetries503;\n    \n    this.variable = variable;\n    this.updateMetadataCache();\n  }\n\n  \n  get baseUrlArray(): string[] {\n    return Array.isArray(this._baseUrls) ? this._baseUrls : [this._baseUrls];\n  }\n  \n  async updateMetadataCache(): Promise<void> {\n    // Load metadata for all URLs in parallel\n    const metadataPromises = this.baseUrlArray.map(url => \n      this.metaForUrl(url).catch(err => {\n        console.warn(`Failed to load metadata for ${url}:`, err);\n        return null;\n      })\n    );\n    \n    await Promise.all(metadataPromises);\n    \n    if (this.baseUrlArray.length > 1) {\n      console.log(`Loaded metadata for ${this.baseUrlArray.length} TEMPO service URL(s)`);\n    }\n  }\n\n  /**\n   * Get cached version boundaries from all base URLs.\n   * Boundaries are sorted by start time.\n   */\n  private async timeBoundaries(): Promise<Array<{ url: string; start: number; end: number }>> {\n    if (this._boundaries !== null) {\n      return this._boundaries;\n    }\n\n    const boundaries: Array<{ url: string; start: number; end: number }> = [];\n    \n    for (const url of this.baseUrlArray) {\n      const meta = await this.metaForUrl(url);\n      if (!meta || !meta.metadataCache) {\n        console.error(`Metadata not loaded for ${url}, cannot determine time boundaries`);\n        continue;\n      }\n      const timeRange = meta.timeRange;\n      if (timeRange) {\n        boundaries.push({ url, start: timeRange[0], end: timeRange[1] });\n      }\n    }\n\n    // Sort boundaries by start time for easier processing\n    boundaries.sort((a, b) => a.start - b.start);\n    this._boundaries = boundaries;\n    return boundaries;\n  }\n\n  \n  private async metaForUrl(url: string): Promise<ImageServiceServiceMetadata> {\n    if (!this.metas.has(url)) {\n      this.metas.set(url, new ImageServiceServiceMetadata(url));\n    }\n    const meta = this.metas.get(url)!;\n    await meta.withMetadataCache();\n    return meta;\n  }\n\n  private _metaForTimeRange(range: MillisecondRange): EsriImageServiceSpec | undefined {\n    const url = this.selectBaseUrlForRange(range);\n    const meta = this.metas.get(url);\n    \n    if (meta?.metadataCache) {\n      return meta.metadataCache;\n    }\n    \n    // Fallback to first available metadata\n    for (const [, m] of this.metas) {\n      if (m.metadataCache) {\n        return m.metadataCache;\n      }\n    }\n    \n    return undefined;\n  }\n\n  selectBaseUrlForRange(range: MillisecondRange): string {\n    for (const url of this.baseUrlArray) {\n      const meta = this.metas.get(url);\n      if (!meta?.metadataCache) {\n        console.error(`Metadata not loaded for ${url}, cannot select URL for range`);\n        continue;\n      }\n      const timeRange = meta.timeRange;\n      if (!timeRange) {\n        throw new Error(`Missing timeInfo for ${url}`);\n      }\n      const [start, end] = timeRange;\n      const overlaps = range.start <= end && range.end >= start;\n      if (overlaps) {\n        return url;\n      }\n    }\n    return this.baseUrlArray[this.baseUrlArray.length - 1];\n  }\n  \n  selectBaseUrlForTimestamp(timestamp: number): string {\n    return this.selectBaseUrlForRange({ start: timestamp, end: timestamp });\n  }\n  \n \n  private async fetchTimestepsForUrl(url: string): Promise<number[]> {\n    if (this.timestepsCache.has(url)) {\n      return this.timestepsCache.get(url)!;\n    }\n    const steps = await getEsriTimesteps(url, this.variable as Variables);\n    this.timestepsCache.set(url, steps);\n    return steps;\n  }\n      \n\n  async getMergedTimesteps(): Promise<number[]> {\n    const allTimesteps: number[][] = [];\n    for (const url of this.baseUrlArray) {\n      await this.metaForUrl(url); // Ensure metadata is loaded\n      const steps = await this.fetchTimestepsForUrl(url);\n      allTimesteps.push(steps);\n    }\n    return Array.from(new Set(allTimesteps.flat())).sort((a, b) => a - b);\n  }\n\n\n  /**\n   * Ensure metadata is loaded and return it \n   * Really just to avoid changing with MapWithControls\n   */\n  async withMetadataCache(): Promise<EsriImageServiceSpec> {\n    await this.updateMetadataCache();\n    const meta = this.metas.get(this.baseUrlArray[0])?.meta ?? null;\n    if (!meta) {\n      throw new Error('Failed to load metadata for TEMPO service');\n    }\n    return meta;\n  }\n\n  // ============================================================================\n  // CONFIGURATION\n  // ============================================================================\n\n  setVariable(variable: Variables | string): void {\n    this.variable = variable;\n  }\n\n  getVariable(): Variables | string {\n    return this.variable;\n  }\n\n  setRateLimit(ms: number): void {\n    this.rateLimitMs = Math.max(0, ms);\n  }\n\n  setRetryLimit(retries: number): void {\n    this.maxRetries503 = Math.max(0, Math.floor(retries));\n  }\n\n  setMaxSamplesPerRequest(max: number): void {\n    this.maxSamplesPerRequest = Math.max(1, Math.floor(max));\n  }\n\n  setSafetyMargin(margin: number): void {\n    this.safetyMargin = Math.max(0.1, Math.min(1.0, margin));\n  }\n\n  setParcelingMode(mode: ParcelingMode): void {\n    this.parcelingMode = mode;\n  }\n\n  getParcelingMode(): ParcelingMode {\n    return this.parcelingMode;\n  }\n\n  setDefaultParcelSize(sizeMs: number): void {\n    if (sizeMs <= 0) {\n      console.warn('Default parcel size must be positive. Reverting to smart parceling mode.');\n      this.setParcelingMode('smart');\n    }\n    this.defaultParcelSize = Math.max(1000, sizeMs); // Minimum 1 second\n  }\n\n  setAvailableTimestamps(timestamps: number[]): void {\n    this.availableTimestamps = [...timestamps].sort((a, b) => a - b);\n  }\n\n  setDryRun(enabled: boolean): void {\n    this.dryRun = enabled;\n  }\n  \n\n  getDryRun(): boolean {\n    return this.dryRun;\n  }\n\n  // ============================================================================\n  // CORE DATA FETCHING\n  // ============================================================================\n  /**\n   * Fetch raw samples from the ESRI Image Server\n   */\n  async fetchSample(\n    geometry: RectBounds | PointBounds,\n    timeRange: MillisecondRange,\n    options: FetchOptions = {},\n  ): Promise<RawSampleDataWithStats> {\n    const numRetries = options.numRetries ?? 0;\n    const skipRetry = numRetries >= this.maxRetries503;\n    const esriGeometry = this.isRectBounds(geometry) \n      ? rectangleToGeometry(geometry as RectBounds)\n      : pointToGeometry(geometry as PointBounds);\n\n    const geometryType: EsriGeometryType = this.isRectBounds(geometry)\n      ? 'esriGeometryPolygon'\n      : 'esriGeometryPoint';\n\n    // Handle multiple time ranges by combining them\n    const timeString = `${timeRange.start},${timeRange.end}`;\n\n\n    const baseUrl = this.selectBaseUrlForRange(timeRange);\n\n    const params = {\n      f: 'pjson' as const,\n      interpolation: 'RSP_NearestNeighbor' as EsriInterpolationMethod,\n      returnFirstValueOnly: false,\n      geometry: esriGeometry,\n      geometryType: geometryType,\n      time: timeString,\n      sampleCount: options.sampleCount || 30, // 100 is the Esri default. 30 has been our default\n      ...options\n    };\n\n    const urlWithParams = `${baseUrl}/getSamples/?${stringifyEsriGetSamplesParameters(params).toString()}`;\n    \n    \n    // If dry run mode, return empty data immediately\n    const isDryRun = this.dryRun || options.dryRun;\n    if (isDryRun) {\n      return emptyRawSampleData(geometry, timeRange, urlWithParams);\n    }\n    \n    const stats: RequestStats = {\n      httpStatus: 'success', // needs to be updated\n      httpStatusCode: 0, // needs to be updated\n      status: 'success', // needs to be updated\n      statusCode: null, // needs to be updated\n      sampleCount: 0,\n      retried: numRetries > 0,\n      succeedAfter503: false,\n      timestamp: Date.now(),\n      timeRange: timeRange,\n      url: urlWithParams.replace('pjson', 'html'), // for easier debugging\n    };\n    \n    try {\n      const response = await fetch(urlWithParams);\n      stats.httpStatusCode = response.status;\n      stats.httpStatus = response.ok ? 'success' : 'error';\n      \n      // Handle HTTP errors\n      if (!response.ok) {\n        stats.httpErrorMessage = await response.text();\n        throw new Error(stats.httpErrorMessage || `HTTP error! status: ${response.status}`);\n      }\n      \n      const data: EsriGetSamplesReturn | EsriGetSamplesReturnError = await response.json();\n      \n      if ('error' in data) {\n        stats.status = 'error';\n        stats.statusCode = data.error.code;\n        stats.errorMessage = `ESRI error: code: ${data.error.code} msg: ${data.error.message} details: ${data.error.details || ''}`.trim();\n        \n        if (data.error.code === 503 && !skipRetry) {\n          console.warn(`Received 503 error for ${urlWithParams.replace('pjson', 'html')}, retrying after delay...`);\n          await delay(1000); // Wait 1 second before retrying\n          return this.fetchSample(geometry, timeRange, {...options, numRetries: (options.numRetries ?? 0) + 1, wasRetried503: true}); // Increment retry count\n        }\n        // if it is not a 503, then we are currently assuming the error is terminal\n        throw new Error(stats.errorMessage);\n      }\n\n      const processedSamples = data.samples.map((sample: EsriGetSamplesSample) => {\n        if (sample.attributes) {\n          return {\n            x: sample.location.x,\n            y: sample.location.y,\n            time: sample.attributes?.StdTime ?? timeRange[0],\n            date: new Date(sample.attributes?.StdTime ?? timeRange[0] ),\n            // variable: safeParseNumber(sample.attributes[this.variable] ?? ''),\n            variable: safeParseNumber(this.variable in sample.attributes ? sample.attributes[this.variable] : ''),\n            value: safeParseNumber(sample.value),\n            locationId: sample.locationId,\n            geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point' as 'rectangle' | 'point'\n          };\n        } else {\n          return {\n            x: sample.location.x,\n            y: sample.location.y,\n            time: timeRange[0],\n            date: new Date(timeRange[0] ),\n            // variable: safeParseNumber(sample.attributes[this.variable] ?? ''),\n            variable: this.variable,\n            value: safeParseNumber(sample.value),\n            locationId: sample.locationId,\n            geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point' as 'rectangle' | 'point'\n          };\n        }}); // this is a CEsriTimeseries[]\n      \n      // Update stats for successful request\n      stats.status = 'success';\n      // ESRI statusCode is only used when ESRI returns an error payload.\n      stats.statusCode = null;\n      stats.sampleCount = processedSamples.length;\n      // if this was a retried request, note if it succeeded after 503\n      if (options.wasRetried503) {\n        stats.succeedAfter503 = true;\n      } else {\n        stats.succeedAfter503 = null;\n      }\n      return {\n        samples: processedSamples,\n        metadata: {\n          totalSamples: processedSamples.length,\n          timeRange: timeRange,\n          geometry,\n          geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point'\n        },\n        stats: stats\n      };\n    } catch (error) {\n      // For network / unexpected failures, capture a generic error message.\n      // Avoid duplicating HTTP error bodies into both httpErrorMessage and errorMessage.\n      if (!stats.errorMessage && !stats.httpErrorMessage && error instanceof Error) {\n        stats.status = 'error';\n        stats.errorMessage = error.message;\n      }\n\n      // If fetch() threw before we had an HTTP response, mark HTTP status as error.\n      if (stats.httpStatusCode === 0 && stats.httpStatus === 'success') {\n        stats.httpStatus = 'error';\n      }\n\n      console.error('Error in TempoDataService.fetchSample:', params, error);\n      // Still return the stats even on error, wrapped in the error\n      const enhancedError = error as Error & { stats?: RequestStats };\n      enhancedError.stats = stats;\n      throw enhancedError;\n    }\n  }\n  \n  /**\n   * Fetch raw samples from the ESRI Image Server\n   */\n  async fetchSamples(\n    geometry: RectBounds | PointBounds,\n    timeRanges: TimeRanges,\n    options: FetchOptions = {}\n  ): Promise<RawSampleDataWithStats> {\n    \n    if (!Array.isArray(timeRanges)) {\n      return this.fetchSample(geometry, timeRanges, options);\n    }\n    \n    // Apply parceling based on mode\n    const sampleCount = options.sampleCount || 30;\n    let parceledRanges: MillisecondRange[];\n    let expectedTotalSamples: number | undefined;\n    \n    switch (this.parcelingMode) {\n    case 'none':\n      parceledRanges = timeRanges;\n      break;\n      \n    case 'default':\n      parceledRanges = parcelRanges(timeRanges, this.defaultParcelSize);\n      break;\n      \n    case 'smart': {\n      const smartResult = this.smartParcelTimeRanges(timeRanges, sampleCount);\n      parceledRanges = smartResult.ranges;\n      expectedTotalSamples = smartResult.expectedTotalSamples;\n      break;\n    }\n    }\n    \n    // Split any parcels that straddle version boundaries\n    parceledRanges = await this.splitParcelsAtVersionBoundaries(parceledRanges);\n    \n    const totalRanges = parceledRanges.length;\n    let completedRanges = 0;\n\n    \n    // Skip rate limiting in dry run mode\n    const isDryRun = this.dryRun || options.dryRun;\n    \n    const promises = parceledRanges.map((tr, index) => {\n      const requestPromise = isDryRun\n        ? this.fetchSample(geometry, tr, options)\n        : delay(this.rateLimitMs * index).then(() => this.fetchSample(geometry, tr, options));\n\n      return requestPromise\n        .then((result) => {\n        // Track progress\n          completedRanges++;\n          if (result.stats) {\n            if (options.onProgress) {\n              options.onProgress(result.stats, completedRanges, totalRanges);\n            }\n          }\n          return result;\n        })\n        .catch((error) => {\n          console.error(`Error fetching sample for time range ${tr.start}-${tr.end}:`, error);\n        \n          // Track progress even on error\n          completedRanges++;\n        \n          // Collect stats from errors too\n          const enhancedError = error as Error & { stats?: RequestStats };\n          if (enhancedError.stats) {\n            if (options.onProgress) {\n              options.onProgress(enhancedError.stats, completedRanges, totalRanges);\n            }\n\n            // Return a structured empty result so we can compute summaries from stats\n            // without maintaining an allStats array.\n            return {\n              samples: [],\n              metadata: {\n                totalSamples: 0,\n                timeRange: tr,\n                geometry: geometry,\n                geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point',\n              },\n              stats: enhancedError.stats,\n            };\n          }\n\n          return null;\n        }\n        );\n    });\n\n    return Promise.all(promises).then((results) => {\n      const validResults = results.filter((result): result is RawSampleDataWithStats => result !== null);\n      const samples = validResults.map((result) => result.samples).flat();\n      console.log(`Total samples fetched across all time ranges: ${samples.length}`);\n\n      const requestStats = validResults.map((r) => r.stats).filter((s): s is RequestStats => s !== undefined);\n\n      const successCount = requestStats.filter((s) => s.status === 'success').length;\n      const errorCountFromStats = requestStats.filter((s) => s.status === 'error').length;\n      const missingStatsCount = Math.max(0, totalRanges - requestStats.length);\n      const failedCount = errorCountFromStats + missingStatsCount;\n\n      // Create a combined result with all stats\n      const result: RawSampleDataWithStats = {\n        samples,\n        metadata: {\n          totalSamples: samples.length,\n          timeRange: parceledRanges,\n          geometry: geometry,\n          geometryType: this.isRectBounds(geometry) ? 'rectangle' : 'point',\n        },\n      };\n\n      result.requestSummary = {\n        totalRequests: totalRanges,\n        successCount,\n        failedCount,\n        retrievedSamples: samples.length,\n        urlList: validResults.map((r) => r.stats?.url || 'unknown'),\n      };\n      \n      // Add expected total samples if available (from smart parceling)\n      if (expectedTotalSamples !== undefined) {\n        result.expectedTotalSamples = expectedTotalSamples;\n      }\n      result.actualTotalSamples = samples.length;\n      \n      return result;\n    });\n  }\n\n  // ============================================================================\n  // AGGREGATION METHODS\n  // ============================================================================\n\n  /**\n   * Aggregate samples by time (for rectangle areas)\n   */\n  aggregateByTime(samples: CEsriTimeseries[]): TimeSeriesData {\n    // Group samples by time\n    const grouped = new Map<number, CEsriTimeseries[]>();\n    samples.forEach((sample) => {\n      if (!grouped.has(sample.time)) {\n        grouped.set(sample.time, []);\n      }\n      grouped.get(sample.time)?.push(sample);\n    });\n\n    // Calculate aggregated values\n    const values: Record<number, AggValue> = {};\n    const errors: Record<number, DataPointError> = {};\n    \n    grouped.forEach((samples, time) => {\n      const sampleValues = samples.map(s => s.value);\n      values[time] = this.calculateMean(sampleValues, time);\n      errors[time] = this.calculateError(sampleValues);\n    });\n\n    // Collect unique locations\n    const seen = new Set<string>();\n    const locations: Array<{ x: number; y: number }> = [];\n    for (const sample of samples) {\n      const key = `${sample.x},${sample.y}`;\n      if (!seen.has(key)) {\n        seen.add(key);\n        locations.push({ x: sample.x, y: sample.y });\n      }\n    }\n    \n    return { \n      values, \n      errors, \n      locations, \n      geometryType: samples[0]?.geometryType || 'rectangle',\n    };\n  }\n\n  /**\n   * Get single point data (for center points or individual points)\n   */\n\n  // ============================================================================\n  // CONVENIENCE METHODS\n  // ============================================================================\n  \n  getTimeSeriesStatistics(jsonData: RawSampleData) {\n    const samples = jsonData.samples || [];\n    \n    const uniqueLocations = new Set();\n    const uniqueLatitudes = new Set<number>();\n    const uniqueLongitudes = new Set<number>();\n    const valuesPerLocation = {};\n    \n    for (const sample of samples) {\n      const location = {x: sample.x, y: sample.y};\n      const locString = `${location.x},${location.y}`;\n      if (location) {\n        // Use a string representation for unique locations in the Set\n        uniqueLocations.add(locString);\n        uniqueLatitudes.add(location.y);\n        uniqueLongitudes.add(location.x);\n      }\n      \n      valuesPerLocation[locString] = (valuesPerLocation[locString] || 0) + 1;\n\n    }\n    \n    const totalValues = samples.length;\n    const numUniqueLocations = uniqueLocations.size;\n    \n    const latitudeSpacing = diff([...uniqueLatitudes].sort());\n    const longitudeSpacing = diff([...uniqueLongitudes].sort());\n    \n    \n    \n    return {\n      numUniqueLocations,\n      totalValues,\n      valuesPerLocation,\n      latitudeSpacing: nanmean(latitudeSpacing),\n      longitudeSpacing: nanmean(longitudeSpacing),\n    };\n  }\n  \n  getRegionCenter(geometry: RectBounds | PointBounds): { lat: number; lon: number } {\n    if (this.isRectBounds(geometry)) {\n      return {\n        lat: (geometry.ymin + geometry.ymax) / 2,\n        lon: (geometry.xmin + geometry.xmax) / 2\n      };\n    } else { // It's a point\n      return {\n        lat: geometry.y,\n        lon: geometry.x\n      };\n    }\n  }\n  /**\n   * Fetch and aggragate any valid geometry data (rectangle or point)\n   */\n  async fetchTimeseriesData(\n    geometry: RectBounds | PointBounds,\n    timeRanges: TimeRanges,\n    options: FetchOptions = {}\n  ): Promise<TimeSeriesDataWithStats> {\n    \n    const { lat: centerLat, lon: centerLon } = this.getRegionCenter(geometry);\n    const timezone = tz_lookup(centerLat, centerLon);\n    \n    // Convert UTC time ranges to local time ranges for this timezone\n    const offsetter = new TimeRangeOffsetter(timezone);\n    const timeRangesArray = Array.isArray(timeRanges) ? timeRanges : [timeRanges];\n    const localTimeRanges = offsetter.offsetRanges(timeRangesArray);\n    \n    \n    const meta = this._metaForTimeRange(localTimeRanges[0]);\n    if (this.isRectBounds(geometry) && meta) {\n      const sampler = new EsriSampler(meta, geometry);\n      const sampleCount = options.sampleCount || 30;\n      options.sampleCount = sampler.getSamplingSpecificationFromSampleCount(sampleCount).count;\n      console.log(`This region is covered by ${options.sampleCount} samples`);\n    }\n    const rawData = await this.fetchSamples(geometry, localTimeRanges, options);\n    // const stats = this.getTimeSeriesStatistics(rawData);\n    \n    const result: TimeSeriesDataWithStats = this.aggregateByTime(rawData.samples);\n\n    if (rawData.requestSummary) {\n      result.summary = {\n        ...rawData.requestSummary,\n        timeseriesLength: Object.keys(result.values).length,\n      };\n    }\n\n    // Pass through expected total samples if available\n    if (rawData.expectedTotalSamples !== undefined) {\n      result.expectedTotalSamples = rawData.expectedTotalSamples;\n    }\n    if (rawData.actualTotalSamples !== undefined) {\n      result.actualTotalSamples = rawData.actualTotalSamples;\n    }\n    console.log(`Summary of fetched time series data:`, result.summary);\n    return result;\n  }\n  \n\n  /**\n   * Get center point of rectangle and fetch data for it\n   */\n  async fetchCenterPointData(\n    rectangle: RectBounds,\n    timeRanges: TimeRanges,\n    options: FetchOptions = {}\n  ): Promise<TimeSeriesData | null> {\n    const center: PointBounds = {\n      x: (rectangle.xmin + rectangle.xmax) / 2,\n      y: (rectangle.ymin + rectangle.ymax) / 2\n    };\n    \n    return this.fetchTimeseriesData(center, timeRanges, options);\n  }\n\n  // ============================================================================\n  // UTILITY METHODS\n  // ============================================================================\n\n  private isRectBounds(geometry: RectBounds | PointBounds): geometry is RectBounds {\n    return _isRectBounds(geometry);\n  }\n\n  private calculateMean(samples: (number | null)[], time: number): AggValue {\n    const validSamples = samples.filter((sample) => sample !== null);\n    if (validSamples.length === 0) return { value: null, date: new Date(time) };\n    const sum = validSamples.reduce((acc, val) => acc! + (val ?? 0), 0);\n    return { value: sum! / validSamples.length, date: new Date(time) };\n  }\n\n  private calculateError(samples: (number | null)[]): DataPointError {\n    const validSamples = samples.filter((sample) => sample !== null);\n    if (validSamples.length === 0) return { lower: null, upper: null };\n    \n    const mean = validSamples.reduce((acc, val) => acc! + (val ?? 0), 0)! / validSamples.length;\n    const squaredDiffs = validSamples.map((sample) => {\n      if (sample === null) return 0;\n      return Math.pow(sample - mean, 2);\n    });\n    // squared standard error of the mean = variance / n\n    const squaredSEM = squaredDiffs.reduce((acc, val) => acc + val, 0) / Math.pow(validSamples.length, 2);\n    \n    return { lower: Math.sqrt(squaredSEM), upper: Math.sqrt(squaredSEM) };\n  }\n\n  // ============================================================================\n  // SMART PARCELING HELPERS\n  // ============================================================================\n\n  /**\n   * Efficiently count timestamps in each range using a two-pointer algorithm.\n   * Both timestamps and ranges must be sorted in ascending order.\n   * Time complexity: O(T + R) where T = number of timestamps, R = number of ranges\n   * \n   * @param ranges - Array of time ranges (must be sorted by start time)\n   * @returns Array of counts, one per range\n   */\n  private countTimestampsInRanges(ranges: MillisecondRange[]): number[] {\n    if (this.availableTimestamps.length === 0 || ranges.length === 0) {\n      return ranges.map(() => 0);\n    }\n\n    const counts: number[] = [];\n    let timestampIndex = 0; // Pointer into availableTimestamps array\n    \n    for (const range of ranges) {\n      let count = 0;\n      \n      // Skip timestamps before the current range\n      while (timestampIndex < this.availableTimestamps.length && \n             this.availableTimestamps[timestampIndex] < range.start) {\n        timestampIndex++;\n      }\n      \n      // Save the starting position for this range\n      // const rangeStartIndex = timestampIndex;\n      \n      // Count timestamps within the range\n      while (timestampIndex < this.availableTimestamps.length && \n             this.availableTimestamps[timestampIndex] <= range.end) {\n        count++;\n        timestampIndex++;\n      }\n      \n      counts.push(count);\n      \n      // Reset to the start position for the next range\n      // This handles overlapping or out-of-order ranges\n      // timestampIndex = rangeStartIndex;\n      \n      // Optimization: if ranges are guaranteed non-overlapping and sorted,\n      // we don't need to reset. THIS ASSUMPTION IS TRUE FOR OUR USE CASE.\n      // timestampIndex = 0;\n    }\n    \n    return counts;\n  }\n\n  /**\n   * Binary search to find the first timestamp >= target\n   */\n  private binarySearchStart(target: number): number {\n    let left = 0;\n    let right = this.availableTimestamps.length - 1;\n    let result = this.availableTimestamps.length;\n    \n    while (left <= right) {\n      const mid = Math.floor((left + right) / 2);\n      if (this.availableTimestamps[mid] >= target) {\n        result = mid;\n        right = mid - 1;\n      } else {\n        left = mid + 1;\n      }\n    }\n    \n    return result;\n  }\n\n  /**\n   * Binary search to find the last timestamp <= target\n   */\n  private binarySearchEnd(target: number, startIdx: number): number {\n    let left = startIdx;\n    let right = this.availableTimestamps.length - 1;\n    let result = -1;\n    \n    while (left <= right) {\n      const mid = Math.floor((left + right) / 2);\n      if (this.availableTimestamps[mid] <= target) {\n        result = mid;\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    \n    return result;\n  }\n  \n  /**\n * Get timestamps that fall within a given time range (for splitting)\n */\n  private getTimestampsInRange(range: MillisecondRange): number[] {\n    // Binary search for efficiency\n    const startIdx = this.binarySearchStart(range.start);\n    const endIdx = this.binarySearchEnd(range.end, startIdx);\n    \n    return this.availableTimestamps.slice(startIdx, endIdx + 1);\n  }\n\n  /**\n   * Get boundaries that overlap with the given time range.\n   * Returns boundaries sorted by start time.\n   */\n  private _getOverlappingBoundaries(\n    range: MillisecondRange,\n    boundaries: Array<{ url: string; start: number; end: number }>\n  ): Array<{ url: string; start: number; end: number }> {\n    const overlapping = boundaries.filter(b => \n      range.start <= b.end && range.end >= b.start\n    );\n    // Sort by start time (boundaries should already be sorted, but ensure it)\n    return overlapping.sort((a, b) => a.start - b.start);\n  }\n\n  /**\n   * Split time ranges that span multiple ESRI service version boundaries.\n   */\n  private async splitParcelsAtVersionBoundaries(ranges: MillisecondRange[]): Promise<MillisecondRange[]> {\n    // If only one base URL, no version boundaries to worry about\n    if (this.baseUrlArray.length <= 1) {\n      return ranges;\n    }\n\n    const boundaries = await this.timeBoundaries();\n    const splitRanges: MillisecondRange[] = [];\n\n    for (const range of ranges) {\n      // Find which boundaries this range overlaps with\n      const overlappingBoundaries = this._getOverlappingBoundaries(range, boundaries);\n\n      if (overlappingBoundaries.length <= 1) {\n        // Range fits within a single version, keep as-is\n        splitRanges.push(range);\n        continue;\n      }\n      console.error(`Splitting range ${range.start}-${range.end} across ${overlappingBoundaries.length} version boundaries`);\n      // Range spans multiple versions - split it\n      for (const boundary of overlappingBoundaries) {\n        // Calculate the intersection of the range with this boundary\n        const splitStart = Math.max(range.start, boundary.start);\n        const splitEnd = Math.min(range.end, boundary.end);\n        \n        if (splitStart <= splitEnd) {\n          splitRanges.push({ start: splitStart, end: splitEnd });\n        }\n      }\n    }\n\n    return splitRanges;\n  }\n\n  /**\n   * Intelligently parcel time ranges based on sample count and timestamp availability\n   * to avoid exceeding the ESRI service limit while maximizing request size\n   */\n  private smartParcelTimeRanges(\n    timeRanges: MillisecondRange[],\n    sampleCount: number\n  ): { ranges: MillisecondRange[]; expectedTotalSamples: number } {\n    // If no timestamps are available, can't do smart parceling\n    if (this.availableTimestamps.length === 0) {\n      console.warn('No timestamps available for smart parceling, using ranges as provided');\n      return { ranges: timeRanges, expectedTotalSamples: 0 };\n    }\n    console.log(`Smart parceling ${timeRanges.length} time ranges with sample count ${sampleCount}`);\n\n    const effectiveLimit = Math.floor(this.maxSamplesPerRequest * this.safetyMargin);\n    const maxTimestampsPerRequest = Math.floor(effectiveLimit / sampleCount);\n    \n    if (maxTimestampsPerRequest < 1) {\n      console.warn(`Sample count (${sampleCount}) exceeds effective limit (${effectiveLimit}). Cannot parcel safely.`);\n      return { ranges: timeRanges, expectedTotalSamples: 0 };\n    }\n\n    // Count timestamps in all ranges efficiently with one pass\n    const timestampCounts = this.countTimestampsInRanges(timeRanges);\n    \n    const parceledRanges: MillisecondRange[] = [];\n    let totalTimestampsAcrossAllRanges = 0;\n\n    for (let i = 0; i < timeRanges.length; i++) {\n      const range = timeRanges[i];\n      const timestampCount = timestampCounts[i];\n      const totalSamples = timestampCount * sampleCount;\n      \n      totalTimestampsAcrossAllRanges += timestampCount;\n\n      // Skip ranges with no timestamps\n      if (timestampCount === 0) {\n        continue;\n      }\n\n      // If this range fits within the limit, keep it as-is\n      if (totalSamples <= effectiveLimit) {\n        parceledRanges.push(range);\n        continue;\n      }\n\n      // Need to split this range - get actual timestamps and chunk them\n      const timestampsInRange = this.getTimestampsInRange(range);\n      \n      for (let j = 0; j < timestampsInRange.length; j += maxTimestampsPerRequest) {\n        // if j + maxTimestampsPerRequest exceeds length, slice will just take to end\n        const chunkTimestamps = timestampsInRange.slice(j, j + maxTimestampsPerRequest);\n        \n        if (chunkTimestamps.length === 0) continue;\n\n        // Create a new range from first to last timestamp in this chunk\n        const newRange: MillisecondRange = {\n          start: chunkTimestamps[0],\n          end: chunkTimestamps[chunkTimestamps.length - 1]\n        };\n\n        parceledRanges.push(newRange);\n      }\n    }\n    \n    // Calculate expected total samples: total timestamps  sample count\n    const expectedTotalSamples = totalTimestampsAcrossAllRanges * sampleCount;\n    \n    return { ranges: parceledRanges, expectedTotalSamples };\n  }\n} ","import { ref, computed, watch, Ref, nextTick } from 'vue';\nimport { getTimezoneOffset } from 'date-fns-tz';\n\nconst ONEDAYMS = 1000 * 60 * 60 * 24;\n\nfunction isBad(value: unknown): value is null | undefined {\n  return value === null || value === undefined;\n}\n\nexport const useUniqueTimeSelection = (timestamps: Ref<number[]>) => {\n  const timeIndex = ref(0);\n  const singleDateSelected = ref<Date>(new Date());\n  const minIndex = ref<number>(0);\n  const maxIndex = ref<number>(0);\n  \n  const mode = ref<'single' | 'all'>('single');\n  const initialTimeSelection = ref<'first' | 'last'>('first');\n\n  function getOneDaysTimestamps(date: Date) {\n    if (isBad(date)) {\n      return [];\n    }\n    const mod = [] as {ts:number, idx: number}[];\n    timestamps.value.forEach((ts, idx) => {\n      if ((ts - date.getTime()) < ONEDAYMS && (ts - date.getTime()) > 0) {\n        mod.push({ ts, idx });\n      }\n    });\n    return mod;\n  }\n  \n  function getAllDaysTimestamps(date: Date) {\n    if (isBad(date)) {\n      return [];\n    }\n    // const mod = [] as {ts:number, idx: number}[];\n    // timestamps.value.forEach((ts, idx) => {\n    //   mod.push({ ts, idx });\n    // });\n    return timestamps.value.map((ts, idx) => ({ ts, idx }));\n  }\n\n  function setNearestDate(date: number | null) {\n    if (date == null) {\n      return;\n    }\n\n    const mod = mode.value === 'single' ? getOneDaysTimestamps(new Date(date)) : getAllDaysTimestamps(new Date(date));\n    if (mod.length > 0) {\n      minIndex.value = mod[0].idx;\n      maxIndex.value = mod[mod.length - 1].idx;\n      timeIndex.value = initialTimeSelection.value === 'first' ? minIndex.value : maxIndex.value;\n    } else {\n      console.warn(\"No timestamps found for the given date.\");\n    }\n  }\n\n  const timestamp = computed(() => {\n    if (timestamps.value.length === 0) {\n      return null;\n    }\n    const val = timestamps.value[timeIndex.value];\n    return val;\n  });\n\n  const date = computed(() => {\n    return timestamp.value ? new Date(timestamp.value) : null;\n  });\n\n  const offset = (date: Date) => getTimezoneOffset(\"US/Eastern\", date);\n\n  const uniqueDays = computed(() => {\n    const easternDates = timestamps.value.map(ts => new Date(ts + offset(new Date(ts))));\n    const days = easternDates.map(date => (new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate())).getTime());\n    const unique = Array.from(new Set(days));\n    return unique.map(ts => new Date(ts));\n  });\n\n  const uniqueDaysIndex = (ts: number) => {\n    let date = new Date(ts + offset(new Date(ts)));\n    date = new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n    return uniqueDays.value.map(e => e.getTime()).indexOf(date.getTime());\n  };\n\n  function getUniqueDayIndex(date: Date | null | undefined): number {\n    if (isBad(date)) {\n      return 0;\n    }\n    return uniqueDays.value.findIndex(day => day.getTime() === date.getTime());\n  }\n\n  function moveBackwardOneDay() {\n    const currentIndex = getUniqueDayIndex(singleDateSelected.value);\n    if (currentIndex > 0) {\n      singleDateSelected.value = uniqueDays.value[currentIndex - 1];\n    }\n  }\n\n  function moveForwardOneDay() {\n    const nextIndex = getUniqueDayIndex(singleDateSelected.value) + 1;\n    if (nextIndex < uniqueDays.value.length) {\n      singleDateSelected.value = uniqueDays.value[nextIndex];\n    }\n  }\n\n  function nearestDate(date: Date): number {\n    const time = date.getTime();\n    const timestamp = timestamps.value.find(ts => ((ts - time) < ONEDAYMS) && (ts - time) >= 0);\n    if (timestamp !== undefined) {\n      return timestamp;\n    } else {\n      console.warn(\"No matching timestamp found, returning default value.\");\n      return timestamps.value[0];\n    }\n  }\n\n  function nearestDateIndex(date: Date): number {\n    const timestamp = date.getTime();\n    const index = timestamps.value.findIndex(ts => ((ts - timestamp) < ONEDAYMS) && (ts - timestamp) >= 0);\n    if (index < 0) {\n      console.log(\"No matching timestamp found, returning default index.\");\n      return 0;\n    }\n    return index;\n  }\n  \n    \n  /**\n   * setNearestTime function will set the timeIndex to the nearest timestamp for the given date\n   * it will also setup the minIndex and maxIndex for the day, and singleDateSelected to the date\n   */\n  function setNearestTime(date: Date | null) {\n    if (isBad(date)) {\n      return;\n    }\n    // check if same day as singleDateSelected\n    let selectedDate = singleDateSelected.value;\n    const sameDay = (selectedDate.getFullYear() === date.getFullYear() &&\n        selectedDate.getMonth() === date.getMonth() &&\n        selectedDate.getDate() === date.getDate());\n    if (!sameDay) {\n      selectedDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n      // check that it is in uniqueDays\n      const uniqueDayIndex = getUniqueDayIndex(selectedDate);\n      if (uniqueDayIndex >= 0) {\n        singleDateSelected.value = uniqueDays.value[uniqueDayIndex];\n      } else {\n        throw new Error(\"Date not found in unique days\");\n      }\n    }\n    // want to set timeIndex to nearest timestamp for that day\n    nextTick(() => {\n      const index = nearestDateIndex(date);\n      timeIndex.value = index;\n      console.log(\"setNearestTime: set timeIndex to \", index, selectedDate);\n    });\n    \n  }\n  \n\n\n  watch(singleDateSelected, (value) => {\n    if (value) { \n      setNearestDate(value.getTime());\n    }\n  });\n  \n  watch(mode, () => {\n    setNearestDate(singleDateSelected.value.getTime());\n  });\n\n  watch(timestamps, (newTimestamps) => {\n    if (newTimestamps.length === 0) {\n      timeIndex.value = 0;\n      minIndex.value = 0;\n      maxIndex.value = 0;\n      return;\n    }\n    // Reset to first date if current date is out of range\n    if (timeIndex.value == null || timeIndex.value >= newTimestamps.length) {\n      timeIndex.value = 0;\n      singleDateSelected.value = new Date(newTimestamps[0]);\n    } else {\n      setNearestDate(singleDateSelected.value.getTime());\n    }\n  }, { immediate: true });\n\n  return {\n    timeIndex,\n    timestamp,\n    date,\n    singleDateSelected,\n    maxIndex,\n    minIndex,\n    uniqueDays,\n    mode,\n    initialTimeSelection,\n    uniqueDaysIndex,\n    setNearestDate,\n    getUniqueDayIndex,\n    moveBackwardOneDay,\n    moveForwardOneDay,\n    nearestDate,\n    nearestDateIndex,\n    setNearestTime,\n  };\n};\n","import { computed, type Ref } from 'vue';\nimport { toZonedTime, fromZonedTime, format as formatTz, getTimezoneOffset } from 'date-fns-tz';\nimport type { MillisecondRange } from '../types/datetime';\n\nexport type Timezone = \n  \"US/Eastern\" |\n  \"US/Central\" |\n  \"US/Mountain\" |\n  \"US/Arizona\" |\n  \"US/Pacific\" |\n  \"US/Alaska\" |\n  \"UTC\";\n\ntype TimezoneOption = { tz: Timezone, name: string };\n\n/**\n * Composable for centralized timezone handling and formatting\n */\nexport function useTimezone(selectedTimezone: Ref<string>) {\n  \n  /**\n   * Convert UTC timestamp to timezone-aware date\n   */\n  function toTimezone(timestamp: number): Date {\n    const utcDate = new Date(timestamp);\n    return toZonedTime(utcDate, selectedTimezone.value);\n  }\n\n  /**\n   * Convert timezone-aware date to UTC timestamp\n   */\n  function fromTimezone(date: Date): number {\n    return fromZonedTime(date, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Set date to local midnight in selected timezone\n   */\n  function setToMidnight(date: Date): number {\n    const zonedDate = toZonedTime(date, selectedTimezone.value);\n    zonedDate.setHours(0, 0, 0, 0);\n    return fromZonedTime(zonedDate, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Set date to end of day in selected timezone\n   */\n  function setToEndOfDay(date: Date): number {\n    const zonedDate = toZonedTime(date, selectedTimezone.value);\n    zonedDate.setHours(23, 59, 59, 999);\n    return fromZonedTime(zonedDate, selectedTimezone.value).getTime();\n  }\n\n  /**\n   * Format timestamp with full date and time\n   */\n  function formatTimeLong(timestamp: number): string {\n    const utcDate = new Date(timestamp);\n    const zonedDate = toZonedTime(utcDate, selectedTimezone.value);\n    return formatTz(zonedDate, 'EEE, MMM d, yyyy \\'at\\' h:mm a', { timeZone: selectedTimezone.value });\n  }\n\n  /**\n   * Format duration with timezone prefix\n   */\n  function formatDuration(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    const startZoned = toZonedTime(startUtc, selectedTimezone.value);\n    const endZoned = toZonedTime(endUtc, selectedTimezone.value);\n    \n    const startTime = startZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    const endTime = endZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    \n    return `${selectedTimezone.value}: ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format timezone range with date and time\n   */\n  function formatTimezoneRange(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    const startZoned = toZonedTime(startUtc, selectedTimezone.value);\n    const endZoned = toZonedTime(endUtc, selectedTimezone.value);\n    \n    const startDate = startZoned.toLocaleDateString('en-US', { \n      month: 'short', \n      day: 'numeric' \n    });\n    const startTime = startZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    const endTime = endZoned.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n    \n    return `${startDate} ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format UTC range\n   */\n  function formatUTCRange(range: MillisecondRange): string {\n    const startUtc = new Date(range.start);\n    const endUtc = new Date(range.end);\n    \n    const startDate = startUtc.toLocaleDateString('en-US', { \n      month: 'short', \n      day: 'numeric',\n      timeZone: 'UTC'\n    });\n    const startTime = startUtc.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true,\n      timeZone: 'UTC'\n    });\n    const endTime = endUtc.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true,\n      timeZone: 'UTC'\n    });\n    \n    return `${startDate} ${startTime} - ${endTime}`;\n  }\n\n  /**\n   * Format time string for display\n   */\n  function formatTime(timeString: string): string {\n    const [hour, minute] = timeString.split(':').map(Number);\n    const date = new Date();\n    date.setHours(hour, minute, 0, 0);\n    return date.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    });\n  }\n\n  /**\n   * Format date for display\n   */\n  function formatDateDisplay(date: Date | null): string {\n    return date?.toDateString() || '';\n  }\n\n  // Computed properties for reactive timezone info\n  const timezoneInfo = computed(() => ({\n    name: selectedTimezone.value,\n    offset: new Date().toLocaleString('en', {\n      timeZone: selectedTimezone.value,\n      timeZoneName: 'short'\n    }).split(' ').pop() || ''\n  }));\n\n  function isDST(date: Date): boolean {\n    const standardOffset = getTimezoneOffset(selectedTimezone.value, new Date(date.getUTCFullYear(), 0, 1));\n    const currentOffset = getTimezoneOffset(selectedTimezone.value, date);\n    if (standardOffset === currentOffset) {\n      return false;\n    }\n    return true;\n  }\n\n  function timezoneOptions(date: Date): TimezoneOption[] {\n    const dateIsDST = isDST(date);\n    return [\n      { tz: 'US/Eastern', name: dateIsDST ? 'Eastern Daylight' : 'Eastern Standard' },\n      { tz: 'US/Central', name: dateIsDST ? 'Central Daylight' : 'Central Standard' },\n      { tz: 'US/Mountain', name: dateIsDST ? 'Mountain Daylight' : 'Mountain Standard' },\n      { tz: 'US/Arizona', name: 'Mountain Standard (AZ)' },\n      { tz: 'US/Pacific', name: dateIsDST ? 'Pacific Daylight' : 'Pacific Standard' },\n      { tz: 'US/Alaska', name: dateIsDST ? 'Alaska Daylight' : 'Alaska Standard' },\n      { tz: 'UTC', name: 'UTC' },\n    ];\n  }\n\n  return {\n    // Core timezone operations\n    toTimezone,\n    fromTimezone,\n    setToMidnight,\n    setToEndOfDay,\n    \n    // Formatting functions\n    formatTimeLong,\n    formatDuration,\n    formatTimezoneRange,\n    formatUTCRange,\n    formatTime,\n    formatDateDisplay,\n\n    // Utility functions\n    isDST,\n    timezoneOptions,\n    \n    // Computed properties\n    timezoneInfo,\n  };\n}\n","\n\n/**\n * @function atleast1d\n * Ensures that the input is at least 1-dimensional. If the input is a single value, it wraps it in an array.\n * If the input is already an array, it returns the array as is.\n * If the input is undefined, it returns undefined.\n * If the input is null, it returns an array with a single null element.\n */\n// The complicated typing ensures that if T is undefined, the return type is also undefined.\nexport function atleast1d<T>(value: T | T[]): T[] {\n  return (Array.isArray(value) ? value : [value]);\n}","import { getTimezoneOffset } from \"date-fns-tz\";\nimport type { MillisecondRange, TimeRange, UserDataset } from \"../types\";\n\nexport function formatSingleRange(range: MillisecondRange): string {\n  const startString = new Date(range.start).toLocaleDateString();\n  const endString = new Date(range.end).toLocaleDateString();\n  if (startString === endString) {\n    return startString;\n  }\n  return `${startString} - ${endString}`;\n}\n\nexport function formatTimeRange(ranges: MillisecondRange | MillisecondRange[]): string {\n  if (Array.isArray(ranges)) {\n    if (ranges.length === 0) {\n      return 'No time range set';\n    }\n    \n    if (ranges.length === 1) {\n      return formatSingleRange(ranges[0]); \n    } else {\n      // For multiple ranges, show the full span\n      const allStarts = ranges.map(r => r.start);\n      const allEnds = ranges.map(r => r.end);\n      const minStart = Math.min(...allStarts);\n      const maxEnd = Math.max(...allEnds);\n      return `${new Date(minStart).toLocaleDateString()} - ${new Date(maxEnd).toLocaleDateString()} (${ranges.length} ranges)`;\n    }\n  } else {\n    return formatSingleRange(ranges);\n  }\n}\n\nexport function getTimeRangeDisplay(sel: UserDataset): string {\n  if (!sel.timeRange || !sel.timeRange.range) {\n    return `No time range set for selection ${sel.id}`;\n  }\n  return formatTimeRange(sel.timeRange.range);\n}\n\nexport function rangeForSingleDay(day: Date, timezone: string): MillisecondRange {\n  const offset = getTimezoneOffset(timezone, day);\n  const dayUTC = day.getTime() - offset;\n  const start = dayUTC - (dayUTC % 86400000) - offset; // Start of the day in milliseconds\n  const end = start + (86400000 - 1); // End of the day in milliseconds\n  return { start, end };\n}\n\nexport function areEquivalentMsRanges(first: MillisecondRange, second: MillisecondRange): boolean {\n  return first.start === second.start && first.end === second.end;\n}\n\nexport function areEquivalentTimeRanges(first: TimeRange, second: TimeRange): boolean {\n  if (first.id === second.id) {\n    return true;\n  }\n\n  const array = Array.isArray(first.range);\n  if (array !== Array.isArray(second.range)) {\n    return false;\n  }\n\n  if (array) {\n    const firstRange = first.range as MillisecondRange[];\n    const secondRange = second.range as MillisecondRange[];\n    return firstRange.length === secondRange.length &&\n      firstRange.every((rg, idx) => areEquivalentMsRanges(rg, secondRange[idx]));\n  } else {\n    return areEquivalentMsRanges(first.range as MillisecondRange, second.range as MillisecondRange);\n  }\n}\n","import { defineStore, type StateTree } from \"pinia\";\nimport { computed, ref, watch, toRaw } from \"vue\";\nimport { v4 } from \"uuid\";\nimport type { Map } from \"maplibre-gl\";\nimport { isComputedRef } from \"@/utils/vue\";\nimport { parse, stringify } from \"zipson\";\n\nimport type { AggValue, InitMapOptions, LatLngPair, MappingBackends, SelectionType, TimeRange, UnifiedRegion, UserDataset } from \"@/types\";\nimport { ESRI_URLS_V03, ESRI_URLS_V04, MoleculeType } from \"@/esri/utils\";\nimport { TempoDataService, FetchOptions } from \"@/esri/services/TempoDataService\";\nimport { useUniqueTimeSelection } from \"@/composables/useUniqueTimeSelection\";\nimport { useTimezone, type Timezone } from \"@/composables/useTimezone\";\nimport { atleast1d } from \"@/utils/atleast1d\";\nimport { formatSingleRange, rangeForSingleDay } from \"@/utils/timeRange\";\n\nconst createTempoStore = (backend: MappingBackends) => defineStore(\"tempods\", () => {\n  const debugMode = ref(false);\n  const timeRanges = ref<TimeRange[]>([]);\n  const regions = ref<UnifiedRegion[]>([]);\n  const datasets = ref<UserDataset[]>([]);\n  const timestamps = ref<number[]>([]);\n  const timestampsLoaded = ref(false);\n  const tempoDataServices: Record<MoleculeType, TempoDataService> | object = {};\n  const backendRef = ref<MappingBackends>(backend);\n  const maxSampleCount = ref(50);\n  const sampleErrors = ref<Record<string, string | null>>({});\n  const regionsCreatedCount = ref(0);\n  const userSelectedCalendarDates: number[] = [];\n  const userSelectedTimezones: string[] = [];\n  const userSelectedLocations: string[] = [];\n  const userSelectedNotableEvents: [string, string][] = [];\n  const shareButtonClickedCount = ref(0);\n  const playButtonClickedCount = ref(0);\n  const timeSliderUsedCount = ref(0);\n  const opacitySliderUsedCount = ref(0);\n\n  const maps = ref<Map[]>([]);\n\n  const datasetControlsOpen = ref(false);\n  const layerControlsOpen = ref(true);\n\n  const selectionActive = ref<SelectionType>(null);\n  const focusRegion = ref<UnifiedRegion | null>(null);\n  const regionOpacity = ref(0.7);\n  const regionVisibility = ref(true);\n\n  const showFieldOfRegard = ref(false);\n  const showRoads = ref(true);\n  const showSamplingPreviewMarkers = ref(false);\n  \n  const showAdvancedLayers = ref(false);\n  const showRGBMode = ref(false);\n\n\n  const showAggregationControls = ref(false);\n\n  const selectedTimezone = ref<Timezone>(\"US/Eastern\");\n  const { isDST, timezoneOptions: tzOptions } = useTimezone(selectedTimezone);\n\n  const dateIsDST = computed(() => isDST(singleDateSelected.value));\n  const timezoneOptions = computed(() => tzOptions(singleDateSelected.value));\n  \n  const shownLayers = ref<string[]>([]);\n\n  // This part is still assuming that multiple maps will be temporally linked\n  // If/when we want to make that not the case, we'll need to rethink this\n  // and some of the consuming components\n  const {\n    timeIndex,\n    timestamp,\n    date,\n    singleDateSelected,\n    maxIndex,\n    minIndex,\n    uniqueDays,\n    uniqueDaysIndex,\n    setNearestDate,\n    moveBackwardOneDay,\n    moveForwardOneDay,\n    nearestDateIndex,\n    setNearestTime,\n  } = useUniqueTimeSelection(timestamps);\n\n\n  const accentColor = ref(\"#068ede\");\n  const accentColor2 = ref(\"#ffcc33\");\n  const tempoRed = ref(\"#b60e32\");\n\n\n  function getTempoDataService(molecule: MoleculeType): TempoDataService {\n    if (molecule in tempoDataServices) {\n      return tempoDataServices[molecule];\n    }\n    const v03 = ESRI_URLS_V03[molecule];\n    const v04 = ESRI_URLS_V04[molecule];\n    const tds = new TempoDataService([v03.url, v04.url], v03.variable);\n    tempoDataServices[molecule] = tds;\n    return tds;\n  }\n\n  function addTimeRange(range: TimeRange) {\n    timeRanges.value.push(range);\n  }\n\n  function deleteTimeRange(range: TimeRange) {\n    const index = timeRanges.value.findIndex(r => r.id === range.id);\n    if (index < 0) {\n      return;\n    }\n    timeRanges.value.splice(index, 1);\n  }\n\n  watch(singleDateSelected, (_newDate, oldDate) => {\n    const oldRange = rangeForSingleDay(oldDate, selectedTimezone.value);\n    const displayedDateSelections = datasets.value.filter(sel => {\n      const range = sel.timeRange.range;\n      return !Array.isArray(range) &&\n             range.start === oldRange.start &&\n             range.end === oldRange.end;\n    });\n    if (displayedDateSelections.length === 0) {\n      return;\n    }\n  \n    const index = timeRanges.value.findIndex(timeRange => {\n      const range = timeRange.range;\n      return !Array.isArray(range) &&\n             range.start === oldRange.start &&\n             range.end === oldRange.end &&\n             timeRange.id !== \"displayed-day\";\n    });\n    if (index < 0) {\n      const formatted = formatSingleRange(oldRange);\n      const oldTimeRange: TimeRange = {\n        id: v4(),\n        name: formatted,\n        description: formatted,\n        range: oldRange,\n        type: 'single'\n      };\n      timeRanges.value.push(oldTimeRange);\n    }\n  });\n\n\n  const zoomScale = 0.5; // for matplibre-gl\n  const urlParams = new URLSearchParams(window.location.search);\n  const initLat = parseFloat(urlParams.get(\"lat\") || '40.044');\n  const initLon = parseFloat(urlParams.get(\"lon\") || '-98.789');\n  const initZoom = parseFloat(urlParams.get(\"zoom\") || `${4 * zoomScale}`); // 4 is the default zoom level for the map, multiplied by zoomScale for maplibre\n  const initTime = urlParams.get(\"t\");\n  const initState = ref<InitMapOptions>({\n    loc: [initLat, initLon] as LatLngPair,\n    zoom: initZoom,\n    t: initTime ? +initTime : null\n  });\n  \n  const homeLat = 40.044;\n  const homeLon = -98.789;\n  const homeZoom = 4 * zoomScale; // 4 is the default zoom level for the map, multiplied by zoomScale for maplibre\n  const homeState = ref({\n    loc: [homeLat, homeLon] as LatLngPair,\n    zoom: homeZoom,\n    t: null as number | null\n  });\n\n  watch(timestampsLoaded, (loaded: boolean) => {\n    if (loaded) {\n      console.log('timestamps loaded');\n      if (initState.value.t) {\n        let index = uniqueDaysIndex(initState.value.t);\n        if (index == -1) {\n          return;\n        }\n        console.log('set the date');\n        singleDateSelected.value = uniqueDays.value[index];\n        index = nearestDateIndex(new Date(initState.value.t));\n        if (index == -1) {\n          return;\n        }\n        timeIndex.value = index;\n        // FIXME if needed. if we find the time is not being set, use nextTick\n        // this.$nextTick(() => { this.timeIndex = index;});\n      }\n    }\n  });\n\n  watch(timestamps, () => {\n    if (uniqueDays.value.length === 0) {\n      return;\n    }\n    singleDateSelected.value = uniqueDays.value[uniqueDays.value.length - 1];\n  });\n\n  function addRegion(region: UnifiedRegion) {\n    // TODO: Fix the typing here\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    regions.value.push(region);\n  }\n\n  function deleteDataset(dataset: UserDataset) {\n    const index = datasets.value.findIndex(s => s.id == dataset.id);\n    if (index < 0) {\n      return;\n    }\n    datasets.value.splice(index, 1);\n  }\n\n  function addDataset(dataset: UserDataset, fetch=true, onProgress?: FetchOptions[\"onProgress\"]) {\n    datasets.value.push(dataset);\n    if (fetch) {\n      fetchDataForDataset(dataset, onProgress);\n    }\n    return dataset;\n  }\n\n  function markDatasetUpdated(dataset: UserDataset) {\n    const index = datasets.value.findIndex(ds => ds.id === dataset.id);\n    if (index >= 0) {\n      datasets.value[index] = { ...dataset };\n    }\n  }\n\n  function setRegionName(region: UnifiedRegion, newName: string) {\n    if (newName.trim() === '') {\n      console.error(\"Region name cannot be empty.\");\n      return;\n    }\n    // eslint-disable-next-line\n    // @ts-ignore it is not actually deep\n    const existing = (regions.value as UnifiedRegion[]).find(r => r.name === newName && r.id !== region.id);\n    if (existing) {\n      console.error(`A region with the name \"${newName}\" already exists.`);\n      return;\n    }\n    region.name = newName;\n    console.log(`Renamed ${region.geometryType} region to: ${newName}`);\n    \n    // check for any datasets using this region and update the region name\n    datasets.value.forEach(ds => {\n      if (ds.region.id === region.id) {\n        ds.region.name = region.name;\n      }\n    });\n  }\n\n  function setTimeRangeName(timeRange: TimeRange, newName: string) {\n    if (newName.trim() === '') {\n      console.error(\"Time range name cannot be empty.\");\n      return;\n    }\n    const existing = timeRanges.value.find(tr => tr.name === newName && tr.id !== timeRange.id);\n    if (existing) {\n      console.error(`A time range with the name \"${newName}\" already exists.`);\n      return;\n    }\n    timeRange.name = newName;\n    console.log(`Renamed time range to: ${newName}`);\n    \n    // Update the name in any datasets using this time range\n    datasets.value.forEach(ds => {\n      if (ds.timeRange.id === timeRange.id) {\n        ds.timeRange.name = timeRange.name;\n      }\n    });\n  }\n\n  async function fetchDataForDataset(dataset: UserDataset, onProgress?: FetchOptions[\"onProgress\"]) {\n    dataset.loading = true;\n\n    // loadingSamples.value = sel.id;\n    // sampleErrors.value[sel.id] = null;\n    \n    const timeRanges = atleast1d(dataset.timeRange.range);\n    \n    try {\n      const tds = getTempoDataService(dataset.molecule);\n      tds.setAvailableTimestamps(timestamps.value);\n      const data = await tds.fetchTimeseriesData(dataset.region.geometryInfo, timeRanges, {onProgress});\n      dataset.samples = data.values;\n      dataset.errors = data.errors;\n      // loadingSamples.value = \"finished\";\n      console.log(`Fetched data for ${timeRanges.length} time range(s)`);\n    } catch (error) {\n      sampleErrors.value[dataset.id] = error instanceof Error ? error.message : String(error);\n      // loadingSamples.value = \"error\";\n    }\n  \n    dataset.loading = false;\n  \n    markDatasetUpdated(dataset);\n  }\n\n  async function fetchCenterPointDataForDataset(dataset: UserDataset) {\n    sampleErrors.value[dataset.id] = null;\n\n    const tds = getTempoDataService(dataset.molecule);\n    const timeRanges = atleast1d(dataset.timeRange.range);\n\n    \n    try {\n      const data = await tds.fetchCenterPointData(\n        dataset.region.geometryInfo,\n        timeRanges,\n        { sampleCount: maxSampleCount.value },\n      );\n      if (data) {\n        dataset.samples = data.values;\n        dataset.locations = data.locations;\n        console.log(`Fetched center point data for ${timeRanges.length} time range(s)`);\n      }\n    } catch (error) {\n      sampleErrors.value[dataset.id] = error instanceof Error ? error.message : String(error);\n    }\n  }\n\n  function datasetHasSamples(dataset: UserDataset): boolean {\n    return (dataset.samples !== undefined) && Object.keys(dataset.samples).length > 0;\n  }\n\n  function regionHasDatasets(region: UnifiedRegion): boolean {\n    const sel = datasets.value.find(ds => ds.region.id === region.id);\n    return sel !== undefined;\n  }\n\n  function deleteRegion(region: UnifiedRegion) {\n    const index = regions.value.findIndex(r => r.id === region.id);\n    if (index < 0) {\n      return;\n    }\n    regions.value.splice(index, 1);\n  }\n\n  function registerMap(map: Map) {\n    maps.value.push(map);\n  }\n\n  function deregisterMap(map: Map) {\n    const index = maps.value.findIndex(m => m === map);\n    if (index > -1) {\n      maps.value.splice(index);\n    }\n  }\n\n  function reset() {\n    regions.value = [];\n    regionsCreatedCount.value = 0;\n    timeRanges.value = [];\n    datasets.value = [];\n  }\n\n  return {\n    debugMode,\n\n    accentColor,\n    accentColor2,\n    tempoRed,\n\n    selectedTimezone,\n    dateIsDST,\n    timezoneOptions,\n\n    selectionActive,\n    focusRegion,\n    regionOpacity,\n    regionVisibility,\n\n    showFieldOfRegard,\n    showRoads,\n    showSamplingPreviewMarkers,\n    showAdvancedLayers,\n    showRGBMode,\n\n    showAggregationControls,\n\n    datasetControlsOpen,\n    layerControlsOpen,\n\n    homeState,\n    initState,\n\n    maps,\n    registerMap,\n    deregisterMap,\n\n    regions,\n    regionsCreatedCount,\n    timeRanges,\n    backend: backendRef,\n    maxSampleCount,\n    getTempoDataService,\n    tempoDataServices,\n    datasets,\n    timestamps,\n    timestampsLoaded,\n\n    addTimeRange,\n    addRegion,\n    addDataset,\n    fetchDataForDataset,\n    fetchCenterPointDataForDataset,\n    markDatasetUpdated,\n    datasetHasSamples,\n    regionHasDatasets,\n    setRegionName,\n    setTimeRangeName,\n\n    deleteTimeRange,\n    deleteRegion,\n    deleteDataset,\n\n    userSelectedLocations,\n    userSelectedTimezones,\n    userSelectedCalendarDates,\n    userSelectedNotableEvents,\n    shareButtonClickedCount,\n    playButtonClickedCount,\n    timeSliderUsedCount,\n    opacitySliderUsedCount,\n\n    timeIndex,\n    timestamp,\n    date,\n    singleDateSelected,\n    maxIndex,\n    minIndex,\n    uniqueDays,\n    uniqueDaysIndex,\n    setNearestDate,\n    moveBackwardOneDay,\n    moveForwardOneDay,\n    nearestDateIndex,\n    setNearestTime,\n    \n    shownLayers,\n\n    reset,\n  };\n});\n\nexport const useTempoStore = createTempoStore(\"maplibre\");\n\nexport type TempoStore = ReturnType<typeof useTempoStore>;\n\nfunction isDateLikeString(value: string): boolean {\n  return /^\\d{4}-\\d{2}-\\d{2}/.test(value);\n}\n\nexport function deserializeTempoStore(value: string): StateTree {\n  if (!value) {\n    return {};\n  }\n  const parsed = parse(value);\n  parsed.singleDateSelected = new Date(parsed.singleDateSelected);\n  for (const dataset of parsed.datasets) {\n    const samples = dataset.samples as Record<number, AggValue>;\n    if (samples) {\n      for (const entry of Object.values(samples)) {\n        entry.date = new Date(entry.date);\n      }\n    }\n\n    // Convert dates in plotlyDatasets if they exist\n    if (dataset.plotlyDatasets) {\n      for (const plotlyDataset of dataset.plotlyDatasets) {\n        if (plotlyDataset.datasetOptions?.customdata) {\n          plotlyDataset.datasetOptions.customdata = plotlyDataset.datasetOptions.customdata.map(d => d ? new Date(d) : d);\n        }\n        \n        // Convert strings in x array if they are dates\n        if (plotlyDataset.x?.[0] && typeof plotlyDataset.x[0] === 'string' && isDateLikeString(plotlyDataset.x[0])) {\n          plotlyDataset.x = plotlyDataset.x.map(d => d ? new Date(d) : d);\n        }\n      }\n    }\n  }\n  return parsed;\n}\n\nconst OMIT = new Set([\"debugMode\", \"selectionActive\", \"maps\"]);\nexport function serializeTempoStore(store: TempoStore): string {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const state: Record<string, any> = {};\n  for (const [key, value] of Object.entries(store.$state)) {\n    if (OMIT.has(key) || isComputedRef(value)) {\n      continue;\n    }\n    state[key] = toRaw(value);\n  }\n  state.regions = state.regions.map(r => {\n    const s = { ...r };\n    delete s.layer;\n    return s;\n  });\n  const stringified = stringify(state);\n  return stringified;\n}\n\nexport function postDeserializeTempoStore(store: TempoStore) {\n  for (const dataset of store.datasets) {\n    if (dataset.loading) {\n      store.fetchDataForDataset(dataset);\n    }\n  }\n}\n\nexport function updateStoreFromJSON(store: TempoStore, json: string): boolean {\n  try {\n    const state = deserializeTempoStore(json);\n    store.$patch(state);\n    postDeserializeTempoStore(store);\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n","<template>\n  <v-app\n    id=\"app\"\n    :style=\"cssVars\"\n  >\n    <header-bar />\n    <div ref=\"root\" class=\"layout-root\">\n      <side-placeholder\n        id=\"layers-panel\"\n        ref=\"layers-panel\"\n        class=\"panel\"\n        open-direction=\"right\"\n        icon=\"mdi-layers\"\n        :color=\"accentColor2\"\n        open-tooltip-text=\"Hide layer controls\"\n        closed-tooltip-text=\"Show layer controls\"\n        open-arrow-color=\"surface-variant\"\n        :closed-arrow-color=\"accentColor2\"\n        tooltips\n        v-model:open=\"layerControlsOpen\"\n      >\n        <template #default>\n          <comparison-data-controls\n            class=\"comparison-data-controls\"\n          />\n        </template>\n      </side-placeholder>\n\n      <v-tooltip\n        text=\"Change panel width\"\n        location=\"end center\"\n        :disabled=\"dragging\"\n      >\n        <template #activator=\"{ props }\">\n          <div\n            v-bind=\"props\"\n            class=\"handle\"\n            ref=\"left-handle\"\n            aria-label=\"Resize left/middle\"\n            role=\"separator\"\n          ></div>\n        </template>\n      </v-tooltip>\n\n      <map-with-controls id=\"map-panel\" />\n\n      <v-tooltip\n        text=\"Change panel width\"\n        location=\"start center\"\n        :disabled=\"dragging\"\n      >\n        <template #activator=\"{ props }\">\n          <div\n            v-bind=\"props\"\n            class=\"handle\"\n            ref=\"right-handle\"\n            aria-label=\"Resize middle/right\"\n            role=\"separator\"\n          ></div>\n        </template>\n      </v-tooltip>\n\n      <side-placeholder\n        id=\"datasets-panel\"\n        ref=\"datasets-panel\"\n        class=\"panel\"\n        open-direction=\"left\"\n        icon=\"mdi-chart-line\"\n        :color=\"accentColor2\"\n        open-tooltip-text=\"Hide graphing controls\"\n        closed-tooltip-text=\"Show graphing controls\"\n        open-arrow-color=\"surface-variant\"\n        :closed-arrow-color=\"accentColor2\"\n        tooltips\n        v-model:open=\"datasetControlsOpen\"\n      >\n        <template #default>\n          <dataset-controls\n           class=\"dataset-controls\"\n          />\n        </template>\n     </side-placeholder>\n    </div>\n  </v-app>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onBeforeMount, onMounted, ref, type Ref, useTemplateRef, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\n\nimport { useTempoStore, updateStoreFromJSON, serializeTempoStore } from \"@/stores/app\";\n\nconst root = useTemplateRef<HTMLDivElement>(\"root\");\nconst leftHandle = useTemplateRef<HTMLDivElement>(\"left-handle\");\nconst rightHandle = useTemplateRef<HTMLDivElement>(\"right-handle\");\n// const layersPanel = useTemplateRef<HTMLElement>(\"layers-panel\");\n// const datasetsPanel = useTemplateRef<HTMLElement>(\"datasets-panel\");\n// const mapsPanel = useTemplateRef<HTMLElement>(\"maps-panel\");\n\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  debugMode,\n  tempoRed,\n  datasetControlsOpen,\n  layerControlsOpen,\n} = storeToRefs(store);\n\nconst query = new URLSearchParams(window.location.search);\ndebugMode.value = (query.get(\"debug\") ?? process.env.VUE_APP_TEMPO_LAB_DEBUG)?.toLowerCase() == \"true\";\nconst ignoreCache = query.get(\"ignorecache\")?.toLowerCase() == \"true\";\n\nconst infoColor = \"#092088\";\nconst HANDLE_SIZE_PX = 4;\nconst DEFAULT_PANEL_WIDTH_PX = 300;\nconst MIN_PANEL_WIDTH_PX = 250;\nconst PLACEHOLDER_WIDTH_PX = 40;\nconst cssVars = computed(() => {\n  return {\n    \"--accent-color\": accentColor.value,\n    \"--accent-color-2\": accentColor2.value,\n    \"--info-background\": infoColor,\n    \"--tempo-red\": tempoRed.value,\n    \"--handle-size\": `${HANDLE_SIZE_PX}px`,\n    \"--handle-color\": \"gray\",\n    \"--handle-hover-color\": accentColor.value,\n  };\n});\n\nconst localStorageKey = \"tempods\";\nlet animationFrame = 0;\n\nfunction setBasis(panel: HTMLElement, sizePx: number) {\n  panel.style.flexBasis = `${sizePx}px`;\n}\n\nfunction getBasis(panel: HTMLElement): number {\n  const basis = parseFloat(getComputedStyle(panel).flexBasis);\n  return isNaN(basis) ? 0 : basis;\n}\n\nonBeforeMount(() => {\n  const storedState = ignoreCache ? undefined : window.localStorage.getItem(localStorageKey);\n  if (storedState) {\n    updateStoreFromJSON(store, storedState);\n  }\n});\n\nfunction updateSizes(layersDefault: boolean = false, datasetsDefault: boolean = false) {\n  // const rootElement = root.value;\n  const layers = document.querySelector(\"#layers-panel\") as HTMLElement;\n  const datasets = document.querySelector(\"#datasets-panel\") as HTMLElement;\n\n  const layersWidth = layerControlsOpen.value ? (layersDefault ? DEFAULT_PANEL_WIDTH_PX : Math.max(MIN_PANEL_WIDTH_PX, layers.clientWidth)) : PLACEHOLDER_WIDTH_PX;\n  setBasis(layers, layersWidth);\n  const datasetsWidth = datasetControlsOpen.value ? (datasetsDefault ? DEFAULT_PANEL_WIDTH_PX : Math.max(MIN_PANEL_WIDTH_PX, datasets.clientWidth)) : PLACEHOLDER_WIDTH_PX;\n  setBasis(datasets, datasetsWidth);\n}\n\nconst dragging = ref(false);\n\ntype EventHandler = (event: PointerEvent) => void;\n\ninterface HandleSetupParams {\n  handle: HTMLElement;\n  onMove: EventHandler;\n  initialEventHandler?: (event: PointerEvent) => void;\n}\n\nfunction setupHandleEvents(params: HandleSetupParams) {\n  \n  const { handle, onMove } = params;\n\n  handle.addEventListener(\"pointerdown\", (event: PointerEvent) => {\n\n    event.preventDefault();\n    handle.setPointerCapture(event.pointerId);\n\n    document.body.classList.add(\"dragging\");\n\n    dragging.value = true;\n\n    if (params.initialEventHandler) {\n      params.initialEventHandler(event); \n    }\n\n    const onUp = (ev: PointerEvent) => {\n      try {\n        handle.releasePointerCapture(ev.pointerId); \n      } catch (error) {\n        console.error(error);\n      }\n      document.body.classList.remove(\"dragging\");\n      dragging.value = false;\n\n      window.removeEventListener(\"pointermove\", onMove);\n      window.removeEventListener(\"pointerup\", onUp);\n      window.removeEventListener(\"pointercancel\", onUp);\n    };\n\n    window.addEventListener(\"pointermove\", onMove);\n    window.addEventListener(\"pointerup\", onUp);\n    window.addEventListener(\"pointercancel\", onUp);\n\n  });\n}\n\nonMounted(() => {\n  \n  const left = leftHandle.value;\n  const leftPanel = document.querySelector(\"#layers-panel\") as HTMLElement;\n  if (left && leftPanel) {\n    let startXLeft = 0;\n    let startLeft = 0;\n\n    const onLeftMove = (event: PointerEvent) => {\n      const dx = event.clientX - startXLeft;\n      const minLeft = layerControlsOpen.value ? DEFAULT_PANEL_WIDTH_PX : PLACEHOLDER_WIDTH_PX;\n      const newLeftSize = Math.max(minLeft, startLeft + dx);\n      setBasis(leftPanel, newLeftSize);\n    };\n\n    const initialLeftHandler = (event: PointerEvent) => {\n      startXLeft = event.clientX;\n      startLeft = getBasis(leftPanel);\n    };\n\n    setupHandleEvents({\n      handle: left,\n      onMove: onLeftMove,\n      initialEventHandler: initialLeftHandler,\n    });\n\n  }\n\n  const right = rightHandle.value;\n  const rightPanel = document.querySelector(\"#datasets-panel\") as HTMLElement;\n  if (right && rightPanel) {\n    let startXRight = 0;\n    let startRight = 0;\n\n    const onRightMove = (event: PointerEvent) => {\n      const dx = event.clientX - startXRight;\n      const minRight = datasetControlsOpen.value ? DEFAULT_PANEL_WIDTH_PX : PLACEHOLDER_WIDTH_PX;\n      const newRightSize = Math.max(minRight, startRight - dx);\n      setBasis(rightPanel, newRightSize);\n    };\n\n    const initialRightHandler = (event: PointerEvent) => {\n      startXRight = event.clientX;\n      startRight = getBasis(rightPanel);\n    };\n\n    setupHandleEvents({\n      handle: right,\n      onMove: onRightMove,\n      initialEventHandler: initialRightHandler,\n    });\n  }\n\n  window.addEventListener(\"resize\", () => {\n    cancelAnimationFrame(animationFrame);\n    animationFrame = requestAnimationFrame(() => updateSizes());\n  });\n\n  window.addEventListener(\"visibilitychange\", () => {\n    if (document.visibilityState === \"hidden\" && !ignoreCache) {\n      const stringified = serializeTempoStore(store); \n      window.localStorage.setItem(localStorageKey, stringified);\n    }\n  });\n\n  updateSizes(true, true);\n  setHandleVisibility(leftHandle, layerControlsOpen.value);\n  setHandleVisibility(rightHandle, datasetControlsOpen.value);\n});\n\nfunction setHandleVisibility(handle: Ref<HTMLElement | null>, visible: boolean) {\n  if (handle.value) {\n    handle.value.style.display = visible ? \"unset\" : \"none\";\n  }\n}\n\nfunction onDatasetPanelOpenChange(open: boolean) {\n  updateSizes(false, true);\n  setHandleVisibility(rightHandle, open);\n}\n\nfunction onLayersPanelOpenChange(open: boolean) {\n  updateSizes(true, false);\n  setHandleVisibility(leftHandle, open);\n}\n\nwatch(datasetControlsOpen, onDatasetPanelOpenChange);\nwatch(layerControlsOpen, onLayersPanelOpenChange);\n</script>\n\n<style lang=\"less\">\n// NB: The styles here are NOT scoped - these are intended to apply to the overall application,\n// as this component is really just a layout container.\n// If we do want component-only styles, just add a <style scoped> block below this one\n\n@font-face {\n  font-family: \"Highway Gothic Narrow\";\n  src: url(\"./assets/HighwayGothicNarrow.ttf\");\n}\n\n// JC: This was commented out, but I put it back in because my browser (Chrome on Ubuntu) didn't already have Lexend\n@import url('https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap');\n\nhtml, body {\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n}\n\nbody {\n  font-family: Verdana, Arial, Helvetica, sans-serif;\n}\n\n#app {\n  h1, h2, h3, h4, h5, h6, p, div {\n    user-select: none;\n    -webkit-user-select: none;\n  }\n  font-family: \"Lexend\", sans-serif;\n  height: 100%;\n}\n\n.map-panel {\n  min-width: 250px;\n  display: flex;\n  flex-direction: row;\n  padding-left: 10px;\n  gap: 5px;\n}\n\n#layers-panel, #datasets-panel {\n  overflow-y: scroll;\n}\n\n#layers-panel {\n  margin-right: 5px;\n}\n\n#datasets-panel {\n  padding-left: 2px;\n}\n\n.comparison-data-controls,\n.dataset-controls {\n  width: 100%;\n  padding-inline: 8px;\n}\n\n:root {\n  // font-size: clamp(14px, 1.7vw, 16px);\n  // --default-font-size: 1rem; // we don't use this\n  font-size: 16px; // this is the standard browser default\n  --default-line-height: clamp(1rem, min(2.2vh, 2.2vw), 1.6rem); // we don't use this\n  --smithsonian-blue: #009ade;\n  --smithsonian-yellow: #ffcc33;\n  --info-background: #092088;\n  --map-height: 500px;\n}\n\n@media (max-width: 750px) {\n  :root {\n    --map-height: 60vh;\n    --map-height: 60dvh;\n    --map-height: 60svh;\n    font-size: 14px;\n  }\n}\n\n.tab-content {\n  padding: 0.5rem 1rem;\n  border: 5px solid var(--tempo-red);\n  border-radius: 10px;\n  margin: 10px;\n}\n\n.layout-root {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  overflow: hidden;\n}\n\n.panel {\n  flex: 0 0 auto;\n  width: 100%;\n  background: var(--panel);\n  box-sizing: border-box;\n  overflow: auto;\n  border: 1px solid rgba(255,255,255,0.06);\n}\n\n.handle {\n  flex: 0 0 var(--handle-size);\n  width: var(--handle-size);\n  cursor: col-resize;\n  background: var(--handle-color);\n  position: relative;\n  touch-action: none;\n}\n\n.handle:hover {\n  background: var(--handle-hover-color);\n}\n\n.handle::after {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 2px;\n  height: 40px;\n  border-radius: 2px;\n  background: rgba(255,255,255,0.35);\n  box-shadow: -6px 0 0 rgba(255,255,255,0.18), 6px 0 0 rgba(255,255,255,0.18);\n}\n\n.dragging, .dragging * {\n  cursor: col-resize !important;\n}\n</style>\n","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, unref as _unref, isRef as _isRef, withCtx as _withCtx, mergeProps as _mergeProps, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { computed, onBeforeMount, onMounted, ref, type Ref, useTemplateRef, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\n\nimport { useTempoStore, updateStoreFromJSON, serializeTempoStore } from \"@/stores/app\";\n\nconst infoColor = \"#092088\";\nconst HANDLE_SIZE_PX = 4;\nconst DEFAULT_PANEL_WIDTH_PX = 300;\nconst MIN_PANEL_WIDTH_PX = 250;\nconst PLACEHOLDER_WIDTH_PX = 40;\nconst localStorageKey = \"tempods\";\ntype EventHandler = (event: PointerEvent) => void;\n\ninterface HandleSetupParams {\n  handle: HTMLElement;\n  onMove: EventHandler;\n  initialEventHandler?: (event: PointerEvent) => void;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'TempoLab',\n  setup(__props) {\n\nconst root = useTemplateRef<HTMLDivElement>(\"root\");\nconst leftHandle = useTemplateRef<HTMLDivElement>(\"left-handle\");\nconst rightHandle = useTemplateRef<HTMLDivElement>(\"right-handle\");\n// const layersPanel = useTemplateRef<HTMLElement>(\"layers-panel\");\n// const datasetsPanel = useTemplateRef<HTMLElement>(\"datasets-panel\");\n// const mapsPanel = useTemplateRef<HTMLElement>(\"maps-panel\");\n\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  debugMode,\n  tempoRed,\n  datasetControlsOpen,\n  layerControlsOpen,\n} = storeToRefs(store);\n\nconst query = new URLSearchParams(window.location.search);\ndebugMode.value = (query.get(\"debug\") ?? process.env.VUE_APP_TEMPO_LAB_DEBUG)?.toLowerCase() == \"true\";\nconst ignoreCache = query.get(\"ignorecache\")?.toLowerCase() == \"true\";\n\nconst cssVars = computed(() => {\n  return {\n    \"--accent-color\": accentColor.value,\n    \"--accent-color-2\": accentColor2.value,\n    \"--info-background\": infoColor,\n    \"--tempo-red\": tempoRed.value,\n    \"--handle-size\": `${HANDLE_SIZE_PX}px`,\n    \"--handle-color\": \"gray\",\n    \"--handle-hover-color\": accentColor.value,\n  };\n});\n\nlet animationFrame = 0;\n\nfunction setBasis(panel: HTMLElement, sizePx: number) {\n  panel.style.flexBasis = `${sizePx}px`;\n}\n\nfunction getBasis(panel: HTMLElement): number {\n  const basis = parseFloat(getComputedStyle(panel).flexBasis);\n  return isNaN(basis) ? 0 : basis;\n}\n\nonBeforeMount(() => {\n  const storedState = ignoreCache ? undefined : window.localStorage.getItem(localStorageKey);\n  if (storedState) {\n    updateStoreFromJSON(store, storedState);\n  }\n});\n\nfunction updateSizes(layersDefault: boolean = false, datasetsDefault: boolean = false) {\n  // const rootElement = root.value;\n  const layers = document.querySelector(\"#layers-panel\") as HTMLElement;\n  const datasets = document.querySelector(\"#datasets-panel\") as HTMLElement;\n\n  const layersWidth = layerControlsOpen.value ? (layersDefault ? DEFAULT_PANEL_WIDTH_PX : Math.max(MIN_PANEL_WIDTH_PX, layers.clientWidth)) : PLACEHOLDER_WIDTH_PX;\n  setBasis(layers, layersWidth);\n  const datasetsWidth = datasetControlsOpen.value ? (datasetsDefault ? DEFAULT_PANEL_WIDTH_PX : Math.max(MIN_PANEL_WIDTH_PX, datasets.clientWidth)) : PLACEHOLDER_WIDTH_PX;\n  setBasis(datasets, datasetsWidth);\n}\n\nconst dragging = ref(false);\n\nfunction setupHandleEvents(params: HandleSetupParams) {\n  \n  const { handle, onMove } = params;\n\n  handle.addEventListener(\"pointerdown\", (event: PointerEvent) => {\n\n    event.preventDefault();\n    handle.setPointerCapture(event.pointerId);\n\n    document.body.classList.add(\"dragging\");\n\n    dragging.value = true;\n\n    if (params.initialEventHandler) {\n      params.initialEventHandler(event); \n    }\n\n    const onUp = (ev: PointerEvent) => {\n      try {\n        handle.releasePointerCapture(ev.pointerId); \n      } catch (error) {\n        console.error(error);\n      }\n      document.body.classList.remove(\"dragging\");\n      dragging.value = false;\n\n      window.removeEventListener(\"pointermove\", onMove);\n      window.removeEventListener(\"pointerup\", onUp);\n      window.removeEventListener(\"pointercancel\", onUp);\n    };\n\n    window.addEventListener(\"pointermove\", onMove);\n    window.addEventListener(\"pointerup\", onUp);\n    window.addEventListener(\"pointercancel\", onUp);\n\n  });\n}\n\nonMounted(() => {\n  \n  const left = leftHandle.value;\n  const leftPanel = document.querySelector(\"#layers-panel\") as HTMLElement;\n  if (left && leftPanel) {\n    let startXLeft = 0;\n    let startLeft = 0;\n\n    const onLeftMove = (event: PointerEvent) => {\n      const dx = event.clientX - startXLeft;\n      const minLeft = layerControlsOpen.value ? DEFAULT_PANEL_WIDTH_PX : PLACEHOLDER_WIDTH_PX;\n      const newLeftSize = Math.max(minLeft, startLeft + dx);\n      setBasis(leftPanel, newLeftSize);\n    };\n\n    const initialLeftHandler = (event: PointerEvent) => {\n      startXLeft = event.clientX;\n      startLeft = getBasis(leftPanel);\n    };\n\n    setupHandleEvents({\n      handle: left,\n      onMove: onLeftMove,\n      initialEventHandler: initialLeftHandler,\n    });\n\n  }\n\n  const right = rightHandle.value;\n  const rightPanel = document.querySelector(\"#datasets-panel\") as HTMLElement;\n  if (right && rightPanel) {\n    let startXRight = 0;\n    let startRight = 0;\n\n    const onRightMove = (event: PointerEvent) => {\n      const dx = event.clientX - startXRight;\n      const minRight = datasetControlsOpen.value ? DEFAULT_PANEL_WIDTH_PX : PLACEHOLDER_WIDTH_PX;\n      const newRightSize = Math.max(minRight, startRight - dx);\n      setBasis(rightPanel, newRightSize);\n    };\n\n    const initialRightHandler = (event: PointerEvent) => {\n      startXRight = event.clientX;\n      startRight = getBasis(rightPanel);\n    };\n\n    setupHandleEvents({\n      handle: right,\n      onMove: onRightMove,\n      initialEventHandler: initialRightHandler,\n    });\n  }\n\n  window.addEventListener(\"resize\", () => {\n    cancelAnimationFrame(animationFrame);\n    animationFrame = requestAnimationFrame(() => updateSizes());\n  });\n\n  window.addEventListener(\"visibilitychange\", () => {\n    if (document.visibilityState === \"hidden\" && !ignoreCache) {\n      const stringified = serializeTempoStore(store); \n      window.localStorage.setItem(localStorageKey, stringified);\n    }\n  });\n\n  updateSizes(true, true);\n  setHandleVisibility(leftHandle, layerControlsOpen.value);\n  setHandleVisibility(rightHandle, datasetControlsOpen.value);\n});\n\nfunction setHandleVisibility(handle: Ref<HTMLElement | null>, visible: boolean) {\n  if (handle.value) {\n    handle.value.style.display = visible ? \"unset\" : \"none\";\n  }\n}\n\nfunction onDatasetPanelOpenChange(open: boolean) {\n  updateSizes(false, true);\n  setHandleVisibility(rightHandle, open);\n}\n\nfunction onLayersPanelOpenChange(open: boolean) {\n  updateSizes(true, false);\n  setHandleVisibility(leftHandle, open);\n}\n\nwatch(datasetControlsOpen, onDatasetPanelOpenChange);\nwatch(layerControlsOpen, onLayersPanelOpenChange);\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_header_bar = _resolveComponent(\"header-bar\")!\n  const _component_comparison_data_controls = _resolveComponent(\"comparison-data-controls\")!\n  const _component_side_placeholder = _resolveComponent(\"side-placeholder\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_map_with_controls = _resolveComponent(\"map-with-controls\")!\n  const _component_dataset_controls = _resolveComponent(\"dataset-controls\")!\n  const _component_v_app = _resolveComponent(\"v-app\")!\n\n  return (_openBlock(), _createBlock(_component_v_app, {\n    id: \"app\",\n    style: _normalizeStyle(cssVars.value)\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_header_bar),\n      _createElementVNode(\"div\", {\n        ref_key: \"root\",\n        ref: root,\n        class: \"layout-root\"\n      }, [\n        _createVNode(_component_side_placeholder, {\n          id: \"layers-panel\",\n          ref: \"layers-panel\",\n          class: \"panel\",\n          \"open-direction\": \"right\",\n          icon: \"mdi-layers\",\n          color: _unref(accentColor2),\n          \"open-tooltip-text\": \"Hide layer controls\",\n          \"closed-tooltip-text\": \"Show layer controls\",\n          \"open-arrow-color\": \"surface-variant\",\n          \"closed-arrow-color\": _unref(accentColor2),\n          tooltips: \"\",\n          open: _unref(layerControlsOpen),\n          \"onUpdate:open\": _cache[0] || (_cache[0] = ($event: any) => (_isRef(layerControlsOpen) ? (layerControlsOpen).value = $event : null))\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_comparison_data_controls, { class: \"comparison-data-controls\" })\n          ]),\n          _: 1\n        }, 8, [\"color\", \"closed-arrow-color\", \"open\"]),\n        _createVNode(_component_v_tooltip, {\n          text: \"Change panel width\",\n          location: \"end center\",\n          disabled: dragging.value\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createElementVNode(\"div\", _mergeProps(props, {\n              class: \"handle\",\n              ref: \"left-handle\",\n              \"aria-label\": \"Resize left/middle\",\n              role: \"separator\"\n            }), null, 16)\n          ]),\n          _: 1\n        }, 8, [\"disabled\"]),\n        _createVNode(_component_map_with_controls, { id: \"map-panel\" }),\n        _createVNode(_component_v_tooltip, {\n          text: \"Change panel width\",\n          location: \"start center\",\n          disabled: dragging.value\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createElementVNode(\"div\", _mergeProps(props, {\n              class: \"handle\",\n              ref: \"right-handle\",\n              \"aria-label\": \"Resize middle/right\",\n              role: \"separator\"\n            }), null, 16)\n          ]),\n          _: 1\n        }, 8, [\"disabled\"]),\n        _createVNode(_component_side_placeholder, {\n          id: \"datasets-panel\",\n          ref: \"datasets-panel\",\n          class: \"panel\",\n          \"open-direction\": \"left\",\n          icon: \"mdi-chart-line\",\n          color: _unref(accentColor2),\n          \"open-tooltip-text\": \"Hide graphing controls\",\n          \"closed-tooltip-text\": \"Show graphing controls\",\n          \"open-arrow-color\": \"surface-variant\",\n          \"closed-arrow-color\": _unref(accentColor2),\n          tooltips: \"\",\n          open: _unref(datasetControlsOpen),\n          \"onUpdate:open\": _cache[1] || (_cache[1] = ($event: any) => (_isRef(datasetControlsOpen) ? (datasetControlsOpen).value = $event : null))\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_dataset_controls, { class: \"dataset-controls\" })\n          ]),\n          _: 1\n        }, 8, [\"color\", \"closed-arrow-color\", \"open\"])\n      ], 512)\n    ]),\n    _: 1\n  }, 8, [\"style\"]))\n}\n}\n\n})","import script from \"./TempoLab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TempoLab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TempoLab.vue?vue&type=style&index=0&id=41c11424&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\nconst _hoisted_2 = { class: \"colorbar-labels\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: _ctx.id,\n    class: \"colorbar-container\"\n  }, [\n    _createElementVNode(\"div\", {\n      style: _normalizeStyle({'--background-color': _ctx.backgroundColor}),\n      class: \"colorbar\"\n    }, null, 4),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"start\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.startValue), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"label\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.label), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"end\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.endValue), 1)\n        ], true)\n      ])\n    ])\n  ], 8, _hoisted_1))\n}","\n<template>\n<div :id=\"id\" class=\"colorbar-container\">\n  <div \n    :style=\"{'--background-color': backgroundColor}\"\n    class=\"colorbar\">\n  </div>\n  <div class=\"colorbar-labels\"> \n    <div><slot name=\"start\">{{ startValue }}</slot></div>\n    <div>\n      <slot name=\"label\">{{ label }}</slot>\n    </div>\n    <div><slot name=\"end\">{{ endValue }}</slot></div>\n  </div>\n</div>\n</template>\n\n\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\n\n// type for a function that maps to either a  (color, opacity) pair or just a color\ntype ColorFunction = (x: number) => string;\ntype ExtendType = boolean | 'start' | 'end' | 'both';\n\nexport default defineComponent({\n  name: 'ColorBar',\n  props: {\n    \n    name: {\n      type: String,\n      default: null\n    },\n    \n    cmapName: {\n      type: String,\n      default: 'none'\n    },\n    nsteps: {\n      type: Number,\n      default: 20\n    },\n    label: {\n      type: String,\n      default: 'Colorbar'\n    },\n    \n    cmap: {\n      type: Function as PropType<ColorFunction>,\n      default: (x: number) => `rgb(255,0,${x * 255})`\n    },\n    \n    backgroundColor: {\n      type: String,\n      default: '#5c5229'\n    },\n    \n    startValue: {\n      type: String,\n      default: '0%'\n    },\n    \n    endValue: {\n      type: String,\n      default: '100%'\n    },\n    \n    extend: {\n      type: (Boolean || String) as PropType<ExtendType>,\n      default: () => 'both'\n    }\n    \n  },\n  \n  \n  mounted() {\n    this.colorbarGradient();\n  },\n  \n  computed: {\n    id() {\n      return this.name ? `colorbar-${this.name}` : `colorbar-${Math.random().toString(36).slice(2)}`;\n    },\n    \n    triangles() {\n      return this.extend !== false;\n    },\n    \n    showStartTriangle() {\n      return this.extend === 'both' || this.extend === 'start' || this.extend;\n    },\n    \n    showEndTriangle() {\n      return this.extend === 'both' || this.extend === 'end' || this.extend;\n    }\n  },\n  \n  \n  \n  methods: {\n    \n    cssLinearGradientFromCmap() {\n      const n = this.nsteps;\n      const colors = Array.from({length: n+1}, (_, i) => {\n        const co = this.cmap(i/n);\n        const [color, _opacity] = Array.isArray(co) ? co : [co,1];\n        return `${color} ${i*100/n}%`;\n      });\n      return `linear-gradient(to top, ${colors.join(', ')})`;\n    },\n    \n    colorbarGradient() {\n      const colorbar = document.querySelector('#' + this.id + '> .colorbar');\n      if (!colorbar) {\n        return;\n      }\n      // remove all the children of the colorbar\n      while (colorbar.firstChild) {\n        colorbar.removeChild(colorbar.firstChild);\n      }\n      const div = document.createElement('div');\n      div.className = 'colorbar-chunk';\n      div.style.background = this.cssLinearGradientFromCmap();\n      div.style.height = '100%';\n      \n      \n      // add the start and end triangles\n      if (this.triangles) {\n        const start = document.createElement('div');\n        start.className = 'colorbar-start';\n        const end = document.createElement('div');\n        end.className = 'colorbar-end';\n        colorbar.appendChild(end);\n        colorbar.appendChild(div);\n        colorbar.appendChild(start);\n      \n        if (start && this.showStartTriangle) {\n          start.style.backgroundColor = this.cmap(0);\n          this.styleDownTriangle(start as HTMLDivElement);\n        }\n        if (end && this.showEndTriangle) {\n          end.style.backgroundColor = this.cmap(1);\n          this.styleUpTriangle(end as HTMLDivElement);\n        }\n      } else {\n        colorbar.appendChild(div);\n      }\n    },\n    \n    styleUpTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderBottom = `${height}px solid ${color}`;\n    },\n    \n    styleDownTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderTop = `${height}px solid ${color}`;\n    }\n  },\n  \n  watch: {\n    nsteps() {\n      this.colorbarGradient();\n    },\n    cmap() {\n      this.colorbarGradient();\n    },\n    cmapName() {\n      this.colorbarGradient();\n    },\n  }\n  \n});\n</script>\n\n<style scoped>\n/*\n* Prefixed by https://autoprefixer.github.io\n* PostCSS: v8.4.14,\n* Autoprefixer: v10.4.7\n* Browsers: last 5 version\n*/\n\n.colorbar-container {\n  position: relative;\n  display: inline-block;\n  --width: 1.25em;\n  width: -webkit-fit-content;\n  width: -moz-fit-content;\n  width: fit-content;\n  margin-left: 5px;\n  margin-right: 1em;\n  background: var(--background-color);\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.colorbar {\n  height: 100%;\n  width: var(--width);\n  margin-left: 5px;\n  margin-right: 1em;\n  background: var(--background-color);\n  display:-webkit-box;\n  display:-ms-flexbox;\n  display:flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-filter: drop-shadow(0 0 0.1rem white);\n          filter: drop-shadow(0 0 0.1rem white);\n}\n\n/* make .colorbar-start and .colorbar-end triangles */\n.colorbar-chunk {\n  \n  -ms-flex-negative: 1;\n  \n      flex-shrink: 1;\n  -webkit-box-flex:1;\n      -ms-flex-positive:1;\n          flex-grow:1;\n}\n\n.colorbar-start {\n  -ms-flex-preferred-size: min-content;\n      flex-basis: min-content;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n  -webkit-box-flex:1;\n      -ms-flex-positive:1;\n          flex-grow:1;\n}\n\n.colorbar-end {\n  -ms-flex-preferred-size: min-content;\n      flex-basis: min-content;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n  -webkit-box-flex: 1;\n      -ms-flex-positive: 1;\n          flex-grow: 1;\n}\n\n\n\n.colorbar-labels {\n  position: absolute;\n  width: -webkit-max-content;\n  width: -moz-max-content;\n  width: max-content;\n  height: 100%;\n  top: 50%;\n  line-height: 1.75;\n  /* right: -1.5ch; */\n  -webkit-transform-origin: top center;\n      -ms-transform-origin: top center;\n          transform-origin: top center;\n  -webkit-transform: rotate(180deg) translate(-100%,-50%);\n      -ms-transform: rotate(180deg) translate(-100%,-50%);\n          transform: rotate(180deg) translate(-100%,-50%);\n  -webkit-writing-mode: vertical-rl;\n      -ms-writing-mode: tb-rl;\n          writing-mode: vertical-rl;\n  \n  display: -webkit-box;\n  \n  display: -ms-flexbox;\n  \n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  }\n</style>\n","import { render } from \"./ColorBar.vue?vue&type=template&id=4b188667&scoped=true&ts=true\"\nimport script from \"./ColorBar.vue?vue&type=script&lang=ts\"\nexport * from \"./ColorBar.vue?vue&type=script&lang=ts\"\n\nimport \"./ColorBar.vue?vue&type=style&index=0&id=4b188667&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4b188667\"]])\n\nexport default __exports__","import { renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\nconst _hoisted_2 = { class: \"colorbar-labels\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: _ctx.id,\n    class: \"colorbar-container-horizontal\",\n    style: _normalizeStyle(_ctx.cssVars)\n  }, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"start\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.startValue), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"label\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.label), 1)\n        ], true)\n      ]),\n      _createElementVNode(\"div\", null, [\n        _renderSlot(_ctx.$slots, \"end\", {}, () => [\n          _createTextVNode(_toDisplayString(_ctx.endValue), 1)\n        ], true)\n      ])\n    ]),\n    _createElementVNode(\"div\", {\n      style: _normalizeStyle({'--background-color': _ctx.backgroundColor}),\n      class: \"colorbar\"\n    }, null, 4)\n  ], 12, _hoisted_1))\n}","\n<template>\n<div\n  :id=\"id\" \n  class=\"colorbar-container-horizontal\"\n  :style=\"cssVars\"\n>\n  <div class=\"colorbar-labels\"> \n    <div><slot name=\"start\">{{ startValue }}</slot></div>\n    <div>\n      <slot name=\"label\">{{ label }}</slot>\n    </div>\n    <div><slot name=\"end\">{{ endValue }}</slot></div>\n  </div>\n  <div \n    :style=\"{'--background-color': backgroundColor}\"\n    class=\"colorbar\">\n  </div>\n  \n</div>\n</template>\n\n\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\n\n// type for a function that maps to either a  (color, opacity) pair or just a color\ntype ColorFunction = (x: number) => string;\ntype ExtendType = boolean | 'start' | 'end' | 'both';\n\nexport default defineComponent({\n  name: 'ColorBar',\n  props: {\n    \n    name: {\n      type: String,\n      default: null\n    },\n    \n    cmapName: {\n      type: String,\n      default: 'none'\n    },\n    \n    nsteps: {\n      type: Number,\n      default: 20\n    },\n    label: {\n      type: String,\n      default: 'Colorbar'\n    },\n    \n    cmap: {\n      type: Function as PropType<ColorFunction>,\n      default: (x: number) => `rgb(255,0,${x * 255})`\n    },\n    \n    backgroundColor: {\n      type: String,\n      default: '#5c5229'\n    },\n    \n    startValue: {\n      type: String,\n      default: '0%'\n    },\n    \n    endValue: {\n      type: String,\n      default: '100%'\n    },\n    \n    extend: {\n      type: (Boolean || String) as PropType<ExtendType>,\n      default: () => 'both'\n    },\n\n    height: {\n      type: String,\n      default: \"1.25em\",\n    },\n\n    fontSize: {\n      type: String,\n      default: \"10pt\",\n    },\n    \n  },\n  \n  \n  mounted() {\n    this.colorbarGradient();\n    // console.log(this.$el);\n  },\n  \n  computed: {\n    id() {\n      return this.name ? `colorbar-${this.name}` : `colorbar-${Math.random().toString(36).slice(2)}`;\n    },\n    \n    triangles() {\n      return this.extend !== false;\n    },\n    \n    showStartTriangle() {\n      return this.extend === 'both' || this.extend === 'start' || this.extend;\n    },\n    \n    showEndTriangle() {\n      return this.extend === 'both' || this.extend === 'end' || this.extend;\n    },\n\n    cssVars() {\n      return {\n        \"--height\": this.height,\n        \"--font-size\": this.fontSize,\n      };\n    },\n  },\n  \n  \n  \n  methods: {\n    \n    cssLinearGradientFromCmap() {\n      const n = this.nsteps;\n      const colors = Array.from({length: n+1}, (_, i) => {\n        const co = this.cmap(i/n);\n        const [color, _opacity] = Array.isArray(co) ? co : [co,1];\n        return `${color} ${i*100/n}%`;\n      });\n      return `linear-gradient(to right, ${colors.join(', ')})`;\n    },\n    \n    colorbarGradient() {\n      const colorbar = document.querySelector('#' + this.id + '> .colorbar');\n      if (!colorbar) {\n        return;\n      }\n      // remove all the children of the colorbar\n      while (colorbar.firstChild) {\n        colorbar.removeChild(colorbar.firstChild);\n      }\n      const div = document.createElement('div');\n      // const div = this.$el.querySelector('.colorbar-chunk');\n      div.className = 'colorbar-chunk';\n      div.style.background = this.cssLinearGradientFromCmap();\n      div.style.height = 'var(--height)';\n      div.style.width = '100%';\n      \n      \n      // add the start and end triangles\n      if (this.triangles) {\n        const start = document.createElement('div');\n        start.className = 'colorbar-start';\n        const end = document.createElement('div');\n        end.className = 'colorbar-end';\n        colorbar.appendChild(start);\n        colorbar.appendChild(div);\n        colorbar.appendChild(end);\n        end && this.showEndTriangle;\n        if (start && this.showStartTriangle) {\n          start.style.backgroundColor = this.cmap(0);\n          this.styleLeftTriangle(start as HTMLDivElement);\n        }\n        if (end && this.showEndTriangle) {\n          end.style.backgroundColor = this.cmap(1);\n          this.styleRightTriangle(end as HTMLDivElement);\n        }\n      } else {\n        colorbar.appendChild(div);\n      }\n    },\n    \n    styleColorbarChunk(div: HTMLDivElement) {\n      div.style.background = this.cssLinearGradientFromCmap();\n      div.style.height = 'var(--height)';\n      div.style.flexGrow = '1';\n      div.style.flexShrink = '1';\n      \n    },\n    \n    styleUpTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderBottom = `${height}px solid ${color}`;\n    },\n    \n    styleDownTriangle(div: HTMLDivElement) {\n      const width = div.offsetWidth;\n      let height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      height = Math.min(Math.max(height, 15), 0.86 * width);\n      div.style.backgroundColor = 'transparent';\n      div.style.borderLeft = `${width/2}px solid transparent`;\n      div.style.borderRight = `${width/2}px solid transparent`;\n      div.style.borderTop = `${height}px solid ${color}`;\n      div.style.flexShrink = '0';\n      div.style.flexGrow = '1';\n    },\n    \n    styleLeftTriangle(div: HTMLDivElement) {\n      div.style.width=\"var(--height)\";\n      div.style.height=\"var(--height)\";\n      const height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      div.style.backgroundColor = 'transparent';\n      \n      div.style.borderTop = `${height/2}px solid transparent`;\n      div.style.borderBottom = `${height/2}px solid transparent`;\n      div.style.borderRight = `${height}px solid ${color}`;\n    },\n    \n    styleRightTriangle(div: HTMLDivElement) {\n      div.style.width=\"var(--height)\";\n      div.style.height=\"var(--height)\";\n      const height = div.offsetHeight;\n      const color = div.style.backgroundColor;\n      div.style.backgroundColor = 'transparent';\n      \n      div.style.borderTop = `${height/2}px solid transparent`;\n      div.style.borderBottom = `${height/2}px solid transparent`;\n      div.style.borderLeft = `${height}px solid ${color}`;\n    }\n  },\n  \n  watch: {\n    nsteps() {\n      this.colorbarGradient();\n    },\n    cmap() {\n      this.colorbarGradient();\n    },\n    cmapName() {\n      this.colorbarGradient();\n    }\n  }\n  \n});\n</script>\n\n<style scoped>\n/*\n* Prefixed by https://autoprefixer.github.io\n* PostCSS: v8.4.14,\n* Autoprefixer: v10.4.7\n* Browsers: last 5 version\n*/\n\n.colorbar-container-horizontal {\n  position: relative;\n  display: block;\n  width: 100%;\n  font-size: var(--font-size);\n}\n.colorbar {\n  width: 100%;\n  height: var(--height);\n  background: var(--background-color);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -webkit-filter: drop-shadow(0 0 0.1rem white);\n          filter: drop-shadow(0 0 0.1rem white);\n}\n\n\n.colorbar-labels {\n  \n  width: 100%;\n  height: -webkit-max-content;\n  height: -moz-max-content;\n  height: max-content;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n</style>\n","import { render } from \"./ColorBarHorizontal.vue?vue&type=template&id=ab9bae7e&scoped=true&ts=true\"\nimport script from \"./ColorBarHorizontal.vue?vue&type=script&lang=ts\"\nexport * from \"./ColorBarHorizontal.vue?vue&type=script&lang=ts\"\n\nimport \"./ColorBarHorizontal.vue?vue&type=style&index=0&id=ab9bae7e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ab9bae7e\"]])\n\nexport default __exports__","import { normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, renderSlot as _renderSlot, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, mergeProps as _mergeProps, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"info-button-close-icon\" }\nconst _hoisted_2 = { class: \"v-card-info-text ma-3\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_v_dialog, {\n    modelValue: _ctx.dialogVisible,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.dialogVisible) = $event)),\n    \"max-width\": \"500\"\n  }, {\n    activator: _withCtx(({ props: activatorProps }) => [\n      _createVNode(_component_v_tooltip, {\n        text: _ctx.tooltipTextValue,\n        disabled: !_ctx.showTooltip\n      }, {\n        activator: _withCtx(( { props} ) => [\n          _renderSlot(_ctx.$slots, \"activator\", _normalizeProps(_guardReactiveProps({...activatorProps, ...props, show: _ctx.dialogVisible})), () => [\n            _createVNode(_component_v_icon, _mergeProps({...activatorProps, ...props}, {\n              class: \"info-button-icon\",\n              elevation: \"1\",\n              onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.dialogVisible = true)),\n              onKeydown: _ctx.handleKeydown\n            }), {\n              default: _withCtx(() => [...(_cache[3] || (_cache[3] = [\n                _createTextVNode(\" mdi-information-variant-circle-outline \", -1)\n              ]))]),\n              _: 1\n            }, 16, [\"onKeydown\"])\n          ], true)\n        ]),\n        _: 2\n      }, 1032, [\"text\", \"disabled\"])\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_component_v_card, { class: \"gradient-background\" }, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_v_icon, {\n              class: \"info-button-close-icon__icon\",\n              onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.dialogVisible = false)),\n              onKeydown: _ctx.handleKeydown\n            }, {\n              default: _withCtx(() => [...(_cache[4] || (_cache[4] = [\n                _createTextVNode(\" mdi-close \", -1)\n              ]))]),\n              _: 1\n            }, 8, [\"onKeydown\"])\n          ]),\n          _createElementVNode(\"div\", _hoisted_2, [\n            _renderSlot(_ctx.$slots, \"default\", {}, () => [\n              _createTextVNode(_toDisplayString(_ctx.helpText), 1)\n            ], true)\n          ])\n        ]),\n        _: 3\n      })\n    ]),\n    _: 3\n  }, 8, [\"modelValue\"]))\n}","<template>\n  <v-dialog v-model=\"dialogVisible\" max-width=\"500\">\n    <template v-slot:activator=\"{ props: activatorProps }\">\n      <v-tooltip :text=\"tooltipTextValue\" :disabled=\"!showTooltip\">\n        <template v-slot:activator=\" { props} \">\n        <slot name=\"activator\" v-bind=\"{...activatorProps, ...props, show: dialogVisible}\">\n          <v-icon \n            v-bind=\"{...activatorProps, ...props}\" \n            class=\"info-button-icon\"\n            elevation=\"1\"\n            @click=\"dialogVisible = true\"\n            @keydown=\"handleKeydown\"\n          >\n            mdi-information-variant-circle-outline\n          </v-icon>\n        </slot>\n        </template>\n      </v-tooltip>\n    </template>\n    <v-card class=\"gradient-background\">\n      <div class=\"info-button-close-icon\">\n        <v-icon \n          class=\"info-button-close-icon__icon\"\n          @click=\"dialogVisible = false\"\n          @keydown=\"handleKeydown\"\n        >\n          mdi-close\n        </v-icon>\n      </div>\n      <div class=\"v-card-info-text ma-3\">\n        <slot>{{ helpText }}</slot>\n      </div>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  name: 'InfoButton',\n  props: {\n    helpText: {\n      type: String,\n      required: false\n    },\n    showTooltip: {\n      type: Boolean,\n      required: false,\n      default: true\n    },\n    tooltipText: {\n      type: String,\n      required: false,\n      default: undefined\n    }\n  },\n  \n\n  \n  data() {\n    return {\n      dialogVisible: false,\n      tooltipTextValue: this.tooltipText ?? (this.showTooltip ? 'Learn More' : undefined),\n    };\n  },\n\n  methods: {\n    handleKeydown(event: KeyboardEvent) {\n      if (event.key === 'Enter') {\n        this.dialogVisible = !this.dialogVisible;\n      }\n    },\n  },\n});\n</script>\n\n<style scoped>\n.v-card-info-text {\n  font-size: 1em;\n  line-height: 1.5em;\n  padding-block: 1em;\n  padding-inline: 1.5em;\n  \n  p {\n    margin-block: 0.5em;\n  }\n\n}\n\n.v-card-info-text > p {\n  margin-bottom: 1em;\n}\n\n.info-button-close-icon {\n  position: fixed;\n  right: 0.5em;\n  height: 1em;\n}\n\n.info-button-close-icon__icon {\n  /* position:absolute !important;\n  right:0 !important; */\n  float:right;\n  right: 1em;\n  top: 1em;\n\n  cursor:pointer;\n  \n  padding:1em !important;\n  margin:-1em !important;\n}\n\n.info-button-close-icon__icon:hover {\n  background-color: #f0f0f0;\n  color: black;\n  border-radius: 50%;\n  padding: 0.5em;\n  margin: -0.5em;\n  transition: background-color 0.3s;\n}\n\n.info-button-icon {\n  font-size: 1.3em; \n  color: var(--accent-color);\n}\n\n</style>","import { render } from \"./InfoButton.vue?vue&type=template&id=5ddd5ee1&scoped=true&ts=true\"\nimport script from \"./InfoButton.vue?vue&type=script&lang=ts\"\nexport * from \"./InfoButton.vue?vue&type=script&lang=ts\"\n\nimport \"./InfoButton.vue?vue&type=style&index=0&id=5ddd5ee1&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5ddd5ee1\"]])\n\nexport default __exports__","import { aliases, mdi } from 'vuetify/iconsets/mdi';\nimport { createVuetify } from 'vuetify';\n\n// For test use. Do not include createVuetify()\n// see https://next.vuetifyjs.com/en/features/treeshaking/\n//import * as components from 'vuetify/components';\n//import * as directives from 'vuetify/directives';\n\n// Translations provided by Vuetify\nimport { en } from 'vuetify/locale';\n\n// Styles\nimport 'vuetify/styles';\nimport '@mdi/font/css/materialdesignicons.css';\n\nexport default createVuetify({\n  // Icon Fonts\n  icons: {\n    defaultSet: 'mdi',\n    aliases,\n    sets: {\n      mdi,\n    },\n  },\n  locale: {\n    locale: 'en',\n    fallback: 'en',\n    messages: { en },\n  },\n  theme: {\n    defaultTheme: 'dark',\n  },\n});\n\n// Export for test.\n//export { components, directives };\n","import { renderSlot as _renderSlot, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createCommentVNode as _createCommentVNode, withKeys as _withKeys, createElementVNode as _createElementVNode, mergeProps as _mergeProps, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"cds-snackbar-alert ma-2\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_snackbar = _resolveComponent(\"v-snackbar\")!\n\n  return (!_ctx.hide)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        (!_ctx.hideButton)\n          ? _renderSlot(_ctx.$slots, \"activator\", {\n              key: 0,\n              onClick: _ctx.openDialog,\n              id: \"snackbar-activator-slot\"\n            }, () => [\n              _createVNode(_component_v_btn, {\n                onClick: _ctx.openDialog,\n                color: \"#333\",\n                id: \"snackbar-activator\",\n                size: \"small\"\n              }, {\n                prepend: _withCtx(() => [\n                  _createVNode(_component_v_icon, {\n                    color: \"red\",\n                    icon: \"mdi-alert-octagram\"\n                  })\n                ]),\n                default: _withCtx(() => [\n                  _createTextVNode(\" \" + _toDisplayString(_ctx.label), 1)\n                ]),\n                _: 1\n              }, 8, [\"onClick\"])\n            ])\n          : _createCommentVNode(\"\", true),\n        _createVNode(_component_v_snackbar, _mergeProps({\n          modelValue: _ctx.snackbar,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.snackbar) = $event)),\n          location: \"top center\"\n        }, _ctx.$attrs, {\n          \"close-on-back\": \"\",\n          role: \"alert\",\n          \"aria-live\": \"assertive\",\n          timeout: \"-1\"\n        }), {\n          actions: _withCtx(() => [\n            _createVNode(_component_v_btn, {\n              tabindex: \"0\",\n              color: \"red\",\n              variant: \"text\",\n              onClick: _ctx.closeDialog\n            }, {\n              default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n                _createTextVNode(\" Close \", -1)\n              ]))]),\n              _: 1\n            }, 8, [\"onClick\"])\n          ]),\n          default: _withCtx(() => [\n            _createElementVNode(\"span\", {\n              ref: \"snackbarMessage\",\n              tabindex: \"0\",\n              onKeydown: _cache[0] || (_cache[0] = _withKeys(\n//@ts-ignore\n(...args) => (_ctx.closeDialog && _ctx.closeDialog(...args)), [\"esc\"]))\n            }, [\n              _renderSlot(_ctx.$slots, \"default\", {}, () => [\n                _createTextVNode(_toDisplayString(_ctx.msg), 1)\n              ])\n            ], 544)\n          ]),\n          _: 3\n        }, 16, [\"modelValue\"])\n      ]))\n    : _createCommentVNode(\"\", true)\n}","<script lang=\"ts\">\n/**\n * v-snackbar wrapper component. The message can be passed\n * as a prop or as as the default slot. Props are passed\n * through to v-snackbar.\n * \n * Example Usage\n * \n * <SnackbarAlert msg=\"Hello there\" />\n * \n * <SnackbarAlert msg=\"Hello there\">\n *  <template v-slot:activator=\"{ onClick, id }\">\n *   <v-btn :id=\"id\" @click=\"onClick\" color=\"primary\">\n *    Custom Activator\n *   </v-btn>\n *  </template>\n * </SnackbarAlert>\n * \n */\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  name: \"SnackbarAlert\",\n  \n  emits: ['update:modelValue'],\n\n  props: {\n    msg: {\n      type: String || undefined || null,\n      required: false,\n      default: undefined,\n    },\n    hide: {\n      type: Boolean,\n      required: false,\n      default: false\n    },\n    label: {\n      type: String,\n      required: false,\n      default: \"Recent changes\"\n    },\n    modelValue: {\n      type: Boolean,\n      required: false,\n      default: false\n    },\n    hideButton: {\n      type: Boolean,\n      required: false,\n      default: false\n    }\n  },\n\n  data() {\n    return {\n      snackbar: false,\n    };\n  },\n  \n  methods: {\n    openDialog() {\n      if (this.snackbar) return;\n      \n      this.snackbar = true;\n      this.$emit('update:modelValue', true);\n      this.$nextTick(() => {\n        (this.$refs.snackbarMessage as HTMLElement).focus();\n      });\n    },\n    closeDialog() {\n      this.snackbar = false;\n      this.$emit('update:modelValue', false);\n      // make sure the focus goes back to the right place\n      this.$nextTick(() => {\n        this.$el.querySelector('#snackbar-activator')?.focus();\n        this.$el.querySelector('#snackbar-activator-slot')?.focus();\n      });\n    },\n  },\n  \n  watch: {\n    modelValue(val: boolean) {\n      if (val) {\n        this.openDialog();\n      } else {\n        this.closeDialog();\n      }\n    }\n  }\n\n\n});\n</script>\n\n<template>\n  <div class=\"cds-snackbar-alert ma-2\" v-if=\"!hide\">\n    \n    <slot v-if=\"!hideButton\" name=\"activator\" :onClick=\"openDialog\" id=\"snackbar-activator-slot\">\n      <v-btn @click=\"openDialog\" color=\"#333\" id=\"snackbar-activator\" size=\"small\">\n        <template v-slot:prepend>\n          <v-icon color=\"red\" icon=\"mdi-alert-octagram\"></v-icon>\n        </template>\n        {{ label }}\n      </v-btn>\n    </slot>\n    \n    <v-snackbar \n      v-model=\"snackbar\" \n      location=\"top center\" \n      v-bind=\"$attrs\"\n      close-on-back\n      role=\"alert\"\n      aria-live=\"assertive\"\n      timeout=\"-1\"\n      >\n      <span ref=\"snackbarMessage\" tabindex=\"0\" @keydown.esc=\"closeDialog\">\n      <slot> {{ msg }} </slot>\n      </span>\n\n\n      <template v-slot:actions>\n        <v-btn tabindex=\"0\" color=\"red\" variant=\"text\" @click=\"closeDialog\">\n          Close\n        </v-btn>\n      </template>\n    </v-snackbar>\n  </div>\n</template>\n","import { render } from \"./SnackbarAlert.vue?vue&type=template&id=034a6a3c&ts=true\"\nimport script from \"./SnackbarAlert.vue?vue&type=script&lang=ts\"\nexport * from \"./SnackbarAlert.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys, mergeProps as _mergeProps } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_snackbar = _resolveComponent(\"v-snackbar\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_use_clipboard = _resolveComponent(\"use-clipboard\")!\n\n  return (_openBlock(), _createBlock(_component_use_clipboard, { source: _ctx.source }, {\n    default: _withCtx(({ copy }) => [\n      (_ctx.tooltipDisabled || _ctx.alert)\n        ? (_openBlock(), _createBlock(_component_v_snackbar, {\n            key: 0,\n            class: \"share-button-snackbar\",\n            timeout: \"3500\",\n            location: \"top\",\n            activator: \"#share-button\",\n            text: \"Share link copied to clipboard. Paste to share this view!\",\n            color: \"success\",\n            variant: \"flat\",\n            \"min-height\": \"0px\",\n            \"min-width\": \"0px\",\n            transition: \"slide-y-transition\",\n            \"close-on-content-click\": \"\"\n          }))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_v_tooltip, {\n        disabled: _ctx.tooltipDisabled,\n        text: \"Share selected view\"\n      }, {\n        activator: _withCtx(({ props }) => [\n          _createVNode(_component_v_btn, _mergeProps({\n            id: \"share-button\",\n            \"aria-label\": \"Get link to share selected view\",\n            class: \"share-button\",\n            icon: \"\",\n            onClick: () => {\n            copy(_ctx.source);\n            _ctx.$emit('share');\n          }\n          ,\n            onKeyup: _withKeys(() => {\n            copy(_ctx.source);\n            _ctx.$emit('share');\n          }, [\"enter\"])\n          }, props, {\n            color: _ctx.buttonColor,\n            elevation: _ctx.elevation,\n            size: _ctx.size,\n            rounded: _ctx.rounded\n          }), {\n            default: _withCtx(() => [\n              _createVNode(_component_v_icon, { color: _ctx.iconColor }, {\n                default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n                  _createTextVNode(\"mdi-share-variant\", -1)\n                ]))]),\n                _: 1\n              }, 8, [\"color\"])\n            ]),\n            _: 1\n          }, 16, [\"onClick\", \"onKeyup\", \"color\", \"elevation\", \"size\", \"rounded\"])\n        ]),\n        _: 2\n      }, 1032, [\"disabled\"])\n    ]),\n    _: 1\n  }, 8, [\"source\"]))\n}","\n<template>\n  <use-clipboard v-slot=\"{ copy }\" :source=\"source\">\n    <v-snackbar \n      v-if=\"tooltipDisabled || alert\"\n      class=\"share-button-snackbar\"   \n      timeout=\"3500\" \n      location=\"top\" \n      activator=\"#share-button\"\n      text=\"Share link copied to clipboard. Paste to share this view!\"\n      color=\"success\"\n      variant=\"flat\"\n      min-height=\"0px\"\n      min-width=\"0px\"\n      transition=\"slide-y-transition\"\n      close-on-content-click\n      >\n    </v-snackbar>\n    <v-tooltip :disabled=\"tooltipDisabled\" text=\"Share selected view\">\n      <template v-slot:activator=\"{ props }\">\n        <v-btn\n          id=\"share-button\"\n          aria-label=\"Get link to share selected view\"\n          class=\"share-button\"\n          icon\n          @click=\"() => {\n            copy(source);\n            $emit('share');\n          }\n          \"\n          @keyup.enter=\"() => {\n            copy(source);\n            $emit('share');\n          }\"\n          v-bind=\"props\"\n          :color=\"buttonColor\"\n          :elevation=\"elevation\"\n          :size=\"size\"\n          :rounded=\"rounded\"\n        > \n          <v-icon :color=\"iconColor\">mdi-share-variant</v-icon>\n        </v-btn>\n      </template>\n    </v-tooltip>\n  </use-clipboard>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    source: {\n      type: String,\n      required: true,\n    },\n    buttonColor: {\n      type: String,\n      default: \"#ffffff66\",\n    },\n    iconColor: {\n      type: String,\n      default: \"#333\",\n    },\n    elevation: {\n      type: [String, Number],\n      default: \"0\",\n    },\n    size: {\n      type: String,\n      default: \"small\",\n    },\n    rounded: {\n      type: [String, Number],\n      default: \"1\",\n    },\n    tooltipDisabled: {\n      type: Boolean,\n      default: false,\n    },\n    alert: {\n      type: Boolean,\n      default: false,\n    },\n    \n  },\n  \n  data() {\n    return {\n      snackbar: false,\n    };\n  },\n\n  emits: [\"share\"],\n});\n</script>\n\n<style>\n.share-button {\n  z-index: 1000;\n  padding-inline: 5px;\n  border-radius: 8px !important;\n  border: thin solid var(--accent-color-2) !important;\n}\n\n.share-button-snackbar .v-snackbar__wrapper > .v-snackbar__content {\n  padding: 0.75em 1em;\n}\n\n</style>\n","import { render } from \"./ShareButton.vue?vue&type=template&id=1a0de751&ts=true\"\nimport script from \"./ShareButton.vue?vue&type=script&lang=ts\"\nexport * from \"./ShareButton.vue?vue&type=script&lang=ts\"\n\nimport \"./ShareButton.vue?vue&type=style&index=0&id=1a0de751&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","export async function getElementRect(element: Element): Promise<DOMRectReadOnly> {\n  let rect: DOMRectReadOnly | null = null;\n  let resolveRectPromise: (value: DOMRectReadOnly | PromiseLike<DOMRectReadOnly>) => void;\n  const rectPromise = new Promise<DOMRectReadOnly>((resolve, _reject) => {\n    resolveRectPromise = resolve;\n  });\n  const observer = new IntersectionObserver(entries => {\n    rect = entries[0].boundingClientRect;\n    resolveRectPromise(rect);\n\n    observer.disconnect();\n  });\n  observer.observe(element);\n\n  return rectPromise;\n}\n\nexport function watchContainerSize(\n  element: HTMLElement,\n  containerSelector: string,\n  callback: (size: { width: number; height: number }) => void,\n): ResizeObserver | null {\n  const container = element.closest(containerSelector);\n  if (container) {\n    const resizeObserver = new ResizeObserver((entries) => {\n      const rect = entries[0].contentRect; // there should be only one entry when we observe a single element\n      callback({ width: rect.width, height: rect.height });\n  \n    });\n    resizeObserver.observe(container);\n    return resizeObserver;\n  }\n  return null;\n}\n","import { onBeforeUnmount, Ref, watch } from \"vue\";\nimport { getElementRect } from \"../utils/dom\";\n\nimport { DragInfo } from \"../types\";\n\nexport interface UseDraggableDialogOptions {\n  root: Ref<HTMLElement | null>;\n  dragPredicate?: (element: HTMLElement) => boolean;\n  dialogSelector?: string;\n  scrimSelector?: string;\n}\n\nexport function useDraggableDialog(options: UseDraggableDialogOptions) {\n\n  const root = options.root;\n  const dialogSelector = options.dialogSelector ?? \".v-dialog.v-overlay--active\";\n  const scrimSelector = options.scrimSelector ?? \".v-overlay__scrim\";\n\n  let dragInfo: DragInfo | null = null;\n  type MouseEventHandler = (event: MouseEvent) => void;\n  let mousedown: MouseEventHandler | null = null;\n  let mouseup: MouseEventHandler | null = null;\n  let mousemove: MouseEventHandler | null = null;\n  let leftOffset = 0;\n\n  function removeListeners(element: HTMLElement) {\n    if (mousedown) {\n      element.removeEventListener(\"mousedown\", mousedown);\n    }\n    if (mouseup) {\n      element.removeEventListener(\"mouseup\", mouseup);\n    }\n    if (mousemove) {\n      element.removeEventListener(\"mousemove\", mousemove);\n    }\n  }\n\n  function setupDraggable(element: HTMLElement) {\n    removeListeners(element);\n\n    let dragging = false;\n\n    mousedown = async (event: MouseEvent) => {\n      if (options.dragPredicate && !options.dragPredicate(event.target as HTMLElement)) {\n        element.style.cursor = \"\";\n        dragging = false;\n        return;\n      }\n      dragging = true;\n\n      element.style.cursor = \"grabbing\";\n      const closestDialog = element.closest(dialogSelector);\n      if (event.button === 0 && closestDialog != null) {\n        const boundingRect = await getElementRect(closestDialog);\n        const d: DragInfo = {\n          el: closestDialog as HTMLElement,\n          title: element,\n          mouseStartX: event.clientX,\n          mouseStartY: event.clientY,\n          elStartX: boundingRect.left,\n          elStartY: boundingRect.top,\n          overlays: document.querySelectorAll(scrimSelector),\n        };\n        if (dragInfo && dragInfo.el) {\n          d.oldTransition = dragInfo.el.style.transition;\n        }\n        if (d.el) {\n          const parent = d.el.parentElement;\n          d.el.style.margin = \"0\";\n          d.el.style.transition = \"none\";\n          if (d.el.style.position !== \"fixed\") {\n            d.el.style.position = \"fixed\";\n            const newLeft = Math.min(\n              Math.max(d.elStartX + event.clientX - d.mouseStartX, 0),\n              window.innerWidth - boundingRect.width\n            );\n            const newtop = Math.min(\n              Math.max(d.elStartY + event.clientY - d.mouseStartY , 0),\n              window.innerHeight - boundingRect.height\n            ) - 0.5 * window.innerHeight;\n            \n            // original element was relative positioned\n            // so we need to account for the parent. \n            if (parent) {\n              const parentRect = await getElementRect(parent);\n              leftOffset = parentRect.left;\n            }\n            \n            d.el.style.left = (newLeft - leftOffset) + \"px\";\n            d.el.style.top = newtop + \"px\";\n          }\n        }\n        d.title.classList.add(\"dragging\");\n        d.overlays.forEach(overlay => (overlay as HTMLElement).style.display = \"none\");\n        dragInfo = d;\n      }\n    };\n    element.addEventListener(\"mousedown\", mousedown);\n\n    mousemove = async (event: MouseEvent) => {\n      if (options.dragPredicate && !options.dragPredicate(event.target as HTMLElement)) {\n        element.style.cursor = \"\";\n        return;\n      }\n      element.style.cursor = dragging ? \"grabbing\" : \"grab\";\n      if (!dragging || dragInfo === null || dragInfo.el == null) {\n        return;\n      }\n      const boundingRect = await getElementRect(dragInfo.el);\n      dragInfo.el.style.left = Math.min(\n        Math.max(dragInfo.elStartX + event.clientX - dragInfo.mouseStartX, -leftOffset),\n        window.innerWidth - boundingRect.width - leftOffset\n      ) + \"px\";\n      dragInfo.el.style.top = Math.min(\n        Math.max(dragInfo.elStartY + event.clientY - dragInfo.mouseStartY , 0),\n        window.innerHeight - boundingRect.height\n      ) - 0.5 * window.innerHeight + \"px\";\n    };\n    document.addEventListener(\"mousemove\", mousemove);\n\n    mouseup = (event: MouseEvent) => {\n      if (options.dragPredicate && !options.dragPredicate(event.target as HTMLElement)) {\n        element.style.cursor = \"\";\n        dragging = false;\n        return;\n      }\n\n      dragging = false;\n\n      element.style.cursor = \"grab\";\n      if (dragInfo === null) {\n        return;\n      }\n      if (dragInfo.oldTransition && dragInfo.el) {\n        dragInfo.el.style.transition = dragInfo.oldTransition;\n      }\n      dragInfo.el = undefined;\n      dragInfo.title.classList.remove(\"dragging\");\n      dragInfo.overlays.forEach(overlay => (overlay as HTMLElement).style.display = '');\n    };\n    document.addEventListener(\"mouseup\", mouseup);\n    \n    // If the window changes size, the dialog may be partially/completely out of bounds\n    // We fix that here\n    const resizeObserver = new ResizeObserver(async (entries) => {\n      if (dragInfo === null) {\n        return;\n      }\n      for (const entry of entries) {\n        const dialogs = entry.target.querySelectorAll(dialogSelector);\n        for (const d of dialogs) {\n          const dialog = d as HTMLElement;\n          const boundingRect = await getElementRect(dialog);\n          const parent = dialog.parentElement;\n          if (parent) {\n            const parentRect = await getElementRect(parent);\n            leftOffset = parentRect.left;\n          }\n          const left = Math.min(boundingRect.left, window.innerWidth - boundingRect.width) - leftOffset;\n          dialog.style.top = Math.min(parseInt(dialog.style.top), window.innerHeight - boundingRect.height) + \"px\";\n          dialog.style.left = left + \"px\";\n        }\n      }\n    });\n    resizeObserver.observe(document.body);\n  }\n\n  if (root.value) {\n    setupDraggable(root.value);\n  }\n\n  watch(root, newRoot => {\n    if (newRoot !== null) {\n      setupDraggable(newRoot);\n    }\n  });\n\n  onBeforeUnmount(() => {\n    const element = root.value;\n    if (element) {\n      removeListeners(element);\n      element.style.cursor = \"\";\n    }\n  });\n\n}\n","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withKeys as _withKeys, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createVNode as _createVNode, unref as _unref, normalizeClass as _normalizeClass } from \"vue\"\n\nimport { computed, ref, onMounted, nextTick, watch, useAttrs, useTemplateRef } from \"vue\";\nimport { VCard } from \"vuetify/components\";\nimport { UseDraggableDialogOptions, useDraggableDialog } from \"../composables/useDraggableDialog\";\n\ninterface CDSDialogProps {\n  title: string;\n  color?: string;\n  titleColor?: string;\n  shortTitle?: string;\n  draggable?: boolean;\n  button?: boolean;\n  scrim?: boolean;\n  persistent?: boolean;\n  modal?: boolean;\n  maxHeight?: string;\n  maxWidth?: string;\n  width?: string;\n  height?: string;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'CDSDialog',\n  props: /*@__PURE__*/_mergeModels({\n    title: {},\n    color: { default: \"red\" },\n    titleColor: { default: \"primary\" },\n    shortTitle: { default: \"\" },\n    draggable: { type: Boolean, default: false },\n    button: { type: Boolean, default: false },\n    scrim: { type: Boolean, default: true },\n    persistent: { type: Boolean, default: false },\n    modal: { type: Boolean, default: true },\n    maxHeight: {},\n    maxWidth: {},\n    width: {},\n    height: {}\n  }, {\n    \"modelValue\": { type: Boolean },\n    \"modelModifiers\": {},\n  }),\n  emits: [\"update:modelValue\"],\n  setup(__props: any) {\n\nconst modelValue = _useModel<boolean>(__props, \"modelValue\");\n\nconst props = __props;\n\n\nconst card = useTemplateRef<InstanceType<typeof VCard>>(\"card\");\nconst displayedShortTitle = computed(() => props.shortTitle || props.title);\nconst cardRoot = ref<HTMLElement | null>(null);\n\nconst attrs = useAttrs();\n\nif (props.draggable) {\n  const options: UseDraggableDialogOptions = {\n    root: cardRoot,\n    dialogSelector: \".cds-dialog-card\",\n  };\n  if (attrs[\"drag-predicate\"]) {\n    options.dragPredicate = attrs[\"drag-predicate\"] as (element: HTMLElement) => boolean;\n  }\n  useDraggableDialog(options);\n}\n\nfunction updateRoot() {\n  nextTick(() => {\n    if (card.value) {\n      cardRoot.value = card.value.$el;\n    }\n  });\n}\n\nfunction close(event: PointerEvent) {\n  modelValue.value = false;\n  event.stopPropagation();\n}\n\nonMounted(() => {\n  if (props.draggable && modelValue.value) {\n    updateRoot();\n  }\n});\n\n\nwatch(modelValue, value => {\n  if (value && props.draggable) {\n    updateRoot();\n  }\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_v_dialog, {\n    class: _normalizeClass(['cds-dialog', `${displayedShortTitle.value.toLowerCase().replace(/ /g, '-')}-cds-dialog`, !__props.modal ? 'nonmodal' : '']),\n    modelValue: modelValue.value,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((modelValue).value = $event)),\n    scrim: __props.scrim,\n    persistent: __props.persistent,\n    \"no-click-animation\": !__props.modal\n  }, {\n    activator: _withCtx(($attrs) => [\n      _renderSlot(_ctx.$slots, \"activator\", _normalizeProps(_guardReactiveProps($attrs)), () => [\n        (__props.button)\n          ? (_openBlock(), _createBlock(_component_v_btn, {\n              key: 0,\n              color: __props.color,\n              title: displayedShortTitle.value,\n              class: \"cds-dialog-button\",\n              onClick: _cache[0] || (_cache[0] = ($event: any) => (modelValue.value = true)),\n              onKeyup: _cache[1] || (_cache[1] = _withKeys(($event: any) => (modelValue.value = true), [\"enter\"])),\n              tabindex: \"0\"\n            }, {\n              default: _withCtx(() => [\n                _createTextVNode(\" Open \" + _toDisplayString(displayedShortTitle.value), 1)\n              ]),\n              _: 1\n            }, 8, [\"color\", \"title\"]))\n          : _createCommentVNode(\"\", true)\n      ])\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_unref(VCard), {\n        ref_key: \"card\",\n        ref: card,\n        class: \"cds-dialog-card\",\n        width: __props.width,\n        \"max-width\": __props.maxWidth,\n        height: __props.height,\n        \"max-height\": __props.maxHeight\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_toolbar, {\n            density: \"compact\",\n            color: __props.titleColor\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_toolbar_title, {\n                class: \"cds-dialog-v-toolbar-title\",\n                text: __props.title\n              }, null, 8, [\"text\"]),\n              _createVNode(_component_v_spacer),\n              _createVNode(_component_v_btn, {\n                class: \"cds-dialog-close-icon\",\n                icon: \"mdi-close\",\n                onClick: close,\n                \"onKeyup:enter\": close\n              })\n            ]),\n            _: 1\n          }, 8, [\"color\"]),\n          _createVNode(_component_v_card_text, { class: \"cds-dialog-v-card-text\" }, {\n            default: _withCtx(() => [\n              _renderSlot(_ctx.$slots, \"default\", {}, () => [\n                _cache[3] || (_cache[3] = _createTextVNode(\" Add content to the default slot \", -1))\n              ])\n            ]),\n            _: 3\n          })\n        ]),\n        _: 3\n      }, 8, [\"width\", \"max-width\", \"height\", \"max-height\"])\n    ]),\n    _: 3\n  }, 8, [\"class\", \"modelValue\", \"scrim\", \"persistent\", \"no-click-animation\"]))\n}\n}\n\n})","<template>\n  <v-dialog \n    :class=\"['cds-dialog', `${displayedShortTitle.toLowerCase().replace(/ /g, '-')}-cds-dialog`, !modal ? 'nonmodal' : '']\" \n    v-model=\"modelValue\" \n    :scrim=\"scrim\"\n    :persistent=\"persistent\"\n    :no-click-animation=\"!modal\"\n    >\n    <!-- add the activator slot, but only use it if the appropriate value is given for activator -->\n    <template v-slot:activator=\"$attrs\">\n      <slot name=\"activator\" v-bind=\"$attrs\">\n        <v-btn\n          v-if=\"button\"\n          :color=\"color\"\n          :title=\"displayedShortTitle\"\n          class=\"cds-dialog-button\"\n          @click=\"modelValue = true\"\n          @keyup.enter=\"modelValue = true\"\n          tabindex=\"0\"\n          >\n          Open {{ displayedShortTitle }}\n        </v-btn>\n      </slot>\n    </template>\n    \n    <v-card\n      ref=\"card\"\n      class=\"cds-dialog-card\"\n      :width=\"width\"\n      :max-width=\"maxWidth\"\n      :height=\"height\"\n      :max-height=\"maxHeight\"\n    >\n        <v-toolbar\n          density=\"compact\"\n          :color=\"titleColor\"\n        >\n          <v-toolbar-title class=\"cds-dialog-v-toolbar-title\" :text=\"title\"></v-toolbar-title>\n          <v-spacer></v-spacer>\n          <v-btn\n            class=\"cds-dialog-close-icon\"\n            icon=\"mdi-close\"\n            @click=\"close\"\n            @keyup:enter=\"close\"\n          >\n          </v-btn>\n        </v-toolbar>\n      \n      <v-card-text class=\"cds-dialog-v-card-text\" >\n        <slot>\n          Add content to the default slot\n        </slot>\n      </v-card-text>\n    </v-card>\n  </v-dialog>\n\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, onMounted, nextTick, watch, useAttrs, useTemplateRef } from \"vue\";\nimport { VCard } from \"vuetify/components\";\nimport { UseDraggableDialogOptions, useDraggableDialog } from \"../composables/useDraggableDialog\";\n\ninterface CDSDialogProps {\n  title: string;\n  color?: string;\n  titleColor?: string;\n  shortTitle?: string;\n  draggable?: boolean;\n  button?: boolean;\n  scrim?: boolean;\n  persistent?: boolean;\n  modal?: boolean;\n  maxHeight?: string;\n  maxWidth?: string;\n  width?: string;\n  height?: string;\n}\n\nconst modelValue = defineModel<boolean>();\n\nconst props = withDefaults(defineProps<CDSDialogProps>(), {\n  color: \"red\",\n  shortTitle: \"\",\n  draggable: false,\n  button: false,\n  titleColor: \"primary\",\n  scrim: true,\n  persistent: false,\n  modal: true,\n});\n\n\nconst card = useTemplateRef<InstanceType<typeof VCard>>(\"card\");\nconst displayedShortTitle = computed(() => props.shortTitle || props.title);\nconst cardRoot = ref<HTMLElement | null>(null);\n\nconst attrs = useAttrs();\n\nif (props.draggable) {\n  const options: UseDraggableDialogOptions = {\n    root: cardRoot,\n    dialogSelector: \".cds-dialog-card\",\n  };\n  if (attrs[\"drag-predicate\"]) {\n    options.dragPredicate = attrs[\"drag-predicate\"] as (element: HTMLElement) => boolean;\n  }\n  useDraggableDialog(options);\n}\n\nfunction updateRoot() {\n  nextTick(() => {\n    if (card.value) {\n      cardRoot.value = card.value.$el;\n    }\n  });\n}\n\nfunction close(event: PointerEvent) {\n  modelValue.value = false;\n  event.stopPropagation();\n}\n\nonMounted(() => {\n  if (props.draggable && modelValue.value) {\n    updateRoot();\n  }\n});\n\n\nwatch(modelValue, value => {\n  if (value && props.draggable) {\n    updateRoot();\n  }\n});\n\n</script>\n\n<style>\n\n.cds-dialog {\n  display: flex;\n  width: calc(100%);\n}\n.cds-dialog-card {\n  align-self: center;\n  outline: 1px solid rgb(var(--v-theme-surface-variant)); \n\n  .v-toolbar, .v-toolbar__content {\n    height: 40px !important;\n  }\n}\n\n.cds-dialog-close-icon {\n  cursor: pointer;\n}\n\n.v-dialog.cds-dialog > .v-overlay__content {\n  margin: unset;\n}\n\n.cds-dialog .v-card-text {\n  contain: layout;\n}\n.cds-dialog-v-card-text {\n\n}\n\n.v-toolbar-title.cds-dialog-v-toolbar-title > .v-toolbar-title__placeholder {\n  padding-bottom: 1px; /* needed for text with unicode subscript text */\n} \n\n.cds-dialog.nonmodal {\n\n  .v-overlay__content {\n    visibility: hidden;\n\n    .v-card {\n      visibility: visible;\n    }\n  }\n\n}\n</style>\n","import script from \"./CDSDialog.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CDSDialog.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CDSDialog.vue?vue&type=style&index=0&id=15bfd0d0&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { resolveComponent as _resolveComponent, createVNode as _createVNode, renderSlot as _renderSlot, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"cds-marquee-alert elevation-3 sucess\"\n}\nconst _hoisted_2 = { class: \"cds-marquee-alert__content\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_v_avatar = _resolveComponent(\"v-avatar\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_ctx.isVisible)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createVNode(_component_v_avatar, {\n          variant: \"flat\",\n          color: \"info\",\n          icon: \"mdi-exclamation-thick\"\n        }),\n        _createElementVNode(\"div\", _hoisted_2, [\n          _renderSlot(_ctx.$slots, \"default\", {}, () => [\n            _createElementVNode(\"span\", null, _toDisplayString(_ctx.message), 1)\n          ])\n        ]),\n        _createVNode(_component_v_btn, {\n          onClick: _ctx.close,\n          class: \"cds-marquee-alert__close-button\",\n          \"aria-label\": \"Close alert\",\n          variant: \"tonal\"\n        }, {\n          default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n            _createTextVNode(\" Close \", -1)\n          ]))]),\n          _: 1\n        }, 8, [\"onClick\"])\n      ]))\n    : _createCommentVNode(\"\", true)\n}","<style>\n.cds-marquee-alert\n{\n  position: sticky;\n  top: 0;\n  left: 0;\n  /* width: 100vw; */\n  padding-inline: 1rem;\n  padding-block: 5px;\n  margin-bottom: 1rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n  background-color: rgb(var(--v-theme-success));\n  color: white;\n  z-index: 9999;\n}\n\n.cds-marquee-alert__content\n{\n  line-height: 1.5;\n  flex-grow: 1;\n}\n\n.cds-marquee-alert__close-button\n{\n  padding: 5px;\n}\n</style>\n\n<template>\n  <div v-if=\"isVisible\" class=\"cds-marquee-alert elevation-3 sucess\">\n    <v-avatar variant=\"flat\" color=\"info\" icon=\"mdi-exclamation-thick\" />\n    <div class=\"cds-marquee-alert__content\">\n      <slot>\n        <span>{{ message }}</span>\n      </slot>\n    </div>\n    <v-btn @click=\"close\" class=\"cds-marquee-alert__close-button\" aria-label=\"Close alert\" variant=\"tonal\">\n      Close\n    </v-btn>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\n\nexport default defineComponent({\n  name: 'MarqueeAlert',\n\n  props: {\n    message: {\n      type: String,\n      default: 'hello'\n    },\n    modelValue: {\n      type: Boolean,\n      required: false,\n      default: true\n    },\n    timeout: {\n      type: Number,\n      default: 5000\n    }\n  },\n  \n  mounted() {\n    setTimeout(() => {\n      this.isVisible = false;\n    }, this.timeout);\n  },\n\n  data() {\n    return {\n      isVisible: true,\n    };\n  },\n\n  methods: {\n    close() {\n      this.isVisible = false;\n    }\n  },\n\n  watch: {\n    isVisible(value) {\n      this.$emit('update:modelValue', value);\n    },\n\n    modelValue(value) {\n      this.isVisible = value;\n    }\n  }\n\n\n});\n</script>\n","import { render } from \"./MarqeeAlert.vue?vue&type=template&id=185155c3&ts=true\"\nimport script from \"./MarqeeAlert.vue?vue&type=script&lang=ts\"\nexport * from \"./MarqeeAlert.vue?vue&type=script&lang=ts\"\n\nimport \"./MarqeeAlert.vue?vue&type=style&index=0&id=185155c3&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { onMounted, computed, ref, watch, nextTick } from \"vue\";\nimport { v4 } from \"uuid\";\nimport { PlotlyHTMLElement, newPlot, restyle, type Layout, type Config, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\n\nimport { AggValue, UserDataset } from \"../types\";\n\n\ninterface TimeseriesProps {\n  data: UserDataset[]; // composed selections\n  showErrors?: boolean;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'TimeseriesGraph',\n  props: {\n    data: {},\n    showErrors: { type: Boolean }\n  },\n  emits: [\"click\"],\n  setup(__props: any, { emit: __emit }) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst props = __props;\nconst sampleKeyCounts = computed(() => props.data.map(sel => Object.keys(sel.samples ?? {}).length));\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\n\nconst emit = __emit;\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst traceVisible = ref<Map<string, boolean>>(new Map());\n\nfunction renderPlot() {\n\n  errorTraces = [];\n  \n  const plotlyData: Data[] = [];\n  if (props.data.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  \n  if (props.data.map(sel => Object.keys(sel.samples ?? {}).length).every(len => len === 0)) {\n    console.log(\"No samples provided for timeseries graph\");\n    return;\n  }\n\n  let max = 0;\n  props.data.forEach(data => {\n    const samples = data.samples;\n    if (!samples) { return; }\n    // derive color from region if present\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n    const regionColor = (data as any).region?.color;\n    const ts = Object.keys(samples).sort();\n    const dataT: Date[] = [];\n    const dataV: (number | null)[] = [];\n    ts.forEach(t => {\n      const point: AggValue = samples[t];\n      if (point.value !== null) {\n        dataT.push(point.date);\n        dataV.push(point.value);\n      }\n    });\n    max = Math.max(max, Math.max(...dataV.filter((v): v is number => v !== null)));\n\n    const legendGroup = v4();\n    if (!traceVisible.value.has(data.id)) {\n      traceVisible.value.set(data.id, true);\n    }\n    legendGroups[data.id] = legendGroup;\n    plotlyData.push({\n      x: dataT,\n      y: dataV,\n      mode: \"lines+markers\",\n      legendgroup: legendGroup,\n      showlegend: true,\n      name: data.region.name,\n      marker: { color: regionColor },\n      visible: traceVisible.value.get(data.id) ? true : \"legendonly\",\n    });\n\n    const errors = data.errors;\n    if (errors != null) {\n      const upperY: (number | null)[] = [];\n      const lowerY: (number | null)[] = [];\n\n      ts.forEach(t => {\n        const point: AggValue = samples[t];\n        const value = point.value;\n        const errs = errors[t];\n        if (value === null || errs == null) {\n          // lowerY.push(null);\n          // upperY.push(null);\n          return;\n        }\n        const { lower, upper } = errs;\n        const valueLower = value - lower;\n        const valueHigher = value + upper;\n        const low = Math.min(valueLower, valueHigher);\n        const high = Math.max(valueLower, valueHigher);\n        max = Math.max(max, high);\n        lowerY.push(low);\n        upperY.push(high);\n      });\n\n      plotlyData.push({\n        x: dataT,\n        y: lowerY,\n        mode: \"lines\",\n        line: { width: 0 },\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n\n      plotlyData.push({\n        x: dataT,\n        y: upperY,\n        mode: \"lines\",\n        line: { width: 0 },\n        fill: \"tonexty\",\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const layout: Partial<Layout> = {\n    width: 600,\n    height: 400,\n    yaxis: {\n      title: { text: \"Molecules / cm<sup>2</sup>\" },\n      range: [0, axisMax],\n    }\n  };\n\n  const config: Partial<Config> = {\n    modeBarButtonsToRemove: ['autoScale2d', 'sendDataToCloud', 'lasso2d', 'select2d'],\n    displaylogo: false,\n  };\n\n  newPlot(graph.value ?? id, plotlyData, layout, config).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", { date, value: point.y as number });\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plotlyData[data.curveNumber];\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (!group) { \n        console.error(\"No legend group for trace\", trace);\n        return true; \n      }\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (!dataId) { \n        console.error(\"Could not find data ID for legend group\", group);\n        return true; \n      }\n      const currentlyVisible = traceVisible.value.get(dataId);\n      traceVisible.value.set(dataId, !currentlyVisible);\n      // if currently visible, and errors are visible, set style the error traces too\n      nextTick(() => { // next tick so that updated traceVisible is available\n        if (currentlyVisible && props.showErrors) {\n          updateErrorDisplay(true);\n        }\n      });\n      return true;\n    });\n  });\n}\n\nfunction updateErrorDisplay(visible: boolean) {\n  if (graph.value) {\n    errorTraces.forEach((traceIndex) => {\n      const trace = plot.value?.data[traceIndex];\n      if (!trace) return;\n      if (!graph.value) return;\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (dataId && traceVisible.value.get(dataId)) {\n        restyle(graph.value, { visible }, [traceIndex]);\n      } \n    });\n  }\n}\n\n\nonMounted(() => {\n  renderPlot();\n});\n\n\nwatch(() => props.showErrors, updateErrorDisplay);\n\nwatch(sampleKeyCounts, (newCounts: number[], oldCounts: number[]) => {\n  const different = (newCounts.length != oldCounts.length) && \n                    newCounts.some((value, index) => value !== oldCounts[index]);\n  if (!different) {\n    return;\n  }\n  if (newCounts.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  console.log(\"Data changed, re-rendering plot\");\n  renderPlot();\n});\n\nwatch(() => props.data, (newData, oldData) => {\n  console.log(\"Data prop changed, re-rendering plot\");\n  renderPlot();\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref_key: \"graph\",\n    ref: graph,\n    id: id,\n    class: \"timeseries\"\n  }, null, 512))\n}\n}\n\n})","<!-- eslint-disable @typescript-eslint/no-unused-vars -->\n<template>\n  <div\n    ref=\"graph\"\n    :id=\"id\"\n    class=\"timeseries\"\n  >\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { onMounted, computed, ref, watch, nextTick } from \"vue\";\nimport { v4 } from \"uuid\";\nimport { PlotlyHTMLElement, newPlot, restyle, type Layout, type Config, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\n\nimport { AggValue, UserDataset } from \"../types\";\n\n\ninterface TimeseriesProps {\n  data: UserDataset[]; // composed selections\n  showErrors?: boolean;\n}\n\nconst props = defineProps<TimeseriesProps>();\nconst sampleKeyCounts = computed(() => props.data.map(sel => Object.keys(sel.samples ?? {}).length));\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\n\nconst emit = defineEmits<{\n  (event: \"click\", value: AggValue): void;\n}>();\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst traceVisible = ref<Map<string, boolean>>(new Map());\n\nfunction renderPlot() {\n\n  errorTraces = [];\n  \n  const plotlyData: Data[] = [];\n  if (props.data.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  \n  if (props.data.map(sel => Object.keys(sel.samples ?? {}).length).every(len => len === 0)) {\n    console.log(\"No samples provided for timeseries graph\");\n    return;\n  }\n\n  let max = 0;\n  props.data.forEach(data => {\n    const samples = data.samples;\n    if (!samples) { return; }\n    // derive color from region if present\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n    const regionColor = (data as any).region?.color;\n    const ts = Object.keys(samples).sort();\n    const dataT: Date[] = [];\n    const dataV: (number | null)[] = [];\n    ts.forEach(t => {\n      const point: AggValue = samples[t];\n      if (point.value !== null) {\n        dataT.push(point.date);\n        dataV.push(point.value);\n      }\n    });\n    max = Math.max(max, Math.max(...dataV.filter((v): v is number => v !== null)));\n\n    const legendGroup = v4();\n    if (!traceVisible.value.has(data.id)) {\n      traceVisible.value.set(data.id, true);\n    }\n    legendGroups[data.id] = legendGroup;\n    plotlyData.push({\n      x: dataT,\n      y: dataV,\n      mode: \"lines+markers\",\n      legendgroup: legendGroup,\n      showlegend: true,\n      name: data.region.name,\n      marker: { color: regionColor },\n      visible: traceVisible.value.get(data.id) ? true : \"legendonly\",\n    });\n\n    const errors = data.errors;\n    if (errors != null) {\n      const upperY: (number | null)[] = [];\n      const lowerY: (number | null)[] = [];\n\n      ts.forEach(t => {\n        const point: AggValue = samples[t];\n        const value = point.value;\n        const errs = errors[t];\n        if (value === null || errs == null) {\n          // lowerY.push(null);\n          // upperY.push(null);\n          return;\n        }\n        const { lower, upper } = errs;\n        const valueLower = value - lower;\n        const valueHigher = value + upper;\n        const low = Math.min(valueLower, valueHigher);\n        const high = Math.max(valueLower, valueHigher);\n        max = Math.max(max, high);\n        lowerY.push(low);\n        upperY.push(high);\n      });\n\n      plotlyData.push({\n        x: dataT,\n        y: lowerY,\n        mode: \"lines\",\n        line: { width: 0 },\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n\n      plotlyData.push({\n        x: dataT,\n        y: upperY,\n        mode: \"lines\",\n        line: { width: 0 },\n        fill: \"tonexty\",\n        showlegend: false,\n        legendgroup: legendGroup,\n        name: data.region.name,\n        marker: { color: regionColor },\n        visible: props.showErrors && traceVisible.value.get(data.id),\n      });\n      errorTraces.push(plotlyData.length - 1);\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const layout: Partial<Layout> = {\n    width: 600,\n    height: 400,\n    yaxis: {\n      title: { text: \"Molecules / cm<sup>2</sup>\" },\n      range: [0, axisMax],\n    }\n  };\n\n  const config: Partial<Config> = {\n    modeBarButtonsToRemove: ['autoScale2d', 'sendDataToCloud', 'lasso2d', 'select2d'],\n    displaylogo: false,\n  };\n\n  newPlot(graph.value ?? id, plotlyData, layout, config).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", { date, value: point.y as number });\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plotlyData[data.curveNumber];\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      if (!group) { \n        console.error(\"No legend group for trace\", trace);\n        return true; \n      }\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (!dataId) { \n        console.error(\"Could not find data ID for legend group\", group);\n        return true; \n      }\n      const currentlyVisible = traceVisible.value.get(dataId);\n      traceVisible.value.set(dataId, !currentlyVisible);\n      // if currently visible, and errors are visible, set style the error traces too\n      nextTick(() => { // next tick so that updated traceVisible is available\n        if (currentlyVisible && props.showErrors) {\n          updateErrorDisplay(true);\n        }\n      });\n      return true;\n    });\n  });\n}\n\nfunction updateErrorDisplay(visible: boolean) {\n  if (graph.value) {\n    errorTraces.forEach((traceIndex) => {\n      const trace = plot.value?.data[traceIndex];\n      if (!trace) return;\n      if (!graph.value) return;\n      // eslint-disable-next-line \n      // @ts-ignore legend group should exist. but guard anyway\n      const group = trace.legendgroup as string;\n      const dataId = Object.keys(legendGroups).find(key => legendGroups[key] === group);\n      if (dataId && traceVisible.value.get(dataId)) {\n        restyle(graph.value, { visible }, [traceIndex]);\n      } \n    });\n  }\n}\n\n\nonMounted(() => {\n  renderPlot();\n});\n\n\nwatch(() => props.showErrors, updateErrorDisplay);\n\nwatch(sampleKeyCounts, (newCounts: number[], oldCounts: number[]) => {\n  const different = (newCounts.length != oldCounts.length) && \n                    newCounts.some((value, index) => value !== oldCounts[index]);\n  if (!different) {\n    return;\n  }\n  if (newCounts.length === 0) {\n    console.log(\"No data provided for timeseries graph\");\n    return;\n  }\n  console.log(\"Data changed, re-rendering plot\");\n  renderPlot();\n});\n\nwatch(() => props.data, (newData, oldData) => {\n  console.log(\"Data prop changed, re-rendering plot\");\n  renderPlot();\n});\n\n</script>\n\n<style scoped>\n.timeseries:not(:empty) {\n  width: 600px;\n  height: 400px;\n}\n</style>\n","import script from \"./TimeseriesGraph.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TimeseriesGraph.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TimeseriesGraph.vue?vue&type=style&index=0&id=1deaa98e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1deaa98e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, createElementVNode as _createElementVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"d-flex ga-2\" }\n\nimport { computed, ref, watch } from \"vue\";\nimport { v4 } from \"uuid\";\n\nimport type { MappingBackends, RectangleSelection, TimeRange, UserDataset } from \"../types\";\nimport type { MillisecondRange } from \"../types/datetime\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"../esri/utils\";\n\ninterface SelectionComposerProps {\n  backend: MappingBackends;\n  timeRanges: TimeRange[];\n  regions: RectangleSelectionType[];\n  disabled?: { region?: boolean; timeRange?: boolean; molecule?: boolean };\n}\n\ntype RectangleSelectionType = RectangleSelection;\n\ninterface DraftUserDataset {\n  region?: RectangleSelectionType | null;\n  timeRange?: TimeRange | null;\n  molecule?: MoleculeType | null;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'SelectionComposer',\n  props: {\n    backend: {},\n    timeRanges: {},\n    regions: {},\n    disabled: {}\n  },\n  emits: [\"create\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst selectedTimeRange = ref<TimeRange | null>(null);\n\nconst props = __props;\n\nconst emit = __emit;\n\nconst loading = ref(false);\n\nconst draftUserDataset = ref<DraftUserDataset>({ region: null, timeRange: null, molecule: null });\nconst availableMolecules = computed(() => MOLECULE_OPTIONS.map(o => ({ key: o.value as MoleculeType, title: o.title })));\n\n// Public composition progress\nconst creationProgress = computed(() => {\n  let count = 0;\n  if (draftUserDataset.value.region) count += 1;\n  if (draftUserDataset.value.timeRange) count += 1;\n  if (draftUserDataset.value.molecule) count += 1;\n  return { count, percent: (count / 3) * 100 };\n});\n\nfunction setDraftSelectionRegion(region: RectangleSelectionType | null) {\n  (draftUserDataset.value.region as RectangleSelectionType | null) = region || null;\n}\n\nfunction setDraftSelectionMolecule(molecule: MoleculeType | null) {\n  draftUserDataset.value.molecule = molecule || null;\n}\n\nfunction setDraftSelectionTimeRange(range: TimeRange | null) {\n  draftUserDataset.value.timeRange = range || null;\n}\n\nasync function composeSelection(): Promise<UserDataset | null> {\n  // const color = COLORS[selectionCount % COLORS.length]; // we will use the color from the region\n  \n  const draft = draftUserDataset.value;\n  if (!draft.region || !draft.timeRange || !draft.molecule) {\n    console.error('Draft selection incomplete');\n    return null;\n  }\n  \n  const sel: UserDataset = {\n    id: v4(),\n    region: draft.region, // as { id: string; name: string; rectangle: RectangleSelectionInfo; color: string; layer?: unknown },\n    timeRange: draft.timeRange,\n    molecule: draft.molecule as MoleculeType,\n  };\n  emit(\"create\", sel);\n  return sel;\n}\n\n\nfunction reset() {\n  draftUserDataset.value = { region: null, timeRange: null, molecule: null };\n  selectedTimeRange.value = null;\n}\n\nwatch(selectedTimeRange, (timeRange: TimeRange | null) => {\n  setDraftSelectionTimeRange(timeRange ?? null);\n});\n\n// just watch the id's. using a 'deep' watch caused a significant performance hit\nwatch(() => props.regions.map(r => r.id), (newRegions) => {\n  if (draftUserDataset.value.region) {\n    const exists = newRegions.find(rid => rid === draftUserDataset.value.region?.id);\n    if (!exists) {\n      draftUserDataset.value.region = null;\n    }\n  }\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_chip = _resolveComponent(\"v-chip\")!\n  const _component_v_card_title = _resolveComponent(\"v-card-title\")!\n  const _component_v_select = _resolveComponent(\"v-select\")!\n  const _component_v_list_item_title = _resolveComponent(\"v-list-item-title\")!\n  const _component_v_list_item_subtitle = _resolveComponent(\"v-list-item-subtitle\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_progress_linear = _resolveComponent(\"v-progress-linear\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, { id: \"selection-composer\" }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_card_title, { class: \"d-flex justify-space-between\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_chip, {\n            size: \"x-small\",\n            color: \"primary\",\n            variant: \"tonal\"\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(creationProgress.value.count) + \"/3\", 1)\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_v_card_text, { class: \"d-flex flex-column ga-3\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_select, {\n            items: __props.regions.map(r => ({ title: r.name, value: r })),\n            \"model-value\": draftUserDataset.value.region,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => (setDraftSelectionRegion($event as RectangleSelectionType))),\n            label: \"Region\",\n            disabled: __props.disabled?.region,\n            \"item-title\": \"title\",\n            \"item-value\": \"value\",\n            density: \"compact\",\n            \"hide-details\": \"\",\n            variant: \"outlined\",\n            \"bg-color\": \"background\"\n          }, null, 8, [\"items\", \"model-value\", \"disabled\"]),\n          _createVNode(_component_v_select, {\n            items: __props.timeRanges,\n            modelValue: selectedTimeRange.value,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((selectedTimeRange).value = $event)),\n            label: \"Time Range\",\n            disabled: __props.disabled?.timeRange,\n            density: \"compact\",\n            \"hide-details\": \"\",\n            variant: \"outlined\",\n            \"return-object\": \"\",\n            \"bg-color\": \"background\"\n          }, {\n            item: _withCtx(({ index, props }) => [\n              _createVNode(_component_v_list_item, _normalizeProps(_guardReactiveProps({ ...props, title: props.value.name })), {\n                title: _withCtx(() => [...(_cache[3] || (_cache[3] = []))]),\n                default: _withCtx(() => [\n                  _createVNode(_component_v_list_item_title, null, {\n                    default: _withCtx(() => [\n                      _createTextVNode(_toDisplayString(__props.timeRanges[index].name), 1)\n                    ]),\n                    _: 2\n                  }, 1024),\n                  (__props.timeRanges[index].name === 'Displayed Day')\n                    ? (_openBlock(), _createBlock(_component_v_list_item_subtitle, { key: 0 }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(new Date((__props.timeRanges[index].range as MillisecondRange).start).toDateString()), 1)\n                        ]),\n                        _: 2\n                      }, 1024))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                _: 2\n              }, 1040)\n            ]),\n            selection: _withCtx(() => [\n              _createTextVNode(_toDisplayString(selectedTimeRange.value?.name || 'Select Time Range'), 1)\n            ]),\n            _: 1\n          }, 8, [\"items\", \"modelValue\", \"disabled\"]),\n          _createVNode(_component_v_select, {\n            items: availableMolecules.value.map(m => ({ title: m.title, value: m.key })),\n            \"model-value\": draftUserDataset.value.molecule,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => (setDraftSelectionMolecule($event))),\n            label: \"Molecule\",\n            disabled: __props.disabled?.molecule,\n            \"item-title\": \"title\",\n            \"item-value\": \"value\",\n            density: \"compact\",\n            \"hide-details\": \"\",\n            variant: \"outlined\",\n            \"bg-color\": \"background\"\n          }, null, 8, [\"items\", \"model-value\", \"disabled\"]),\n          _createVNode(_component_v_progress_linear, {\n            \"model-value\": creationProgress.value.percent,\n            height: \"6\",\n            color: \"primary\",\n            rounded: \"\"\n          }, null, 8, [\"model-value\"]),\n          _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_v_btn, {\n              color: \"primary\",\n              disabled: creationProgress.value.count < 3,\n              onClick: composeSelection,\n              size: \"small\",\n              loading: loading.value\n            }, {\n              loader: _withCtx(() => [\n                _createVNode(_component_v_progress_linear, { indeterminate: \"\" })\n              ]),\n              default: _withCtx(() => [\n                _cache[4] || (_cache[4] = _createTextVNode(\" Access Data \", -1))\n              ]),\n              _: 1\n            }, 8, [\"disabled\", \"loading\"]),\n            _createVNode(_component_v_btn, {\n              color: \"secondary\",\n              variant: \"tonal\",\n              size: \"small\",\n              onClick: reset\n            }, {\n              default: _withCtx(() => [...(_cache[5] || (_cache[5] = [\n                _createTextVNode(\" Reset \", -1)\n              ]))]),\n              _: 1\n            })\n          ])\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n  <v-card id=\"selection-composer\">\n    <v-card-title class=\"d-flex justify-space-between\">\n      <v-chip size=\"x-small\" color=\"primary\" variant=\"tonal\">{{ creationProgress.count }}/3</v-chip>\n    </v-card-title>\n    <v-card-text class=\"d-flex flex-column ga-3\">\n      <!-- Region Picker -->\n      <v-select\n        :items=\"regions.map(r => ({ title: r.name, value: r }))\"\n        :model-value=\"draftUserDataset.region\"\n        @update:model-value=\"setDraftSelectionRegion($event as RectangleSelectionType)\"\n        label=\"Region\"\n        :disabled=\"disabled?.region\"\n        item-title=\"title\"\n        item-value=\"value\"\n        density=\"compact\"\n        hide-details\n        variant=\"outlined\"\n        bg-color=\"background\"\n      />\n\n\n      <!-- Time Range Picker: offer Effective (current day/custom) and any active custom ranges -->\n      <v-select\n        :items=\"timeRanges\"\n        v-model=\"selectedTimeRange\"\n        label=\"Time Range\"\n        :disabled=\"disabled?.timeRange\"\n        density=\"compact\"\n        hide-details\n        variant=\"outlined\"\n        return-object\n        bg-color=\"background\"\n      >\n        <template #item=\"{ index, props }\">\n          <v-list-item v-bind=\"{ ...props, title: props.value.name }\">\n            <template #title></template>\n            <template #default>\n              <v-list-item-title>{{ timeRanges[index].name }}</v-list-item-title>\n              <v-list-item-subtitle\n                v-if=\"timeRanges[index].name === 'Displayed Day'\"\n              >\n                {{ new Date((timeRanges[index].range as MillisecondRange).start).toDateString() }}\n              </v-list-item-subtitle>\n            </template>\n          </v-list-item>\n        </template>\n        <template #selection>\n          {{ selectedTimeRange?.name || 'Select Time Range' }}\n        </template>\n      </v-select>\n\n      <!-- Molecule Picker -->\n      <v-select\n        :items=\"availableMolecules.map(m => ({ title: m.title, value: m.key }))\"\n        :model-value=\"draftUserDataset.molecule\"\n        @update:model-value=\"setDraftSelectionMolecule($event)\"\n        label=\"Molecule\"\n        :disabled=\"disabled?.molecule\"\n        item-title=\"title\"\n        item-value=\"value\"\n        density=\"compact\"\n        hide-details\n        variant=\"outlined\"\n        bg-color=\"background\"\n      />\n\n      <v-progress-linear :model-value=\"creationProgress.percent\" height=\"6\" color=\"primary\" rounded></v-progress-linear>\n\n      <div class=\"d-flex ga-2\">\n        <v-btn\n          color=\"primary\"\n          :disabled=\"creationProgress.count < 3\"\n          @click=\"composeSelection\"\n          size=\"small\"\n          :loading=\"loading\"\n        >\n          <template #loader>\n            <v-progress-linear\n              indeterminate\n            ></v-progress-linear>\n          </template>\n          Access Data\n        </v-btn>\n        <v-btn\n          color=\"secondary\"\n          variant=\"tonal\"\n          size=\"small\"\n          @click=\"reset\"\n        >\n          Reset\n        </v-btn>\n      </div>\n    </v-card-text>\n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport { v4 } from \"uuid\";\n\nimport type { MappingBackends, RectangleSelection, TimeRange, UserDataset } from \"../types\";\nimport type { MillisecondRange } from \"../types/datetime\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"../esri/utils\";\n\nconst selectedTimeRange = ref<TimeRange | null>(null);\n\ninterface SelectionComposerProps {\n  backend: MappingBackends;\n  timeRanges: TimeRange[];\n  regions: RectangleSelectionType[];\n  disabled?: { region?: boolean; timeRange?: boolean; molecule?: boolean };\n}\n\nconst props = defineProps<SelectionComposerProps>();\n\nconst emit = defineEmits<{\n  (event: \"create\", selection: UserDataset): void;\n}>();\n\nconst loading = ref(false);\n\ntype RectangleSelectionType = RectangleSelection;\n\ninterface DraftUserDataset {\n  region?: RectangleSelectionType | null;\n  timeRange?: TimeRange | null;\n  molecule?: MoleculeType | null;\n}\nconst draftUserDataset = ref<DraftUserDataset>({ region: null, timeRange: null, molecule: null });\nconst availableMolecules = computed(() => MOLECULE_OPTIONS.map(o => ({ key: o.value as MoleculeType, title: o.title })));\n\n// Public composition progress\nconst creationProgress = computed(() => {\n  let count = 0;\n  if (draftUserDataset.value.region) count += 1;\n  if (draftUserDataset.value.timeRange) count += 1;\n  if (draftUserDataset.value.molecule) count += 1;\n  return { count, percent: (count / 3) * 100 };\n});\n\nfunction setDraftSelectionRegion(region: RectangleSelectionType | null) {\n  (draftUserDataset.value.region as RectangleSelectionType | null) = region || null;\n}\n\nfunction setDraftSelectionMolecule(molecule: MoleculeType | null) {\n  draftUserDataset.value.molecule = molecule || null;\n}\n\nfunction setDraftSelectionTimeRange(range: TimeRange | null) {\n  draftUserDataset.value.timeRange = range || null;\n}\n\nasync function composeSelection(): Promise<UserDataset | null> {\n  // const color = COLORS[selectionCount % COLORS.length]; // we will use the color from the region\n  \n  const draft = draftUserDataset.value;\n  if (!draft.region || !draft.timeRange || !draft.molecule) {\n    console.error('Draft selection incomplete');\n    return null;\n  }\n  \n  const sel: UserDataset = {\n    id: v4(),\n    region: draft.region, // as { id: string; name: string; rectangle: RectangleSelectionInfo; color: string; layer?: unknown },\n    timeRange: draft.timeRange,\n    molecule: draft.molecule as MoleculeType,\n  };\n  emit(\"create\", sel);\n  return sel;\n}\n\n\nfunction reset() {\n  draftUserDataset.value = { region: null, timeRange: null, molecule: null };\n  selectedTimeRange.value = null;\n}\n\nwatch(selectedTimeRange, (timeRange: TimeRange | null) => {\n  setDraftSelectionTimeRange(timeRange ?? null);\n});\n\n// just watch the id's. using a 'deep' watch caused a significant performance hit\nwatch(() => props.regions.map(r => r.id), (newRegions) => {\n  if (draftUserDataset.value.region) {\n    const exists = newRegions.find(rid => rid === draftUserDataset.value.region?.id);\n    if (!exists) {\n      draftUserDataset.value.region = null;\n    }\n  }\n});\n</script>\n\n<style>\n#selection-composer  .v-progress-linear {\n  width: 80%;\n}\n\n/* the lists are actually attached to the somewhere else in the DOM */\n.v-list[aria-label=\"Time Range-list\"] {\n  background-color: rgb(var(--v-theme-background)) !important;\n  /* color: rgb(var(--v-theme-on-surface-light)); */\n  /* border: 2px solid currentColor; */\n  border-top-width: 1px;\n}\n\n.v-list[aria-label=\"Molecule-list\"] {\n  background-color: rgb(var(--v-theme-background)) !important;\n  /* color: rgb(var(--v-theme-on-surface-light)); */\n  /* border: 1px solid currentColor; */\n}\n\n.v-list[aria-label=\"Region-list\"] {\n  background-color: rgb(var(--v-theme-background)) !important;\n  /* color: rgb(var(--v-theme-on-surface-light)); */\n  /* border: 1px solid currentColor; */\n}\n\n\n/* selectors */\n\n#selection-composer .v-select--active-menu .v-field.v-field--focused .v-field__outline {\n  /* border-bottom: none !important; */\n}\n\n#selection-composer .v-select--active-menu .v-field.v-field--focused .v-field__outline .v-field__outline__start {\n  border-bottom: none !important;\n}\n#selection-composer .v-select--active-menu .v-field.v-field--focused .v-field__outline .v-field__outline__end {\n  border-bottom: none !important;\n}\n#selection-composer  .v-select--active-menu .v-field.v-field--focused .v-field__outline .v-field__outline__notch::after {\n  border-color: transparent !important;\n}\n</style>\n","import script from \"./SelectionComposer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SelectionComposer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SelectionComposer.vue?vue&type=style&index=0&id=f21cfb88&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","export default [\n  {\n    date: \"2025-04-24\",\n    html: 'Educational resources designed for for informal educators (e.g., in museums, public outreach) are now available on the Cosmic Data Stories website at <a style=\"font-weight: normal;\" tabindex=\"0\"  href=\"https://www.cosmicds.cfa.harvard.edu/resources/tempo\" target=\"_blank\" rel=\"noopener\">Educator Resources</a>. You can also find the link the menu.',\n    highlight: new Date() < new Date('2025-05-7 00:00:00') ,\n    \n  },\n  {\n    date: \"2025-02-02\",\n    html:\n      'During the LA fires that began on Jan 7th, NO<sub>2</sub> levels far exceeded the default range displayed on our maps. For Jan 7 - Feb 2, 2025, we added an option to use an extended range of NO<sub>2</sub> values. For those dates, a button appears on the map to toggle between the standard and extended range.',\n      \n  },\n  {\n    date: \"2025-01-21\",\n    text:\n      \"Enable viewing the full resolution data. By default this is always off, displaying data at 1/2 the native Level 3 resolution for better performance\"\n  },\n  {\n    date: \"2025-01-09\",\n    text:\n      \"We have added a new sharable url feature! Click the share icon to copy a link for the current view (location, zoom level, date, and time) to your clipboard.\",\n  },\n  {\n    date: \"2024-11-29\",\n    text:\n      \"We are in the process of updating our data processing routines and images to use averaging rather than the nearest-neighbor pixel value when reprojecting. TEMPO images for dates after Nov 29th use the new pipeline, and past images will be updated over time\",\n  },\n];\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\"\nimport _imports_0 from '@/assets/TEMPO-Logo-Small.png'\n\n\nconst _hoisted_1 = { class: \"header\" }\nconst _hoisted_2 = { class: \"snackbar-alert-ul\" }\nconst _hoisted_3 = [\"data-date\"]\nconst _hoisted_4 = [\"innerHTML\"]\nconst _hoisted_5 = { id: \"menu-area\" }\nconst _hoisted_6 = {\n  style: {\"font-weight\":\"normal\"},\n  tabindex: \"0\",\n  href: \"https://www.cosmicds.cfa.harvard.edu/resources/tempo\",\n  target: \"_blank\",\n  rel: \"noopener\"\n}\n\nimport { computed, ref } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { useDisplay } from \"vuetify\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { useTempoStore } from \"@/stores/app\";\nimport changes from \"@/changes\";\n\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faArrowsRotate } from \"@fortawesome/free-solid-svg-icons\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'HeaderBar',\n  emits: [\"intro-slide\", \"layers\"],\n  setup(__props, { emit: __emit }) {\n\nlibrary.add(faArrowsRotate);\n\nconst emit = __emit;\n\nconst store = useTempoStore();\nconst {\n  accentColor2,\n} = storeToRefs(store);\n\nconst display = useDisplay();\n\nconst showChanges = ref(false);\nconst showAboutData = ref(false);\nconst showCredits = ref(false);\nconst showSaveDialog = ref(false);\nconst showErrorSnackbar = ref(false);\nconst ioErrorMessage = ref(\"\");\n\nconst touchscreen = supportsTouchscreen();\n\nconst smallSize = computed(() => {\n  return display.smAndDown.value;\n});\n\n\nconst mobile = computed(() => {\n  return smallSize.value && touchscreen;\n});\n\nfunction reportError(_error: string, message: string) {\n  showErrorSnackbar.value = true;\n  ioErrorMessage.value = message;\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_cds_dialog = _resolveComponent(\"cds-dialog\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_list = _resolveComponent(\"v-list\")!\n  const _component_v_menu = _resolveComponent(\"v-menu\")!\n  const _component_save_state = _resolveComponent(\"save-state\")!\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n  const _component_v_snackbar = _resolveComponent(\"v-snackbar\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _cache[31] || (_cache[31] = _createElementVNode(\"div\", { id: \"logo-title\" }, [\n      _createElementVNode(\"a\", {\n        href: \"https://tempo.si.edu\",\n        target: \"_blank\",\n        rel: \"noopener noreferrer\"\n      }, [\n        _createElementVNode(\"img\", {\n          src: _imports_0,\n          alt: \"TEMPO Logo\",\n          style: {\"width\":\"100px\",\"height\":\"100px\"}\n        })\n      ])\n    ], -1)),\n    _cache[32] || (_cache[32] = _createElementVNode(\"h1\", { id: \"title\" }, \"TEMPO Lab: Investigate Air Quality\", -1)),\n    _createVNode(_component_cds_dialog, {\n      title: \"What's new\",\n      modelValue: showChanges.value,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((showChanges).value = $event)),\n      color: _unref(accentColor2)\n    }, {\n      default: _withCtx(() => [\n        _createElementVNode(\"ul\", _hoisted_2, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(changes), (change) => {\n            return (_openBlock(), _createElementBlock(\"li\", {\n              class: \"change-item mb-5\",\n              key: change.date,\n              \"data-date\": change.date\n            }, [\n              _createElementVNode(\"span\", {\n                style: _normalizeStyle({\"font-weight\":\"bold\", \"color\": `${change.highlight ? \"var(--smithsonian-yellow)\" : \"currentColor\"}` })\n              }, _toDisplayString(change.date), 5),\n              _cache[19] || (_cache[19] = _createElementVNode(\"br\", null, null, -1)),\n              _cache[20] || (_cache[20] = _createTextVNode()),\n              _createElementVNode(\"span\", {\n                innerHTML: change.html\n              }, null, 8, _hoisted_4),\n              _createTextVNode(_toDisplayString(change.text), 1)\n            ], 8, _hoisted_3))\n          }), 128))\n        ])\n      ]),\n      _: 1\n    }, 8, [\"modelValue\", \"color\"]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      ((new Date('2025-05-7 00:00:00') > new Date()))\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 0,\n            class: \"whats-new-button pulse\",\n            \"aria-label\": \"What's new\",\n            onClick: _cache[1] || (_cache[1] = ($event: any) => (showChanges.value = true)),\n            onKeyup: _cache[2] || (_cache[2] = _withKeys(($event: any) => (showChanges.value = true), [\"enter\"])),\n            variant: \"outlined\",\n            rounded: \"lg\",\n            color: _unref(accentColor2),\n            elevation: \"0\",\n            size: \"lg\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_tooltip, {\n                location: \"bottom\",\n                activator: \"parent\",\n                disabled: mobile.value,\n                text: \"What's new\"\n              }, null, 8, [\"disabled\"]),\n              _createVNode(_component_v_icon, null, {\n                default: _withCtx(() => [...(_cache[21] || (_cache[21] = [\n                  _createTextVNode(\"mdi-creation\", -1)\n                ]))]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }, 8, [\"color\"]))\n        : _createCommentVNode(\"\", true),\n      _createVNode(_component_v_btn, {\n        onClick: _cache[3] || (_cache[3] = ($event: any) => (showSaveDialog.value = !showSaveDialog.value)),\n        class: \"save-button\",\n        \"aria-label\": \"Export current state\",\n        variant: \"outlined\",\n        rounded: \"lg\",\n        density: \"default\",\n        color: _unref(accentColor2),\n        elevation: \"0\",\n        size: \"lg\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_tooltip, {\n            location: \"bottom\",\n            activator: \"parent\",\n            disabled: mobile.value,\n            text: \"Export current state\"\n          }, null, 8, [\"disabled\"]),\n          _createVNode(_component_v_icon, null, {\n            default: _withCtx(() => [...(_cache[22] || (_cache[22] = [\n              _createTextVNode(\"mdi-file-arrow-up-down\", -1)\n            ]))]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"color\"]),\n      _createVNode(_component_v_btn, {\n        \"aria-role\": \"menu\",\n        \"aria-label\": \"Show menu\",\n        class: \"menu-button\",\n        variant: \"outlined\",\n        rounded: \"lg\",\n        color: _unref(accentColor2),\n        elevation: \"5\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_icon, { size: \"x-large\" }, {\n            default: _withCtx(() => [...(_cache[23] || (_cache[23] = [\n              _createTextVNode(\"mdi-menu\", -1)\n            ]))]),\n            _: 1\n          }),\n          _createVNode(_component_v_menu, { activator: \"parent\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_list, null, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"See recent changes\",\n                    onClick: _cache[4] || (_cache[4] = ($event: any) => (showChanges.value = true)),\n                    onKeyup: _cache[5] || (_cache[5] = _withKeys(($event: any) => (showChanges.value = true), [\"enter\"]))\n                  }, {\n                    default: _withCtx(() => [...(_cache[24] || (_cache[24] = [\n                      _createTextVNode(\" What's New \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show introduction\",\n                    onClick: _cache[6] || (_cache[6] = () => emit('intro-slide', 1)),\n                    onKeyup: _cache[7] || (_cache[7] = _withKeys(() => emit('intro-slide', 1), [\"enter\"])),\n                    disabled: \"\"\n                  }, {\n                    default: _withCtx(() => [...(_cache[25] || (_cache[25] = [\n                      _createTextVNode(\" Introduction \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show user guide\",\n                    onClick: _cache[8] || (_cache[8] = () => emit('intro-slide', 4)),\n                    onKeyup: _cache[9] || (_cache[9] = _withKeys(() => emit('intro-slide', 4), [\"enter\"])),\n                    disabled: \"\"\n                  }, {\n                    default: _withCtx(() => [...(_cache[26] || (_cache[26] = [\n                      _createTextVNode(\" User Guide \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show dialog telling about the data\",\n                    onClick: _cache[10] || (_cache[10] = ($event: any) => (showAboutData.value = true)),\n                    onKeyup: _cache[11] || (_cache[11] = _withKeys(($event: any) => (showAboutData.value = true), [\"enter\"])),\n                    disabled: \"\"\n                  }, {\n                    default: _withCtx(() => [...(_cache[27] || (_cache[27] = [\n                      _createTextVNode(\" About the Data \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, { \"aria-label\": \"Leave Page to Educator Resources\" }, {\n                    default: _withCtx(() => [\n                      _createElementVNode(\"a\", _hoisted_6, [\n                        _cache[29] || (_cache[29] = _createTextVNode(\"Educator Resources\", -1)),\n                        _createVNode(_component_v_icon, null, {\n                          default: _withCtx(() => [...(_cache[28] || (_cache[28] = [\n                            _createTextVNode(\"mdi-open-in-new\", -1)\n                          ]))]),\n                          _: 1\n                        })\n                      ])\n                    ]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_list_item, {\n                    tabindex: \"0\",\n                    \"aria-label\": \"Show credits\",\n                    onClick: _cache[12] || (_cache[12] = ($event: any) => (showCredits.value = true)),\n                    onKeyup: _cache[13] || (_cache[13] = _withKeys(($event: any) => (showCredits.value = true), [\"enter\"])),\n                    disabled: \"\"\n                  }, {\n                    default: _withCtx(() => [...(_cache[30] || (_cache[30] = [\n                      _createTextVNode(\" Credits \", -1)\n                    ]))]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"color\"]),\n      _createVNode(_component_v_dialog, {\n        modelValue: showSaveDialog.value,\n        \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event: any) => ((showSaveDialog).value = $event)),\n        width: \"300px\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_save_state, {\n            onLoadLocal: _cache[14] || (_cache[14] = ($event: any) => (showSaveDialog.value = false)),\n            onSaveLocal: _cache[15] || (_cache[15] = ($event: any) => (showSaveDialog.value = false)),\n            onError: _cache[16] || (_cache[16] = (type, message) => reportError(type, message))\n          })\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"]),\n      _createVNode(_component_v_snackbar, {\n        modelValue: showErrorSnackbar.value,\n        \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event: any) => ((showErrorSnackbar).value = $event)),\n        timeout: \"2000\",\n        color: \"error\"\n      }, {\n        default: _withCtx(() => [\n          _createTextVNode(_toDisplayString(ioErrorMessage.value), 1)\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"])\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"header\">\n    <!-- tempo logo -->\n    <div id=\"logo-title\">\n    <a href=\"https://tempo.si.edu\" target=\"_blank\" rel=\"noopener noreferrer\" >\n      <img \n        src=\"@/assets/TEMPO-Logo-Small.png\"\n        alt=\"TEMPO Logo\"\n        style=\"width: 100px; height: 100px;\"\n      >\n    </a>\n    </div>\n\n    <h1 id=\"title\">TEMPO Lab: Investigate Air Quality</h1>\n    <!-- <cds-dialog\n      title=\"Time Series\"\n      v-model=\"samplesGraph\"\n      :color=\"accentColor2\"\n      draggable\n      :scrim=\"false\"\n      :drag-predicate=\"(element: HTMLElement) => element.closest('.plotly') == null\"\n    >\n      <timeseries-graph\n        v-if=\"userSelections.length > 0\"\n        :data=\"userSelections\"\n      />\n    </cds-dialog> -->\n\n    <!-- </div> -->\n    <cds-dialog title=\"What's new\" v-model=\"showChanges\" :color=\"accentColor2\">\n      <ul class=\"snackbar-alert-ul\">\n        <li class=\"change-item mb-5\" v-for=\"change in changes\" :key=\"change.date\" :data-date=\"change.date\">\n          <span :style='{\"font-weight\":\"bold\", \"color\": `${change.highlight ? \"var(--smithsonian-yellow)\" : \"currentColor\"}` }'>{{ change.date }}</span><br> <span v-html=\"change.html\">  </span>{{ change.text }}\n        </li>\n      </ul>\n      <!-- <template v-slot:activator=\"{ onClick, id }\">\n        <v-btn :id=\"id\" @click=\"onClick\" color=\"primary\">\n          Custom Activator\n        </v-btn>\n      </template>  -->\n    </cds-dialog>\n\n    <div id=\"menu-area\">\n      <v-btn \n        v-if=\"(new Date('2025-05-7 00:00:00') > new Date())\"\n        class='whats-new-button pulse' \n        aria-label=\"What's new\" \n        @click=\"showChanges = true\" \n        @keyup.enter=\"showChanges = true\" \n        variant=\"outlined\" \n        rounded=\"lg\" \n        :color=\"accentColor2\" \n        elevation=\"0\"\n        size=\"lg\"\n        >\n        <v-tooltip location=\"bottom\" activator=\"parent\" :disabled=\"mobile\" text=\"What's new\"></v-tooltip>\n        <v-icon>mdi-creation</v-icon>\n      </v-btn>\n\n     <v-btn\n        @click=\"showSaveDialog = !showSaveDialog\"\n        class=\"save-button\"\n        aria-label=\"Export current state\"\n        variant=\"outlined\"\n        rounded=\"lg\"\n        density=\"default\"\n        :color=\"accentColor2\"\n        elevation=\"0\"\n        size=\"lg\"\n      >\n        <v-tooltip location=\"bottom\" activator=\"parent\" :disabled=\"mobile\" text=\"Export current state\"></v-tooltip>\n        <v-icon>mdi-file-arrow-up-down</v-icon>\n      </v-btn>\n\n      <v-btn aria-role=\"menu\" aria-label=\"Show menu\" class=\"menu-button\" variant=\"outlined\" rounded=\"lg\" :color=\"accentColor2\" elevation=\"5\">\n        <v-icon size=\"x-large\">mdi-menu</v-icon>\n        <v-menu\n          activator=\"parent\"\n          >\n          <v-list>\n            <v-list-item \n              tabindex=\"0\"\n              aria-label=\"See recent changes\"\n              @click=\"showChanges = true\"\n              @keyup.enter=\"showChanges = true\"\n              >\n              What's New\n            </v-list-item>\n\n            <v-list-item \n              tabindex=\"0\" \n              aria-label=\"Show introduction\"\n              @click=\"() => emit('intro-slide', 1)\"\n              @keyup.enter=\"() => emit('intro-slide', 1)\"\n              disabled\n              >\n                Introduction\n            </v-list-item>\n            \n            <v-list-item \n              tabindex=\"0\"\n              aria-label=\"Show user guide\"\n              @click=\"() => emit('intro-slide', 4)\"\n              @keyup.enter=\"() => emit('intro-slide', 4)\"\n              disabled\n              >\n              User Guide\n            </v-list-item>\n            \n            <v-list-item \n              tabindex=\"0\"\n              aria-label=\"Show dialog telling about the data\"\n              @click=\"showAboutData = true\"\n              @keyup.enter=\"showAboutData = true\"\n              disabled\n              >\n              About the Data\n            </v-list-item>\n            \n            <v-list-item \n              \n              aria-label=\"Leave Page to Educator Resources\"\n              >\n              <a style=\"font-weight: normal;\" tabindex=\"0\"  href=\"https://www.cosmicds.cfa.harvard.edu/resources/tempo\" target=\"_blank\" rel=\"noopener\">Educator Resources<v-icon>mdi-open-in-new</v-icon></a>\n            </v-list-item>\n            \n            <v-list-item \n              tabindex=\"0\" \n              aria-label=\"Show credits\"\n              @click=\"showCredits = true\"\n              @keyup.enter=\"showCredits = true\"\n              disabled\n              >\n                Credits\n            </v-list-item>\n            \n          </v-list>\n        </v-menu>\n      </v-btn>\n\n      <v-dialog\n        v-model=\"showSaveDialog\"\n        width=\"300px\"\n      >\n        <save-state\n          @load-local=\"showSaveDialog = false\"\n          @save-local=\"showSaveDialog = false\"\n          @error=\"(type: string, message: string) => reportError(type, message)\"\n        />\n      </v-dialog>\n\n      <v-snackbar\n        v-model=\"showErrorSnackbar\"\n        timeout=\"2000\"\n        color=\"error\"\n      >\n         {{ ioErrorMessage }}\n      </v-snackbar>\n\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { useDisplay } from \"vuetify\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { useTempoStore } from \"@/stores/app\";\nimport changes from \"@/changes\";\n\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faArrowsRotate } from \"@fortawesome/free-solid-svg-icons\";\n\nlibrary.add(faArrowsRotate);\n\nconst emit = defineEmits<{\n  (event: \"intro-slide\", value: number): void;\n  (event: 'layers'): void;\n}>();\n\nconst store = useTempoStore();\nconst {\n  accentColor2,\n} = storeToRefs(store);\n\nconst display = useDisplay();\n\nconst showChanges = ref(false);\nconst showAboutData = ref(false);\nconst showCredits = ref(false);\nconst showSaveDialog = ref(false);\nconst showErrorSnackbar = ref(false);\nconst ioErrorMessage = ref(\"\");\n\nconst touchscreen = supportsTouchscreen();\n\nconst smallSize = computed(() => {\n  return display.smAndDown.value;\n});\n\n\nconst mobile = computed(() => {\n  return smallSize.value && touchscreen;\n});\n\nfunction reportError(_error: string, message: string) {\n  showErrorSnackbar.value = true;\n  ioErrorMessage.value = message;\n}\n</script>\n\n<style scoped lang=\"less\">\n#title {\n  color: var(--smithsonian-yellow);\n  font-weight: 600;\n  font-size: 2.5rem;\n  text-align: center;\n  text-wrap: nowrap;\n  flex-grow: 1;\n}\n\na[href=\"https://tempo.si.edu\"]>img {\n  // display: inline;\n  height: 70px !important;\n  width: auto !important;\n}\n\n.header {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  padding: 10px;\n  gap: 3px;\n\n  >* {\n    background-color: transparent;\n  }\n\n  >div {\n    outline: 1px solid transparent;\n  }\n\n  .layers-button, .save-button {\n    padding: 8px;\n  }\n\n  #menu-area {\n    display: flex;\n    justify-self: end;\n    gap: 1rem;\n    align-items: center;\n\n    :deep(.icon-wrapper) {\n      width: 40px;\n      height: 40px;\n      border-radius: 8px !important;\n    }\n\n  }\n}\n\n\n\n</style>\n","import script from \"./HeaderBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./HeaderBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./HeaderBar.vue?vue&type=style&index=0&id=57c01bcc&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-57c01bcc\"]])\n\nexport default __exports__","export function titleBarPredicate(element: HTMLElement): boolean {\n  return element.closest(\".v-toolbar\") != null;\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, withKeys as _withKeys, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { id: \"dual-date-range-picker\" }\nconst _hoisted_2 = { class: \"ddrp__picker mb-4\" }\nconst _hoisted_3 = [\"disabled\"]\nconst _hoisted_4 = { class: \"ddrp__picker mb-4\" }\nconst _hoisted_5 = [\"disabled\"]\n\nimport { ref, watch } from 'vue';\n\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DateRangePicker',\n  props: {\n    startDate: {},\n    endDate: {},\n    allowedDates: {},\n    formatFunction: { type: Function },\n    clearable: { type: Boolean },\n    textInput: { type: Boolean },\n    teleport: { type: Boolean },\n    dark: { type: Boolean },\n    yearRange: {}\n  },\n  emits: [\"update:startDate\", \"update:endDate\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst props = __props;\n\nconst format = (date: Date | null) => {\n  if (date === null) {\n    throw new Error('Date is null' );\n  }\n  if (props.formatFunction) {\n    return props.formatFunction(date);\n  }\n  return date.toLocaleDateString();\n};\n\nconst emit = __emit;\n\n\nconst startDateCalendar = ref();\nconst endDateCalendar = ref();\nconst startDateObj = ref<Date | null>(props.startDate ?? null);\nconst endDateObj = ref<Date | null>(props.endDate ?? null);\nconst errMessage = ref<string>('');\n\n\nfunction handleStartDateChange(value: Date | null) {\n  if (value !== null && value.getTime() !== startDateObj.value?.getTime()) {\n    if (endDateObj.value && value > endDateObj.value) {\n      errMessage.value = 'Start date cannot be after end date.';\n      console.error(errMessage.value);\n      return;\n    }\n    startDateObj.value = value;\n    emit('update:startDate', value);\n    startDateCalendar.value?.closeMenu();\n  }\n}\n\nfunction handleEndDateChange(value: Date | null) {\n  if (value !== null && value.getTime() !== endDateObj.value?.getTime()) {\n    if (startDateObj.value && value < startDateObj.value) {\n      errMessage.value = 'End date cannot be before start date.';\n      console.error(errMessage.value);\n      return;\n    }\n    \n    endDateObj.value = value;\n    emit('update:endDate', value);\n    endDateCalendar.value?.closeMenu();\n  }\n}\n\n\n\n\nwatch(() => props.startDate, (newDate) => {\n  if (newDate?.getTime() !== startDateObj.value?.getTime()) {\n    startDateObj.value = newDate ?? null;\n  }\n});\n\nwatch(() => props.endDate, (newDate) => {\n  if (newDate?.getTime() !== endDateObj.value?.getTime()) {\n    endDateObj.value = newDate ?? null;\n  }\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_date_picker = _resolveComponent(\"date-picker\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _cache[4] || (_cache[4] = _createElementVNode(\"label\", { class: \"text-subtitle-2 mb-2 d-block\" }, \"Start Date\", -1)),\n      _createVNode(_component_date_picker, {\n        class: \"cds__date-picker\",\n        ref_key: \"startDateCalendar\",\n        ref: startDateCalendar,\n        \"model-value\": startDateObj.value,\n        onInternalModelChange: handleStartDateChange,\n        \"allowed-dates\": __props.allowedDates,\n        formats: {'input': format, 'preview': format },\n        \"input-atters\": { clearable: __props.clearable },\n        \"text-input\": __props.textInput,\n        teleport: true,\n        dark: __props.dark,\n        \"year-range\": __props.yearRange,\n        \"time-config\": { enableTimePicker: false },\n        \"max-date\": endDateObj.value ?? new Date(),\n        \"week-start\": 0,\n        \"prevent-min-max-navigation\": \"\",\n        \"six-weeks\": \"\"\n      }, {\n        \"action-buttons\": _withCtx(() => [\n          _createElementVNode(\"button\", {\n            class: \"dp__action_button dp__action-latest\",\n            onClick: _cache[0] || (_cache[0] = () => __props.allowedDates ? handleStartDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null),\n            onKeyup: _cache[1] || (_cache[1] = _withKeys(() => __props.allowedDates ? handleStartDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null, [\"enter\"])),\n            disabled: !__props.allowedDates || !!(endDateObj.value && (__props.allowedDates[__props.allowedDates.length - 1] > endDateObj.value)),\n            elevation: \"0\",\n            size: \"sm\"\n          }, \" Latest \", 40, _hoisted_3)\n        ]),\n        _: 1\n      }, 8, [\"model-value\", \"allowed-dates\", \"formats\", \"input-atters\", \"text-input\", \"dark\", \"year-range\", \"max-date\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_4, [\n      _cache[5] || (_cache[5] = _createElementVNode(\"label\", { class: \"text-subtitle-2 mb-2 d-block\" }, \"End Date\", -1)),\n      _createVNode(_component_date_picker, {\n        class: \"cds__date-picker\",\n        ref_key: \"endDateCalendar\",\n        ref: endDateCalendar,\n        \"model-value\": endDateObj.value,\n        onInternalModelChange: handleEndDateChange,\n        \"allowed-dates\": __props.allowedDates,\n        formats: {input: format, preview: format},\n        \"input-atters\": { clearable: __props.clearable },\n        teleport: true,\n        dark: __props.dark,\n        \"year-range\": __props.yearRange,\n        \"time-config\": { enableTimePicker: false },\n        \"min-date\": startDateObj.value ?? new Date(0),\n        \"week-start\": 0,\n        \"prevent-min-max-navigation\": \"\",\n        \"six-weeks\": \"\"\n      }, {\n        \"action-buttons\": _withCtx(() => [\n          _createElementVNode(\"button\", {\n            class: \"dp__action_button dp__action-latest\",\n            onClick: _cache[2] || (_cache[2] = () => __props.allowedDates ? handleEndDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null),\n            onKeyup: _cache[3] || (_cache[3] = _withKeys(() => __props.allowedDates ? handleEndDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null, [\"enter\"])),\n            disabled: !__props.allowedDates,\n            elevation: \"0\",\n            size: \"sm\"\n          }, \" Latest \", 40, _hoisted_5)\n        ]),\n        _: 1\n      }, 8, [\"model-value\", \"allowed-dates\", \"formats\", \"input-atters\", \"dark\", \"year-range\", \"min-date\"])\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <!-- TODO -- make the date pickers have sharper colors -->\n  <div id=\"dual-date-range-picker\">\n    <div class=\"ddrp__picker mb-4\">\n      <label class=\"text-subtitle-2 mb-2 d-block\">Start Date</label>\n      <date-picker\n        class=\"cds__date-picker\"\n        ref=\"startDateCalendar\"\n        :model-value=\"startDateObj\"\n        @internal-model-change=\"handleStartDateChange\"\n        :allowed-dates=\"allowedDates\"\n        :formats=\"{'input': format, 'preview': format }\"\n        :input-atters=\"{ clearable }\"\n        :text-input=\"textInput\"\n        :teleport=\"true\"\n        :dark=\"dark\"\n        :year-range=\"yearRange\"\n        :time-config=\"{ enableTimePicker: false }\"\n        :max-date=\"endDateObj ?? new Date()\"\n        :week-start=\"0\"\n        prevent-min-max-navigation\n        six-weeks\n      >\n        <template #action-buttons>\n          <button\n            class=\"dp__action_button dp__action-latest\"\n            @click=\"() => allowedDates ? handleStartDateChange(allowedDates[allowedDates.length - 1]) : null\"\n            @keyup.enter=\"() => allowedDates ? handleStartDateChange(allowedDates[allowedDates.length - 1]) : null\"\n            :disabled=\"!allowedDates || !!(endDateObj && (allowedDates[allowedDates.length - 1] > endDateObj))\"\n            elevation=\"0\"\n            size=\"sm\"\n          >\n            Latest\n          </button>\n        </template>\n      </date-picker>\n    </div>\n    \n    <div class=\"ddrp__picker mb-4\">\n      <label class=\"text-subtitle-2 mb-2 d-block\">End Date</label>\n      <date-picker\n        class=\"cds__date-picker\"\n        ref=\"endDateCalendar\"\n        :model-value=\"endDateObj\"\n        @internal-model-change=\"handleEndDateChange\"\n        :allowed-dates=\"allowedDates\"\n        :formats=\"{input: format, preview: format}\"\n        :input-atters=\"{ clearable }\"\n        :teleport=\"true\"\n        :dark=\"dark\"\n        :year-range=\"yearRange\"\n        :time-config=\"{ enableTimePicker: false }\"\n        :min-date=\"startDateObj ?? new Date(0)\"\n        :week-start=\"0\"\n        prevent-min-max-navigation\n        six-weeks\n      >\n        <template #action-buttons>\n          <button\n            class=\"dp__action_button dp__action-latest\"\n            @click=\"() => allowedDates ? handleEndDateChange(allowedDates[allowedDates.length - 1]) : null\"\n            @keyup.enter=\"() => allowedDates ? handleEndDateChange(allowedDates[allowedDates.length - 1]) : null\"\n            :disabled=\"!allowedDates\"\n            elevation=\"0\"\n            size=\"sm\"\n          >\n            Latest\n          </button>\n        </template>\n      </date-picker>\n    </div>\n    \n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch } from 'vue';\n\n\nconst props = defineProps<{\n  startDate?: Date | null;\n  endDate?: Date | null;\n  allowedDates?: Date[];\n  formatFunction?: (date: Date) => string;\n  clearable?: boolean;\n  textInput?: boolean;\n  teleport?: boolean;\n  dark?: boolean;\n  yearRange?: [number, number];\n}>();\n\nconst format = (date: Date | null) => {\n  if (date === null) {\n    throw new Error('Date is null' );\n  }\n  if (props.formatFunction) {\n    return props.formatFunction(date);\n  }\n  return date.toLocaleDateString();\n};\n\nconst emit = defineEmits<{\n  'update:startDate': [date: Date | null];\n  'update:endDate': [date: Date | null];\n}>();\n\n\nconst startDateCalendar = ref();\nconst endDateCalendar = ref();\nconst startDateObj = ref<Date | null>(props.startDate ?? null);\nconst endDateObj = ref<Date | null>(props.endDate ?? null);\nconst errMessage = ref<string>('');\n\n\nfunction handleStartDateChange(value: Date | null) {\n  if (value !== null && value.getTime() !== startDateObj.value?.getTime()) {\n    if (endDateObj.value && value > endDateObj.value) {\n      errMessage.value = 'Start date cannot be after end date.';\n      console.error(errMessage.value);\n      return;\n    }\n    startDateObj.value = value;\n    emit('update:startDate', value);\n    startDateCalendar.value?.closeMenu();\n  }\n}\n\nfunction handleEndDateChange(value: Date | null) {\n  if (value !== null && value.getTime() !== endDateObj.value?.getTime()) {\n    if (startDateObj.value && value < startDateObj.value) {\n      errMessage.value = 'End date cannot be before start date.';\n      console.error(errMessage.value);\n      return;\n    }\n    \n    endDateObj.value = value;\n    emit('update:endDate', value);\n    endDateCalendar.value?.closeMenu();\n  }\n}\n\n\n\n\nwatch(() => props.startDate, (newDate) => {\n  if (newDate?.getTime() !== startDateObj.value?.getTime()) {\n    startDateObj.value = newDate ?? null;\n  }\n});\n\nwatch(() => props.endDate, (newDate) => {\n  if (newDate?.getTime() !== endDateObj.value?.getTime()) {\n    endDateObj.value = newDate ?? null;\n  }\n});\n\n</script>\n\n<style>\n#dual-date-range-picker {\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n\n#dual-date-range-picker > div.ddrp__picker {\n  flex-basis: 48%;\n  min-width: 150px;\n}\n\n\n</style>\n","import script from \"./DateRangePicker.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DateRangePicker.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DateRangePicker.vue?vue&type=style&index=0&id=3aec89e3&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { vShow as _vShow, createElementVNode as _createElementVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelCheckbox as _vModelCheckbox, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = { class: \"d-flex flex-wrap align-content-center\" }\nconst _hoisted_2 = { class: \"text-subtitle-2 mb-2 d-block\" }\nconst _hoisted_3 = {\n  \"aria-live\": \"polite\",\n  style: {\"font-weight\":\"bold\"}\n}\nconst _hoisted_4 = [\"value\"]\nconst _hoisted_5 = { class: \"ml-1\" }\n\nimport { ref, computed, onMounted, onBeforeUnmount } from 'vue';\nimport { type DayType, DAYS } from './date_time_range_generators';\n\nconst monthItemWidthPx = 60;\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DaysPicker',\n  props: /*@__PURE__*/_mergeModels({\n    showErrorForEmpty: { type: Boolean }\n  }, {\n    \"modelValue\": {\n  type: Array as () => DayType[],\n  default: () => [...DAYS],\n},\n    \"modelModifiers\": {},\n  }),\n  emits: [\"update:modelValue\"],\n  setup(__props: any) {\n\n\n\nconst selectedDays = _useModel<DayType[]>(__props, \"modelValue\");\n\nconst empty = computed(() => selectedDays.value?.length === 0);\n\n\nconst columns = ref(1);\nconst cssVars = computed(() => ({\n  '--column-count': columns.value\n}));\nconst observer = new ResizeObserver(() => {\n  updateColumnCount();\n});\n\nfunction updateColumnCount() {\n  const container = document.getElementById('dtrs-days-picker') ;\n  if (container) {\n    columns.value = Math.max(Math.floor(container.clientWidth / monthItemWidthPx), 1);\n  }\n}\nonMounted(() => {\n  updateColumnCount();\n  const container = document.getElementById('dtrs-days-picker') ;\n  if (container) {\n    observer.observe(container);\n  }\n});\n\nonBeforeUnmount(() => {\n  observer.disconnect();\n});\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: \"dtrs-days-picker\",\n    class: _normalizeClass({'dtrs-error-highlight': __props.showErrorForEmpty && empty.value})\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"label\", _hoisted_2, [\n        _cache[3] || (_cache[3] = _createTextVNode(\"Days of Week \", -1)),\n        _withDirectives(_createElementVNode(\"span\", _hoisted_3, \" (Select at least 1) \", 512), [\n          [_vShow, __props.showErrorForEmpty && empty.value]\n        ])\n      ]),\n      _createElementVNode(\"div\", null, [\n        _createVNode(_component_v_btn, {\n          size: \"x-small\",\n          variant: \"outlined\",\n          class: \"mr-2 mb-2 ml-4\",\n          onClick: _cache[0] || (_cache[0] = ($event: any) => (selectedDays.value = []))\n        }, {\n          prepend: _withCtx(() => [\n            _createVNode(_component_v_icon, {\n              icon: \"mdi-close-circle\",\n              color: \"error\"\n            })\n          ]),\n          default: _withCtx(() => [\n            _cache[4] || (_cache[4] = _createTextVNode(\" Clear \", -1))\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_v_btn, {\n          size: \"x-small\",\n          variant: \"outlined\",\n          class: \"mr-2 mb-2\",\n          onClick: _cache[1] || (_cache[1] = ($event: any) => (selectedDays.value = _unref(DAYS).slice()))\n        }, {\n          prepend: _withCtx(() => [\n            _createVNode(_component_v_icon, {\n              icon: \"mdi-check-circle\",\n              color: \"success\"\n            })\n          ]),\n          default: _withCtx(() => [\n            _cache[5] || (_cache[5] = _createTextVNode(\" All \", -1))\n          ]),\n          _: 1\n        })\n      ])\n    ]),\n    _createElementVNode(\"div\", {\n      style: _normalizeStyle(cssVars.value),\n      id: \"dtrs-days-block\"\n    }, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(DAYS), (day, idx) => {\n        return (_openBlock(), _createElementBlock(\"label\", {\n          key: idx,\n          class: \"mr-3\",\n          style: {\"text-wrap\":\"nowrap\"}\n        }, [\n          _withDirectives(_createElementVNode(\"input\", {\n            type: \"checkbox\",\n            value: day,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((selectedDays).value = $event))\n          }, null, 8, _hoisted_4), [\n            [_vModelCheckbox, selectedDays.value]\n          ]),\n          _createElementVNode(\"span\", _hoisted_5, _toDisplayString(day.slice(0,3)), 1)\n        ]))\n      }), 128))\n    ], 4)\n  ], 2))\n}\n}\n\n})","<template>\n  <div id='dtrs-days-picker' :class=\"{'dtrs-error-highlight': showErrorForEmpty && empty}\">\n    <div class=\"d-flex flex-wrap align-content-center\">\n      <label class=\"text-subtitle-2 mb-2 d-block\">Days of Week\n        <span v-show=\"showErrorForEmpty && empty\" aria-live=\"polite\" style=\"font-weight: bold;\">\n          (Select at least 1)\n        </span>\n      </label>\n      <div>\n        <!-- clear -->\n        <v-btn \n          size=\"x-small\" \n          variant=\"outlined\" \n          class=\"mr-2 mb-2 ml-4\"\n          @click=\"selectedDays = []\"\n        >\n          Clear\n          <template #prepend>\n            <v-icon icon=\"mdi-close-circle\" color=\"error\"/>\n          </template>\n        </v-btn>\n        \n        <v-btn \n          size=\"x-small\" \n          variant=\"outlined\" \n          class=\"mr-2 mb-2\"\n          @click=\"selectedDays = DAYS.slice()\"\n        >\n          All\n          <template #prepend>\n            <v-icon icon=\"mdi-check-circle\" color=\"success\"/>\n          </template>\n        </v-btn>\n        \n      </div>\n    </div>\n    <!-- just do labeled checkboxes -->\n    <div :style=\"cssVars\" id=\"dtrs-days-block\">\n    <label v-for=\"(day, idx) in DAYS\" :key=\"idx\" class=\"mr-3\" style=\"text-wrap: nowrap;\">\n      <input \n        type=\"checkbox\" \n        :value=\"day\" \n        v-model=\"selectedDays\" \n      />\n      <span class=\"ml-1\">{{ day.slice(0,3) }}</span>\n    </label>\n  </div>\n  </div>\n</template>\n\n\n<script lang=\"ts\" setup>\nimport { ref, computed, onMounted, onBeforeUnmount } from 'vue';\nimport { type DayType, DAYS } from './date_time_range_generators';\n\nconst { showErrorForEmpty } = defineProps<{\n  showErrorForEmpty?: boolean;\n}>();\n\nconst selectedDays = defineModel<DayType[]>({\n  type: Array as () => DayType[],\n  default: () => [...DAYS],\n});\n\nconst empty = computed(() => selectedDays.value?.length === 0);\n\n\nconst columns = ref(1);\nconst cssVars = computed(() => ({\n  '--column-count': columns.value\n}));\nconst observer = new ResizeObserver(() => {\n  updateColumnCount();\n});\n\nconst monthItemWidthPx = 60;\nfunction updateColumnCount() {\n  const container = document.getElementById('dtrs-days-picker') ;\n  if (container) {\n    columns.value = Math.max(Math.floor(container.clientWidth / monthItemWidthPx), 1);\n  }\n}\nonMounted(() => {\n  updateColumnCount();\n  const container = document.getElementById('dtrs-days-picker') ;\n  if (container) {\n    observer.observe(container);\n  }\n});\n\nonBeforeUnmount(() => {\n  observer.disconnect();\n});\n\n\n</script>\n\n<style scoped>\n\n#dtrs-days-block {\n  display: grid;\n  grid-template-columns: repeat(var(--column-count), auto);\n}\n\n.dtrs-days-picker {\n  border-radius: 8px;\n  padding: 8px 12px;\n  margin: 4px;\n  \n}\n.dtrs-error-highlight {\n  box-shadow: inset 0 0 8px 0px rgba(255,0,0,0.82)\n}\n</style>","import script from \"./DaysPicker.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./DaysPicker.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./DaysPicker.vue?vue&type=style&index=0&id=c5ba0d10&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c5ba0d10\"]])\n\nexport default __exports__","import { useModel as _useModel, defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"mb-4 simple-patterns\" }\n\nimport { type DayType } from './date_time_range_generators';\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DayPatterns',\n  props: {\n    \"modelValue\": {\n  type: Array as () => DayType[]\n},\n    \"modelModifiers\": {},\n  },\n  emits: [\"update:modelValue\"],\n  setup(__props) {\n\nconst selectedDays = _useModel<DayType[]>(__props, \"modelValue\");\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(_component_v_btn, {\n      size: \"x-small\",\n      variant: \"outlined\",\n      class: \"mr-2 mb-2\",\n      onClick: _cache[0] || (_cache[0] = ($event: any) => (selectedDays.value = ['Monday','Tuesday','Wednesday','Thursday','Friday']))\n    }, {\n      default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n        _createTextVNode(\"Weekdays\", -1)\n      ]))]),\n      _: 1\n    }),\n    _createVNode(_component_v_btn, {\n      size: \"x-small\",\n      variant: \"outlined\",\n      class: \"mr-2 mb-2\",\n      onClick: _cache[1] || (_cache[1] = ($event: any) => (selectedDays.value = ['Sunday','Saturday']))\n    }, {\n      default: _withCtx(() => [...(_cache[3] || (_cache[3] = [\n        _createTextVNode(\"Weekends\", -1)\n      ]))]),\n      _: 1\n    })\n  ]))\n}\n}\n\n})","<template>\n<div class=\"mb-4 simple-patterns\">\n  <!-- weekdays -->\n  <v-btn \n    size=\"x-small\" \n    variant=\"outlined\" \n    class=\"mr-2 mb-2\"\n    @click=\"selectedDays = ['Monday','Tuesday','Wednesday','Thursday','Friday']\"\n  >Weekdays</v-btn>\n  <!-- weekends -->\n  <v-btn \n    size=\"x-small\" \n    variant=\"outlined\" \n    class=\"mr-2 mb-2\"\n    @click=\"selectedDays = ['Sunday','Saturday']\"\n  >Weekends</v-btn>\n  <!--\n  <v-btn \n    size=\"x-small\" \n    variant=\"outlined\" \n    class=\"mr-2 mb-2\"\n    @click=\"selectedDays = DAYS.slice()\"\n  >Full Week</v-btn>\n  <v-btn \n    size=\"x-small\" \n    variant=\"outlined\" \n    class=\"mr-2 mb-2\"\n    @click=\"selectedDays = []\"\n  >Clear</v-btn>\n  -->\n</div>\n\n</template>\n\n<script lang=\"ts\" setup>\nimport { type DayType } from './date_time_range_generators';\nconst selectedDays = defineModel<DayType[]>({\n  type: Array as () => DayType[]\n});\n</script>","import script from \"./DayPatterns.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./DayPatterns.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, unref as _unref, vShow as _vShow, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelCheckbox as _vModelCheckbox, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = { class: \"d-flex flex-wrap align-content-center\" }\nconst _hoisted_2 = {\n  \"aria-live\": \"polite\",\n  style: {\"font-weight\":\"bold\"},\n  class: \"mb-2\"\n}\nconst _hoisted_3 = [\"for\"]\nconst _hoisted_4 = [\"id\", \"value\"]\nconst _hoisted_5 = { class: \"ml-1\" }\n\nimport { ref, computed, onMounted, onBeforeUnmount } from 'vue';\nimport { type MonthType, MONTHS } from './date_time_range_generators';\n\nconst monthItemWidthPx = 110;\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MonthsPicker',\n  props: /*@__PURE__*/_mergeModels({\n    showErrorForEmpty: { type: Boolean }\n  }, {\n    \"modelValue\": {\n  type: Array as () => MonthType[]\n},\n    \"modelModifiers\": {},\n  }),\n  emits: [\"update:modelValue\"],\n  setup(__props: any) {\n\n\n\nconst selectedMonths = _useModel<MonthType[]>(__props, \"modelValue\");\n\nconst empty = computed(() => selectedMonths.value?.length === 0);\n\nconst columns = ref(1);\nconst cssVars = computed(() => ({\n  '--column-count': columns.value\n}));\nconst observer = new ResizeObserver(() => {\n  updateColumnCount();\n});\n\nfunction updateColumnCount() {\n  const container = document.getElementById('dtrs-months-picker') ;\n  if (container) {\n    columns.value = Math.max(Math.floor(container.clientWidth / monthItemWidthPx), 1);\n  }\n}\nonMounted(() => {\n  updateColumnCount();\n  const container = document.getElementById('dtrs-months-picker') ;\n  if (container) {\n    observer.observe(container);\n  }\n});\n\nonBeforeUnmount(() => {\n  observer.disconnect();\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: \"dtrs-months-picker\",\n    class: _normalizeClass({'dtrs-error-highlight': __props.showErrorForEmpty && empty.value})\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _cache[5] || (_cache[5] = _createElementVNode(\"label\", { class: \"text-subtitle-2 mb-2 d-inline\" }, \"Months \", -1)),\n      _createElementVNode(\"div\", null, [\n        _createVNode(_component_v_btn, {\n          size: \"x-small\",\n          variant: \"outlined\",\n          class: \"mr-2 mb-2 ml-4\",\n          onClick: _cache[0] || (_cache[0] = ($event: any) => (selectedMonths.value = []))\n        }, {\n          prepend: _withCtx(() => [\n            _createVNode(_component_v_icon, {\n              icon: \"mdi-close-circle\",\n              color: \"error\"\n            })\n          ]),\n          default: _withCtx(() => [\n            _cache[3] || (_cache[3] = _createTextVNode(\"Clear \", -1))\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_v_btn, {\n          size: \"x-small\",\n          variant: \"outlined\",\n          class: \"mr-2 mb-2\",\n          onClick: _cache[1] || (_cache[1] = ($event: any) => (selectedMonths.value = _unref(MONTHS).slice()))\n        }, {\n          prepend: _withCtx(() => [\n            _createVNode(_component_v_icon, {\n              icon: \"mdi-check-circle\",\n              color: \"success\"\n            })\n          ]),\n          default: _withCtx(() => [\n            _cache[4] || (_cache[4] = _createTextVNode(\"All \", -1))\n          ]),\n          _: 1\n        })\n      ]),\n      _withDirectives(_createElementVNode(\"div\", _hoisted_2, \" (Select at least 1) \", 512), [\n        [_vShow, __props.showErrorForEmpty && empty.value]\n      ])\n    ]),\n    _createElementVNode(\"fieldset\", {\n      style: _normalizeStyle(cssVars.value),\n      class: _normalizeClass({'dtrs-months-block':true, 'dtrs-error-month': empty.value} )\n    }, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(MONTHS), (month) => {\n        return (_openBlock(), _createElementBlock(\"div\", { key: month }, [\n          _createElementVNode(\"label\", {\n            class: \"mr-3\",\n            style: {\"text-wrap\":\"nowrap\"},\n            for: `dtrs-month-${month}`\n          }, [\n            _withDirectives(_createElementVNode(\"input\", {\n              id: `dtrs-month-${month}`,\n              type: \"checkbox\",\n              value: month,\n              \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((selectedMonths).value = $event))\n            }, null, 8, _hoisted_4), [\n              [_vModelCheckbox, selectedMonths.value]\n            ]),\n            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(month), 1)\n          ], 8, _hoisted_3)\n        ]))\n      }), 128))\n    ], 6)\n  ], 2))\n}\n}\n\n})","<template>\n  <div id=\"dtrs-months-picker\" :class=\"{'dtrs-error-highlight': showErrorForEmpty && empty}\">\n    <div class=\"d-flex flex-wrap align-content-center\">\n      <label class=\"text-subtitle-2 mb-2 d-inline\">Months\n      </label>\n      <div>\n      <v-btn \n        size=\"x-small\" \n        variant=\"outlined\" \n        class=\"mr-2 mb-2 ml-4\"\n        @click=\"selectedMonths = []\"\n      >Clear\n      <template #prepend>\n        <v-icon icon=\"mdi-close-circle\" color=\"error\"/>\n      </template>\n    </v-btn>\n      <v-btn \n        size=\"x-small\" \n        variant=\"outlined\" \n        class=\"mr-2 mb-2\"\n        @click=\"selectedMonths = MONTHS.slice()\"\n      >All\n      <template #prepend>\n        <v-icon icon=\"mdi-check-circle\" color=\"success\"/>\n      </template>\n    </v-btn>\n      </div>\n      <div v-show=\"showErrorForEmpty && empty\" aria-live=\"polite\" style=\"font-weight: bold;\" class=\"mb-2\">\n        (Select at least 1)\n      </div>\n    </div>\n    <fieldset \n      :style=\"cssVars\" \n      :class=\"{'dtrs-months-block':true, 'dtrs-error-month': empty} \">\n      <div v-for=\"month in MONTHS\" :key=\"month\">\n        <label class=\"mr-3\" style=\"text-wrap: nowrap;\" :for=\"`dtrs-month-${month}`\">\n          <input \n            :id=\"`dtrs-month-${month}`\"\n            type=\"checkbox\" \n            :value=\"month\" \n            v-model=\"selectedMonths\" \n          />\n          <span class=\"ml-1\">{{ month }}</span>\n        </label>\n      </div>\n    </fieldset>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, computed, onMounted, onBeforeUnmount } from 'vue';\nimport { type MonthType, MONTHS } from './date_time_range_generators';\n\nconst { showErrorForEmpty } = defineProps<{\n  showErrorForEmpty?: boolean;\n}>();\n\nconst selectedMonths = defineModel<MonthType[]>({\n  type: Array as () => MonthType[]\n});\n\nconst empty = computed(() => selectedMonths.value?.length === 0);\n\nconst columns = ref(1);\nconst cssVars = computed(() => ({\n  '--column-count': columns.value\n}));\nconst observer = new ResizeObserver(() => {\n  updateColumnCount();\n});\n\nconst monthItemWidthPx = 110;\nfunction updateColumnCount() {\n  const container = document.getElementById('dtrs-months-picker') ;\n  if (container) {\n    columns.value = Math.max(Math.floor(container.clientWidth / monthItemWidthPx), 1);\n  }\n}\nonMounted(() => {\n  updateColumnCount();\n  const container = document.getElementById('dtrs-months-picker') ;\n  if (container) {\n    observer.observe(container);\n  }\n});\n\nonBeforeUnmount(() => {\n  observer.disconnect();\n});\n\n</script>\n\n<style scoped>\n\n.dtrs-months-block {\n  display: grid;\n  grid-template-columns: repeat(var(--column-count), auto);\n  border: none;\n  margin-inline: -8px;\n  padding-inline: 8px;\n  border-radius: 4px;\n}\n#dtrs-months-picker {\n  border-radius: 8px;\n  padding: 8px 0px;\n  margin: 4px;\n  \n}\n\n\nfieldset.dtrs-months-block.dtrs-error-month {\n  background-color: rgba(255,0,0,.2)\n}\n\n</style>\n","import script from \"./MonthsPicker.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./MonthsPicker.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./MonthsPicker.vue?vue&type=style&index=0&id=7ae64146&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7ae64146\"]])\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { vShow as _vShow, createElementVNode as _createElementVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelCheckbox as _vModelCheckbox, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = { class: \"text-subtitle-2 mb-2 d-block\" }\nconst _hoisted_2 = {\n  \"aria-live\": \"polite\",\n  style: {\"font-weight\":\"bold\"}\n}\nconst _hoisted_3 = [\"for\"]\nconst _hoisted_4 = [\"id\", \"value\"]\nconst _hoisted_5 = { class: \"ml-1\" }\n\nimport { computed } from 'vue';\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'YearsPicker',\n  props: /*@__PURE__*/_mergeModels({\n    possibleYears: {},\n    showErrorForEmpty: { type: Boolean }\n  }, {\n    \"modelValue\": {\n  type: Array as () => number[]\n},\n    \"modelModifiers\": {},\n  }),\n  emits: [\"update:modelValue\"],\n  setup(__props: any) {\n\n\n\nconst selectedYears = _useModel<number[]>(__props, \"modelValue\");\n\nconst empty = computed(() => selectedYears.value?.length === 0);\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass({'dtrs-error-highlight': __props.showErrorForEmpty && empty.value, 'dtrs-years-picker': true})\n  }, [\n    _createElementVNode(\"label\", _hoisted_1, [\n      _cache[1] || (_cache[1] = _createTextVNode(\"Years \", -1)),\n      _withDirectives(_createElementVNode(\"span\", _hoisted_2, \" (Select at least 1) \", 512), [\n        [_vShow, __props.showErrorForEmpty && empty.value]\n      ])\n    ]),\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.possibleYears, (year) => {\n      return (_openBlock(), _createElementBlock(\"div\", {\n        key: year,\n        class: \"d-inline-block\"\n      }, [\n        _createElementVNode(\"label\", {\n          class: \"mr-3\",\n          style: {\"text-wrap\":\"nowrap\"},\n          for: `dtrs-year-${year}`\n        }, [\n          _withDirectives(_createElementVNode(\"input\", {\n            id: `dtrs-year-${year}`,\n            type: \"checkbox\",\n            value: year,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((selectedYears).value = $event))\n          }, null, 8, _hoisted_4), [\n            [_vModelCheckbox, selectedYears.value]\n          ]),\n          _createElementVNode(\"span\", _hoisted_5, _toDisplayString(year), 1)\n        ], 8, _hoisted_3)\n      ]))\n    }), 128))\n  ], 2))\n}\n}\n\n})","<template>\n  <div :class=\"{'dtrs-error-highlight': showErrorForEmpty && empty, 'dtrs-years-picker': true}\">\n    <label class=\"text-subtitle-2 mb-2 d-block\">Years \n      <span v-show=\"showErrorForEmpty && empty\" aria-live=\"polite\" style=\"font-weight: bold;\">\n        (Select at least 1)\n      </span>\n      </label>\n    <div v-for=\"year in possibleYears\" :key=\"year\" class=\"d-inline-block\">\n      <label class=\"mr-3\" style=\"text-wrap: nowrap;\" :for=\"`dtrs-year-${year}`\">\n        <input \n          :id=\"`dtrs-year-${year}`\"\n          type=\"checkbox\" \n          :value=\"year\" \n          v-model=\"selectedYears\" \n        />\n        <span class=\"ml-1\">{{ year }} </span>\n      </label>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed } from 'vue';\nconst { possibleYears } = defineProps<{\n  possibleYears: number[];\n  showErrorForEmpty?: boolean;\n}>();\n\nconst selectedYears = defineModel<number[]>({\n  type: Array as () => number[]\n});\n\nconst empty = computed(() => selectedYears.value?.length === 0);\n</script>\n\n<style scoped>\n.dtrs-years-picker {\n  border-radius: 8px;\n  padding: 8px 12px;\n  margin: 4px;\n  \n}\n.dtrs-error-highlight {\n  box-shadow: inset 0 0 8px 0px rgba(255,0,0,0.82)\n}\n</style>","import script from \"./YearsPicker.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./YearsPicker.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./YearsPicker.vue?vue&type=style&index=0&id=18114425&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-18114425\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"dtrs-list-days-preview\" }\nconst _hoisted_2 = { key: 0 }\nconst _hoisted_3 = { key: 0 }\nconst _hoisted_4 = { key: 1 }\n\nimport { computed } from 'vue';\ninterface Props {\n  days: string[];\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DaysPreview',\n  props: {\n    days: { default: () => [] }\n  },\n  setup(__props: any) {\n\n/* eslint-disable @typescript-eslint/naming-convention */\n\nconst DAYS = {\n  'Sunday' : {full: 'Sunday', three: 'Sun', short: 'Su', one: 'S'},\n  'Monday' : {full: 'Monday', three: 'Mon', short: 'M', one: 'M'},\n  'Tuesday' : {full: 'Tuesday', three: 'Tue', short: 'Tu', one: 'T'},\n  'Wednesday' : {full: 'Wednesday', three: 'Wed', short: 'W', one: 'W'},\n  'Thursday' : {full: 'Thursday', three: 'Thu', short: 'Th', one: 'R'},\n  'Friday' : {full: 'Friday', three: 'Fri', short: 'F', one: 'F'},\n  'Saturday' : {full: 'Saturday', three: 'Sat', short: 'Sa', one: 'S'},\n} as const;\n\nconst props = __props;\n\nconst sortedDays = computed(() => {\n  const dayOrder = [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  return props.days.slice().sort((a, b) => dayOrder.indexOf(a) - dayOrder.indexOf(b));\n});\n\nconst _mode = computed<'full' | 'three' | 'short' | 'one'>(() => {\n  switch (props.days.length) {\n  case 0:\n  case 1:\n    return 'full';\n  case 2:\n    return 'three';\n  case 3:\n  case 4:\n  case 5:\n    return 'short';\n  default:\n    return 'one';\n  }\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (__props.days.length < 7)\n      ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(sortedDays.value, (day, index) => {\n            return (_openBlock(), _createElementBlock(\"span\", { key: day }, [\n              _createTextVNode(_toDisplayString(DAYS[day].short), 1),\n              (index < __props.days.length - 1)\n                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \"/\"))\n                : _createCommentVNode(\"\", true)\n            ]))\n          }), 128))\n        ]))\n      : (_openBlock(), _createElementBlock(\"span\", _hoisted_4, \" (All) \"))\n  ]))\n}\n}\n\n})","<!-- \n  This vue component shows a list of days in a compact form\n  for two or fewer days, show the 3-letter day with a \"/\".\n  fot more, just use a single letter with a forward slash \"/\"\n  use Su, Sa, Th for short versions of those days when only one\n  either Sun/Sat or Th/Tu are used. keep them in order\n-->\n<template>\n  <div class=\"dtrs-list-days-preview\">\n  <span v-if=\"days.length < 7\">\n    <span v-for=\"(day, index) in sortedDays\" :key=\"day\">\n      {{ DAYS[day].short }}<span v-if=\"index < days.length - 1\">/</span>\n    </span>\n  </span>\n  <span v-else>\n    (All)\n  </span>\n</div>\n</template>\n\n<style>\n.dtrs-list-days-preview {\n  opacity: 0.75;\n}\n</style>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/naming-convention */\n\nimport { computed, withDefaults } from 'vue';\nconst DAYS = {\n  'Sunday' : {full: 'Sunday', three: 'Sun', short: 'Su', one: 'S'},\n  'Monday' : {full: 'Monday', three: 'Mon', short: 'M', one: 'M'},\n  'Tuesday' : {full: 'Tuesday', three: 'Tue', short: 'Tu', one: 'T'},\n  'Wednesday' : {full: 'Wednesday', three: 'Wed', short: 'W', one: 'W'},\n  'Thursday' : {full: 'Thursday', three: 'Thu', short: 'Th', one: 'R'},\n  'Friday' : {full: 'Friday', three: 'Fri', short: 'F', one: 'F'},\n  'Saturday' : {full: 'Saturday', three: 'Sat', short: 'Sa', one: 'S'},\n} as const;\n\ninterface Props {\n  days: string[];\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  days: () => [],\n});\n\nconst sortedDays = computed(() => {\n  const dayOrder = [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  return props.days.slice().sort((a, b) => dayOrder.indexOf(a) - dayOrder.indexOf(b));\n});\n\nconst _mode = computed<'full' | 'three' | 'short' | 'one'>(() => {\n  switch (props.days.length) {\n  case 0:\n  case 1:\n    return 'full';\n  case 2:\n    return 'three';\n  case 3:\n  case 4:\n  case 5:\n    return 'short';\n  default:\n    return 'one';\n  }\n});\n</script>","import script from \"./DaysPreview.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DaysPreview.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DaysPreview.vue?vue&type=style&index=0&id=6de112dc&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, withCtx as _withCtx, createVNode as _createVNode, resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"mt-2 dtrs-flex-time-box\" }\nconst _hoisted_2 = { class: \"radio-info-label\" }\nconst _hoisted_3 = { class: \"radio-info-label\" }\n\nimport { ref, watch, computed } from 'vue';\nimport { DEFAULT_TOLERANCE, ALL_DAY_TOLERANCE } from './date_time_range_generators';\nimport { _normalizeTimes } from '@/utils/parse_time_strings';\nimport InfoButton from '@/components/InfoButton.vue';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'SpecificTimesSelector',\n  props: {\n    \"modelValue\": {\n  type: Array as () => string[]\n},\n    \"modelModifiers\": {},\n    \"timePlusMinus\": {\n  type: Array as unknown as () => [number, number],\n  default: () => [...DEFAULT_TOLERANCE]\n},\n    \"timePlusMinusModifiers\": {},\n  },\n  emits: [\"update:modelValue\", \"update:timePlusMinus\"],\n  setup(__props) {\n\nfunction timeFormat(hour: number, minute: number, ampm = true): string {\n  if (ampm) {\n    // from 24 hour to am/pm\n    const ampm = hour >= 12 ? 'pm' : 'am';\n    const h12 = hour % 12 === 0 ? 12 : hour % 12;\n    if (minute === 0) {\n      return `${h12} ${ampm}`;\n    }\n    return `${h12}:${String(minute).padStart(2, '0')} ${ampm}`;\n  } else {\n    return `${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}`;\n  }\n}\n\nconst selectedTimes = _useModel<string[]>(__props, \"modelValue\");\nconst timePlusMinus = _useModel<[number, number]>(__props, 'timePlusMinus');\nconst timeOptions = ref<string[]>(Array.from({ length: 15 }, (_, h) => timeFormat(h + 6, 0, true))); // 6:00 to 20:00\n\nconst allDay = computed({\n  get: () => timePlusMinus.value[0] === ALL_DAY_TOLERANCE[0] && timePlusMinus.value[1] === ALL_DAY_TOLERANCE[1],\n  set: (val: boolean) => {\n    timePlusMinus.value = val ? [...ALL_DAY_TOLERANCE] : [...DEFAULT_TOLERANCE];\n  }\n});\n\nconst _selectedTimesRef = ref<string[]>([]);\nconst selectedTimesRef = computed({\n  get: () => {\n    if (allDay.value) return timeOptions.value;\n    return _selectedTimesRef.value;\n  },\n  set: (value: string[]) => {\n    // console.log('selectedTimesRef set to', value);\n    _selectedTimesRef.value = value;\n  }\n});\n\n\nwatch(selectedTimesRef, (value: string[]) => {\n  // console.log('selectedTimesRef changed to', value);\n  if (allDay.value) {\n    selectedTimes.value = [];\n    return;\n  }\n  selectedTimes.value = value;\n});\n\n// Normalize entered times to HH:MM 24h (flexible entry via copilot)\nfunction normalizeTimes(values: string[]) {\n  const normalized = _normalizeTimes(values, timeFormat);\n  const unique = Array.from(new Set(normalized));\n  selectedTimesRef.value = unique;\n  return unique;\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_radio = _resolveComponent(\"v-radio\")!\n  const _component_v_radio_group = _resolveComponent(\"v-radio-group\")!\n  const _component_v_combobox = _resolveComponent(\"v-combobox\")!\n  const _component_v_col = _resolveComponent(\"v-col\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(_component_v_col, null, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_radio_group, {\n          modelValue: allDay.value,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((allDay).value = $event)),\n          direction: \"horizontal\",\n          \"hide-details\": \"\",\n          class: \"mb-2\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_radio, {\n              label: \"Entire Day\",\n              value: true\n            }, {\n              label: _withCtx(({label}) => [\n                _createElementVNode(\"div\", _hoisted_2, [\n                  _createElementVNode(\"div\", null, _toDisplayString(label), 1),\n                  _createVNode(InfoButton, null, {\n                    default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n                      _createElementVNode(\"div\", null, [\n                        _createElementVNode(\"p\", null, \" TEMPO only collects data during daylight hours. Depending on the time of year, different time ranges will be available on a given day \")\n                      ], -1)\n                    ]))]),\n                    _: 1\n                  })\n                ])\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_v_radio, {\n              label: \"Specific Times\",\n              value: false\n            }, {\n              label: _withCtx(({label}) => [\n                _createElementVNode(\"div\", _hoisted_3, [\n                  _createElementVNode(\"div\", null, _toDisplayString(label), 1),\n                  _createVNode(InfoButton, null, {\n                    default: _withCtx(() => [...(_cache[3] || (_cache[3] = [\n                      _createElementVNode(\"div\", null, [\n                        _createElementVNode(\"p\", null, \" Select the times of day you want to include data for. TEMPO will only collect data during daylight hours. The times you pick will be used for each region and corrected for timezone differences. For example, creating a time range of 9:00-11:00 would pull data from 9:00-11:00 Eastern Time for New York, and 9:00-11:00 Pacific Time for Los Angeles. \")\n                      ], -1)\n                    ]))]),\n                    _: 1\n                  })\n                ])\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        }, 8, [\"modelValue\"]),\n        (!allDay.value)\n          ? (_openBlock(), _createBlock(_component_v_combobox, {\n              key: 0,\n              modelValue: selectedTimesRef.value,\n              \"onUpdate:modelValue\": [\n                _cache[1] || (_cache[1] = ($event: any) => ((selectedTimesRef).value = $event)),\n                normalizeTimes\n              ],\n              items: timeOptions.value,\n              label: \"Add/select times\",\n              multiple: \"\",\n              chips: \"\",\n              \"closable-chips\": \"\",\n              density: \"compact\",\n              variant: \"outlined\",\n              \"hide-details\": \"\",\n              hint: \"24h format HH:MM (e.g., 09:00, 14:30)\",\n              \"persistent-hint\": \"\"\n            }, null, 8, [\"modelValue\", \"items\"]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _: 1\n    })\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"mt-2 dtrs-flex-time-box\">\n    <v-col>\n    <v-radio-group\n      v-model=\"allDay\"\n      direction=\"horizontal\"\n      hide-details\n      class=\"mb-2\"\n      >\n      <v-radio\n        label=\"Entire Day\"\n        :value=\"true\"\n      >\n        <template #label=\"{label}\">\n          <div class=\"radio-info-label\">\n          <div>{{ label }}</div>\n          <info-button>\n            <div>\n              <p>\n                TEMPO only collects data during daylight hours. \n                Depending on the time of year, different time ranges will be available on a given day\n              </p>\n            </div>\n          </info-button>\n        </div>\n        </template>\n      </v-radio>\n      <v-radio\n        label=\"Specific Times\"\n        :value=\"false\"\n      >\n        <template #label=\"{label}\">\n          <div class=\"radio-info-label\">\n          <div>{{label}}</div>\n          <info-button>\n            <div>\n              <p>\n                Select the times of day you want to include data for. TEMPO will only collect data during daylight hours.\n                The times you pick will be used for each region and corrected for timezone differences. For example, creating\n                a time range of 9:00-11:00 would pull data from 9:00-11:00 Eastern Time for New York, and 9:00-11:00 Pacific Time for Los Angeles.\n              </p>\n            </div>\n          </info-button>\n          </div>\n        </template>\n      </v-radio>\n    </v-radio-group>\n    <v-combobox\n      v-if=\"!allDay\"\n      v-model=\"selectedTimesRef\"\n      :items=\"timeOptions\"\n      label=\"Add/select times\"\n      multiple\n      chips\n      closable-chips\n      density=\"compact\"\n      variant=\"outlined\"\n      hide-details\n      hint=\"24h format HH:MM (e.g., 09:00, 14:30)\"\n      persistent-hint\n      @update:model-value=\"normalizeTimes\"\n    />\n    <!-- <div v-else class=\"dtrs-all-day-label\">\n      All Times Selected\n    </div> -->\n  </v-col>\n    \n    <!-- <div class=\"pm-wrapper\">\n      <input\n        id=\"dtrs-time-plus-minus\"\n        type=\"checkbox\"\n        v-model=\"timePlusMinus\"\n        :true-value=\"12\"\n        :false-value=\"0.5\"\n      />\n      <label for=\"dtrs-time-plus-minus\">All Day</label>\n    </div> -->\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, watch, computed } from 'vue';\nimport { DEFAULT_TOLERANCE, ALL_DAY_TOLERANCE } from './date_time_range_generators';\nimport { _normalizeTimes } from '@/utils/parse_time_strings';\nimport InfoButton from '@/components/InfoButton.vue';\n\nfunction timeFormat(hour: number, minute: number, ampm = true): string {\n  if (ampm) {\n    // from 24 hour to am/pm\n    const ampm = hour >= 12 ? 'pm' : 'am';\n    const h12 = hour % 12 === 0 ? 12 : hour % 12;\n    if (minute === 0) {\n      return `${h12} ${ampm}`;\n    }\n    return `${h12}:${String(minute).padStart(2, '0')} ${ampm}`;\n  } else {\n    return `${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}`;\n  }\n}\n\nconst selectedTimes = defineModel<string[]>({\n  type: Array as () => string[]\n});\nconst timePlusMinus = defineModel<[number, number]>('timePlusMinus', {\n  type: Array as unknown as () => [number, number],\n  default: () => [...DEFAULT_TOLERANCE]\n});\nconst timeOptions = ref<string[]>(Array.from({ length: 15 }, (_, h) => timeFormat(h + 6, 0, true))); // 6:00 to 20:00\n\nconst allDay = computed({\n  get: () => timePlusMinus.value[0] === ALL_DAY_TOLERANCE[0] && timePlusMinus.value[1] === ALL_DAY_TOLERANCE[1],\n  set: (val: boolean) => {\n    timePlusMinus.value = val ? [...ALL_DAY_TOLERANCE] : [...DEFAULT_TOLERANCE];\n  }\n});\n\nconst _selectedTimesRef = ref<string[]>([]);\nconst selectedTimesRef = computed({\n  get: () => {\n    if (allDay.value) return timeOptions.value;\n    return _selectedTimesRef.value;\n  },\n  set: (value: string[]) => {\n    // console.log('selectedTimesRef set to', value);\n    _selectedTimesRef.value = value;\n  }\n});\n\n\nwatch(selectedTimesRef, (value: string[]) => {\n  // console.log('selectedTimesRef changed to', value);\n  if (allDay.value) {\n    selectedTimes.value = [];\n    return;\n  }\n  selectedTimes.value = value;\n});\n\n// Normalize entered times to HH:MM 24h (flexible entry via copilot)\nfunction normalizeTimes(values: string[]) {\n  const normalized = _normalizeTimes(values, timeFormat);\n  const unique = Array.from(new Set(normalized));\n  selectedTimesRef.value = unique;\n  return unique;\n}\n</script>\n\n<style scoped>\n.dtrs-flex-time-box {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px 10px;\n  align-items: center;\n}\n\n.pm-wrapper {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  flex: 0 0 auto;\n}\n\n.pm-wrapper > span {\n  font-size: 1.2em;\n  line-height: 1;\n}\n\n.radio-info-label {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 6px;\n}\n\n.radio-info-label > div {\n  width: 16ch;\n}\n</style>","import script from \"./SpecificTimesSelector.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./SpecificTimesSelector.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./SpecificTimesSelector.vue?vue&type=style&index=0&id=65e18e7b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-65e18e7b\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = { class: \"timeline-section\" }\nconst _hoisted_2 = { class: \"config-display\" }\nconst _hoisted_3 = { key: 0 }\nconst _hoisted_4 = { class: \"ml-2\" }\nconst _hoisted_5 = { key: 1 }\nconst _hoisted_6 = { class: \"mt-2\" }\nconst _hoisted_7 = { key: 0 }\nconst _hoisted_8 = { key: 1 }\nconst _hoisted_9 = { key: 2 }\nconst _hoisted_10 = { key: 3 }\nconst _hoisted_11 = { key: 4 }\nconst _hoisted_12 = { key: 5 }\nconst _hoisted_13 = {\n  key: 0,\n  class: \"mt-3\"\n}\nconst _hoisted_14 = {\n  key: 1,\n  class: \"mt-3\"\n}\nconst _hoisted_15 = {\n  key: 0,\n  class: \"text-caption error-text\"\n}\nconst _hoisted_16 = { class: \"text-caption mt-1\" }\nconst _hoisted_17 = { class: \"d-flex justify-space-between align-center mb-3\" }\nconst _hoisted_18 = { class: \"text-subtitle-2 font-weight-bold\" }\nconst _hoisted_19 = { class: \"d-flex justify-space-between\" }\nconst _hoisted_20 = { class: \"text-caption\" }\nconst _hoisted_21 = {\n  key: 0,\n  class: \"text-caption error-text mt-1\"\n}\n\nimport { computed } from 'vue';\nimport type { MillisecondRange } from '../types/datetime';\nimport type { TimeRangeConfig } from './date_time_range_generators';\nimport { validateRanges, DEFAULT_TOLERANCE, ALL_DAY_TOLERANCE } from './date_time_range_generators';\n\ninterface ValidationResult {\n  isValid: boolean;\n  errors: string[];\n  badRanges: Set<MillisecondRange>;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'TimelineVisualization',\n  props: {\n    ranges: {},\n    config: {},\n    allowedDates: {}\n  },\n  setup(__props: any) {\n\n// Generated by Copilot\nconst props = __props;\n\nconst validationResults = computed<ValidationResult | null>(() => {\n  if (!props.config) return null;\n  \n  const validation = validateRanges(props.ranges, props.config);\n  \n  return {\n    isValid: validation.valid,\n    errors: validation.errors,\n    badRanges: new Set(validation.badRanges || [])\n  };\n});\n\nfunction formatDate(date: Date): string {\n  return date.toLocaleDateString('en-US', { \n    year: 'numeric', \n    month: 'short', \n    day: 'numeric',\n    timeZone: 'UTC'\n  });\n}\n\nfunction formatDateTime(timestamp: number): string {\n  return new Date(timestamp).toLocaleString(undefined, {\n    day: '2-digit',\n    weekday: 'short',\n    month: '2-digit',\n    year: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: false,\n    timeZone: 'UTC'\n  });\n}\n\nfunction formatDuration(ms: number): string {\n  const hours = Math.floor(ms / (60 * 60 * 1000));\n  const minutes = Math.floor((ms % (60 * 60 * 1000)) / (60 * 1000));\n  const days = Math.floor(hours / 24);\n  \n  if (days > 0) {\n    return `${days}d ${hours % 24}h`;\n  }\n  return `${hours}h ${minutes}m`;\n}\n\nfunction formatTolerance(tolerance: [number, number]): string {\n  const [before, after] = tolerance;\n  \n  // Check if it's all day tolerance\n  if (before === ALL_DAY_TOLERANCE[0] && after === ALL_DAY_TOLERANCE[1]) {\n    return 'All Day';\n  }\n  \n  // Check if it's default tolerance\n  if (before === DEFAULT_TOLERANCE[0] && after === DEFAULT_TOLERANCE[1]) {\n    return `${before}h (default)`;\n  }\n  \n  // Check if it's symmetric\n  if (before === after) {\n    return `${before}h`;\n  }\n  \n  // Asymmetric tolerance\n  return `-${before}h / +${after}h`;\n}\n\nconst countNotAllowedRange = computed(() => {\n  if (!props.allowedDates) return 0;\n  \n  const allowedDateSet = new Set(\n    props.allowedDates.map(d => d.toISOString().split('T')[0])\n  );\n  \n  let count = 0;\n  \n  for (const range of props.ranges) {\n    const startDateStr = new Date(range.start).toISOString().split('T')[0];\n    const endDateStr = new Date(range.end).toISOString().split('T')[0];\n    \n    if (!allowedDateSet.has(startDateStr) || !allowedDateSet.has(endDateStr)) {\n      count += 1;\n    }\n  }\n  \n  return count;\n});\n\nfunction getRangeValidationClass(item: MillisecondRange, _index: number): string {\n  if (!validationResults.value) return '';\n  return validationResults.value.badRanges.has(item) ? 'validation-error' : 'validation-success';\n}\n\nfunction getItemValidationError(item: MillisecondRange, _index: number): string | undefined {\n  if (!validationResults.value || !validationResults.value.badRanges.has(item)) return undefined;\n  return 'This range does not match the configuration filters';\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_chip = _resolveComponent(\"v-chip\")!\n  const _component_v_divider = _resolveComponent(\"v-divider\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_virtual_scroll = _resolveComponent(\"v-virtual-scroll\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (__props.config)\n      ? (_openBlock(), _createBlock(_component_v_card, {\n          key: 0,\n          class: \"pa-3 mb-3\",\n          variant: \"outlined\",\n          color: \"info\"\n        }, {\n          default: _withCtx(() => [\n            _cache[10] || (_cache[10] = _createElementVNode(\"div\", { class: \"text-subtitle-2 font-weight-bold mb-2\" }, \" Configuration Summary \", -1)),\n            _createElementVNode(\"div\", _hoisted_2, [\n              (__props.config.type === 'single')\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                    _createVNode(_component_v_chip, {\n                      size: \"small\",\n                      color: \"primary\"\n                    }, {\n                      default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n                        _createTextVNode(\"Single Date\", -1)\n                      ]))]),\n                      _: 1\n                    }),\n                    _createElementVNode(\"span\", _hoisted_4, _toDisplayString(formatDate(__props.config.singleDate)), 1)\n                  ]))\n                : _createCommentVNode(\"\", true),\n              (__props.config.type === 'multiple')\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                    _createVNode(_component_v_chip, {\n                      size: \"small\",\n                      color: \"primary\"\n                    }, {\n                      default: _withCtx(() => [...(_cache[1] || (_cache[1] = [\n                        _createTextVNode(\"Multiple Dates\", -1)\n                      ]))]),\n                      _: 1\n                    }),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                      (__props.config.dateRange)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"Date Range:\", -1)),\n                            _createTextVNode(\" \" + _toDisplayString(formatDate(__props.config.dateRange.start)) + \" - \" + _toDisplayString(formatDate(__props.config.dateRange.end)), 1)\n                          ]))\n                        : _createCommentVNode(\"\", true),\n                      (__props.config.years)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Years:\", -1)),\n                            _createTextVNode(\" \" + _toDisplayString(__props.config.years.join(', ')), 1)\n                          ]))\n                        : _createCommentVNode(\"\", true),\n                      (__props.config.months)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"Months:\", -1)),\n                            _createTextVNode(\" \" + _toDisplayString(__props.config.months.join(', ')), 1)\n                          ]))\n                        : _createCommentVNode(\"\", true),\n                      (__props.config.weekdays)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                            _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \"Weekdays:\", -1)),\n                            _createTextVNode(\" \" + _toDisplayString(__props.config.weekdays.join(', ')), 1)\n                          ]))\n                        : _createCommentVNode(\"\", true),\n                      (__props.config.times)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                            _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \"Times:\", -1)),\n                            _createTextVNode(\" \" + _toDisplayString(__props.config.times.join(', ')), 1)\n                          ]))\n                        : _createCommentVNode(\"\", true),\n                      (__props.config.toleranceHours)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                            _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \"Tolerance:\", -1)),\n                            _createTextVNode(\" \" + _toDisplayString(formatTolerance(__props.config.toleranceHours)), 1)\n                          ]))\n                        : _createCommentVNode(\"\", true)\n                    ])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            (__props.allowedDates)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                  _createVNode(_component_v_divider, { class: \"my-2\" }),\n                  _cache[8] || (_cache[8] = _createElementVNode(\"div\", { class: \"text-subtitle-2 font-weight-bold mb-2\" }, \" Allowed Dates Check \", -1)),\n                  _createVNode(_component_v_chip, {\n                    color: countNotAllowedRange.value === 0 ? 'success' : 'error',\n                    size: \"small\",\n                    class: \"mb-2\"\n                  }, {\n                    default: _withCtx(() => [\n                      _createTextVNode(_toDisplayString(countNotAllowedRange.value === 0 ? ' All ranges within allowed dates' : ` ${countNotAllowedRange.value} ranges outside allowed dates`), 1)\n                    ]),\n                    _: 1\n                  }, 8, [\"color\"])\n                ]))\n              : _createCommentVNode(\"\", true),\n            (validationResults.value)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                  _createVNode(_component_v_divider, { class: \"my-2\" }),\n                  _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"text-subtitle-2 font-weight-bold mb-2\" }, \" Validation Results \", -1)),\n                  _createVNode(_component_v_chip, {\n                    color: validationResults.value.isValid ? 'success' : 'error',\n                    size: \"small\",\n                    class: \"mb-2\"\n                  }, {\n                    default: _withCtx(() => [\n                      _createTextVNode(_toDisplayString(validationResults.value.isValid ? ' All ranges match config' : ' Validation failed'), 1)\n                    ]),\n                    _: 1\n                  }, 8, [\"color\"]),\n                  (!validationResults.value.isValid)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(validationResults.value.errors, (error) => {\n                          return (_openBlock(), _createElementBlock(\"div\", { key: error }, \"  \" + _toDisplayString(error), 1))\n                        }), 128))\n                      ]))\n                    : _createCommentVNode(\"\", true),\n                  _createElementVNode(\"div\", _hoisted_16, \" Total ranges: \" + _toDisplayString(__props.ranges.length), 1)\n                ]))\n              : _createCommentVNode(\"\", true)\n          ]),\n          _: 1\n        }))\n      : _createCommentVNode(\"\", true),\n    _createVNode(_component_v_card, {\n      class: \"pa-3\",\n      variant: \"tonal\"\n    }, {\n      default: _withCtx(() => [\n        _createElementVNode(\"div\", _hoisted_17, [\n          _createElementVNode(\"span\", _hoisted_18, \" Generated Time Ranges (\" + _toDisplayString(__props.ranges.length) + \") \", 1)\n        ]),\n        _createVNode(_component_v_virtual_scroll, {\n          items: __props.ranges,\n          height: \"300\",\n          \"item-height\": \"80\"\n        }, {\n          default: _withCtx(({ item, index }) => [\n            _createElementVNode(\"div\", {\n              class: _normalizeClass([\"range-item pa-2\", getRangeValidationClass(item, index)])\n            }, [\n              _createElementVNode(\"div\", _hoisted_19, [\n                _createElementVNode(\"span\", null, _toDisplayString(formatDateTime(item.start)) + \" - \" + _toDisplayString(formatDateTime(item.end)), 1),\n                _createElementVNode(\"span\", _hoisted_20, _toDisplayString(formatDuration(item.end - item.start)), 1)\n              ]),\n              (getItemValidationError(item, index))\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, _toDisplayString(getItemValidationError(item, index)), 1))\n                : _createCommentVNode(\"\", true)\n            ], 2)\n          ]),\n          _: 1\n        }, 8, [\"items\"])\n      ]),\n      _: 1\n    })\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"timeline-section\">\n    \n    <!-- Config Verification Display -->\n    <v-card v-if=\"config\" class=\"pa-3 mb-3\" variant=\"outlined\" color=\"info\">\n      <div class=\"text-subtitle-2 font-weight-bold mb-2\">\n        Configuration Summary\n      </div>\n      <div class=\"config-display\">\n        <div v-if=\"config.type === 'single'\">\n          <v-chip size=\"small\" color=\"primary\">Single Date</v-chip>\n          <span class=\"ml-2\">{{ formatDate(config.singleDate) }}</span>\n        </div>\n        <div v-if=\"config.type === 'multiple'\">\n          <v-chip size=\"small\" color=\"primary\">Multiple Dates</v-chip>\n          <div class=\"mt-2\">\n            <div v-if=\"config.dateRange\">\n              <strong>Date Range:</strong> \n              {{ formatDate(config.dateRange.start) }} - {{ formatDate(config.dateRange.end) }}\n            </div>\n            <div v-if=\"config.years\">\n              <strong>Years:</strong> {{ config.years.join(', ') }}\n            </div>\n            <div v-if=\"config.months\">\n              <strong>Months:</strong> {{ config.months.join(', ') }}\n            </div>\n            <div v-if=\"config.weekdays\">\n              <strong>Weekdays:</strong> {{ config.weekdays.join(', ') }}\n            </div>\n            <div v-if=\"config.times\">\n              <strong>Times:</strong> {{ config.times.join(', ') }}\n            </div>\n            <div v-if=\"config.toleranceHours\">\n              <strong>Tolerance:</strong> {{ formatTolerance(config.toleranceHours) }}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Count of ranges in not allowed -->\n      <div v-if=\"allowedDates\" class=\"mt-3\">\n        <v-divider class=\"my-2\" />\n        <div class=\"text-subtitle-2 font-weight-bold mb-2\">\n          Allowed Dates Check\n        </div>\n        <v-chip \n          :color=\"countNotAllowedRange === 0 ? 'success' : 'error'\" \n          size=\"small\"\n          class=\"mb-2\"\n        >\n          {{ countNotAllowedRange === 0 ? ' All ranges within allowed dates' : ` ${countNotAllowedRange} ranges outside allowed dates` }}\n        </v-chip>\n      </div>\n      \n      \n      <!-- Validation Results -->\n      <div v-if=\"validationResults\" class=\"mt-3\">\n        <v-divider class=\"my-2\" />\n        <div class=\"text-subtitle-2 font-weight-bold mb-2\">\n          Validation Results\n        </div>\n        <v-chip \n          :color=\"validationResults.isValid ? 'success' : 'error'\" \n          size=\"small\"\n          class=\"mb-2\"\n        >\n          {{ validationResults.isValid ? ' All ranges match config' : ' Validation failed' }}\n        </v-chip>\n        <div v-if=\"!validationResults.isValid\" class=\"text-caption error-text\">\n          <div v-for=\"error in validationResults.errors\" :key=\"error\">\n             {{ error }}\n          </div>\n        </div>\n        <div class=\"text-caption mt-1\">\n          Total ranges: {{ ranges.length }}\n        </div>\n      </div>\n    </v-card>\n    \n    <!-- Timeline Ranges -->\n    <v-card class=\"pa-3\" variant=\"tonal\">\n      <div class=\"d-flex justify-space-between align-center mb-3\">\n        <span class=\"text-subtitle-2 font-weight-bold\">\n          Generated Time Ranges ({{ ranges.length }})\n        </span>\n      </div>\n\n      <v-virtual-scroll\n        :items=\"ranges\"\n        height=\"300\"\n        item-height=\"80\"\n      >\n        <template v-slot:default=\"{ item, index }\">\n          <div class=\"range-item pa-2\" :class=\"getRangeValidationClass(item, index)\">\n            <div class=\"d-flex justify-space-between\">\n              <span>\n                {{ formatDateTime(item.start) }} - {{ formatDateTime(item.end) }}\n              </span>\n              <span class=\"text-caption\">\n                {{ formatDuration(item.end - item.start) }}\n              </span>\n            </div>\n            <div v-if=\"getItemValidationError(item, index)\" class=\"text-caption error-text mt-1\">\n              {{ getItemValidationError(item, index) }}\n            </div>\n          </div>\n        </template>\n      </v-virtual-scroll>\n    </v-card>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n// Generated by Copilot\nimport { computed } from 'vue';\nimport type { MillisecondRange } from '../types/datetime';\nimport type { TimeRangeConfig } from './date_time_range_generators';\nimport { validateRanges, DEFAULT_TOLERANCE, ALL_DAY_TOLERANCE } from './date_time_range_generators';\n\nconst props = defineProps<{\n  ranges: MillisecondRange[];\n  config?: TimeRangeConfig;\n  allowedDates?: Date[];\n}>();\n\ninterface ValidationResult {\n  isValid: boolean;\n  errors: string[];\n  badRanges: Set<MillisecondRange>;\n}\n\nconst validationResults = computed<ValidationResult | null>(() => {\n  if (!props.config) return null;\n  \n  const validation = validateRanges(props.ranges, props.config);\n  \n  return {\n    isValid: validation.valid,\n    errors: validation.errors,\n    badRanges: new Set(validation.badRanges || [])\n  };\n});\n\nfunction formatDate(date: Date): string {\n  return date.toLocaleDateString('en-US', { \n    year: 'numeric', \n    month: 'short', \n    day: 'numeric',\n    timeZone: 'UTC'\n  });\n}\n\nfunction formatDateTime(timestamp: number): string {\n  return new Date(timestamp).toLocaleString(undefined, {\n    day: '2-digit',\n    weekday: 'short',\n    month: '2-digit',\n    year: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: false,\n    timeZone: 'UTC'\n  });\n}\n\nfunction formatDuration(ms: number): string {\n  const hours = Math.floor(ms / (60 * 60 * 1000));\n  const minutes = Math.floor((ms % (60 * 60 * 1000)) / (60 * 1000));\n  const days = Math.floor(hours / 24);\n  \n  if (days > 0) {\n    return `${days}d ${hours % 24}h`;\n  }\n  return `${hours}h ${minutes}m`;\n}\n\nfunction formatTolerance(tolerance: [number, number]): string {\n  const [before, after] = tolerance;\n  \n  // Check if it's all day tolerance\n  if (before === ALL_DAY_TOLERANCE[0] && after === ALL_DAY_TOLERANCE[1]) {\n    return 'All Day';\n  }\n  \n  // Check if it's default tolerance\n  if (before === DEFAULT_TOLERANCE[0] && after === DEFAULT_TOLERANCE[1]) {\n    return `${before}h (default)`;\n  }\n  \n  // Check if it's symmetric\n  if (before === after) {\n    return `${before}h`;\n  }\n  \n  // Asymmetric tolerance\n  return `-${before}h / +${after}h`;\n}\n\nconst countNotAllowedRange = computed(() => {\n  if (!props.allowedDates) return 0;\n  \n  const allowedDateSet = new Set(\n    props.allowedDates.map(d => d.toISOString().split('T')[0])\n  );\n  \n  let count = 0;\n  \n  for (const range of props.ranges) {\n    const startDateStr = new Date(range.start).toISOString().split('T')[0];\n    const endDateStr = new Date(range.end).toISOString().split('T')[0];\n    \n    if (!allowedDateSet.has(startDateStr) || !allowedDateSet.has(endDateStr)) {\n      count += 1;\n    }\n  }\n  \n  return count;\n});\n\nfunction getRangeValidationClass(item: MillisecondRange, _index: number): string {\n  if (!validationResults.value) return '';\n  return validationResults.value.badRanges.has(item) ? 'validation-error' : 'validation-success';\n}\n\nfunction getItemValidationError(item: MillisecondRange, _index: number): string | undefined {\n  if (!validationResults.value || !validationResults.value.badRanges.has(item)) return undefined;\n  return 'This range does not match the configuration filters';\n}\n</script>\n\n<style scoped>\n.config-display {\n  font-size: 0.875rem;\n}\n\n.range-item {\n  border-left: 3px solid transparent;\n  margin-bottom: 4px;\n  border-radius: 4px;\n}\n\n.validation-success {\n  border-left-color: rgb(var(--v-theme-success));\n  background-color: rgba(var(--v-theme-success), 0.05);\n}\n\n.validation-error {\n  border-left-color: rgb(var(--v-theme-error));\n  background-color: rgba(var(--v-theme-error), 0.05);\n}\n\n.error-text {\n  color: rgb(var(--v-theme-error));\n}\n\n\n</style>\n","import script from \"./TimelineVisualization.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TimelineVisualization.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TimelineVisualization.vue?vue&type=style&index=0&id=e71598f0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e71598f0\"]])\n\nexport default __exports__","import { MillisecondRange } from \"@/types\";\n/**\n * Efficient \"two-pointer\" filtering of time ranges based on allowed timestamps.\n * These methods were suggest by Google Gemini 2.5 Flash\n * \n*/\n\n\n// Helper to convert an allowed Date into a full-day range (00:00:00 to 23:59:59.999)\n// The times we input have the correct UTC days values. \n// Out allowed Dates have the correct Date but start at 0:00 Eastern time, but have the correct Day\n// So we need to create a full-day range in UTC for that date.\nfunction dateToDayRange(date: Date): MillisecondRange {\n  const startUTC = Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getDate(), 0, 0, 0, 0);\n  const start = new Date(startUTC);\n  \n  const endUTC = Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getDate(), 23, 59, 59, 999);\n  const end = new Date(endUTC);\n  \n  return {\n    start: start.getTime(),\n    end: end.getTime(),\n  };\n}\n\n/**\n * Filters a sorted list of time ranges based on ANY overlap with a sorted list of allowed full-day ranges.\n * This is the correct Range-Over-Range Two-Pointer approach for your requirement.\n *\n * @param ranges Must be sorted by 'start'.\n * @param allowedDates Must be sorted chronologically.\n * @returns Filtered MillisecondRange[]\n */\nexport function filterForAllowedDates(\n  ranges: MillisecondRange[],\n  allowedDates: Date[]\n): MillisecondRange[] {\n  if (!allowedDates || allowedDates.length === 0) {\n    return [];\n  }\n\n  const filteredRanges: MillisecondRange[] = [];\n  \n  // O(M) transformation\n  const allowedDayRanges = allowedDates.map(dateToDayRange);\n  \n  let rangeIndex = 0; // Pointer for the input ranges (N)\n  let dayIndex = 0;   // Pointer for the allowed full-day ranges (M)\n  let _rejectedCount = 0;\n\n  while (rangeIndex < ranges.length && dayIndex < allowedDayRanges.length) {\n    const currentRange = ranges[rangeIndex];\n    const currentDayRange = allowedDayRanges[dayIndex];\n\n    // Check for ANY overlap\n    const hasOverlap = currentRange.start <= currentDayRange.end &&\n                       currentRange.end >= currentDayRange.start;\n\n    if (hasOverlap) {\n      // 1. MATCH: The time range is valid.\n      filteredRanges.push(currentRange);\n      // Advance the time range pointer to check the next range.\n      // The current allowed day might validate multiple ranges.\n      rangeIndex++;\n    } else {\n      // 2. NO MATCH: Determine which pointer to advance.\n      \n      // If the current time range ENDS BEFORE the allowed day STARTS, \n      // the time range is too early. Advance the time range pointer.\n      if (currentRange.end < currentDayRange.start) {\n        _rejectedCount++;\n        rangeIndex++;\n      }\n      \n      // If the current time range STARTS AFTER the allowed day ENDS, \n      // the allowed day is too early. Advance the allowed day pointer.\n      else if (currentRange.start > currentDayRange.end) {\n        dayIndex++;\n      }\n      \n      // Note: Due to the 'hasOverlap' check above, one of the two conditions \n      // in the 'else' block must be true if there is no overlap.\n    }\n  }\n  // console.log(`filterForAllowedDates: Rejected ${rejectedCount} ranges/dates.`);\n  return filteredRanges;\n}","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withKeys as _withKeys, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, vShow as _vShow, withDirectives as _withDirectives } from \"vue\"\n\nconst _hoisted_1 = {\n  ref: \"dtrs-root\",\n  class: \"datetime-range-selector my-4\",\n  elevation: \"4\",\n  color: \"surface\"\n}\nconst _hoisted_2 = [\"disabled\"]\nconst _hoisted_3 = {\n  key: 0,\n  class: \"single-date-section\"\n}\nconst _hoisted_4 = { class: \"my-4\" }\nconst _hoisted_5 = [\"disabled\"]\nconst _hoisted_6 = {\n  key: 0,\n  class: \"multiple-dates-section\"\n}\nconst _hoisted_7 = { class: \"ml-4 mb-4 pl-4 dtr-select-by-div\" }\nconst _hoisted_8 = { class: \"mb-4\" }\nconst _hoisted_9 = { class: \"mb-4\" }\nconst _hoisted_10 = { class: \"mb-4\" }\nconst _hoisted_11 = { key: 0 }\nconst _hoisted_12 = { key: 1 }\nconst _hoisted_13 = { key: 2 }\nconst _hoisted_14 = { class: \"mb-4\" }\nconst _hoisted_15 = { class: \"my-4 mx-auto pa-4 dtrs-invalid-config-warning\" }\nconst _hoisted_16 = { class: \"my-4 mx-auto pa-4 dtrs-invalid-config-warning\" }\n\nimport { watch, computed, ref, onMounted, useTemplateRef } from 'vue';\nimport type { MillisecondRange } from '../types/datetime';\nimport DateRangePicker from './DateRangePicker.vue';\nimport DaysPicker from './DaysPicker.vue';\nimport DayPatterns from './DayPatterns.vue';\nimport MonthsPicker from './MonthsPicker.vue';\nimport YearsPicker from './YearsPicker.vue';\nimport DaysPreview from './DaysPreview.vue';\nimport SpecificTimesSelector from './SpecificTimesSelector.vue';\nimport TimelineVisualization from './TimelineVisualization.vue';\nimport { DAYS, MONTHS, generateTimeRanges, DEFAULT_TOLERANCE, ALL_DAY_TOLERANCE } from './date_time_range_generators';\nimport type { TimeRangeConfig, TimeRangeCreationMode, DayType, MonthType, TimeRangeConfigMultiple, TimeRangeConfigSingle } from './date_time_range_generators';\n// === INTERFACES === \n// === PROPS ===\nimport { isRingConsecutive } from '@/utils/array_operations/cyclic';\nimport { filterForAllowedDates } from \"./filter_ranges\";\n\nimport { watchContainerSize } from '@/utils/dom';\n\n\n// === LIFECYCLE HOOKS ===\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DateTimeRangeSelection',\n  props: {\n    currentDate: {},\n    allowedDates: {},\n    validTimes: {},\n    validate: { type: Boolean },\n    enableParceling: { type: Boolean },\n    parcelSizeMs: {}\n  },\n  emits: [\"ranges-change\"],\n  setup(__props: any, { emit: __emit }) {\n\n// no unused vars\n// === IMPORTS ===\nconst props = __props;\n\n// === EMITS ===\nconst emit = __emit;\n\n\n\nconst tab = ref<'daterange' | 'monthrange'>('daterange');\n\n// === COMPOSABLE SETUP ===\n// Create refs for the current date to pass to the composable\nconst currentDateRef = ref(props.currentDate);\n\n// === REFS ===\nconst singleDateCalendar = ref();\n// === PICKER STATE ===\n// Direct date objects for date pickers - no unnecessary timestamp conversion\nconst timeSelectionRadio = ref<TimeRangeCreationMode | 'tracked'>('tracked');\nconst startDateObj = ref<Date | null>(null);\nconst endDateObj = ref<Date | null>(null);\nconst singleDateObj = ref<Date | null>(currentDateRef.value);\n\n\nwatch(() => props.currentDate, (newDate) => {\n  if (timeSelectionRadio.value === 'tracked') {\n    currentDateRef.value = newDate;\n  }\n});\n\n\n\nconst datePickerYearRange = computed<[number, number]>(() => {\n  if (!props.allowedDates || props.allowedDates.length === 0) {\n    return [2023, new Date().getFullYear()];\n  }\n  const minYear = props.allowedDates ? props.allowedDates[0].getFullYear() : 2023;\n  \n  const maxYear = props.allowedDates \n    ? props.allowedDates[props.allowedDates.length - 1].getFullYear() \n    : new Date().getFullYear();\n    \n  return [minYear, maxYear];\n});\n\nconst possibleYears = computed(() => {\n  const dates = props.allowedDates ?? [2024];\n  if (dates.length === 0) return [2023, new Date().getFullYear()];\n  const years = dates.map(d => d.getFullYear());\n  // Deduplicate and sort\n  return [...new Set(years)].sort((a, b) => a - b);\n});\n\n\nfunction formatDateDisplay(date: Date | null): string {  \n  return date?.toLocaleDateString() || '';\n}\n\n\nconst currentDateString = computed((): string => {\n  return currentDateRef.value.toLocaleDateString(undefined, \n    { year:'2-digit', month: 'numeric', day: 'numeric', timeZone: 'UTC' }\n  );\n});\n\nconst timeSelectionMode = ref<TimeRangeCreationMode>('multiple');\nwatch(timeSelectionRadio, (newVal) => {\n  if (newVal === 'tracked') {\n    timeSelectionMode.value = 'single';\n  } else {\n    timeSelectionMode.value = newVal;\n  }\n});\nconst selectedMonths = ref<MonthType[]>([...MONTHS]);\nconst selectedYears = ref<number[]>([...possibleYears.value]);\nconst selectedTimes = ref<string[]>([]);\nconst selectedDays = ref<DayType[]>([...DAYS]);\nconst timePlusMinus = ref<[number, number]>([...ALL_DAY_TOLERANCE]);\nconst allDay = computed(() => timePlusMinus.value[0] === ALL_DAY_TOLERANCE[0] && timePlusMinus.value[1] === ALL_DAY_TOLERANCE[1]);\nconst dayNames = DAYS as unknown as DayType[];\nconst monthNames = MONTHS as unknown as MonthType[];\n\nconst timeRangeStart = computed<Date | null>(() => {\n  if (tab.value === 'monthrange') {\n    // For month range, start from Jan 1 of the earliest selected year and month\n    const year = selectedYears.value.length > 0 ? Math.min(...selectedYears.value) : new Date().getFullYear();\n    const minMonth = selectedMonths.value.reduce((min, month) => {\n      const monthIndex = MONTHS.indexOf(month);\n      return monthIndex < min ? monthIndex : min;\n    }, 11);\n    const month = selectedMonths.value.length > 0 ? minMonth : 0;\n    return new Date(Date.UTC(year, month, 1, 0, 0, 0, 0));\n  }\n  if (!startDateObj.value) return null;\n  const utc = Date.UTC(\n    startDateObj.value.getUTCFullYear(), \n    startDateObj.value.getUTCMonth(),\n    startDateObj.value.getDate(),\n    0, 0, 0, 0\n  );\n  return new Date(utc);\n});\n\nconst timeRangeEnd = computed<Date | null>(() => {\n  if (tab.value === 'monthrange') {\n    // For month range, end at Dec 31 of the latest selected year and month\n    const year = selectedYears.value.length > 0 ? Math.max(...selectedYears.value) : new Date().getFullYear();\n    const maxMonth = selectedMonths.value.reduce((max, month) => {\n      const monthIndex = MONTHS.indexOf(month);\n      return monthIndex > max ? monthIndex : max;\n    }, 0);\n    const month = selectedMonths.value.length > 0 ? maxMonth : 11;\n    // Get last day of month\n    const lastDay = new Date(Date.UTC(year, month + 1, 0)).getUTCDate();\n    return new Date(Date.UTC(year, month, lastDay, 23, 59, 59, 999));\n  }\n  if (!endDateObj.value) return null;\n  const utc = Date.UTC(\n    endDateObj.value.getUTCFullYear(), \n    endDateObj.value.getUTCMonth(),\n    endDateObj.value.getDate(),\n    23, 59, 59, 999\n  );\n  return new Date(utc);\n});\n\nconst timeRangeSelectedMonths = computed<MonthType[] | undefined>(() => {\n  if (tab.value === 'monthrange') {\n    if (selectedMonths.value.length === MONTHS.length) {\n      return undefined;\n    }\n    return selectedMonths.value;\n  }\n  return undefined;\n});\n\nconst timeRangeSelectedYears = computed<number[] | undefined>(() => {\n  if (tab.value === 'monthrange') {\n    if (selectedYears.value.length === possibleYears.value.length) {\n      return undefined;\n    }\n    return selectedYears.value;\n  }\n  return undefined;\n});\n\nconst timeRangeConfig = computed<TimeRangeConfig>(() => {\n  if (timeSelectionRadio.value === 'single' || timeSelectionRadio.value === 'tracked') {\n    return {\n      type: 'single',\n      singleDate: timeSelectionRadio.value === 'tracked'? currentDateRef.value : singleDateObj.value,\n    } as TimeRangeConfigSingle;\n  } else {\n    const patternConfig: TimeRangeConfigMultiple = {\n      type: 'multiple',\n      dateRange: {\n        start: timeRangeStart.value ?? new Date(),\n        end: timeRangeEnd.value ?? new Date(),\n      },\n      // years needs to send undefined for all years selected\n      years: timeRangeSelectedYears.value,\n      // months: (selectedMonths.value.length === 0 || allMonthsSelected.value) ? undefined : selectedMonths.value,\n      // weekdays: (selectedDays.value.length === 0 || allDaysSelected.value) ? undefined : selectedDays.value,\n      // times: ((selectedTimes.value.length > 0) && !allDay.value) ? selectedTimes.value : undefined,\n      months: timeRangeSelectedMonths.value,\n      weekdays: selectedDays.value.length === DAYS.length ? undefined : selectedDays.value,\n      times: allDay.value ? undefined : selectedTimes.value,\n      toleranceHours: allDay.value ? [...ALL_DAY_TOLERANCE] : [...DEFAULT_TOLERANCE],\n      parcel: props.enableParceling ?? false,\n      parcelSize: props.parcelSizeMs,\n    };\n    return patternConfig as TimeRangeConfig;\n  }\n});\n\nconst invalidConfig = computed<boolean>(() => {\n  const config = timeRangeConfig.value;\n  if (config.type === 'single') {\n    return config.singleDate === null;\n  } else {\n    if (config.years !== undefined && config.years.length === 0) {\n      return true;\n    }\n    if (config.months !== undefined && config.months.length === 0) {\n      return true;\n    }\n    if (config.weekdays !== undefined && config.weekdays.length === 0) {\n      return true;\n    } \n    if (config.times !== undefined && config.times.length === 0) {\n      return true;\n    }\n  }\n  return false;\n});\n\n\nfunction asRangeOrList<T extends string>(arr: T[], order: T[]): string {\n  if (arr.length === 0) return '';  \n  if (arr.length <= 2) {\n    return arr.map(s => s.slice(0,3)).join(', ');\n  }\n  const sortedArrr = arr.slice().sort((a, b) => order.indexOf(a) - order.indexOf(b));\n  const isConsecutive = isRingConsecutive(sortedArrr,  order, true);\n  if (isConsecutive.consecutive && sortedArrr.length > 2) {\n    return `${isConsecutive.start.slice(0,3)}-${isConsecutive.end.slice(0,3)}`;\n  }\n  return arr.map(s => s.slice(0,3)).join(', ');\n}\n  \n\nconst customTimeRangeName = computed((): string => {\n  \n  if (timeSelectionMode.value === 'single') {\n    return `${singleDateObj.value ? formatDateDisplay(singleDateObj.value) : 'No date selected'}`;\n  }\n    \n  let dateRangeString = '';\n  let monthsString = '';\n  let yearsString = '';\n  let daysString = '';\n  let timesString = '';\n  if (startDateObj.value && endDateObj.value) {\n    dateRangeString = `${formatDateDisplay(startDateObj.value)} - ${formatDateDisplay(endDateObj.value)}`;\n  } else {\n    // we shouldn't be able to reach this, so just throw an error\n    throw new Error('Start date or end date is null');\n  }\n  \n  if (selectedMonths.value.length > 0) {\n    monthsString = `Months: ${asRangeOrList(selectedMonths.value, monthNames)}`;\n  }\n  if (selectedYears.value.length > 0) {\n    yearsString = `Years: ${selectedYears.value.join(', ')}`;\n  }\n  if (selectedDays.value.length > 0) {\n    daysString = `${asRangeOrList(selectedDays.value, dayNames)}`;\n  }\n  if (selectedTimes.value.length > 0 && !allDay.value) {\n    timesString = `Times: ${selectedTimes.value.join(', ')}`;\n  }\n  if (tab.value === 'monthrange') {\n    // For monthrange tab, omit date range string\n    dateRangeString = '';\n  }\n  if (tab.value === 'daterange') {\n    // For daterange tab, omit months and years string\n    monthsString = '';\n    yearsString = '';\n  }\n  \n  return [dateRangeString, monthsString, yearsString, daysString, timesString]\n    .filter(s => s !== '')\n    .join(' | ');\n    \n});\n\nconst currentTimeRanges = ref<MillisecondRange[]>([]);\nconst submissionTried = ref<boolean>(false);\n// === METHODS ===\n// Update custom range button handler\nfunction updateCustomRange(doEmit=true) {\n  let currentRanges: MillisecondRange[] = [];\n  currentRanges = generateTimeRanges(timeRangeConfig.value, doEmit);\n  \n  // Filter ranges to only include those with allowed dates\n  if (props.allowedDates && props.allowedDates.length > 0) {\n    currentRanges = filterForAllowedDates(currentRanges, props.allowedDates);\n  }\n  \n  currentTimeRanges.value = currentRanges;\n  submissionTried.value = doEmit;\n  if (doEmit) {\n    emit('ranges-change', currentRanges, timeSelectionMode.value, customTimeRangeName.value, timeRangeConfig.value);\n  }\n}\n\nwatch(timeRangeConfig, () => {\n  if (props.validTimes) updateCustomRange(false);\n}, { immediate: true, deep: true });\n\nfunction handleSingleDateChange(value: Date) {\n  if (value && value.getTime() !== singleDateObj.value?.getTime()) {\n    singleDateObj.value = value;\n    singleDateCalendar.value?.closeMenu();\n  }\n}\n\nconst dtrsRoot = useTemplateRef('dtrs-root');\nconst containerSize = ref<{width: number; height: number}>({width: 0, height: 0});\nonMounted(() => {\n  if (dtrsRoot.value) {\n    // console.log(dtrsRoot.value);\n    watchContainerSize(dtrsRoot.value as HTMLElement, \".panel\", (size) => {\n      containerSize.value = size;\n    });\n  }\n  // Initialize default dates\n  if (props.allowedDates && props.allowedDates.length > 0) {\n    const end = new Date(props.allowedDates[props.allowedDates.length - 1]);\n    const start = new Date(end);\n    // set back by 1 week\n    start.setDate(end.getDate() - 6);\n    startDateObj.value = start;\n    endDateObj.value = end;\n  }\n});\n// watch(glContainerSize, (newSize) => {\n//   console.log('DTRS Golden Layout container size changed:', newSize);\n// });\n// === WATCHERS ===\n// Watch for prop changes and update refs\nwatch(() => props.currentDate, (newDate) => {\n  currentDateRef.value = newDate;\n});\n\n\n\n// Ranges are now only emitted when the Update Custom Range button is clicked\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_radio = _resolveComponent(\"v-radio\")!\n  const _component_date_picker = _resolveComponent(\"date-picker\")!\n  const _component_v_expand_transition = _resolveComponent(\"v-expand-transition\")!\n  const _component_v_radio_group = _resolveComponent(\"v-radio-group\")!\n  const _component_v_tabs_window_item = _resolveComponent(\"v-tabs-window-item\")!\n  const _component_v_tabs_window = _resolveComponent(\"v-tabs-window\")!\n  const _component_v_expansion_panel_title = _resolveComponent(\"v-expansion-panel-title\")!\n  const _component_v_expansion_panel_text = _resolveComponent(\"v-expansion-panel-text\")!\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\")!\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _cache[25] || (_cache[25] = _createElementVNode(\"h4\", null, \"Select Date(s)\", -1)),\n    _createVNode(_component_v_radio_group, {\n      modelValue: timeSelectionRadio.value,\n      \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((timeSelectionRadio).value = $event)),\n      class: \"mb-4\",\n      direction: \"horizontal\",\n      density: \"comfortable\",\n      \"hide-details\": \"\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_radio, {\n          label: `Date Shown On Map: ${currentDateString.value}`,\n          value: \"tracked\"\n        }, null, 8, [\"label\"]),\n        _createVNode(_component_v_radio, {\n          label: \"1 Day\",\n          value: \"single\"\n        }, {\n          label: _withCtx(() => [\n            _cache[16] || (_cache[16] = _createElementVNode(\"span\", {\n              class: \"mr-2\",\n              style: {\"text-wrap\":\"nowrap\"}\n            }, \"Single Day\", -1)),\n            (timeSelectionRadio.value === 'single' && containerSize.value.width > 450)\n              ? (_openBlock(), _createBlock(_component_date_picker, {\n                  key: 0,\n                  class: \"mx-2 cds__date-picker\",\n                  ref_key: \"singleDateCalendar\",\n                  ref: singleDateCalendar,\n                  \"model-value\": singleDateObj.value,\n                  onInternalModelChange: handleSingleDateChange,\n                  \"allowed-dates\": __props.allowedDates,\n                  formats: {input: formatDateDisplay, preview: formatDateDisplay},\n                  \"input-atters\": { clearable: false },\n                  teleport: true,\n                  dark: \"\",\n                  \"year-range\": datePickerYearRange.value,\n                  \"week-start\": 0,\n                  \"six-weeks\": \"\",\n                  \"time-config\": { enableTimePicker: false }\n                }, {\n                  \"action-buttons\": _withCtx(() => [\n                    _createElementVNode(\"button\", {\n                      class: \"dp__action_button dp__action-latest\",\n                      onClick: _cache[0] || (_cache[0] = () => __props.allowedDates ? handleSingleDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null),\n                      onKeyup: _cache[1] || (_cache[1] = _withKeys(() => __props.allowedDates ? handleSingleDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null, [\"enter\"])),\n                      disabled: !__props.allowedDates,\n                      elevation: \"0\",\n                      size: \"sm\"\n                    }, \" Latest \", 40, _hoisted_2)\n                  ]),\n                  _: 1\n                }, 8, [\"model-value\", \"allowed-dates\", \"formats\", \"year-range\"]))\n              : _createCommentVNode(\"\", true)\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_v_expand_transition, { title: \"Select a Single Date\" }, {\n          default: _withCtx(() => [\n            (timeSelectionRadio.value === 'single' && containerSize.value.width <= 450)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                  _createElementVNode(\"div\", _hoisted_4, [\n                    _createVNode(_component_date_picker, {\n                      class: \"mx-2 cds__date-picker\",\n                      ref_key: \"singleDateCalendar\",\n                      ref: singleDateCalendar,\n                      \"model-value\": singleDateObj.value,\n                      onInternalModelChange: handleSingleDateChange,\n                      \"allowed-dates\": __props.allowedDates,\n                      formats: {input: formatDateDisplay, preview: formatDateDisplay},\n                      \"input-atters\": { clearable: false },\n                      teleport: true,\n                      dark: \"\",\n                      \"year-range\": datePickerYearRange.value,\n                      \"week-start\": 0,\n                      \"six-weeks\": \"\",\n                      \"time-config\": { enableTimePicker: false }\n                    }, {\n                      \"action-buttons\": _withCtx(() => [\n                        _createElementVNode(\"button\", {\n                          class: \"dp__action_button dp__action-latest\",\n                          onClick: _cache[2] || (_cache[2] = () => __props.allowedDates ? handleSingleDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null),\n                          onKeyup: _cache[3] || (_cache[3] = _withKeys(() => __props.allowedDates ? handleSingleDateChange(__props.allowedDates[__props.allowedDates.length - 1]) : null, [\"enter\"])),\n                          disabled: !__props.allowedDates,\n                          elevation: \"0\",\n                          size: \"sm\"\n                        }, \" Latest \", 40, _hoisted_5)\n                      ]),\n                      _: 1\n                    }, 8, [\"model-value\", \"allowed-dates\", \"formats\", \"year-range\"])\n                  ])\n                ]))\n              : _createCommentVNode(\"\", true)\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_v_radio, {\n          label: \"More than 1 Day\",\n          value: \"multiple\"\n        })\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createVNode(_component_v_expand_transition, { title: \"Select Multiple Dates\" }, {\n      default: _withCtx(() => [\n        (timeSelectionRadio.value === 'multiple')\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createVNode(_component_v_radio_group, {\n                  id: \"dtr-select-by-group\",\n                  modelValue: tab.value,\n                  \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((tab).value = $event)),\n                  mandatory: \"\",\n                  label: \"Select days by\"\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_v_radio, {\n                      class: \"daterange-btn\",\n                      value: \"daterange\",\n                      label: \"Date Range\"\n                    }),\n                    _createVNode(_component_v_radio, {\n                      class: \"monthrange-btn\",\n                      value: \"monthrange\",\n                      label: \"Month / Year\"\n                    })\n                  ]),\n                  _: 1\n                }, 8, [\"modelValue\"]),\n                _createVNode(_component_v_tabs_window, {\n                  modelValue: tab.value,\n                  \"onUpdate:modelValue\": _cache[10] || (_cache[10] = ($event: any) => ((tab).value = $event)),\n                  crossfade: \"\"\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_v_tabs_window_item, {\n                      \"selected-class\": \"dtrs-tab-window-selected\",\n                      class: \"dtrs-tab-window\",\n                      value: \"daterange\"\n                    }, {\n                      default: _withCtx(() => [\n                        _createVNode(DateRangePicker, {\n                          \"start-date\": startDateObj.value,\n                          \"onUpdate:startDate\": _cache[6] || (_cache[6] = ($event: any) => ((startDateObj).value = $event)),\n                          \"end-date\": endDateObj.value,\n                          \"onUpdate:endDate\": _cache[7] || (_cache[7] = ($event: any) => ((endDateObj).value = $event)),\n                          \"allowed-dates\": __props.allowedDates,\n                          \"format-function\": formatDateDisplay,\n                          clearable: false,\n                          \"text-input\": false,\n                          teleport: true,\n                          dark: true,\n                          \"year-range\": datePickerYearRange.value\n                        }, null, 8, [\"start-date\", \"end-date\", \"allowed-dates\", \"year-range\"])\n                      ]),\n                      _: 1\n                    }),\n                    _createVNode(_component_v_tabs_window_item, {\n                      \"selected-class\": \"dtrs-tab-window-selected\",\n                      class: \"dtrs-tab-window\",\n                      value: \"monthrange\"\n                    }, {\n                      default: _withCtx(() => [\n                        _createElementVNode(\"div\", _hoisted_8, [\n                          _createVNode(YearsPicker, {\n                            modelValue: selectedYears.value,\n                            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((selectedYears).value = $event)),\n                            \"possible-years\": possibleYears.value,\n                            \"show-error-for-empty\": \"\"\n                          }, null, 8, [\"modelValue\", \"possible-years\"])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_9, [\n                          _createVNode(MonthsPicker, {\n                            modelValue: selectedMonths.value,\n                            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((selectedMonths).value = $event)),\n                            \"show-error-for-empty\": \"\"\n                          }, null, 8, [\"modelValue\"])\n                        ])\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                }, 8, [\"modelValue\"]),\n                _createVNode(_component_v_expansion_panels, {\n                  class: \"mb-2\",\n                  variant: \"default\",\n                  focusable: \"\",\n                  color: \"var(--info-background)\",\n                  \"expand-icon\": \"mdi-filter-menu\",\n                  \"collapse-icon\": \"mdi-chevron-up\"\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_v_expansion_panel, {\n                      value: \"filter-days\",\n                      \"bg-color\": \"surface\"\n                    }, {\n                      default: _withCtx(() => [\n                        _createVNode(_component_v_expansion_panel_title, { class: \"d-flex flex-wrap ga-2\" }, {\n                          default: _withCtx(() => [\n                            _cache[17] || (_cache[17] = _createElementVNode(\"div\", null, \"Filter Days: \", -1)),\n                            _createElementVNode(\"div\", null, [\n                              _createVNode(DaysPreview, { days: selectedDays.value }, null, 8, [\"days\"])\n                            ])\n                          ]),\n                          _: 1\n                        }),\n                        _createVNode(_component_v_expansion_panel_text, { class: \"pattern-section\" }, {\n                          default: _withCtx(() => [\n                            _createElementVNode(\"div\", _hoisted_10, [\n                              _createVNode(DaysPicker, {\n                                modelValue: selectedDays.value,\n                                \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((selectedDays).value = $event)),\n                                \"show-error-for-empty\": \"\"\n                              }, null, 8, [\"modelValue\"])\n                            ]),\n                            _createVNode(DayPatterns, {\n                              modelValue: selectedDays.value,\n                              \"onUpdate:modelValue\": _cache[12] || (_cache[12] = ($event: any) => ((selectedDays).value = $event))\n                            }, null, 8, [\"modelValue\"])\n                          ]),\n                          _: 1\n                        })\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_component_v_expansion_panels, {\n                  class: \"mb-4\",\n                  variant: \"default\",\n                  focusable: \"\",\n                  color: \"var(--info-background)\",\n                  \"expand-icon\": \"mdi-filter-menu\",\n                  \"collapse-icon\": \"mdi-chevron-up\"\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_v_expansion_panel, {\n                      value: \"filter-times\",\n                      \"bg-color\": \"surface\"\n                    }, {\n                      default: _withCtx(() => [\n                        _createVNode(_component_v_expansion_panel_title, { class: \"d-flex flex-wrap ga-2\" }, {\n                          default: _withCtx(() => [\n                            _cache[20] || (_cache[20] = _createElementVNode(\"div\", null, \"Filter Times: \", -1)),\n                            _createElementVNode(\"div\", null, [\n                              _cache[18] || (_cache[18] = _createTextVNode(\" (\", -1)),\n                              (allDay.value)\n                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_11, \"All Day\"))\n                                : (selectedTimes.value.length === 0)\n                                  ? (_openBlock(), _createElementBlock(\"span\", _hoisted_12, \"No Times Selected\"))\n                                  : (_openBlock(), _createElementBlock(\"span\", _hoisted_13, _toDisplayString(selectedTimes.value.join(',')), 1)),\n                              _cache[19] || (_cache[19] = _createTextVNode(\") \", -1))\n                            ])\n                          ]),\n                          _: 1\n                        }),\n                        _createVNode(_component_v_expansion_panel_text, { class: \"pattern-section\" }, {\n                          default: _withCtx(() => [\n                            _createElementVNode(\"div\", _hoisted_14, [\n                              _createVNode(SpecificTimesSelector, {\n                                modelValue: selectedTimes.value,\n                                \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event: any) => ((selectedTimes).value = $event)),\n                                timePlusMinus: timePlusMinus.value,\n                                \"onUpdate:timePlusMinus\": _cache[14] || (_cache[14] = ($event: any) => ((timePlusMinus).value = $event))\n                              }, null, 8, [\"modelValue\", \"timePlusMinus\"])\n                            ])\n                          ]),\n                          _: 1\n                        })\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                })\n              ])\n            ]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_v_btn, {\n      color: \"primary\",\n      disabled: invalidConfig.value,\n      variant: \"elevated\",\n      class: \"mb-4 mx-auto d-block\",\n      onClick: updateCustomRange\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_icon, { class: \"mr-2\" }, {\n          default: _withCtx(() => [...(_cache[21] || (_cache[21] = [\n            _createTextVNode(\"mdi-update\", -1)\n          ]))]),\n          _: 1\n        }),\n        _cache[22] || (_cache[22] = _createTextVNode(\" Confirm Selection \", -1))\n      ]),\n      _: 1\n    }, 8, [\"disabled\"]),\n    _withDirectives(_createElementVNode(\"div\", _hoisted_15, \" The current time range selections are invalid and result in no possible times. Please adjust your selections. \", 512), [\n      [_vShow, invalidConfig.value]\n    ]),\n    _withDirectives(_createElementVNode(\"div\", _hoisted_16, \" There is no TEMPO data available for the time range selected. Please adjust your selections. \", 512), [\n      [_vShow, submissionTried.value && currentTimeRanges.value.length===0]\n    ]),\n    (__props.validate)\n      ? (_openBlock(), _createBlock(_component_v_btn, {\n          key: 0,\n          color: \"info\",\n          variant: \"outlined\",\n          class: \"mb-4 mx-4\",\n          onClick: _cache[15] || (_cache[15] = () =>updateCustomRange(false))\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_icon, { class: \"mr-2\" }, {\n              default: _withCtx(() => [...(_cache[23] || (_cache[23] = [\n                _createTextVNode(\"mdi-help-circle\", -1)\n              ]))]),\n              _: 1\n            }),\n            _cache[24] || (_cache[24] = _createTextVNode(\" Validate Time Range \", -1))\n          ]),\n          _: 1\n        }))\n      : _createCommentVNode(\"\", true),\n    (__props.validate)\n      ? (_openBlock(), _createBlock(TimelineVisualization, {\n          key: 1,\n          ranges: currentTimeRanges.value,\n          config: timeRangeConfig.value,\n          \"allowed-dates\": __props.allowedDates\n        }, null, 8, [\"ranges\", \"config\", \"allowed-dates\"]))\n      : _createCommentVNode(\"\", true)\n  ], 512))\n}\n}\n\n})","<template>\n  <div ref=\"dtrs-root\" class=\"datetime-range-selector my-4\" elevation=\"4\" color=\"surface\">\n    <h4>Select Date(s)</h4>\n\n      <!-- Selection Type Radio Buttons -->\n      <v-radio-group \n        v-model=\"timeSelectionRadio\" \n        class=\"mb-4\"\n        direction=\"horizontal\" \n        density=\"comfortable\"\n        hide-details\n      >\n        <v-radio \n          :label=\"`Date Shown On Map: ${currentDateString}`\" \n            value=\"tracked\"\n        />    \n        <v-radio \n          label=\"1 Day\" \n            value=\"single\"\n        >    \n        <template #label>\n          <span class=\"mr-2\" style=\"text-wrap:nowrap\">Single Day</span>\n          <date-picker\n                v-if=\"timeSelectionRadio === 'single' && containerSize.width > 450\"\n                class=\"mx-2 cds__date-picker\"\n                ref=\"singleDateCalendar\"\n                :model-value=\"singleDateObj\"\n                @internal-model-change=\"handleSingleDateChange\"\n                :allowed-dates=\"allowedDates\"\n                :formats=\"{input: formatDateDisplay, preview: formatDateDisplay}\"\n                :input-atters=\"{ clearable: false }\"\n                :teleport=\"true\"\n                dark\n                :year-range=\"datePickerYearRange\"\n                :week-start=\"0\"\n                six-weeks\n                :time-config=\"{ enableTimePicker: false }\"\n              >\n              <template #action-buttons>\n                <button\n                  class=\"dp__action_button dp__action-latest\"\n                  @click=\"() => allowedDates ? handleSingleDateChange(allowedDates[allowedDates.length - 1]) : null\"\n                  @keyup.enter=\"() => allowedDates ? handleSingleDateChange(allowedDates[allowedDates.length - 1]) : null\"\n                  :disabled=\"!allowedDates\"\n                  elevation=\"0\"\n                  size=\"sm\"\n                >\n                  Latest\n                </button>\n              </template>\n          </date-picker>\n        </template>\n      </v-radio>\n        <v-expand-transition title=\"Select a Single Date\">\n        <div v-if=\"timeSelectionRadio === 'single' && containerSize.width <= 450\" class=\"single-date-section\">\n            <div class=\"my-4\">\n              <date-picker\n                class=\"mx-2 cds__date-picker\"\n                ref=\"singleDateCalendar\"\n                :model-value=\"singleDateObj\"\n                @internal-model-change=\"handleSingleDateChange\"\n                :allowed-dates=\"allowedDates\"\n                :formats=\"{input: formatDateDisplay, preview: formatDateDisplay}\"\n                :input-atters=\"{ clearable: false }\"\n                :teleport=\"true\"\n                dark\n                :year-range=\"datePickerYearRange\"\n                :week-start=\"0\"\n                six-weeks\n                :time-config=\"{ enableTimePicker: false }\"\n              >\n              <template #action-buttons>\n                <button\n                  class=\"dp__action_button dp__action-latest\"\n                  @click=\"() => allowedDates ? handleSingleDateChange(allowedDates[allowedDates.length - 1]) : null\"\n                  @keyup.enter=\"() => allowedDates ? handleSingleDateChange(allowedDates[allowedDates.length - 1]) : null\"\n                  :disabled=\"!allowedDates\"\n                  elevation=\"0\"\n                  size=\"sm\"\n                >\n                  Latest\n                </button>\n              </template>\n          </date-picker>\n            </div>\n          </div>\n        </v-expand-transition>\n\n        <v-radio \n          label=\"More than 1 Day\" \n          value=\"multiple\"\n        />\n      </v-radio-group>\n\n        \n\n        <v-expand-transition title=\"Select Multiple Dates\">\n          <div v-if=\"timeSelectionRadio === 'multiple'\" class=\"multiple-dates-section\">\n            <!-- <v-tabs\n              v-if=\"glContainerSize.width >= 500\"\n              v-model=\"tab\"\n              id=\"dtrs-tabs\"\n              color=\"var(--info-background)\"\n              density=\"comfortable\"\n              >\n              <v-tab \n                :variant=\"tab == 'daterange' ? 'flat' : 'tonal'\" \n                value=\"daterange\">Custom Range</v-tab>\n              <v-tab \n              :variant=\"tab == 'monthrange' ? 'flat' : 'tonal'\" \n              value=\"monthrange\">Quick Select</v-tab>\n            </v-tabs> -->\n            \n            <div class=\"ml-4 mb-4 pl-4 dtr-select-by-div\">\n              <v-radio-group\n                id=\"dtr-select-by-group\"\n                v-model=\"tab\"\n                mandatory\n                label=\"Select days by\"\n              >\n                <v-radio \n                  class=\"daterange-btn\"\n                  value=\"daterange\" \n                  label=\"Date Range\"\n                >\n                </v-radio>\n                <v-radio \n                  class=\"monthrange-btn\"\n                  value=\"monthrange\" \n                  label=\"Month / Year\"\n                >\n                  \n                </v-radio>\n              </v-radio-group>\n            \n            \n            <v-tabs-window\n              v-model=\"tab\"\n              crossfade\n              >\n              <v-tabs-window-item \n              selected-class=\"dtrs-tab-window-selected\" \n              class=\"dtrs-tab-window\" \n              value=\"daterange\">\n                <DateRangePicker\n                  v-model:start-date=\"startDateObj\"\n                  v-model:end-date=\"endDateObj\"\n                  :allowed-dates=\"allowedDates\"\n                  :format-function=\"formatDateDisplay\"\n                  :clearable=\"false\"\n                  :text-input=\"false\"\n                  :teleport=\"true\"\n                  :dark=\"true\"\n                  :year-range=\"datePickerYearRange\"\n                />\n              </v-tabs-window-item>\n              <v-tabs-window-item \n              selected-class=\"dtrs-tab-window-selected\" \n              class=\"dtrs-tab-window\" \n              value=\"monthrange\">\n              \n                <div class=\"mb-4\">\n                  <YearsPicker\n                    v-model=\"selectedYears\"\n                    :possible-years=\"possibleYears\"\n                    show-error-for-empty\n                  />\n                </div>\n                \n                <div class=\"mb-4\">\n                  <MonthsPicker\n                    v-model=\"selectedMonths\"\n                    show-error-for-empty\n                  />\n                </div>\n                \n              </v-tabs-window-item>\n            </v-tabs-window>\n                \n            \n            \n            <!-- Pattern Section (Multi-day) -->\n            <v-expansion-panels \n              class=\"mb-2\"\n              variant=\"default\"\n              focusable\n              color=\"var(--info-background)\"\n              expand-icon=\"mdi-filter-menu\"\n              collapse-icon=\"mdi-chevron-up\"\n            >\n              <v-expansion-panel \n                value=\"filter-days\" \n                bg-color=\"surface\"\n              >\n                <v-expansion-panel-title class=\"d-flex flex-wrap ga-2\">\n                  <div>Filter Days: </div>\n                  <div><DaysPreview :days=\"selectedDays\" /></div>\n                </v-expansion-panel-title>\n                <v-expansion-panel-text  class=\"pattern-section\">\n                  <div class=\"mb-4\">\n                    <DaysPicker\n                      v-model=\"selectedDays\"\n                      show-error-for-empty\n                    />\n                  </div>\n                    <DayPatterns\n                      v-model=\"selectedDays\"\n                    />\n                </v-expansion-panel-text>\n              </v-expansion-panel>\n            </v-expansion-panels>\n            \n            <!-- Pattern Section (Multi-time) -->\n            <v-expansion-panels \n              class=\"mb-4\"\n              variant=\"default\"\n              focusable \n              color=\"var(--info-background)\"\n              expand-icon=\"mdi-filter-menu\"\n              collapse-icon=\"mdi-chevron-up\"\n            >\n              <v-expansion-panel \n                value=\"filter-times\" \n                bg-color=\"surface\"\n              >\n                <v-expansion-panel-title class=\"d-flex flex-wrap ga-2\">\n                  <div>Filter Times: </div>\n                  <div>\n                    (<span v-if=\"allDay\">All Day</span>\n                    <span v-else-if=\"selectedTimes.length === 0\">No Times Selected</span>\n                    <span v-else>{{selectedTimes.join(',')}}</span>)\n                  </div>\n                </v-expansion-panel-title>\n                <v-expansion-panel-text  class=\"pattern-section\">\n                  <!-- Times Multi-select -->\n                  <div class=\"mb-4\">\n                    <SpecificTimesSelector\n                      v-model=\"selectedTimes\"\n                      v-model:timePlusMinus=\"timePlusMinus\"\n                    />\n                  </div>\n                </v-expansion-panel-text>\n              </v-expansion-panel>\n            </v-expansion-panels>\n            </div>\n          </div>\n      </v-expand-transition>\n\n\n      <!-- Update Custom Range Button -->\n      <v-btn\n        color=\"primary\"\n        :disabled=\"invalidConfig\"\n        variant=\"elevated\"\n        class=\"mb-4 mx-auto d-block\"\n        @click=\"updateCustomRange\"\n      >\n        <v-icon class=\"mr-2\">mdi-update</v-icon>\n        Confirm Selection \n      </v-btn>\n      <div v-show=\"invalidConfig\" class=\"my-4 mx-auto pa-4 dtrs-invalid-config-warning\">\n        The current time range selections are invalid and result in no possible times. Please adjust your selections.\n      </div>\n      <div v-show=\"submissionTried && currentTimeRanges.length===0\" class=\"my-4 mx-auto pa-4 dtrs-invalid-config-warning\">\n        <!-- This should be incredibly rare to see except for contrived cases. \n        Ex: Select 8/7/2024 - 8/22/2024 and remove Wed/Thu and select a specific time -->\n        There is no TEMPO data available for the time range selected. Please adjust your selections. \n      </div>\n\n\n    <!-- validate time range button -->\n    <v-btn\n      v-if=\"validate\"\n      color=\"info\"\n      variant=\"outlined\"\n      class=\"mb-4 mx-4\"\n      @click=\"() =>updateCustomRange(false)\"\n    >\n      <v-icon class=\"mr-2\">mdi-help-circle</v-icon>\n      Validate Time Range\n    </v-btn>  \n    <TimelineVisualization\n      v-if=\"validate\"\n      :ranges=\"currentTimeRanges\"\n      :config=\"timeRangeConfig\"\n      :allowed-dates=\"allowedDates\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n// no unused vars\n// === IMPORTS ===\nimport { watch, computed, ref, onMounted, useTemplateRef } from 'vue';\nimport type { MillisecondRange } from '../types/datetime';\nimport DateRangePicker from './DateRangePicker.vue';\nimport DaysPicker from './DaysPicker.vue';\nimport DayPatterns from './DayPatterns.vue';\nimport MonthsPicker from './MonthsPicker.vue';\nimport YearsPicker from './YearsPicker.vue';\nimport DaysPreview from './DaysPreview.vue';\nimport SpecificTimesSelector from './SpecificTimesSelector.vue';\nimport TimelineVisualization from './TimelineVisualization.vue';\nimport { DAYS, MONTHS, generateTimeRanges, DEFAULT_TOLERANCE, ALL_DAY_TOLERANCE } from './date_time_range_generators';\nimport type { TimeRangeConfig, TimeRangeCreationMode, DayType, MonthType, TimeRangeConfigMultiple, TimeRangeConfigSingle } from './date_time_range_generators';\n// === INTERFACES === \n// === PROPS ===\nconst props = defineProps<{\n  currentDate: Date;\n  allowedDates?: Date[];\n  validTimes?: number[]; // timestamps\n  validate?: boolean; // Whether to show the timeline visualization for validation\n  enableParceling?: boolean; // Whether to enable parceling of long ranges\n  parcelSizeMs?: number; // Maximum parcel size in milliseconds\n}>();\n\n// === EMITS ===\nconst emit = defineEmits<{\n  'ranges-change': [ranges: MillisecondRange[], selectionType: TimeRangeCreationMode, customName: string, config: TimeRangeConfig];\n}>();\n\n\n\nconst tab = ref<'daterange' | 'monthrange'>('daterange');\n\n// === COMPOSABLE SETUP ===\n// Create refs for the current date to pass to the composable\nconst currentDateRef = ref(props.currentDate);\n\n// === REFS ===\nconst singleDateCalendar = ref();\n// === PICKER STATE ===\n// Direct date objects for date pickers - no unnecessary timestamp conversion\nconst timeSelectionRadio = ref<TimeRangeCreationMode | 'tracked'>('tracked');\nconst startDateObj = ref<Date | null>(null);\nconst endDateObj = ref<Date | null>(null);\nconst singleDateObj = ref<Date | null>(currentDateRef.value);\n\n\nwatch(() => props.currentDate, (newDate) => {\n  if (timeSelectionRadio.value === 'tracked') {\n    currentDateRef.value = newDate;\n  }\n});\n\n\n\nconst datePickerYearRange = computed<[number, number]>(() => {\n  if (!props.allowedDates || props.allowedDates.length === 0) {\n    return [2023, new Date().getFullYear()];\n  }\n  const minYear = props.allowedDates ? props.allowedDates[0].getFullYear() : 2023;\n  \n  const maxYear = props.allowedDates \n    ? props.allowedDates[props.allowedDates.length - 1].getFullYear() \n    : new Date().getFullYear();\n    \n  return [minYear, maxYear];\n});\n\nconst possibleYears = computed(() => {\n  const dates = props.allowedDates ?? [2024];\n  if (dates.length === 0) return [2023, new Date().getFullYear()];\n  const years = dates.map(d => d.getFullYear());\n  // Deduplicate and sort\n  return [...new Set(years)].sort((a, b) => a - b);\n});\n\n\nfunction formatDateDisplay(date: Date | null): string {  \n  return date?.toLocaleDateString() || '';\n}\n\n\nconst currentDateString = computed((): string => {\n  return currentDateRef.value.toLocaleDateString(undefined, \n    { year:'2-digit', month: 'numeric', day: 'numeric', timeZone: 'UTC' }\n  );\n});\n\nconst timeSelectionMode = ref<TimeRangeCreationMode>('multiple');\nwatch(timeSelectionRadio, (newVal) => {\n  if (newVal === 'tracked') {\n    timeSelectionMode.value = 'single';\n  } else {\n    timeSelectionMode.value = newVal;\n  }\n});\nconst selectedMonths = ref<MonthType[]>([...MONTHS]);\nconst selectedYears = ref<number[]>([...possibleYears.value]);\nconst selectedTimes = ref<string[]>([]);\nconst selectedDays = ref<DayType[]>([...DAYS]);\nconst timePlusMinus = ref<[number, number]>([...ALL_DAY_TOLERANCE]);\nconst allDay = computed(() => timePlusMinus.value[0] === ALL_DAY_TOLERANCE[0] && timePlusMinus.value[1] === ALL_DAY_TOLERANCE[1]);\nconst dayNames = DAYS as unknown as DayType[];\nconst monthNames = MONTHS as unknown as MonthType[];\n\nconst timeRangeStart = computed<Date | null>(() => {\n  if (tab.value === 'monthrange') {\n    // For month range, start from Jan 1 of the earliest selected year and month\n    const year = selectedYears.value.length > 0 ? Math.min(...selectedYears.value) : new Date().getFullYear();\n    const minMonth = selectedMonths.value.reduce((min, month) => {\n      const monthIndex = MONTHS.indexOf(month);\n      return monthIndex < min ? monthIndex : min;\n    }, 11);\n    const month = selectedMonths.value.length > 0 ? minMonth : 0;\n    return new Date(Date.UTC(year, month, 1, 0, 0, 0, 0));\n  }\n  if (!startDateObj.value) return null;\n  const utc = Date.UTC(\n    startDateObj.value.getUTCFullYear(), \n    startDateObj.value.getUTCMonth(),\n    startDateObj.value.getDate(),\n    0, 0, 0, 0\n  );\n  return new Date(utc);\n});\n\nconst timeRangeEnd = computed<Date | null>(() => {\n  if (tab.value === 'monthrange') {\n    // For month range, end at Dec 31 of the latest selected year and month\n    const year = selectedYears.value.length > 0 ? Math.max(...selectedYears.value) : new Date().getFullYear();\n    const maxMonth = selectedMonths.value.reduce((max, month) => {\n      const monthIndex = MONTHS.indexOf(month);\n      return monthIndex > max ? monthIndex : max;\n    }, 0);\n    const month = selectedMonths.value.length > 0 ? maxMonth : 11;\n    // Get last day of month\n    const lastDay = new Date(Date.UTC(year, month + 1, 0)).getUTCDate();\n    return new Date(Date.UTC(year, month, lastDay, 23, 59, 59, 999));\n  }\n  if (!endDateObj.value) return null;\n  const utc = Date.UTC(\n    endDateObj.value.getUTCFullYear(), \n    endDateObj.value.getUTCMonth(),\n    endDateObj.value.getDate(),\n    23, 59, 59, 999\n  );\n  return new Date(utc);\n});\n\nconst timeRangeSelectedMonths = computed<MonthType[] | undefined>(() => {\n  if (tab.value === 'monthrange') {\n    if (selectedMonths.value.length === MONTHS.length) {\n      return undefined;\n    }\n    return selectedMonths.value;\n  }\n  return undefined;\n});\n\nconst timeRangeSelectedYears = computed<number[] | undefined>(() => {\n  if (tab.value === 'monthrange') {\n    if (selectedYears.value.length === possibleYears.value.length) {\n      return undefined;\n    }\n    return selectedYears.value;\n  }\n  return undefined;\n});\n\nconst timeRangeConfig = computed<TimeRangeConfig>(() => {\n  if (timeSelectionRadio.value === 'single' || timeSelectionRadio.value === 'tracked') {\n    return {\n      type: 'single',\n      singleDate: timeSelectionRadio.value === 'tracked'? currentDateRef.value : singleDateObj.value,\n    } as TimeRangeConfigSingle;\n  } else {\n    const patternConfig: TimeRangeConfigMultiple = {\n      type: 'multiple',\n      dateRange: {\n        start: timeRangeStart.value ?? new Date(),\n        end: timeRangeEnd.value ?? new Date(),\n      },\n      // years needs to send undefined for all years selected\n      years: timeRangeSelectedYears.value,\n      // months: (selectedMonths.value.length === 0 || allMonthsSelected.value) ? undefined : selectedMonths.value,\n      // weekdays: (selectedDays.value.length === 0 || allDaysSelected.value) ? undefined : selectedDays.value,\n      // times: ((selectedTimes.value.length > 0) && !allDay.value) ? selectedTimes.value : undefined,\n      months: timeRangeSelectedMonths.value,\n      weekdays: selectedDays.value.length === DAYS.length ? undefined : selectedDays.value,\n      times: allDay.value ? undefined : selectedTimes.value,\n      toleranceHours: allDay.value ? [...ALL_DAY_TOLERANCE] : [...DEFAULT_TOLERANCE],\n      parcel: props.enableParceling ?? false,\n      parcelSize: props.parcelSizeMs,\n    };\n    return patternConfig as TimeRangeConfig;\n  }\n});\n\nconst invalidConfig = computed<boolean>(() => {\n  const config = timeRangeConfig.value;\n  if (config.type === 'single') {\n    return config.singleDate === null;\n  } else {\n    if (config.years !== undefined && config.years.length === 0) {\n      return true;\n    }\n    if (config.months !== undefined && config.months.length === 0) {\n      return true;\n    }\n    if (config.weekdays !== undefined && config.weekdays.length === 0) {\n      return true;\n    } \n    if (config.times !== undefined && config.times.length === 0) {\n      return true;\n    }\n  }\n  return false;\n});\n\n\nimport { isRingConsecutive } from '@/utils/array_operations/cyclic';\nfunction asRangeOrList<T extends string>(arr: T[], order: T[]): string {\n  if (arr.length === 0) return '';  \n  if (arr.length <= 2) {\n    return arr.map(s => s.slice(0,3)).join(', ');\n  }\n  const sortedArrr = arr.slice().sort((a, b) => order.indexOf(a) - order.indexOf(b));\n  const isConsecutive = isRingConsecutive(sortedArrr,  order, true);\n  if (isConsecutive.consecutive && sortedArrr.length > 2) {\n    return `${isConsecutive.start.slice(0,3)}-${isConsecutive.end.slice(0,3)}`;\n  }\n  return arr.map(s => s.slice(0,3)).join(', ');\n}\n  \n\nconst customTimeRangeName = computed((): string => {\n  \n  if (timeSelectionMode.value === 'single') {\n    return `${singleDateObj.value ? formatDateDisplay(singleDateObj.value) : 'No date selected'}`;\n  }\n    \n  let dateRangeString = '';\n  let monthsString = '';\n  let yearsString = '';\n  let daysString = '';\n  let timesString = '';\n  if (startDateObj.value && endDateObj.value) {\n    dateRangeString = `${formatDateDisplay(startDateObj.value)} - ${formatDateDisplay(endDateObj.value)}`;\n  } else {\n    // we shouldn't be able to reach this, so just throw an error\n    throw new Error('Start date or end date is null');\n  }\n  \n  if (selectedMonths.value.length > 0) {\n    monthsString = `Months: ${asRangeOrList(selectedMonths.value, monthNames)}`;\n  }\n  if (selectedYears.value.length > 0) {\n    yearsString = `Years: ${selectedYears.value.join(', ')}`;\n  }\n  if (selectedDays.value.length > 0) {\n    daysString = `${asRangeOrList(selectedDays.value, dayNames)}`;\n  }\n  if (selectedTimes.value.length > 0 && !allDay.value) {\n    timesString = `Times: ${selectedTimes.value.join(', ')}`;\n  }\n  if (tab.value === 'monthrange') {\n    // For monthrange tab, omit date range string\n    dateRangeString = '';\n  }\n  if (tab.value === 'daterange') {\n    // For daterange tab, omit months and years string\n    monthsString = '';\n    yearsString = '';\n  }\n  \n  return [dateRangeString, monthsString, yearsString, daysString, timesString]\n    .filter(s => s !== '')\n    .join(' | ');\n    \n});\n\nimport { filterForAllowedDates } from \"./filter_ranges\";\n\nconst currentTimeRanges = ref<MillisecondRange[]>([]);\nconst submissionTried = ref<boolean>(false);\n// === METHODS ===\n// Update custom range button handler\nfunction updateCustomRange(doEmit=true) {\n  let currentRanges: MillisecondRange[] = [];\n  currentRanges = generateTimeRanges(timeRangeConfig.value, doEmit);\n  \n  // Filter ranges to only include those with allowed dates\n  if (props.allowedDates && props.allowedDates.length > 0) {\n    currentRanges = filterForAllowedDates(currentRanges, props.allowedDates);\n  }\n  \n  currentTimeRanges.value = currentRanges;\n  submissionTried.value = doEmit;\n  if (doEmit) {\n    emit('ranges-change', currentRanges, timeSelectionMode.value, customTimeRangeName.value, timeRangeConfig.value);\n  }\n}\n\nwatch(timeRangeConfig, () => {\n  if (props.validTimes) updateCustomRange(false);\n}, { immediate: true, deep: true });\n\nfunction handleSingleDateChange(value: Date) {\n  if (value && value.getTime() !== singleDateObj.value?.getTime()) {\n    singleDateObj.value = value;\n    singleDateCalendar.value?.closeMenu();\n  }\n}\n\nconst dtrsRoot = useTemplateRef('dtrs-root');\nconst containerSize = ref<{width: number; height: number}>({width: 0, height: 0});\nimport { watchContainerSize } from '@/utils/dom';\n\n\n// === LIFECYCLE HOOKS ===\nonMounted(() => {\n  if (dtrsRoot.value) {\n    // console.log(dtrsRoot.value);\n    watchContainerSize(dtrsRoot.value as HTMLElement, \".panel\", (size) => {\n      containerSize.value = size;\n    });\n  }\n  // Initialize default dates\n  if (props.allowedDates && props.allowedDates.length > 0) {\n    const end = new Date(props.allowedDates[props.allowedDates.length - 1]);\n    const start = new Date(end);\n    // set back by 1 week\n    start.setDate(end.getDate() - 6);\n    startDateObj.value = start;\n    endDateObj.value = end;\n  }\n});\n// watch(glContainerSize, (newSize) => {\n//   console.log('DTRS Golden Layout container size changed:', newSize);\n// });\n// === WATCHERS ===\n// Watch for prop changes and update refs\nwatch(() => props.currentDate, (newDate) => {\n  currentDateRef.value = newDate;\n});\n\n\n\n// Ranges are now only emitted when the Update Custom Range button is clicked\n</script>\n\n<style>\n\n#dtrs-tabs .v-slide-group__content {\n  gap: 4px !important;\n}\n.dtrs-tab-window {\n  padding: 16px;\n  margin-bottom: 16px;\n  border: 1px solid rgb(var(--v-theme-surface-variant), 0.3);\n  border-radius: 4px;\n}\n\n.dtrs-tab-window-selected {\n}\n\n.dtrs-invalid-config-warning {\n  background-color: rgba(255, 0, 0, 0.25);\n  font-weight: bold;\n  border: 1px solid red;\n  border-left: 4px solid red;\n  border-radius: 8px;\n}\n\n.daterange-btn .v-btn__overlay {\n  display: none;\n}\n\n.monthrange-btn .v-btn__overlay {\n  display: none;\n}\n\n.dtr-select-by-div {\n  border-left: 2px solid white;\n  border-radius: 4px;\n}\n\nlabel#dtr-select-by-group {\n  font-size: 1.17;\n  font-weight: 700;\n  margin-inline: 0;\n  color: inherit;\n  opacity: 1;\n}\n</style>\n","import script from \"./DateTimeRangeSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DateTimeRangeSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DateTimeRangeSelection.vue?vue&type=style&index=0&id=6dcc1d12&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","\nimport {\n  nan2null,\n  nanmin,\n  nanmax,\n} from \"@/utils/array_operations/array_math\";\n\nimport {\n  mean,\n  standardError,\n  stdev,\n  sum,\n  median,\n  mad,\n  rootMeanSquare,\n} from \"@/utils/array_operations/array_math\";\n\n\n\n/**\n * Aggregate numerical data and calculates an associated error\n *\n * @param y - An array of numerical values (or nulls) to aggregate.\n * @param e - An optional array of numerical error values (or nulls) corresponding to `y`.\n * @param aggFunc - mean, median, min, max, sum\n * @param errorFunc - The error calculation function to use. Options are:\n *   - `'standardError'`: Calculates the standard error of the values.\n *   - `'stdev'`: Calculates the standard deviation of the values.\n *   - `'mad'`: Calculates the median absolute deviation, scaled to approximate standard deviation.\n * @returns An object containing:\n *   - `value`: The aggregated value, or `null` if the input data is empty or invalid.\n *   - `error`: The calculated error value, or `null` if the input data is empty or invalid.\n *\n * The function handles null values in the input arrays by filtering them out before performing calculations.\n * Notes on Errors\n * \n * For`'sum'`, the error is calculated as the square root of the sum of squared data errors.\n * \n * For `'median'` with `'standardError'`, the error is scaled to approximate the standard error of the median\n * assuming a normal distribution.\n * \n * In general, the final error is quadrature sum of the aggregation error and the RMS of the input errors.\n */\nexport function aggregateData(\n  y: (number | null)[],\n  e: (number | null)[] | undefined,\n  aggFunc: 'mean' | 'median' | 'min' | 'max' | 'sum',\n  errorFunc: 'standardError' | 'stdev' | 'mad',\n): { value: number | null; error: number | null } {\n  \n  // console log an error if we will be ignoring the errorFunc choice\n  // if ((aggFunc === 'min' || aggFunc === 'max' || aggFunc === 'sum') ) {\n  //   console.warn(`Warning: Choice of error function will be ignored when using aggFunc of ${aggFunc}`);\n  // }\n  \n  let aggY: number | null = null;\n  let aggE: number | null = null;\n  \n  const cleanY = y.filter(v => v !== null) as number[];\n  const cleanE = e ? e.filter(v => v !== null) as number[] : [];\n  \n  if (cleanY.length === 0) {\n    return { value: null, error: null };\n  }\n  \n  \n  // Special case for sum since error is different\n  if (aggFunc === 'sum') {\n    aggY = sum(cleanY);\n    aggE = stdev(cleanY);\n    const calE = rootMeanSquare(cleanE);\n    return { value: aggY, error: nan2null(Math.sqrt((aggE ?? 0) ** 2 + (calE ?? 0) ** 2)) };\n  }\n  \n  // Special case for rms since error is different\n  if (aggFunc === 'max') {\n    const r = nanmax(cleanY, true);\n    aggY = r ? r.value : null;\n    aggE = r ? cleanE[r.index] : null;\n    return { value: aggY, error: aggE };\n  }\n  \n  \n  // Special case for rms since error is different\n  if (aggFunc === 'min') {\n    const r = nanmin(cleanY, true);\n    aggY = r ? r.value : null;\n    aggE = r ? cleanE[r.index] : null;\n    return { value: aggY, error: aggE };\n  }\n  \n  // We will be using RMS error in quadrature with aggregation error\n  const calE = rootMeanSquare(cleanE);\n  \n  if (aggFunc === 'mean') {\n    aggY = mean(cleanY);\n  }\n  \n  if (aggFunc === 'median') {\n    aggY = median(cleanY);\n  }\n  \n  if (errorFunc === 'standardError') {\n    aggE = standardError(cleanY);\n    \n  } else if (errorFunc === 'stdev') {\n    aggE = stdev(cleanY);\n    \n  } else if (errorFunc === 'mad') {\n    aggE = mad(cleanY); // scale factor for normal distribution\n    aggE = aggE !== null ? aggE * 1.4826 : null; // convert to stddev equivalent\n  }\n  \n  // sqrt(pi/2) = 1.2533141...\n  // https://stats.stackexchange.com/a/61759\n  // https://en.wikipedia.org/wiki/Median#Sampling_distribution\n  if (aggE !== null && aggFunc === 'median' && errorFunc === 'standardError') {\n    aggE = aggE * 1.25331; // convert to standard error on median (assuming normal)\n  }\n  \n  const finalError = nan2null(Math.sqrt((aggE ?? 0) ** 2 + (calE ?? 0) ** 2));\n  \n  return { value: aggY, error: finalError };\n}\n\n\n\n","import { toZonedTime, fromZonedTime } from 'date-fns-tz';\n\nexport const START_WEEK_ON_MONDAY = false;\n\n\nexport function getBeginningOfWeek(date: Date, timezone?: string): Date {\n  const zonedDate = timezone ? toZonedTime(date, timezone) : new Date(date);\n  const day = zonedDate.getDay(); // 0 (Sun) to 6 (Sat)\n  const weekStart = new Date(zonedDate);\n  if (START_WEEK_ON_MONDAY) {\n    if (day === 0) { // if it is a Sunday, go back 6 days to monday\n      weekStart.setDate(zonedDate.getDate() - 6);\n    } else { // otherwise only go back to Monday\n      weekStart.setDate(zonedDate.getDate() - (day - 1));\n    }\n  \n  } else { // we can just subtract the day number\n    weekStart.setDate(zonedDate.getDate() - day);\n  }\n  weekStart.setHours(0, 0, 0, 0);\n  // want this to return the UTC time (so we can use the timestamp if we want)\n  return timezone ? fromZonedTime(weekStart, timezone) : weekStart;\n}\n\nexport function getEndOfWeek(date: Date, timezone?: string): Date {\n  // we'll handle the timzone\n  const zonedDate = timezone ? toZonedTime(date, timezone) : date;\n  const weekEnd = getBeginningOfWeek(zonedDate); // we'll modify this to be the end\n  // increment by 6 days 23:59:59.999\n  weekEnd.setDate(weekEnd.getDate() + 6); // move to Sunday\n  weekEnd.setHours(23, 59, 59, 999); // end of the day\n  return timezone ? fromZonedTime(weekEnd, timezone) : weekEnd;\n}\n\n\nfunction dayOfYear(date: Date): number {\n  const start = new Date(date.getFullYear(), 0, 0);\n  const diff = date.getTime() - start.getTime();\n  const oneDay = 1000 * 60 * 60 * 24;\n  return Math.floor(diff / oneDay);\n}\n\nfunction getWeekOfYearSundayStart(date: Date) {\n  const currentDayOfYear = dayOfYear(date);\n  const januaryFirst = new Date(date.getFullYear(), 0, 1);\n  const dayOfYearStart = januaryFirst.getDay();\n  \n  return Math.floor((currentDayOfYear + dayOfYearStart) / 7) + 1; \n}\n\nfunction getWeekOfYearMondayStart(date: Date) {\n  const currentDayOfYear = dayOfYear(date);\n  const januaryFirst = new Date(date.getFullYear(), 0, 1);\n  // Shift so that Monday = 0, Sunday = 6\n  const dayOfYearStart = (januaryFirst.getDay() + 6) % 7;\n\n  return Math.floor((currentDayOfYear + dayOfYearStart) / 7) + 1;\n}\n\nexport function getWeekOfYear(date: Date) {\n  return START_WEEK_ON_MONDAY ? getWeekOfYearMondayStart(date) : getWeekOfYearSundayStart(date);\n}\n\n\n/**\n * Helper to get number of days in a month\n * @param month 1-12 for Jan-Dec\n * @param year full year e.g. 2023\n * @returns number of days in the month\n */\nexport function daysInMonth(month, year) {\n  return new Date(year, month, 0).getDate();\n}\n\nexport function getDaysInMonth(date: Date): number {\n  return daysInMonth(date.getMonth() + 1, date.getFullYear());\n}\n\nexport function getDaysInYear(date: Date): number {\n  const year = date.getFullYear();\n  return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0) ? 366 : 365;\n}\n\nexport function seasonFraction(date: Date): number {\n  // D=12, J=1, F=2, M=3, A=4, M=5, J=6, J=7, A=8, S=9, O=10, N=11\n  // D=11, J=0, F=1, M=2, A=3, M=4, J=5, J=6, A=7, S=8, O=9, N=10 (0-based)\n  const month = date.getMonth();\n  const seasonStartingMonths = [11, 2, 5, 8]; // Dec-11, Mar-2, Jun-5, Sep-8\n  const seasonEndingMonths = [1, 4, 7, 10]; // Feb-1, May-4, Aug-7, Nov-10\n  const season = Math.floor(((month + 1) / 3) % 4); // 0, 1, 2, 3 for DJF, MAM, JJA, SON\n\n  const yearOff = season === 0 ? 1 : 0; // if DJF, then year offset is 1\n  const seasonStart = new Date(\n    date.getFullYear() - yearOff, \n    seasonStartingMonths[season], 1).getTime(); // Dec 1 of previous year\n  const seasonEnd = new Date(\n    date.getFullYear(),\n    seasonEndingMonths[season] +1 , -1, 23, 59, 59, 999).getTime(); // Last day of Feb\n  const seasonFrac = (date.getTime() - seasonStart) / (seasonEnd - seasonStart);\n  return seasonFrac;\n  \n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function _run_value_or_funcion<T, D>(valueOrFunc: T | ((input: D) => T) | undefined, argument?: D) : T | undefined {\n  if (valueOrFunc === undefined) return undefined;\n  if (typeof valueOrFunc === 'function') {\n    if (!argument) throw new Error('An argument must be provided when value is a function');\n    return (valueOrFunc as (input: D) => T)(argument);\n  }\n  return valueOrFunc;\n} \n\nexport type BinSizes = 's' | 'minute' | 'hour' | 'day' | 'week' | 'month' | 'year' | 'none' | 'weekendweekday';\nexport type FoldPeriods = 'day' | 'week' | 'year' | 'month' | 'none' | 'weekendweekday';\n\n/**\n * \n * Handle our basic BinSizes and time specifiers\n * \n * \n*/\n\nfunction altFloorHour(date: Date): Date {\n  const msPerHour = 3600000; // milliseconds in an hour\n  return new Date(Math.round(date.getTime() / msPerHour) * msPerHour);\n}\n\nfunction floorWeekendWeekday(date: Date): Date {\n  // The weekend defined to be consecutive Saturday and Sunday\n  const _date = new Date(date);\n  const day = date.getDay();\n  _date.setHours(0, 0, 0, 0); // set to start of day\n  \n  const isWeekday = !(day === 0 || day === 6);\n  // just push to previous Monday\n  \n  \n  if (isWeekday) { // move to Monday\n    _date.setDate(date.getDate() - day + 1);\n    return _date;\n  } \n  \n  // // eslint-disable-next-line no-empty\n  if (day === 6) { \n    _date.setDate(date.getDate() - 5); // move to Monday\n  }\n  \n  if (day == 0) {\n    _date.setDate(date.getDate() - 1 - 5);\n  }\n  \n  return _date;\n}\n\nconst d = (date: Date) => new Date(date); // helper to avoid mutating input date\nconst dateFlooringMap = new Map<BinSizes, (date: Date) => Date>([\n  ['s', (date: Date) => new Date(d(date).setMilliseconds(0))],\n  \n  ['minute', (date: Date) => new Date(d(date).setSeconds(0, 0))],\n  \n  // ['hour', (date: Date) => new Date(d(date).setMinutes(0, 0, 0))],\n  ['hour', altFloorHour], // we want to bin to the nearest hour\n  \n  ['day', (date: Date) => new Date(d(date).setHours(0, 0, 0, 0))],\n  \n  ['week', (date: Date) => getBeginningOfWeek(date)],\n  \n  ['month', (date: Date) => new Date(date.getFullYear(), date.getMonth(), 1, 0, 0, 0, 0)],\n  \n  ['year', (date: Date) => new Date(date.getFullYear(), 0, 1, 0, 0, 0, 0)],\n  \n  ['none', (date: Date) => date],\n  \n  ['weekendweekday', (date: Date) => floorWeekendWeekday(date)],\n  \n]); \n  \n// we never actually use this fucntionc\n// const getDateLocalPart = new Map<BinSizes, (date: Date) => number>([\n//   ['s', (date: Date) => date.getSeconds()],\n//   ['minute', (date: Date) => date.getMinutes()],\n//   ['hour', (date: Date) => date.getHours()],\n//   ['day', (date: Date) => date.getDate()],\n//   ['week', (date: Date) => getWeekOfYear(date)],\n//   ['month', (date: Date) => date.getMonth()], // return 1-12\n//   ['year', (date: Date) => date.getFullYear()],\n//   ['none', (date: Date) => date.getTime()], // not sure if this makes sense\n//   ['weekendweekday', (date: Date) => {\n//     const day = date.getDay();\n//     return (day === 0 || day === 6) ? 2 : 5; // 6 = Sat/Sun, 1 = Mon-Fri\n//   }], \n// ]);\n\nconst MS_IN_SECOND = 1000;\nconst MS_IN_MINUTE = 60 * MS_IN_SECOND;\nconst MS_IN_HOUR = 60 * MS_IN_MINUTE;\nconst MS_IN_DAY = 24 * MS_IN_HOUR;\nconst MS_IN_WEEK = 7 * MS_IN_DAY;\n\nexport const binDurationMs = new Map<BinSizes, number | ((date: Date) => number)>([\n  ['s', MS_IN_SECOND],\n  ['minute', MS_IN_MINUTE],\n  ['hour', MS_IN_HOUR],\n  ['day', MS_IN_DAY],\n  ['week', MS_IN_WEEK],\n  ['month', (date: Date) => {\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    return daysInMonth(month + 1, year) * MS_IN_DAY;\n  }],\n  ['year', (date: Date) => {\n    const year = date.getFullYear();\n    return getDaysInYear(new Date(year, 0, 1)) * MS_IN_DAY;\n  }],\n  ['none', 1],\n  ['weekendweekday', (date: Date) => {\n    const day = date.getDay();\n    return MS_IN_DAY * (day === 0 || day === 6 ? 1 : 1);\n  }],\n]);\n\nexport function floorTime(date: Date, floorTo: BinSizes): Date {\n  const func = dateFlooringMap.get(floorTo);\n  if (!func) throw new Error(`Unsupported floorTo value: ${floorTo}`);\n  return func(new Date(date)); // use new Date to avoid mutating input date\n}\n\nexport function getBinSizeAsMs(size: BinSizes, date?: Date): number | undefined {\n  const duration = binDurationMs.get(size);\n  return _run_value_or_funcion(duration, date);\n}\n\n\n// we never actually use this function\n// export const applyFoldOnFunctions = (date: Date, f: BinSizes) => getDateLocalPart.get(f)!(date);\n\nexport const applyFloorFunctions = (date: Date, bin: BinSizes) => dateFlooringMap.get(bin)!(date);\n\n\nexport function getFoldedPhase(date: Date, period: FoldPeriods, normalize=false): number {\n  if (period === 'none') return date.getTime();\n  const originalTime = date.getTime();\n  const foldOn = applyFloorFunctions(new Date(date), period).getTime();\n  if (!normalize) {\n    return originalTime - foldOn;\n  }\n  const durationMsValue = binDurationMs.get(period)!;\n  const durationMs = typeof durationMsValue === 'function' ? durationMsValue(date) : durationMsValue;\n\n  return (originalTime - foldOn) / durationMs;\n\n}\n\n\n\n\n\n/**\n * Returns a number or function that provides a precise duration in milliseconds\n * for the given TimeSpecifier.\n * In particular - for month and year, it returns a function that takes a Date object\n */\n\n\ntype SecondSpecifier = 's' | 'sec' | 'second' ;\ntype MinuteSpecifier =  'min' | 'minute' ;\ntype HourSpecifier = 'h' | 'hr' | 'hour' ;\ntype DaySpecifier = 'd' | 'day' ;\ntype MonthSpecifier = 'm' | 'mon' | 'month' ;\ntype YearSpecifier = 'y' | 'yr' | 'year' ;\ntype WeekSpecifier = 'w' | 'wk' | 'week' ;\ntype TimeSpecifier = SecondSpecifier | MinuteSpecifier | HourSpecifier | DaySpecifier | MonthSpecifier | YearSpecifier | WeekSpecifier ;\n\nconst timespecifierToBinSize: Record<TimeSpecifier, BinSizes> = {\n  's': 's', 'sec': 's', 'second': 's', \n  'min': 'minute', 'minute': 'minute', \n  'h': 'hour', 'hr': 'hour', 'hour': 'hour', \n  'd': 'day', 'day': 'day', \n  'w': 'week', 'wk': 'week', 'week': 'week', \n  'm': 'month', 'mon': 'month', 'month': 'month', \n  'y': 'year', 'yr': 'year', 'year': 'year',\n};\n\nexport function parseTimeSpecifier(spec: string): [number, BinSizes] | null {\n  const tsoptions = Object.keys(timespecifierToBinSize).join('|');\n  const decimalOrFloatRegex = '\\\\d*\\\\.?\\\\d+'; // matches integers or decimals of form 10, .5, 0.25, 2.0 etc.\n  const regex = new RegExp(`^(${decimalOrFloatRegex})?\\\\s*(${tsoptions})$`, 'i');\n  const match = spec.trim().match(regex);\n  if (!match) return null;\n  const value = match[1] ? parseFloat(match[1]) : 1;\n  const unit = match[2].toLowerCase() as TimeSpecifier;\n  let binSize: BinSizes;\n  if (unit in timespecifierToBinSize) {\n    binSize = timespecifierToBinSize[unit];\n  } else {\n    return null;\n  }\n  return [value, binSize];\n}\n\n\n\nfunction timeSpecDurationMs(spec: TimeSpecifier) {\n  const parsed = parseTimeSpecifier(spec)!;\n  const [value , binSize] = parsed;\n  const duration = binDurationMs.get(binSize)!;\n  if (typeof duration === 'number') {\n    return value * duration;\n  } else {\n    return (d: Date) => value * duration(d);\n  }\n}\n\n/**\n * Convenience wrapper around timeSpecDurationMs to return the duration in ms\n * for a given TimeSpecifier and optional Date (required for month and year)\n * For a loop it is better to call timeSpecDurationMs once and reuse the result\n * rather than calling this function repeatedly which results in multiple lookups\n * and function creations.\n */\nexport function timespecifierToMs(spec: TimeSpecifier, date?: Date): number | undefined {\n  return _run_value_or_funcion(timeSpecDurationMs(spec), date);\n}\n\n","/* eslint-disable indent */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/** A set of generic routines for aggregating data that comes from \n * our Tempo Data Serivce\n*/\n\nimport type { Prettify } from \"@/types\";\nimport type { RawSampleData } from \"./TempoDataService\";\nimport type { CEsriTimeseries } from \"../types\";\n// import type { TimeSeriesData } from \"./TempoDataService\";\nimport type { AggValue, DataPointError } from \"@/types\";\nimport { \n  toZonedTime, // returns a Date object where the time is ajusted\n  fromZonedTime, \n  format as formatTz,\n  formatInTimeZone\n} from 'date-fns-tz';\nimport {\n  nan2null,\n} from \"../../utils/array_operations/array_math\";\n\nimport { aggregateData } from \"../../utils/array_operations/aggregator\";\n\nexport interface TimeSeriesData {\n  values: Record<number, AggValue>;\n  errors: Record<number, DataPointError>;\n  locations: Array<{ x: number; y: number }>;\n  geometryType: 'rectangle' | 'point';\n}\n\n// a flexible aggregation\n// aggregation options\n// daily, multi-day, weekly\n\n/** https://www.geeksforgeeks.org/javascript/calculate-current-week-number-in-javascript/\n* getWeekoOfYear for Date object\n* If you have a UTC/js timestamp, and want the day of week for a \n* specfic timezone\n*/\nimport {\n  getBeginningOfWeek,\n  getWeekOfYear,\n} from '@/utils/calendar_utils';\n\ntype Window = string ; // e.g, '1d', '3d', '1w' , 'weekly'\n\nexport type AggregationMethod = 'mean' | 'median' | 'sum' | 'min' | 'max';\n\n\nexport class TimeSeriesResampler {\n  window: Window;\n  timezone?: string;\n  method: AggregationMethod;\n  errorMethod: 'std' | 'sem' = 'sem'; // standard deviation or standard error of the mean\n  includeCalibrationUncertainty = true; // whether to include calibration uncertainty in the error propagation\n\n  constructor(\n    window: Window, \n    timezone: string = 'UTC', \n    method: AggregationMethod = 'mean',\n    errorMethod: 'std' | 'sem' = 'sem',\n    includeCalibrationUncertainty = true\n  ) {\n    console.log(\"Creating Grouper with window:\", window, \"timezone:\", timezone, \"method:\", method);\n    this.window = window;\n    this.timezone = timezone;\n    this.method = method;\n    this.errorMethod = errorMethod;\n    this.includeCalibrationUncertainty = includeCalibrationUncertainty;\n    if (includeCalibrationUncertainty) {\n      console.error('This may not handle NaN values in the errors correctly which can lead to Zero values for errors');\n    }\n  }\n  \n  private _getZonedDate(date: Date): Date {\n    return this.timezone ? toZonedTime(date, this.timezone) : date;\n  }\n\n  getGroupId(date: Date): string {\n    const zonedDate = this._getZonedDate(date);\n    const groupDate = new Date(zonedDate);\n    \n    // handle daily or multi-day\n    if (this.window.endsWith('d')) {\n      const days = parseInt(this.window.slice(0, -1));\n      const day = zonedDate.getDate();\n      const groupDay = Math.floor((day - 1) / days) * days + 1;\n      groupDate.setDate(groupDay);\n      groupDate.setHours(0, 0, 0, 0);\n      \n      // handle weekly\n    } else if (this.window === '1w' || this.window === 'weekly') {\n      const weekStart = getBeginningOfWeek(date, this.timezone);\n      return String(weekStart.getTime());\n      \n      // handly monthly\n    } else if (this.window === '1m' || this.window === 'monthly') {\n      groupDate.setDate(1);\n      groupDate.setHours(0, 0, 0, 0);\n      \n      // default to daily\n    } else {\n      groupDate.setHours(0, 0, 0, 0);\n    }\n    const utcMidnight = this.timezone ? fromZonedTime(groupDate, this.timezone) : groupDate;\n    return String(utcMidnight.getTime());\n  }\n  \n  groupData(timeseries: Prettify<TimeSeriesData>): TimeSeriesData {\n    console.log(\"Grouping data with window:\", this.window, \"and method:\", this.method);\n    // the data and the error are in the same order\n    const data = Object.values(timeseries.values); // AggValue[]\n    const error = Object.values(timeseries.errors); // DataPointError[] | undefined\n    \n    // colate the data and errors into groups (bins)\n    const groups: { [key: string]: { values: AggValue[]; errors: DataPointError[] } } = {};\n    data.forEach((d, idx) => {\n      const groupId = this.getGroupId(d.date);\n      if (!groups[groupId]) {\n        groups[groupId] = { values: [], errors: [] };\n      }\n      groups[groupId].values.push(d);\n      if (error) {\n        groups[groupId].errors.push(error[idx]);\n      }\n    });\n\n    // these will be the time-aggregated values\n    const values: Record<number, AggValue> = {};\n    const errors: Record<number, DataPointError> = {};\n    \n    // loop over the groups\n    for (const groupId in groups) {\n      const groupData = groups[groupId];\n      const timestamp = parseInt(groupId); // this is the UTC for the start of the group\n\n      const groupValues = groupData.values.map(d => d.value);\n      \n      // Prepare error arrays for aggregateData (using uppers since errors are symmetric)\n      const errorValues = this.includeCalibrationUncertainty && groupData.errors.length > 0\n        ? groupData.errors.map(e => e.upper)\n        : undefined;\n      \n      // Map error method from 'sem'/'std' to aggregateData's format\n      const errorFunc = this.errorMethod === 'sem' ? 'standardError' : 'stdev';\n      \n      // Use aggregateData (errors are symmetric, so we reuse the result)\n      const result = aggregateData(groupValues, errorValues, this.method, errorFunc);\n      \n      values[timestamp] = { value: result.value, date: new Date(timestamp) };\n      errors[timestamp] = { \n        lower: result.error, \n        upper: result.error \n      };\n      \n      // end of loop over groups\n    }\n    \n    return {\n      values,\n      errors,\n      locations: timeseries.locations,\n      geometryType: timeseries.geometryType\n    };\n  }\n}\n\n\n\n\n// name format is [binning]Of[folding period]\nexport type FoldType = \n    // Original fold types\n    'hourOfDay' | \n    'dayOfWeek' | \n    'hourOfWeek'|\n    'dayOfWeekdayWeekend' |\n    // Hour-based bins\n    'hourOfWeek' |    // hour bins, folded over a week (0-167)\n    'hourOfMonth' |   // hour bins, folded over a month (0-743 max)\n    'hourOfYear' |    // hour bins, folded over a year (0-8783 max)\n    'hourOfSeason' |  // hour bins, folded over a season (0-2183 max)\n    // Day-based bins\n    'dayOfWeek' |     // day bins, folded over a week (0-6)\n    'dayOfMonth' |    // day bins, folded over a month (0-30 max)\n    'dayOfYear' |     // day bins, folded over a year (0-365)\n    'dayOfSeason' |   // day bins, folded over a season (0-91 max)\n    // Week-based bins\n    'weekOfMonth' |   // week bins, folded over a month (0-4 max)\n    'weekOfYear' |    // week bins, folded over a year (0-52)\n    'weekOfSeason' |  // week bins, folded over a season (0-13 max)\n    // Month-based bins\n    'monthOfYear' |   // month bins, folded over a year (0-11)\n    'monthOfSeason'|  // month bins, folded over a season (0-2)\n    // None-period bins (simple binning with dates, no folding)\n    'hourOfNone' |    // hour bins with no folding (x-axis shows dates)\n    'dayOfNone' |     // day bins with no folding (x-axis shows dates)\n    'weekOfNone' |    // week bins with no folding (x-axis shows dates)\n    'monthOfNone' |   // month bins with no folding (x-axis shows dates)\n    'noneOfNone' |   // no folding or binning\n    // fold without binning\n    'noneOfDay' |    // shows days of the week\n    'noneOfWeek' |   // shows weeks of the year\n    'noneOfMonth' |  // shows months of the year\n    'noneOfYear' |   // shows months of the year\n    // Others\n    'hourOfWeekdayWeekend'; // shows hours of the weekday, and hour of the weekend\n\nexport interface FoldBinContent {\n  bin: number;\n  timestamps: number[];          // original UTC timestamps of samples contributing\n  binPhase: number[]\n  lowers: (number | null)[];    // original lower error values (may include nulls)\n  uppers: (number | null)[];    // original upper error values (may include nulls)\n  rawValues: (number | null)[];  // raw numeric values (may include nulls)\n}\n\n\n// functino to sort folded bin content by timestamps\nexport function sortfoldBinContent(bin: FoldBinContent): FoldBinContent {\n  const sorted = bin.binPhase\n    .map((bp, idx) => ({ bp, idx }))\n    .sort((a, b) =>a.bp - b.bp);\n  \n  const sortedIndices = sorted.map(item => item.idx);\n  function applySort<T>(arr: T[]): T[] {\n    return sortedIndices.map(i => arr[i]);\n  }\n  \n  return {\n    bin: bin.bin,\n    timestamps: applySort(bin.timestamps),\n    binPhase: sorted.map(item => item.bp),\n    rawValues: applySort(bin.rawValues),\n    lowers: applySort(bin.lowers),\n    uppers: applySort(bin.uppers)\n  };\n}\n\nfunction altFloorHour(date: Date): Date {\n  const msPerHour = 3600000; // milliseconds in an hour\n  return new Date(Math.round(date.getTime() / msPerHour) * msPerHour);\n}\n\nexport type Seasons = 'DJF' | 'MAM' | 'JJA' | 'SON'; // meteorological seasons\n\nexport interface FoldedAggValue {\n  value: number | null;\n  bin: number; // 023, 06, or 0167 depending on fold\n  date?: Date; // actual date for None-period bins (hourOfNone, dayOfNone, etc.)\n}\n\ninterface InternalBin {\n      bin: number;\n      timestamps: number[];\n      rawValues: (number | null)[];\n      numericValues: number[];           // non-null numeric values\n      calibrationErrors: DataPointError[]; // original per-sample errors\n    }\n\nexport interface FoldedTimeSeriesData {\n  foldType: FoldType;\n  values: Record<number, FoldedAggValue>;         // binIndex -> aggregated value\n  errors: Record<number, DataPointError>;         // binIndex -> aggregated error\n  bins: Record<number, FoldBinContent>;           // binIndex -> full raw bin content\n  locations: Array<{ x: number; y: number }>;\n  geometryType: 'rectangle' | 'point';\n}\n\n/** Class for folding data periodically \n * We want to control the periodicity and resolution\n*/\nexport class TimeSeriesFolder {\n  foldType: FoldType;\n  timezone: string;\n  method: AggregationMethod;\n  errorMethod: 'std' | 'sem';\n  includeCalibrationUncertainty: boolean;\n\n  constructor(\n    foldType: FoldType,\n    timezone: string = 'UTC',\n    method: AggregationMethod = 'mean',\n    errorMethod: 'std' | 'sem' = 'sem',\n    includeCalibrationUncertainty = true\n  ) {\n    this.foldType = foldType;\n    this.timezone = timezone;\n    this.method = method;\n    this.errorMethod = errorMethod;\n    this.includeCalibrationUncertainty = includeCalibrationUncertainty;\n  }\n  \n  private _getZonedDate(date: Date): Date {\n    return this.timezone ? toZonedTime(date, this.timezone) : date;\n  }\n\n  // convenience to get the number of bins\n  private _binCount(): number {\n    switch (this.foldType) {\n      // Hour-based bins\n      case 'hourOfDay': return 24;\n      case 'hourOfWeek': return 24 * 7;        // 168\n      case 'hourOfMonth': return 24 * 31;      // 744 (max for 31-day month)\n      case 'hourOfYear': return 24 * 366;      // 8784 (max for leap year)\n      case 'hourOfSeason': return 24 * 92;     // 2208 (max ~92 days)\n      \n      // Day-based bins\n      case 'dayOfWeek': return 7;\n      case 'dayOfMonth': return 31;            // max days in a month\n      case 'dayOfYear': return 366;            // max for leap year\n      case 'dayOfSeason': return 92;           // max ~92 days in a season\n      \n      // Week-based bins\n      case 'weekOfMonth': return 5;            // max ~5 weeks in a month\n      case 'weekOfYear': return 54;            // max 53 weeks in a year\n      case 'weekOfSeason': return 14;          // max ~14 weeks in a season\n      \n      // Month-based bins\n      case 'monthOfYear': return 12;\n      case 'monthOfSeason': return 3;          // 3 months per season\n      \n      // None-period bins (use timestamps as keys, so no fixed count)\n      case 'hourOfNone':\n      case 'dayOfNone':\n      case 'weekOfNone':\n      case 'monthOfNone':\n      case 'noneOfNone':\n        return Infinity;  // no fixed bin count for None-period types\n      \n      // fold without binning\n      case 'noneOfDay':\n      case 'noneOfWeek':\n      case 'noneOfMonth':\n      case 'noneOfYear':\n        return Infinity; // no fixed bin count for fold-only types\n      \n      // Special cases\n      case 'dayOfWeekdayWeekend': return 2;\n      case 'hourOfWeekdayWeekend': return 48; // 0-23 for weekday, 24-48 for weekend\n      \n      default:\n        console.error('Unknown fold type:', this.foldType);\n        return 1;\n    }\n  }\n  \n  // instead of a groupId we just need the bin index\n  private _binIndex(date: Date): number {\n    const z = this._getZonedDate(date);\n    \n    switch (this.foldType) {\n      // Hour-based bins\n      case 'hourOfDay': \n        return altFloorHour(z).getHours();                                    // 023\n      case 'hourOfWeek': \n        return z.getDay() * 24 + altFloorHour(z).getHours();                  // 0167\n      case 'hourOfMonth': \n        return (z.getDate() - 1) * 24 + altFloorHour(z).getHours();           // 0743\n      case 'hourOfYear': {\n        const yearStart = new Date(z.getFullYear(), 0, 1);\n        const dayOfYear = Math.floor((z.getTime() - yearStart.getTime()) / (1000 * 60 * 60 * 24));\n        return dayOfYear * 24 + altFloorHour(z).getHours();                   // 08783\n      }\n      case 'hourOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);       // 0-3 for DJF, MAM, JJA, SON\n        const seasonStartMonths = [11, 2, 5, 8];                // Dec, Mar, Jun, Sep\n        const yearOff = season === 0 ? 1 : 0;\n        const seasonStart = new Date(z.getFullYear() - yearOff, seasonStartMonths[season], 1);\n        const dayOfSeason = Math.floor((z.getTime() - seasonStart.getTime()) / (1000 * 60 * 60 * 24));\n        return dayOfSeason * 24 + altFloorHour(z).getHours();                 // 02207\n      }\n      \n      // Day-based bins\n      case 'dayOfWeek': \n        return z.getDay();                                      // 06\n      case 'dayOfMonth': \n        return z.getDate() - 1;                                 // 030\n      case 'dayOfYear': {\n        const yearStart = new Date(z.getFullYear(), 0, 1);\n        return Math.floor((z.getTime() - yearStart.getTime()) / (1000 * 60 * 60 * 24)); // 0365\n      }\n      case 'dayOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);\n        const seasonStartMonths = [11, 2, 5, 8];\n        const yearOff = season === 0 ? 1 : 0;\n        const seasonStart = new Date(z.getFullYear() - yearOff, seasonStartMonths[season], 1);\n        return Math.floor((z.getTime() - seasonStart.getTime()) / (1000 * 60 * 60 * 24)); // 091\n      }\n      \n      // Week-based bins\n      case 'weekOfMonth': {\n        const dayOfMonth = z.getDate();\n        return Math.floor((dayOfMonth - 1) / 7);                // 04\n      }\n      case 'weekOfYear': {\n        return getWeekOfYear(date); // this can be done approximately w/o the timezone\n        // i haven't tested, but in principle there could be some off-by one hour errors\n      }\n      \n      case 'weekOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);\n        const seasonStartMonths = [11, 2, 5, 8];\n        const yearOff = season === 0 ? 1 : 0;\n        const seasonStart = new Date(z.getFullYear() - yearOff, seasonStartMonths[season], 1);\n        const dayOfSeason = Math.floor((z.getTime() - seasonStart.getTime()) / (1000 * 60 * 60 * 24));\n        return Math.floor(dayOfSeason / 7);                     // 013\n      }\n      \n      // Month-based bins\n      case 'monthOfYear': \n        return z.getMonth();                                    // 011\n      case 'monthOfSeason': {\n        const month = z.getMonth();\n        const season = Math.floor(((month + 1) / 3) % 4);\n        const seasonStartMonths = [11, 2, 5, 8];\n        const seasonStartMonth = seasonStartMonths[season];\n        // Calculate month offset within season\n        if (season === 0) { // DJF\n          return month === 11 ? 0 : month + 1;                  // Dec=0, Jan=1, Feb=2\n        } else {\n          return (month - seasonStartMonth + 12) % 12;          // 02\n        }\n      }\n      \n      // None-period bins (return timestamp of bin start, like resampler)\n      case 'hourOfNone': {\n        // const zBinStart = new Date(z);\n        // zBinStart.setMinutes(0, 0, 0);\n        const zBinStart = altFloorHour(z);\n        return (this.timezone ? fromZonedTime(zBinStart, this.timezone) : zBinStart).getTime();\n      }\n      case 'dayOfNone': {\n        const zBinStart = new Date(z);\n        zBinStart.setHours(0, 0, 0, 0);\n        return (this.timezone ? fromZonedTime(zBinStart, this.timezone) : zBinStart).getTime();\n      }\n      case 'weekOfNone': {\n        const weekStart = getBeginningOfWeek(date, this.timezone);\n        return weekStart.getTime();\n      }\n      case 'monthOfNone': {\n        const zBinStart = new Date(z);\n        zBinStart.setDate(1);\n        zBinStart.setHours(0, 0, 0, 0);\n        return (this.timezone ? fromZonedTime(zBinStart, this.timezone) : zBinStart).getTime();\n      }      \n      \n      // Special cases\n      case 'dayOfWeekdayWeekend': \n        return (z.getDay() % 6 > 0) ? 0 : 1;                    // 1=weekend, 0=weekday\n        \n      case 'hourOfWeekdayWeekend': {\n        const isWeekend = (z.getDay() % 6 === 0);                // true if weekend\n        return isWeekend ? (24 + altFloorHour(z).getHours()) : altFloorHour(z).getHours();  // 0-23 for weekday, 24-47 for weekend\n      }\n      \n      default:\n        console.error('Unknown fold type:', this.foldType);\n        return 0;\n    }\n  }\n  \n  private _binPhase(date: Date): number {\n    const z = this._getZonedDate(date);\n    const minutes = z.getMinutes();\n    const seconds = z.getSeconds();\n    const milliseconds = z.getMilliseconds();\n    \n    switch (this.foldType) {\n      // Hour-based bins - return fraction of hour\n      case 'hourOfDay':\n      case 'hourOfWeek':\n      case 'hourOfMonth':\n      case 'hourOfYear':\n      case 'hourOfSeason':\n      case 'hourOfNone':\n        return -((minutes / 60 + seconds / 3600 + milliseconds / 3600000 ) - 0.5); // fraction of hour\n      \n      // Day-based bins - return fraction of day (as hours)\n      case 'dayOfWeek':\n      case 'dayOfMonth':\n      case 'dayOfYear':\n      case 'dayOfSeason':\n      case 'dayOfNone': {\n        const hourOfDay = z.getHours() + minutes / 60 + seconds / 3600;\n        return hourOfDay / 24; // fraction of day\n      }\n      \n      // Week-based bins - return fraction of week (as days)\n      case 'weekOfMonth':\n      case 'weekOfYear':\n      case 'weekOfSeason':\n      case 'weekOfNone': {\n        const dayOfWeek = z.getDay();\n        const hourOfDay = z.getHours() + minutes / 60 + seconds / 3600;\n        return (dayOfWeek + hourOfDay / 24) / 7; // fraction of week\n      }\n      \n      // Month-based bins - return fraction of month (as days)\n      case 'monthOfYear':\n      case 'monthOfSeason':\n      case 'monthOfNone': {\n        const dayOfMonth = z.getDate() - 1; // 0-based\n        const hourOfDay = z.getHours() + minutes / 60 + seconds / 3600;\n        const daysInMonth = new Date(z.getFullYear(), z.getMonth() + 1, 0).getDate();\n        return (dayOfMonth + hourOfDay / 24) / daysInMonth; // fraction of month\n      }\n      \n      // Special cases\n      case 'dayOfWeekdayWeekend': \n        return 0;  // binary choice, no phase\n        \n      case 'hourOfWeekdayWeekend': {\n        // Return fraction of hour (0-1) to match other hour-based bins\n        return minutes / 60 + seconds / 3600 + milliseconds / 3600000;\n      }\n      \n      default:\n        console.error('Unknown fold type:', this.foldType);\n        return 0;\n    }\n  }\n  \n  foldData(timeseries: Prettify<TimeSeriesData>): FoldedTimeSeriesData | null {\n    \n    if (this.foldType.startsWith('none')) {\n      return null;\n    }\n    const binCount = this._binCount();\n    const binsRecord: Record<number, Prettify<InternalBin>> = {};\n    \n    // bundle data and errors into bins\n    // it includes the timestamps, and raw/cleaned valued\n    Object.entries(timeseries.values).forEach(([ts,d]) => {\n      const binIndex = this._binIndex(d.date);\n      if (binIndex == null || binIndex < 0 || binIndex >= binCount) {\n        console.error('Invalid bin index', binIndex, 'for date', d.date, 'with fold type', this.foldType);\n        return;\n      }\n      if (!binsRecord[binIndex]) {\n        binsRecord[binIndex] = {\n          bin: binIndex,\n          timestamps: [],\n          rawValues: [],\n          numericValues: [],\n          calibrationErrors: []\n        };\n      }\n      \n      const bin = binsRecord[binIndex];\n      bin.timestamps.push(d.date.getTime());\n      bin.rawValues.push(d.value);\n      // get clean values\n      if (d.value !== null && !isNaN(d.value)) {\n        bin.numericValues.push(d.value);\n      }\n      \n      const err = timeseries.errors[ts];\n      if (err) {\n        bin.calibrationErrors.push(err);\n      } else {\n        console.error('No error found for timestamp', ts);\n      }\n      \n    });\n\n    // Check if this is a None-period fold type\n    const isNonePeriod = ['noneOfNone', 'hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(this.foldType);\n\n    // these will be the time-aggregated values\n    const values: Record<number, FoldedAggValue> = {};\n    const errors: Record<number, DataPointError> = {};\n    const publicBins: Record<number, FoldBinContent> = {};\n\n    // loop over the groups and aggregate\n    Object.values(binsRecord).forEach(bin => {\n\n      const { bin: binIndex, numericValues, calibrationErrors, rawValues, timestamps } = bin;\n      \n      // Prepare error arrays for aggregateData (using uppers since errors are symmetric)\n      const errorValues = this.includeCalibrationUncertainty && calibrationErrors.length > 0\n        ? calibrationErrors.map(e => e.upper)\n        : undefined;\n      \n      // Map error method from 'sem'/'std' to aggregateData's format\n      const errorFunc = this.errorMethod === 'sem' ? 'standardError' : 'stdev';\n      \n      // Use aggregateData (errors are symmetric, so we reuse the result)\n      const result = aggregateData(rawValues, errorValues, this.method, errorFunc);\n      \n      // For None-period bins, binIndex is a timestamp, convert to Date\n      const binDate = isNonePeriod ? new Date(binIndex) : undefined;\n      \n      values[binIndex] = { \n        value: result.value, \n        bin: binIndex,\n        date: binDate\n      };\n      \n      errors[binIndex] = { \n        lower: result.error, \n        upper: result.error \n      };\n      \n      // expose the full bin contents\n      publicBins[binIndex] = {\n        bin: binIndex,\n        timestamps: [...timestamps],\n        binPhase: timestamps.map(t => this._binPhase(new Date(t))),\n        rawValues: [...rawValues].map(v => nan2null(v)),\n        lowers: calibrationErrors.map(e => e.lower).map(v => nan2null(v)),\n        uppers: calibrationErrors.map(e => e.upper).map(v => nan2null(v))\n      };\n      \n    });\n    \n    \n    return {\n      foldType: this.foldType,\n      values,\n      errors,\n      bins: publicBins,\n      locations: timeseries.locations,\n      geometryType: timeseries.geometryType\n    };\n  }\n}\n\n\nexport function hourOfWeekToDayHour(hourOfWeek: number): { day: number; hour: number } {\n  const day = Math.floor(hourOfWeek / 24);\n  const hour = hourOfWeek % 24;\n  return { day, hour };\n}","// Generated by Copilot, modified...\nimport type { DTickValue, Layout } from 'plotly.js-dist-min';\nimport type { FoldType } from '@/esri/services/aggregation';\n\n\n// Main style configuration for each fold type\ntype PredefinedFoldTypes = Exclude<FoldType,\n  | 'noneOfDay'\n  | 'noneOfWeek'\n  | 'noneOfMonth'\n  | 'noneOfYear'\n>;\n\nconst plotlyGridStyles = {\n  'xaxis': {\n    'showgrid': true,\n    // 'gridcolor': 'red',\n    // 'gridwidth': 1,\n    // 'zerolinecolor': 'blue',\n    // 'zerolinewidth': 2,\n  }\n};\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction num2TimeLabel(hour: number): string {\n  const h = Math.floor(hour % 24);\n  const ampm = h >= 12 ? 'PM' : 'AM';\n  const hour12 = h % 12 === 0 ? 12 : (h % 12); // just get hour diget\n  \n  const minute = Math.round((hour % 1) * 60);\n  \n  if (minute === 0) {\n    return `${hour12.toFixed(0)} ${ampm}`;\n  }\n  if (minute == 60) {\n    return `${(hour12 + 1).toFixed(0)} ${ampm}`;\n  }\n  \n  return `${hour12.toFixed(0)}:${minute.toFixed(0).padStart(2, '0')} ${ampm}`;\n}\n// create an object like 0: 12 AM, 0.1: 12:06 AM, 0.2: 12:12 AM, ..., 23.9: 11:54 PM\nconst timeLabelAlias: Record<string, string> = {};\nfor (let h = 0; h < 24; h += 0.1) {\n  h = Math.round(h * 10) / 10; // avoid floating point precision issues\n  const hasDecimal = h % 1 !== 0;\n  if (hasDecimal) {\n    timeLabelAlias[h.toFixed(1)] = num2TimeLabel(h);\n    continue;\n  }\n  timeLabelAlias[parseInt(h.toFixed(1))] = num2TimeLabel(h);\n}\n\n// create weekday/weekend label alias\n// weekday is 0, 23, weekend 24-47\nconst weekdayWeekendAlias: Record<string, string> = {};\nfor (let h = 0; h < 48; h += 0.1) {\n  const dayHour = h % 24;\n  const isWeekend = h >= 24;\n  let label = num2TimeLabel(dayHour) + (isWeekend ? ' (WE)' : ' (WD)');\n  // between 20 - 28 label is none\n  if (h >= 20 && h < 28) {\n    label = '';\n  }\n  const key = Math.round(h * 10) / 10; // avoid floating point precision issues\n  if (key % 1 !== 0) {\n    weekdayWeekendAlias[key.toFixed(1)] = label;\n  } else {\n    weekdayWeekendAlias[parseInt(key.toFixed(1))] = label;\n  }\n}\n\nconst _defaultyAxisStyle: Partial<Layout> = {\n  'yaxis': {\n  }\n};\n\nexport const foldTypeStyles: Record<PredefinedFoldTypes, Partial<Layout>> = {\n  // Hour-based bins\n  'hourOfDay': {\n    xaxis: {\n      title: { text: 'Hour of Day (Local Time for Region)' },\n      tickmode: 'auto',\n      tick0: 0,\n      nticks: 7,\n      labelalias: timeLabelAlias as unknown as DTickValue\n    }\n  },\n  \n  'hourOfWeek': {\n    xaxis: {\n      title: { text: 'Day of Week' },\n      tickmode: 'array',\n      tickvals: [0, 24, 48, 72, 96, 120, 144].map(v => v + 12),\n      ticktext: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n      minor: {\n        gridcolor: 'black',\n        gridwidth: 1,\n        showgrid: true,\n        tickmode: 'array',\n        tickvals: [0, 24, 48, 72, 96, 120, 144],\n        ticklen: 0,\n      }\n    },\n  },\n  \n  'hourOfMonth': {\n    xaxis: {\n      title: { text: 'Hour of Month' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 24 * 5, // Every 5 days\n      tickformat: 'd'\n    }\n  },\n  \n  'hourOfYear': {\n    xaxis: {\n      title: { text: 'Day of Year' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 24 * 30, // Roughly monthly\n      tickformat: 'd',\n    }\n  },\n  \n  'hourOfSeason': {\n    xaxis: {\n      title: { text: 'Hour of Season' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 24 * 7, // Weekly\n      tickformat: 'd'\n    }\n  },\n  \n  // Day-based bins\n  'dayOfWeek': {\n    xaxis: {\n      title: { text: 'Day of Week' },\n      tickmode: 'array',\n      tickvals: [0, 1, 2, 3, 4, 5, 6].map(v => v + 0.5),\n      ticktext: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n      minor: {\n        gridcolor: 'black',\n        gridwidth: 1,\n        showgrid: true,\n        tickmode: 'array',\n        tickvals: [0, 1, 2, 3, 4, 5, 6],\n        ticklen: 0,\n      }\n    }\n  },\n  \n  'dayOfMonth': {\n    xaxis: {\n      title: { text: 'Day of Month' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 5,\n      tickformat: 'd'\n    }\n  },\n  \n  'dayOfYear': {\n    xaxis: {\n      title: { text: 'Day of Year' },\n      tickmode: 'array',\n      tickvals: [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334],\n      ticktext: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n    }\n  },\n  \n  'dayOfSeason': {\n    xaxis: {\n      title: { text: 'Day of Season' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 10,\n      tickformat: 'd'\n    }\n  },\n  \n  // Week-based bins\n  'weekOfMonth': {\n    xaxis: {\n      title: { text: 'Week of Month' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 1,\n      tickformat: 'd'\n    }\n  },\n  \n  'weekOfYear': {\n    xaxis: {\n      title: { text: 'Week of Year' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 4,\n      tickformat: 'd'\n    }\n  },\n  \n  'weekOfSeason': {\n    xaxis: {\n      title: { text: 'Week of Season' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 2,\n      tickformat: 'd'\n    }\n  },\n  \n  // Month-based bins\n  'monthOfYear': {\n    xaxis: {\n      title: { text: 'Month of Year' },\n      tickmode: 'array',\n      tickvals: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],\n      ticktext: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n    }\n  },\n  \n  'monthOfSeason': {\n    xaxis: {\n      title: { text: 'Month of Season' },\n      tickmode: 'array',\n      tickvals: [0, 1, 2],\n      ticktext: ['Month 1', 'Month 2', 'Month 3']\n    }\n  },\n  \n  // None-period bins (simple binning with dates)\n  'noneOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m-%d'\n    }\n  },\n  \n  'hourOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m-%d %H:%M'\n    }\n  },\n  \n  'dayOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m-%d'\n    }\n  },\n  \n  'weekOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m-%d'\n    }\n  },\n  \n  'monthOfNone': {\n    xaxis: {\n      title: { text: 'Date' },\n      type: 'date',\n      // tickformat: '%Y-%m'\n    }\n  },\n  \n  // Special cases\n  'dayOfWeekdayWeekend': {\n    xaxis: {\n      title: { text: 'Day Type' },\n      tickmode: 'array',\n      tickvals: [0, 1],\n      ticktext: ['Weekday', 'Weekend'],\n      range: [-0.5, 1.5],\n    }\n  },\n  \n  'hourOfWeekdayWeekend': {\n    xaxis: {\n      title: { text: 'Hour of Day' },\n      tickmode: 'linear',\n      tick0: 0,\n      dtick: 3,\n      // tickvals: [0, 6, 12, 18, 24, 30, 36, 42],\n      // ticktext: ['0:00 WD', '6:00 WD', '12:00 WD', '18:00 WD', '0:00 WE', '6:00 WE', '12:00 WE', '18:00 WE']\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      labelalias: weekdayWeekendAlias as unknown as any\n      // tickvals: [12, 36],\n      // ticktext: ['Weekday', 'Weekend'],\n      // minor: {\n      //   showgrid: false,\n      //   tickmode: 'linear',\n      //   tick0: 0,\n      //   dtick: 1,\n      //   ticklen: 5,\n      //   ticks: 'inside',\n      // }\n      \n    }\n  }\n};\n\n/**\n * Get the Plotly layout styling for a specific fold type\n */\nexport function getFoldTypeStyle(foldType: FoldType): Partial<Layout> {\n  if (foldType.startsWith('none')) {\n    return foldTypeStyles[foldType.replace('noneOf', 'hourOf') as PredefinedFoldTypes];\n  }\n    \n  return foldTypeStyles[foldType];\n}\n\nexport function deepMerge(target: object, source: object): object {\n  const result = {...target};\n  for (const key in source) {\n    // if key has a non-array object, iterate recursively\n    if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n      result[key] = deepMerge(result[key] || {}, source[key]);\n    } else {\n      result[key] = source[key];\n    }\n  }\n  return result;\n}\n\n\nexport function mergeFoldTypeLayout(foldType: FoldType, customLayout?: Partial<Layout>): Partial<Layout> {\n  const foldStyle = deepMerge(getFoldTypeStyle(foldType), _defaultyAxisStyle);\n  const layout = deepMerge(deepMerge(foldStyle, plotlyGridStyles) , customLayout || {});\n\n  const xaxisTitle = layout[\"xaxis\"]?.title?.text;\n  if (xaxisTitle) {\n    const prefix = \"Time: \";\n    if (!xaxisTitle.startsWith(prefix)) {\n      layout[\"xaxis\"].title.text = `${prefix}${xaxisTitle}`;\n    }\n  }\n\n  return layout;\n}\n","\nimport type { PlotlyGraphDataSet } from '../../types';\nimport Plotly, { type Datum } from \"plotly.js-dist-min\";\nimport { diff, nanmedian, arraysEqual } from '@/utils/array_operations/array_math';\n\n\nimport { nanmean } from \"@/utils/array_operations/array_math\";\n\nfunction normalizeBadValue(v: number | null | undefined): number | null {\n  if (v === null || v === undefined || isNaN(v)) {\n    return null;\n  }\n  return v;\n}\n\nimport { deepMerge } from \"./plotly_styles\";\n\nexport function createErrorBands(data: PlotlyGraphDataSet, color: string, datasetName: string, legendGroup: string, options: object = {}) {\n  if (!data.upper || !data.lower) return {lower: null, upper: null, max: 0, min: 0};\n      \n  const upperY: (number | null)[] = [];\n  const lowerY: (number | null)[] = [];\n  let max = 0;\n  let min = 0;\n    \n  data.y.forEach((y, idx) => {\n    if (y === null) {\n      lowerY.push(null);\n      upperY.push(null);\n      return;\n    }\n        \n    if (data.upper === undefined) {\n      upperY.push(null);\n    } else {\n      const high = y + (data.upper[idx] ?? nanmean(data.upper) ?? 0);\n      upperY.push(high);\n      max = Math.max(max, high !== null ? high : 0);\n    }\n        \n    if (data.lower === undefined) {\n      lowerY.push(null);\n    } else {\n      const low = y - (data.lower[idx] ?? nanmean(data.lower) ?? 0);\n      lowerY.push(low);\n      min = Math.min(min, low !== null ? low : 0);\n          \n    }\n        \n        \n  });\n  // console.log({lowerY, upperY});\n  const traceErrorOptions = {\n    x: data.x,\n    mode: \"lines\",\n    line: { width: 0 },\n    showlegend: false,\n    legendgroup: legendGroup,\n    name: datasetName,\n    marker: { color: color ?? 'red' },\n  } as Partial<Plotly.PlotData>;\n      \n  return {\n    lower:{\n      y: lowerY.map(normalizeBadValue),\n      ...deepMerge(traceErrorOptions, options),\n    } as Plotly.PlotData,\n    upper:{\n      y: upperY.map(normalizeBadValue),\n      ...deepMerge(traceErrorOptions, options),\n      fill: \"tonexty\",\n    } as Plotly.PlotData,\n    max,\n    min\n\n  };\n    \n}\n\n/* Check if a dataset has error bars defined\nisSymmetric means, either upper = lower, or only one of them is defined\nErrors are either symmetric, or both upper and lower are defined and of same length\n*/\nexport function dataHasErrors(data: PlotlyGraphDataSet) {\n  const hasUpper = !!data.upper;\n  const hasLower = !!data.lower;\n  const sameLength = data.upper && data.lower && data.upper.length === data.y.length && data.lower.length === data.y.length;\n  const isSymmetric = (!!data.upper !== !!data.lower) || arraysEqual(data.upper, data.lower);\n  const hasErrors = isSymmetric || (hasUpper && hasLower && sameLength);\n  return { hasErrors, hasUpper, hasLower, isSymmetric };\n}\n  \n\nexport function createErrorBars(data: PlotlyGraphDataSet, color: string, options: Partial<Plotly.ErrorOptions> = {}): Extract<Plotly.ErrorBar, {type: 'data'}> | null {\n  if (!data.upper && !data.lower) return null;\n  \n  \n  const isSymmetric = (!!data.upper !== !!data.lower) || arraysEqual(data.upper, data.lower);\n    \n  return {\n    type: 'data',\n    ...options,\n    color: options.color || color || 'limegreen', /* ts should prevent limegreen, but just in case */\n    symmetric: isSymmetric,\n    array: (isSymmetric ? (data.upper ?? data.lower) : data.upper) as Datum[],\n    arrayminus: (isSymmetric ? undefined : data.lower) as Datum[],\n  };\n}\n\n\n\nexport function filterNullValues(data: PlotlyGraphDataSet): PlotlyGraphDataSet {\n  // filter out any place where\n  // data.x or data.y is null or undefined or NaN\n  if (!data.x || !data.y) {\n    return data;\n  }\n  const filteredX: Datum[] = [];\n  const filteredY: number[] = [];\n  const filteredLower: (number | null)[] = [];\n  const filteredUpper: (number | null)[] = [];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const filteredCustomData: any[] = [];\n  data.x.forEach((x, idx) => {\n    const y = data.y[idx];\n    if (x !== null && x !== undefined && y !== null && y !== undefined && !isNaN(y)) {\n      filteredX.push(x);\n      filteredY.push(y);\n      filteredCustomData.push(data.datasetOptions?.customdata ? data.datasetOptions.customdata[idx] : null);\n      if (data.lower) {\n        filteredLower.push(data.lower[idx] ?? null); // keep length consistent \n      }\n      if (data.upper) {\n        filteredUpper.push(data.upper[idx] ?? null); // keep length consistent \n      }\n    }\n  });\n\n  const result: PlotlyGraphDataSet = {\n    ...data,\n    datasetOptions: {\n      ...data.datasetOptions,\n      customdata: filteredCustomData,\n    },\n    x: filteredX,\n    y: filteredY,\n    name: data.name\n  };\n  if (data.lower) {\n    result.lower = filteredLower;\n  } \n  if (data.upper) {\n    result.upper = filteredUpper;\n  }\n  result.errorType = data.errorType;\n  \n  return result;\n}\n\n\nfunction _appendDataPoint(target: PlotlyGraphDataSet, source: PlotlyGraphDataSet, idx: number): void {\n  target.x.push(source.x[idx]);\n  target.y.push(source.y[idx]);\n  if (source.lower) {\n    target.lower!.push(source.lower[idx]);\n  }\n  if (source.upper) {\n    target.upper!.push(source.upper[idx]);\n  }\n  if (source.datasetOptions?.customdata) {\n    target.datasetOptions!.customdata!.push(source.datasetOptions.customdata[idx]);\n  }\n}\n\nfunction _createEmptyDatasetCopy(data: PlotlyGraphDataSet): PlotlyGraphDataSet {\n  const copy: PlotlyGraphDataSet = {\n    ...data,\n    x: [],\n    y: [],\n    name: data.name,\n  };\n  \n  if (data.lower) {\n    copy.lower = [];\n  }\n  \n  if (data.upper) {\n    copy.upper = [];\n  }\n  \n  if (data.datasetOptions?.customdata) {\n    copy.datasetOptions = {\n      ...data.datasetOptions,\n      customdata: [],\n    };\n  }\n  \n  return copy;\n}\n\n\nexport function splitDatasetByDay(data: PlotlyGraphDataSet): PlotlyGraphDataSet[] {\n  const datasetsByDay: { [key: string]: PlotlyGraphDataSet } = {};\n\n  data.x.forEach((x, idx) => {\n    const date = new Date(x as string); // assuming x is a date string\n    const dayKey = date.toLocaleDateString(undefined, { year: 'numeric', month: '2-digit', day: '2-digit' });\n    \n    if (!datasetsByDay[dayKey]) {\n      datasetsByDay[dayKey] = _createEmptyDatasetCopy(data);\n    }\n    _appendDataPoint(datasetsByDay[dayKey], data, idx);\n    \n  });\n\n  return Object.values(datasetsByDay);\n}\n\n\n\n\nexport function splitDatasetByGap(data: PlotlyGraphDataSet): PlotlyGraphDataSet[] {\n  // const gaps: number[] = [];\n  const xValues = data.x as number[];\n  const gaps = diff(xValues) as number[];\n  const medianGap = nanmedian(gaps);\n  if (medianGap === null) {\n    return [data];\n  }\n  const threshold = medianGap * 3;\n\n  const datasetsByGap: PlotlyGraphDataSet[] = [];\n  let currentDataset: PlotlyGraphDataSet = _createEmptyDatasetCopy(data);\n\n  data.x.forEach((x, idx) => {\n    if (idx > 0) {\n      const gap = (x as number) - (data.x[idx - 1] as number);\n      if (gap > threshold) {\n        // Start a new dataset\n        datasetsByGap.push(currentDataset);\n        currentDataset = _createEmptyDatasetCopy(data);\n      }\n    }\n    _appendDataPoint(currentDataset, data, idx);\n    \n  });\n\n  // Push the last dataset if it has data\n  if (currentDataset.x.length > 0) {\n    datasetsByGap.push(currentDataset);\n  }\n\n  return datasetsByGap;\n}","import { Layout, Config, ModeBarDefaultButtons } from \"plotly.js-dist-min\";\n\nexport const DEFAULT_PLOT_LAYOUT: Partial<Layout> = {\n  dragmode: false,\n  modebar: {\n    color: \"#808080\",\n    activecolor: \"#009ade\",  // Smithsonian blue\n  },\n};\n\nexport const DEFAULT_MODEBAR_BUTTONS_TO_REMOVE: ModeBarDefaultButtons[] = ['sendDataToCloud', 'lasso2d', 'select2d', 'autoScale2d'];\nexport const DEFAULT_PLOT_CONFIG: Partial<Config> = {\n  modeBarButtonsToRemove: DEFAULT_MODEBAR_BUTTONS_TO_REMOVE,\n  displaylogo: false,\n};\n","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { onMounted, onBeforeUnmount, ref, watch, nextTick, onUnmounted, computed } from \"vue\";\nimport { v4 } from \"uuid\";\nimport Plotly, { PlotlyHTMLElement, newPlot, purge, restyle, relayout, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\nimport type { PlotlyGraphDataSet } from '../../types';\nimport { createErrorBands, filterNullValues, splitDatasetByGap, createErrorBars, dataHasErrors } from \"./plotly_graph_elements\";\nimport { cycle } from \"@/utils/array_operations/array_math\";\nimport { DEFAULT_PLOT_LAYOUT, DEFAULT_PLOT_CONFIG } from \"@/components/plotly/defaults\";\n\n// https://stackoverflow.com/a/7616484\nexport interface PlotlyGraphProps {\n  datasets: PlotlyGraphDataSet[];\n  colors?: string[];\n  showErrors?: boolean;\n  dataOptions?: Partial<Data>[];\n  errorBarStyles?: (Partial<Plotly.ErrorOptions> | null)[];\n  names?: string[];\n  layoutOptions?: Partial<Plotly.Layout>;\n  configOptions?: Partial<Plotly.Config>;\n  showZero?: boolean;\n  xaxisTitle?: string;\n  yaxisTitle?: string;\n}\n\ninterface ErrorBarMeta {\n  id: string;\n  errorType: 'bar';\n  isErrorBar: true;\n  hasErrors?: boolean;\n  useErrorBar?: boolean;\n}\ninterface ErrorBandMeta {\n  id: string;\n  errorType: 'band';\n  isErrorBand: true;\n  hasErrors?: boolean;\n  useErrorBand?: boolean;\n}\ntype DataWithMeta = Plotly.PlotData & { meta?: ErrorBarMeta | ErrorBandMeta };\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'PlotlyGraph',\n  props: {\n    datasets: {},\n    colors: {},\n    showErrors: { type: Boolean },\n    dataOptions: {},\n    errorBarStyles: {},\n    names: {},\n    layoutOptions: {},\n    configOptions: {},\n    showZero: { type: Boolean, default: true },\n    xaxisTitle: {},\n    yaxisTitle: {}\n  },\n  emits: [\"click\"],\n  setup(__props: any, { emit: __emit }) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst generateHash = (string) => {\n  let hash = 0;\n  for (const char of string) {\n    hash = (hash << 5) - hash + char.charCodeAt(0);\n    hash |= 0; // Constrain to 32bit integer\n  }\n  return hash;\n};\n\nconst hashDataset = (data: PlotlyGraphDataSet) => {\n  const hash = JSON.stringify(data.x) + JSON.stringify(data.y) + \n  JSON.stringify(data.lower) + JSON.stringify(data.upper); // + JSON.stringify(data.errorType);\n  return generateHash(hash).toString();\n};\n\nconst props = __props;\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\nlet resizeObserver: ResizeObserver | null = null; // eslint-disable-line prefer-const\n\nconst emit = __emit;\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst legendGroupVisible = ref<Map<string, boolean>>(new Map());\n\n\nconst filterNulls = ref(true);  \n\n\nconst plotlyData = computed<Plotly.PlotData[]>(() => {\n  errorTraces = [];\n  \n  const _plotlyData: Plotly.PlotData[] = [];\n  if (props.datasets.length === 0) {\n    console.error(\"No data provided for timeseries graph\");\n    return _plotlyData;\n  }\n  \n\n  let max = 0;\n  let min = Infinity;\n  \n  const datasets = props.datasets;\n  \n  // split into multiple traces if error bands are requested\n  // the split should be per dataset, and the split should be on the day\n  \n  \n  datasets.forEach((data, index) => {\n    // create a hash from the data.x and data.y to be it's \"id\"\n    data = filterNulls.value ? filterNullValues(data) : data;\n    data.name = data.name + ''; // add an ideographic space for for legend uniqueness\n    \n    // check x, and have same length y\n    if (!data.x || !data.y || data.x.length !== data.y.length) {\n      console.error(\"Invalid dataset, skipping\", data);\n      return;\n      // throw new Error(`Invalid dataset: x and y must be non-null and of same length. Lengths: x=${data.x?.length}, y=${data.y?.length}`);\n    }\n    \n    const id = hashDataset(data);\n    \n    const validY = data.y.filter((v): v is number => v !== null);\n    max = Math.max(max, Math.max(...validY));\n    min = Math.min(min, Math.min(...validY));\n\n    // const legendGroup = v4();\n    const legendGroup = `legend-group-${index}`;\n    if (!legendGroupVisible.value.has(legendGroup)) {\n      legendGroupVisible.value.set(legendGroup, true);\n    }\n    legendGroups[id] = legendGroup;\n    \n    const useErrorBands = data.errorType == 'band' && props.showErrors;\n    \n    (useErrorBands ? splitDatasetByGap(data) : [data]).forEach((data, jindex) => {\n    \n      /* start of plotly element creation */\n      const errorOptions = {} as Record<'error_y',Plotly.ErrorBar>;\n      const hasErrors = dataHasErrors(data);\n      \n      // https://plotly.com/javascript/error-bars/\n      if (hasErrors.hasErrors) {\n        /* we cycle the styles if it is shorter, like matplotlib does */\n        const style = cycle(index, props.errorBarStyles) || {};\n\n        const options = {\n          thickness: 1.5,\n          width: 0,\n          ...style,\n        };\n        const _e = createErrorBars(data, cycle(index, props.colors) ?? 'red', options);\n        if (_e) {\n          errorOptions['error_y'] = _e;\n          errorOptions['error_y']['visible'] = data.errorType === 'bar' && props.showErrors ;\n\n        } else {\n          console.error(`No errors set for dataset index ${index} and name ${data.name}`,);\n        } \n        \n      }\n      const datasetName = data.name || props.names?.[index] || `Dataset ${index + 1}`;\n      \n      const dataTraceOptions = {\n        mode: \"lines+markers\",\n        legendgroup: legendGroup,\n        showlegend: jindex === 0,\n        name: datasetName,\n        marker: { color: cycle(index, props.colors) ?? 'red'},\n        visible: legendGroupVisible.value.get(legendGroup) ? true : \"legendonly\",\n        ...errorOptions,\n        ...(cycle(index, props.dataOptions) ?? {}),\n        ...(data.datasetOptions ?? {}), // allow per-dataset options override\n        meta: { \n          id:id,\n          errorType: 'bar',\n          hasErrors: hasErrors.hasErrors,\n          isErrorBar: true,\n          useErrorBar: data.errorType == 'bar',\n        },\n      };\n\n      _plotlyData.push({\n        x: data.x,\n        y: data.y,\n        ...dataTraceOptions\n      } as Plotly.PlotData);\n      \n      \n      // double checking to have valid types\n      if (hasErrors.hasErrors) {\n        \n        const {lower, upper, max: newMax, min: newMin} = createErrorBands(\n          data,\n          props.colors ? props.colors[index % props.colors.length] : 'red',\n          datasetName,\n          legendGroup,\n        );\n\n        max = Math.max(max, newMax);\n        min = Math.min(min, newMin);\n\n        if (lower === null || upper === null) {\n          console.error(\"Error creating error bands for dataset\", index, data);\n          return;\n        }\n        \n        const errorBandsVisible = legendGroupVisible.value.get(legendGroup) ? true : false;\n        lower['visible'] =  errorBandsVisible && props.showErrors && (data.errorType == 'band');\n        upper['visible'] =  errorBandsVisible && props.showErrors && (data.errorType == 'band');\n        // make these identifiable as error bands\n        lower['meta'] = { \n          id: id,\n          errorType: 'band',\n          hasErrors: hasErrors.hasErrors,\n          isErrorBand: true,\n          useErrorBand: data.errorType == 'band',\n        };\n        upper['meta'] = { \n          id: id,\n          errorType: 'band',\n          hasErrors: hasErrors.hasErrors,\n          isErrorBand: true,\n          useErrorBand: data.errorType == 'band',\n        };\n        \n        _plotlyData.push(lower);\n        errorTraces.push(_plotlyData.length - 1);\n\n        _plotlyData.push(upper);\n        errorTraces.push(_plotlyData.length - 1);\n      }\n      /* end of plotly element creation */\n    });\n    \n    \n  });\n  return _plotlyData;\n});\n\n\nconst layout = computed<Partial<Plotly.Layout>>(() => {\n  let max = 0;\n  let min = Infinity;\n  \n  plotlyData.value.forEach((trace) => {\n    const yValues = trace.y as (number | null)[];\n    const validY = yValues.filter((v): v is number => v !== null);\n    if (validY.length > 0) {\n      max = Math.max(max, Math.max(...validY));\n      min = Math.min(min, Math.min(...validY));\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const axisMin = props.showZero ? Math.min(0, min) : min;\n\n  return {\n    ...DEFAULT_PLOT_LAYOUT,\n    ...(props.layoutOptions || {}),\n    xaxis: {\n      ...(props.layoutOptions?.xaxis || {}),\n      ...(props.xaxisTitle ? {title: { text: props.xaxisTitle, ...props.layoutOptions?.xaxis?.title }} : {}),\n    },\n    yaxis: {\n      range: [axisMin, axisMax],\n      autorange: false,\n      ...(props.layoutOptions?.yaxis || {}),\n      ...(props.yaxisTitle ? {title: { text: props.yaxisTitle, ...props.layoutOptions?.yaxis?.title }} : {}),\n    },\n  };\n});\n\nfunction getTraceGroupVisibility(trace: Plotly.PlotData): {group: string | undefined, dataId: string | undefined, visibility: boolean} {\n  let group: string | undefined = undefined;\n  let dataId: string | undefined = undefined;\n  \n  group = trace.legendgroup as string;\n  \n  dataId = Object.keys(legendGroups).find(key => (group && legendGroups[key] === group));\n  // if it has a visibility setting, use it\n  return {group, dataId, visibility: dataId ? legendGroupVisible.value.get(group) ?? true : true };\n}\n\n\n\nfunction renderPlot() {\n  const config = {\n    ...DEFAULT_PLOT_CONFIG,\n    ...props.configOptions,\n  };\n  newPlot(graph.value ?? id, plotlyData.value, layout.value, config).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        console.log(\"Point clicked:\", point);\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", {x: point.x, y: point.y as number, customdata: point.customdata} );\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plot.value?.data[data.curveNumber] as Plotly.PlotData;\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      \n      const {group, dataId, visibility: currentlyVisible} = getTraceGroupVisibility(trace);\n      if (!dataId || !group) {\n        console.error(`No ${!dataId ? 'dataId' : 'group'} for legend click trace`, trace);\n        return true;\n      }\n      \n      nextTick(() => setLegendGroupErrorVisibility(group, !currentlyVisible));\n      \n      \n      return true;\n    });\n  });\n}\n\nfunction setErrorVisibilityForTrace(trace: DataWithMeta, visible: boolean, index: number) {\n  if (!graph.value) return;\n  \n  // check index and trace match\n  const traceIndex = (plot.value?.data as DataWithMeta[]).indexOf(trace);\n  if (traceIndex !== index) {\n    console.error(\"Trace index mismatch:\", index, traceIndex, trace);\n    return;\n  }\n  \n  \n  if (!trace.meta || (trace.meta && !trace.meta.hasErrors)) {\n    console.log(\"No errors for trace, skipping visibility update\", index, trace);\n    return;\n  }\n\n  if (trace.meta.errorType === 'band') {\n    console.log(\"Updating error band visibility\", index, visible, trace);\n    // here we need to use the 'false' instead of 'legendonly'\n    restyle(graph.value, { visible: visible && !!trace.meta.useErrorBand }, index);\n    return;\n  } \n  \n  if (trace.meta.errorType === 'bar') {\n    console.log(\"Updating error bar visibility\", index, visible, trace);\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    const update = { 'error_y' : (visible ? {...plotlyData.value[index]['error_y'], \n      visible: visible && !!trace.meta.useErrorBar\n    } : {})\n    } as Data;\n    restyle(graph.value, update, index);\n  }\n}\n\nfunction setLegendGroupErrorVisibility(legendGroup: string, visible: boolean) {\n  legendGroupVisible.value.set(legendGroup, visible);\n\n  if (graph.value) {    \n    (plot.value?.data as DataWithMeta[]).forEach((trace, index) => {\n      if (!graph.value) return;\n      const group = trace.legendgroup as string;\n      if (group !== legendGroup) return;\n      \n      setErrorVisibilityForTrace(trace, (visible && props.showErrors), index);\n    });\n  } else {\n    console.error(\"No graph element to update error band visibility\");\n  }\n}\n\n// function updateErrorDisplayTypes(errorType: 'bar' | 'band' | 'none') {\n//   // this\n\n\nfunction updateAllErrorVisibility(visible: boolean) {\n  if (graph.value) {    \n    (plot.value?.data as DataWithMeta[]).forEach((trace, index) => {\n      if (!graph.value) return;\n      \n      const {group, dataId, visibility} = getTraceGroupVisibility(trace as Plotly.PlotData);\n        \n      if (!dataId) {\n        console.error(\"No dataId for trace, skipping\", index, trace);\n        return;\n      }\n    \n      setErrorVisibilityForTrace(trace, (visibility && visible), index);\n    });\n  } else {\n    console.error(\"No graph element to update error band visibility\");\n  }\n}\n\nfunction onResize() {\n  if (graph.value && plot.value) {\n    relayout(graph.value, {\n      autosize: true\n    });\n  }\n}\n\nonMounted(() => {\n  renderPlot();\n  \n  // Set up resize observer\n  if (graph.value?.parentElement) {\n    resizeObserver = new ResizeObserver(() => {\n      onResize();\n    });\n    resizeObserver.observe(graph.value.parentElement);\n  }\n});\n\n\nonUnmounted(() => {\n  // Clean up resize observer\n  if (resizeObserver) {\n    resizeObserver.disconnect();\n    resizeObserver = null;\n  }\n  \n  // Clean up Plotly instance\n  if (graph.value) {\n    purge(graph.value);\n  }\n  plot.value = null;\n});\n\n\n\nwatch(() => props.showErrors, updateAllErrorVisibility);\n\nfunction updateDatasetMeta(index: number, useErrorBars) {\n  if (!graph.value) return;\n  \n  const trace = plot.value?.data[index] as DataWithMeta;\n  if (!trace) {\n    console.error(\"No trace for dataset meta update\", index);\n    return;\n  }\n  \n  const hasErrors = trace.meta?.hasErrors as boolean | undefined;\n  if (hasErrors === undefined) {\n    console.error(\"No hasErrors meta for trace dataset meta update\", index, trace);\n    return;\n  }\n  \n  if (!trace.meta) {\n    return;\n  }\n  \n  // if an error band\n  if (trace.meta.errorType === 'band') {\n    console.log(\"Updating error band meta\", index, useErrorBars);\n    trace.meta.useErrorBand = !useErrorBars;\n  }\n  \n  if (trace.meta.errorType === 'bar') {\n    console.log(\"Updating error bar meta\", index, useErrorBars);\n    trace.meta.useErrorBar = useErrorBars;\n  }\n  \n}\n\n\nwatch(() => props.datasets, (_newData, _oldData) => {\n  // if the dataset hashes changed, re-render\n  const newHashes = _newData.map(d => hashDataset(d));\n  const oldHashes = _oldData.map(d => hashDataset(d));\n  if (newHashes.join(',') !== oldHashes.join(',')) {\n    renderPlot();\n    return;\n  }\n  console.log(\"Datasets unchanged, updating error styles only\");\n  // check if error styles changed\n  \n  \n  // check for error bar style changes and update the meta\n  let changed = false;\n  _newData.forEach((data, index) => {\n    (plot.value?.data as DataWithMeta[])\n      .forEach((d, i) => {\n        if (d.meta?.id === hashDataset(data)) {\n          // if (d.meta.errorType !== data.errorType) {\n          console.log(\"Updating dataset error type meta\", i, data.errorType);\n          updateDatasetMeta(i, data.errorType === 'bar');\n          changed = true;\n          const { visibility } = getTraceGroupVisibility(d as Plotly.PlotData);\n          setErrorVisibilityForTrace(d, visibility && props.showErrors, i);\n          // }\n        }\n      });\n  });\n    \n}, { deep: true });\n\nwatch(() => props.showZero, renderPlot);\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref_key: \"graph\",\n    ref: graph,\n    id: id,\n    class: \"timeseries\"\n  }, null, 512))\n}\n}\n\n})","<!-- eslint-disable @typescript-eslint/no-unused-vars -->\n<template>\n  <div\n    ref=\"graph\"\n    :id=\"id\"\n    class=\"timeseries\"\n  >\n  </div>\n</template>\n\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { onMounted, onBeforeUnmount, ref, watch, nextTick, onUnmounted, computed } from \"vue\";\nimport { v4 } from \"uuid\";\nimport Plotly, { PlotlyHTMLElement, newPlot, purge, restyle, relayout, type Data, type Datum, type PlotMouseEvent } from \"plotly.js-dist-min\";\nimport type { PlotlyGraphDataSet } from '../../types';\nimport { createErrorBands, filterNullValues, splitDatasetByGap, createErrorBars, dataHasErrors } from \"./plotly_graph_elements\";\nimport { cycle } from \"@/utils/array_operations/array_math\";\nimport { DEFAULT_PLOT_LAYOUT, DEFAULT_PLOT_CONFIG } from \"@/components/plotly/defaults\";\n\n// https://stackoverflow.com/a/7616484\nconst generateHash = (string) => {\n  let hash = 0;\n  for (const char of string) {\n    hash = (hash << 5) - hash + char.charCodeAt(0);\n    hash |= 0; // Constrain to 32bit integer\n  }\n  return hash;\n};\n\nconst hashDataset = (data: PlotlyGraphDataSet) => {\n  const hash = JSON.stringify(data.x) + JSON.stringify(data.y) + \n  JSON.stringify(data.lower) + JSON.stringify(data.upper); // + JSON.stringify(data.errorType);\n  return generateHash(hash).toString();\n};\n\nexport interface PlotlyGraphProps {\n  datasets: PlotlyGraphDataSet[];\n  colors?: string[];\n  showErrors?: boolean;\n  dataOptions?: Partial<Data>[];\n  errorBarStyles?: (Partial<Plotly.ErrorOptions> | null)[];\n  names?: string[];\n  layoutOptions?: Partial<Plotly.Layout>;\n  configOptions?: Partial<Plotly.Config>;\n  showZero?: boolean;\n  xaxisTitle?: string;\n  yaxisTitle?: string;\n}\n\nconst props = withDefaults(defineProps<PlotlyGraphProps>(), {\n  showZero: true,\n});\n\nconst id = `timeseries-${v4()}`;\n\nconst plot = ref<PlotlyHTMLElement | null>(null);\nconst graph = ref<HTMLDivElement | null>(null);\nlet resizeObserver: ResizeObserver | null = null; // eslint-disable-line prefer-const\n\nconst emit = defineEmits<{\n  // Datum is from type of x in DataSet\n  (event: \"click\", value: {x: Datum, y: number, customdata: unknown}): void;\n}>();\n\nfunction datumToDate(datum: Datum): Date | null {\n  if (datum === null) { return null; }\n  if (datum instanceof Date) { return datum; }\n  return new Date(datum);\n}\n\nconst legendGroups: Record<string, string> = {};\nlet errorTraces: number[] = [];\nconst legendGroupVisible = ref<Map<string, boolean>>(new Map());\n\n\nconst filterNulls = ref(true);  \n\n\nconst plotlyData = computed<Plotly.PlotData[]>(() => {\n  errorTraces = [];\n  \n  const _plotlyData: Plotly.PlotData[] = [];\n  if (props.datasets.length === 0) {\n    console.error(\"No data provided for timeseries graph\");\n    return _plotlyData;\n  }\n  \n\n  let max = 0;\n  let min = Infinity;\n  \n  const datasets = props.datasets;\n  \n  // split into multiple traces if error bands are requested\n  // the split should be per dataset, and the split should be on the day\n  \n  \n  datasets.forEach((data, index) => {\n    // create a hash from the data.x and data.y to be it's \"id\"\n    data = filterNulls.value ? filterNullValues(data) : data;\n    data.name = data.name + ''; // add an ideographic space for for legend uniqueness\n    \n    // check x, and have same length y\n    if (!data.x || !data.y || data.x.length !== data.y.length) {\n      console.error(\"Invalid dataset, skipping\", data);\n      return;\n      // throw new Error(`Invalid dataset: x and y must be non-null and of same length. Lengths: x=${data.x?.length}, y=${data.y?.length}`);\n    }\n    \n    const id = hashDataset(data);\n    \n    const validY = data.y.filter((v): v is number => v !== null);\n    max = Math.max(max, Math.max(...validY));\n    min = Math.min(min, Math.min(...validY));\n\n    // const legendGroup = v4();\n    const legendGroup = `legend-group-${index}`;\n    if (!legendGroupVisible.value.has(legendGroup)) {\n      legendGroupVisible.value.set(legendGroup, true);\n    }\n    legendGroups[id] = legendGroup;\n    \n    const useErrorBands = data.errorType == 'band' && props.showErrors;\n    \n    (useErrorBands ? splitDatasetByGap(data) : [data]).forEach((data, jindex) => {\n    \n      /* start of plotly element creation */\n      const errorOptions = {} as Record<'error_y',Plotly.ErrorBar>;\n      const hasErrors = dataHasErrors(data);\n      \n      // https://plotly.com/javascript/error-bars/\n      if (hasErrors.hasErrors) {\n        /* we cycle the styles if it is shorter, like matplotlib does */\n        const style = cycle(index, props.errorBarStyles) || {};\n\n        const options = {\n          thickness: 1.5,\n          width: 0,\n          ...style,\n        };\n        const _e = createErrorBars(data, cycle(index, props.colors) ?? 'red', options);\n        if (_e) {\n          errorOptions['error_y'] = _e;\n          errorOptions['error_y']['visible'] = data.errorType === 'bar' && props.showErrors ;\n\n        } else {\n          console.error(`No errors set for dataset index ${index} and name ${data.name}`,);\n        } \n        \n      }\n      const datasetName = data.name || props.names?.[index] || `Dataset ${index + 1}`;\n      \n      const dataTraceOptions = {\n        mode: \"lines+markers\",\n        legendgroup: legendGroup,\n        showlegend: jindex === 0,\n        name: datasetName,\n        marker: { color: cycle(index, props.colors) ?? 'red'},\n        visible: legendGroupVisible.value.get(legendGroup) ? true : \"legendonly\",\n        ...errorOptions,\n        ...(cycle(index, props.dataOptions) ?? {}),\n        ...(data.datasetOptions ?? {}), // allow per-dataset options override\n        meta: { \n          id:id,\n          errorType: 'bar',\n          hasErrors: hasErrors.hasErrors,\n          isErrorBar: true,\n          useErrorBar: data.errorType == 'bar',\n        },\n      };\n\n      _plotlyData.push({\n        x: data.x,\n        y: data.y,\n        ...dataTraceOptions\n      } as Plotly.PlotData);\n      \n      \n      // double checking to have valid types\n      if (hasErrors.hasErrors) {\n        \n        const {lower, upper, max: newMax, min: newMin} = createErrorBands(\n          data,\n          props.colors ? props.colors[index % props.colors.length] : 'red',\n          datasetName,\n          legendGroup,\n        );\n\n        max = Math.max(max, newMax);\n        min = Math.min(min, newMin);\n\n        if (lower === null || upper === null) {\n          console.error(\"Error creating error bands for dataset\", index, data);\n          return;\n        }\n        \n        const errorBandsVisible = legendGroupVisible.value.get(legendGroup) ? true : false;\n        lower['visible'] =  errorBandsVisible && props.showErrors && (data.errorType == 'band');\n        upper['visible'] =  errorBandsVisible && props.showErrors && (data.errorType == 'band');\n        // make these identifiable as error bands\n        lower['meta'] = { \n          id: id,\n          errorType: 'band',\n          hasErrors: hasErrors.hasErrors,\n          isErrorBand: true,\n          useErrorBand: data.errorType == 'band',\n        };\n        upper['meta'] = { \n          id: id,\n          errorType: 'band',\n          hasErrors: hasErrors.hasErrors,\n          isErrorBand: true,\n          useErrorBand: data.errorType == 'band',\n        };\n        \n        _plotlyData.push(lower);\n        errorTraces.push(_plotlyData.length - 1);\n\n        _plotlyData.push(upper);\n        errorTraces.push(_plotlyData.length - 1);\n      }\n      /* end of plotly element creation */\n    });\n    \n    \n  });\n  return _plotlyData;\n});\n\n\nconst layout = computed<Partial<Plotly.Layout>>(() => {\n  let max = 0;\n  let min = Infinity;\n  \n  plotlyData.value.forEach((trace) => {\n    const yValues = trace.y as (number | null)[];\n    const validY = yValues.filter((v): v is number => v !== null);\n    if (validY.length > 0) {\n      max = Math.max(max, Math.max(...validY));\n      min = Math.min(min, Math.min(...validY));\n    }\n  });\n\n  const paddingFactor = 1.1;\n  const axisMax = Math.max(1, paddingFactor * max);\n  const axisMin = props.showZero ? Math.min(0, min) : min;\n\n  return {\n    ...DEFAULT_PLOT_LAYOUT,\n    ...(props.layoutOptions || {}),\n    xaxis: {\n      ...(props.layoutOptions?.xaxis || {}),\n      ...(props.xaxisTitle ? {title: { text: props.xaxisTitle, ...props.layoutOptions?.xaxis?.title }} : {}),\n    },\n    yaxis: {\n      range: [axisMin, axisMax],\n      autorange: false,\n      ...(props.layoutOptions?.yaxis || {}),\n      ...(props.yaxisTitle ? {title: { text: props.yaxisTitle, ...props.layoutOptions?.yaxis?.title }} : {}),\n    },\n  };\n});\n\nfunction getTraceGroupVisibility(trace: Plotly.PlotData): {group: string | undefined, dataId: string | undefined, visibility: boolean} {\n  let group: string | undefined = undefined;\n  let dataId: string | undefined = undefined;\n  \n  group = trace.legendgroup as string;\n  \n  dataId = Object.keys(legendGroups).find(key => (group && legendGroups[key] === group));\n  // if it has a visibility setting, use it\n  return {group, dataId, visibility: dataId ? legendGroupVisible.value.get(group) ?? true : true };\n}\n\n\n\nfunction renderPlot() {\n  const config = {\n    ...DEFAULT_PLOT_CONFIG,\n    ...props.configOptions,\n  };\n  newPlot(graph.value ?? id, plotlyData.value, layout.value, config).then((el: PlotlyHTMLElement) => {\n    plot.value = el;\n    el.on(\"plotly_click\", (data: PlotMouseEvent) => {\n      data.points.forEach(point => {\n        const traceIndex = point.curveNumber;\n        if (traceIndex !== 0 || point.x == null || point.y == null) {\n          return;\n        }\n        console.log(\"Point clicked:\", point);\n        const date = datumToDate(point.x);\n        if (date !== null) {\n          emit(\"click\", {x: point.x, y: point.y as number, customdata: point.customdata} );\n        }\n      });\n    });\n    el.on('plotly_legendclick', (data) => {\n      const trace = plot.value?.data[data.curveNumber] as Plotly.PlotData;\n      if (!trace) { \n        console.error(\"No trace for legend click\", data);\n        return true; \n      }\n      \n      const {group, dataId, visibility: currentlyVisible} = getTraceGroupVisibility(trace);\n      if (!dataId || !group) {\n        console.error(`No ${!dataId ? 'dataId' : 'group'} for legend click trace`, trace);\n        return true;\n      }\n      \n      nextTick(() => setLegendGroupErrorVisibility(group, !currentlyVisible));\n      \n      \n      return true;\n    });\n  });\n}\n\ninterface ErrorBarMeta {\n  id: string;\n  errorType: 'bar';\n  isErrorBar: true;\n  hasErrors?: boolean;\n  useErrorBar?: boolean;\n}\ninterface ErrorBandMeta {\n  id: string;\n  errorType: 'band';\n  isErrorBand: true;\n  hasErrors?: boolean;\n  useErrorBand?: boolean;\n}\ntype DataWithMeta = Plotly.PlotData & { meta?: ErrorBarMeta | ErrorBandMeta };\n\nfunction setErrorVisibilityForTrace(trace: DataWithMeta, visible: boolean, index: number) {\n  if (!graph.value) return;\n  \n  // check index and trace match\n  const traceIndex = (plot.value?.data as DataWithMeta[]).indexOf(trace);\n  if (traceIndex !== index) {\n    console.error(\"Trace index mismatch:\", index, traceIndex, trace);\n    return;\n  }\n  \n  \n  if (!trace.meta || (trace.meta && !trace.meta.hasErrors)) {\n    console.log(\"No errors for trace, skipping visibility update\", index, trace);\n    return;\n  }\n\n  if (trace.meta.errorType === 'band') {\n    console.log(\"Updating error band visibility\", index, visible, trace);\n    // here we need to use the 'false' instead of 'legendonly'\n    restyle(graph.value, { visible: visible && !!trace.meta.useErrorBand }, index);\n    return;\n  } \n  \n  if (trace.meta.errorType === 'bar') {\n    console.log(\"Updating error bar visibility\", index, visible, trace);\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    const update = { 'error_y' : (visible ? {...plotlyData.value[index]['error_y'], \n      visible: visible && !!trace.meta.useErrorBar\n    } : {})\n    } as Data;\n    restyle(graph.value, update, index);\n  }\n}\n\nfunction setLegendGroupErrorVisibility(legendGroup: string, visible: boolean) {\n  legendGroupVisible.value.set(legendGroup, visible);\n\n  if (graph.value) {    \n    (plot.value?.data as DataWithMeta[]).forEach((trace, index) => {\n      if (!graph.value) return;\n      const group = trace.legendgroup as string;\n      if (group !== legendGroup) return;\n      \n      setErrorVisibilityForTrace(trace, (visible && props.showErrors), index);\n    });\n  } else {\n    console.error(\"No graph element to update error band visibility\");\n  }\n}\n\n// function updateErrorDisplayTypes(errorType: 'bar' | 'band' | 'none') {\n//   // this\n\n\nfunction updateAllErrorVisibility(visible: boolean) {\n  if (graph.value) {    \n    (plot.value?.data as DataWithMeta[]).forEach((trace, index) => {\n      if (!graph.value) return;\n      \n      const {group, dataId, visibility} = getTraceGroupVisibility(trace as Plotly.PlotData);\n        \n      if (!dataId) {\n        console.error(\"No dataId for trace, skipping\", index, trace);\n        return;\n      }\n    \n      setErrorVisibilityForTrace(trace, (visibility && visible), index);\n    });\n  } else {\n    console.error(\"No graph element to update error band visibility\");\n  }\n}\n\nfunction onResize() {\n  if (graph.value && plot.value) {\n    relayout(graph.value, {\n      autosize: true\n    });\n  }\n}\n\nonMounted(() => {\n  renderPlot();\n  \n  // Set up resize observer\n  if (graph.value?.parentElement) {\n    resizeObserver = new ResizeObserver(() => {\n      onResize();\n    });\n    resizeObserver.observe(graph.value.parentElement);\n  }\n});\n\n\nonUnmounted(() => {\n  // Clean up resize observer\n  if (resizeObserver) {\n    resizeObserver.disconnect();\n    resizeObserver = null;\n  }\n  \n  // Clean up Plotly instance\n  if (graph.value) {\n    purge(graph.value);\n  }\n  plot.value = null;\n});\n\n\n\nwatch(() => props.showErrors, updateAllErrorVisibility);\n\nfunction updateDatasetMeta(index: number, useErrorBars) {\n  if (!graph.value) return;\n  \n  const trace = plot.value?.data[index] as DataWithMeta;\n  if (!trace) {\n    console.error(\"No trace for dataset meta update\", index);\n    return;\n  }\n  \n  const hasErrors = trace.meta?.hasErrors as boolean | undefined;\n  if (hasErrors === undefined) {\n    console.error(\"No hasErrors meta for trace dataset meta update\", index, trace);\n    return;\n  }\n  \n  if (!trace.meta) {\n    return;\n  }\n  \n  // if an error band\n  if (trace.meta.errorType === 'band') {\n    console.log(\"Updating error band meta\", index, useErrorBars);\n    trace.meta.useErrorBand = !useErrorBars;\n  }\n  \n  if (trace.meta.errorType === 'bar') {\n    console.log(\"Updating error bar meta\", index, useErrorBars);\n    trace.meta.useErrorBar = useErrorBars;\n  }\n  \n}\n\n\nwatch(() => props.datasets, (_newData, _oldData) => {\n  // if the dataset hashes changed, re-render\n  const newHashes = _newData.map(d => hashDataset(d));\n  const oldHashes = _oldData.map(d => hashDataset(d));\n  if (newHashes.join(',') !== oldHashes.join(',')) {\n    renderPlot();\n    return;\n  }\n  console.log(\"Datasets unchanged, updating error styles only\");\n  // check if error styles changed\n  \n  \n  // check for error bar style changes and update the meta\n  let changed = false;\n  _newData.forEach((data, index) => {\n    (plot.value?.data as DataWithMeta[])\n      .forEach((d, i) => {\n        if (d.meta?.id === hashDataset(data)) {\n          // if (d.meta.errorType !== data.errorType) {\n          console.log(\"Updating dataset error type meta\", i, data.errorType);\n          updateDatasetMeta(i, data.errorType === 'bar');\n          changed = true;\n          const { visibility } = getTraceGroupVisibility(d as Plotly.PlotData);\n          setErrorVisibilityForTrace(d, visibility && props.showErrors, i);\n          // }\n        }\n      });\n  });\n    \n}, { deep: true });\n\nwatch(() => props.showZero, renderPlot);\n\n</script>\n\n<style scoped>\n.js-plotly-plot  {\n  min-width: 30px;\n}\n</style>\n","import script from \"./PlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PlotlyGraph.vue?vue&type=style&index=0&id=044aeef1&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-044aeef1\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { computed } from 'vue';\nimport PlotlyGraph, { type PlotlyGraphProps } from './plotly/PlotlyGraph.vue';\nimport { mergeFoldTypeLayout } from './plotly/plotly_styles';\nimport type { FoldType } from '../esri/services/aggregation';\nimport { toZonedTime } from 'date-fns-tz';\n\nexport interface FoldedPlotlyGraphProps extends PlotlyGraphProps {\n  foldType: FoldType;\n  timezones?: string | string[];\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'FoldedPlotlyGraph',\n  props: {\n    foldType: {},\n    timezones: {},\n    datasets: {},\n    colors: {},\n    showErrors: { type: Boolean },\n    dataOptions: {},\n    errorBarStyles: {},\n    names: {},\n    layoutOptions: {},\n    configOptions: {},\n    showZero: { type: Boolean },\n    xaxisTitle: {},\n    yaxisTitle: {}\n  },\n  emits: [\"plot-click\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst browserTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\nfunction cloneTimeFromLocalToBrowser(date: Date, timeZone: string): Date {\n  // Get the equivalent time in the target timezone\n  const zonedDate = toZonedTime(date, timeZone);\n  // Create a new date object in the local timezone with the same components\n  return new Date(\n    zonedDate.getFullYear(),\n    zonedDate.getMonth(),\n    zonedDate.getDate(),\n    zonedDate.getHours(),\n    zonedDate.getMinutes(),\n    zonedDate.getSeconds(),\n    zonedDate.getMilliseconds()\n  );\n}\n\nconst props = __props;\n\nconst rezonedDatasets = computed(() => {\n  // do nothing if the timeseries isn't usind Date object\n  if (props.datasets.length === 0 || !(props.datasets[0].x[0] instanceof Date) || !props.timezones) {\n    return props.datasets;\n  }\n  return props.datasets.map((dataset, index) => {\n    const timezone = Array.isArray(props.timezones) ? props.timezones[index] : props.timezones;\n    const newX = dataset.x.map((x) => {\n      if (x instanceof Date) {\n        return cloneTimeFromLocalToBrowser(x, timezone ?? browserTimeZone);\n      }\n      return x;\n    });\n    return {...dataset, x: newX};\n  });\n});\n\nconst emit = __emit;\n\n// Merge the fold-type specific layout with any custom layout options\nconst mergedLayoutOptions = computed(() => {\n  return mergeFoldTypeLayout(props.foldType, props.layoutOptions);\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(PlotlyGraph, {\n    datasets: rezonedDatasets.value,\n    colors: __props.colors,\n    \"show-errors\": __props.showErrors,\n    \"data-options\": __props.dataOptions,\n    \"error-bar-styles\": __props.errorBarStyles,\n    names: __props.names,\n    \"layout-options\": mergedLayoutOptions.value,\n    \"config-options\": __props.configOptions,\n    \"yaxis-title\": __props.yaxisTitle,\n    \"xaxis-title\": __props.xaxisTitle,\n    onClick: _cache[0] || (_cache[0] = (value) => emit('plot-click', value))\n  }, null, 8, [\"datasets\", \"colors\", \"show-errors\", \"data-options\", \"error-bar-styles\", \"names\", \"layout-options\", \"config-options\", \"yaxis-title\", \"xaxis-title\"]))\n}\n}\n\n})","<template>\n  <plotly-graph\n    :datasets=\"rezonedDatasets\"\n    :colors=\"colors\"\n    :show-errors=\"showErrors\"\n    :data-options=\"dataOptions\"\n    :error-bar-styles=\"errorBarStyles\"\n    :names=\"names\"\n    :layout-options=\"mergedLayoutOptions\"\n    :config-options=\"configOptions\"\n    :yaxis-title=\"yaxisTitle\"\n    :xaxis-title=\"xaxisTitle\"\n    @click=\"(value) => emit('plot-click', value)\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue';\nimport PlotlyGraph, { type PlotlyGraphProps } from './plotly/PlotlyGraph.vue';\nimport { mergeFoldTypeLayout } from './plotly/plotly_styles';\nimport type { FoldType } from '../esri/services/aggregation';\nimport { toZonedTime } from 'date-fns-tz';\n\nconst browserTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\nfunction cloneTimeFromLocalToBrowser(date: Date, timeZone: string): Date {\n  // Get the equivalent time in the target timezone\n  const zonedDate = toZonedTime(date, timeZone);\n  // Create a new date object in the local timezone with the same components\n  return new Date(\n    zonedDate.getFullYear(),\n    zonedDate.getMonth(),\n    zonedDate.getDate(),\n    zonedDate.getHours(),\n    zonedDate.getMinutes(),\n    zonedDate.getSeconds(),\n    zonedDate.getMilliseconds()\n  );\n}\n\nexport interface FoldedPlotlyGraphProps extends PlotlyGraphProps {\n  foldType: FoldType;\n  timezones?: string | string[];\n}\n\nconst props = defineProps<FoldedPlotlyGraphProps>();\n\nconst rezonedDatasets = computed(() => {\n  // do nothing if the timeseries isn't usind Date object\n  if (props.datasets.length === 0 || !(props.datasets[0].x[0] instanceof Date) || !props.timezones) {\n    return props.datasets;\n  }\n  return props.datasets.map((dataset, index) => {\n    const timezone = Array.isArray(props.timezones) ? props.timezones[index] : props.timezones;\n    const newX = dataset.x.map((x) => {\n      if (x instanceof Date) {\n        return cloneTimeFromLocalToBrowser(x, timezone ?? browserTimeZone);\n      }\n      return x;\n    });\n    return {...dataset, x: newX};\n  });\n});\n\nconst emit = defineEmits<{\n  (event: \"plot-click\", value: {x: number | string | Date | null, y: number, customdata: unknown}): void;\n}>();\n\n// Merge the fold-type specific layout with any custom layout options\nconst mergedLayoutOptions = computed(() => {\n  return mergeFoldTypeLayout(props.foldType, props.layoutOptions);\n});\n</script>\n","import script from \"./FoldedPlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FoldedPlotlyGraph.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"aggregation-controls\" }\nconst _hoisted_2 = { class: \"explainer-text\" }\nconst _hoisted_3 = { key: 0 }\nconst _hoisted_4 = { key: 1 }\nconst _hoisted_5 = { key: 2 }\nconst _hoisted_6 = { key: 3 }\nconst _hoisted_7 = {\n  key: 0,\n  class: \"selected-timezone-details d-flex mb-4\"\n}\nconst _hoisted_8 = { class: \"d-flex flex-row flex-wrap\" }\nconst _hoisted_9 = { class: \"text-caption\" }\nconst _hoisted_10 = { key: 0 }\nconst _hoisted_11 = { class: \"d-flex ga-2\" }\n\nimport type { AggregationMethod , FoldType, FoldedTimeSeriesData} from '@/esri/services/aggregation';\n\nimport {\n  TimeBinOptions,\n  FoldingPeriodOptions,\n} from '@/utils/foldingValidation';\n\n\n/*\n:foldingPeriodOptions=\"foldingPeriodOptions\"\n:timeBinOptions=\"timeBinOptions\"\n:timezoneOptions=\"timezoneOptions\"\n:methodOptions=\"methodOptions\"\n:debugMode=\"debugMode\"\n:originalDataPointCount=\"originalDataPointCount\"\n\nv-model:validFoldingForData=\"validFoldingForData\"\nv-model:validTimeBinForData=\"validTimeBinForData\"\nv-model:isValidCombination=\"isValidCombination\"\nv-model:useTzCenter=\"useTzCenter\"\nv-model:tzCenter=\"tzCenter\"\nv-model:selectedTimezone=\"selectedTimezone\"\nv-model:showErrors=\"showErrors\"\nv-model:useErrorBars=\"useErrorBars\"\nv-model:useSEM=\"useSEM\"\nv-model:alignDataToBinCenters=\"alignDataToBinCenters\"\nv-model:disableIncludePhaseCheckbox=\"disableIncludePhaseCheckbox\"\nv-model:alignToBinCenter=\"alignToBinCenter\"\nv-model:disableBinCenterCheckbox=\"disableBinCenterCheckbox\"\nv-model:foldedDataPointCount=\"foldedDataPointCount\"\nv-model:selectedFoldType=\"selectedFoldType\"\nv-model:canSave=\"canSave\"\nv-model:saveFolding=\"saveFolding\"\nv-model:closeDialog=\"closeDialog\"\nv-model:selectedFoldingPeriod=\"selectedFoldingPeriod\"\nv-model:selectedTimeBin=\"selectedTimeBin\"\nv-model:selectedMethod=\"selectedMethod\"\nv-model:foldedData=\"foldedData\"\n*/\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'AggregationControls',\n  props: /*@__PURE__*/_mergeModels({\n    foldingPeriodOptions: {},\n    timeBinOptions: {},\n    timezoneOptions: {},\n    methodOptions: {},\n    debugMode: { type: Boolean },\n    originalDataPointCount: {},\n    foldedDataPointCount: {},\n    canSave: { type: Boolean }\n  }, {\n    \"validFoldingForData\": { type: Function, ...{ required: true } },\n    \"validFoldingForDataModifiers\": {},\n    \"validTimeBinForData\": { type: Function, ...{ required: true } },\n    \"validTimeBinForDataModifiers\": {},\n    \"isValidCombination\": { type: Function, ...{ required: true } },\n    \"isValidCombinationModifiers\": {},\n    \"useTzCenter\": { type: Boolean, ...{ required: true } },\n    \"useTzCenterModifiers\": {},\n    \"tzCenter\": { required: true },\n    \"tzCenterModifiers\": {},\n    \"selectedTimezone\": { required: true },\n    \"selectedTimezoneModifiers\": {},\n    \"showErrors\": { type: Boolean, ...{ required: true } },\n    \"showErrorsModifiers\": {},\n    \"useErrorBars\": { type: Boolean, ...{ required: true } },\n    \"useErrorBarsModifiers\": {},\n    \"useSEM\": { type: Boolean, ...{ required: true } },\n    \"useSEMModifiers\": {},\n    \"alignDataToBinCenters\": { type: Boolean, ...{ required: true } },\n    \"alignDataToBinCentersModifiers\": {},\n    \"disableIncludePhaseCheckbox\": { type: Boolean, ...{ required: true } },\n    \"disableIncludePhaseCheckboxModifiers\": {},\n    \"alignToBinCenter\": { type: Boolean, ...{ required: true } },\n    \"alignToBinCenterModifiers\": {},\n    \"disableBinCenterCheckbox\": { type: Boolean, ...{ required: true } },\n    \"disableBinCenterCheckboxModifiers\": {},\n    \"selectedFoldType\": { required: true },\n    \"selectedFoldTypeModifiers\": {},\n    \"selectedFoldingPeriod\": { required: true },\n    \"selectedFoldingPeriodModifiers\": {},\n    \"selectedTimeBin\": { required: true },\n    \"selectedTimeBinModifiers\": {},\n    \"selectedMethod\": { required: true },\n    \"selectedMethodModifiers\": {},\n    \"foldedData\": { required: true },\n    \"foldedDataModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels(['save', 'cancel'], [\"update:validFoldingForData\", \"update:validTimeBinForData\", \"update:isValidCombination\", \"update:useTzCenter\", \"update:tzCenter\", \"update:selectedTimezone\", \"update:showErrors\", \"update:useErrorBars\", \"update:useSEM\", \"update:alignDataToBinCenters\", \"update:disableIncludePhaseCheckbox\", \"update:alignToBinCenter\", \"update:disableBinCenterCheckbox\", \"update:selectedFoldType\", \"update:selectedFoldingPeriod\", \"update:selectedTimeBin\", \"update:selectedMethod\", \"update:foldedData\"]),\n  setup(__props: any, { emit: __emit }) {\n\n\n\n\n\nconst validFoldingForData = _useModel<(foldType: FoldingPeriodOptions) => boolean>(__props, 'validFoldingForData');\nconst validTimeBinForData = _useModel<(timeBin: TimeBinOptions) => boolean>(__props, 'validTimeBinForData');\nconst isValidCombination = _useModel<(timeBin: TimeBinOptions, foldingPeriod: FoldingPeriodOptions) => boolean>(__props, 'isValidCombination');\nconst useTzCenter = _useModel<boolean>(__props, 'useTzCenter');\nconst tzCenter = _useModel<string>(__props, 'tzCenter');\nconst selectedTimezone = _useModel<string>(__props, 'selectedTimezone');\nconst showErrors = _useModel<boolean>(__props, 'showErrors');\nconst useErrorBars = _useModel<boolean>(__props, 'useErrorBars');\nconst useSEM = _useModel<boolean>(__props, 'useSEM');\nconst alignDataToBinCenters = _useModel<boolean>(__props, 'alignDataToBinCenters');\nconst disableIncludePhaseCheckbox = _useModel<boolean>(__props, 'disableIncludePhaseCheckbox');\nconst alignToBinCenter = _useModel<boolean>(__props, 'alignToBinCenter');\nconst disableBinCenterCheckbox = _useModel<boolean>(__props, 'disableBinCenterCheckbox');\nconst selectedFoldType = _useModel<FoldType>(__props, 'selectedFoldType');\nconst selectedFoldingPeriod = _useModel<FoldingPeriodOptions>(__props, 'selectedFoldingPeriod');\nconst selectedTimeBin = _useModel<TimeBinOptions>(__props, 'selectedTimeBin');\nconst selectedMethod = _useModel<AggregationMethod>(__props, 'selectedMethod');\nconst foldedData = _useModel<FoldedTimeSeriesData | null>(__props, 'foldedData');\n\n// emits: save, cancel\nconst emit = __emit;\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_info_button = _resolveComponent(\"info-button\")!\n  const _component_v_chip = _resolveComponent(\"v-chip\")!\n  const _component_v_chip_group = _resolveComponent(\"v-chip-group\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_select = _resolveComponent(\"v-select\")!\n  const _component_v_card_subtitle = _resolveComponent(\"v-card-subtitle\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"h3\", null, [\n      _createVNode(_component_info_button, null, {\n        default: _withCtx(() => [...(_cache[12] || (_cache[12] = [\n          _createElementVNode(\"div\", { class: \"explainer-text\" }, [\n            _createElementVNode(\"div\", null, \" Greyed out options are options which are either not able to be applied to the current dataset (due to insufficient data), or which are incompatible with other selected options. \"),\n            _createElementVNode(\"hr\"),\n            _createElementVNode(\"strong\", { class: \"text-red\" }, \"FIX\"),\n            _createTextVNode(\" We \\\"stack\\\" data by re-aligning data based on the period you set. For example, if we fold by \\\"Week\\\", then Select the period over which to stack the data. Selecting \\\"None\\\" will simply bin the data without stacking. \")\n          ], -1)\n        ]))]),\n        _: 1\n      }),\n      _cache[13] || (_cache[13] = _createTextVNode(\" Stack data by... \", -1))\n    ]),\n    _createVNode(_component_v_chip_group, {\n      modelValue: selectedFoldingPeriod.value,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((selectedFoldingPeriod).value = $event)),\n      column: \"\",\n      class: \"mb-3\"\n    }, {\n      default: _withCtx(() => [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.foldingPeriodOptions, (option) => {\n          return (_openBlock(), _createBlock(_component_v_chip, {\n            key: option.value,\n            value: option.value,\n            color: \"#092088\",\n            variant: option.value === selectedFoldingPeriod.value ? 'flat' : 'outlined',\n            outline: \"\",\n            density: \"compact\",\n            disabled: !validFoldingForData.value(option.value as FoldingPeriodOptions)\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(option.title), 1)\n            ]),\n            _: 2\n          }, 1032, [\"value\", \"variant\", \"disabled\"]))\n        }), 128))\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createElementVNode(\"h3\", null, [\n      _createVNode(_component_info_button, null, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_2, [\n            _cache[18] || (_cache[18] = _createElementVNode(\"strong\", { class: \"text-red\" }, \"FIX\", -1)),\n            _cache[19] || (_cache[19] = _createTextVNode(\" Select the resolution (bin size) within which we will aggregate the data. When aggregating data, we take all of the data in a bin (say a 1 hour bins around 1pm ) and computed a single (average) value for it, such as a mean or a max value. \", -1)),\n            _cache[20] || (_cache[20] = _createElementVNode(\"hr\", null, null, -1)),\n            _createElementVNode(\"div\", null, [\n              (selectedTimeBin.value === 'hour')\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [...(_cache[14] || (_cache[14] = [\n                    _createElementVNode(\"dt\", null, \"Hour\", -1),\n                    _createElementVNode(\"dd\", null, \" Rounds data to the nearest hour. For example: Date from 12:30pm to 1:29pm will go into the 1pm bin. The binned point, shown in black is placed on the hour (e.g. at 1:00pm). \", -1)\n                  ]))]))\n                : (selectedTimeBin.value === 'day')\n                  ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [...(_cache[15] || (_cache[15] = [\n                      _createElementVNode(\"dt\", null, \"Day\", -1),\n                      _createElementVNode(\"dd\", null, \"Bins all data within a date. For example, all data points occuring on Dec 5 2025, or on Aug 28 2024, etc. The binned point, shown in black is placed at local noon (12:00pm) of that day. \", -1)\n                    ]))]))\n                  : (selectedTimeBin.value === 'week')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[16] || (_cache[16] = [\n                        _createElementVNode(\"dt\", null, \"Week\", -1),\n                        _createElementVNode(\"dd\", null, \" Rounds data to the nearest week. Weeks start on Sunday. For example: Date from Sunday 12:00am to Saturday 11:59pm will go into the week bin. The binned point, shown in black is placed at local noon (12:00pm) on Wednesday of that week. \", -1)\n                      ]))]))\n                    : (selectedTimeBin.value === 'month')\n                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [...(_cache[17] || (_cache[17] = [\n                          _createElementVNode(\"dt\", null, \"Month\", -1),\n                          _createElementVNode(\"dd\", null, \" Rounds data to the nearest month. For example: Date from the 1st of the month 12:00am to the last day of the month 11:59pm will go into the month bin. The binned point, shown in black is placed at local noon (12:00pm) on the 15th of that month. \", -1)\n                        ]))]))\n                      : _createCommentVNode(\"\", true)\n            ])\n          ])\n        ]),\n        _: 1\n      }),\n      _cache[21] || (_cache[21] = _createTextVNode(\" Average data over... \", -1))\n    ]),\n    _createVNode(_component_v_chip_group, {\n      modelValue: selectedTimeBin.value,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((selectedTimeBin).value = $event)),\n      column: \"\",\n      class: \"mb-3\"\n    }, {\n      default: _withCtx(() => [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.timeBinOptions, (option) => {\n          return (_openBlock(), _createBlock(_component_v_chip, {\n            key: option.value,\n            value: option.value,\n            color: \"#092088\",\n            variant: option.value === selectedTimeBin.value ? 'flat' : 'outlined',\n            density: \"compact\",\n            disabled: !validTimeBinForData.value(option.value as TimeBinOptions) || !isValidCombination.value(option.value as TimeBinOptions, selectedFoldingPeriod.value)\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(option.title), 1)\n            ]),\n            _: 2\n          }, 1032, [\"value\", \"variant\", \"disabled\"]))\n        }), 128))\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    false\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n          _createVNode(_component_v_checkbox, {\n            modelValue: useTzCenter.value,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((useTzCenter).value = $event)),\n            label: `Use timezone of region center: ${tzCenter.value}`,\n            density: \"compact\",\n            \"hide-details\": \"\",\n            class: \"mb-1\"\n          }, null, 8, [\"modelValue\", \"label\"])\n        ]))\n      : _createCommentVNode(\"\", true),\n    (!useTzCenter.value)\n      ? (_openBlock(), _createBlock(_component_v_select, {\n          key: 1,\n          modelValue: selectedTimezone.value,\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((selectedTimezone).value = $event)),\n          items: __props.timezoneOptions,\n          label: \"Timezone\",\n          density: \"compact\",\n          variant: \"outlined\",\n          \"hide-details\": \"\",\n          class: \"mb-3\"\n        }, null, 8, [\"modelValue\", \"items\"]))\n      : _createCommentVNode(\"\", true),\n    _createVNode(_component_v_select, {\n      modelValue: selectedMethod.value,\n      \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((selectedMethod).value = $event)),\n      items: __props.methodOptions,\n      label: \"Aggregation Method\",\n      density: \"compact\",\n      variant: \"outlined\",\n      \"hide-details\": \"\",\n      class: \"mb-3\"\n    }, null, 8, [\"modelValue\", \"items\"]),\n    _createElementVNode(\"div\", _hoisted_8, [\n      _createVNode(_component_v_checkbox, {\n        modelValue: showErrors.value,\n        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((showErrors).value = $event)),\n        label: \"Show Errors\",\n        density: \"compact\",\n        disabled: selectedMethod.value == 'min' || selectedMethod.value == 'max',\n        \"hide-details\": \"\",\n        class: \"mb-3\"\n      }, null, 8, [\"modelValue\", \"disabled\"]),\n      _createVNode(_component_v_checkbox, {\n        modelValue: useErrorBars.value,\n        \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => ((useErrorBars).value = $event)),\n        label: \"Use Error Bars\",\n        density: \"compact\",\n        \"hide-details\": \"\",\n        class: \"mb-3\"\n      }, null, 8, [\"modelValue\"]),\n      _createVNode(_component_v_checkbox, {\n        modelValue: useSEM.value,\n        \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((useSEM).value = $event)),\n        label: \"Use Standard Error of the Mean\",\n        density: \"compact\",\n        \"hide-details\": \"\",\n        class: \"mb-3\"\n      }, null, 8, [\"modelValue\"]),\n      _createVNode(_component_v_checkbox, {\n        modelValue: alignDataToBinCenters.value,\n        \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((alignDataToBinCenters).value = $event)),\n        label: \"Align Data to bins\",\n        density: \"compact\",\n        disabled: !disableIncludePhaseCheckbox.value,\n        \"hide-details\": \"\",\n        class: \"mb-3\"\n      }, null, 8, [\"modelValue\", \"disabled\"]),\n      false\n        ? (_openBlock(), _createBlock(_component_v_checkbox, {\n            key: 0,\n            modelValue: alignToBinCenter.value,\n            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((alignToBinCenter).value = $event)),\n            label: \"Center bins\",\n            density: \"compact\",\n            disabled: !disableBinCenterCheckbox.value,\n            \"hide-details\": \"\",\n            class: \"mb-3\"\n          }, null, 8, [\"modelValue\", \"disabled\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    (__props.debugMode)\n      ? (_openBlock(), _createBlock(_component_v_card, {\n          key: 2,\n          height: \"fit-content\",\n          variant: \"tonal\",\n          class: \"pa-2 mb-3\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_card_subtitle, { class: \"pa-0\" }, {\n              default: _withCtx(() => [...(_cache[22] || (_cache[22] = [\n                _createTextVNode(\"Preview\", -1)\n              ]))]),\n              _: 1\n            }),\n            _createElementVNode(\"div\", _hoisted_9, [\n              _createElementVNode(\"div\", null, \"Original points: \" + _toDisplayString(__props.originalDataPointCount), 1),\n              _createElementVNode(\"div\", null, \"Aggregated points: \" + _toDisplayString(__props.foldedDataPointCount), 1),\n              _createElementVNode(\"div\", null, \"Time Bin: \" + _toDisplayString(selectedTimeBin.value), 1),\n              _createElementVNode(\"div\", null, \"Folding Period: \" + _toDisplayString(selectedFoldingPeriod.value), 1),\n              _createElementVNode(\"div\", null, \"Fold Type: \" + _toDisplayString(selectedFoldType.value), 1),\n              _createElementVNode(\"div\", null, \"First bin: \" + _toDisplayString(foldedData.value && foldedData.value.bins ? Object.keys(foldedData.value.bins)[0] : 'N/A'), 1),\n              (foldedData.value && foldedData.value.bins && foldedData.value.bins[Object.keys(foldedData.value.bins)[0]] && foldedData.value.values[Object.keys(foldedData.value.bins)[0]] && foldedData.value.values[Object.keys(foldedData.value.bins)[0]].date)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \" First bin time: \"))\n                : _createCommentVNode(\"\", true)\n            ])\n          ]),\n          _: 1\n        }))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", _hoisted_11, [\n      _createVNode(_component_v_btn, {\n        color: \"primary\",\n        onClick: _cache[10] || (_cache[10] = () => emit('save')),\n        disabled: !__props.canSave,\n        size: \"small\",\n        \"prepend-icon\": \"mdi-content-save-outline\"\n      }, {\n        default: _withCtx(() => [...(_cache[23] || (_cache[23] = [\n          _createTextVNode(\" Save Stacked Data \", -1)\n        ]))]),\n        _: 1\n      }, 8, [\"disabled\"]),\n      _createVNode(_component_v_btn, {\n        color: \"secondary\",\n        variant: \"outlined\",\n        onClick: _cache[11] || (_cache[11] = () => emit('cancel')),\n        size: \"small\"\n      }, {\n        default: _withCtx(() => [...(_cache[24] || (_cache[24] = [\n          _createTextVNode(\" Cancel \", -1)\n        ]))]),\n        _: 1\n      })\n    ])\n  ]))\n}\n}\n\n})","<!-- eslint-disable vue/no-mutating-props -->\n<template>\n\t<!-- Folding Period Selection -->\n\t<div class=\"aggregation-controls\">\n\t\t<h3>\n\t\t\t<info-button>\n\t\t\t\t<div class=\"explainer-text\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\tGreyed out options are options which are either not able to be applied to the current dataset (due to\n\t\t\t\t\t\tinsufficient data), or\n\t\t\t\t\t\twhich are incompatible with other selected options.\n\t\t\t\t\t</div>\n\t\t\t\t\t<hr />\n\t\t\t\t\t<strong class=\"text-red\">FIX</strong>\n\t\t\t\t\tWe \"stack\" data by re-aligning data based on the period you set. For example, if we fold by \"Week\", then\n\n\t\t\t\t\tSelect the period over which to stack the data. Selecting \"None\" will simply bin the data without stacking.\n\t\t\t\t</div>\n\t\t\t</info-button>\n\t\t\tStack data by...\n\t\t</h3>\n\t\t<v-chip-group v-model=\"selectedFoldingPeriod\" column class=\"mb-3\">\n\t\t\t<v-chip v-for=\"option in foldingPeriodOptions\" :key=\"option.value\" :value=\"option.value\" color=\"#092088\"\n\t\t\t\t:variant=\"option.value === selectedFoldingPeriod ? 'flat' : 'outlined'\" outline density=\"compact\"\n\t\t\t\t:disabled=\"!validFoldingForData(option.value as FoldingPeriodOptions)\">\n\t\t\t\t{{ option.title }}\n\t\t\t</v-chip>\n\t\t</v-chip-group>\n\n\n\n\n\t\t<!-- Time Bin Selection -->\n\t\t<!-- use chips for select -->\n\t\t<h3>\n\t\t\t<info-button>\n\t\t\t\t<div class=\"explainer-text\">\n\t\t\t\t\t<strong class=\"text-red\">FIX</strong>\n\t\t\t\t\tSelect the resolution (bin size) within which we will aggregate the data.\n\t\t\t\t\tWhen aggregating data, we take all of the data in a bin (say a 1 hour bins around 1pm ) and\n\t\t\t\t\tcomputed a single (average) value for it, such as a mean or a max value.\n\t\t\t\t\t<hr />\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div v-if=\"selectedTimeBin === 'hour'\">\n\t\t\t\t\t\t\t<dt>Hour</dt>\n\t\t\t\t\t\t\t<dd>\n\t\t\t\t\t\t\t\tRounds data to the nearest hour. For example: Date from 12:30pm to 1:29pm will go into the 1pm bin.\n\t\t\t\t\t\t\t\tThe binned point, shown in black is placed on the hour (e.g. at 1:00pm).\n\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-else-if=\"selectedTimeBin === 'day'\">\n\t\t\t\t\t\t\t<dt>Day</dt>\n\t\t\t\t\t\t\t<dd>Bins all data within a date. For example, all data points occuring on Dec 5 2025, or on Aug 28 2024,\n\t\t\t\t\t\t\t\tetc.\n\t\t\t\t\t\t\t\tThe binned point, shown in black is placed at local noon (12:00pm) of that day.\n\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-else-if=\"selectedTimeBin === 'week'\">\n\t\t\t\t\t\t\t<dt>Week</dt>\n\t\t\t\t\t\t\t<dd>\n\t\t\t\t\t\t\t\tRounds data to the nearest week. Weeks start on Sunday. For example: Date from Sunday 12:00am to\n\t\t\t\t\t\t\t\tSaturday\n\t\t\t\t\t\t\t\t11:59pm will go into the week bin.\n\t\t\t\t\t\t\t\tThe binned point, shown in black is placed at local noon (12:00pm) on Wednesday of that week.\n\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-else-if=\"selectedTimeBin === 'month'\">\n\t\t\t\t\t\t\t<dt>Month</dt>\n\t\t\t\t\t\t\t<dd>\n\t\t\t\t\t\t\t\tRounds data to the nearest month.\n\t\t\t\t\t\t\t\tFor example: Date from the 1st of the month 12:00am to the last day of the month 11:59pm will go into\n\t\t\t\t\t\t\t\tthe\n\t\t\t\t\t\t\t\tmonth bin.\n\t\t\t\t\t\t\t\tThe binned point, shown in black is placed at local noon (12:00pm) on the 15th of that month.\n\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</info-button>\n\t\t\tAverage data over...\n\t\t</h3>\n\t\t<v-chip-group v-model=\"selectedTimeBin\" column class=\"mb-3\">\n\t\t\t<v-chip v-for=\"option in timeBinOptions\" :key=\"option.value\" :value=\"option.value\" color=\"#092088\"\n\t\t\t\t:variant=\"option.value === selectedTimeBin ? 'flat' : 'outlined'\" density=\"compact\"\n\t\t\t\t:disabled=\"!validTimeBinForData(option.value as TimeBinOptions) || !isValidCombination(option.value as TimeBinOptions, selectedFoldingPeriod)\">\n\t\t\t\t{{ option.title }}\n\t\t\t</v-chip>\n\t\t</v-chip-group>\n\n\n\n\n\n\n\t\t<!-- Timezone Selection -->\n\t\t<div v-if=\"false\" class=\"selected-timezone-details d-flex mb-4\">\n\t\t\t<v-checkbox v-model=\"useTzCenter\" :label=\"`Use timezone of region center: ${tzCenter}`\" density=\"compact\"\n\t\t\t\thide-details class=\"mb-1\" />\n\t\t</div>\n\t\t<v-select v-if=\"!useTzCenter\" v-model=\"selectedTimezone\" :items=\"timezoneOptions\" label=\"Timezone\" density=\"compact\"\n\t\t\tvariant=\"outlined\" hide-details class=\"mb-3\" />\n\n\t\t<!-- Folding Method -->\n\t\t<v-select v-model=\"selectedMethod\" :items=\"methodOptions\" label=\"Aggregation Method\" density=\"compact\"\n\t\t\tvariant=\"outlined\" hide-details class=\"mb-3\" />\n\n\t\t<!-- Show Errors Toggle -->\n\t\t<div class=\"d-flex flex-row flex-wrap\">\n\t\t\t<v-checkbox v-model=\"showErrors\" label=\"Show Errors\" density=\"compact\"\n\t\t\t\t:disabled=\"selectedMethod == 'min' || selectedMethod == 'max'\" hide-details class=\"mb-3\" />\n\n\t\t\t<v-checkbox v-model=\"useErrorBars\" label=\"Use Error Bars\" density=\"compact\" hide-details class=\"mb-3\" />\n\n\t\t\t<!-- Show Errors Toggle -->\n\t\t\t<v-checkbox v-model=\"useSEM\" label=\"Use Standard Error of the Mean\" density=\"compact\" hide-details class=\"mb-3\" />\n\n\t\t\t<v-checkbox v-model=\"alignDataToBinCenters\" label=\"Align Data to bins\" density=\"compact\"\n\t\t\t\t:disabled=\"!disableIncludePhaseCheckbox\" hide-details class=\"mb-3\" />\n\n\t\t\t<v-checkbox v-if=\"false\" v-model=\"alignToBinCenter\" label=\"Center bins\" density=\"compact\"\n\t\t\t\t:disabled=\"!disableBinCenterCheckbox\" hide-details class=\"mb-3\" />\n\t\t</div>\n\t\t<!-- Preview Info -->\n\t\t<v-card v-if=\"debugMode\" height=\"fit-content\" variant=\"tonal\" class=\"pa-2 mb-3\">\n\t\t\t<v-card-subtitle class=\"pa-0\">Preview</v-card-subtitle>\n\t\t\t<div class=\"text-caption\">\n\t\t\t\t<div>Original points: {{ originalDataPointCount }}</div>\n\t\t\t\t<div>Aggregated points: {{ foldedDataPointCount }}</div>\n\t\t\t\t<div>Time Bin: {{ selectedTimeBin }}</div>\n\t\t\t\t<div>Folding Period: {{ selectedFoldingPeriod }}</div>\n\t\t\t\t<div>Fold Type: {{ selectedFoldType }}</div>\n\t\t\t\t<div>First bin: {{ foldedData && foldedData.bins ? Object.keys(foldedData.bins)[0] : 'N/A' }}</div>\n\t\t\t\t<!-- show first bins time in the local timezone if it's a date using toZonedTime -->\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"foldedData && foldedData.bins && foldedData.bins[Object.keys(foldedData.bins)[0]] && foldedData.values[Object.keys(foldedData.bins)[0]] && foldedData.values[Object.keys(foldedData.bins)[0]].date\">\n\t\t\t\t\tFirst bin time:\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</v-card>\n\n\t\t<!-- Action Buttons -->\n\t\t<div class=\"d-flex ga-2\">\n\t\t\t<v-btn color=\"primary\" @click=\"() => emit('save')\" :disabled=\"!canSave\" size=\"small\" prepend-icon=\"mdi-content-save-outline\">\n\t\t\t\tSave Stacked Data\n\t\t\t</v-btn>\n\t\t\t<v-btn color=\"secondary\" variant=\"outlined\" @click=\"() => emit('cancel')\" size=\"small\">\n\t\t\t\tCancel\n\t\t\t</v-btn>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { AggregationMethod , FoldType, FoldedTimeSeriesData} from '@/esri/services/aggregation';\n\nimport {\n  TimeBinOptions,\n  FoldingPeriodOptions,\n} from '@/utils/foldingValidation';\n\n\n/*\n:foldingPeriodOptions=\"foldingPeriodOptions\"\n:timeBinOptions=\"timeBinOptions\"\n:timezoneOptions=\"timezoneOptions\"\n:methodOptions=\"methodOptions\"\n:debugMode=\"debugMode\"\n:originalDataPointCount=\"originalDataPointCount\"\n\nv-model:validFoldingForData=\"validFoldingForData\"\nv-model:validTimeBinForData=\"validTimeBinForData\"\nv-model:isValidCombination=\"isValidCombination\"\nv-model:useTzCenter=\"useTzCenter\"\nv-model:tzCenter=\"tzCenter\"\nv-model:selectedTimezone=\"selectedTimezone\"\nv-model:showErrors=\"showErrors\"\nv-model:useErrorBars=\"useErrorBars\"\nv-model:useSEM=\"useSEM\"\nv-model:alignDataToBinCenters=\"alignDataToBinCenters\"\nv-model:disableIncludePhaseCheckbox=\"disableIncludePhaseCheckbox\"\nv-model:alignToBinCenter=\"alignToBinCenter\"\nv-model:disableBinCenterCheckbox=\"disableBinCenterCheckbox\"\nv-model:foldedDataPointCount=\"foldedDataPointCount\"\nv-model:selectedFoldType=\"selectedFoldType\"\nv-model:canSave=\"canSave\"\nv-model:saveFolding=\"saveFolding\"\nv-model:closeDialog=\"closeDialog\"\nv-model:selectedFoldingPeriod=\"selectedFoldingPeriod\"\nv-model:selectedTimeBin=\"selectedTimeBin\"\nv-model:selectedMethod=\"selectedMethod\"\nv-model:foldedData=\"foldedData\"\n*/\ndefineProps<{\n\tfoldingPeriodOptions: { title: string; value: FoldingPeriodOptions; }[];\n\ttimeBinOptions: { title: string; value: TimeBinOptions; }[];\n\ttimezoneOptions: { title: string; value: string; }[];\n\tmethodOptions: { title: string; value: string; }[];\n\tdebugMode: boolean;\n\toriginalDataPointCount: number;\n\tfoldedDataPointCount: number;\n\tcanSave: boolean;\n}>();\n\n\n\nconst validFoldingForData = defineModel<(foldType: FoldingPeriodOptions) => boolean>('validFoldingForData', { required: true });\nconst validTimeBinForData = defineModel<(timeBin: TimeBinOptions) => boolean>('validTimeBinForData', { required: true });\nconst isValidCombination = defineModel<(timeBin: TimeBinOptions, foldingPeriod: FoldingPeriodOptions) => boolean>('isValidCombination', { required: true });\nconst useTzCenter = defineModel<boolean>('useTzCenter', { required: true });\nconst tzCenter = defineModel<string>('tzCenter', { required: true });\nconst selectedTimezone = defineModel<string>('selectedTimezone', { required: true });\nconst showErrors = defineModel<boolean>('showErrors', { required: true });\nconst useErrorBars = defineModel<boolean>('useErrorBars', { required: true });\nconst useSEM = defineModel<boolean>('useSEM', { required: true });\nconst alignDataToBinCenters = defineModel<boolean>('alignDataToBinCenters', { required: true });\nconst disableIncludePhaseCheckbox = defineModel<boolean>('disableIncludePhaseCheckbox', { required: true });\nconst alignToBinCenter = defineModel<boolean>('alignToBinCenter', { required: true });\nconst disableBinCenterCheckbox = defineModel<boolean>('disableBinCenterCheckbox', { required: true });\nconst selectedFoldType = defineModel<FoldType>('selectedFoldType', { required: true });\nconst selectedFoldingPeriod = defineModel<FoldingPeriodOptions>('selectedFoldingPeriod', { required: true });\nconst selectedTimeBin = defineModel<TimeBinOptions>('selectedTimeBin', { required: true });\nconst selectedMethod = defineModel<AggregationMethod>('selectedMethod', { required: true });\nconst foldedData = defineModel<FoldedTimeSeriesData | null>('foldedData', { required: true });\n\n// emits: save, cancel\nconst emit = defineEmits(['save', 'cancel']);\n</script>\n","import script from \"./AggregationControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AggregationControls.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import type { TimeBinOptions, FoldingPeriodOptions } from '@/types';\nexport type { TimeBinOptions, FoldingPeriodOptions } from '@/types';\n\nconst validFoldingPeriodsForTimeBin: Record<TimeBinOptions, FoldingPeriodOptions[]> = {\n  'hour': [ 'none', 'day', 'week', 'month', 'year', 'weekdayWeekend',],\n  'day': ['none', 'week', 'month', 'year', 'weekdayWeekend', ],\n  'week': ['none', 'month', 'year', ],\n  'month': ['none', 'year', ],\n  'none' :  [ 'none', 'day', 'week', 'month', 'year']\n};\n\n\nconst validTimeBinsForFoldingPeriod: Record<FoldingPeriodOptions, (keyof typeof validFoldingPeriodsForTimeBin)[]> = {\n  'day': ['none', 'hour'],\n  'week': ['none', 'hour', 'day'],\n  'month': ['none', 'hour', 'day', 'week'],\n  'year': ['none', 'hour', 'day', 'week', 'month'],\n  'weekdayWeekend': ['hour', 'day'],\n  'none': ['none', 'hour', 'day', 'week', 'month'],\n};\n\n\nexport function getValidFoldingPeriods(timeBin: TimeBinOptions): FoldingPeriodOptions[] {\n  return validFoldingPeriodsForTimeBin[timeBin] || [];\n}\n\n\nexport function getValidTimeBins(foldingPeriod: FoldingPeriodOptions): TimeBinOptions[] {\n  return validTimeBinsForFoldingPeriod[foldingPeriod] || [];\n}\n\nexport function isValidCombination(timeBin: TimeBinOptions, foldingPeriod: FoldingPeriodOptions): boolean {\n  return validTimeBinsForFoldingPeriod[foldingPeriod]?.includes(timeBin) ?? false;\n}\n\nexport function getFirstValidTimeBin(foldingPeriod: FoldingPeriodOptions): TimeBinOptions {\n  const validTimeBins = validTimeBinsForFoldingPeriod[foldingPeriod];\n  return validTimeBins[0];\n}\n\nexport function getFirstValidFoldingPeriod(timeBin: TimeBinOptions): FoldingPeriodOptions {\n  const validFoldingPeriods = validFoldingPeriodsForTimeBin[timeBin];\n  return validFoldingPeriods[0];\n}","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, isRef as _isRef, createVNode as _createVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"df__left-pane\" }\nconst _hoisted_2 = { class: \"df__right-pane\" }\nconst _hoisted_3 = { class: \"df__graph-container\" }\nconst _hoisted_4 = {\n  key: 0,\n  id: \"below-graph-stuff\",\n  class: \"mt-2 explainer-text\"\n}\nconst _hoisted_5 = {\n  key: 0,\n  id: \"aggregation-warning\"\n}\nconst _hoisted_6 = {\n  key: 1,\n  class: \"d-flex justify-end mt-3\"\n}\n\nimport { ref, computed, watch, nextTick } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from 'uuid';\nimport { TimeSeriesFolder, sortfoldBinContent } from '../esri/services/aggregation';\nimport FoldedPlotlyGraph from './FoldedPlotlyGraph.vue';\nimport type { Prettify, UserDataset, PlotlyGraphDataSet, UnifiedRegion, MoleculeType } from '../types';\nimport type { TimeRangeSelectionType } from '@/types/datetime';\nimport type { AggregationMethod, TimeSeriesData, FoldedTimeSeriesData , FoldType, FoldBinContent} from '../esri/services/aggregation';\nimport tz_lookup from '@photostructure/tz-lookup';\nimport { toZonedTime, fromZonedTime } from 'date-fns-tz';\nimport { useTempoStore } from '@/stores/app';\nimport AggregationControls from './AggregationControls.vue';\nimport { moleculeDescriptor } from '@/esri/utils';\n\nimport {\n  TimeBinOptions,\n  FoldingPeriodOptions,\n  isValidCombination,\n  getFirstValidTimeBin\n} from '@/utils/foldingValidation';\n\ninterface DataFoldingProps {\n  selection: UserDataset | null;\n}\n\nconst MS_IN_HOUR = 3600000;\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DataFoldingAndBinning',\n  props: /*@__PURE__*/_mergeModels({\n    selection: {}\n  }, {\n    \"modelValue\": { type: Boolean, ...{ type: Boolean, required: true } },\n    \"modelModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"save\", \"controls-toggle\", \"plot-click\"], [\"update:modelValue\"]),\n  setup(__props: any, { emit: __emit }) {\n\n// eslint-disable @typescript-eslint/no-unused-vars */\nconst store = useTempoStore();\nconst {\n  debugMode,\n  showAggregationControls\n} = storeToRefs(store);\n\nconst props = __props;\n  \n\nconst emit = __emit;\n\n\n// Dialog state\nconst dialogOpen = _useModel<boolean>(__props, 'modelValue');\n\nconst theColor = computed(() => {\n  return props.selection?.customColor ?? (props.selection?.region.color ?? 'blue');\n});\n\n\nconst MS_IN_DAY = MS_IN_HOUR * 24;\nconst MS_IN_WEEK = MS_IN_DAY * 7;\nconst MS_IN_MONTH = MS_IN_DAY * 28; // to avoid invalidating February\nconst MS_IN_YEAR = MS_IN_DAY * 365.25;\n\nconst timeBinDurations: Record<TimeBinOptions, number> = {\n  'hour': MS_IN_HOUR,\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month': MS_IN_MONTH, \n  'none': 0,\n};\n\nconst foldingPeriodDurations: Record<FoldingPeriodOptions, number> = {\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month' : MS_IN_MONTH,\n  'year': MS_IN_YEAR,\n  'weekdayWeekend': MS_IN_WEEK, // weekend is part of week\n  'none': 0,\n};\n\nconst dataDuration = computed(() => {\n  if (!props.selection?.samples) return 0;\n  const timestamps = Object.values(props.selection.samples).map(s => s.date.getTime());\n  if (timestamps.length === 0) return 0;\n  // single loop to find min and max on unsorted array\n  // (but it may already be sorted, but we only need to do this once so it's fine)\n  const minMax = timestamps.reduce((acc, t) => {\n    return {\n      min: Math.min(acc.min, t),\n      max: Math.max(acc.max, t)\n    };\n  }, { min: Infinity, max: -Infinity });\n  return minMax.max - minMax.min;\n});\n\nfunction validTimeBinForData(timeBin: TimeBinOptions): boolean {\n  if (dataDuration.value === 0) return false;\n\n  return dataDuration.value >= timeBinDurations[timeBin];\n}\n\nfunction validFoldingForData(foldType: FoldingPeriodOptions): boolean {\n  if (dataDuration.value === 0) return false;\n  if (foldType === 'weekdayWeekend') {\n    return (props.selection?.samples && Object.values(props.selection?.samples).map(s => s.date.getDay()).some(d => d === 0 || d === 6)) as boolean; // has at least one weekend day\n  }\n  return dataDuration.value >= foldingPeriodDurations[foldType];\n}\n\nconst aggregationWarning = ref('');\n\n\n// Time bin and folding period options\nconst timeBinOptions: {title: string, value: TimeBinOptions}[] = [\n  { title: 'None', value: 'none' },\n  { title: 'Hour', value: 'hour' },\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' }\n];\n\nconst allFoldingPeriodOptions: {title: string, value: FoldingPeriodOptions}[] = [\n  { title: 'None', value: 'none' },\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' },\n  { title: 'Year', value: 'year' },\n  { title: 'Weekend/Weekday', value: 'weekdayWeekend' },\n];\n\n\n\n// Computed property to filter valid folding periods based on selected time bin\nconst foldingPeriodOptions = computed(() => {\n  return allFoldingPeriodOptions;\n});\n\n\nconst methodOptions = [\n  { title: 'Mean', value: 'mean' },\n  { title: 'Median', value: 'median' },\n  { title: 'Min', value: 'min' },\n  { title: 'Max', value: 'max' }\n];\n\nconst timezoneOptions = [\n  { title: 'US/Eastern', value: 'US/Eastern' },\n  { title: 'US/Central', value: 'US/Central' },\n  { title: 'US/Mountain', value: 'US/Mountain' },\n  { title: 'US/Arizona', value: 'US/Arizona' },\n  { title: 'US/Pacific', value: 'US/Pacific' },\n  { title: 'UTC', value: 'UTC' }\n];\n\n// Reactive state\nconst selectedTimeBin = ref<TimeBinOptions>('none');\nconst selectedFoldingPeriod = ref<FoldingPeriodOptions>('none');\nconst selectedMethod = ref<AggregationMethod>('mean');\nconst selectedTimezone = ref('US/Eastern');\nconst showErrors = ref(true);\nconst useSEM = ref(true);\nconst useErrorBars = ref(false);\n\nwatch(selectedFoldingPeriod, (newPeriod) => {\n  if (!isValidCombination(selectedTimeBin.value, newPeriod)) {\n    // Set to first valid option\n    const validTimeBin = getFirstValidTimeBin(newPeriod);\n    if (validTimeBin && validTimeBinForData(validTimeBin)) {\n      selectedTimeBin.value = validTimeBin;\n    } else {\n      selectedTimeBin.value = 'hour'; // default fallback\n    }\n  }\n});\n\n// Computed FoldType based on time bin and folding period selections\nconst selectedFoldType = computed<FoldType>(() => {\n  // Map the combination to the appropriate FoldType\n  const timeBin = selectedTimeBin.value;\n  const period = selectedFoldingPeriod.value;\n    \n  const foldType = `${timeBin}Of${period.charAt(0).toUpperCase()}${period.slice(1)}` as FoldType;\n  console.log('Computed FoldType:', foldType, 'from', timeBin, 'and', period);\n  return foldType;\n});\n\n\n\n\n// Check if we're using a None-period fold type (no actual folding)\nconst isNonePeriod = computed(() => {\n  return selectedFoldingPeriod.value === 'none';\n});\n\n// Check if we're using any hour-based fold type (which is always centered)\nconst isHourBinned = computed(() => {\n  return selectedTimeBin.value === 'hour';\n});\n\nconst isFoldWithNoBin = computed(() => {\n  return selectedTimeBin.value === 'none' && selectedFoldingPeriod.value !== 'none';\n});\n\nconst includeBinPhase = ref(true);\n// const alignToBinCenter = ref(true);\nconst alignToBinCenter = computed(() => {\n  if (isNonePeriod.value) return true;\n  if (selectedFoldingPeriod.value === 'weekdayWeekend') return false;\n  if (includeBinPhase.value === false) return false;\n  if (isHourBinned.value) return true;\n  if (selectedTimeBin.value === 'week' && selectedFoldingPeriod.value === 'year') return false;\n  return true;\n});\n\nconst alignDataToBinCenters = computed({\n  get() {\n    return !includeBinPhase.value;\n  },\n  set(value: boolean) {\n    includeBinPhase.value = !value;\n  }\n});\n\n\nconst disableBinCenterCheckbox = computed(() => {\n  return !isNonePeriod.value && includeBinPhase.value && !isHourBinned.value;\n});\n\nconst disableIncludePhaseCheckbox = computed(() => {\n  return !isNonePeriod.value;\n});\n\n// Watch to ensure selected folding period is valid when time bin changes\nwatch(selectedTimeBin, () => {\n  const validPeriods = foldingPeriodOptions.value.map(opt => opt.value);\n  if (!validPeriods.includes(selectedFoldingPeriod.value)) {\n    // Set to first valid option\n    if (validPeriods.length > 0) {\n      selectedFoldingPeriod.value = validPeriods[0];\n    }\n  }\n});\n\n// Watch for None-period types and reset incompatible options\nwatch(isNonePeriod, (isNone) => {\n  if (isNone) {\n    includeBinPhase.value = true;\n    // alignToBinCenter.value = true;\n  }\n});\n\nconst regionCenter = computed(() => {\n  const region = props.selection?.region as UnifiedRegion;\n  \n  if (region && region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  }\n  \n  if (region && region.geometryType === 'rectangle') {\n    const { xmin, ymin, xmax, ymax } = region.geometryInfo;\n    return { lat: (ymin + ymax) / 2, lon: (xmin + xmax) / 2 };\n  }\n  \n  return { lat: 0, lon: 0 };\n});\n\n\n\nconst useTzCenter = ref(true);\nconst tzCenter = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n\nif (regionCenter.value.lat !== 0 || regionCenter.value.lon !== 0) {\n  const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n  if (tz && useTzCenter.value) {\n    selectedTimezone.value = tz;\n  }\n}\n\nwatch(useTzCenter, (newVal) => {\n  if (newVal && regionCenter.value.lat !== 0 && regionCenter.value.lon !== 0) {\n    const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n    if (tz) {\n      selectedTimezone.value = tz;\n    }\n  }\n});\n\n// Computed properties\nconst originalDataPointCount = computed(() => {\n  if (!props.selection?.samples) return 0;\n  return Object.keys(props.selection.samples).length;\n});\n\nconst foldedDataPointCount = computed(() => {\n  if (!foldedData.value) return 0;\n  return Object.keys(foldedData.value.values).length;\n});\n\nconst canSave = computed(() => {\n  return !!(props.selection && foldedData.value && foldedDataPointCount.value > 0);\n});\n\nconst foldedDatasetName = computed(() => {\n  if (!props.selection?.name) return 'Stacked Data';\n  return `Aggregated ${props.selection.name ?? props.selection.region.name}`;// (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}, ${selectedMethod.value})`;\n});\n\n// Aggregated data\nconst foldedData = ref<FoldedTimeSeriesData | null>(null);\nconst foldedSelection = ref<null>(null);\n// Graph data for display - now a ref that gets manually updated\nconst graphData = ref<PlotlyGraphDataSet[]>([]);\n\nwatch(foldedData, (newvValue) => {\n  // if there is only one bin present the user with an aggregation warning\n  if (newvValue && newvValue.bins && Object.keys(newvValue.bins).length <= 1) {\n    aggregationWarning.value = (\"Warning: This combination of time bin and folding period results \" +\n      \"in only one bin. Please select a smaller time bin \" + \n      \"or a different folding period if available. In most cases, it is recommend to select 'None' for the folding period.\");\n  } else {\n    aggregationWarning.value = '';\n  }\n});\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction timeseriesToDataSet(timeseries: TimeSeriesData): Omit<PlotlyGraphDataSet, 'name'> {\n  const x: PlotlyGraphDataSet['x'] = [];\n  const y: PlotlyGraphDataSet['y'] = [];\n  const lower: PlotlyGraphDataSet['lower'] = [];\n  const upper: PlotlyGraphDataSet['upper'] = [];\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(timeseries.values).sort(([tsa, _a], [tsb, _b]) => parseInt(tsa) - parseInt(tsb));\n  // get the first timestamp\n  sortedEntries.forEach(([timestamp, aggValue]) => {\n    y.push(aggValue.value);\n    x.push(new Date(parseInt(timestamp)));\n    const error = timeseries.errors[timestamp];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper, errorType: 'bar' };\n}\n\nfunction foldedTimesSeriesToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotlyGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['noneOfNone','hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([binIndex, _binContent]) => {\n    const idx = parseInt(binIndex);\n    const aggValue = foldedTimeSeries.values[idx];\n    \n    // Use date if available (for None-period types), otherwise use bin index\n    if (isNonePeriod && aggValue.date) {\n      // For None-period types with dates, center bins by adding half the bin width\n      if (alignToBinCenter.value) {\n        const date = new Date(aggValue.date);\n        switch (foldedTimeSeries.foldType) {\n        case 'hourOfNone':\n          date.setMinutes(30); // Center of hour\n          break;\n        case 'dayOfNone':\n          date.setHours(date.getHours() + 12); // local Noon\n          break;\n        case 'weekOfNone':\n          date.setDate(date.getDate() + 3); // Middle of week (approx)\n          date.setHours(date.getHours() + 12);\n          break;\n        case 'monthOfNone':\n          date.setDate(15); // Middle of month (approx)\n          break;\n        }\n        x.push(date);\n      } else {\n        x.push(aggValue.date);\n      }\n    } else {\n      if (foldedTimeSeries.foldType !== 'hourOfDay') {\n        x.push(idx + (alignToBinCenter.value ? 0.5 : 0));\n      } else {\n        x.push(idx);\n      }\n    }\n    \n    y.push(aggValue.value);\n    const error = foldedTimeSeries.errors[idx];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper, errorType: useErrorBars.value ? 'bar' : 'band' };\n}\n  \nfunction foldedTimeSeriesRawToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotlyGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n  const customdata: Date[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([_binIndex, binContent]) => {\n    const sortedBinContent = sortfoldBinContent(binContent);\n    const bins = sortedBinContent as Prettify<FoldBinContent>;\n    \n    bins.rawValues.forEach((rv, index) => {\n      if (isNonePeriod) {\n        // For None-period types, use the actual timestamp\n        x.push(new Date(bins.timestamps[index]));\n      } else {\n        // For regular fold types, use bin index with optional phase\n        x.push(bins.bin + (includeBinPhase.value ? bins.binPhase[index] : 0));\n      }\n      customdata.push(toZonedTime(new Date(bins.timestamps[index]), selectedTimezone.value));\n      y.push(rv);\n    });\n    bins.lowers.forEach(low => {\n      lower.push(low ?? null);\n    });\n    bins.uppers.forEach(up => {\n      upper.push(up ?? null);\n    });\n  });\n  // the ascii +- symbol is this characher: \n  const hovertemplate = '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>';\n  \n  return { x, y, lower, upper, errorType: 'bar', datasetOptions: { customdata, hovertemplate } };\n}\n\n// Function to update graph data\nfunction updateGraphData() {\n  console.log(\"Updating graph data\");\n  if (!props.selection) {\n    graphData.value = [];\n    return;\n  }\n  \n  // const data = [timeseriesToDataSet(selectionToTimeseries(props.selection))]; // Original data\n  const data: PlotlyGraphDataSet[] = [];\n  \n  if (foldedData.value) {\n    const t = foldedTimeSeriesRawToDataSet(foldedData.value); // Raw folded data\n    (t as PlotlyGraphDataSet).name = props.selection.name || 'Original Data';\n    (t as PlotlyGraphDataSet).errorType = 'bar';\n    data.push(t as PlotlyGraphDataSet); // Raw folded data\n    if (!isFoldWithNoBin.value) {\n      const f = foldedTimesSeriesToDataSet(foldedData.value); // Summary folded data\n      (f as PlotlyGraphDataSet).name = foldedDatasetName.value;\n      data.push(f as PlotlyGraphDataSet); // Summary folded data\n    }\n  } else {\n    // No folded data, just show original\n    const original = timeseriesToDataSet(selectionToTimeseries(props.selection));\n    (original as PlotlyGraphDataSet).name = props.selection.name || 'Original Data';\n    data.push(original as PlotlyGraphDataSet);\n  }\n  console.log(\"Prepared graph data:\", data);\n  graphData.value = data;\n  console.log(\"Graph data updated with\", data.length, \"datasets\");\n}\n\n// Create a time range for the folded data\nfunction createFoldedTimeRange() {\n  if (!props.selection) {\n    throw new Error('No selection available');\n  }\n  \n  const originalRange = props.selection.timeRange.range;\n  const ranges = Array.isArray(originalRange) ? originalRange : [originalRange];\n  \n  return {\n    id: v4(),\n    name: `Stacked (${selectedTimeBin.value} of ${selectedFoldingPeriod.value})`,\n    description: `Stacked data (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}) ${selectedMethod.value}`,\n    range: ranges,\n    type: 'folded' as TimeRangeSelectionType,\n    source: props.selection.timeRange,\n  };\n}\n\n\n// Only recalculate when data-affecting parameters change\nwatch([selectedTimeBin, selectedFoldingPeriod, selectedMethod, selectedTimezone, useSEM], \n  updateAggregatedData, { immediate: true });\n\n// Handle display-only changes separately\nwatch([useErrorBars, alignToBinCenter, includeBinPhase], updateGraphData);\n\nfunction selectionToTimeseries(selection: UserDataset): TimeSeriesData {\n  return {\n    values: selection.samples || {},\n    errors: selection.errors || {},\n    locations: selection.locations || [],\n    geometryType: selection.region.geometryType || 'rectangle'\n  };\n}\n\n// Update folded data when parameters change\nfunction updateAggregatedData() {\n  console.log(\"Updating folded data with time bin:\", selectedTimeBin.value, \"folding period:\", selectedFoldingPeriod.value, \"fold type:\", selectedFoldType.value, \"method:\", selectedMethod.value, \"timezone:\", selectedTimezone.value);\n  if (!props.selection?.samples) {\n    foldedData.value = null;\n    return;\n  }\n  \n  try {\n    \n    // Convert the selection data to TimeSeriesData format\n    const timeSeriesData = selectionToTimeseries(props.selection);\n    \n    let foldType = selectedFoldType.value;\n    if (isFoldWithNoBin.value) {\n      foldType = foldType.replace('noneOf', 'hourOf') as FoldType;\n    }\n    \n    const grouper = new TimeSeriesFolder(\n      foldType,  // Use the computed fold type\n      selectedTimezone.value, \n      selectedMethod.value, \n      useSEM.value ? 'sem' : 'std', true);\n    foldedData.value = grouper.foldData(timeSeriesData);\n    \n  } catch (error) {\n    console.error('Error aggregating data:', error);\n    foldedData.value = null;\n    foldedSelection.value = null;\n  }\n  \n  // Update graph data after folding\n  updateGraphData();\n  console.log(\"graphData after update:\", graphData.value);\n}\n\nfunction handlePointClick(value: {x: Plotly.Datum, y: number, customdata: unknown}) {\n  console.log(\"Point clicked:\", value);\n  console.log(\"Custom data Date:\", value.customdata ? value.customdata as Date: value.customdata);\n  // the from timezoned time is what we want to to send work with if we go back to esri stuff\n  console.log(\"fromZonedTime\", value.customdata ? fromZonedTime(value.customdata as Date, selectedTimezone.value) : value.customdata);\n  emit('plot-click', {\n    x: value.x,\n    y: value.y,\n    customdata: value.customdata,\n    molecule: props.selection?.molecule as MoleculeType,\n    region: props.selection?.region as UnifiedRegion\n  });\n  return;\n}\n\n// Save the folding\nfunction saveFolding() {\n  \n  if (!canSave.value || !props.selection || !foldedData.value) return;\n  \n  // const rawDataset = foldedTimeSeriesRawToDataSet(foldedData.value);\n  // (rawDataset as PlotlyGraphDataSet).name = props.selection.name || 'Original Data';\n  // const summaryDataset = foldedTimesSeriesToDataSet(foldedData.value);\n  // (summaryDataset as PlotlyGraphDataSet).name = foldedDatasetName.value;\n\n  const foldedSelection: UserDataset = {\n    id: v4(),\n    region: { ...props.selection.region, name: props.selection.region.name } as typeof props.selection.region,\n    timeRange: createFoldedTimeRange(),\n    molecule: props.selection.molecule,\n    customColor: theColor.value,\n    loading: false, // folded data is immediately available\n    // samples/errors intentionally omitted for folded since bins are synthetic; rely on plotlyDatasets\n    locations: foldedData.value.locations,\n    name: foldedDatasetName.value,\n    folded: {\n      timeBin: selectedTimeBin.value,\n      foldingPeriod: selectedFoldingPeriod.value,\n      foldType: selectedFoldType.value,\n      method: selectedMethod.value,\n      timezone: selectedTimezone.value,\n      useSEM: useSEM.value,\n      includeBinPhase: includeBinPhase.value,\n      alignToBinCenter: alignToBinCenter.value,\n      useErrorBars: useErrorBars.value,\n      raw: foldedData.value\n    },\n    plotlyDatasets: [\n      {\n        ...graphData.value[0],\n        datasetOptions: {\n          ...graphData.value[0].datasetOptions,\n          mode: 'markers',\n          // hovertemplate: '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>'\n        }\n      } as PlotlyGraphDataSet,\n      {\n        ...graphData.value[1],\n        datasetOptions: {\n          mode: 'markers'\n        }\n      } as PlotlyGraphDataSet\n    ].slice(0, isFoldWithNoBin.value ? 1 : 2) // only include summary if not fold-with-no-bin\n  };\n  console.log(foldedSelection);\n  emit('save', foldedSelection);\n\n  closeDialog();\n}\n\n// Close dialog\nfunction closeDialog() {\n  dialogOpen.value = false;\n  // Reset state\n  nextTick(() => {\n    foldedData.value = null;\n  });\n}\n\n// Watch for selection changes\nwatch(() => props.selection, () => {\n  if (props.selection) {\n    updateAggregatedData();\n  }\n}, { immediate: true });\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_scroll_x_transition = _resolveComponent(\"v-scroll-x-transition\")!\n  const _component_side_placeholder = _resolveComponent(\"side-placeholder\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_local_scope = _resolveComponent(\"local-scope\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_row = _resolveComponent(\"v-row\")!\n\n  return (_openBlock(), _createBlock(_component_v_row, { class: \"df__panel-container\" }, {\n    default: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_1, [\n        _createVNode(_component_side_placeholder, {\n          open: _unref(showAggregationControls),\n          \"onUpdate:open\": _cache[17] || (_cache[17] = ($event: any) => (_isRef(showAggregationControls) ? (showAggregationControls).value = $event : null)),\n          \"open-direction\": \"right\",\n          icon: \"mdi-calculator\",\n          \"open-tooltip-text\": \"Show stacking and binning controls\",\n          \"closed-tooltip-text\": \"Close stacking and binning controls\",\n          \"open-arrow-color\": \"surface-variant\",\n          \"closed-arrow-color\": \"surface-variant\",\n          tooltips: \"\",\n          color: \"surface-variant\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_scroll_x_transition, null, {\n              default: _withCtx(() => [\n                _createVNode(AggregationControls, {\n                  foldingPeriodOptions: foldingPeriodOptions.value,\n                  validFoldingForData: validFoldingForData,\n                  timeBinOptions: timeBinOptions,\n                  validTimeBinForData: validTimeBinForData,\n                  isValidCombination: _unref(isValidCombination),\n                  useTzCenter: useTzCenter.value,\n                  \"onUpdate:useTzCenter\": _cache[0] || (_cache[0] = ($event: any) => ((useTzCenter).value = $event)),\n                  tzCenter: _unref(tzCenter),\n                  \"onUpdate:tzCenter\": _cache[1] || (_cache[1] = ($event: any) => (_isRef(tzCenter) ? (tzCenter).value = $event : null)),\n                  selectedTimezone: selectedTimezone.value,\n                  \"onUpdate:selectedTimezone\": _cache[2] || (_cache[2] = ($event: any) => ((selectedTimezone).value = $event)),\n                  timezoneOptions: timezoneOptions,\n                  methodOptions: methodOptions,\n                  showErrors: showErrors.value,\n                  \"onUpdate:showErrors\": _cache[3] || (_cache[3] = ($event: any) => ((showErrors).value = $event)),\n                  useErrorBars: useErrorBars.value,\n                  \"onUpdate:useErrorBars\": _cache[4] || (_cache[4] = ($event: any) => ((useErrorBars).value = $event)),\n                  useSEM: useSEM.value,\n                  \"onUpdate:useSEM\": _cache[5] || (_cache[5] = ($event: any) => ((useSEM).value = $event)),\n                  alignDataToBinCenters: alignDataToBinCenters.value,\n                  \"onUpdate:alignDataToBinCenters\": _cache[6] || (_cache[6] = ($event: any) => ((alignDataToBinCenters).value = $event)),\n                  disableIncludePhaseCheckbox: disableIncludePhaseCheckbox.value,\n                  \"onUpdate:disableIncludePhaseCheckbox\": _cache[7] || (_cache[7] = ($event: any) => ((disableIncludePhaseCheckbox).value = $event)),\n                  alignToBinCenter: alignToBinCenter.value,\n                  \"onUpdate:alignToBinCenter\": _cache[8] || (_cache[8] = ($event: any) => ((alignToBinCenter).value = $event)),\n                  disableBinCenterCheckbox: disableBinCenterCheckbox.value,\n                  \"onUpdate:disableBinCenterCheckbox\": _cache[9] || (_cache[9] = ($event: any) => ((disableBinCenterCheckbox).value = $event)),\n                  debugMode: _unref(debugMode),\n                  originalDataPointCount: originalDataPointCount.value,\n                  foldedDataPointCount: foldedDataPointCount.value,\n                  \"onUpdate:foldedDataPointCount\": _cache[10] || (_cache[10] = ($event: any) => ((foldedDataPointCount).value = $event)),\n                  selectedFoldType: selectedFoldType.value,\n                  \"onUpdate:selectedFoldType\": _cache[11] || (_cache[11] = ($event: any) => ((selectedFoldType).value = $event)),\n                  canSave: canSave.value,\n                  \"onUpdate:canSave\": _cache[12] || (_cache[12] = ($event: any) => ((canSave).value = $event)),\n                  onSave: saveFolding,\n                  onCancel: closeDialog,\n                  selectedFoldingPeriod: selectedFoldingPeriod.value,\n                  \"onUpdate:selectedFoldingPeriod\": _cache[13] || (_cache[13] = ($event: any) => ((selectedFoldingPeriod).value = $event)),\n                  selectedTimeBin: selectedTimeBin.value,\n                  \"onUpdate:selectedTimeBin\": _cache[14] || (_cache[14] = ($event: any) => ((selectedTimeBin).value = $event)),\n                  selectedMethod: selectedMethod.value,\n                  \"onUpdate:selectedMethod\": _cache[15] || (_cache[15] = ($event: any) => ((selectedMethod).value = $event)),\n                  foldedData: foldedData.value,\n                  \"onUpdate:foldedData\": _cache[16] || (_cache[16] = ($event: any) => ((foldedData).value = $event))\n                }, null, 8, [\"foldingPeriodOptions\", \"isValidCombination\", \"useTzCenter\", \"tzCenter\", \"selectedTimezone\", \"showErrors\", \"useErrorBars\", \"useSEM\", \"alignDataToBinCenters\", \"disableIncludePhaseCheckbox\", \"alignToBinCenter\", \"disableBinCenterCheckbox\", \"debugMode\", \"originalDataPointCount\", \"foldedDataPointCount\", \"selectedFoldType\", \"canSave\", \"selectedFoldingPeriod\", \"selectedTimeBin\", \"selectedMethod\", \"foldedData\"])\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        }, 8, [\"open\"])\n      ]),\n      _createElementVNode(\"div\", _hoisted_2, [\n        _createVNode(_component_v_card, {\n          class: \"df__right-pane-card\",\n          style: {\"height\":\"auto\"}\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_local_scope, {\n              descriptor: __props.selection?.molecule ? _unref(moleculeDescriptor)(__props.selection?.molecule) : null\n            }, {\n              default: _withCtx(({ descriptor }) => [\n                _createElementVNode(\"div\", _hoisted_3, [\n                  _createVNode(FoldedPlotlyGraph, {\n                    datasets: graphData.value,\n                    \"show-errors\": showErrors.value,\n                    \"fold-type\": selectedFoldType.value,\n                    colors: [theColor.value, '#333'],\n                    timezones: selectedTimezone.value,\n                    \"data-options\": [\n                      {mode: 'markers'}, // options for the original data\n                      {mode: 'markers'} // options for the folded data\n                      ],\n                    \"error-bar-styles\": [\n                      {'thickness': 1, 'width': 0}, // original data error bar style\n                      { 'thickness': 3, 'width': 0 } // folded data error bar style\n                    ],\n                    \"config-options\": {responsive: false, modeBarButtonsToRemove: ['autoScale2d', 'sendDataToCloud','lasso2d', 'select2d'], displaylogo: false},\n                    onPlotClick: handlePointClick,\n                    \"layout-options\": {\n                      margin: {t: 10, r: 20, b: 80, l: 90,}, \n                      autosize: false, width: 700, height: 400,\n                      xaxis: {\n                        automargin: false,\n                        gridcolor: 'rgba(128, 128, 128, 0.3)',\n                        title: {\n                          standoff: 10,\n                        },\n                      },\n                      yaxis: {\n                        automargin: false,\n                        gridcolor: 'rgba(128, 128, 128, 0.3)',\n                        title: {\n                          standoff: 10,\n                          text: `${descriptor?.shortName.html ?? ''} Quantity<br>(${descriptor?.unit.html ?? 'Molecules / cm<sup>2</sup>'})`,\n                        },\n                      },\n                      legend: {\n                        yanchor: 'top',\n                        yref: 'container',\n                        y: .99,\n                        orientation:'h' as |'h' | 'v',\n                        bordercolor: '#ccc', \n                        borderwidth:1,\n                        // @ts-ignore\n                        entrywidthmode: 'pixels',\n                        entrywidth: 0, // fit the text\n                      }\n                      }\n                  }, null, 8, [\"datasets\", \"show-errors\", \"fold-type\", \"colors\", \"timezones\", \"layout-options\"])\n                ]),\n                (_unref(showAggregationControls))\n                  ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                      (aggregationWarning.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _toDisplayString(aggregationWarning.value), 1))\n                        : _createCommentVNode(\"\", true)\n                    ]))\n                  : _createCommentVNode(\"\", true),\n                (!_unref(showAggregationControls) && canSave.value)\n                  ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                      _createVNode(_component_v_btn, {\n                        color: \"primary\",\n                        onClick: saveFolding,\n                        disabled: !canSave.value,\n                        size: \"small\",\n                        \"prepend-icon\": \"mdi-content-save-outline\"\n                      }, {\n                        default: _withCtx(() => [...(_cache[18] || (_cache[18] = [\n                          _createTextVNode(\" Save Folded Data \", -1)\n                        ]))]),\n                        _: 1\n                      }, 8, [\"disabled\"])\n                    ]))\n                  : _createCommentVNode(\"\", true)\n              ]),\n              _: 1\n            }, 8, [\"descriptor\"])\n          ]),\n          _: 1\n        })\n      ])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n  <!-- <v-dialog\n    v-model=\"dialogOpen\"\n    max-width=\"90vw\"\n    max-height=\"90vh\"\n    persistent\n    scrollable\n  > -->\n        <v-row class=\"df__panel-container\">\n          <!-- Left Panel: Folding Options with collapsible drawer -->\n          <div class=\"df__left-pane\">\n            <side-placeholder\n              v-model:open=\"showAggregationControls\"\n              open-direction=\"right\"\n              icon=\"mdi-calculator\"\n              open-tooltip-text=\"Show stacking and binning controls\"\n              closed-tooltip-text=\"Close stacking and binning controls\"\n              open-arrow-color=\"surface-variant\"\n              closed-arrow-color=\"surface-variant\"\n              tooltips\n              color=\"surface-variant\"\n            >\n              <v-scroll-x-transition>\n              <AggregationControls\n                :foldingPeriodOptions=\"foldingPeriodOptions\"\n                :validFoldingForData=\"validFoldingForData\"\n                :timeBinOptions=\"timeBinOptions\"\n                :validTimeBinForData=\"validTimeBinForData\"\n                :isValidCombination=\"isValidCombination\"\n                v-model:useTzCenter=\"useTzCenter\"\n                v-model:tzCenter=\"tzCenter\"\n                v-model:selectedTimezone=\"selectedTimezone\"\n                :timezoneOptions=\"timezoneOptions\"\n                :methodOptions=\"methodOptions\"\n                v-model:showErrors=\"showErrors\"\n                v-model:useErrorBars=\"useErrorBars\"\n                v-model:useSEM=\"useSEM\"\n                v-model:alignDataToBinCenters=\"alignDataToBinCenters\"\n                v-model:disableIncludePhaseCheckbox=\"disableIncludePhaseCheckbox\"\n                v-model:alignToBinCenter=\"alignToBinCenter\"\n                v-model:disableBinCenterCheckbox=\"disableBinCenterCheckbox\"\n                :debugMode=\"debugMode\"\n                :originalDataPointCount=\"originalDataPointCount\"\n                v-model:foldedDataPointCount=\"foldedDataPointCount\"\n                v-model:selectedFoldType=\"selectedFoldType\"\n                v-model:canSave=\"canSave\"\n                @save=\"saveFolding\"\n                @cancel=\"closeDialog\"\n                v-model:selectedFoldingPeriod=\"selectedFoldingPeriod\"\n                v-model:selectedTimeBin=\"selectedTimeBin\"\n                v-model:selectedMethod=\"selectedMethod\"\n                v-model:foldedData=\"foldedData\"\n              />\n              </v-scroll-x-transition>\n            </side-placeholder>\n          </div>\n          \n          <!-- Right Panel: Timeseries Graph -->\n          <div class=\"df__right-pane\">\n            <v-card class=\"df__right-pane-card\" style=\"height: auto;\">\n              <local-scope\n                :descriptor=\"selection?.molecule ? moleculeDescriptor(selection?.molecule) : null\"\n              >\n              <template #default=\"{ descriptor }\">\n                <div  class=\"df__graph-container\">\n                  <folded-plotly-graph\n                    :datasets=\"graphData\"\n                    :show-errors=\"showErrors\"\n                    :fold-type=\"selectedFoldType\"\n                    :colors=\"[theColor, '#333']\"\n                    :timezones=\"selectedTimezone\"\n                    :data-options=\"[\n                      {mode: 'markers'}, // options for the original data\n                      {mode: 'markers'} // options for the folded data\n                      ]\"\n                    :error-bar-styles=\"[\n                      {'thickness': 1, 'width': 0}, // original data error bar style\n                      { 'thickness': 3, 'width': 0 } // folded data error bar style\n                    ]\"\n                    :config-options=\"{responsive: false, modeBarButtonsToRemove: ['autoScale2d', 'sendDataToCloud','lasso2d', 'select2d'], displaylogo: false}\"\n                    @plot-click=\"handlePointClick\"\n                    :layout-options=\"{\n                      margin: {t: 10, r: 20, b: 80, l: 90,}, \n                      autosize: false, width: 700, height: 400,\n                      xaxis: {\n                        automargin: false,\n                        gridcolor: 'rgba(128, 128, 128, 0.3)',\n                        title: {\n                          standoff: 10,\n                        },\n                      },\n                      yaxis: {\n                        automargin: false,\n                        gridcolor: 'rgba(128, 128, 128, 0.3)',\n                        title: {\n                          standoff: 10,\n                          text: `${descriptor?.shortName.html ?? ''} Quantity<br>(${descriptor?.unit.html ?? 'Molecules / cm<sup>2</sup>'})`,\n                        },\n                      },\n                      legend: {\n                        yanchor: 'top',\n                        yref: 'container',\n                        y: .99,\n                        orientation:'h' as |'h' | 'v',\n                        bordercolor: '#ccc', \n                        borderwidth:1,\n                        // @ts-ignore\n                        entrywidthmode: 'pixels',\n                        entrywidth: 0, // fit the text\n                      }\n                      }\"\n                  />\n                </div>\n                <div v-if=\"showAggregationControls\" id=\"below-graph-stuff\" class=\"mt-2 explainer-text\">\n                  <div v-if=\"aggregationWarning\" id=\"aggregation-warning\">\n                    {{ aggregationWarning }}\n                  </div>\n                </div>\n                <!-- Save button visible when aggregation controls panel is collapsed -->\n                <div v-if=\"!showAggregationControls && canSave\" class=\"d-flex justify-end mt-3\">\n                  <v-btn color=\"primary\" @click=\"saveFolding\" :disabled=\"!canSave\" size=\"small\" prepend-icon=\"mdi-content-save-outline\">\n                    Save Folded Data\n                  </v-btn>\n                </div>\n              </template>\n            </local-scope>\n            </v-card>\n          </div>\n        </v-row>\n  <!-- </v-dialog> -->\n</template>\n\n<script setup lang=\"ts\">\n// eslint-disable @typescript-eslint/no-unused-vars */\nimport { ref, computed, watch, nextTick } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from 'uuid';\nimport { TimeSeriesFolder, sortfoldBinContent } from '../esri/services/aggregation';\nimport FoldedPlotlyGraph from './FoldedPlotlyGraph.vue';\nimport type { Prettify, UserDataset, PlotlyGraphDataSet, UnifiedRegion, MoleculeType } from '../types';\nimport type { TimeRangeSelectionType } from '@/types/datetime';\nimport type { AggregationMethod, TimeSeriesData, FoldedTimeSeriesData , FoldType, FoldBinContent} from '../esri/services/aggregation';\nimport tz_lookup from '@photostructure/tz-lookup';\nimport { toZonedTime, fromZonedTime } from 'date-fns-tz';\nimport { useTempoStore } from '@/stores/app';\nimport AggregationControls from './AggregationControls.vue';\nimport { moleculeDescriptor } from '@/esri/utils';\n\nconst store = useTempoStore();\nconst {\n  debugMode,\n  showAggregationControls\n} = storeToRefs(store);\n\nimport {\n  TimeBinOptions,\n  FoldingPeriodOptions,\n  isValidCombination,\n  getFirstValidTimeBin\n} from '@/utils/foldingValidation';\n\ninterface DataFoldingProps {\n  selection: UserDataset | null;\n}\n\nconst props = defineProps<DataFoldingProps>();\n  \n\nconst emit = defineEmits<{\n  (event: 'save', foldedSelection: UserDataset): void;\n  (event: 'controls-toggle', isOpen: boolean): void;\n  (event: \"plot-click\", value: {x: number | string | Date | null, y: number, customdata: unknown, molecule: MoleculeType, region: UnifiedRegion}): void;\n}>();\n\n\n// Dialog state\nconst dialogOpen = defineModel<boolean>('modelValue', { type: Boolean, required: true });\n\nconst theColor = computed(() => {\n  return props.selection?.customColor ?? (props.selection?.region.color ?? 'blue');\n});\n\n\nconst MS_IN_HOUR = 3600000;\nconst MS_IN_DAY = MS_IN_HOUR * 24;\nconst MS_IN_WEEK = MS_IN_DAY * 7;\nconst MS_IN_MONTH = MS_IN_DAY * 28; // to avoid invalidating February\nconst MS_IN_YEAR = MS_IN_DAY * 365.25;\n\nconst timeBinDurations: Record<TimeBinOptions, number> = {\n  'hour': MS_IN_HOUR,\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month': MS_IN_MONTH, \n  'none': 0,\n};\n\nconst foldingPeriodDurations: Record<FoldingPeriodOptions, number> = {\n  'day': MS_IN_DAY,\n  'week': MS_IN_WEEK,\n  'month' : MS_IN_MONTH,\n  'year': MS_IN_YEAR,\n  'weekdayWeekend': MS_IN_WEEK, // weekend is part of week\n  'none': 0,\n};\n\nconst dataDuration = computed(() => {\n  if (!props.selection?.samples) return 0;\n  const timestamps = Object.values(props.selection.samples).map(s => s.date.getTime());\n  if (timestamps.length === 0) return 0;\n  // single loop to find min and max on unsorted array\n  // (but it may already be sorted, but we only need to do this once so it's fine)\n  const minMax = timestamps.reduce((acc, t) => {\n    return {\n      min: Math.min(acc.min, t),\n      max: Math.max(acc.max, t)\n    };\n  }, { min: Infinity, max: -Infinity });\n  return minMax.max - minMax.min;\n});\n\nfunction validTimeBinForData(timeBin: TimeBinOptions): boolean {\n  if (dataDuration.value === 0) return false;\n\n  return dataDuration.value >= timeBinDurations[timeBin];\n}\n\nfunction validFoldingForData(foldType: FoldingPeriodOptions): boolean {\n  if (dataDuration.value === 0) return false;\n  if (foldType === 'weekdayWeekend') {\n    return (props.selection?.samples && Object.values(props.selection?.samples).map(s => s.date.getDay()).some(d => d === 0 || d === 6)) as boolean; // has at least one weekend day\n  }\n  return dataDuration.value >= foldingPeriodDurations[foldType];\n}\n\nconst aggregationWarning = ref('');\n\n\n// Time bin and folding period options\nconst timeBinOptions: {title: string, value: TimeBinOptions}[] = [\n  { title: 'None', value: 'none' },\n  { title: 'Hour', value: 'hour' },\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' }\n];\n\nconst allFoldingPeriodOptions: {title: string, value: FoldingPeriodOptions}[] = [\n  { title: 'None', value: 'none' },\n  { title: 'Day', value: 'day' },\n  { title: 'Week', value: 'week' },\n  { title: 'Month', value: 'month' },\n  { title: 'Year', value: 'year' },\n  { title: 'Weekend/Weekday', value: 'weekdayWeekend' },\n];\n\n\n\n// Computed property to filter valid folding periods based on selected time bin\nconst foldingPeriodOptions = computed(() => {\n  return allFoldingPeriodOptions;\n});\n\n\nconst methodOptions = [\n  { title: 'Mean', value: 'mean' },\n  { title: 'Median', value: 'median' },\n  { title: 'Min', value: 'min' },\n  { title: 'Max', value: 'max' }\n];\n\nconst timezoneOptions = [\n  { title: 'US/Eastern', value: 'US/Eastern' },\n  { title: 'US/Central', value: 'US/Central' },\n  { title: 'US/Mountain', value: 'US/Mountain' },\n  { title: 'US/Arizona', value: 'US/Arizona' },\n  { title: 'US/Pacific', value: 'US/Pacific' },\n  { title: 'UTC', value: 'UTC' }\n];\n\n// Reactive state\nconst selectedTimeBin = ref<TimeBinOptions>('none');\nconst selectedFoldingPeriod = ref<FoldingPeriodOptions>('none');\nconst selectedMethod = ref<AggregationMethod>('mean');\nconst selectedTimezone = ref('US/Eastern');\nconst showErrors = ref(true);\nconst useSEM = ref(true);\nconst useErrorBars = ref(false);\n\nwatch(selectedFoldingPeriod, (newPeriod) => {\n  if (!isValidCombination(selectedTimeBin.value, newPeriod)) {\n    // Set to first valid option\n    const validTimeBin = getFirstValidTimeBin(newPeriod);\n    if (validTimeBin && validTimeBinForData(validTimeBin)) {\n      selectedTimeBin.value = validTimeBin;\n    } else {\n      selectedTimeBin.value = 'hour'; // default fallback\n    }\n  }\n});\n\n// Computed FoldType based on time bin and folding period selections\nconst selectedFoldType = computed<FoldType>(() => {\n  // Map the combination to the appropriate FoldType\n  const timeBin = selectedTimeBin.value;\n  const period = selectedFoldingPeriod.value;\n    \n  const foldType = `${timeBin}Of${period.charAt(0).toUpperCase()}${period.slice(1)}` as FoldType;\n  console.log('Computed FoldType:', foldType, 'from', timeBin, 'and', period);\n  return foldType;\n});\n\n\n\n\n// Check if we're using a None-period fold type (no actual folding)\nconst isNonePeriod = computed(() => {\n  return selectedFoldingPeriod.value === 'none';\n});\n\n// Check if we're using any hour-based fold type (which is always centered)\nconst isHourBinned = computed(() => {\n  return selectedTimeBin.value === 'hour';\n});\n\nconst isFoldWithNoBin = computed(() => {\n  return selectedTimeBin.value === 'none' && selectedFoldingPeriod.value !== 'none';\n});\n\nconst includeBinPhase = ref(true);\n// const alignToBinCenter = ref(true);\nconst alignToBinCenter = computed(() => {\n  if (isNonePeriod.value) return true;\n  if (selectedFoldingPeriod.value === 'weekdayWeekend') return false;\n  if (includeBinPhase.value === false) return false;\n  if (isHourBinned.value) return true;\n  if (selectedTimeBin.value === 'week' && selectedFoldingPeriod.value === 'year') return false;\n  return true;\n});\n\nconst alignDataToBinCenters = computed({\n  get() {\n    return !includeBinPhase.value;\n  },\n  set(value: boolean) {\n    includeBinPhase.value = !value;\n  }\n});\n\n\nconst disableBinCenterCheckbox = computed(() => {\n  return !isNonePeriod.value && includeBinPhase.value && !isHourBinned.value;\n});\n\nconst disableIncludePhaseCheckbox = computed(() => {\n  return !isNonePeriod.value;\n});\n\n// Watch to ensure selected folding period is valid when time bin changes\nwatch(selectedTimeBin, () => {\n  const validPeriods = foldingPeriodOptions.value.map(opt => opt.value);\n  if (!validPeriods.includes(selectedFoldingPeriod.value)) {\n    // Set to first valid option\n    if (validPeriods.length > 0) {\n      selectedFoldingPeriod.value = validPeriods[0];\n    }\n  }\n});\n\n// Watch for None-period types and reset incompatible options\nwatch(isNonePeriod, (isNone) => {\n  if (isNone) {\n    includeBinPhase.value = true;\n    // alignToBinCenter.value = true;\n  }\n});\n\nconst regionCenter = computed(() => {\n  const region = props.selection?.region as UnifiedRegion;\n  \n  if (region && region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  }\n  \n  if (region && region.geometryType === 'rectangle') {\n    const { xmin, ymin, xmax, ymax } = region.geometryInfo;\n    return { lat: (ymin + ymax) / 2, lon: (xmin + xmax) / 2 };\n  }\n  \n  return { lat: 0, lon: 0 };\n});\n\n\n\nconst useTzCenter = ref(true);\nconst tzCenter = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n\nif (regionCenter.value.lat !== 0 || regionCenter.value.lon !== 0) {\n  const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n  if (tz && useTzCenter.value) {\n    selectedTimezone.value = tz;\n  }\n}\n\nwatch(useTzCenter, (newVal) => {\n  if (newVal && regionCenter.value.lat !== 0 && regionCenter.value.lon !== 0) {\n    const tz = tz_lookup(regionCenter.value.lat, regionCenter.value.lon);\n    if (tz) {\n      selectedTimezone.value = tz;\n    }\n  }\n});\n\n// Computed properties\nconst originalDataPointCount = computed(() => {\n  if (!props.selection?.samples) return 0;\n  return Object.keys(props.selection.samples).length;\n});\n\nconst foldedDataPointCount = computed(() => {\n  if (!foldedData.value) return 0;\n  return Object.keys(foldedData.value.values).length;\n});\n\nconst canSave = computed(() => {\n  return !!(props.selection && foldedData.value && foldedDataPointCount.value > 0);\n});\n\nconst foldedDatasetName = computed(() => {\n  if (!props.selection?.name) return 'Stacked Data';\n  return `Aggregated ${props.selection.name ?? props.selection.region.name}`;// (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}, ${selectedMethod.value})`;\n});\n\n// Aggregated data\nconst foldedData = ref<FoldedTimeSeriesData | null>(null);\nconst foldedSelection = ref<null>(null);\n// Graph data for display - now a ref that gets manually updated\nconst graphData = ref<PlotlyGraphDataSet[]>([]);\n\nwatch(foldedData, (newvValue) => {\n  // if there is only one bin present the user with an aggregation warning\n  if (newvValue && newvValue.bins && Object.keys(newvValue.bins).length <= 1) {\n    aggregationWarning.value = (\"Warning: This combination of time bin and folding period results \" +\n      \"in only one bin. Please select a smaller time bin \" + \n      \"or a different folding period if available. In most cases, it is recommend to select 'None' for the folding period.\");\n  } else {\n    aggregationWarning.value = '';\n  }\n});\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction timeseriesToDataSet(timeseries: TimeSeriesData): Omit<PlotlyGraphDataSet, 'name'> {\n  const x: PlotlyGraphDataSet['x'] = [];\n  const y: PlotlyGraphDataSet['y'] = [];\n  const lower: PlotlyGraphDataSet['lower'] = [];\n  const upper: PlotlyGraphDataSet['upper'] = [];\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(timeseries.values).sort(([tsa, _a], [tsb, _b]) => parseInt(tsa) - parseInt(tsb));\n  // get the first timestamp\n  sortedEntries.forEach(([timestamp, aggValue]) => {\n    y.push(aggValue.value);\n    x.push(new Date(parseInt(timestamp)));\n    const error = timeseries.errors[timestamp];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper, errorType: 'bar' };\n}\n\nfunction foldedTimesSeriesToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotlyGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['noneOfNone','hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([binIndex, _binContent]) => {\n    const idx = parseInt(binIndex);\n    const aggValue = foldedTimeSeries.values[idx];\n    \n    // Use date if available (for None-period types), otherwise use bin index\n    if (isNonePeriod && aggValue.date) {\n      // For None-period types with dates, center bins by adding half the bin width\n      if (alignToBinCenter.value) {\n        const date = new Date(aggValue.date);\n        switch (foldedTimeSeries.foldType) {\n        case 'hourOfNone':\n          date.setMinutes(30); // Center of hour\n          break;\n        case 'dayOfNone':\n          date.setHours(date.getHours() + 12); // local Noon\n          break;\n        case 'weekOfNone':\n          date.setDate(date.getDate() + 3); // Middle of week (approx)\n          date.setHours(date.getHours() + 12);\n          break;\n        case 'monthOfNone':\n          date.setDate(15); // Middle of month (approx)\n          break;\n        }\n        x.push(date);\n      } else {\n        x.push(aggValue.date);\n      }\n    } else {\n      if (foldedTimeSeries.foldType !== 'hourOfDay') {\n        x.push(idx + (alignToBinCenter.value ? 0.5 : 0));\n      } else {\n        x.push(idx);\n      }\n    }\n    \n    y.push(aggValue.value);\n    const error = foldedTimeSeries.errors[idx];\n    lower.push(error?.lower ?? null);\n    upper.push(error?.upper ?? null);\n  });\n\n  return { x, y, lower, upper, errorType: useErrorBars.value ? 'bar' : 'band' };\n}\n  \nfunction foldedTimeSeriesRawToDataSet(foldedTimeSeries: FoldedTimeSeriesData): Omit<PlotlyGraphDataSet, 'name'> {\n  const x: (number | Date | null)[] = [];\n  const y: (number | null)[] = [];\n  const lower: (number | null)[] = [];\n  const upper: (number | null)[] = [];\n  const customdata: Date[] = [];\n\n  // Check if this is a None-period fold type\n  const isNonePeriod = ['hourOfNone', 'dayOfNone', 'weekOfNone', 'monthOfNone'].includes(foldedTimeSeries.foldType);\n\n  // tsa, tsb are the timestamps as strings\n  const sortedEntries = Object.entries(foldedTimeSeries.bins).sort(([binIndexa, _a], [binIndexb, _b]) => parseInt(binIndexa) - parseInt(binIndexb));\n\n  sortedEntries.forEach(([_binIndex, binContent]) => {\n    const sortedBinContent = sortfoldBinContent(binContent);\n    const bins = sortedBinContent as Prettify<FoldBinContent>;\n    \n    bins.rawValues.forEach((rv, index) => {\n      if (isNonePeriod) {\n        // For None-period types, use the actual timestamp\n        x.push(new Date(bins.timestamps[index]));\n      } else {\n        // For regular fold types, use bin index with optional phase\n        x.push(bins.bin + (includeBinPhase.value ? bins.binPhase[index] : 0));\n      }\n      customdata.push(toZonedTime(new Date(bins.timestamps[index]), selectedTimezone.value));\n      y.push(rv);\n    });\n    bins.lowers.forEach(low => {\n      lower.push(low ?? null);\n    });\n    bins.uppers.forEach(up => {\n      upper.push(up ?? null);\n    });\n  });\n  // the ascii +- symbol is this characher: \n  const hovertemplate = '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>';\n  \n  return { x, y, lower, upper, errorType: 'bar', datasetOptions: { customdata, hovertemplate } };\n}\n\n// Function to update graph data\nfunction updateGraphData() {\n  console.log(\"Updating graph data\");\n  if (!props.selection) {\n    graphData.value = [];\n    return;\n  }\n  \n  // const data = [timeseriesToDataSet(selectionToTimeseries(props.selection))]; // Original data\n  const data: PlotlyGraphDataSet[] = [];\n  \n  if (foldedData.value) {\n    const t = foldedTimeSeriesRawToDataSet(foldedData.value); // Raw folded data\n    (t as PlotlyGraphDataSet).name = props.selection.name || 'Original Data';\n    (t as PlotlyGraphDataSet).errorType = 'bar';\n    data.push(t as PlotlyGraphDataSet); // Raw folded data\n    if (!isFoldWithNoBin.value) {\n      const f = foldedTimesSeriesToDataSet(foldedData.value); // Summary folded data\n      (f as PlotlyGraphDataSet).name = foldedDatasetName.value;\n      data.push(f as PlotlyGraphDataSet); // Summary folded data\n    }\n  } else {\n    // No folded data, just show original\n    const original = timeseriesToDataSet(selectionToTimeseries(props.selection));\n    (original as PlotlyGraphDataSet).name = props.selection.name || 'Original Data';\n    data.push(original as PlotlyGraphDataSet);\n  }\n  console.log(\"Prepared graph data:\", data);\n  graphData.value = data;\n  console.log(\"Graph data updated with\", data.length, \"datasets\");\n}\n\n// Create a time range for the folded data\nfunction createFoldedTimeRange() {\n  if (!props.selection) {\n    throw new Error('No selection available');\n  }\n  \n  const originalRange = props.selection.timeRange.range;\n  const ranges = Array.isArray(originalRange) ? originalRange : [originalRange];\n  \n  return {\n    id: v4(),\n    name: `Stacked (${selectedTimeBin.value} of ${selectedFoldingPeriod.value})`,\n    description: `Stacked data (${selectedTimeBin.value} of ${selectedFoldingPeriod.value}) ${selectedMethod.value}`,\n    range: ranges,\n    type: 'folded' as TimeRangeSelectionType,\n    source: props.selection.timeRange,\n  };\n}\n\n\n// Only recalculate when data-affecting parameters change\nwatch([selectedTimeBin, selectedFoldingPeriod, selectedMethod, selectedTimezone, useSEM], \n  updateAggregatedData, { immediate: true });\n\n// Handle display-only changes separately\nwatch([useErrorBars, alignToBinCenter, includeBinPhase], updateGraphData);\n\nfunction selectionToTimeseries(selection: UserDataset): TimeSeriesData {\n  return {\n    values: selection.samples || {},\n    errors: selection.errors || {},\n    locations: selection.locations || [],\n    geometryType: selection.region.geometryType || 'rectangle'\n  };\n}\n\n// Update folded data when parameters change\nfunction updateAggregatedData() {\n  console.log(\"Updating folded data with time bin:\", selectedTimeBin.value, \"folding period:\", selectedFoldingPeriod.value, \"fold type:\", selectedFoldType.value, \"method:\", selectedMethod.value, \"timezone:\", selectedTimezone.value);\n  if (!props.selection?.samples) {\n    foldedData.value = null;\n    return;\n  }\n  \n  try {\n    \n    // Convert the selection data to TimeSeriesData format\n    const timeSeriesData = selectionToTimeseries(props.selection);\n    \n    let foldType = selectedFoldType.value;\n    if (isFoldWithNoBin.value) {\n      foldType = foldType.replace('noneOf', 'hourOf') as FoldType;\n    }\n    \n    const grouper = new TimeSeriesFolder(\n      foldType,  // Use the computed fold type\n      selectedTimezone.value, \n      selectedMethod.value, \n      useSEM.value ? 'sem' : 'std', true);\n    foldedData.value = grouper.foldData(timeSeriesData);\n    \n  } catch (error) {\n    console.error('Error aggregating data:', error);\n    foldedData.value = null;\n    foldedSelection.value = null;\n  }\n  \n  // Update graph data after folding\n  updateGraphData();\n  console.log(\"graphData after update:\", graphData.value);\n}\n\nfunction handlePointClick(value: {x: Plotly.Datum, y: number, customdata: unknown}) {\n  console.log(\"Point clicked:\", value);\n  console.log(\"Custom data Date:\", value.customdata ? value.customdata as Date: value.customdata);\n  // the from timezoned time is what we want to to send work with if we go back to esri stuff\n  console.log(\"fromZonedTime\", value.customdata ? fromZonedTime(value.customdata as Date, selectedTimezone.value) : value.customdata);\n  emit('plot-click', {\n    x: value.x,\n    y: value.y,\n    customdata: value.customdata,\n    molecule: props.selection?.molecule as MoleculeType,\n    region: props.selection?.region as UnifiedRegion\n  });\n  return;\n}\n\n// Save the folding\nfunction saveFolding() {\n  \n  if (!canSave.value || !props.selection || !foldedData.value) return;\n  \n  // const rawDataset = foldedTimeSeriesRawToDataSet(foldedData.value);\n  // (rawDataset as PlotlyGraphDataSet).name = props.selection.name || 'Original Data';\n  // const summaryDataset = foldedTimesSeriesToDataSet(foldedData.value);\n  // (summaryDataset as PlotlyGraphDataSet).name = foldedDatasetName.value;\n\n  const foldedSelection: UserDataset = {\n    id: v4(),\n    region: { ...props.selection.region, name: props.selection.region.name } as typeof props.selection.region,\n    timeRange: createFoldedTimeRange(),\n    molecule: props.selection.molecule,\n    customColor: theColor.value,\n    loading: false, // folded data is immediately available\n    // samples/errors intentionally omitted for folded since bins are synthetic; rely on plotlyDatasets\n    locations: foldedData.value.locations,\n    name: foldedDatasetName.value,\n    folded: {\n      timeBin: selectedTimeBin.value,\n      foldingPeriod: selectedFoldingPeriod.value,\n      foldType: selectedFoldType.value,\n      method: selectedMethod.value,\n      timezone: selectedTimezone.value,\n      useSEM: useSEM.value,\n      includeBinPhase: includeBinPhase.value,\n      alignToBinCenter: alignToBinCenter.value,\n      useErrorBars: useErrorBars.value,\n      raw: foldedData.value\n    },\n    plotlyDatasets: [\n      {\n        ...graphData.value[0],\n        datasetOptions: {\n          ...graphData.value[0].datasetOptions,\n          mode: 'markers',\n          // hovertemplate: '%{customdata|%Y-%m-%d %H:%M}<br>%{y:0.2e}%{error_y.array:0.2e}<extra></extra>'\n        }\n      } as PlotlyGraphDataSet,\n      {\n        ...graphData.value[1],\n        datasetOptions: {\n          mode: 'markers'\n        }\n      } as PlotlyGraphDataSet\n    ].slice(0, isFoldWithNoBin.value ? 1 : 2) // only include summary if not fold-with-no-bin\n  };\n  console.log(foldedSelection);\n  emit('save', foldedSelection);\n\n  closeDialog();\n}\n\n// Close dialog\nfunction closeDialog() {\n  dialogOpen.value = false;\n  // Reset state\n  nextTick(() => {\n    foldedData.value = null;\n  });\n}\n\n// Watch for selection changes\nwatch(() => props.selection, () => {\n  if (props.selection) {\n    updateAggregatedData();\n  }\n}, { immediate: true });\n</script>\n\n<style scoped>\n\n#aggregation-warning {\n  color: red;\n  font-weight: bold;\n  margin-bottom: 0.5em;\n}\n\n.df__panel-container {\n  flex-wrap: nowrap;\n  overflow-x: auto;\n}\n\n.df__left-pane {\n  min-width: min-content;\n  max-width: fit-content;\n}\n\n.df__right-pane {\n  margin-inline: 1em;\n  width: min-content;\n}\n\n.df__right-pane-card {\n}\n.df__graph-container {\n  height: calc(100% - 40px);\n}\n\n</style>\n","import script from \"./DataFoldingAndBinning.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DataFoldingAndBinning.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DataFoldingAndBinning.vue?vue&type=style&index=0&id=639143c4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-639143c4\"]])\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx } from \"vue\"\n\nimport { ref } from 'vue';\nimport type { UserDataset, UnifiedRegion, MoleculeType} from '../types';\nimport NewDataGenericAggregation from './DataFoldingAndBinning.vue';\nimport { moleculeDescriptor } from '@/esri/utils';\n\nimport { titleBarPredicate } from \"../utils/draggable\";\n\n\ninterface DataAggregationProps {\n  selection: UserDataset | null;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'AdvancedOperations',\n  props: /*@__PURE__*/_mergeModels({\n    selection: {}\n  }, {\n    \"modelValue\": { type: Boolean, ...{ type: Boolean, required: true } },\n    \"modelModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"save\", \"plot-click\"], [\"update:modelValue\"]),\n  setup(__props: any, { emit: __emit }) {\n\n\nconst dialogOpen = _useModel<boolean>(__props, 'modelValue');\nconst aggControlsVisible = ref(false);\n\nconst mode = ref<'aggregate' | 'fold' | 'new'>('new');\n\nconst emit = __emit;\n\n\nfunction handlePlotClick(value: {x: number | string | Date | null, y: number, customdata: unknown, molecule: MoleculeType, region: UnifiedRegion}) {\n  emit('plot-click', value);\n}\n// Save the aggregation\n// function saveAggregation(selection: UserDataset) {\n//   emit('save', selection);\n// }\n\nfunction saveFolded(selection: UserDataset) {\n  // Reuse same save channel for folded selections\n  emit('save', selection);\n}\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_cds_dialog = _resolveComponent(\"cds-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_cds_dialog, {\n    modelValue: dialogOpen.value,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((dialogOpen).value = $event)),\n    title: `${__props.selection ? _unref(moleculeDescriptor)(__props.selection.molecule).shortName.text : 'Graph of'} Quantity vs. Time`,\n    density: \"compact\",\n    \"title-color\": \"var(--info-background)\",\n    \"max-width\": \"90vw\",\n    \"max-height\": \"90vh\",\n    height: \"fit-content\",\n    persistent: \"\",\n    draggable: \"\",\n    \"drag-predicate\": _unref(titleBarPredicate)\n  }, {\n    default: _withCtx(() => [\n      (mode.value === 'new')\n        ? (_openBlock(), _createBlock(NewDataGenericAggregation, {\n            key: 0,\n            modelValue: dialogOpen.value,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((dialogOpen).value = $event)),\n            \"show-controls\": aggControlsVisible.value,\n            \"onUpdate:showControls\": _cache[1] || (_cache[1] = ($event: any) => ((aggControlsVisible).value = $event)),\n            selection: __props.selection,\n            onSave: saveFolded,\n            onPlotClick: handlePlotClick\n          }, null, 8, [\"modelValue\", \"show-controls\", \"selection\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _: 1\n  }, 8, [\"modelValue\", \"title\", \"drag-predicate\"]))\n}\n}\n\n})","<template>\n  <cds-dialog\n    v-model=\"dialogOpen\"\n    :title=\"`${selection ? moleculeDescriptor(selection.molecule).shortName.text : 'Graph of'} Quantity vs. Time`\"\n    density=\"compact\"\n    title-color=\"var(--info-background)\"\n    max-width=\"90vw\"\n    max-height=\"90vh\"\n    height=\"fit-content\"\n    persistent\n    draggable\n    :drag-predicate=\"titleBarPredicate\"\n  > \n    <new-data-generic-aggregation\n      v-if=\"mode === 'new'\"\n      v-model=\"dialogOpen\"\n      v-model:show-controls=\"aggControlsVisible\"\n      :selection=\"selection\"\n      @save=\"saveFolded\"\n      @plot-click=\"handlePlotClick\"\n    />\n  </cds-dialog>\n\n  \n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\nimport type { UserDataset, UnifiedRegion, MoleculeType} from '../types';\nimport NewDataGenericAggregation from './DataFoldingAndBinning.vue';\nimport { moleculeDescriptor } from '@/esri/utils';\n\nimport { titleBarPredicate } from \"../utils/draggable\";\n\n\ninterface DataAggregationProps {\n  selection: UserDataset | null;\n}\n\nconst { selection } = defineProps<DataAggregationProps>();\nconst dialogOpen = defineModel<boolean>('modelValue', { type: Boolean, required: true });\nconst aggControlsVisible = ref(false);\n\nconst mode = ref<'aggregate' | 'fold' | 'new'>('new');\n\nconst emit = defineEmits<{\n  (event: 'save', aggregatedSelection: UserDataset): void;\n  (event: \"plot-click\", value: {x: number | string | Date | null, y: number, customdata: unknown, molecule: MoleculeType, region: UnifiedRegion}): void;\n}>();\n\n\nfunction handlePlotClick(value: {x: number | string | Date | null, y: number, customdata: unknown, molecule: MoleculeType, region: UnifiedRegion}) {\n  emit('plot-click', value);\n}\n// Save the aggregation\n// function saveAggregation(selection: UserDataset) {\n//   emit('save', selection);\n// }\n\nfunction saveFolded(selection: UserDataset) {\n  // Reuse same save channel for folded selections\n  emit('save', selection);\n}\n\n\n\n</script>\n\n<style>\n\n\n</style>\n","import script from \"./AdvancedOperations.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AdvancedOperations.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withKeys as _withKeys, mergeProps as _mergeProps, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { ref } from 'vue';\n\nexport default /*@__PURE__*/_defineComponent({\n  ...{ inheritAttrs: false },\n  __name: 'CTextField',\n  props: {\n    title: {},\n    label: {},\n    buttonColor: {},\n    confirmText: { default: 'Done' },\n    minWidth: { default: 300 },\n    width: { default: '50%' }\n  },\n  emits: [\"update:modelValue\", \"confirm\", \"cancel\"],\n  setup(__props: any, { emit: __emit }) {\n\n\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst props = __props;\n\n// const modelValue = defineModel('modelValue', { type: String, required: true });\n\nconst emit = __emit;\n\nconst local = ref('');\n// watch(modelValue, v => { \n//   if (v !== local.value) {\n//     local.value = v; \n//   }\n// });\n\n// don't update the model value\n// watch(local, v => emit('update:modelValue', v));\n\nfunction onConfirm() {\n  if (!local.value.trim()) return;\n  emit('confirm', local.value.trim());\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_card_title = _resolveComponent(\"v-card-title\")!\n  const _component_v_text_field = _resolveComponent(\"v-text-field\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_actions = _resolveComponent(\"v-card-actions\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, {\n    class: \"mx-auto px-3 py-2 popup-card--outline\",\n    \"min-width\": __props.minWidth,\n    width: __props.width\n  }, {\n    default: _withCtx(() => [\n      _renderSlot(_ctx.$slots, \"title\", {}, () => [\n        _createVNode(_component_v_card_title, null, {\n          default: _withCtx(() => [\n            _createTextVNode(_toDisplayString(__props.title), 1)\n          ]),\n          _: 1\n        })\n      ]),\n      _createVNode(_component_v_text_field, _mergeProps({ class: \"mb-2 px-2\" }, _ctx.$attrs, {\n        modelValue: local.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((local).value = $event)),\n        label: __props.label,\n        \"hide-details\": \"\",\n        autofocus: \"\",\n        onKeyup: _withKeys(onConfirm, [\"enter\"])\n      }), null, 16, [\"modelValue\", \"label\"]),\n      _createVNode(_component_v_card_actions, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_spacer),\n          _createVNode(_component_v_btn, {\n            variant: \"text\",\n            onClick: _cache[1] || (_cache[1] = ($event: any) => (emit('cancel')))\n          }, {\n            default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n              _createTextVNode(\"Cancel\", -1)\n            ]))]),\n            _: 1\n          }),\n          _createVNode(_component_v_btn, {\n            color: __props.buttonColor,\n            variant: \"flat\",\n            disabled: !local.value.trim(),\n            onClick: onConfirm\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(__props.confirmText), 1)\n            ]),\n            _: 1\n          }, 8, [\"color\", \"disabled\"])\n        ]),\n        _: 1\n      })\n    ]),\n    _: 3\n  }, 8, [\"min-width\", \"width\"]))\n}\n}\n\n})","<template>\n  <v-card \n    class=\"mx-auto px-3 py-2 popup-card--outline\" \n    :min-width=\"minWidth\" \n    :width=\"width\"\n    >\n    <slot name=\"title\">\n      <v-card-title>\n        {{ title }}\n      </v-card-title>\n    </slot>\n    <v-text-field\n      class=\"mb-2 px-2\"\n      v-bind=\"$attrs\"\n      v-model=\"local\"\n      :label=\"label\"\n      hide-details\n      autofocus\n      @keyup.enter=\"onConfirm\"\n    />\n    <v-card-actions>\n      <v-spacer />\n      <v-btn variant=\"text\" @click=\"emit('cancel')\">Cancel</v-btn>\n      <v-btn\n        :color=\"buttonColor\"\n        variant=\"flat\"\n        :disabled=\"!local.trim()\"\n        @click=\"onConfirm\"\n      >{{ confirmText }}</v-btn>\n    </v-card-actions>\n    \n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\ndefineOptions({ inheritAttrs: false });\n\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst props = withDefaults(defineProps<{\n  title?: string;\n  label?: string;\n  buttonColor?: string;\n  confirmText?: string;\n  minWidth?: string | number;\n  width?: string | number;\n}>(), {\n  confirmText: 'Done',\n  minWidth: 300,\n  width: '50%',\n});\n\n// const modelValue = defineModel('modelValue', { type: String, required: true });\n\nconst emit = defineEmits<{\n  (e:'update:modelValue', v:string): void;\n  (e:'confirm', v:string): void;\n  (e:'cancel'): void;\n}>();\n\nconst local = ref('');\n// watch(modelValue, v => { \n//   if (v !== local.value) {\n//     local.value = v; \n//   }\n// });\n\n// don't update the model value\n// watch(local, v => emit('update:modelValue', v));\n\nfunction onConfirm() {\n  if (!local.value.trim()) return;\n  emit('confirm', local.value.trim());\n}\n</script>","import script from \"./CTextField.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CTextField.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, resolveComponent as _resolveComponent, withModifiers as _withModifiers, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, mergeProps as _mergeProps, createCommentVNode as _createCommentVNode, renderSlot as _renderSlot, createSlots as _createSlots, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"d-flex flex-wrap align-center ga-1 mb-1\"\n}\nconst _hoisted_2 = { class: \"molecule-label\" }\n\nimport { ref, computed } from \"vue\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\nimport type { UserDataset } from \"../types\";\nimport { useTempoStore } from \"../stores/app\";\nimport { moleculeName } from \"../esri/utils\";\n\n\ninterface DatasetCardProps {\n  datasets: UserDataset[];\n  turnOnSelection?: boolean;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DatasetCard',\n  props: /*@__PURE__*/_mergeModels({\n    datasets: {},\n    turnOnSelection: { type: Boolean }\n  }, {\n    \"selectedDatasets\": {\n  type: Array as () => string[],\n  default: () => [],\n},\n    \"selectedDatasetsModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"editRegion\"], [\"update:selectedDatasets\"]),\n  setup(__props: any, { emit: __emit }) {\n\nconst store = useTempoStore();\n\n\n\n// create a selectedDatasets model, to hold selectedDatsets use (defineModel). should just store the dataset.id values\nconst selectedDatasets = _useModel<string[]>(__props, 'selectedDatasets');\n\nconst emit = __emit;\n\nconst touchscreen = supportsTouchscreen();\n\n\nconst openGraphs = ref<Record<string,boolean>>({});\n\n\n\nconst datasetRowRefs = ref({});\n\nfunction isFolded(dataset: UserDataset): boolean {\n  return !!(dataset.timeRange && dataset.timeRange.type === 'folded');\n}\n\n\nconst datesetsWithNotFoldedFisrt = computed(() => {\n  return [...__props.datasets].sort((a, b) => {\n    const aFolded = isFolded(a) ? 1 : 0;\n    const bFolded = isFolded(b) ? 1 : 0;\n    return aFolded - bFolded;\n  });\n});\n\n\nfunction _removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\nconst showDetails = ref(false);\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_chip = _resolveComponent(\"v-chip\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_expand_transition = _resolveComponent(\"v-expand-transition\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_hover = _resolveComponent(\"v-hover\")!\n  const _component_v_list = _resolveComponent(\"v-list\")!\n\n  return (_openBlock(), _createBlock(_component_v_list, { density: \"compact\" }, {\n    default: _withCtx(() => [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(datesetsWithNotFoldedFisrt.value, (dataset) => {\n        return (_openBlock(), _createBlock(_component_v_hover, {\n          key: dataset.id\n        }, {\n          default: _withCtx(({ isHovering, props }) => [\n            _createVNode(_component_v_list_item, _mergeProps({ ref_for: true }, props, {\n              ref_for: true,\n              ref: (el) => datasetRowRefs.value[dataset.id] = el,\n              class: \"selection-item my-2 rounded-lg\",\n              style: { 'background-color': isFolded(dataset) ? '#333' : '#999', 'color': isFolded(dataset) ? '#fff' : '#000' },\n              ripple: _unref(touchscreen),\n              density: \"compact\",\n              slim: \"\",\n              onClick: _cache[2] || (_cache[2] = ($event: any) => (showDetails.value = !showDetails.value))\n            }), _createSlots({\n              default: _withCtx(() => [\n                _createElementVNode(\"div\", null, [\n                  _createVNode(_component_v_chip, {\n                    class: \"dataset-name-chip my-1\",\n                    size: \"small\",\n                    variant: \"flat\",\n                    elevation: \"1\",\n                    color: dataset.customColor ?? dataset.region.color,\n                    onClick: ($event: any) => (emit('editRegion', dataset))\n                  }, {\n                    default: _withCtx(() => [\n                      _createTextVNode(_toDisplayString(dataset.name ?? dataset.region.name), 1)\n                    ]),\n                    _: 2\n                  }, 1032, [\"color\", \"onClick\"]),\n                  _createVNode(_component_v_expand_transition, null, {\n                    default: _withCtx(() => [\n                      (showDetails.value || isHovering)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                            _createVNode(_component_v_chip, {\n                              label: \"\",\n                              size: \"small\",\n                              variant: \"flat\",\n                              color: dataset.region.color\n                            }, {\n                              default: _withCtx(() => [\n                                _createTextVNode(_toDisplayString(dataset.region.name), 1)\n                              ]),\n                              _: 2\n                            }, 1032, [\"color\"]),\n                            _createVNode(_component_v_chip, {\n                              label: \"\",\n                              size: \"small\"\n                            }, {\n                              default: _withCtx(() => [\n                                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(_unref(moleculeName)(dataset.molecule)), 1)\n                              ]),\n                              _: 2\n                            }, 1024),\n                            _createVNode(_component_v_tooltip, {\n                              text: dataset.timeRange.description\n                            }, {\n                              activator: _withCtx(({props}) => [\n                                _createVNode(_component_v_chip, _mergeProps({ ref_for: true }, props, {\n                                  label: \"\",\n                                  size: \"small\"\n                                }), {\n                                  default: _withCtx(() => [\n                                    _createTextVNode(_toDisplayString(dataset.timeRange.name), 1)\n                                  ]),\n                                  _: 2\n                                }, 1040)\n                              ]),\n                              _: 2\n                            }, 1032, [\"text\"])\n                          ]))\n                        : _createCommentVNode(\"\", true)\n                    ]),\n                    _: 2\n                  }, 1024)\n                ]),\n                _renderSlot(_ctx.$slots, \"action-row\", {\n                  isHovering: isHovering ?? true,\n                  dataset: dataset\n                })\n              ]),\n              _: 2\n            }, [\n              (__props.turnOnSelection)\n                ? {\n                    name: \"prepend\",\n                    fn: _withCtx(() => [\n                      _createVNode(_component_v_checkbox, {\n                        modelValue: selectedDatasets.value,\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((selectedDatasets).value = $event)),\n                        value: dataset.id,\n                        onClick: _cache[1] || (_cache[1] = _withModifiers(() => {}, [\"stop\"])),\n                        \"hide-details\": \"\",\n                        density: \"compact\"\n                      }, null, 8, [\"modelValue\", \"value\"])\n                    ]),\n                    key: \"0\"\n                  }\n                : undefined\n            ]), 1040, [\"style\", \"ripple\"])\n          ]),\n          _: 2\n        }, 1024))\n      }), 128))\n    ]),\n    _: 3\n  }))\n}\n}\n\n})","<template>\n  <v-list density=\"compact\">\n    <v-hover\n      v-slot=\"{ isHovering, props }\"\n      v-for=\"dataset in datesetsWithNotFoldedFisrt\"\n      :key=\"dataset.id\"\n    > \n      <!-- create a checkbox input that will -->\n    \n      <v-list-item\n        v-bind=\"props\"\n        :ref=\"(el) => datasetRowRefs[dataset.id] = el\"\n        class=\"selection-item my-2 rounded-lg\"\n        :style=\"{ 'background-color': isFolded(dataset) ? '#333' : '#999', 'color': isFolded(dataset) ? '#fff' : '#000' }\"\n        :ripple=\"touchscreen\"\n        density=\"compact\"\n        slim\n        @click=\"showDetails = !showDetails\"\n      >\n        <template v-slot:prepend v-if=\"turnOnSelection\">\n          <v-checkbox\n            v-model=\"selectedDatasets\"\n            :value=\"dataset.id\"\n            @click.stop\n            hide-details\n            density=\"compact\"\n          />\n        </template>\n        <template #default>\n          <div>\n            <v-chip\n              class=\"dataset-name-chip my-1\"\n              size=\"small\" \n              variant=\"flat\"\n              elevation=\"1\"\n              :color=\"dataset.customColor ?? dataset.region.color\"\n              @click=\"emit('editRegion', dataset)\"\n              >\n              {{ dataset.name ?? dataset.region.name }}\n            </v-chip>\n            <v-expand-transition>\n              <div v-if=\"showDetails || isHovering\" class=\"d-flex flex-wrap align-center ga-1 mb-1\">\n                <v-chip \n                  label\n                  size=\"small\" \n                  variant=\"flat\"  \n                  :color=\"dataset.region.color\"\n                  >\n                  {{ dataset.region.name }}\n                </v-chip>\n                \n                <v-chip label size=\"small\" >\n                  <span class=\"molecule-label\">\n                    {{ moleculeName(dataset.molecule) }}\n                  </span>\n                </v-chip>\n                \n                <v-tooltip :text=\"dataset.timeRange.description\">\n                  <template #activator=\"{props}\">\n                    <v-chip \n                      v-bind=\"props\" \n                      label \n                      size=\"small\"\n                      >\n                      {{ dataset.timeRange.name }}\n                    </v-chip> \n                  </template>\n                </v-tooltip>\n                <!-- <div class=\"d-inline-block text-caption dataset-patttern-chip\"\n                  v-if=\"dataset.timeRange\" \n                  >\n                  <span>{{ dataset.timeRange.name }}</span>\n                </div> -->\n              </div>\n            </v-expand-transition>\n          </div>\n          <!-- this is where the actions will go -->\n          <slot name=\"action-row\" :isHovering=\"isHovering ?? true\" :dataset=\"dataset\">\n          </slot>\n        </template>\n      </v-list-item>\n    </v-hover>\n  </v-list>\n\n\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from \"vue\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\nimport type { UserDataset } from \"../types\";\nimport { useTempoStore } from \"../stores/app\";\nimport { moleculeName } from \"../esri/utils\";\n\n\nconst store = useTempoStore();\n\ninterface DatasetCardProps {\n  datasets: UserDataset[];\n  turnOnSelection?: boolean;\n}\nconst { datasets, turnOnSelection } = defineProps<DatasetCardProps>();\n\n// create a selectedDatasets model, to hold selectedDatsets use (defineModel). should just store the dataset.id values\nconst selectedDatasets = defineModel<string[]>('selectedDatasets', {\n  type: Array as () => string[],\n  default: () => [],\n});\n\nconst emit = defineEmits<{\n  (event: 'editRegion', value: UserDataset): void;\n}>();\n\nconst touchscreen = supportsTouchscreen();\n\n\nconst openGraphs = ref<Record<string,boolean>>({});\n\n\n\nconst datasetRowRefs = ref({});\n\nfunction isFolded(dataset: UserDataset): boolean {\n  return !!(dataset.timeRange && dataset.timeRange.type === 'folded');\n}\n\n\nconst datesetsWithNotFoldedFisrt = computed(() => {\n  return [...datasets].sort((a, b) => {\n    const aFolded = isFolded(a) ? 1 : 0;\n    const bFolded = isFolded(b) ? 1 : 0;\n    return aFolded - bFolded;\n  });\n});\n\n\nfunction _removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\nconst showDetails = ref(false);\n</script>\n\n<style scoped lang=\"less\">\n.dataset-patttern-chip {\n  text-wrap: auto;\n  background-color: #878787;\n  border-radius: 4px;\n  padding: 2px 6px;\n}\n.dataset-patttern-chip > span {\n  opacity: 1;\n  color: black;\n}\n\n.dataset-name-chip {\n  cursor:text;\n}\n\n.v-list-item--density-compact.v-list-item--one-line {\n  min-height: unset;\n}\n\n.mol-label {\n  --size: 3em;\n  width: var(--size);\n  height: var(--size);\n}\n\n\n</style>\n","import script from \"./DatasetCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DatasetCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DatasetCard.vue?vue&type=style&index=0&id=479fe2be&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-479fe2be\"]])\n\nexport default __exports__","// list of stop words to not upper case\nconst STOP_WORDS = [\n  'A', 'An', 'The', \n  'And', 'But', 'Or', 'Nor', \n  'For', 'So', 'Yet', \n  'At', 'By', 'In', 'Of', 'On', 'To', 'Up',\n];\n\nexport function camelToSentance(s: string): string {\n  if (s.length == 0) return s;\n  let out = s[0].toUpperCase();\n  for (const c of s.slice(1)) {\n    out += (!isNaN(+c) || c == c.toLowerCase()) ? c : ` ${c}`;\n  }\n  // un-capitalize stop words\n  out = out.replace(/\\b\\w+\\b/g, (word) => {\n    if (STOP_WORDS.includes(word)) {\n      return word.toLowerCase();\n    }\n    return word;\n  });\n  return out;\n}\n\n// https://stackoverflow.com/a/4149612/11594175\nexport function camelToSnake(s: string, delimeter = '_'): string {\n  return s.replace(/([a-z])([A-Z])/g, `$1${delimeter}$2`).toLowerCase();\n}","import type { FoldType } from '@/esri/services/aggregation';\nimport { daysInMonth } from '@/utils/calendar_utils';\n\nconst DAY_NAMES = ['Sunday', 'Monday', 'Tuesday', 'Wednewday', 'Thursday', 'Friday', 'Saturday'];\nconst MONTH_NAMES = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\nconst REFERENCE_LEAP_YEAR = 2020;\n\nfunction normalizeFoldTypeForLabels(foldType: FoldType | string): FoldType | string {\n  if (foldType.startsWith('noneOf') && foldType !== 'noneOfNone') {\n    return foldType.replace('noneOf', 'hourOf') as FoldType;\n  }\n  return foldType;\n}\n\nfunction formatHourLabel(hourValue: number): string {\n  if (!Number.isFinite(hourValue)) return '';\n  const wrapped = ((hourValue % 24) + 24) % 24;\n  let hour = Math.floor(wrapped);\n  let minute = Math.round((wrapped - hour) * 60);\n\n  if (minute === 60) {\n    minute = 0;\n    hour = (hour + 1) % 24;\n  }\n\n  const ampm = hour >= 12 ? 'PM' : 'AM';\n  const hour12 = hour % 12 === 0 ? 12 : hour % 12;\n\n  if (minute === 0) {\n    return `${hour12} ${ampm}`;\n  }\n\n  return `${hour12}:${String(minute).padStart(2, '0')} ${ampm}`;\n}\n\nfunction dayIndexToMonthDay(dayIndex: number, year: number): { monthIndex: number; dayOfMonth: number } {\n  let remaining = Math.max(0, Math.floor(dayIndex));\n  for (let monthIndex = 0; monthIndex < 12; monthIndex += 1) {\n    const days = daysInMonth(monthIndex + 1, year);\n    if (remaining < days) {\n      return { monthIndex, dayOfMonth: remaining + 1 };\n    }\n    remaining -= days;\n  }\n  const lastMonth = 11;\n  return { monthIndex: lastMonth, dayOfMonth: daysInMonth(lastMonth + 1, year) };\n}\n\nfunction formatMonthDay(dayIndex: number): string {\n  const { monthIndex, dayOfMonth } = dayIndexToMonthDay(dayIndex, REFERENCE_LEAP_YEAR);\n  const monthName = MONTH_NAMES[monthIndex] ?? '';\n  return `${monthName} ${dayOfMonth}`;\n}\n\nexport function formatFoldedBinValue(foldType: FoldType | string, bin: number): string {\n  if (!Number.isFinite(bin)) return '';\n  const normalizedFoldType = normalizeFoldTypeForLabels(foldType);\n\n  switch (normalizedFoldType) {\n  case 'hourOfDay':\n    return formatHourLabel(bin);\n  case 'hourOfWeek': {\n    const dayIndex = Math.floor(bin / 24);\n    const hour = bin - dayIndex * 24;\n    const dayName = DAY_NAMES[((dayIndex % 7) + 7) % 7] ?? '';\n    return `${dayName} ${formatHourLabel(hour)}`.trim();\n  }\n  case 'hourOfMonth': {\n    const dayIndex = Math.floor(bin / 24);\n    const hour = bin - dayIndex * 24;\n    return `Day ${dayIndex + 1} ${formatHourLabel(hour)}`;\n  }\n  case 'hourOfYear': {\n    const dayIndex = Math.floor(bin / 24);\n    const hour = bin - dayIndex * 24;\n    return `${formatMonthDay(dayIndex)} ${formatHourLabel(hour)}`;\n  }\n  case 'hourOfSeason': {\n    const dayIndex = Math.floor(bin / 24);\n    const hour = bin - dayIndex * 24;\n    return `Day ${dayIndex + 1} ${formatHourLabel(hour)}`;\n  }\n  case 'dayOfWeek': {\n    const dayIndex = Math.floor(bin);\n    return DAY_NAMES[((dayIndex % 7) + 7) % 7] ?? String(bin);\n  }\n  case 'dayOfWeekdayWeekend':\n    return Math.floor(bin) === 0 ? 'Weekday' : 'Weekend';\n  case 'hourOfWeekdayWeekend': {\n    const dayHour = Math.floor(bin);\n    const isWeekend = dayHour >= 24;\n    const hour = bin - (isWeekend ? 24 : 0);\n    const suffix = isWeekend ? 'WE' : 'WD';\n    return `${formatHourLabel(hour)} (${suffix})`;\n  }\n  case 'dayOfMonth':\n    return `Day ${Math.floor(bin) + 1}`;\n  case 'dayOfYear':\n    return formatMonthDay(bin);\n  case 'dayOfSeason':\n    return `Day ${Math.floor(bin) + 1}`;\n  case 'weekOfMonth':\n    return `Week ${Math.floor(bin) + 1}`;\n  case 'weekOfYear': {\n    const week = Math.floor(bin);\n    return `Week ${week < 1 ? week + 1 : week}`;\n  }\n  case 'weekOfSeason':\n    return `Week ${Math.floor(bin) + 1}`;\n  case 'monthOfYear': {\n    const monthIndex = Math.floor(bin);\n    return MONTH_NAMES[((monthIndex % 12) + 12) % 12] ?? String(bin);\n  }\n  case 'monthOfSeason':\n    return `Month ${Math.floor(bin) + 1}`;\n  case 'noneOfNone':\n  case 'hourOfNone':\n  case 'dayOfNone':\n  case 'weekOfNone':\n  case 'monthOfNone':\n    return String(bin);\n  default:\n    return String(bin);\n  }\n}\n\nexport function foldedDataBinUnit(foldType: FoldType | string): string | null {\n  const unit = normalizeFoldTypeForLabels(foldType).split('Of')[0];\n  if (unit === 'none') {\n    return 'Time';\n  }\n  return unit;\n}\n\nimport { camelToSentance } from './text';\n\nexport function foldTypeToLabel(foldType: FoldType | string): string {\n  if (!foldType.endsWith('None')) {\n    return camelToSentance(foldType);\n  }\n  \n  return camelToSentance(foldType.split('Of')[0]).replace('Day', 'Dai') + 'ly Average';\n}","import type { \n  Prettify,\n  UserDataset, \n  PlotlyGraphDataSet, \n  AggValue, \n  DataPointError, \n  UnifiedRegion\n} from '@/types';\nimport { toZonedTime } from 'date-fns-tz';\nimport tz_lookup from '@photostructure/tz-lookup';\nimport { camelToSnake } from './text';\nimport { formatFoldedBinValue, foldedDataBinUnit } from './folded_bin_processor';\n\nclass PlotlyDatasetBuilder {\n  private _x: Date[];\n  private _y: (number | null)[];\n  private _lower: (number | null)[] | undefined;\n  private _upper: (number | null)[] | undefined;\n  private _length: number = 0;\n  private _size: number;\n  private hasErrors: boolean;\n  public cleanOutput: boolean;\n  private _skippedPoints: number = 0;\n\n  constructor(size: number, hasErrors: boolean, cleanOutput: boolean = false) {\n    this._size = size;\n    this._x = new Array(size);\n    this._y = new Array(size);\n    this.hasErrors = hasErrors;\n    this.cleanOutput = cleanOutput;\n    if (hasErrors) {\n      this._lower = new Array(size);\n      this._upper = new Array(size);\n    }\n  }\n  \n  private get index() {return this._length;}\n  \n  private _addPointWithError(value: AggValue, error: DataPointError) {\n    \n    if (this.cleanOutput && value.value === null) {\n      this._skippedPoints++;\n      return;\n    }\n    \n    this._x[this.index] = value.date;\n    this._y[this.index] = value.value;\n    // use \"definite assignment assertion\" since we know hasErrors is true\n    this._lower![this.index] = error.lower;\n    this._upper![this.index] = error.upper;\n    this._length++;\n  }\n  \n  private _addPointNoError(value: AggValue) {\n    \n    if (this.cleanOutput && value.value === null) {\n      this._skippedPoints++;\n      return;\n    }\n    \n    this._x[this.index] = value.date;\n    this._y[this.index] = value.value;\n    this._length++;\n  }\n  \n  addPoint(value: AggValue, error?: DataPointError) {\n    if (this.hasErrors && error) {\n      this._addPointWithError(value, error);\n    } else {\n      this._addPointNoError(value);\n    }\n  }\n  \n  build(name: string, errorType: 'band' | 'bar' = 'bar'): PlotlyGraphDataSet {\n    if (this._length !== (this._size - this._skippedPoints)) {\n      throw new Error(`Data length mismatch: expected ${this._size}, got only ${this._length}`);\n    }\n    const isFull = this._length === this._size;\n    \n    if (this.hasErrors) {\n      return {\n        x: isFull ? this._x : this._x.slice(0, this._length),\n        y: isFull ? this._y : this._y.slice(0, this._length),\n        lower: isFull ? this._lower : this._lower!.slice(0, this._length),\n        upper: isFull ? this._upper : this._upper!.slice(0, this._length),\n        errorType: errorType,\n        name\n      };\n    } else {\n      return {\n        x: this._x,\n        y: this._y,\n        name\n      };\n    }\n  }\n}\n\nexport function regionCenter(region: UnifiedRegion): { lat: number; lon: number } {\n  if (region.geometryType === 'point') {\n    return { lat: region.geometryInfo.y, lon: region.geometryInfo.x };\n  } else {\n    const lat = (region.geometryInfo.ymin + region.geometryInfo.ymax) / 2;\n    const lon = (region.geometryInfo.xmin + region.geometryInfo.xmax) / 2;\n    return { lat, lon };\n  }\n}\n\nexport function userDatasetToPlotly(selection: Prettify<UserDataset>, useLocalTime: boolean = false): PlotlyGraphDataSet {\n  if (!selection.samples) {\n    return { x: [], y: [], name: '' };\n  }\n  \n  const data = selection.samples;\n  const hasErrors = !!selection.errors;\n  const errors = selection.errors ??  {}; // so errors[key] is valid or undefined instead of an error\n  const length = Object.keys(data).length;\n  \n  const plotlyBuilder = new PlotlyDatasetBuilder(length, hasErrors);\n  let useTz = (c) => c; // identity function if no timezone\n  \n  if (useLocalTime) {\n    const { lat, lon } = regionCenter(selection.region);\n    const tz = tz_lookup(lat, lon);\n    useTz = (d: Date) => toZonedTime(d, tz);\n  }\n  \n  Object.keys(data).sort((a, b) => +a - +b).forEach((key) => {\n    if (useLocalTime) {\n      const value = { ...data[+key], date: useTz(data[+key].date) };\n      plotlyBuilder.addPoint(value, errors[+key]);\n    } else {\n      plotlyBuilder.addPoint(data[+key], errors[+key]);\n    }\n  });\n\n  return plotlyBuilder.build(selection.name || 'Dataset', 'bar');\n}\n  \n\ninterface OutputTimeSeriesFormat {\n  utcDateTime: string;\n  localDateTime: string;\n  localDate: string;\n  localTime: string;\n  columnDensity: number | null;\n  uncertainty: number | null;\n  timezone: string;\n  utcOffsetHours: number;\n}\n\nconst toDate = (date: Date, tz: string) => date.toLocaleDateString(undefined, {dateStyle: 'medium', timeZone: tz}).replace(',', '');\nconst toTime = (date: Date, tz: string) => date.toLocaleTimeString(undefined, {\n  hour12:true, hour:'numeric', minute: '2-digit', second:'2-digit',\n  timeZone: tz,\n});\nfunction _dateToStrings(date: Date, tz: string) {\n  const utcDateTime = toDate(date, 'UTC') + ' ' + toTime(date, 'UTC');\n  const utcOffsetHours = -date.getTimezoneOffset() / 60;\n  const localDate = toDate(date, tz);\n  const localTime = toTime(date, tz);\n  const localDateTime = `${localDate} ${localTime}`;\n  return { \n    utcDateTime,\n    localDateTime, \n    localDate, \n    localTime, \n    utcOffsetHours, \n  };\n}\n\nfunction dateToCODAPStrings(date: Date, tz: string) {\n  // CODAP wants MM/DD/YYY, HH:MM:SS AM/PM in UTC, we'll still do utc and local\n  const utcDateTime = date.toLocaleString('en-US', {\n    \"dateStyle\": \"short\",\n    \"timeStyle\": \"medium\",\n    timeZone: 'UTC',\n  }).replace(',', '');\n  const localDateTime = date.toLocaleString('en-US', {\n    \"dateStyle\": \"short\",\n    \"timeStyle\": \"medium\",\n    timeZone: tz, \n  }).replace(',', '');\n  // const [localDate, localTime] = localDateTime.split(' ');\n  const localDate = date.toLocaleDateString('en-US', {\n    \"dateStyle\": \"short\",\n    timeZone: tz, \n  });\n  const localTime = date.toLocaleTimeString('en-US', {\n    \"timeStyle\": \"medium\",\n    \"hour12\": true,\n    timeZone: tz, \n  });\n  const utcOffsetHours = -date.getTimezoneOffset() / 60;\n  return { \n    utcDateTime,\n    localDateTime, \n    localDate, \n    localTime, \n    utcOffsetHours, \n  };\n}\n\nexport function createCODAPMeta(dataset: Prettify<UserDataset>): string[] {\n  // check useSEM on folded dataset\n  \n  \n  // const errShort = dataset.folded.useSEM ? 'SEM' : 'SD';\n  \n  \n  const meta: string[] = [];\n  \n  \n  // Basic info\n  meta.push(`# name: ${dataset.name || 'Unnamed Dataset'}`);\n  meta.push('# source: TEMPO-Lab Data Export');  \n  \n  // Attributes common to all datasets\n  const unit = dataset.molecule === 'o3' ? 'Dobson Units' : 'molecules per cm^2';\n  meta.push(`# attribute -- name: column_density, description: column density of ${dataset.molecule}, type: numeric, unit: ${unit}, editable: false`);\n  const errorMes = ((dataset.folded === 'undefined') || (dataset.folded && dataset.folded.useSEM)) \n    ? 'standard error of mean ' \n    : 'standard deviation';\n  meta.push(`# attribute -- name: uncertainty, description: uncertainy (${errorMes}) in column density, unit: ${unit} , type: numeric, editable: false`);\n  \n  // Description common to all datasets\n  const regionCenterCoords = regionCenter(dataset.region);\n  const description = [\n    `Dataset Name: ${dataset.name || 'Unnamed Dataset'}`,\n    `Molecule: ${dataset.molecule}`,\n    `Region Name: ${dataset.region.name || 'Unnamed Region'}`,\n    `Region Center: (lat: ${regionCenterCoords.lat.toFixed(4)}, lon: ${regionCenterCoords.lon.toFixed(4)})`,\n    `Time Range: ${(dataset.folded && dataset.timeRange.source) ? dataset.timeRange.source.description : dataset.timeRange.description}`,\n  ];\n\n  // Folded dataset specific info\n  if (dataset.folded) {\n    // folding description:\n    // Data is folded by {foldingPeriod} by {timeBin}\n    if (dataset.folded.foldingPeriod === 'none') {\n      description.push(`Data is binned by ${dataset.folded.timeBin}`);\n    } else if (dataset.folded.timeBin === 'none') {\n      description.push(`Data is folded by ${dataset.folded.foldingPeriod}`);\n    } else {\n      description.push(`Data is folded by ${dataset.folded.foldingPeriod} and binned by ${dataset.folded.timeBin}`);\n    }\n    description.push(`Aggregation method: ${dataset.folded.method}`);\n    const errorMes = dataset.folded.useSEM ? 'standard error of mean ' : 'standard deviation';\n    description.push(`Uncertainty type: ${errorMes}`);\n  }\n  \n  meta.push('# description: ' + description.join('&NewLine;'));\n  // Time attributes for data with timestamps\n  if (dataset.folded === undefined || (dataset.folded && dataset.folded.foldingPeriod === 'none')) {\n    meta.push(`# attribute -- name: utc_date_time, description: date and time in UTC, type: date, editable: false`);\n    meta.push(`# attribute -- name: local_date_time, description: date and time in local timezone (M/Y/D), type: date, editable: false`);\n    meta.push(`# attribute -- name: local_date, description: date in local timezone (M/Y/D), type: date, editable: false`);\n    meta.push(`# attribute -- name: local_time, description: time in local timezone, editable: false`); // no pure \"time type\" in CODAP\n    meta.push(`# attribute -- name: utc_offset_hours, description: offset from UTC in hours, type: numeric, editable: false`);\n    meta.push(`# attribute -- name: timezone, description: timezone of the region center, type: categorical, editable: false`);\n    return meta;\n  } \n  \n  // Time attributes for folded data\n  if (dataset.folded && dataset.folded.foldingPeriod !== 'none') {\n    const foldType = dataset.folded.foldType;\n    meta.push(`# attribute -- name: ${camelToSnake(foldType)}_numeric, description: numeric value for folded bin of type ${foldType}, type: numeric, unit: ${foldedDataBinUnit(foldType)}, editable: false`);\n    meta.push(`# attribute -- name: ${camelToSnake(foldType)}_value, description: formatted label for folded bin of type ${foldType}, type: categorical, editable: false`);\n    return meta;\n  }\n  \n  // we should not reach here so add an error message\n  meta.push('# Error: Unable to determine dataset time attributes for CODAP export');\n  return meta;\n}\n\n\n\nexport function convertSamplesToJson(dataset: Prettify<UserDataset>): OutputTimeSeriesFormat[] {\n  if (!dataset.samples) {\n    return [];\n  }\n  \n  const samples = dataset.samples;\n  const errors = dataset.errors;\n  const center = regionCenter(dataset.region);\n  const tz = tz_lookup(center.lat, center.lon);\n  \n  if (samples === undefined) {\n    throw new Error('No samples in dataset');\n  }\n  \n  return Object.entries(samples)\n    .map( ([key, sample]) => ({  \n      columnDensity: sample.value,\n      uncertainty: errors && errors[+key] ? errors[+key]?.upper : null,\n      timezone: tz,\n      ...dateToCODAPStrings(sample.date, tz),\n    }));\n}\n\nfunction _toSafeString(val: unknown): string {\n  if (val === null || val === undefined) {\n    return '';\n  }\n  return `${val}`;\n}\n\n\nexport interface Json2CsvOptions {\n  delimiter?: string;\n  headers?: string[];\n  meta?: string[];\n  units?: (string | null)[];\n  // all inluded by default if present\n  includeHeaders?: boolean;\n  includeMeta?: boolean;\n  includeUnits?: boolean;\n}\n\n/**\n * Convert JSON data to CSV format\n * @param jsonData Array of objects representing the data\n * @param options Options for CSV conversion\n * @returns CSV string\n * Explaination of options\n * - delimiter: Delimiter to use in the CSV (default is ',')\n * - headers: Headers to use (default is keys of the first object)\n * - meta: CODAP formatted meta lines to include at the top of the CSV (default is none)\n * - units: Units corresponding to the headers (default is none)\n * - includeHeaders: Whether to include the header row (default is true)\n * - includeMeta: Whether to include the meta lines (default is true)\n * - includeUnits: Whether to include the units row (default is true)\n */\nexport function json2Csv(jsonData: object[], options: Json2CsvOptions ): string {\n\n  if (jsonData.length === 0) {\n    return '';\n  }\n  \n  if (options.includeHeaders === undefined) {\n    options.includeHeaders = true;\n  }\n  if (options.includeMeta === undefined) {\n    options.includeMeta = true;\n  }\n  if (options.includeUnits === undefined) {\n    options.includeUnits = true;\n  }\n  \n  const delimiter = options.delimiter || ',';\n  \n  let _headers = options.headers;\n  if (!_headers) {\n    _headers = Object.keys(jsonData[0]);\n  }\n  \n  const rows = jsonData.map(row => _headers.map(h => _toSafeString(row[h])));\n  \n  const csvRows = [\n    _headers.map(h => camelToSnake(h)).join(delimiter), // header row\n    ...rows.map(r => r.join(delimiter)) // data rows\n  ];\n  \n  if (!options.includeHeaders) {\n    csvRows.shift();\n  }\n  \n  if (options.units && options.includeUnits) {\n    const unitRow = '#units ' + options.units.map(u => _toSafeString(u)).join(delimiter);\n    // insert before first row or header\n    csvRows.unshift(unitRow);\n  }\n  \n\n  if (options.meta && options.includeMeta) {\n    csvRows.unshift(...options.meta);\n  }\n  \n  \n  return csvRows.join('\\n');\n}\n\n/**\n * Create a tab-separated fixed width string from CSV data\n * @param csvData CSV data as a string\n * @param csvDelimiter Delimiter used in the CSV data (default is ',')\n * @returns Fixed width string\n */\nexport function csv2FixedWidth(csvData: string, csvDelimiter = ',', fixedWidthDelimiter = '\\t'): string {\n  const lines = csvData.split('\\n').map(line => {\n    if (line.trim() === '') return [];\n    if (line.startsWith('#') && !line.startsWith('#units')) {\n      return [line]; // comment line, do not split\n    }\n    return line.split(csvDelimiter);\n  });\n  if (lines.length === 0) {\n    console.error('No lines in CSV data');\n    return '';\n  }\n\n  const colWidths: number[] = [];\n  lines.forEach(row => {\n    if (row.length === 0) return;\n    if (row[0].startsWith('#') && !row[0].startsWith('#units')) return;\n    \n    row.forEach((cell, idx) => {\n      if (!isNaN(cell.length)) {\n        colWidths[idx] = Math.max(colWidths[idx] || 0, cell.length);\n      }\n    });\n  });\n  \n\n  const fixedWidthLines = lines.map(row => {\n    if (row.length === 0) return '';\n    // comment line, do not pad, just reconstruct it\n    if (row[0].startsWith('#') && !row[0].startsWith('#units')) return row[0]; \n      \n    return row.map((cell, idx) => (idx>0 ?'  ':'') + `${cell.padEnd(colWidths[idx],' ')}`).join(fixedWidthDelimiter);\n  }\n  );\n\n  return fixedWidthLines.join('\\n');\n}\n\nexport interface SampleCSVJsonOutput {\n  data: object[];\n  headers?: string[];\n  meta?: string[];\n  units?: (string | null)[];\n}\n\nexport function samplesToJSON(dataset: Prettify<UserDataset>, includeMeta = true, includeUnits = true): SampleCSVJsonOutput {\n  const jsonData = convertSamplesToJson(dataset);\n  \n  const headers = [\n    'columnDensity',\n    'uncertainty',\n    'utcDateTime',\n    'localDateTime',\n    'localDate',\n    'localTime',\n    'timezone',\n    'utcOffsetHours',\n  ];\n\n  return {\n    data: jsonData, \n    headers, \n    meta: includeMeta ? createCODAPMeta(dataset) : undefined,\n    units: includeUnits ? [\n      dataset.molecule === 'o3' ? 'Dobson Units' : 'molecules per cm^2', // columnDensity\n      dataset.molecule === 'o3' ? 'Dobson Units' : 'molecules per cm^2', // uncertainty\n      '', // localDateTime\n      '', // utcDateTime\n      '', // localDate\n      '', // localTime\n      '', // timezone\n      'hours', // utcOffsetHours\n    ] : undefined,\n  };\n}\n\n\n\n\n\n/*\nSo folded data may have a time column, if it was not folded\nand only binned. so we will have to handle both cases.\n*/\nexport function foldedSamplesToJSON(dataset: UserDataset, includeMeta = true, includeUnits = true): SampleCSVJsonOutput {\n  if (!dataset.folded || !dataset.plotlyDatasets) {\n    console.error('Dataset is not folded');\n    return { data: [], headers: undefined, meta:  undefined, units: undefined };\n  }\n  \n  const foldedDataSet = dataset.folded.raw;\n  \n\n  //   // if the data was not folded, then we will have timestamps in x, otherwise it will be indices\n  const useTimes = dataset.folded.foldingPeriod === 'none';\n\n  const center = regionCenter(dataset.region);\n  const tz = tz_lookup(center.lat, center.lon);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const jsonData: any[] = [];\n\n  Object.keys(foldedDataSet.values).forEach((key) => {\n    const columnDensity = foldedDataSet.values[key].value;\n    const bin = foldedDataSet.values[key].bin;\n    const error = foldedDataSet.errors[bin].upper;\n    let o = {\n      columnDensity,\n      uncertainty: error,\n      timezone: tz,\n    };\n    if (useTimes) {\n      const timestamp = bin;\n      const date = new Date(timestamp);\n      o = {\n        ...o,\n        ...dateToCODAPStrings(date, tz),\n      };\n    } else {\n      o[dataset.folded.foldType + '_numeric'] = bin;\n      o[dataset.folded.foldType + '_value'] = formatFoldedBinValue(dataset.folded.foldType, bin);\n      // o['time_unit'] = foldedDataBinUnit(dataset.folded.foldType);\n    }\n    jsonData.push(o);\n  });\n  \n  const headers = useTimes ? [\n    'columnDensity',\n    'uncertainty',\n    'utcDateTime',\n    'localDateTime',\n    'localDate',\n    'localTime',\n    'timezone',\n    'utcOffsetHours',\n  ] : [\n    'columnDensity',\n    'uncertainty',\n    `${dataset.folded.foldType}_numeric`,\n    `${dataset.folded.foldType}_value`,\n  ];\n  \n  const units = useTimes ? [\n    dataset.molecule === 'o3' ? 'Dobson Units' : 'molecules per cm^2', // columnDensity\n    dataset.molecule === 'o3' ? 'Dobson Units' : 'molecules per cm^2', // uncertainty\n    '', // utcDateTime\n    '', // localDateTime\n    '', // localDate\n    '', // localTime\n    '', // timezone\n    'hours', // utcOffsetHours\n  ] : [\n    dataset.molecule === 'o3' ? 'Dobson Units' : 'molecules per cm^2', // columnDensity\n    dataset.molecule === 'o3' ? 'Dobson Units' : 'molecules per cm^2', // uncertainty\n    foldedDataBinUnit(dataset.folded.foldType), // folded bin numeric\n    '', // folded bin value\n  ];  \n  \n  \n  return {\n    data: jsonData, \n    headers: headers, \n    meta: includeMeta ? createCODAPMeta(dataset) : undefined,\n    units: includeUnits ? units : undefined,\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, withKeys as _withKeys, withCtx as _withCtx } from \"vue\"\n\nconst _hoisted_1 = { class: \"save-csv\" }\nconst _hoisted_2 = [\"download\"]\nconst _hoisted_3 = {\n  key: 0,\n  class: \"utdc--loading\"\n}\nconst _hoisted_4 = { key: 1 }\n\nimport { onMounted, useTemplateRef, onUnmounted, ref, nextTick, watch} from 'vue';\nimport { csv2FixedWidth, json2Csv, type SampleCSVJsonOutput } from '@/utils/data_converters';\n\nexport interface OutputOptions {\n  delimiter: string; // default ','\n  includeHeaders: boolean; // default true\n  includeUnits: boolean; // default true\n  includeMeta: boolean; // default true\n  fixedWidth: boolean; // default false\n}\ninterface SaveCsvProps {\n  json: SampleCSVJsonOutput | undefined;\n  datasetName?: string;\n  fileOptions?: OutputOptions;\n  clipboardOptions?: OutputOptions;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'SaveCSV',\n  props: {\n    json: {},\n    datasetName: {},\n    fileOptions: { default: () => ({\n    delimiter: ',',\n    includeHeaders: true,\n    includeUnits: true,\n    includeMeta: true,\n    fixedWidth: false,\n  }) },\n    clipboardOptions: { default: () => ({\n    delimiter: '\\t',\n    includeHeaders: true,\n    includeUnits: false,\n    includeMeta: true,\n    fixedWidth: false,\n  }) }\n  },\n  setup(__props: any) {\n\nconst isLoading = ref(true);\nconst startLoading = performance.now();\nconst bothReady = ref([false, false]); // [fileCSV ready, clipboardCSV ready]\nwatch(bothReady, (newVal) => {\n  if (newVal[0] && newVal[1]) {\n    isLoading.value = false;\n    const endLoading = performance.now();\n    console.log(`SaveCSV: CSV generation took ${endLoading - startLoading} ms`);\n  }\n}, { immediate: true, deep: true });\nconst props = __props;\n\n\nconst fileCSV = ref('');\nconst clipboardCSV = ref('');\nconst getfileCSV = async () => {\n  if (props.json === undefined) return '';\n  if (props.fileOptions.fixedWidth === true) {\n    const csv = json2Csv(props.json.data, {...props.json, ...props.fileOptions, delimiter: '@@@@@',});\n    return csv2FixedWidth(csv, '@@@@@', props.fileOptions.delimiter ?? '\\t');\n  }\n  \n  return json2Csv(\n    props.json.data, \n    {...props.json, ...props.fileOptions}\n  );\n};\n\nconst getclipboardCSV = async () => {\n  if (props.json === undefined) return '';\n  if (props.fileOptions.fixedWidth === true) {\n    const csv = json2Csv(props.json.data, {...props.json, ...props.clipboardOptions, delimiter: '@@@@@',});\n    return csv2FixedWidth(csv, '@@@@@', props.clipboardOptions.delimiter ?? '\\t');\n  }\n  return json2Csv(\n    props.json.data, \n    {...props.json, ...props.clipboardOptions}\n  );\n};\n\nconst csvDownloadLink = useTemplateRef<HTMLAnchorElement>('csvDownloadLink');\nconst url = ref<string>('');\n  \nfunction setupFileAndUrls() {\n  if (url.value !== '') {\n    URL.revokeObjectURL(url.value);\n    url.value = '';\n  }\n  isLoading.value = true;\n  console.log(`SaveCSV: Generating file CSV`);\n  getfileCSV().then((csv) => {\n    fileCSV.value = csv;\n  }).then(() => {\n    if (csvDownloadLink.value && props.json !== undefined) {\n      const blob = new Blob([fileCSV.value], { type: 'text/csv;charset=utf-8;' });\n      url.value = URL.createObjectURL(blob);\n      csvDownloadLink.value.href = url.value;\n      bothReady.value[0] = true;\n    } else {\n      console.error(`SaveCSV failed because csvDownloadLink or json is undefined`);\n    }\n  });\n  \n  getclipboardCSV().then((csv) => {\n    clipboardCSV.value = csv;\n    if (csv !== ''){\n      bothReady.value[1] = true;\n    }\n  });\n}\n  \nonMounted(() => {\n  console.log(`SaveCSV: Starting CSV generation`);\n  nextTick(setupFileAndUrls);\n});\n\nwatch(() => props.json, (newVal, oldVal) => {\n  if (newVal !== oldVal) {\n    console.log(`SaveCSV: json prop changed, regenerating CSV`);\n    bothReady.value = [false, false];\n    setupFileAndUrls();\n  }\n});\n\n\nfunction downloadCsv() {\n  if (csvDownloadLink.value) {\n    csvDownloadLink.value.click();\n  }\n}\n\nonUnmounted(() => {\n  if (url.value !== '') {\n    URL.revokeObjectURL(url.value);\n  }\n});\n\n\n// function saveCsv() {\n//   if (csv === undefined) return;\n//   const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n//   const link = document.createElement('a');\n//   const url = URL.createObjectURL(blob);\n//   link.href = url;\n//   link.download = `dataset_${new Date() .toLocaleString()}.csv`;\n//   link.style.visibility = 'hidden';\n//   document.body.appendChild(link);\n//   link.click();\n//   document.body.removeChild(link);\n//   URL.revokeObjectURL(url);\n// }\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_progress_circular = _resolveComponent(\"v-progress-circular\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_use_clipboard = _resolveComponent(\"use-clipboard\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"a\", {\n      ref_key: \"csvDownloadLink\",\n      ref: csvDownloadLink,\n      style: {\"display\":\"none\"},\n      href: \"#\",\n      download: __props.datasetName ?? 'download.csv'\n    }, null, 8, _hoisted_2),\n    (isLoading.value)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n          _createVNode(_component_v_progress_circular, {\n            indeterminate: \"\",\n            color: \"primary\"\n          }),\n          _cache[0] || (_cache[0] = _createElementVNode(\"span\", { class: \"ml-4\" }, \"Readying files...\", -1))\n        ]))\n      : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n          _createVNode(_component_v_btn, {\n            class: \"save-csv__action\",\n            variant: \"text\",\n            density: \"compact\",\n            disabled: __props.json === undefined || url.value === '',\n            onClick: downloadCsv,\n            onKeyup: _withKeys(downloadCsv, [\"enter\"])\n          }, {\n            default: _withCtx(() => [\n              (url.value!=='')\n                ? (_openBlock(), _createBlock(_component_v_icon, {\n                    key: 0,\n                    icon: \"mdi-table-arrow-down\",\n                    color: \"#ffcc33\"\n                  }))\n                : (_openBlock(), _createBlock(_component_v_progress_circular, {\n                    key: 1,\n                    indeterminate: \"\",\n                    size: \"16\",\n                    width: \"2\",\n                    color: \"#ffcc33\"\n                  })),\n              _cache[1] || (_cache[1] = _createElementVNode(\"span\", { class: \"save-csv__label\" }, \"Download CSV\", -1))\n            ]),\n            _: 1\n          }, 8, [\"disabled\"]),\n          _createVNode(_component_use_clipboard, { source: __props.json }, {\n            default: _withCtx(({ copy, isSupported }) => [\n              _createVNode(_component_v_btn, {\n                class: \"save-csv__action\",\n                variant: \"text\",\n                density: \"compact\",\n                disabled: !isSupported || __props.json === undefined || clipboardCSV.value === '',\n                onClick: () => copy(clipboardCSV.value),\n                onKeyup: _withKeys(() => copy(clipboardCSV.value), [\"enter\"])\n              }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_icon, {\n                    icon: \"mdi-clipboard-check-multiple\",\n                    color: \"#ffcc33\"\n                  }),\n                  _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"save-csv__label\" }, \"Copy CSV to clipboard\", -1))\n                ]),\n                _: 1\n              }, 8, [\"disabled\", \"onClick\", \"onKeyup\"])\n            ]),\n            _: 1\n          }, 8, [\"source\"])\n        ]))\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"save-csv\">\n    <a ref=\"csvDownloadLink\"\n      style=\"display: none;\"\n      href=\"#\"\n      :download=\"datasetName ?? 'download.csv'\"\n      ></a>\n    <div v-if=\"isLoading\" class=\"utdc--loading\">\n      <v-progress-circular indeterminate color=\"primary\" />\n      <span class=\"ml-4\">Readying files...</span>\n    </div>\n    <div v-else>\n    <v-btn\n      class=\"save-csv__action\"\n      variant=\"text\"\n      density=\"compact\"\n      :disabled=\"json === undefined || url === ''\"\n      @click=\"downloadCsv\"\n      @keyup.enter=\"downloadCsv\"\n    >\n      <v-icon v-if=\"url!==''\" icon=\"mdi-table-arrow-down\" color=\"#ffcc33\" />\n      <v-progress-circular\n        v-else\n        indeterminate\n        size=\"16\"\n        width=\"2\"\n        color=\"#ffcc33\"\n      />\n      <span class=\"save-csv__label\">Download CSV</span>\n    </v-btn>\n    <use-clipboard v-slot=\"{ copy, isSupported }\" :source=\"json\">\n      <v-btn\n        class=\"save-csv__action\"\n        variant=\"text\"\n        density=\"compact\"\n        :disabled=\"!isSupported || json === undefined || clipboardCSV === ''\"\n        @click=\"() => copy(clipboardCSV)\"\n        @keyup.enter=\"() => copy(clipboardCSV)\"\n      >\n        <v-icon icon=\"mdi-clipboard-check-multiple\" color=\"#ffcc33\" />\n        <span class=\"save-csv__label\">Copy CSV to clipboard</span>\n      </v-btn>\n    </use-clipboard>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { onMounted, useTemplateRef, onUnmounted, ref, nextTick, watch} from 'vue';\nimport { csv2FixedWidth, json2Csv, type SampleCSVJsonOutput } from '@/utils/data_converters';\n\nconst isLoading = ref(true);\nconst startLoading = performance.now();\nconst bothReady = ref([false, false]); // [fileCSV ready, clipboardCSV ready]\nwatch(bothReady, (newVal) => {\n  if (newVal[0] && newVal[1]) {\n    isLoading.value = false;\n    const endLoading = performance.now();\n    console.log(`SaveCSV: CSV generation took ${endLoading - startLoading} ms`);\n  }\n}, { immediate: true, deep: true });\nexport interface OutputOptions {\n  delimiter: string; // default ','\n  includeHeaders: boolean; // default true\n  includeUnits: boolean; // default true\n  includeMeta: boolean; // default true\n  fixedWidth: boolean; // default false\n}\ninterface SaveCsvProps {\n  json: SampleCSVJsonOutput | undefined;\n  datasetName?: string;\n  fileOptions?: OutputOptions;\n  clipboardOptions?: OutputOptions;\n}\n\nconst props = withDefaults(defineProps<SaveCsvProps>(), {\n  fileOptions: () => ({\n    delimiter: ',',\n    includeHeaders: true,\n    includeUnits: true,\n    includeMeta: true,\n    fixedWidth: false,\n  }),\n  clipboardOptions: () => ({\n    delimiter: '\\t',\n    includeHeaders: true,\n    includeUnits: false,\n    includeMeta: true,\n    fixedWidth: false,\n  }),\n});\n\n\nconst fileCSV = ref('');\nconst clipboardCSV = ref('');\nconst getfileCSV = async () => {\n  if (props.json === undefined) return '';\n  if (props.fileOptions.fixedWidth === true) {\n    const csv = json2Csv(props.json.data, {...props.json, ...props.fileOptions, delimiter: '@@@@@',});\n    return csv2FixedWidth(csv, '@@@@@', props.fileOptions.delimiter ?? '\\t');\n  }\n  \n  return json2Csv(\n    props.json.data, \n    {...props.json, ...props.fileOptions}\n  );\n};\n\nconst getclipboardCSV = async () => {\n  if (props.json === undefined) return '';\n  if (props.fileOptions.fixedWidth === true) {\n    const csv = json2Csv(props.json.data, {...props.json, ...props.clipboardOptions, delimiter: '@@@@@',});\n    return csv2FixedWidth(csv, '@@@@@', props.clipboardOptions.delimiter ?? '\\t');\n  }\n  return json2Csv(\n    props.json.data, \n    {...props.json, ...props.clipboardOptions}\n  );\n};\n\nconst csvDownloadLink = useTemplateRef<HTMLAnchorElement>('csvDownloadLink');\nconst url = ref<string>('');\n  \nfunction setupFileAndUrls() {\n  if (url.value !== '') {\n    URL.revokeObjectURL(url.value);\n    url.value = '';\n  }\n  isLoading.value = true;\n  console.log(`SaveCSV: Generating file CSV`);\n  getfileCSV().then((csv) => {\n    fileCSV.value = csv;\n  }).then(() => {\n    if (csvDownloadLink.value && props.json !== undefined) {\n      const blob = new Blob([fileCSV.value], { type: 'text/csv;charset=utf-8;' });\n      url.value = URL.createObjectURL(blob);\n      csvDownloadLink.value.href = url.value;\n      bothReady.value[0] = true;\n    } else {\n      console.error(`SaveCSV failed because csvDownloadLink or json is undefined`);\n    }\n  });\n  \n  getclipboardCSV().then((csv) => {\n    clipboardCSV.value = csv;\n    if (csv !== ''){\n      bothReady.value[1] = true;\n    }\n  });\n}\n  \nonMounted(() => {\n  console.log(`SaveCSV: Starting CSV generation`);\n  nextTick(setupFileAndUrls);\n});\n\nwatch(() => props.json, (newVal, oldVal) => {\n  if (newVal !== oldVal) {\n    console.log(`SaveCSV: json prop changed, regenerating CSV`);\n    bothReady.value = [false, false];\n    setupFileAndUrls();\n  }\n});\n\n\nfunction downloadCsv() {\n  if (csvDownloadLink.value) {\n    csvDownloadLink.value.click();\n  }\n}\n\nonUnmounted(() => {\n  if (url.value !== '') {\n    URL.revokeObjectURL(url.value);\n  }\n});\n\n\n// function saveCsv() {\n//   if (csv === undefined) return;\n//   const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n//   const link = document.createElement('a');\n//   const url = URL.createObjectURL(blob);\n//   link.href = url;\n//   link.download = `dataset_${new Date() .toLocaleString()}.csv`;\n//   link.style.visibility = 'hidden';\n//   document.body.appendChild(link);\n//   link.click();\n//   document.body.removeChild(link);\n//   URL.revokeObjectURL(url);\n// }\n\n</script>\n\n<style scoped>\n.save-csv {\n  display: inline;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.save-csv__action {\n  display: inline;\n  text-decoration: none;\n  text-transform: none;\n  font-size: 1em;\n}\n\n.save-csv__label {\n  white-space: nowrap;\n}\n</style>\n","import script from \"./SaveCSV.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SaveCSV.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SaveCSV.vue?vue&type=style&index=0&id=143e4c2c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-143e4c2c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, unref as _unref, toDisplayString as _toDisplayString } from \"vue\"\n\nconst _hoisted_1 = { id: \"user-dataset-table-container\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"utdc--loading\"\n}\nconst _hoisted_3 = { key: 1 }\nconst _hoisted_4 = {\n  key: 0,\n  id: \"utdc--samples\"\n}\nconst _hoisted_5 = {\n  key: 1,\n  id: \"utdc--folded\"\n}\nconst _hoisted_6 = { class: \"utdc--uncertainty-note\" }\n\nimport { computed, ref, onMounted, nextTick } from 'vue';\nimport type { Prettify, UserDataset, UnifiedRegion } from '@/types';\nimport type { FoldedTimeSeriesData, } from '@/esri/services/aggregation';\nimport type { TimeBinOptions, FoldingPeriodOptions } from '@/utils/foldingValidation';\nimport { regionCenter } from '@/utils/data_converters';\n\n\nimport { samplesToJSON, foldedSamplesToJSON, type SampleCSVJsonOutput } from '@/utils/data_converters';\nimport tz_lookup from '@photostructure/tz-lookup';\nimport SaveCsv, {type OutputOptions} from './SaveCSV.vue';\nimport { formatFoldedBinValue } from '@/utils/folded_bin_processor';\n\n\nimport { foldTypeToLabel } from '@/utils/folded_bin_processor';\n\nconst FILE_DELIMITER = ',';\nconst FIXED_WIDTH_DELIMITER = ','; // fixed width files use tabs\nconst DOWNLOAD_FILE_FIXED_WIDTH = true;\nconst CLIPBOARD_DELIMITER = '\\t'; // a tab break is intepreted by google sheets as a column break\n\ntype DataTableItem = {\n  date: Date | number | string;\n  value: number | null;\n  error?: number;\n};\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'UserDatasetTable',\n  props: {\n    dataset: {}\n  },\n  emits: [\"rowClick\"],\n  setup(__props: any, { emit: __emit }) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst clipboardOptions: OutputOptions = {\n  delimiter: CLIPBOARD_DELIMITER,\n  includeHeaders: true,\n  includeMeta: true, // codap formatted meta, includes units\n  includeUnits: true, // unit row not seen by codap, but probably useful in a spreadsheet, so keep it. to exclude it, set <<<< this to false.\n  fixedWidth: true, // doesn't have to be fixed width. but we'll keep it consistent with file download\n};\n\nconst fileOptions: OutputOptions = {\n  delimiter: DOWNLOAD_FILE_FIXED_WIDTH ? FIXED_WIDTH_DELIMITER : FILE_DELIMITER,\n  includeHeaders: true,\n  includeMeta: true,\n  includeUnits: true,\n  fixedWidth: DOWNLOAD_FILE_FIXED_WIDTH,\n};\n\nconst props = __props;\n\nconst isLoading = ref(true);\n\nconst samples = props.dataset.samples;\nconst errors = props.dataset.errors;\nconst center = regionCenter(props.dataset.region);\nconst tz = tz_lookup(center.lat, center.lon);\n\nconst errorMessage = computed(() => {\n  if (samples === undefined) {\n    return 'No samples available in this dataset.';\n  }\n  if (Object.keys(samples).length === 0) {\n    return 'Samples has length 0 for this dataset';\n  }\n  return null;\n});\n\nconst toDate = (date: Date) => date.toLocaleDateString(undefined, {dateStyle: 'medium'});\nconst toTime = (date: Date) => date.toLocaleTimeString(undefined, {\n  hour12:true, hour:'numeric', minute: '2-digit', second:'2-digit',\n  timeZone: tz,\n});\nconst toDateTime = (date: Date) => date.toLocaleString(undefined, {\n  \"dateStyle\": \"medium\",\n  \"timeStyle\": \"short\",\n  timeZone: tz,\n});\n\n\nfunction formatValue(value: number | undefined | null): string {\n  if (value === undefined || value === null) { return 'N/A'; }\n  if (props.dataset.molecule === 'o3') { return value.toFixed(2); }\n  return (value / 1e14).toFixed(2);\n}\n\nfunction formatError(error: number | undefined | null): string {\n  if (error === undefined || error === null) { return 'N/A'; }\n  if (props.dataset.molecule === 'o3') { return error.toFixed(2); }\n  return (error / 1e14).toFixed(2);\n}\n\nfunction formatValueError(value: number | undefined | null, error: number | undefined | null): string {\n  if (!value && !error) {\n    return '';\n  }\n  const valStr = formatValue(value);\n  const errStr = formatError(error);\n  return `${valStr} (${errStr})`;\n}\n\nconst sampleHeaders = [\n  { \n    title: 'Date' , \n    key: 'date',\n    value: item => toDate(item.date),\n  },\n  { \n    title: 'Local Time', \n    key: 'localTime',\n    value: item => toTime(item.date) \n  },\n  { \n    title: 'Column Density',\n    children: [{\n      title:  props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => formatValue(item.value),\n    }]\n  },\n  {\n    title: 'Uncertainty*',\n    children: [{\n      title:  props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'uncertainty',\n      value: item => formatError(item.error),\n    }]\n  },\n];\n\nconst samplesItems = ref<DataTableItem[]>([]);\n\nconst getSamplesItems = () => {\n  if (!samples) {\n    return [];\n  }\n  return Object.entries(samples).map(([key, value]) => ({\n    date: value.date,\n    value: value.value,\n    error: errors ? errors[key]?.upper : undefined,\n  }));\n};\n\n\nconst folded = props.dataset.folded;\nconst timeBin = props.dataset.folded?.timeBin as TimeBinOptions | undefined; \nconst foldPeriod = props.dataset.folded?.foldPeriod as FoldingPeriodOptions | undefined;\nconst foldedData = props.dataset.folded?.raw as FoldedTimeSeriesData | undefined;\n\nconst errorTypeStrinc = (!folded || (folded && folded.useSEM)) ? 'standard error of mean' : 'standard deviation';\n\nconst foldedHeaders = [\n  { \n    title: foldTypeToLabel(folded?.foldType || 'none'),\n    key: 'date',\n  },\n  { \n    title: 'Column Density',\n    children: [{\n      title: props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => formatValue(item.value)\n    }]\n  },\n  {\n    title: 'Uncertainty*',\n    children: [{\n      title:  props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'uncertainty',\n      value: item => formatError(item.error),\n    }]\n  }\n];\nconst foldedItems = ref<DataTableItem[]>([]);\nconst getfFoldedItems = () => {\n  if (!foldedData) {\n    return [];\n  }\n  return Object.entries(foldedData.values).map(([key, value]) => ({\n    date: foldedData.foldType.toLowerCase().endsWith('none') ? toDateTime(new Date(value.bin)).replace(', 12:00 AM', '') : formatFoldedBinValue(folded.foldType, value.bin),\n    // date: formatFoldedBinValue(folded.foldType, value.bin),\n    value: value.value,\n    error: foldedData.errors ? foldedData.errors[key]?.upper : undefined,\n  }));\n};\n\nconst jsonData = ref<SampleCSVJsonOutput | undefined>(undefined);\n// Compute JSON data once for CSV export\nconst getJsonData = () => {\n  if (samples && Object.keys(samples).length > 0) {\n    return samplesToJSON(props.dataset, true, true);\n  } else if (folded) {\n    return foldedSamplesToJSON(props.dataset, true, true);\n  }\n  return undefined;\n};\n\nonMounted(() => {\n  if (!samples && !folded) {\n    return;\n  }\n\n  // Use requestIdleCallback to avoid blocking the UI\n  const processData = () => {\n    samplesItems.value = getSamplesItems();\n    foldedItems.value = getfFoldedItems();\n    jsonData.value = getJsonData();\n    isLoading.value = false;\n  };\n\n  // this won't work on Safari, so we fallback, but waiting for idle\n  // makes the ui more responsive\n  if (typeof requestIdleCallback !== 'undefined') {\n    requestIdleCallback(processData);\n  } else {\n    processData();\n  }\n});\n\n\nconst emits = __emit;\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_progress_circular = _resolveComponent(\"v-progress-circular\")!\n  const _component_v_data_table = _resolveComponent(\"v-data-table\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (isLoading.value)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createVNode(_component_v_progress_circular, {\n            indeterminate: \"\",\n            color: \"primary\"\n          }),\n          _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"ml-4\" }, \"Creating table...\", -1))\n        ]))\n      : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n          (_unref(samples) && Object.keys(_unref(samples)).length > 0)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                _createVNode(SaveCsv, {\n                  json: jsonData.value,\n                  \"clipboard-options\": clipboardOptions,\n                  \"file-options\": fileOptions,\n                  \"dataset-name\": __props.dataset.name\n                }, null, 8, [\"json\", \"dataset-name\"]),\n                _createVNode(_component_v_data_table, {\n                  class: \"utdc--data-table utdc--sampples-table\",\n                  items: samplesItems.value,\n                  headers: sampleHeaders,\n                  \"onClick:row\": _cache[0] || (_cache[0] = ($event: any) => (emits('rowClick', $event.item)))\n                }, null, 8, [\"items\"])\n              ]))\n            : (_unref(folded))\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                  _createVNode(SaveCsv, {\n                    json: jsonData.value,\n                    \"clipboard-options\": clipboardOptions,\n                    \"file-options\": fileOptions,\n                    \"dataset-name\": __props.dataset.name\n                  }, null, 8, [\"json\", \"dataset-name\"]),\n                  _createVNode(_component_v_data_table, {\n                    class: \"utdc--data-table utdc--folded-table\",\n                    headers: foldedHeaders,\n                    items: foldedItems.value,\n                    \"onClick:row\": _cache[1] || (_cache[1] = ($event: any) => (emits('rowClick', $event.item)))\n                  }, null, 8, [\"items\"]),\n                  _createElementVNode(\"p\", _hoisted_6, \" * The uncertainty for this value is the \" + _toDisplayString(_unref(errorTypeStrinc)), 1)\n                ]))\n              : _createCommentVNode(\"\", true)\n        ]))\n  ]))\n}\n}\n\n})","<template>\n  <div id=\"user-dataset-table-container\">\n    <!-- Loading state -->\n    <div v-if=\"isLoading\" class=\"utdc--loading\">\n      <v-progress-circular indeterminate color=\"primary\" />\n      <span class=\"ml-4\">Creating table...</span>\n    </div>\n    <div v-else>\n      <div v-if=\"samples && Object.keys(samples).length > 0\" id=\"utdc--samples\">\n        <!-- must pass '\\t' and '\\n' as javascript, otherwise it will be interpreted literally -->\n        <save-csv \n          :json=\"jsonData\"\n          :clipboard-options=\"clipboardOptions\"\n          :file-options=\"fileOptions\"\n          :dataset-name=\"dataset.name\"\n          />\n        <v-data-table\n          class=\"utdc--data-table utdc--sampples-table\"\n          :items=\"samplesItems\"\n          :headers=\"sampleHeaders\"\n          @click:row=\"emits('rowClick', $event.item)\"\n        />\n      </div>\n      <div v-else-if=\"folded\" id=\"utdc--folded\">\n        <save-csv \n          :json=\"jsonData\" \n          :clipboard-options=\"clipboardOptions\"\n          :file-options=\"fileOptions\"\n          :dataset-name=\"dataset.name\"\n        />\n        <v-data-table\n          class=\"utdc--data-table utdc--folded-table\"\n          :headers=\"foldedHeaders\"\n          :items=\"foldedItems\"\n          @click:row=\"emits('rowClick', $event.item)\"\n        />\n        <p class=\"utdc--uncertainty-note\">\n          * The uncertainty for this value is the {{ errorTypeStrinc }}\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { computed, ref, onMounted, nextTick } from 'vue';\nimport type { Prettify, UserDataset, UnifiedRegion } from '@/types';\nimport type { FoldedTimeSeriesData, } from '@/esri/services/aggregation';\nimport type { TimeBinOptions, FoldingPeriodOptions } from '@/utils/foldingValidation';\nimport { regionCenter } from '@/utils/data_converters';\n\n\nimport { samplesToJSON, foldedSamplesToJSON, type SampleCSVJsonOutput } from '@/utils/data_converters';\nimport tz_lookup from '@photostructure/tz-lookup';\nimport SaveCsv, {type OutputOptions} from './SaveCSV.vue';\nimport { formatFoldedBinValue } from '@/utils/folded_bin_processor';\n\n\nconst FILE_DELIMITER = ',';\nconst FIXED_WIDTH_DELIMITER = ','; // fixed width files use tabs\nconst DOWNLOAD_FILE_FIXED_WIDTH = true;\nconst CLIPBOARD_DELIMITER = '\\t'; // a tab break is intepreted by google sheets as a column break\n\nconst clipboardOptions: OutputOptions = {\n  delimiter: CLIPBOARD_DELIMITER,\n  includeHeaders: true,\n  includeMeta: true, // codap formatted meta, includes units\n  includeUnits: true, // unit row not seen by codap, but probably useful in a spreadsheet, so keep it. to exclude it, set <<<< this to false.\n  fixedWidth: true, // doesn't have to be fixed width. but we'll keep it consistent with file download\n};\n\nconst fileOptions: OutputOptions = {\n  delimiter: DOWNLOAD_FILE_FIXED_WIDTH ? FIXED_WIDTH_DELIMITER : FILE_DELIMITER,\n  includeHeaders: true,\n  includeMeta: true,\n  includeUnits: true,\n  fixedWidth: DOWNLOAD_FILE_FIXED_WIDTH,\n};\n\nconst props = defineProps<{\n  dataset: Prettify<UserDataset>;\n}>();\n\nconst isLoading = ref(true);\n\nconst samples = props.dataset.samples;\nconst errors = props.dataset.errors;\nconst center = regionCenter(props.dataset.region);\nconst tz = tz_lookup(center.lat, center.lon);\n\nconst errorMessage = computed(() => {\n  if (samples === undefined) {\n    return 'No samples available in this dataset.';\n  }\n  if (Object.keys(samples).length === 0) {\n    return 'Samples has length 0 for this dataset';\n  }\n  return null;\n});\n\nconst toDate = (date: Date) => date.toLocaleDateString(undefined, {dateStyle: 'medium'});\nconst toTime = (date: Date) => date.toLocaleTimeString(undefined, {\n  hour12:true, hour:'numeric', minute: '2-digit', second:'2-digit',\n  timeZone: tz,\n});\nconst toDateTime = (date: Date) => date.toLocaleString(undefined, {\n  \"dateStyle\": \"medium\",\n  \"timeStyle\": \"short\",\n  timeZone: tz,\n});\n\n\nfunction formatValue(value: number | undefined | null): string {\n  if (value === undefined || value === null) { return 'N/A'; }\n  if (props.dataset.molecule === 'o3') { return value.toFixed(2); }\n  return (value / 1e14).toFixed(2);\n}\n\nfunction formatError(error: number | undefined | null): string {\n  if (error === undefined || error === null) { return 'N/A'; }\n  if (props.dataset.molecule === 'o3') { return error.toFixed(2); }\n  return (error / 1e14).toFixed(2);\n}\n\nfunction formatValueError(value: number | undefined | null, error: number | undefined | null): string {\n  if (!value && !error) {\n    return '';\n  }\n  const valStr = formatValue(value);\n  const errStr = formatError(error);\n  return `${valStr} (${errStr})`;\n}\n\nconst sampleHeaders = [\n  { \n    title: 'Date' , \n    key: 'date',\n    value: item => toDate(item.date),\n  },\n  { \n    title: 'Local Time', \n    key: 'localTime',\n    value: item => toTime(item.date) \n  },\n  { \n    title: 'Column Density',\n    children: [{\n      title:  props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => formatValue(item.value),\n    }]\n  },\n  {\n    title: 'Uncertainty*',\n    children: [{\n      title:  props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'uncertainty',\n      value: item => formatError(item.error),\n    }]\n  },\n];\n\ntype DataTableItem = {\n  date: Date | number | string;\n  value: number | null;\n  error?: number;\n};\nconst samplesItems = ref<DataTableItem[]>([]);\n\nconst getSamplesItems = () => {\n  if (!samples) {\n    return [];\n  }\n  return Object.entries(samples).map(([key, value]) => ({\n    date: value.date,\n    value: value.value,\n    error: errors ? errors[key]?.upper : undefined,\n  }));\n};\n\n\nconst folded = props.dataset.folded;\nconst timeBin = props.dataset.folded?.timeBin as TimeBinOptions | undefined; \nconst foldPeriod = props.dataset.folded?.foldPeriod as FoldingPeriodOptions | undefined;\nconst foldedData = props.dataset.folded?.raw as FoldedTimeSeriesData | undefined;\n\nimport { foldTypeToLabel } from '@/utils/folded_bin_processor';\n\nconst errorTypeStrinc = (!folded || (folded && folded.useSEM)) ? 'standard error of mean' : 'standard deviation';\n\nconst foldedHeaders = [\n  { \n    title: foldTypeToLabel(folded?.foldType || 'none'),\n    key: 'date',\n  },\n  { \n    title: 'Column Density',\n    children: [{\n      title: props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'columnDensity',\n      value: item => formatValue(item.value)\n    }]\n  },\n  {\n    title: 'Uncertainty*',\n    children: [{\n      title:  props.dataset.molecule === 'o3' ? 'Dobson Units' : '10 molecules/cm',\n      key: 'uncertainty',\n      value: item => formatError(item.error),\n    }]\n  }\n];\nconst foldedItems = ref<DataTableItem[]>([]);\nconst getfFoldedItems = () => {\n  if (!foldedData) {\n    return [];\n  }\n  return Object.entries(foldedData.values).map(([key, value]) => ({\n    date: foldedData.foldType.toLowerCase().endsWith('none') ? toDateTime(new Date(value.bin)).replace(', 12:00 AM', '') : formatFoldedBinValue(folded.foldType, value.bin),\n    // date: formatFoldedBinValue(folded.foldType, value.bin),\n    value: value.value,\n    error: foldedData.errors ? foldedData.errors[key]?.upper : undefined,\n  }));\n};\n\nconst jsonData = ref<SampleCSVJsonOutput | undefined>(undefined);\n// Compute JSON data once for CSV export\nconst getJsonData = () => {\n  if (samples && Object.keys(samples).length > 0) {\n    return samplesToJSON(props.dataset, true, true);\n  } else if (folded) {\n    return foldedSamplesToJSON(props.dataset, true, true);\n  }\n  return undefined;\n};\n\nonMounted(() => {\n  if (!samples && !folded) {\n    return;\n  }\n\n  // Use requestIdleCallback to avoid blocking the UI\n  const processData = () => {\n    samplesItems.value = getSamplesItems();\n    foldedItems.value = getfFoldedItems();\n    jsonData.value = getJsonData();\n    isLoading.value = false;\n  };\n\n  // this won't work on Safari, so we fallback, but waiting for idle\n  // makes the ui more responsive\n  if (typeof requestIdleCallback !== 'undefined') {\n    requestIdleCallback(processData);\n  } else {\n    processData();\n  }\n});\n\n\nconst emits = defineEmits<{\n  (event: 'rowClick', value: { date: Date | number; value: number; error?: number }): void;\n}>();\n</script>\n\n<style>\np.utdc--uncertainty-note {\n  border-top: 1px solid wheat;\n  margin-top: 8px;\n  font-size: 0.8em;\n  font-style: italic;\n}\n\n\n.utdc--data-table {\n  max-height: 70vh;\n  overflow-y: auto;\n}\n</style>","import script from \"./UserDatasetTable.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./UserDatasetTable.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./UserDatasetTable.vue?vue&type=style&index=0&id=2b98be12&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"time-range-card\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"time-range-config-name\"\n}\nconst _hoisted_3 = {\n  key: 1,\n  class: \"time-range-single\"\n}\nconst _hoisted_4 = { class: \"time-range-config-name\" }\nconst _hoisted_5 = {\n  key: 2,\n  class: \"time-range-multiple\"\n}\nconst _hoisted_6 = { class: \"time-range-config-name\" }\nconst _hoisted_7 = { class: \"time-range-config-item\" }\nconst _hoisted_8 = {\n  key: 0,\n  class: \"time-range-config-item\"\n}\nconst _hoisted_9 = {\n  key: 1,\n  class: \"time-range-config-item\"\n}\nconst _hoisted_10 = {\n  key: 2,\n  class: \"time-range-config-item\"\n}\nconst _hoisted_11 = {\n  key: 3,\n  class: \"time-range-config-item\"\n}\n\nimport { computed, ref } from 'vue';\nimport type { TimeRangeConfig } from './date_time_range_generators';\nimport type { TimeRange } from '@/types';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'TimeRangeCard',\n  props: {\n    name: {},\n    timeRange: {},\n    isHovering: { type: Boolean }\n  },\n  setup(__props: any) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst formatDate = (date: Date): string => {\n  try {\n    return (new Date(date)).toLocaleDateString(undefined, { timeZone: 'UTC' });\n  } catch (e) {\n    console.error('Format Date in TimeRangeCard', date);\n    return String(date);\n  }\n};\n\nconst props = __props;\n// console.log('TimeRangeCard props:', props.timeRange.config);\n\nconst showDetails = ref(false);\nfunction onShowClick() {\n  showDetails.value = !showDetails.value;\n}\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_expand_transition = _resolveComponent(\"v-expand-transition\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (__props.timeRange?.config === undefined)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString((__props.name && __props.name!=='') ? __props.name : __props.timeRange.name), 1))\n      : _createCommentVNode(\"\", true),\n    (__props.timeRange.config && __props.timeRange.config.type==='single')\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n          _createElementVNode(\"div\", _hoisted_4, _toDisplayString((new Date(__props.timeRange.config.singleDate)).toLocaleDateString(undefined, { timeZone: 'UTC'})), 1)\n        ]))\n      : _createCommentVNode(\"\", true),\n    (__props.timeRange.config && __props.timeRange.config.type==='multiple')\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n          _createElementVNode(\"div\", _hoisted_6, _toDisplayString(__props.timeRange.name), 1),\n          _createVNode(_component_v_expand_transition, null, {\n            default: _withCtx(() => [\n              (showDetails.value)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    onClick: onShowClick\n                  }, [\n                    _createElementVNode(\"div\", _hoisted_7, [\n                      _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"Date Range:\", -1)),\n                      _createTextVNode(\" \" + _toDisplayString(formatDate(__props.timeRange.config.dateRange.start)) + \" - \" + _toDisplayString(formatDate(__props.timeRange.config.dateRange.end)), 1)\n                    ]),\n                    (__props.timeRange.config.years)\n                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                          _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"Years:\", -1)),\n                          _createTextVNode(\" \" + _toDisplayString(__props.timeRange.config.years.join(', ')), 1)\n                        ]))\n                      : _createCommentVNode(\"\", true),\n                    (__props.timeRange.config.months)\n                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                          _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"Months:\", -1)),\n                          _createTextVNode(\" \" + _toDisplayString(__props.timeRange.config.months.map(s => s.slice(0,3)).join(', ')), 1)\n                        ]))\n                      : _createCommentVNode(\"\", true),\n                    (__props.timeRange.config.weekdays)\n                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                          _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Weekdays:\", -1)),\n                          _createTextVNode(\" \" + _toDisplayString(__props.timeRange.config.weekdays.map(s => s.slice(0,3)).join(', ')), 1)\n                        ]))\n                      : _createCommentVNode(\"\", true),\n                    (__props.timeRange.config.times)\n                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                          _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"Times:\", -1)),\n                          _createTextVNode(\" \" + _toDisplayString(__props.timeRange.config.times.join(', ')), 1)\n                        ]))\n                      : _createCommentVNode(\"\", true)\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_expand_transition, null, {\n            default: _withCtx(() => [\n              (__props.isHovering)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"time-range-show-details\",\n                    onClick: onShowClick\n                  }, \" Click to \" + _toDisplayString(showDetails.value ? 'hide' : 'show') + \" details \", 1))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          })\n        ]))\n      : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","<!-- TimeRange Card to display time range configuration -->\n<template>\n    <div class=\"time-range-card\">\n      \n      <!-- Display Date -->\n      <div v-if='timeRange?.config === undefined' class=\"time-range-config-name\">\n          {{ (name && name!=='') ? name : timeRange.name }} \n      </div>\n      \n        \n      <!-- Single Date -->\n      <div class=\"time-range-single\" v-if=\"timeRange.config && timeRange.config.type==='single'\">\n        <div class=\"time-range-config-name\">\n          {{ (new Date(timeRange.config.singleDate)).toLocaleDateString(undefined, { timeZone: 'UTC'})}}\n        </div>\n      </div>\n      \n      \n      <!-- Multiple Date -->\n      <div class=\"time-range-multiple\" v-if=\"timeRange.config && timeRange.config.type==='multiple'\">\n        <!-- Name -->\n        <div class=\"time-range-config-name\">\n          {{ timeRange.name}}\n        </div>\n      \n        <v-expand-transition>\n          <div v-if=\"showDetails\" @click=\"onShowClick\">\n            <!-- Date Range -->\n            <div class=\"time-range-config-item\">\n              <strong>Date Range:</strong> \n              {{ formatDate(timeRange.config.dateRange.start) }} - {{ formatDate(timeRange.config.dateRange.end) }}\n            </div>\n            \n            <!-- Years -->\n            <div v-if=\"timeRange.config.years\" class=\"time-range-config-item\">\n              <strong>Years:</strong> {{ timeRange.config.years.join(', ') }}\n            </div>\n            \n            <!-- Months -->\n            <div v-if=\"timeRange.config.months\" class=\"time-range-config-item\">\n              <strong>Months:</strong> {{ timeRange.config.months.map(s => s.slice(0,3)).join(', ') }} \n            </div>\n            \n            <!-- Weekdays -->\n            <div v-if=\"timeRange.config.weekdays\" class=\"time-range-config-item\">\n              <strong>Weekdays:</strong> {{ timeRange.config.weekdays.map(s => s.slice(0,3)).join(', ') }} \n            </div>\n            \n            <!-- Actual Time ranges -->\n            <div v-if=\"timeRange.config.times\" class=\"time-range-config-item\">\n              <strong>Times:</strong> {{ timeRange.config.times.join(', ') }}\n            </div>\n          </div>\n        </v-expand-transition>\n        <v-expand-transition>\n          <div class=\"time-range-show-details\" v-if=\"isHovering\" @click=\"onShowClick\">\n            Click to {{ showDetails ? 'hide' : 'show' }} details\n          </div>\n        </v-expand-transition>\n        \n        \n      </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { computed, ref } from 'vue';\nimport type { TimeRangeConfig } from './date_time_range_generators';\nimport type { TimeRange } from '@/types';\n\nconst formatDate = (date: Date): string => {\n  try {\n    return (new Date(date)).toLocaleDateString(undefined, { timeZone: 'UTC' });\n  } catch (e) {\n    console.error('Format Date in TimeRangeCard', date);\n    return String(date);\n  }\n};\n\nconst props = defineProps<{\n  name?: string;\n  timeRange: TimeRange;\n  isHovering: boolean;\n}>();\n// console.log('TimeRangeCard props:', props.timeRange.config);\n\nconst showDetails = ref(false);\nfunction onShowClick() {\n  showDetails.value = !showDetails.value;\n}\n\n</script>\n    \n\n<style land=\"less\" scoped>\n.time-range-card {\n  padding: 0px;\n  height: fit-content;\n}\n\n.time-range-config-name {\n  font-weight: normal;\n  margin: 0;\n  display: none;\n}\n\n.time-range-config-item {\n  margin-bottom: 2px;\n  font-size: 0.8em;\n}\n\n.time-range-show-details {\n  font-size: 0.7em;\n  background-color: cadetblue;\n  border-radius: 4px;\n}\n</style>","import script from \"./TimeRangeCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TimeRangeCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TimeRangeCard.vue?vue&type=style&index=0&id=3fa43f82&land=less&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3fa43f82\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createVNode as _createVNode, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, withCtx as _withCtx, createCommentVNode as _createCommentVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"dataset-plot-container\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"dataset-plot\"\n}\nconst _hoisted_3 = {\n  key: 1,\n  class: \"dataset-plot\"\n}\nconst _hoisted_4 = {\n  class: /*@__PURE__*/_normalizeClass(['dataset-plot__plot', 'dataset-plot-details', 'normal-data-details'])\n}\n\nimport { computed } from 'vue';\nimport FoldedPlotlyGraph from '../FoldedPlotlyGraph.vue';\nimport type {FoldedPlotlyGraphProps} from '../FoldedPlotlyGraph.vue';\nimport PlotlyGraph from './PlotlyGraph.vue';\nimport { userDatasetToPlotly } from '@/utils/data_converters';\nimport type { UserDataset } from '@/types';\nimport type { Config } from 'plotly.js-dist-min';\nimport { moleculeDescriptor } from '@/esri/utils';\nimport { DEFAULT_PLOT_LAYOUT, DEFAULT_PLOT_CONFIG } from \"@/components/plotly/defaults\";\nimport type { FoldType } from '@/esri/services/aggregation';\n\ninterface DatasetPlotProps extends Omit<FoldedPlotlyGraphProps, 'datasets'| 'foldType' | 'timezones'> {\n  datasets: UserDataset[];\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MultiDatasetPlot',\n  props: {\n    datasets: {},\n    colors: {},\n    showErrors: { type: Boolean },\n    dataOptions: {},\n    errorBarStyles: {},\n    names: {},\n    layoutOptions: {},\n    configOptions: {},\n    showZero: { type: Boolean },\n    xaxisTitle: {},\n    yaxisTitle: {}\n  },\n  emits: [\"plot-click\"],\n  setup(__props: any, { emit: __emit }) {\n\nfunction foldTypeToHumanReadable(ft: FoldType): string {\n  switch (ft) {\n\n  case 'hourOfDay':\n    return 'Stacked by day, binned by hour';\n  case 'noneOfDay':\n    return 'Stacked by day';\n    \n  case 'hourOfWeek':\n    return 'Stacked by week, binned by hour';\n  case 'dayOfWeek':\n    return 'Stacked by week, binned by day';\n  case 'noneOfWeek':\n    return 'Stacked by week';\n\n  case 'hourOfMonth':\n    return 'Stacked by month, binned by hour';\n  case 'dayOfMonth':\n    return 'Stacked by month, binned by day';\n  case 'weekOfMonth':\n    return 'Stacked by month, binned by week';\n  case 'noneOfMonth':\n    return 'Stacked by month';\n\n  case 'hourOfYear':\n    return 'Stacked by year, binned by hour';\n  case 'dayOfYear':\n    return 'Stacked by year, binned by day';\n  case 'weekOfYear':\n    return 'Stacked by year, binned by week';\n  case 'monthOfYear':\n    return 'Stacked by year, binned by month';\n  case 'noneOfYear':\n    return 'Stacked by year';\n\n  case 'hourOfNone':\n    return 'Hourly average';\n  case 'dayOfNone':\n    return 'Daily average';\n  case 'weekOfNone':\n    return 'Weekly average';\n  case 'monthOfNone':\n    return 'Monthly average';\n\n  default:\n    return pascalToSnake(ft);\n  }\n}\n\n\nconst props = __props;\nconst emit = __emit;\n\n\n\n// Common layout options for all plots\nconst dlayoutOptions = {\n  ...DEFAULT_PLOT_LAYOUT,\n  margin: { t: 20, r: 30, b: 60, l: 80 },\n  autosize: true,\n  ...(props.layoutOptions ?? {}),\n};\n\n// Common config options for all plots\nconst dconfigOptions: Partial<Config> = {\n  ...DEFAULT_PLOT_CONFIG,\n  responsive: true,\n  ...(props.configOptions ?? {}),\n};\n\nconst ddataOptions = computed(() => {\n  const defaultOpt = {showlegend: true};\n  if (props.dataOptions && props.dataOptions.length > 0) {\n    return props.dataOptions.map((opt) => ({...opt, ...defaultOpt}));\n  } else {\n    return [{...defaultOpt}];\n  }\n});\n\nconst foldedDatasets = computed(() => {\n  const byGroup: Map<string, UserDataset[]> = new Map();\n  props.datasets\n    .forEach(d => {\n      if (d.folded && d.plotlyDatasets) {\n        const ft = d.folded.foldType;\n        if (byGroup.has(ft)) {\n          byGroup.get(ft)!.push(d);\n        } else {\n          byGroup.set(ft, [d]);\n        }\n      }\n    });\n\n  \n  return byGroup;\n});\n\nconst normalDatasets = computed(() => {\n  return props.datasets.filter(d => !d.folded);\n});\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_local_scope = _resolveComponent(\"local-scope\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (foldedDatasets.value.size > 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createVNode(_component_local_scope, {\n            descriptor: _unref(moleculeDescriptor)(__props.datasets[0].molecule)\n          }, {\n            default: _withCtx(({ descriptor }) => [\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(foldedDatasets.value, ([foldType, datasets]) => {\n                return (_openBlock(), _createElementBlock(\"details\", {\n                  class: _normalizeClass(['dataset-plot__plot', 'dataset-plot-details', 'folded-data-details']),\n                  key: foldType\n                }, [\n                  _createElementVNode(\"summary\", null, [\n                    _createElementVNode(\"div\", null, _toDisplayString(descriptor.fullName.text) + \" Timeseries - \" + _toDisplayString(foldTypeToHumanReadable(foldType as FoldType)), 1)\n                  ]),\n                  _createVNode(FoldedPlotlyGraph, {\n                    datasets: datasets.map(d => d.plotlyDatasets![1]),\n                    \"show-errors\": props.showErrors,\n                    colors: datasets.map(d => (d.customColor ?? d.region.color)),\n                    \"data-options\": ddataOptions.value,\n                    names: datasets.map(d => d.name ?? d.id),\n                    \"layout-options\": dlayoutOptions,\n                    \"fold-type\": datasets[0].folded?.foldType,\n                    timezones: datasets.map(d => d.folded.timezone ?? 'UTC'),\n                    \"config-options\": dconfigOptions,\n                    \"yaxis-title\": `${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`,\n                    onPlotClick: _cache[0] || (_cache[0] = (value) => emit('plot-click', value))\n                  }, null, 8, [\"datasets\", \"show-errors\", \"colors\", \"data-options\", \"names\", \"fold-type\", \"timezones\", \"yaxis-title\"])\n                ]))\n              }), 128))\n            ]),\n            _: 1\n          }, 8, [\"descriptor\"])\n        ]))\n      : _createCommentVNode(\"\", true),\n    (normalDatasets.value.length > 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n          _createVNode(_component_local_scope, {\n            descriptor: _unref(moleculeDescriptor)(normalDatasets.value[0].molecule)\n          }, {\n            default: _withCtx(({ descriptor }) => [\n              _createElementVNode(\"details\", _hoisted_4, [\n                _createElementVNode(\"summary\", null, [\n                  _createElementVNode(\"div\", null, _toDisplayString(descriptor.fullName.text) + \" Timeseries \", 1)\n                ]),\n                _createVNode(PlotlyGraph, {\n                  datasets: normalDatasets.value.map(d => _unref(userDatasetToPlotly)(d, true)),\n                  colors: normalDatasets.value.map(d => (d.customColor || d.region.color)),\n                  \"show-errors\": __props.showErrors,\n                  \"data-options\": ddataOptions.value,\n                  names: normalDatasets.value.map(d => d.name ?? d.id),\n                  \"layout-options\": {\n                ...dlayoutOptions,\n                xaxis: {...(dlayoutOptions?.xaxis ?? {}), title: {text: 'Local Time for Region'}},\n              },\n                  \"config-options\": dconfigOptions,\n                  \"yaxis-title\": `${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`,\n                  onClick: _cache[1] || (_cache[1] = (value) => emit('plot-click', value))\n                }, null, 8, [\"datasets\", \"colors\", \"show-errors\", \"data-options\", \"names\", \"layout-options\", \"yaxis-title\"])\n              ])\n            ]),\n            _: 1\n          }, 8, [\"descriptor\"])\n        ]))\n      : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"dataset-plot-container\">\n    <div class=\"dataset-plot\" v-if=\"foldedDatasets.size > 0\">\n      <local-scope\n        :descriptor=\"moleculeDescriptor(datasets[0].molecule)\"\n      >\n        <template #default=\"{ descriptor }\">\n          <details :class=\"['dataset-plot__plot', 'dataset-plot-details', 'folded-data-details']\" v-for=\"[foldType, datasets] in foldedDatasets\" :key=\"foldType\">\n            <summary>\n              <!-- {molecule} folded timeseries -->\n              <div>\n                {{ descriptor.fullName.text }} Timeseries - {{ foldTypeToHumanReadable(foldType as FoldType) }}\n              </div>\n            </summary>\n            <folded-plotly-graph\n              :datasets=\"datasets.map(d => d.plotlyDatasets![1])\"\n              :show-errors=\"props.showErrors\"\n              :colors=\"datasets.map(d => (d.customColor ?? d.region.color))\"\n              :data-options=\"ddataOptions\"\n              :names=\"datasets.map(d => d.name ?? d.id)\"\n              :layout-options=\"dlayoutOptions\"\n              :fold-type=\"datasets[0].folded?.foldType\"\n              :timezones=\"datasets.map(d => d.folded.timezone ?? 'UTC')\"\n              :config-options=\"dconfigOptions\"\n              :yaxis-title=\"`${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`\"\n              @plot-click=\"(value) => emit('plot-click', value)\"\n            />\n          </details>\n        </template>\n      </local-scope>\n    </div>\n    <div class=\"dataset-plot\" v-if=\"normalDatasets.length > 0\">\n      <local-scope\n        :descriptor=\"moleculeDescriptor(normalDatasets[0].molecule)\"\n      >\n        <template #default=\"{ descriptor }\">\n          <details :class=\"['dataset-plot__plot', 'dataset-plot-details', 'normal-data-details']\" >\n            <summary>\n              <!-- {molecule} timeseries -->\n              <div>\n                {{ descriptor.fullName.text }} Timeseries\n              </div>\n            </summary>\n            <plotly-graph\n              :datasets=\"normalDatasets.map(d => userDatasetToPlotly(d, true))\"\n              :colors=\"normalDatasets.map(d => (d.customColor || d.region.color))\"\n              :show-errors=\"showErrors\"\n              :data-options=\"ddataOptions\"\n              :names=\"normalDatasets.map(d => d.name ?? d.id)\"\n              :layout-options=\"{\n                ...dlayoutOptions,\n                xaxis: {...(dlayoutOptions?.xaxis ?? {}), title: {text: 'Local Time for Region'}},\n              }\"\n              :config-options=\"dconfigOptions\"\n              :yaxis-title=\"`${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`\"\n              @click=\"(value) => emit('plot-click', value)\"\n            />\n          </details>\n        </template>\n      </local-scope>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue';\nimport FoldedPlotlyGraph from '../FoldedPlotlyGraph.vue';\nimport type {FoldedPlotlyGraphProps} from '../FoldedPlotlyGraph.vue';\nimport PlotlyGraph from './PlotlyGraph.vue';\nimport { userDatasetToPlotly } from '@/utils/data_converters';\nimport type { UserDataset } from '@/types';\nimport type { Config } from 'plotly.js-dist-min';\nimport { moleculeDescriptor } from '@/esri/utils';\nimport { DEFAULT_PLOT_LAYOUT, DEFAULT_PLOT_CONFIG } from \"@/components/plotly/defaults\";\nimport type { FoldType } from '@/esri/services/aggregation';\n\nfunction foldTypeToHumanReadable(ft: FoldType): string {\n  switch (ft) {\n\n  case 'hourOfDay':\n    return 'Stacked by day, binned by hour';\n  case 'noneOfDay':\n    return 'Stacked by day';\n    \n  case 'hourOfWeek':\n    return 'Stacked by week, binned by hour';\n  case 'dayOfWeek':\n    return 'Stacked by week, binned by day';\n  case 'noneOfWeek':\n    return 'Stacked by week';\n\n  case 'hourOfMonth':\n    return 'Stacked by month, binned by hour';\n  case 'dayOfMonth':\n    return 'Stacked by month, binned by day';\n  case 'weekOfMonth':\n    return 'Stacked by month, binned by week';\n  case 'noneOfMonth':\n    return 'Stacked by month';\n\n  case 'hourOfYear':\n    return 'Stacked by year, binned by hour';\n  case 'dayOfYear':\n    return 'Stacked by year, binned by day';\n  case 'weekOfYear':\n    return 'Stacked by year, binned by week';\n  case 'monthOfYear':\n    return 'Stacked by year, binned by month';\n  case 'noneOfYear':\n    return 'Stacked by year';\n\n  case 'hourOfNone':\n    return 'Hourly average';\n  case 'dayOfNone':\n    return 'Daily average';\n  case 'weekOfNone':\n    return 'Weekly average';\n  case 'monthOfNone':\n    return 'Monthly average';\n\n  default:\n    return pascalToSnake(ft);\n  }\n}\n\n\ninterface DatasetPlotProps extends Omit<FoldedPlotlyGraphProps, 'datasets'| 'foldType' | 'timezones'> {\n  datasets: UserDataset[];\n}\nconst props = defineProps<DatasetPlotProps>();\nconst emit = defineEmits<{\n  (event: \"plot-click\", value: {x: number | string | Date | null, y: number, customdata: unknown}): void;\n}>();\n\n\n\n// Common layout options for all plots\nconst dlayoutOptions = {\n  ...DEFAULT_PLOT_LAYOUT,\n  margin: { t: 20, r: 30, b: 60, l: 80 },\n  autosize: true,\n  ...(props.layoutOptions ?? {}),\n};\n\n// Common config options for all plots\nconst dconfigOptions: Partial<Config> = {\n  ...DEFAULT_PLOT_CONFIG,\n  responsive: true,\n  ...(props.configOptions ?? {}),\n};\n\nconst ddataOptions = computed(() => {\n  const defaultOpt = {showlegend: true};\n  if (props.dataOptions && props.dataOptions.length > 0) {\n    return props.dataOptions.map((opt) => ({...opt, ...defaultOpt}));\n  } else {\n    return [{...defaultOpt}];\n  }\n});\n\nconst foldedDatasets = computed(() => {\n  const byGroup: Map<string, UserDataset[]> = new Map();\n  props.datasets\n    .forEach(d => {\n      if (d.folded && d.plotlyDatasets) {\n        const ft = d.folded.foldType;\n        if (byGroup.has(ft)) {\n          byGroup.get(ft)!.push(d);\n        } else {\n          byGroup.set(ft, [d]);\n        }\n      }\n    });\n\n  \n  return byGroup;\n});\n\nconst normalDatasets = computed(() => {\n  return props.datasets.filter(d => !d.folded);\n});\n\n\n</script>\n\n<style scoped>\ndiv.dataset-plot-container {\n  display: flex;\n  flex-direction: column-reverse;\n  gap: 5px;\n}\n\ndiv.dataset-plot {\n  display: flex;\n  flex-direction: column;\n}\n\n\ndetails.dataset-plot__plot {\n  border-radius: 6px;\n  background-color: rgba(0 0 0 / .25);\n  font-size: 0.8em;\n}\n\ndetails.dataset-plot-details:hover {\n  outline: 1px solid #888;\n}\ndetails.dataset-plot-details.single-plot:hover {\n  outline: none;\n}\n\ndetails.dataset-plot-details > summary {\n  display: block;\n}\ndetails.dataset-plot-details.single-plot > summary {\n  display: none;\n}\ndetails.dataset-plot-details > summary > div {\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  height: 3em;\n}\n\n/* https://stackoverflow.com/a/66487919/11594175 */\ndetails.dataset-plot-details > summary::marker,\ndetails.dataset-plot-details > summary::-webkit-details-marker {\n  display: none;\n  content: \"\";\n}\n\ndetails.dataset-plot-details > summary:before {\n  content: \"\";\n  display: inline-block;\n  margin-right: 6px;\n  transition: transform 50ms 0s ease-in-out;\n  /*\n  transition-property: transform;\n  transition-duration: 50ms;\n  transition-delay: 0s;\n  transition-timing-function: ease-in-out;\n  */\n}\ndetails[open].dataset-plot-details > summary:before {\n  content: \"\";\n  transform: rotate(90deg);\n}\n</style>\n","import script from \"./MultiDatasetPlot.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MultiDatasetPlot.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MultiDatasetPlot.vue?vue&type=style&index=0&id=586597a0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-586597a0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, unref as _unref, createVNode as _createVNode, resolveComponent as _resolveComponent, withCtx as _withCtx } from \"vue\"\n\nconst _hoisted_1 = { class: \"dataset-plot-container\" }\nconst _hoisted_2 = { class: \"dataset-plot__title\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"dataset-plot__fold-desc\"\n}\nconst _hoisted_4 = { key: 0 }\nconst _hoisted_5 = { key: 1 }\nconst _hoisted_6 = { class: \"dataset-plot\" }\nconst _hoisted_7 = {\n  key: 0,\n  class: \"dataset-plot__plot dataset-plot-folded\"\n}\nconst _hoisted_8 = {\n  key: 1,\n  class: \"dataset-plot__plot dataset-plot-normal\"\n}\n\nimport { computed } from 'vue';\nimport FoldedPlotlyGraph from '../FoldedPlotlyGraph.vue';\nimport type {FoldedPlotlyGraphProps} from '../FoldedPlotlyGraph.vue';\nimport PlotlyGraph from './PlotlyGraph.vue';\nimport { userDatasetToPlotly } from '@/utils/data_converters';\nimport type { UserDataset } from '@/types';\nimport type { Config } from 'plotly.js-dist-min';\nimport { moleculeDescriptor } from '@/esri/utils';\nimport { DEFAULT_PLOT_CONFIG } from \"@/components/plotly/defaults\";\n\n\ninterface UserDatasetPlotProps extends Omit<FoldedPlotlyGraphProps, 'datasets'| 'foldType' | 'timezones'> {\n  dataset: UserDataset;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'UserDatasetPlot',\n  props: {\n    dataset: {},\n    colors: {},\n    showErrors: { type: Boolean, default: false },\n    dataOptions: {},\n    errorBarStyles: {},\n    names: {},\n    layoutOptions: {},\n    configOptions: {},\n    showZero: { type: Boolean },\n    xaxisTitle: {},\n    yaxisTitle: {}\n  },\n  emits: [\"plot-click\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst props = __props;\n\nconst emit = __emit;\n\n\n// Common layout options for all plots\nconst dlayoutOptions = {\n  margin: { t: 20, r: 30, b: 60, l: 80 },\n  autosize: false,\n  ...(props.layoutOptions ?? {}),\n};\n\n// Common config options for all plots\nconst dconfigOptions: Partial<Config> = {\n  ...DEFAULT_PLOT_CONFIG,\n  responsive: true,\n  ...(props.configOptions ?? {}),\n};\n\nconst ddataOptions = computed(() => {\n  const defaultOpt = {showlegend: false};\n  if (props.dataOptions && props.dataOptions.length > 0) {\n    return props.dataOptions.map((opt) => ({...opt, ...defaultOpt}));\n  } else {\n    return [{...defaultOpt}];\n  }\n});\n\nconst isFolded = (d: UserDataset) => d.folded && d.plotlyDatasets;\nconst datasetIsFolded = computed(() => isFolded(props.dataset));\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_local_scope = _resolveComponent(\"local-scope\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"h3\", _hoisted_2, _toDisplayString(__props.dataset.name), 1),\n    (datasetIsFolded.value)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n          _createElementVNode(\"ul\", null, [\n            (__props.dataset.folded?.foldingPeriod)\n              ? (_openBlock(), _createElementBlock(\"li\", _hoisted_4, \"Stacked by \" + _toDisplayString(__props.dataset.folded?.foldingPeriod), 1))\n              : _createCommentVNode(\"\", true),\n            (__props.dataset.folded?.timeBin)\n              ? (_openBlock(), _createElementBlock(\"li\", _hoisted_5, \"Binned by \" + _toDisplayString(__props.dataset.folded?.timeBin), 1))\n              : _createCommentVNode(\"\", true)\n          ])\n        ]))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", _hoisted_6, [\n      _createVNode(_component_local_scope, {\n        descriptor: _unref(moleculeDescriptor)(__props.dataset.molecule)\n      }, {\n        default: _withCtx(({ descriptor }) => [\n          (datasetIsFolded.value)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                _createVNode(FoldedPlotlyGraph, {\n                  datasets: [__props.dataset.plotlyDatasets![1]],\n                  \"show-errors\": props.showErrors,\n                  colors: [(__props.dataset.customColor ?? __props.dataset.region.color)],\n                  \"data-options\": ddataOptions.value,\n                  names: [__props.dataset.name ?? __props.dataset.id],\n                  \"layout-options\": dlayoutOptions,\n                  \"fold-type\": __props.dataset.folded?.foldType,\n                  timezones: [__props.dataset.folded.timezone ?? 'UTC'],\n                  \"config-options\": dconfigOptions,\n                  \"xaxis-title\": `Time: ${__props.dataset.folded.foldType}`,\n                  \"yaxis-title\": `${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`,\n                  onPlotClick: _cache[0] || (_cache[0] = (value) => emit('plot-click', value))\n                }, null, 8, [\"datasets\", \"show-errors\", \"colors\", \"data-options\", \"names\", \"fold-type\", \"timezones\", \"xaxis-title\", \"yaxis-title\"])\n              ]))\n            : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                _createVNode(PlotlyGraph, {\n                  datasets: [_unref(userDatasetToPlotly)(__props.dataset, true)],\n                  colors: [__props.dataset.customColor || __props.dataset.region.color],\n                  \"show-errors\": __props.showErrors,\n                  \"data-options\": ddataOptions.value,\n                  names: [__props.dataset.name ?? __props.dataset.id],\n                  \"layout-options\": {\n            ...dlayoutOptions,\n            xaxis: {...(dlayoutOptions?.xaxis ?? {}), title: {text: 'Local Time for Region'}},\n          },\n                  \"config-options\": dconfigOptions,\n                  \"xaxis-title\": \"Time\",\n                  \"yaxis-title\": `${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`,\n                  onClick: _cache[1] || (_cache[1] = (value) => emit('plot-click', value))\n                }, null, 8, [\"datasets\", \"colors\", \"show-errors\", \"data-options\", \"names\", \"layout-options\", \"yaxis-title\"])\n              ]))\n        ]),\n        _: 1\n      }, 8, [\"descriptor\"])\n    ])\n  ]))\n}\n}\n\n})","<template>\n<div class=\"dataset-plot-container\">\n  <h3 class=\"dataset-plot__title\">{{ dataset.name }}</h3>\n  <div class=\"dataset-plot__fold-desc\" v-if=\"datasetIsFolded\">\n    <ul>\n      <li v-if=\"dataset.folded?.foldingPeriod\">Stacked by {{ dataset.folded?.foldingPeriod }}</li>\n      <li v-if=\"dataset.folded?.timeBin\" >Binned by {{ dataset.folded?.timeBin }}</li>\n    </ul>\n  </div>\n  <div class=\"dataset-plot\">\n    <local-scope\n      :descriptor=\"moleculeDescriptor(dataset.molecule)\"\n    >\n      <template #default=\"{ descriptor }\">\n        <div v-if=\"datasetIsFolded\" class=\"dataset-plot__plot dataset-plot-folded\">\n        <FoldedPlotlyGraph\n          :datasets=\"[dataset.plotlyDatasets![1]]\"\n          :show-errors=\"props.showErrors\"\n          :colors=\"[(dataset.customColor ?? dataset.region.color)]\"\n          :data-options=\"ddataOptions\"\n          :names=\"[dataset.name ?? dataset.id]\"\n          :layout-options=\"dlayoutOptions\"\n          :fold-type=\"dataset.folded?.foldType\"\n          :timezones=\"[dataset.folded.timezone ?? 'UTC']\"\n          :config-options=\"dconfigOptions\"\n          :xaxis-title=\"`Time: ${dataset.folded.foldType}`\"\n          :yaxis-title=\"`${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`\"\n          @plot-click=\"(value) => emit('plot-click', value)\"\n        />\n        </div>\n        <div v-else class=\"dataset-plot__plot dataset-plot-normal\">\n        <PlotlyGraph\n          :datasets=\"[userDatasetToPlotly(dataset, true)]\"\n          :colors=\"[dataset.customColor || dataset.region.color]\"\n          :show-errors=\"showErrors\"\n          :data-options=\"ddataOptions\"\n          :names=\"[dataset.name ?? dataset.id]\"\n          :layout-options=\"{\n            ...dlayoutOptions,\n            xaxis: {...(dlayoutOptions?.xaxis ?? {}), title: {text: 'Local Time for Region'}},\n          }\"\n          :config-options=\"dconfigOptions\"\n          xaxis-title=\"Time\"\n          :yaxis-title=\"`${descriptor.shortName.html} Quantity<br>(${descriptor.unit.html})`\"\n          @click=\"(value) => emit('plot-click', value)\"\n        />\n        </div>\n      </template>\n    </local-scope>\n  </div>\n</div>\n\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue';\nimport FoldedPlotlyGraph from '../FoldedPlotlyGraph.vue';\nimport type {FoldedPlotlyGraphProps} from '../FoldedPlotlyGraph.vue';\nimport PlotlyGraph from './PlotlyGraph.vue';\nimport { userDatasetToPlotly } from '@/utils/data_converters';\nimport type { UserDataset } from '@/types';\nimport type { Config } from 'plotly.js-dist-min';\nimport { moleculeDescriptor } from '@/esri/utils';\nimport { DEFAULT_PLOT_CONFIG } from \"@/components/plotly/defaults\";\n\n\ninterface UserDatasetPlotProps extends Omit<FoldedPlotlyGraphProps, 'datasets'| 'foldType' | 'timezones'> {\n  dataset: UserDataset;\n}\nconst props = withDefaults(defineProps<UserDatasetPlotProps>(), {\n  showErrors: false,\n});\n\nconst emit = defineEmits<{\n  (event: \"plot-click\", value: {x: number | string | Date | null, y: number, customdata: unknown}): void;\n}>();\n\n\n// Common layout options for all plots\nconst dlayoutOptions = {\n  margin: { t: 20, r: 30, b: 60, l: 80 },\n  autosize: false,\n  ...(props.layoutOptions ?? {}),\n};\n\n// Common config options for all plots\nconst dconfigOptions: Partial<Config> = {\n  ...DEFAULT_PLOT_CONFIG,\n  responsive: true,\n  ...(props.configOptions ?? {}),\n};\n\nconst ddataOptions = computed(() => {\n  const defaultOpt = {showlegend: false};\n  if (props.dataOptions && props.dataOptions.length > 0) {\n    return props.dataOptions.map((opt) => ({...opt, ...defaultOpt}));\n  } else {\n    return [{...defaultOpt}];\n  }\n});\n\nconst isFolded = (d: UserDataset) => d.folded && d.plotlyDatasets;\nconst datasetIsFolded = computed(() => isFolded(props.dataset));\n\n</script>\n\n<style scoped>\ndiv.dataset-plot-container {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\ndiv.dataset-plot {\n  width: 100%;\n}\n\nh3.dataset-plot__title {\n  font-weight: normal;\n  margin-bottom: 5px;\n}\n\ndiv.dataset-plot__plot {\n  width: 100%;\n  height: 100%;\n  margin-block: 4px;\n  padding-inline: 5px;\n  border-radius: 6px;\n  background-color: rgba(0 0 0 / .25);\n  font-size: 0.8em;\n}\n\n.dataset-plot__fold-desc ul {\n  list-style-position: inside;\n  padding-left: 5px;\n}\n</style>\n","import script from \"./UserDatasetPlot.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./UserDatasetPlot.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./UserDatasetPlot.vue?vue&type=style&index=0&id=885de42a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-885de42a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"multi-plot-container__plot\"\n}\n\nimport { ref, computed } from 'vue';\nimport type { UserDataset } from '@/types';\nimport type { Config } from 'plotly.js-dist-min';\nimport MultiDatasetPlot from './MultiDatasetPlot.vue';\nimport UserDatasetPlot from './UserDatasetPlot.vue';\nimport { DEFAULT_PLOT_CONFIG, DEFAULT_PLOT_LAYOUT } from \"@/components/plotly/defaults\";\n\ninterface MultiPlotProps {\n  datasets: UserDataset[];\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MultiMoleculePlot',\n  props: {\n    datasets: {}\n  },\n  emits: [\"plot-click\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst isSingle = computed(() => {return __props.datasets.length === 1;});\n\n\n  \nconst emit = __emit;\n\nconst _showErrorBands = ref(__props.datasets.map((d) => d.folded ? true : false));\n\n// Common layout options for all plots\nconst commonLayoutOptions = {\n  ...DEFAULT_PLOT_LAYOUT,\n  autosize: false,\n  height: 350,\n  width: Math.floor(700 * 350 / 400),\n  xaxis: {\n    automargin: false,\n    gridcolor: 'rgba(128, 128, 128, 0.3)',\n    title: {\n      standoff: 10,\n    },\n  },\n  yaxis: {\n    automargin: true,\n    gridcolor: 'rgba(128, 128, 128, 0.3)',\n    title: {\n      standoff: 10,\n    },\n  },\n  legend: {\n    yanchor: 'top',\n    yref: 'paper',\n    y: 1.3,\n    orientation:'h' as |'h' | 'v',\n    bordercolor: '#ccc', \n    borderwidth:1,\n    entrywidthmode: 'pixels',\n    entrywidth: 0, // fit the text\n  }\n} as Partial<Plotly.Layout>;\n\n// Common config options for all plots\nconst commonConfigOptions: Partial<Config> = {\n  ...DEFAULT_PLOT_CONFIG,\n  responsive: true,\n};\n\n// const groupByMolecule = ref(false);\n\nconst datasetsGroupedByMolecule = computed(() => {\n  const groups = new Map<string, UserDataset[]>();\n  __props.datasets.forEach((dataset) => {\n    const molecule = dataset.molecule || 'Unknown Molecule';\n    if (!groups.has(molecule)) {\n      groups.set(molecule, []);\n    }\n    groups.get(molecule)!.push(dataset);\n  });\n  return groups;\n});\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass(['multi-plot-container', { 'single-plot': isSingle.value }])\n  }, [\n    (isSingle.value)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n          _createVNode(UserDatasetPlot, {\n            dataset: __props.datasets[0],\n            \"show-errors\": true,\n            \"data-options\": [{mode: 'markers'}],\n            \"layout-options\": commonLayoutOptions,\n            \"config-options\": commonConfigOptions,\n            onPlotClick: _cache[0] || (_cache[0] = (value) => emit('plot-click', value))\n          }, null, 8, [\"dataset\"])\n        ]))\n      : (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(datasetsGroupedByMolecule.value, (group) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            class: \"multi-plot-container__plot\",\n            key: group[0]\n          }, [\n            _createVNode(MultiDatasetPlot, {\n              datasets: group[1],\n              \"show-errors\": true,\n              \"data-options\": [{mode: 'markers'}],\n              \"layout-options\": commonLayoutOptions,\n              \"config-options\": commonConfigOptions,\n              onPlotClick: _cache[1] || (_cache[1] = (value) => emit('plot-click', value))\n            }, null, 8, [\"datasets\"])\n          ]))\n        }), 128))\n  ], 2))\n}\n}\n\n})","<template>    \n    <div :class=\"['multi-plot-container', { 'single-plot': isSingle }]\">\n      <div v-if=\"isSingle\" class=\"multi-plot-container__plot\">\n        <UserDatasetPlot\n          :dataset=\"datasets[0]\"\n          :show-errors=\"true\"\n          :data-options=\"[{mode: 'markers'}]\"\n          :layout-options=\"commonLayoutOptions\"\n          :config-options=\"commonConfigOptions\"\n          @plot-click=\"(value) => emit('plot-click', value)\"\n        />\n      </div>\n      \n      <div v-else class=\"multi-plot-container__plot\"  v-for=\"group in datasetsGroupedByMolecule\" :key=\"group[0]\">\n        <MultiDatasetPlot\n          :datasets=\"group[1]\"\n          :show-errors=\"true\"\n          :data-options=\"[{mode: 'markers'}]\"\n          :layout-options=\"commonLayoutOptions\"\n          :config-options=\"commonConfigOptions\"\n          @plot-click=\"(value) => emit('plot-click', value)\"\n        />\n      </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue';\nimport type { UserDataset } from '@/types';\nimport type { Config } from 'plotly.js-dist-min';\nimport MultiDatasetPlot from './MultiDatasetPlot.vue';\nimport UserDatasetPlot from './UserDatasetPlot.vue';\nimport { DEFAULT_PLOT_CONFIG, DEFAULT_PLOT_LAYOUT } from \"@/components/plotly/defaults\";\n\ninterface MultiPlotProps {\n  datasets: UserDataset[];\n}\n\nconst isSingle = computed(() => {return datasets.length === 1;});\n\nconst { datasets } = defineProps<MultiPlotProps>();\n  \nconst emit = defineEmits<{\n  (event: \"plot-click\", value: {x: number | string | Date | null, y: number, customdata: unknown}): void;\n}>();\n\nconst _showErrorBands = ref(datasets.map((d) => d.folded ? true : false));\n\n// Common layout options for all plots\nconst commonLayoutOptions = {\n  ...DEFAULT_PLOT_LAYOUT,\n  autosize: false,\n  height: 350,\n  width: Math.floor(700 * 350 / 400),\n  xaxis: {\n    automargin: false,\n    gridcolor: 'rgba(128, 128, 128, 0.3)',\n    title: {\n      standoff: 10,\n    },\n  },\n  yaxis: {\n    automargin: true,\n    gridcolor: 'rgba(128, 128, 128, 0.3)',\n    title: {\n      standoff: 10,\n    },\n  },\n  legend: {\n    yanchor: 'top',\n    yref: 'paper',\n    y: 1.3,\n    orientation:'h' as |'h' | 'v',\n    bordercolor: '#ccc', \n    borderwidth:1,\n    entrywidthmode: 'pixels',\n    entrywidth: 0, // fit the text\n  }\n} as Partial<Plotly.Layout>;\n\n// Common config options for all plots\nconst commonConfigOptions: Partial<Config> = {\n  ...DEFAULT_PLOT_CONFIG,\n  responsive: true,\n};\n\n// const groupByMolecule = ref(false);\n\nconst datasetsGroupedByMolecule = computed(() => {\n  const groups = new Map<string, UserDataset[]>();\n  datasets.forEach((dataset) => {\n    const molecule = dataset.molecule || 'Unknown Molecule';\n    if (!groups.has(molecule)) {\n      groups.set(molecule, []);\n    }\n    groups.get(molecule)!.push(dataset);\n  });\n  return groups;\n});\n\n\n</script>\n\n<style>\ndiv.multi-plot-container {\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n  overflow-y: auto;\n  max-height: calc(90vh - 100px);\n  align-items: center;\n  width: 100%;\n}\n\ndiv.multi-plot-container__plot {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  min-width: 438px;\n}\n\ndiv.multi-plot-container.isSingle div.multi-plot-container__plot {\n  width: auto;\n}\n</style>\n","import script from \"./MultiMoleculePlot.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MultiMoleculePlot.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MultiMoleculePlot.vue?vue&type=style&index=0&id=76a4c935&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, unref as _unref, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"user-dataset-editor\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"ude__label_input\"\n}\nconst _hoisted_3 = [\"placeholder\"]\nconst _hoisted_4 = {\n  key: 1,\n  class: \"ude__label_input\"\n}\nconst _hoisted_5 = { class: \"ude__button-container\" }\n\nimport { ref, watch, onUnmounted  } from 'vue';\nimport { useTempoStore } from \"../stores/app\";\nimport { UserDataset } from '@/types';\n\ntype Props = {\n  nameOnly?: boolean;\n  colorOnly?: boolean;\n};\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'UserDatasetEditor',\n  props: /*@__PURE__*/_mergeModels({\n    nameOnly: { type: Boolean, default: false },\n    colorOnly: { type: Boolean, default: false }\n  }, {\n    \"modelValue\": {\n  type: Object as () => UserDataset,\n  required: true,\n},\n    \"modelModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"complete\"], [\"update:modelValue\"]),\n  setup(__props: any, { emit: __emit }) {\n\nconst accentColor2 = useTempoStore().accentColor2;\n\nconst props = __props;\n\nconst model = _useModel(__props, \"modelValue\");\n\nconst emit = __emit;\n\nconst name = ref(model.value.name || '');\nconst color = ref(model.value.customColor || model.value.region.color || 'white');\nconst changed = ref(false);\n\nwatch(name, () => {\n  changed.value = true;\n});\nwatch(color, () => {\n  changed.value = true;\n});\n\nfunction save() {\n  if (model.value) {\n    model.value.name = name.value;\n    if (model.value.plotlyDatasets) {\n      model.value.plotlyDatasets[1].name = name.value;\n    }\n    model.value.customColor = color.value;\n  }\n  emit('complete');\n}\n\nfunction cancel() {\n  emit('complete');\n}\n\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Enter' && changed.value) {\n    save();\n  } else if (event.key === 'Escape') {\n    cancel();\n  }\n}\n\nwindow.addEventListener('keydown', globalKeydownHandler);\n\nfunction globalKeydownHandler(event: KeyboardEvent) {\n  const skipTags = ['INPUT', 'TEXTAREA', 'BUTTON', 'SELECT'];\n  if (\n    event.target && \n    skipTags.includes((event.target as HTMLElement).tagName)) {\n    return; \n  }\n  handleKeydown(event);\n}\nonUnmounted(() => {\n  window.removeEventListener('keydown', globalKeydownHandler);\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, {\n    width: \"fit-content\",\n    class: \"mx-auto popup-card--outline\"\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_card_text, { class: \"pb-0\" }, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_1, [\n            (!props.colorOnly)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                  _cache[3] || (_cache[3] = _createElementVNode(\"label\", { for: \"ude-name\" }, \"Edit Name:\", -1)),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    id: \"ude-name\",\n                    type: \"text\",\n                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((name).value = $event)),\n                    placeholder: model.value.name ?? 'Dataset Name',\n                    minlength: \"3\",\n                    onKeydown: handleKeydown\n                  }, null, 40, _hoisted_3), [\n                    [_vModelText, name.value]\n                  ])\n                ]))\n              : _createCommentVNode(\"\", true),\n            (!props.nameOnly)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                  _cache[5] || (_cache[5] = _createElementVNode(\"label\", { for: \"ude-color\" }, \" Edit Color:\", -1)),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    id: \"ude-color\",\n                    type: \"color\",\n                    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((color).value = $event)),\n                    onKeydown: handleKeydown\n                  }, null, 544), [\n                    [_vModelText, color.value]\n                  ]),\n                  _createVNode(_component_v_btn, {\n                    class: \"use_reset-color\",\n                    variant: \"outlined\",\n                    color: model.value.region.color,\n                    size: \"small\",\n                    onClick: _cache[2] || (_cache[2] = ($event: any) => (color.value = model.value.region.color))\n                  }, {\n                    default: _withCtx(() => [\n                      _cache[4] || (_cache[4] = _createTextVNode(\" Reset \", -1)),\n                      _createElementVNode(\"div\", {\n                        class: \"ude_color-swatch\",\n                        style: _normalizeStyle({backgroundColor: model.value.region.color})\n                      }, null, 4)\n                    ]),\n                    _: 1\n                  }, 8, [\"color\"])\n                ]))\n              : _createCommentVNode(\"\", true)\n          ])\n        ]),\n        _: 1\n      }),\n      _createElementVNode(\"div\", _hoisted_5, [\n        _createVNode(_component_v_btn, {\n          variant: \"flat\",\n          size: \"small\",\n          onClick: cancel\n        }, {\n          default: _withCtx(() => [...(_cache[6] || (_cache[6] = [\n            _createTextVNode(\"Cancel\", -1)\n          ]))]),\n          _: 1\n        }),\n        _createVNode(_component_v_btn, {\n          color: _unref(accentColor2),\n          size: \"small\",\n          onClick: save,\n          disabled: !changed.value\n        }, {\n          default: _withCtx(() => [...(_cache[7] || (_cache[7] = [\n            _createTextVNode(\"Save\", -1)\n          ]))]),\n          _: 1\n        }, 8, [\"color\", \"disabled\"])\n      ])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<!-- eslint-disable @typescript-eslint/no-unused-vars -->\n<template>\n  <!-- not too wide, and center it -->\n  <v-card width=\"fit-content\" class=\"mx-auto popup-card--outline\">\n    \n    <v-card-text class=\"pb-0\">\n      \n      <div class=\"user-dataset-editor\">\n        <div class=\"ude__label_input\" v-if=\"!props.colorOnly\">\n          <label for=\"ude-name\">Edit Name:</label>\n          <input id=\"ude-name\" type=\"text\" v-model=\"name\" :placeholder=\"model.name ?? 'Dataset Name'\" minlength=\"3\" @keydown=\"handleKeydown\"/>\n        </div>\n\n        <div class=\"ude__label_input\" v-if=\"!props.nameOnly\">\n          <label for=\"ude-color\"> Edit Color:</label>\n          <input id=\"ude-color\" type=\"color\" v-model=\"color\" @keydown=\"handleKeydown\"/>\n          <v-btn class=\"use_reset-color\" variant=\"outlined\" :color=\"model.region.color\"  size=\"small\" @click=\"color = model.region.color\">\n            <template #default>\n            Reset\n              <div \n                class=\"ude_color-swatch\" \n                :style=\"{backgroundColor: model.region.color}\"\n                > \n              </div>\n              </template>\n          </v-btn>\n        </div>\n      </div>\n      \n    </v-card-text>\n    \n    <div class=\"ude__button-container\">\n      <v-btn variant=\"flat\" size=\"small\" @click=\"cancel\">Cancel</v-btn>\n      <v-btn :color=\"accentColor2\" size=\"small\" @click=\"save\" :disabled=\"!changed\">Save</v-btn>\n    </div>\n\n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onUnmounted  } from 'vue';\nimport { useTempoStore } from \"../stores/app\";\nconst accentColor2 = useTempoStore().accentColor2;\n\nimport { UserDataset } from '@/types';\n\ntype Props = {\n  nameOnly?: boolean;\n  colorOnly?: boolean;\n};\n\nconst props = withDefaults(defineProps<Props>(),{\n  nameOnly: false,\n  colorOnly: false,\n});\n\nconst model = defineModel({\n  type: Object as () => UserDataset,\n  required: true,\n});\n\nconst emit = defineEmits<{\n  (e: 'complete'): void;\n}>();\n\nconst name = ref(model.value.name || '');\nconst color = ref(model.value.customColor || model.value.region.color || 'white');\nconst changed = ref(false);\n\nwatch(name, () => {\n  changed.value = true;\n});\nwatch(color, () => {\n  changed.value = true;\n});\n\nfunction save() {\n  if (model.value) {\n    model.value.name = name.value;\n    if (model.value.plotlyDatasets) {\n      model.value.plotlyDatasets[1].name = name.value;\n    }\n    model.value.customColor = color.value;\n  }\n  emit('complete');\n}\n\nfunction cancel() {\n  emit('complete');\n}\n\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Enter' && changed.value) {\n    save();\n  } else if (event.key === 'Escape') {\n    cancel();\n  }\n}\n\nwindow.addEventListener('keydown', globalKeydownHandler);\n\nfunction globalKeydownHandler(event: KeyboardEvent) {\n  const skipTags = ['INPUT', 'TEXTAREA', 'BUTTON', 'SELECT'];\n  if (\n    event.target && \n    skipTags.includes((event.target as HTMLElement).tagName)) {\n    return; \n  }\n  handleKeydown(event);\n}\nonUnmounted(() => {\n  window.removeEventListener('keydown', globalKeydownHandler);\n});\n\n</script>\n\n<style lang=\"less\" scoped>\ndiv.user-dataset-editor {\n  display: flex;\n  flex-direction: column;\n  gap: 1em;\n  margin-block: 1em;\n}\n\n.ude__label_input {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: 5px;\n}\n\nlabel {\n  font-size: 0.9em;\n  font-weight: bold;\n  width: 10ch; // bad: hack to get inputs aligned\n}\n\n.ude__button-container {\n  display: flex;\n  justify-content: flex-end;\n  padding: 0.5rem 1rem;\n  padding-bottom: 1rem;\n  gap: 1rem;\n}\n\n\n\ninput {\n  background-color: rgb(var(--v-theme-surface));\n  border: 1px solid rgb(var(--v-theme-on-surface));\n  border-radius: 5px;\n  color: rgb(var(--v-theme-on-surface));\n  padding-inline: 0.5rem;\n  font-size: 0.9em;\n}\n\n.ude_color-swatch {\n  display: inline-block;\n  width: 1em;\n  height: 1em;\n  border: 1px solid rgb(var(--v-theme-on-surface));\n  margin-left: 0.5em;\n  vertical-align: middle;\n}\n\n.use_reset-color {\n  text-transform: none;\n}\n</style>","import script from \"./UserDatasetEditor.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./UserDatasetEditor.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./UserDatasetEditor.vue?vue&type=style&index=0&id=7610d958&lang=less&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7610d958\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, isRef as _isRef, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, vShow as _vShow, mergeProps as _mergeProps } from \"vue\"\n\nconst _hoisted_1 = { id: \"add-region-time\" }\nconst _hoisted_2 = { id: \"add-region-buttons\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"my-selections\",\n  style: {\"margin-top\":\"1em\"}\n}\nconst _hoisted_4 = { class: \"datset-controls-action-buttons region-action-buttons\" }\nconst _hoisted_5 = {\n  key: 0,\n  class: \"my-selections\",\n  style: {\"margin-top\":\"1em\"}\n}\nconst _hoisted_6 = { class: \"datset-controls-action-buttons time-range-action-buttons\" }\nconst _hoisted_7 = {\n  key: 0,\n  class: \"my-selections\",\n  style: {\"margin-top\":\"1em\"}\n}\nconst _hoisted_8 = {\n  key: 0,\n  class: \"dataset-loading\"\n}\nconst _hoisted_9 = { class: \"text-subtitle-2\" }\nconst _hoisted_10 = { key: 0 }\nconst _hoisted_11 = { class: \"selection-icons\" }\nconst _hoisted_12 = {\n  key: 1,\n  class: \"dataset-select-all-none\"\n}\nconst _hoisted_13 = { class: \"d-flex flex-column align-items-center justify-space-between ga-2\" }\nconst _hoisted_14 = { class: \"d-flex flex-wrap flex-row align-center justify-center ga-1\" }\n\nimport { computed, ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from \"uuid\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport type { MillisecondRange, TimeRange, UserDataset, UnifiedRegion, MoleculeType } from \"../types\";\nimport type { TimeRangeConfig } from \"@/date_time_range_selection/date_time_range_generators\";\nimport { serializeTempoStore, useTempoStore } from \"../stores/app\";\nimport { MOLECULE_OPTIONS, moleculeDescriptor } from \"../esri/utils\";\nimport { areEquivalentTimeRanges, formatTimeRange } from \"../utils/timeRange\";\nimport { atleast1d } from \"../utils/atleast1d\";\nimport { titleBarPredicate } from \"../utils/draggable\";\n\nimport DateTimeRangeSelection from \"../date_time_range_selection/DateTimeRangeSelection.vue\";\nimport AdvancedOperations from \"./AdvancedOperations.vue\";\nimport { TimeRangeSelectionType } from \"@/types/datetime\";\n// import PlotlyGraph from \"./plotly/PlotlyGraph.vue\";\n// import FoldedPlotlyGraph from \"./FoldedPlotlyGraph.vue\";\nimport CTextField from \"./CTextField.vue\";\nimport DatasetCard from \"./DatasetCard.vue\";\nimport { toZonedTime } from \"date-fns-tz\";\n// import { userDatasetToPlotly } from \"@/utils/data_converters\";\nimport UserDatasetTable from \"./UserDatasetTable.vue\";\nimport TimeRangeCard from \"@/date_time_range_selection/TimeRangeCard.vue\";\nimport MultiPlot from \"./plotly/MultiMoleculePlot.vue\";\nimport UserDatasetPlot from \"./plotly/UserDatasetPlot.vue\";\n\nimport { RequestStats, FetchOptions } from \"@/esri/services/TempoDataService\";\nimport UserDatasetEditor from \"./UserDatasetEditor.vue\";\ntype UnifiedRegionType = UnifiedRegion;\n\nconst popupCardWidth = 300;\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DatasetControls',\n  setup(__props) {\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  backend,\n  regions,\n  datasets,\n  timeRanges,\n  singleDateSelected,\n  uniqueDays,\n  selectionActive,\n  focusRegion,\n  showSamplingPreviewMarkers,\n  regionOpacity,\n  regionVisibility,\n  tempoRed,\n} = storeToRefs(store);\n\nconst cssVars = computed(() => {\n  return {\n    '--accent-color': accentColor.value,\n    '--accent-color-2': accentColor2.value,\n  };\n});\n\nconst touchscreen = supportsTouchscreen();\n\nconst openPanels = ref<number[]>([0, 1, 2]);\nconst openGraphs = ref<Record<string,boolean>>({});\nconst openSelection = ref<string | null>(null);\nconst tableSelection = ref<UserDataset | null>(null);\nconst currentlyEditingDataset = ref<UserDataset | null>(null);\nconst showConfirmReset = ref(false);\nconst showMultiPlot = ref(false);\n\nconst createTimeRangeActive = ref(false);\nconst createDatasetActive = ref(false);\nconst datasetRowRefs = ref({});\nconst sampleErrorID = ref<string | null>(null);\n\nconst showEditRegionNameDialog = ref(false);\nconst regionBeingEdited = ref<UnifiedRegionType | null>(null);\n\nconst showEditTimeRangeNameDialog = ref(false);\nconst timeRangeBeingEdited = ref<TimeRange | null>(null);\n\nconst aggregationDataset = ref<UserDataset | null>(null);\nconst showAggregationDialog = ref(false);\nfunction openAggregationDialog(selection: UserDataset) {\n  aggregationDataset.value = selection;\n  showAggregationDialog.value = true;\n}\nfunction handleAggregationSaved(aggregatedSelection: UserDataset) {\n  const n = datasets.value.map(d => d.name).filter(n => n?.startsWith(aggregatedSelection.name + ' ' || 'animpossiblename')).length;\n  aggregatedSelection.name = `${aggregatedSelection.name} ${String.fromCharCode(97 + n)}`; // a, b, c, ...\n  store.addDataset(aggregatedSelection, false); // no need to fetch anything\n  showAggregationDialog.value = false;\n  aggregationDataset.value = null;\n}\n\nfunction handleDatasetCreated(dataset: UserDataset) {\n  dataset.name = `Dataset ${datasets.value.length + 1}`; // give it a default name\n  const onProgress: FetchOptions[\"onProgress\"] = (_stats: RequestStats, completed: number, total: number) => {\n    console.log(`Dataset ${dataset.name} loading progress: ${completed}/${total} requests completed.`, _stats);\n  };\n  store.addDataset(dataset, true, onProgress);\n  createDatasetActive.value = false;\n}\n\nconst showDatasetEditor = ref(false);\nconst datasetEditorNameOnly = ref(false);\nfunction handleEditDataset(dataset: UserDataset, nameOnly = false) {\n  datasetEditorNameOnly.value = nameOnly;\n  currentlyEditingDataset.value = dataset;\n  showDatasetEditor.value = true;\n}\n\nfunction removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\nfunction handleDateTimeRangeSelectionChange(\n  timeRanges: MillisecondRange[], \n  selectionType: TimeRangeSelectionType, \n  customName: string, \n  config: TimeRangeConfig,\n) {\n  if (!Array.isArray(timeRanges) || timeRanges.length === 0) {\n    console.error('No time ranges received from DateTimeRangeSelection');\n    return;\n  }\n  console.log(`Received ${timeRanges.length} time ranges of type ${selectionType} and name ${customName}`);\n  const normalized = atleast1d(timeRanges);\n  const countTimeRanges = store.timeRanges.length;\n  // No dedup tracking now\n  const tr: TimeRange = {\n    id: v4(),\n    name: `Time Range ${countTimeRanges + 1}`,\n    description: customName,\n    range: normalized.length === 1 ? normalized[0] : normalized,\n    type: selectionType,\n    config: config,\n  };\n  store.addTimeRange(tr);\n\n  createTimeRangeActive.value = false;\n  console.log(`Registered ${tr.name}: ${tr.description}`);\n}\n\nfunction editRegionName(region: UnifiedRegionType) {\n  console.log(`Editing ${region.geometryType}: ${region.name}`);\n  // Set the region to edit\n\n  // eslint-disable-next-line\n  // @ts-ignore it is not actually deep\n  const existing = (regions.value as UnifiedRegionType[]).find(r => r.id === region.id);\n  if (!existing) {\n    console.error(`Region with ID ${region.id} not found.`);\n    return;\n  }\n  regionBeingEdited.value = region;\n  // Open dialog for renaming\n  showEditRegionNameDialog.value = true;\n}\n\nfunction editTimeRangeName(timeRange: TimeRange) {\n  console.log(`Editing time range: ${timeRange.name}`);\n  \n  const existing = timeRanges.value.find(tr => tr.id === timeRange.id);\n  if (!existing) {\n    console.error(`Time range with ID ${timeRange.id} not found.`);\n    return;\n  }\n  timeRangeBeingEdited.value = timeRange;\n  // Open dialog for renaming\n  showEditTimeRangeNameDialog.value = true;\n}\n\nfunction _graphTitle(dataset: UserDataset): string {\n  const molecule = dataset.molecule;\n  const molTitle = MOLECULE_OPTIONS.find(m => m.value === molecule)?.title || '';\n  return dataset.name ?? `${molTitle} Time Series for ${dataset.region.name}`;\n}\n\n\n\n\nfunction _toZonedTime(date: number | Date | string, timezone): number | Date {\n  if (typeof date === 'number') {\n    date = new Date(date);\n  } else if (typeof date === 'string') {\n    date = new Date(date);\n  }\n  return toZonedTime(date, timezone);\n}\n\nconst allDatasetSelection = ref(false);\nconst selectedDatasets = ref<string[]>([]);\nwatch(allDatasetSelection, (newVal) => {\n  if (!newVal) {\n    selectedDatasets.value = [];\n  }\n});\nwatch(selectedDatasets, (newVal) => {\n  console.log('Selected datasets changed:', newVal);\n});\n\n\n\n\nconst showErrorBands = ref(true);\n\nconst showUserDatasetTable = ref(false);\nwatch(tableSelection, (newVal) => {\n  if (newVal) {\n    console.log('Table selection changed:', newVal);\n    showUserDatasetTable.value = true;\n  }\n});\n\n\n/** handle plot click should set the time and molecule and zoom into the region */\nfunction handlePlotClick(value: {x: number | string | Date | null, y: number, customdata: unknown, molecule: MoleculeType, region: UnifiedRegion}): void {\n  if (value.x === null) return;\n  console.log('Plot clicked at:', value);\n  // store.setNearestTime(new Date(value.x));\n  focusRegion.value = value.region;\n  \n}\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_actions = _resolveComponent(\"v-card-actions\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_dialog = _resolveComponent(\"v-dialog\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_popup_info_button = _resolveComponent(\"popup-info-button\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_slider = _resolveComponent(\"v-slider\")!\n  const _component_v_list_item = _resolveComponent(\"v-list-item\")!\n  const _component_v_list = _resolveComponent(\"v-list\")!\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\")!\n  const _component_v_hover = _resolveComponent(\"v-hover\")!\n  const _component_v_divider = _resolveComponent(\"v-divider\")!\n  const _component_selection_composer = _resolveComponent(\"selection-composer\")!\n  const _component_v_progress_linear = _resolveComponent(\"v-progress-linear\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_expand_transition = _resolveComponent(\"v-expand-transition\")!\n  const _component_cds_dialog = _resolveComponent(\"cds-dialog\")!\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\")!\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_local_scope = _resolveComponent(\"local-scope\")!\n  const _directive_tooltip = _resolveDirective(\"tooltip\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: \"dataset-sections\",\n    style: _normalizeStyle(cssVars.value)\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _cache[40] || (_cache[40] = _createElementVNode(\"p\", null, \" Select a Region, Time Range, and Molecule to create a dataset of your choice! \", -1)),\n      _createVNode(_component_v_dialog, {\n        modelValue: showConfirmReset.value,\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((showConfirmReset).value = $event)),\n        \"max-width\": \"35%\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_card, { class: \"popup-card--outline\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_card_text, null, {\n                default: _withCtx(() => [...(_cache[31] || (_cache[31] = [\n                  _createTextVNode(\" Are you sure you want to delete all of your selections? This will remove all of your regions, time ranges, and datasets, and cannot be undone. \", -1)\n                ]))]),\n                _: 1\n              }),\n              _createVNode(_component_v_card_actions, null, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_btn, {\n                    color: \"error\",\n                    onClick: _cache[0] || (_cache[0] = ($event: any) => (showConfirmReset.value = false))\n                  }, {\n                    default: _withCtx(() => [...(_cache[32] || (_cache[32] = [\n                      _createTextVNode(\" No \", -1)\n                    ]))]),\n                    _: 1\n                  }),\n                  _createVNode(_component_v_btn, {\n                    color: \"success\",\n                    onClick: _cache[1] || (_cache[1] = () => {\n              _unref(store).reset();\n              _unref(serializeTempoStore)(_unref(store));\n              showConfirmReset.value = false;\n            })\n                  }, {\n                    default: _withCtx(() => [...(_cache[33] || (_cache[33] = [\n                      _createTextVNode(\" Yes \", -1)\n                    ]))]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"]),\n      _createVNode(_component_v_expansion_panels, {\n        modelValue: openPanels.value,\n        \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event: any) => ((openPanels).value = $event)),\n        variant: \"accordion\",\n        id: \"user-options-panels\",\n        multiple: \"\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_expansion_panel, {\n            title: \"Regions\",\n            class: \"mt-3 h3-panel-titles\"\n          }, {\n            text: _withCtx(() => [\n              _createElementVNode(\"div\", _hoisted_2, [\n                _createVNode(_component_v_btn, {\n                  size: \"small\",\n                  active: _unref(selectionActive) === 'rectangle',\n                  disabled: _unref(selectionActive) === 'point',\n                  color: _unref(accentColor2),\n                  onClick: _cache[3] || (_cache[3] = () => {\n                  selectionActive.value = (_unref(selectionActive) === 'rectangle') ? null : 'rectangle';\n                })\n                }, {\n                  prepend: _withCtx(() => [\n                    (_unref(selectionActive) !== 'rectangle')\n                      ? (_openBlock(), _createBlock(_component_v_icon, {\n                          key: 0,\n                          icon: \"mdi-plus\"\n                        }))\n                      : _createCommentVNode(\"\", true)\n                  ]),\n                  default: _withCtx(() => [\n                    _createTextVNode(\" \" + _toDisplayString(_unref(selectionActive) === 'rectangle' ? \"Cancel\" : \"New Region\"), 1)\n                  ]),\n                  _: 1\n                }, 8, [\"active\", \"disabled\", \"color\"]),\n                _createVNode(_component_popup_info_button, {\n                  \"info-text\": \"To select a region, click and drag a rectangle across the map. When a large region is selected, we sample an evenly-spaced subset of approximately 30 pixels to shorten the data loading time. For each available time step, all the sampled data across the region will be averaged together.\",\n                  width: popupCardWidth\n                })\n              ]),\n              _createVNode(_component_v_checkbox, {\n                modelValue: _unref(showSamplingPreviewMarkers),\n                \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => (_isRef(showSamplingPreviewMarkers) ? (showSamplingPreviewMarkers).value = $event : null)),\n                class: \"show-sample-points-toggle\",\n                label: \"Show sample points\",\n                density: \"compact\",\n                \"hide-details\": \"\"\n              }, {\n                append: _withCtx(() => [\n                  _createVNode(_component_popup_info_button, {\n                    \"info-text\": \"Checking this box will display the pixels of your selected region where data will be requested from the server.\",\n                    width: popupCardWidth\n                  })\n                ]),\n                _: 1\n              }, 8, [\"modelValue\"]),\n              (_unref(regions).length>0)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                    _createElementVNode(\"h4\", null, [\n                      _cache[34] || (_cache[34] = _createTextVNode(\" My Regions \", -1)),\n                      _createVNode(_component_popup_info_button, {\n                        \"info-text\": \"Click the region card to go to that region on the map. Click the pen to rename a region. Click the trash can to delete a region. If an existing dataset is using a region, it cannot be deleted.\",\n                        width: popupCardWidth\n                      })\n                    ]),\n                    _createVNode(_component_v_slider, {\n                      modelValue: _unref(regionOpacity),\n                      \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => (_isRef(regionOpacity) ? (regionOpacity).value = $event : null)),\n                      min: 0,\n                      max: 1,\n                      step: 0.01,\n                      label: \"Region Opacity\",\n                      color: _unref(tempoRed),\n                      density: \"compact\",\n                      \"hide-details\": \"\",\n                      \"thumb-size\": 12,\n                      \"track-size\": 3\n                    }, null, 8, [\"modelValue\", \"color\"]),\n                    _createVNode(_component_v_checkbox, {\n                      modelValue: _unref(regionVisibility),\n                      \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => (_isRef(regionVisibility) ? (regionVisibility).value = $event : null)),\n                      label: \"Show regions\",\n                      density: \"compact\",\n                      \"hide-details\": \"\"\n                    }, null, 8, [\"modelValue\"]),\n                    _createVNode(_component_v_list, null, {\n                      default: _withCtx(() => [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(regions), (region, index) => {\n                          return (_openBlock(), _createBlock(_component_v_list_item, {\n                            class: _normalizeClass(` my-2 rounded-lg region-list-item region-list-item-${index}`),\n                            key: index,\n                            title: region.name,\n                            style: _normalizeStyle({ 'background-color': region.color }),\n                            onClick: () => focusRegion.value = region,\n                            density: \"compact\",\n                            slim: \"\"\n                          }, {\n                            append: _withCtx(() => [\n                              _createElementVNode(\"div\", _hoisted_4, [\n                                _withDirectives(_createVNode(_component_v_btn, {\n                                  variant: \"plain\",\n                                  icon: \"mdi-pencil\",\n                                  color: \"white\",\n                                  size: \"small\",\n                                  density: \"compact\",\n                                  onClick: (event) => {\n                        editRegionName(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\n                                }, null, 8, [\"onClick\"]), [\n                                  [_directive_tooltip, 'Edit Name']\n                                ]),\n                                (!_unref(store).regionHasDatasets(region as UnifiedRegionType))\n                                  ? _withDirectives((_openBlock(), _createBlock(_component_v_btn, {\n                                      key: 0,\n                                      variant: \"plain\",\n                                      icon: \"mdi-delete\",\n                                      color: \"white\",\n                                      size: \"small\",\n                                      density: \"compact\",\n                                      onClick: (event) => {\n                        _unref(store).deleteRegion(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\n                                    }, null, 8, [\"onClick\"])), [\n                                      [_directive_tooltip, 'Delete']\n                                    ])\n                                  : _createCommentVNode(\"\", true)\n                              ])\n                            ]),\n                            _: 2\n                          }, 1032, [\"class\", \"title\", \"style\", \"onClick\"]))\n                        }), 128))\n                      ]),\n                      _: 1\n                    })\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_expansion_panel, {\n            title: \"Time Ranges\",\n            class: \"mt-3 h3-panel-titles\"\n          }, {\n            text: _withCtx(() => [\n              _createVNode(_component_v_btn, {\n                size: \"small\",\n                active: createTimeRangeActive.value,\n                color: _unref(accentColor2),\n                onClick: _cache[7] || (_cache[7] = ($event: any) => (createTimeRangeActive.value = !createTimeRangeActive.value))\n              }, {\n                prepend: _withCtx(() => [\n                  (!createTimeRangeActive.value)\n                    ? (_openBlock(), _createBlock(_component_v_icon, {\n                        key: 0,\n                        icon: \"mdi-plus\"\n                      }))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                default: _withCtx(() => [\n                  _createTextVNode(\" \" + _toDisplayString(createTimeRangeActive.value ? \"Cancel\" : \"New Time Range\"), 1)\n                ]),\n                _: 1\n              }, 8, [\"active\", \"color\"]),\n              _withDirectives(_createVNode(DateTimeRangeSelection, {\n                \"current-date\": _unref(singleDateSelected),\n                \"allowed-dates\": _unref(uniqueDays),\n                onRangesChange: handleDateTimeRangeSelectionChange\n              }, null, 8, [\"current-date\", \"allowed-dates\"]), [\n                [_vShow, createTimeRangeActive.value]\n              ]),\n              (_unref(timeRanges).length>0)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                    _createVNode(_component_v_list, null, {\n                      default: _withCtx(() => [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(timeRanges), (timeRange, index) => {\n                          return (_openBlock(), _createBlock(_component_v_hover, {\n                            key: index,\n                            \"close-delay\": \"50\",\n                            \"open-delay\": \"250\"\n                          }, {\n                            default: _withCtx(({ isHovering, props }) => [\n                              _createVNode(_component_v_list_item, _mergeProps({ class: \"my-2 rounded-lg time-range-v-list-item\" }, { ref_for: true }, props, {\n                                density: \"compact\",\n                                slim: \"\",\n                                title: timeRange.name === 'Displayed Day' ? `Displayed Day: ${ _unref(formatTimeRange)(timeRange.range) }` : (timeRange.name ?? _unref(formatTimeRange)(timeRange.range))\n                              }), {\n                                default: _withCtx(() => [\n                                  _createVNode(TimeRangeCard, {\n                                    name: timeRange.name === 'Displayed Day' ? `Displayed Day: ${ _unref(formatTimeRange)(timeRange.range) }` : (timeRange.name ?? _unref(formatTimeRange)(timeRange.range)),\n                                    \"time-range\": timeRange,\n                                    \"is-hovering\": isHovering ?? false\n                                  }, null, 8, [\"name\", \"time-range\", \"is-hovering\"])\n                                ]),\n                                append: _withCtx(() => [\n                                  _createElementVNode(\"div\", _hoisted_6, [\n                                    (timeRange.id !== 'displayed-day')\n                                      ? _withDirectives((_openBlock(), _createBlock(_component_v_btn, {\n                                          key: 0,\n                                          variant: \"plain\",\n                                          size: \"small\",\n                                          density: \"compact\",\n                                          icon: \"mdi-pencil\",\n                                          color: \"white\",\n                                          onClick: (event) => {\n                        editTimeRangeName(timeRange);\n                        event.stopPropagation();\n                      }\n                                        }, null, 8, [\"onClick\"])), [\n                                          [_directive_tooltip, 'Edit Name']\n                                        ])\n                                      : _createCommentVNode(\"\", true),\n                                    (timeRange.id !== 'displayed-day' && !_unref(datasets).some(s => _unref(areEquivalentTimeRanges)(s.timeRange, timeRange)))\n                                      ? _withDirectives((_openBlock(), _createBlock(_component_v_btn, {\n                                          key: 1,\n                                          variant: \"plain\",\n                                          size: \"small\",\n                                          density: \"compact\",\n                                          icon: \"mdi-delete\",\n                                          color: \"white\",\n                                          onClick: () => _unref(store).deleteTimeRange(timeRange)\n                                        }, null, 8, [\"onClick\"])), [\n                                          [_directive_tooltip, 'Delete']\n                                        ])\n                                      : _createCommentVNode(\"\", true)\n                                  ])\n                                ]),\n                                _: 2\n                              }, 1040, [\"title\"])\n                            ]),\n                            _: 2\n                          }, 1024))\n                        }), 128))\n                      ]),\n                      _: 1\n                    })\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_v_divider, {\n            class: \"mt-3\",\n            opacity: \"1\"\n          }),\n          _createVNode(_component_v_expansion_panel, {\n            title: \"Datasets\",\n            class: \"mt-3 h3-panel-titles\"\n          }, {\n            text: _withCtx(() => [\n              _createVNode(_component_v_btn, {\n                size: \"small\",\n                active: createDatasetActive.value,\n                color: _unref(accentColor2),\n                onClick: _cache[8] || (_cache[8] = ($event: any) => (createDatasetActive.value = !createDatasetActive.value)),\n                class: \"mt-3\"\n              }, {\n                prepend: _withCtx(() => [\n                  (!createDatasetActive.value)\n                    ? (_openBlock(), _createBlock(_component_v_icon, {\n                        key: 0,\n                        icon: \"mdi-plus\"\n                      }))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                default: _withCtx(() => [\n                  _createTextVNode(\" \" + _toDisplayString(createDatasetActive.value ? \"Cancel\" : \"New Dataset\"), 1)\n                ]),\n                _: 1\n              }, 8, [\"active\", \"color\"]),\n              _withDirectives(_createVNode(_component_selection_composer, {\n                backend: _unref(backend),\n                \"time-ranges\": _unref(timeRanges),\n                regions: _unref(regions),\n                disabled: { region: _unref(regions).length === 0, point: _unref(selectionActive) === 'point', timeRange: _unref(timeRanges).length === 0 },\n                onCreate: handleDatasetCreated\n              }, null, 8, [\"backend\", \"time-ranges\", \"regions\", \"disabled\"]), [\n                [_vShow, createDatasetActive.value]\n              ]),\n              (_unref(datasets).length>0)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                    _createVNode(DatasetCard, {\n                      datasets: _unref(datasets),\n                      \"turn-on-selection\": allDatasetSelection.value,\n                      \"selected-datasets\": selectedDatasets.value,\n                      \"onUpdate:selectedDatasets\": _cache[9] || (_cache[9] = ($event: any) => ((selectedDatasets).value = $event)),\n                      onEditRegion: _cache[10] || (_cache[10] = (e) => handleEditDataset(e))\n                    }, {\n                      \"action-row\": _withCtx(({ dataset }) => [\n                        ((dataset.loading || !dataset.samples)  && !(dataset.timeRange?.type === 'folded' && dataset.plotlyDatasets))\n                          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                              _cache[36] || (_cache[36] = _createElementVNode(\"hr\", null, null, -1)),\n                              _createVNode(_component_v_progress_linear, {\n                                class: _normalizeClass(['dataset-loading-progress', !(dataset.loading && dataset.samples) ? 'dataset-loading-failed' : '']),\n                                active: dataset.loading || !dataset.samples,\n                                color: dataset.loading ? 'primary' : 'red',\n                                indeterminate: dataset.loading,\n                                value: !dataset.loading ? 100 : 0,\n                                striped: !dataset.loading,\n                                bottom: \"\",\n                                rounded: \"\",\n                                height: \"20\"\n                              }, {\n                                default: _withCtx(() => [\n                                  _createElementVNode(\"span\", _hoisted_9, _toDisplayString(dataset.loading ? 'Data Loading' : (!dataset.samples ? 'Error Loading Data' : '')), 1)\n                                ]),\n                                _: 2\n                              }, 1032, [\"class\", \"active\", \"color\", \"indeterminate\", \"value\", \"striped\"]),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Remove selection\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-trash-can\",\n                                    variant: \"plain\",\n                                    onClick: () => removeDataset(dataset)\n                                  }), null, 16, [\"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              (!(dataset.loading || dataset.samples || dataset.plotlyDatasets))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                                    _cache[35] || (_cache[35] = _createElementVNode(\"hr\", null, null, -1)),\n                                    _createVNode(_component_v_tooltip, {\n                                      text: \"Failure info\",\n                                      location: \"top\"\n                                    }, {\n                                      activator: _withCtx(({ props }) => [\n                                        _createVNode(_component_v_btn, _mergeProps(props, {\n                                          size: \"x-small\",\n                                          icon: \"mdi-help-circle\",\n                                          variant: \"plain\",\n                                          onClick: () => sampleErrorID.value = dataset.id\n                                        }), null, 16, [\"onClick\"])\n                                      ]),\n                                      _: 2\n                                    }, 1024),\n                                    _createVNode(_component_v_tooltip, {\n                                      text: \"Remove selection\",\n                                      location: \"top\"\n                                    }, {\n                                      activator: _withCtx(({ props }) => [\n                                        _createVNode(_component_v_btn, _mergeProps(props, {\n                                          size: \"x-small\",\n                                          icon: \"mdi-trash-can\",\n                                          variant: \"plain\",\n                                          onClick: () => removeDataset(dataset)\n                                        }), null, 16, [\"onClick\"])\n                                      ]),\n                                      _: 2\n                                    }, 1024)\n                                  ]))\n                                : _createCommentVNode(\"\", true)\n                            ]))\n                          : _createCommentVNode(\"\", true),\n                        _createVNode(_component_v_expand_transition, null, {\n                          default: _withCtx(() => [\n                            _withDirectives(_createElementVNode(\"div\", _hoisted_11, [\n                              (dataset.timeRange.type === 'single' || dataset.folded)\n                                ? (_openBlock(), _createBlock(_component_v_tooltip, {\n                                    key: 0,\n                                    text: \"Show graph\",\n                                    location: \"top\"\n                                  }, {\n                                    activator: _withCtx(({ props }) => [\n                                      _createVNode(_component_v_btn, _mergeProps(props, {\n                                        size: \"x-small\",\n                                        icon: \"mdi-chart-line\",\n                                        disabled: !(dataset.samples || dataset.plotlyDatasets),\n                                        variant: \"plain\",\n                                        onClick: () => openGraphs.value[dataset.id] = true\n                                      }), null, 16, [\"disabled\", \"onClick\"])\n                                    ]),\n                                    _: 2\n                                  }, 1024))\n                                : (_openBlock(), _createBlock(_component_v_tooltip, {\n                                    key: 1,\n                                    text: \"Graph Data\",\n                                    location: \"top\"\n                                  }, {\n                                    activator: _withCtx(({ props }) => [\n                                      _createVNode(_component_v_btn, _mergeProps(props, {\n                                        size: \"x-small\",\n                                        icon: \"mdi-chart-line\",\n                                        disabled: !dataset.samples,\n                                        variant: \"plain\",\n                                        onClick: () => openAggregationDialog(dataset)\n                                      }), null, 16, [\"disabled\", \"onClick\"])\n                                    ]),\n                                    _: 2\n                                  }, 1024)),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Show table\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-table\",\n                                    disabled: !dataset.samples && !dataset.folded,\n                                    variant: \"plain\",\n                                    onClick: () => tableSelection.value = dataset\n                                  }), null, 16, [\"disabled\", \"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Edit Dataset Name/Color\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-pencil\",\n                                    variant: \"plain\",\n                                    onClick: () => handleEditDataset(dataset)\n                                  }), null, 16, [\"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024),\n                              _createVNode(_component_v_spacer),\n                              _createVNode(_component_v_tooltip, {\n                                text: \"Remove selection\",\n                                location: \"top\"\n                              }, {\n                                activator: _withCtx(({ props }) => [\n                                  _createVNode(_component_v_btn, _mergeProps(props, {\n                                    size: \"x-small\",\n                                    icon: \"mdi-trash-can\",\n                                    variant: \"plain\",\n                                    onClick: () => removeDataset(dataset)\n                                  }), null, 16, [\"onClick\"])\n                                ]),\n                                _: 2\n                              }, 1024)\n                            ], 512), [\n                              [_vShow, (dataset.samples || dataset.plotlyDatasets) && (_unref(touchscreen) ? openSelection.value == dataset.id : true)]\n                            ])\n                          ]),\n                          _: 2\n                        }, 1024),\n                        _createVNode(_component_cds_dialog, {\n                          title: `${_unref(moleculeDescriptor)(dataset.molecule).shortName.text} Quantity vs. Time`,\n                          modelValue: openGraphs.value[dataset.id],\n                          \"onUpdate:modelValue\": ($event: any) => ((openGraphs.value[dataset.id]) = $event),\n                          \"title-color\": \"var(--info-background)\",\n                          draggable: \"\",\n                          persistent: \"\",\n                          scrim: false,\n                          modal: false,\n                          \"max-height\": \"fit-content\",\n                          height: \"fit-content\",\n                          \"drag-predicate\": _unref(titleBarPredicate)\n                        }, {\n                          default: _withCtx(() => [\n                            ((dataset.timeRange.type === 'folded' && dataset.plotlyDatasets) || (dataset.timeRange.type === 'single'))\n                              ? (_openBlock(), _createBlock(UserDatasetPlot, {\n                                  key: 0,\n                                  dataset: dataset,\n                                  \"show-errors\": showErrorBands.value,\n                                  colors: [dataset.customColor ?? dataset.region.color, '#333'],\n                                  \"data-options\": [{mode: 'markers'}, {mode: 'markers'}],\n                                  names: [`Original Data`, `Binned`],\n                                  \"layout-options\": {\n                            width: 600, \n                            height: 400,\n                            autosize: false,\n                            ...(dataset.folded ? {} : { xaxis: {title: {text: 'Local Time for Region'}}}),\n                          },\n                                  \"fold-type\": dataset.folded?.foldType,\n                                  timezones: dataset.folded?.timezone,\n                                  \"config-options\": {responsive: false},\n                                  onPlotClick: (value) => handlePlotClick({...value, molecule: dataset.molecule, region: dataset.region})\n                                }, null, 8, [\"dataset\", \"show-errors\", \"colors\", \"layout-options\", \"fold-type\", \"timezones\", \"onPlotClick\"]))\n                              : _createCommentVNode(\"\", true)\n                          ]),\n                          _: 2\n                        }, 1032, [\"title\", \"modelValue\", \"onUpdate:modelValue\", \"drag-predicate\"])\n                      ]),\n                      _: 1\n                    }, 8, [\"datasets\", \"turn-on-selection\", \"selected-datasets\"])\n                  ]))\n                : _createCommentVNode(\"\", true),\n              (allDatasetSelection.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                    _createVNode(_component_v_btn, {\n                      variant: \"outlined\",\n                      size: \"small\",\n                      onClick: _cache[11] || (_cache[11] = ($event: any) => (selectedDatasets.value = _unref(datasets).map(d => d.id)))\n                    }, {\n                      prepend: _withCtx(() => [\n                        _createVNode(_component_v_icon, {\n                          icon: \"mdi-check-circle\",\n                          color: \"success\"\n                        })\n                      ]),\n                      default: _withCtx(() => [\n                        _cache[37] || (_cache[37] = _createTextVNode(\" All \", -1))\n                      ]),\n                      _: 1\n                    }),\n                    _createVNode(_component_v_btn, {\n                      variant: \"outlined\",\n                      size: \"small\",\n                      class: \"ml-2\",\n                      onClick: _cache[12] || (_cache[12] = ($event: any) => (selectedDatasets.value = []))\n                    }, {\n                      prepend: _withCtx(() => [\n                        _createVNode(_component_v_icon, {\n                          icon: \"mdi-close-circle\",\n                          color: \"error\"\n                        })\n                      ]),\n                      default: _withCtx(() => [\n                        _cache[38] || (_cache[38] = _createTextVNode(\" Clear \", -1))\n                      ]),\n                      _: 1\n                    })\n                  ]))\n                : _createCommentVNode(\"\", true),\n              _createElementVNode(\"div\", _hoisted_13, [\n                (_unref(datasets).length > 1)\n                  ? (_openBlock(), _createBlock(_component_v_btn, {\n                      key: 0,\n                      disabled: _unref(datasets).length === 0 || !_unref(datasets).every(d => d.samples || d.plotlyDatasets),\n                      color: \"#ffcc33\",\n                      size: \"small\",\n                      block: false,\n                      onClick: _cache[13] || (_cache[13] = ($event: any) => (allDatasetSelection.value = !allDatasetSelection.value))\n                    }, {\n                      default: _withCtx(() => [\n                        _createTextVNode(_toDisplayString(allDatasetSelection.value ? 'Cancel Selection' : 'Select Datasets to Graph'), 1)\n                      ]),\n                      _: 1\n                    }, 8, [\"disabled\"]))\n                  : _createCommentVNode(\"\", true),\n                (_unref(datasets).length > 1)\n                  ? (_openBlock(), _createBlock(_component_v_btn, {\n                      key: 1,\n                      color: _unref(accentColor2),\n                      disabled: selectedDatasets.value.length == 0,\n                      variant: selectedDatasets.value.length > 0 ? 'flat' : 'outlined',\n                      onClick: _cache[14] || (_cache[14] = ($event: any) => (showMultiPlot.value = true))\n                    }, {\n                      default: _withCtx(() => [...(_cache[39] || (_cache[39] = [\n                        _createTextVNode(\" Graph Selected Datasets \", -1)\n                      ]))]),\n                      _: 1\n                    }, 8, [\"color\", \"disabled\", \"variant\"]))\n                  : _createCommentVNode(\"\", true)\n              ])\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_14, [\n      _cache[42] || (_cache[42] = _createElementVNode(\"hr\", {\n        class: \"ma-2\",\n        style: {\"width\":\"100%\"}\n      }, null, -1)),\n      (_unref(regions).length > 0 || _unref(timeRanges).length > 1)\n        ? (_openBlock(), _createBlock(_component_v_btn, {\n            key: 0,\n            color: \"#a63a3f\",\n            onClick: _cache[16] || (_cache[16] = ($event: any) => (showConfirmReset.value = true))\n          }, {\n            default: _withCtx(() => [...(_cache[41] || (_cache[41] = [\n              _createTextVNode(\" Delete ALL selections \", -1)\n            ]))]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _createVNode(_component_v_dialog, {\n      modelValue: showEditRegionNameDialog.value,\n      \"onUpdate:modelValue\": _cache[19] || (_cache[19] = ($event: any) => ((showEditRegionNameDialog).value = $event))\n    }, {\n      default: _withCtx(() => [\n        _createVNode(CTextField, {\n          label: \"Region Name\",\n          title: \"Enter a new name for this region\",\n          \"hide-details\": \"\",\n          dense: \"\",\n          \"button-color\": _unref(accentColor),\n          onConfirm: _cache[17] || (_cache[17] = (name) => {\n    if (regionBeingEdited.value) {\n      _unref(store).setRegionName(regionBeingEdited.value as UnifiedRegionType, name);\n      showEditRegionNameDialog.value = false;\n    }\n  }),\n          onCancel: _cache[18] || (_cache[18] = () => {\n            showEditRegionNameDialog.value = false;\n            regionBeingEdited.value = null;\n          })\n        }, null, 8, [\"button-color\"])\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createVNode(_component_v_dialog, {\n      \"model-value\": sampleErrorID.value !== null,\n      \"max-width\": \"50%\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_card, { class: \"popup-card--outline\" }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_toolbar, { density: \"compact\" }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_toolbar_title, { text: \"Error Loading Data\" }),\n                _createVNode(_component_v_spacer),\n                _createVNode(_component_v_btn, {\n                  icon: \"mdi-close\",\n                  onClick: _cache[20] || (_cache[20] = ($event: any) => (sampleErrorID.value = null))\n                })\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_v_card_text, null, {\n              default: _withCtx(() => [...(_cache[43] || (_cache[43] = [\n                _createTextVNode(\" There was an error loading data for this selection. Either there is no data for the region/time range/molecule combination that you selected, or there was an error loading data from the server. You can delete this selection and try making a new one. \", -1)\n              ]))]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"model-value\"]),\n    _createVNode(_component_v_dialog, {\n      modelValue: showEditTimeRangeNameDialog.value,\n      \"onUpdate:modelValue\": _cache[23] || (_cache[23] = ($event: any) => ((showEditTimeRangeNameDialog).value = $event))\n    }, {\n      default: _withCtx(() => [\n        _createVNode(CTextField, {\n          label: \"Time Range Name\",\n          title: \"Enter a new name for this time range\",\n          \"hide-details\": \"\",\n          dense: \"\",\n          \"button-color\": _unref(accentColor),\n          onConfirm: _cache[21] || (_cache[21] = (name) => {\n            if (timeRangeBeingEdited.value) {\n              _unref(store).setTimeRangeName(timeRangeBeingEdited.value, name);\n              showEditTimeRangeNameDialog.value = false;\n            }\n          }),\n          onCancel: _cache[22] || (_cache[22] = () => {\n            showEditTimeRangeNameDialog.value = false;\n            timeRangeBeingEdited.value = null;\n          })\n        }, null, 8, [\"button-color\"])\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createVNode(_component_v_dialog, {\n      modelValue: showDatasetEditor.value,\n      \"onUpdate:modelValue\": _cache[26] || (_cache[26] = ($event: any) => ((showDatasetEditor).value = $event))\n    }, {\n      default: _withCtx(() => [\n        (currentlyEditingDataset.value !== null)\n          ? (_openBlock(), _createBlock(UserDatasetEditor, {\n              key: 0,\n              modelValue: currentlyEditingDataset.value,\n              \"onUpdate:modelValue\": _cache[24] || (_cache[24] = ($event: any) => ((currentlyEditingDataset).value = $event)),\n              \"name-only\": datasetEditorNameOnly.value,\n              onComplete: _cache[25] || (_cache[25] = () => {\n          showDatasetEditor.value = false;\n          currentlyEditingDataset.value = null;\n        })\n            }, null, 8, [\"modelValue\", \"name-only\"]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createVNode(AdvancedOperations, {\n      modelValue: showAggregationDialog.value,\n      \"onUpdate:modelValue\": _cache[27] || (_cache[27] = ($event: any) => ((showAggregationDialog).value = $event)),\n      selection: aggregationDataset.value,\n      onSave: handleAggregationSaved,\n      onPlotClick: handlePlotClick\n    }, null, 8, [\"modelValue\", \"selection\"]),\n    _createVNode(_component_v_dialog, {\n      modelValue: showUserDatasetTable.value,\n      \"onUpdate:modelValue\": _cache[29] || (_cache[29] = ($event: any) => ((showUserDatasetTable).value = $event)),\n      \"max-width\": \"800px\",\n      persistent: \"\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_card, { class: \"popup-card--outline\" }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_toolbar, { density: \"compact\" }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_toolbar_title, { text: \"Dataset Table View\" }),\n                _createVNode(_component_v_spacer),\n                _createVNode(_component_v_btn, {\n                  icon: \"mdi-close\",\n                  onClick: _cache[28] || (_cache[28] = ($event: any) => {showUserDatasetTable.value = false; tableSelection.value = null})\n                })\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_v_card_text, null, {\n              default: _withCtx(() => [\n                (tableSelection.value !== null)\n                  ? (_openBlock(), _createBlock(UserDatasetTable, {\n                      key: 0,\n                      dataset: tableSelection.value\n                    }, null, 8, [\"dataset\"]))\n                  : _createCommentVNode(\"\", true)\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"modelValue\"]),\n    _createVNode(_component_local_scope, {\n      datasets: _unref(datasets).filter(d => (d.samples || d.plotlyDatasets) && selectedDatasets.value.includes(d.id) )\n    }, {\n      default: _withCtx(({ datasets }) => [\n        _createVNode(_component_cds_dialog, {\n          title: `Graph${new Set(datasets.map(ds => ds.molecule)).size > 1 ? 's' : ''} of Quantity vs Time`,\n          \"title-color\": \"var(--info-background)\",\n          modelValue: showMultiPlot.value,\n          \"onUpdate:modelValue\": _cache[30] || (_cache[30] = ($event: any) => ((showMultiPlot).value = $event)),\n          persistent: \"\",\n          draggable: \"\",\n          \"max-height\": \"90vh\",\n          \"max-width\": \"90vw\",\n          scrim: true,\n          \"drag-predicate\": _unref(titleBarPredicate)\n        }, {\n          default: _withCtx(() => [\n            _createVNode(MultiPlot, { datasets: datasets }, null, 8, [\"datasets\"])\n          ]),\n          _: 2\n        }, 1032, [\"title\", \"modelValue\", \"drag-predicate\"])\n      ]),\n      _: 1\n    }, 8, [\"datasets\"])\n  ], 4))\n}\n}\n\n})","<template>\n  <div id=\"dataset-sections\" :style=\"cssVars\">\n    <div id=\"add-region-time\">\n      <p>\n        Select a Region, Time Range, and Molecule to create a dataset of your choice!\n      </p>\n    <v-dialog\n      v-model=\"showConfirmReset\"\n      max-width=\"35%\"\n    >\n      <v-card class=\"popup-card--outline\">\n        <v-card-text>\n          Are you sure you want to delete all of your selections? \n          This will remove all of your regions, time ranges, \n          and datasets, and cannot be undone.\n        </v-card-text>\n        <v-card-actions>\n          <v-btn\n            color=\"error\"\n            @click=\"showConfirmReset = false\"\n          >\n            No\n          </v-btn>\n          <v-btn\n            color=\"success\"\n            @click=\"() => {\n              store.reset();\n              serializeTempoStore(store);\n              showConfirmReset = false;\n            }\"\n          >\n            Yes\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n      <v-expansion-panels\n        v-model=\"openPanels\"\n        variant=\"accordion\"\n        id=\"user-options-panels\"\n        multiple\n      > \n        <v-expansion-panel\n          title=\"Regions\"\n          class=\"mt-3 h3-panel-titles\"\n        >\n          <template #text>\n            <div id=\"add-region-buttons\">\n              <v-btn\n                size=\"small\"\n                :active=\"selectionActive === 'rectangle'\"\n                :disabled=\"selectionActive === 'point'\"\n                :color=\"accentColor2\"\n                @click=\"() => {\n                  selectionActive = (selectionActive === 'rectangle') ? null : 'rectangle';\n                }\"\n              >\n                <template #prepend>\n                  <v-icon v-if=\"selectionActive !== 'rectangle'\" icon=\"mdi-plus\"></v-icon>\n                </template>\n                {{ selectionActive === 'rectangle' ? \"Cancel\" : \"New Region\" }}\n              </v-btn>\n              <popup-info-button\n                info-text=\"To select a region, click and drag a rectangle across the map. When a large region is selected, we sample an evenly-spaced subset of approximately 30 pixels to shorten the data loading time. For each available time step, all the sampled data across the region will be averaged together.\"\n                :width=\"popupCardWidth\"\n              >\n              </popup-info-button>\n            </div>\n            <v-checkbox\n              v-model=\"showSamplingPreviewMarkers\"\n              class=\"show-sample-points-toggle\"\n              label=\"Show sample points\"\n              density=\"compact\"\n              hide-details\n            >\n              <template #append>\n                <popup-info-button\n                  info-text=\"Checking this box will display the pixels of your selected region where data will be requested from the server.\"\n                  :width=\"popupCardWidth\"\n                >\n                </popup-info-button>\n              </template>\n            </v-checkbox>\n            <div class=\"my-selections\" v-if=\"regions.length>0\" style=\"margin-top: 1em;\">\n            <h4>\n              My Regions\n              <popup-info-button\n                info-text=\"Click the region card to go to that region on the map. Click the pen to rename a region. Click the trash can to delete a region. If an existing dataset is using a region, it cannot be deleted.\"\n                :width=\"popupCardWidth\"\n              >\n              </popup-info-button>\n            </h4>                   \n              <v-slider\n                v-model=\"regionOpacity\"\n                :min=\"0\"\n                :max=\"1\"\n                :step=\"0.01\"\n                label=\"Region Opacity\"\n                :color=\"tempoRed\"\n                density=\"compact\"\n                hide-details\n                :thumb-size=\"12\"\n                :track-size=\"3\"\n              >\n              </v-slider>\n              <v-checkbox\n                v-model=\"regionVisibility\"\n                label=\"Show regions\"\n                density=\"compact\"\n                hide-details\n              >\n              </v-checkbox>\n              <v-list>\n                <v-list-item\n                  v-for=\"(region, index) in regions\"\n                  :class=\"` my-2 rounded-lg region-list-item region-list-item-${index}`\"\n                  :key=\"index\"\n                  :title=\"region.name\"\n                  :style=\"{ 'background-color': region.color }\"\n                  @click=\"() => focusRegion = region\"\n                  density=\"compact\"\n                  slim\n                >\n                  <template #append>\n                    <!-- New: Edit Geometry button (disabled if any selection using region has samples) -->\n                    <!-- <v-btn\n                      variant=\"plain\"\n                      :icon=\"region.geometryType === 'rectangle' ? 'mdi-select' : 'mdi-plus'\"\n                      color=\"white\"\n                      :disabled=\"regionHasSamples(region as UnifiedRegionType)\"\n                      v-tooltip=\"regionHasSamples(region as UnifiedRegionType) ? 'Cannot edit geometry after samples are fetched for a selection using this region' : 'Edit Geometry'\"\n                      @click=\"() => editRegionGeometry(region as UnifiedRegionType)\"\n                    ></v-btn> -->\n                    <div class=\"datset-controls-action-buttons region-action-buttons\">\n                    <v-btn\n                      variant=\"plain\"\n                      v-tooltip=\"'Edit Name'\"\n                      icon=\"mdi-pencil\"\n                      color=\"white\"\n                      size=\"small\"\n                      density=\"compact\"\n                      @click=\"(event: MouseEvent | KeyboardEvent) => {\n                        editRegionName(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\"\n                    ></v-btn>\n                    <v-btn\n                      v-if=\"!store.regionHasDatasets(region as UnifiedRegionType)\"\n                      variant=\"plain\"\n                      v-tooltip=\"'Delete'\"\n                      icon=\"mdi-delete\"\n                      color=\"white\"\n                      size=\"small\"\n                      density=\"compact\"\n                      @click=\"(event: MouseEvent | KeyboardEvent) => {\n                        store.deleteRegion(region as UnifiedRegionType);\n                        event.stopPropagation();\n                      }\"\n                    ></v-btn>\n                    </div>\n                  </template>\n                </v-list-item>\n              </v-list>\n            </div>\n          </template>\n        </v-expansion-panel>\n        <v-expansion-panel\n          title=\"Time Ranges\"\n          class=\"mt-3 h3-panel-titles\"\n        >\n          <template #text>\n            <v-btn\n              size=\"small\"\n              :active=\"createTimeRangeActive\"\n              :color=\"accentColor2\"\n              @click=\"createTimeRangeActive = !createTimeRangeActive\"\n            >\n              <template #prepend>\n                <v-icon v-if=\"!createTimeRangeActive\" icon=\"mdi-plus\"></v-icon>\n              </template>\n              {{ createTimeRangeActive ? \"Cancel\" : \"New Time Range\" }}\n            </v-btn>\n            <date-time-range-selection\n              v-show=\"createTimeRangeActive\"\n              :current-date=\"singleDateSelected\"\n              :allowed-dates=\"uniqueDays\"\n              @ranges-change=\"handleDateTimeRangeSelectionChange\"\n            />\n            <div class=\"my-selections\" v-if=\"timeRanges.length>0\" style=\"margin-top: 1em;\">\n\n              <v-list>\n                <v-hover\n                  v-for=\"(timeRange, index) in timeRanges\"\n                  :key=\"index\" v-slot=\"{ isHovering, props }\"\n                  close-delay=\"50\"\n                  open-delay=\"250\"\n                  >\n                <v-list-item\n                  class=\"my-2 rounded-lg time-range-v-list-item\"\n                  v-bind=\"props\"\n                  density=\"compact\"\n                  slim\n                  :title=\"timeRange.name === 'Displayed Day' ? `Displayed Day: ${ formatTimeRange(timeRange.range) }` : (timeRange.name ?? formatTimeRange(timeRange.range))\"\n                >\n                  \n                  <template #default>\n                    <TimeRangeCard \n                    :name=\"timeRange.name === 'Displayed Day' ? `Displayed Day: ${ formatTimeRange(timeRange.range) }` : (timeRange.name ?? formatTimeRange(timeRange.range))\"\n                    :time-range=\"timeRange\" \n                    :is-hovering=\"isHovering ?? false\"  \n                    />\n                  </template>\n                  <template #append>\n                  <div class=\"datset-controls-action-buttons time-range-action-buttons\">\n                    <v-btn\n                      v-if=\"timeRange.id !== 'displayed-day'\"\n                      variant=\"plain\"\n                      size=\"small\"\n                      density=\"compact\"\n                      v-tooltip=\"'Edit Name'\"\n                      icon=\"mdi-pencil\"\n                      color=\"white\"\n                      @click=\"(event) => {\n                        editTimeRangeName(timeRange);\n                        event.stopPropagation();\n                      }\"\n                    ></v-btn>\n                    <v-btn\n                      v-if=\"timeRange.id !== 'displayed-day' && !datasets.some(s => areEquivalentTimeRanges(s.timeRange, timeRange))\"\n                      variant=\"plain\"\n                      size=\"small\"\n                      density=\"compact\"\n                      v-tooltip=\"'Delete'\"\n                      icon=\"mdi-delete\"\n                      color=\"white\"\n                      @click=\"() => store.deleteTimeRange(timeRange)\"\n                    >\n                    </v-btn>\n                  </div>\n                  </template>\n                </v-list-item>\n                </v-hover>\n              </v-list>\n            </div>\n          </template>\n        </v-expansion-panel>\n\n        <v-divider\n          class=\"mt-3\"\n          opacity=\"1\"\n        >\n        </v-divider>\n\n        <v-expansion-panel\n          title=\"Datasets\"\n          class=\"mt-3 h3-panel-titles\"\n        >\n        <template #text>\n          <v-btn\n            size=\"small\"\n            :active=\"createDatasetActive\"\n            :color=\"accentColor2\"                    \n            @click=\"createDatasetActive = !createDatasetActive\"\n            class=\"mt-3\"\n          >\n            <template #prepend>\n              <v-icon v-if=\"!createDatasetActive\" icon=\"mdi-plus\"></v-icon>\n            </template>\n            {{ createDatasetActive ? \"Cancel\" : \"New Dataset\" }}\n          </v-btn>\n          <selection-composer\n            v-show=\"createDatasetActive\"\n            :backend=\"backend\"\n            :time-ranges=\"timeRanges\"\n            :regions=\"regions\"\n            :disabled=\"{ region: regions.length === 0, point: selectionActive === 'point', timeRange: timeRanges.length === 0 }\"\n            @create=\"handleDatasetCreated\"\n          >\n          </selection-composer>\n          <div class=\"my-selections\" v-if=\"datasets.length>0\" style=\"margin-top: 1em;\">\n\n\n            \n            <dataset-card\n              :datasets=\"datasets\"\n              :turn-on-selection=\"allDatasetSelection\"\n              v-model:selected-datasets=\"selectedDatasets\"\n              @edit-region=\"(e) => handleEditDataset(e)\"\n            >\n              <template #action-row=\"{ dataset }\">\n                    <div\n                      v-if=\"(dataset.loading || !dataset.samples)  && !(dataset.timeRange?.type === 'folded' && dataset.plotlyDatasets)\"\n                      class=\"dataset-loading\"\n                    >\n                      <hr/>\n                      <v-progress-linear\n                        :class=\"['dataset-loading-progress', !(dataset.loading && dataset.samples) ? 'dataset-loading-failed' : '']\"\n                        :active=\"dataset.loading || !dataset.samples\"\n                        :color=\"dataset.loading ? 'primary' : 'red'\"\n                        :indeterminate=\"dataset.loading\"\n                        :value=\"!dataset.loading ? 100 : 0\"\n                        :striped=\"!dataset.loading\"\n                        bottom\n                        rounded\n                        height=\"20\"\n                      >\n                        <template #default>\n                          <span class=\"text-subtitle-2\">\n                            {{ dataset.loading ? 'Data Loading' : (!dataset.samples ? 'Error Loading Data' : '') }}\n                          </span>\n                        </template>\n                      </v-progress-linear>\n                      \n                      <v-tooltip\n                        text=\"Remove selection\"\n                        location=\"top\"\n                      >\n                        <template #activator=\"{ props }\">\n                          <v-btn\n                            v-bind=\"props\"\n                            size=\"x-small\"\n                            icon=\"mdi-trash-can\"\n                            variant=\"plain\"\n                            @click=\"() => removeDataset(dataset)\"\n                          ></v-btn>\n                        </template>\n                      </v-tooltip>\n                      \n                      <div v-if=\"!(dataset.loading || dataset.samples || dataset.plotlyDatasets)\">\n                        <hr/>\n                        <v-tooltip\n                          text=\"Failure info\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-help-circle\"\n                              variant=\"plain\"\n                              @click=\"() => sampleErrorID = dataset.id\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          text=\"Remove selection\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-trash-can\"\n                              variant=\"plain\"\n                              @click=\"() => removeDataset(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                      </div>\n                    </div>\n\n                    <v-expand-transition>\n                      <div\n                        class=\"selection-icons\"\n                        v-show=\"(dataset.samples || dataset.plotlyDatasets) && (touchscreen ? openSelection == dataset.id : true)\"\n                      >\n                        <v-tooltip\n                          v-if=\"dataset.timeRange.type === 'single' || dataset.folded\"\n                          text=\"Show graph\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-chart-line\"\n                              :disabled=\"!(dataset.samples || dataset.plotlyDatasets)\"\n                              variant=\"plain\"\n                              @click=\"() => openGraphs[dataset.id] = true\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          v-else\n                          text=\"Graph Data\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-chart-line\"\n                              :disabled=\"!dataset.samples\"\n                              variant=\"plain\"\n                              @click=\"() => openAggregationDialog(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-tooltip\n                          text=\"Show table\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-table\"\n                              :disabled=\"!dataset.samples && !dataset.folded\"\n                              variant=\"plain\"\n                              @click=\"() => tableSelection = dataset\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        \n                        <v-tooltip\n                          text=\"Edit Dataset Name/Color\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-pencil\"\n                              variant=\"plain\"\n                              @click=\"() => handleEditDataset(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                        <v-spacer ></v-spacer>\n                        <v-tooltip\n                          text=\"Remove selection\"\n                          location=\"top\"\n                        >\n                          <template #activator=\"{ props }\">\n                            <v-btn\n                              v-bind=\"props\"\n                              size=\"x-small\"\n                              icon=\"mdi-trash-can\"\n                              variant=\"plain\"\n                              @click=\"() => removeDataset(dataset)\"\n                            ></v-btn>\n                          </template>\n                        </v-tooltip>\n                      </div>\n                    </v-expand-transition>\n                    \n                    <cds-dialog\n                      :title=\"`${moleculeDescriptor(dataset.molecule).shortName.text} Quantity vs. Time`\"\n                      v-model=\"openGraphs[dataset.id]\"\n                      title-color=\"var(--info-background)\"\n                      draggable\n                      persistent\n                      :scrim=\"false\"\n                      :modal=\"false\"\n                      max-height=\"fit-content\"\n                      height=\"fit-content\"\n                      :drag-predicate=\"titleBarPredicate\"\n                    >\n                    \n                    <template v-if=\"(dataset.timeRange.type === 'folded' && dataset.plotlyDatasets) || (dataset.timeRange.type === 'single')\">\n                        <user-dataset-plot\n                          :dataset=\"dataset\"\n                          :show-errors=\"showErrorBands\"\n                          :colors=\"[dataset.customColor ?? dataset.region.color, '#333']\"\n                          :data-options=\"[{mode: 'markers'}, {mode: 'markers'}]\"\n                          :names=\"[`Original Data`, `Binned`]\"\n                          :layout-options=\"{\n                            width: 600, \n                            height: 400,\n                            autosize: false,\n                            ...(dataset.folded ? {} : { xaxis: {title: {text: 'Local Time for Region'}}}),\n                          }\"\n                          :fold-type=\"dataset.folded?.foldType\"\n                          :timezones=\"dataset.folded?.timezone\"\n                          :config-options=\"{responsive: false}\"\n                          @plot-click=\"(value) => handlePlotClick({...value, molecule: dataset.molecule, region: dataset.region})\"\n                        />\n                      </template>\n                    </cds-dialog>\n                  </template>\n                </dataset-card>\n              </div>\n              <div v-if=\"allDatasetSelection\" class=\"dataset-select-all-none\">\n                <v-btn\n                  variant=\"outlined\"\n                  size=\"small\"\n                  @click=\"selectedDatasets = datasets.map(d => d.id)\"\n                >\n                  <template #prepend>\n                    <v-icon icon=\"mdi-check-circle\" color=\"success\"/>\n                  </template>\n                  All\n                </v-btn>\n                <v-btn\n                  variant=\"outlined\"\n                  size=\"small\"\n                  class=\"ml-2\"\n                  @click=\"selectedDatasets = []\"\n                >\n                  <template #prepend>\n                    <v-icon icon=\"mdi-close-circle\" color=\"error\"/>\n                  </template>\n                  Clear\n                </v-btn>\n              </div>\n              <div class=\"d-flex flex-column align-items-center justify-space-between ga-2\">\n                <v-btn \n                v-if=\"datasets.length > 1\"\n                :disabled=\"datasets.length === 0 || !datasets.every(d => d.samples || d.plotlyDatasets)\"\n                color=\"#ffcc33\" size=\"small\" :block=\"false\" @click=\"allDatasetSelection = !allDatasetSelection\">\n                {{ allDatasetSelection ? 'Cancel Selection' : 'Select Datasets to Graph' }}\n              </v-btn>\n              <v-btn \n              v-if=\"datasets.length > 1\"\n              :color=\"accentColor2\"\n              :disabled=\"selectedDatasets.length == 0\"\n              :variant=\"selectedDatasets.length > 0 ? 'flat' : 'outlined'\"\n              @click=\"showMultiPlot = true\">\n              Graph Selected Datasets\n            </v-btn>\n          </div>\n        </template>\n      </v-expansion-panel>\n    </v-expansion-panels>\n  </div>\n  \n  <div class=\"d-flex flex-wrap flex-row align-center justify-center ga-1\">\n    \n    \n    \n    <!--  -->\n    <hr class=\"ma-2\" style=\"width: 100%;\"/>\n    <v-btn\n    v-if=\"regions.length > 0 || timeRanges.length > 1\"\n      color=\"#a63a3f\"\n      @click=\"showConfirmReset = true\"\n      >\n      Delete ALL selections\n    </v-btn>\n  </div>\n  \n  <v-dialog\n  v-model=\"showEditRegionNameDialog\"\n  >\n  <!-- text field that requires a confirmation -->\n  <c-text-field\n  label=\"Region Name\"\n  title=\"Enter a new name for this region\"\n  hide-details\n  dense\n  :button-color=\"accentColor\"\n  @confirm=\"(name: string) => {\n    if (regionBeingEdited) {\n      store.setRegionName(regionBeingEdited as UnifiedRegionType, name);\n      showEditRegionNameDialog = false;\n    }\n  }\"\n          @cancel=\"() => {\n            showEditRegionNameDialog = false;\n            regionBeingEdited = null;\n          }\"\n        ></c-text-field>\n      </v-dialog>\n      \n    <v-dialog\n      :model-value=\"sampleErrorID !== null\"\n      max-width=\"50%\"\n    >\n      <v-card class=\"popup-card--outline\">\n        <v-toolbar\n          density=\"compact\"\n        >\n          <v-toolbar-title text=\"Error Loading Data\"></v-toolbar-title>\n          <v-spacer></v-spacer>\n          <v-btn\n            icon=\"mdi-close\"\n            @click=\"sampleErrorID = null\"\n          >\n          </v-btn>\n        </v-toolbar>\n        <v-card-text>\n          There was an error loading data for this selection. Either there is no data for the\n          region/time range/molecule combination that you selected, or there was an error loading\n          data from the server. You can delete this selection and try making a new one.\n        </v-card-text>\n      </v-card>\n    </v-dialog>\n    \n    <v-dialog\n      v-model=\"showEditTimeRangeNameDialog\"\n    >\n      <!-- text field that requires a confirmation -->\n        <c-text-field\n          label=\"Time Range Name\"\n          title=\"Enter a new name for this time range\"\n          hide-details\n          dense\n          :button-color=\"accentColor\"\n          @confirm=\"(name: string) => {\n            if (timeRangeBeingEdited) {\n              store.setTimeRangeName(timeRangeBeingEdited, name);\n              showEditTimeRangeNameDialog = false;\n            }\n          }\"\n          @cancel=\"() => {\n            showEditTimeRangeNameDialog = false;\n            timeRangeBeingEdited = null;\n          }\"\n        ></c-text-field>\n    </v-dialog>\n        \n    <v-dialog\n      v-model=\"showDatasetEditor\"\n    >\n      <user-dataset-editor\n        v-if=\"currentlyEditingDataset !== null\"\n        v-model=\"currentlyEditingDataset\" \n        :name-only=\"datasetEditorNameOnly\"\n        @complete=\"() => {\n          showDatasetEditor = false;\n          currentlyEditingDataset = null;\n        }\"\n        />\n    </v-dialog>\n        \n    <!-- Data Aggregation Dialog -->\n    <advanced-operations\n      v-model=\"showAggregationDialog\"\n      :selection=\"aggregationDataset\"\n      @save=\"handleAggregationSaved\"\n      @plot-click=\"handlePlotClick\"\n    />\n    \n    <v-dialog\n      v-model=\"showUserDatasetTable\"\n      max-width=\"800px\"\n      persistent\n    >\n      <v-card class=\"popup-card--outline\">\n        <v-toolbar\n          density=\"compact\"\n        >\n          <v-toolbar-title text=\"Dataset Table View\"></v-toolbar-title>\n          <v-spacer></v-spacer>\n          <v-btn\n            icon=\"mdi-close\"\n            @click=\"showUserDatasetTable = false; tableSelection = null\"\n          >\n          </v-btn>\n        </v-toolbar>\n        <v-card-text>\n          <user-dataset-table\n            v-if=\"tableSelection !== null\"\n            :dataset=\"tableSelection\"\n          />\n        </v-card-text>\n      </v-card>\n    </v-dialog>\n    \n    <local-scope\n      :datasets=\"datasets.filter(d => (d.samples || d.plotlyDatasets) && selectedDatasets.includes(d.id) )\"\n    >\n      <template #default=\"{ datasets }\">\n        <cds-dialog\n          :title=\"`Graph${new Set(datasets.map(ds => ds.molecule)).size > 1 ? 's' : ''} of Quantity vs Time`\"\n          title-color=\"var(--info-background)\"\n          v-model=\"showMultiPlot\"\n          persistent\n          draggable\n          max-height=\"90vh\"\n          max-width=\"90vw\"\n          :scrim=\"true\"\n          :drag-predicate=\"titleBarPredicate\"\n        >\n          <multi-plot\n            :datasets=\"datasets\"\n          />\n        </cds-dialog>\n      </template>\n    </local-scope>\n\n  </div>\n\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { v4 } from \"uuid\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport type { MillisecondRange, TimeRange, UserDataset, UnifiedRegion, MoleculeType } from \"../types\";\nimport type { TimeRangeConfig } from \"@/date_time_range_selection/date_time_range_generators\";\nimport { serializeTempoStore, useTempoStore } from \"../stores/app\";\nimport { MOLECULE_OPTIONS, moleculeDescriptor } from \"../esri/utils\";\nimport { areEquivalentTimeRanges, formatTimeRange } from \"../utils/timeRange\";\nimport { atleast1d } from \"../utils/atleast1d\";\nimport { titleBarPredicate } from \"../utils/draggable\";\n\nimport DateTimeRangeSelection from \"../date_time_range_selection/DateTimeRangeSelection.vue\";\nimport AdvancedOperations from \"./AdvancedOperations.vue\";\nimport { TimeRangeSelectionType } from \"@/types/datetime\";\n// import PlotlyGraph from \"./plotly/PlotlyGraph.vue\";\n// import FoldedPlotlyGraph from \"./FoldedPlotlyGraph.vue\";\nimport CTextField from \"./CTextField.vue\";\nimport DatasetCard from \"./DatasetCard.vue\";\nimport { toZonedTime } from \"date-fns-tz\";\n// import { userDatasetToPlotly } from \"@/utils/data_converters\";\nimport UserDatasetTable from \"./UserDatasetTable.vue\";\nimport TimeRangeCard from \"@/date_time_range_selection/TimeRangeCard.vue\";\nimport MultiPlot from \"./plotly/MultiMoleculePlot.vue\";\nimport UserDatasetPlot from \"./plotly/UserDatasetPlot.vue\";\n\ntype UnifiedRegionType = UnifiedRegion;\n\nconst store = useTempoStore();\nconst {\n  accentColor,\n  accentColor2,\n  backend,\n  regions,\n  datasets,\n  timeRanges,\n  singleDateSelected,\n  uniqueDays,\n  selectionActive,\n  focusRegion,\n  showSamplingPreviewMarkers,\n  regionOpacity,\n  regionVisibility,\n  tempoRed,\n} = storeToRefs(store);\n\nconst cssVars = computed(() => {\n  return {\n    '--accent-color': accentColor.value,\n    '--accent-color-2': accentColor2.value,\n  };\n});\n\nconst touchscreen = supportsTouchscreen();\n\nconst openPanels = ref<number[]>([0, 1, 2]);\nconst openGraphs = ref<Record<string,boolean>>({});\nconst openSelection = ref<string | null>(null);\nconst tableSelection = ref<UserDataset | null>(null);\nconst currentlyEditingDataset = ref<UserDataset | null>(null);\nconst showConfirmReset = ref(false);\nconst showMultiPlot = ref(false);\n\nconst createTimeRangeActive = ref(false);\nconst createDatasetActive = ref(false);\nconst datasetRowRefs = ref({});\nconst sampleErrorID = ref<string | null>(null);\n\nconst showEditRegionNameDialog = ref(false);\nconst regionBeingEdited = ref<UnifiedRegionType | null>(null);\n\nconst showEditTimeRangeNameDialog = ref(false);\nconst timeRangeBeingEdited = ref<TimeRange | null>(null);\n\nconst popupCardWidth = 300;\n\nconst aggregationDataset = ref<UserDataset | null>(null);\nconst showAggregationDialog = ref(false);\nfunction openAggregationDialog(selection: UserDataset) {\n  aggregationDataset.value = selection;\n  showAggregationDialog.value = true;\n}\nfunction handleAggregationSaved(aggregatedSelection: UserDataset) {\n  const n = datasets.value.map(d => d.name).filter(n => n?.startsWith(aggregatedSelection.name + ' ' || 'animpossiblename')).length;\n  aggregatedSelection.name = `${aggregatedSelection.name} ${String.fromCharCode(97 + n)}`; // a, b, c, ...\n  store.addDataset(aggregatedSelection, false); // no need to fetch anything\n  showAggregationDialog.value = false;\n  aggregationDataset.value = null;\n}\n\nimport { RequestStats, FetchOptions } from \"@/esri/services/TempoDataService\";\nfunction handleDatasetCreated(dataset: UserDataset) {\n  dataset.name = `Dataset ${datasets.value.length + 1}`; // give it a default name\n  const onProgress: FetchOptions[\"onProgress\"] = (_stats: RequestStats, completed: number, total: number) => {\n    console.log(`Dataset ${dataset.name} loading progress: ${completed}/${total} requests completed.`, _stats);\n  };\n  store.addDataset(dataset, true, onProgress);\n  createDatasetActive.value = false;\n}\n\nimport UserDatasetEditor from \"./UserDatasetEditor.vue\";\nconst showDatasetEditor = ref(false);\nconst datasetEditorNameOnly = ref(false);\nfunction handleEditDataset(dataset: UserDataset, nameOnly = false) {\n  datasetEditorNameOnly.value = nameOnly;\n  currentlyEditingDataset.value = dataset;\n  showDatasetEditor.value = true;\n}\n\nfunction removeDataset(dataset: UserDataset) {\n  store.deleteDataset(dataset);\n\n  delete openGraphs[dataset.id];\n  delete datasetRowRefs[dataset.id];\n}\n\nfunction handleDateTimeRangeSelectionChange(\n  timeRanges: MillisecondRange[], \n  selectionType: TimeRangeSelectionType, \n  customName: string, \n  config: TimeRangeConfig,\n) {\n  if (!Array.isArray(timeRanges) || timeRanges.length === 0) {\n    console.error('No time ranges received from DateTimeRangeSelection');\n    return;\n  }\n  console.log(`Received ${timeRanges.length} time ranges of type ${selectionType} and name ${customName}`);\n  const normalized = atleast1d(timeRanges);\n  const countTimeRanges = store.timeRanges.length;\n  // No dedup tracking now\n  const tr: TimeRange = {\n    id: v4(),\n    name: `Time Range ${countTimeRanges + 1}`,\n    description: customName,\n    range: normalized.length === 1 ? normalized[0] : normalized,\n    type: selectionType,\n    config: config,\n  };\n  store.addTimeRange(tr);\n\n  createTimeRangeActive.value = false;\n  console.log(`Registered ${tr.name}: ${tr.description}`);\n}\n\nfunction editRegionName(region: UnifiedRegionType) {\n  console.log(`Editing ${region.geometryType}: ${region.name}`);\n  // Set the region to edit\n\n  // eslint-disable-next-line\n  // @ts-ignore it is not actually deep\n  const existing = (regions.value as UnifiedRegionType[]).find(r => r.id === region.id);\n  if (!existing) {\n    console.error(`Region with ID ${region.id} not found.`);\n    return;\n  }\n  regionBeingEdited.value = region;\n  // Open dialog for renaming\n  showEditRegionNameDialog.value = true;\n}\n\nfunction editTimeRangeName(timeRange: TimeRange) {\n  console.log(`Editing time range: ${timeRange.name}`);\n  \n  const existing = timeRanges.value.find(tr => tr.id === timeRange.id);\n  if (!existing) {\n    console.error(`Time range with ID ${timeRange.id} not found.`);\n    return;\n  }\n  timeRangeBeingEdited.value = timeRange;\n  // Open dialog for renaming\n  showEditTimeRangeNameDialog.value = true;\n}\n\nfunction _graphTitle(dataset: UserDataset): string {\n  const molecule = dataset.molecule;\n  const molTitle = MOLECULE_OPTIONS.find(m => m.value === molecule)?.title || '';\n  return dataset.name ?? `${molTitle} Time Series for ${dataset.region.name}`;\n}\n\n\n\n\nfunction _toZonedTime(date: number | Date | string, timezone): number | Date {\n  if (typeof date === 'number') {\n    date = new Date(date);\n  } else if (typeof date === 'string') {\n    date = new Date(date);\n  }\n  return toZonedTime(date, timezone);\n}\n\nconst allDatasetSelection = ref(false);\nconst selectedDatasets = ref<string[]>([]);\nwatch(allDatasetSelection, (newVal) => {\n  if (!newVal) {\n    selectedDatasets.value = [];\n  }\n});\nwatch(selectedDatasets, (newVal) => {\n  console.log('Selected datasets changed:', newVal);\n});\n\n\n\n\nconst showErrorBands = ref(true);\n\nconst showUserDatasetTable = ref(false);\nwatch(tableSelection, (newVal) => {\n  if (newVal) {\n    console.log('Table selection changed:', newVal);\n    showUserDatasetTable.value = true;\n  }\n});\n\n\n/** handle plot click should set the time and molecule and zoom into the region */\nfunction handlePlotClick(value: {x: number | string | Date | null, y: number, customdata: unknown, molecule: MoleculeType, region: UnifiedRegion}): void {\n  if (value.x === null) return;\n  console.log('Plot clicked at:', value);\n  // store.setNearestTime(new Date(value.x));\n  focusRegion.value = value.region;\n  \n}\n\n</script>\n\n<style scoped lang=\"less\">\n#dataset-sections {\n  font-size: 11pt !important;\n}\n\n// prevent overflows of the content\n#add-region-time {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  gap: 5px;\n}\n\n.my-selections {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  gap: 5px;\n  padding: 0.5rem;\n  border-radius: 10px;\n  // background-color: #555555;\n}\n\n.selection-icons {\n  display: flex;\n}\n\n.h3-panel-titles .v-expansion-panel-title {\n  font-size: 1.17em;\n  font-weight: bold;\n}\n\n.explainer-text {\n  border-radius: 5px;\n  padding: 5px;\n  padding-inline-start: 10px;\n  background-color: rgb(var(--v-theme-background));\n  font-size: 0.8em;\n  color: rgb(var(--v-theme-on-surface));\n  \n}\n\n.error-explainer-text {\n  border-radius: 5px;\n  padding: 5px;\n  padding-inline-start: 10px;\n  background-color: rgba(255, 0, 0, 0.4);\n  font-size: 0.8em;\n  color: white;\n  font-weight: bold;\n}\n\n.explainer-text hr {\n  border: none;\n  border-top: 1px solid rgb(var(--v-theme-on-surface-light));\n  margin-inline: 0;\n  margin-block: 1em;\n}\n\n.explainer-text dt {\n  font-weight: bold;\n}\n\n.explainer-text dd {\n  margin-left: 0;\n  margin-bottom: 8px;\n}\n\n.dataset-loading {\n  display: flex;\n  align-items: center;\n}\n\n.datset-controls-action-buttons {\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n}\n.time-range-action-buttons {\n  text-align: right;\n}\n\n.time-range-v-list-item:nth-child(odd) {\n  background-color: #444444;\n}\n.time-range-v-list-item:nth-child(even) {\n  background-color: #656565;\n}\n\n:deep(.v-checkbox .v-label),\n:deep(.v-slider__label),\n:deep(.v-list-item-title)\n{\n  font-size: 10pt;\n}\n\n.show-sample-points-toggle {\n  width: fit-content;\n}\n\n:deep(.info-button) {\n  padding-left: 5px;\n}\n\n:deep(.show-sample-points-toggle .v-input__append) {\n  margin: 0;\n}\n\n.dataset-select-all-none {\n  display: flex;\n  margin-bottom: 1em;\n  flex-direction: row;\n}\n\n.dataset-select-all-none > button {\n  flex-grow: 1;\n}\n\n.region-list-item {\n  \n}\n</style>\n","import script from \"./DatasetControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DatasetControls.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DatasetControls.vue?vue&type=style&index=0&id=0fa3d9dd&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0fa3d9dd\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, withKeys as _withKeys, isRef as _isRef } from \"vue\"\n\nconst _hoisted_1 = { class: \"comparison-data-controls\" }\n\nimport { storeToRefs } from \"pinia\";\n\nimport { useTempoStore } from \"@/stores/app\";\n\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'ComparisonDataControls',\n  setup(__props) {\n\nconst store = useTempoStore();\nconst {\n  maps,\n  showFieldOfRegard,\n  showAdvancedLayers,\n  showRGBMode,\n  accentColor2\n} = storeToRefs(store);\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_layer_order_control = _resolveComponent(\"layer-order-control\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"my-3\" }, [\n      _createTextVNode(\" Choose datasets to view with the TEMPO Data. \"),\n      _createElementVNode(\"ul\", { class: \"cdc-instruction\" }, [\n        _createElementVNode(\"li\", null, \"Drag cards to re-order data layers.\"),\n        _createElementVNode(\"li\", null, \"Use slider to adjust layer opacity.\")\n      ])\n    ], -1)),\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(maps), (map, index) => {\n      return (_openBlock(), _createElementBlock(\"div\", { key: index }, [\n        _createVNode(_component_layer_order_control, {\n          mapRef: map,\n          order: ['power-plants-layer', 'aqi-layer-aqi', 'pop-dens', 'land-use','hms-fire', 'tempo-o3', 'tempo-hcho', 'tempo-no2', 'stamen-toner-lines', 'stamen-toner-labels']\n        }, null, 8, [\"mapRef\"]),\n        _createVNode(_component_v_btn, {\n          class: \"my-2 d-block mx-auto\",\n          onClick: _cache[0] || (_cache[0] = ($event: any) => (showAdvancedLayers.value = !_unref(showAdvancedLayers))),\n          onKeyup: _cache[1] || (_cache[1] = _withKeys(($event: any) => (showAdvancedLayers.value = !_unref(showAdvancedLayers)), [\"enter\"])),\n          text: _unref(showAdvancedLayers) ? 'Show me less' : 'Show me more!',\n          density: \"compact\",\n          \"hide-details\": \"\",\n          color: _unref(accentColor2)\n        }, null, 8, [\"text\", \"color\"]),\n        _createVNode(_component_v_checkbox, {\n          modelValue: _unref(showRGBMode),\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => (_isRef(showRGBMode) ? (showRGBMode).value = $event : null)),\n          label: \"Use single-color TEMPO layers\",\n          density: \"compact\",\n          \"hide-details\": \"\"\n        }, null, 8, [\"modelValue\"]),\n        _createVNode(_component_v_checkbox, {\n          modelValue: _unref(showFieldOfRegard),\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => (_isRef(showFieldOfRegard) ? (showFieldOfRegard).value = $event : null)),\n          label: \"Show TEMPO field of regard\",\n          density: \"compact\",\n          \"hide-details\": \"\"\n        }, null, 8, [\"modelValue\"])\n      ]))\n    }), 128))\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"comparison-data-controls\">\n    <div class=\"my-3\">\n      Choose datasets to view with the TEMPO Data. \n      <ul class=\"cdc-instruction\">\n        <li>Drag cards to re-order data layers.</li>\n        <li>Use slider to adjust layer opacity.</li>\n      </ul>\n    </div>\n    <div\n      v-for=\"(map, index) in maps\"\n      :key=\"index\"\n    >\n      <layer-order-control\n        :mapRef=\"map\"\n        :order=\"['power-plants-layer', 'aqi-layer-aqi', 'pop-dens', 'land-use','hms-fire', 'tempo-o3', 'tempo-hcho', 'tempo-no2', 'stamen-toner-lines', 'stamen-toner-labels']\"\n      >\n      </layer-order-control>\n      <!-- center with d-block mx-auto -->\n      <v-btn\n        class=\"my-2 d-block mx-auto\"\n        @click=\"showAdvancedLayers = !showAdvancedLayers\"\n        @keyup.enter=\"showAdvancedLayers = !showAdvancedLayers\"\n        :text=\"showAdvancedLayers ? 'Show me less' : 'Show me more!'\"\n        density=\"compact\"\n        hide-details\n        :color=\"accentColor2\"\n      >\n      </v-btn>\n      <v-checkbox\n        v-model=\"showRGBMode\"\n        label=\"Use single-color TEMPO layers\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n      <v-checkbox\n        v-model=\"showFieldOfRegard\"\n        label=\"Show TEMPO field of regard\"\n        density=\"compact\"\n        hide-details\n      >\n      </v-checkbox>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { storeToRefs } from \"pinia\";\n\nimport { useTempoStore } from \"@/stores/app\";\n\n\nconst store = useTempoStore();\nconst {\n  maps,\n  showFieldOfRegard,\n  showAdvancedLayers,\n  showRGBMode,\n  accentColor2\n} = storeToRefs(store);\n\n</script>\n\n<style scoped lang=\"less\">\n.comparison-data-controls {\n  font-size: 11pt !important;\n}\n\n:deep(.v-checkbox .v-label) {\n  font-size: 10pt;\n}\n\n.comparison-data-controls ul.cdc-instruction {\n  font-size: 0.8em;\n  list-style-type: disc;\n  list-style-position: outside;\n  margin-left: 1.2em;\n}\n</style>\n","import script from \"./ComparisonDataControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ComparisonDataControls.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ComparisonDataControls.vue?vue&type=style&index=0&id=158089ee&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-158089ee\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, withKeys as _withKeys, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, mergeProps as _mergeProps, isRef as _isRef, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"map-view\" }\nconst _hoisted_2 = { class: \"map-view-controls\" }\nconst _hoisted_3 = { class: \"date-view-controls mt-2\" }\nconst _hoisted_4 = { class: \"d-flex flex-row align-center\" }\nconst _hoisted_5 = [\"disabled\"]\nconst _hoisted_6 = { class: \"d-flex flex-row align-center my-2\" }\nconst _hoisted_7 = { class: \"map-dropdown-container d-flex flex-row flex-wrap\" }\n\nimport { ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { VueDatePicker } from \"@vuepic/vue-datepicker\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { type MoleculeType } from \"@/esri/utils\";\nimport { useTempoStore } from \"@/stores/app\";\n// import { useEsriTimesteps } from \"@/composables/useEsriTimesteps\";\n\n// import TimeChips from \"@/components/TimeChips.vue\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MapControls',\n  emits: [\"molecule\"],\n  setup(__props, { emit: __emit }) {\n\nconst store = useTempoStore();\nconst {\n  singleDateSelected,\n  uniqueDays,\n  selectedTimezone,\n  timezoneOptions,\n} = storeToRefs(store);\n\nconst emit = __emit;\n\nconst molecule = ref<MoleculeType>('no2');\n\nconst radio = ref<number | null>(null);\nconst touchscreen = supportsTouchscreen();\n\nconst calendar = ref<typeof VueDatePicker | null>(null);\n\n\nwatch(molecule, (newMol: MoleculeType) => {\n  emit(\"molecule\", newMol);\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_date_picker = _resolveComponent(\"date-picker\")!\n  const _component_v_radio_group = _resolveComponent(\"v-radio-group\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_spacer = _resolveComponent(\"v-spacer\")!\n  const _component_v_select = _resolveComponent(\"v-select\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _cache[10] || (_cache[10] = _createElementVNode(\"h2\", null, \"Explore Map View\", -1)),\n    _cache[11] || (_cache[11] = _createElementVNode(\"p\", { class: \"my-2\" }, \"Select a date and timezone to display\", -1)),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _createElementVNode(\"div\", _hoisted_4, [\n          _createVNode(_component_v_radio_group, {\n            modelValue: radio.value,\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((radio).value = $event))\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_date_picker, {\n                class: \"cds__date-picker tall\",\n                ref_key: \"calendar\",\n                ref: calendar,\n                \"model-value\": _unref(singleDateSelected),\n                onInternalModelChange: _cache[2] || (_cache[2] = (value) => {\n                if (value != null && value.getTime() != _unref(singleDateSelected).getTime()) {\n                  radio.value = null;\n                  singleDateSelected.value = value;\n                  calendar.value?.closeMenu();\n                }\n              }),\n                \"allowed-dates\": _unref(uniqueDays),\n                \"input-atters\": {clearable: false},\n                \"time-config\": { enableTimePicker: false },\n                \"multi-dates\": false,\n                transitions: false,\n                formats: {'input': (date) => date?.toDateString(), 'preview': (date) => date?.toDateString()},\n                \"week-start\": 0,\n                \"no-today\": \"\",\n                dark: \"\",\n                \"year-range\": [_unref(uniqueDays)[0]?.getFullYear(), _unref(uniqueDays)[_unref(uniqueDays).length - 1]?.getFullYear()],\n                \"six-weeks\": \"\"\n              }, {\n                \"action-buttons\": _withCtx(() => [\n                  _createElementVNode(\"button\", {\n                    class: \"dp__action_button dp__action-latest\",\n                    onClick: _cache[0] || (_cache[0] = () => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1]),\n                    onKeyup: _cache[1] || (_cache[1] = _withKeys(() => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1], [\"enter\"])),\n                    disabled: _unref(singleDateSelected) === _unref(uniqueDays)[_unref(uniqueDays).length - 1],\n                    elevation: \"0\",\n                    size: \"sm\"\n                  }, \" Latest \", 40, _hoisted_5)\n                ]),\n                _: 1\n              }, 8, [\"model-value\", \"allowed-dates\", \"formats\", \"year-range\"])\n            ]),\n            _: 1\n          }, 8, [\"modelValue\"])\n        ]),\n        _createElementVNode(\"div\", _hoisted_6, [\n          _createVNode(_component_v_tooltip, {\n            disabled: _unref(touchscreen),\n            text: \"Previous Date\"\n          }, {\n            activator: _withCtx(({ props }) => [\n              _createVNode(_component_v_btn, _mergeProps(props, {\n                class: \"rounded-icon-wrapper\",\n                onClick: _unref(store).moveBackwardOneDay,\n                onKeyup: _withKeys(_unref(store).moveBackwardOneDay, [\"enter\"]),\n                disabled: _unref(singleDateSelected) === _unref(uniqueDays)[0],\n                color: \"#009ade\",\n                variant: \"outlined\",\n                elevation: \"0\",\n                size: \"md\"\n              }), {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_icon, null, {\n                    default: _withCtx(() => [...(_cache[7] || (_cache[7] = [\n                      _createTextVNode(\"mdi-chevron-double-left\", -1)\n                    ]))]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              }, 16, [\"onClick\", \"onKeyup\", \"disabled\"])\n            ]),\n            _: 1\n          }, 8, [\"disabled\"]),\n          _createVNode(_component_v_spacer),\n          _createVNode(_component_v_tooltip, {\n            disabled: _unref(touchscreen),\n            text: \"Get Data for latest available day\"\n          }, {\n            activator: _withCtx(({ props }) => [\n              _createVNode(_component_v_btn, _mergeProps(props, {\n                style: {\"padding-inline\":\"4px\"},\n                onClick: _cache[4] || (_cache[4] = () => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1]),\n                onKeyup: _cache[5] || (_cache[5] = _withKeys(() => singleDateSelected.value = _unref(uniqueDays)[_unref(uniqueDays).length - 1], [\"enter\"])),\n                disabled: _unref(singleDateSelected) === _unref(uniqueDays)[_unref(uniqueDays).length - 1],\n                color: \"#009ade\",\n                variant: \"outlined\",\n                elevation: \"0\",\n                size: \"md\"\n              }), {\n                default: _withCtx(() => [...(_cache[8] || (_cache[8] = [\n                  _createTextVNode(\" Latest Available Data \", -1)\n                ]))]),\n                _: 1\n              }, 16, [\"disabled\"])\n            ]),\n            _: 1\n          }, 8, [\"disabled\"]),\n          _createVNode(_component_v_spacer),\n          _createVNode(_component_v_tooltip, {\n            disabled: _unref(touchscreen),\n            text: \"Next Date\"\n          }, {\n            activator: _withCtx(({ props }) => [\n              _createVNode(_component_v_btn, _mergeProps(props, {\n                class: \"rounded-icon-wrapper\",\n                onClick: _unref(store).moveForwardOneDay,\n                onKeyup: _withKeys(_unref(store).moveForwardOneDay, [\"enter\"]),\n                disabled: _unref(singleDateSelected) === _unref(uniqueDays)[_unref(uniqueDays).length - 1],\n                color: \"#009ade\",\n                variant: \"outlined\",\n                elevation: \"0\",\n                size: \"md\"\n              }), {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_icon, null, {\n                    default: _withCtx(() => [...(_cache[9] || (_cache[9] = [\n                      _createTextVNode(\"mdi-chevron-double-right\", -1)\n                    ]))]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              }, 16, [\"onClick\", \"onKeyup\", \"disabled\"])\n            ]),\n            _: 1\n          }, 8, [\"disabled\"])\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_7, [\n        _createVNode(_component_v_select, {\n          modelValue: _unref(selectedTimezone),\n          \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => (_isRef(selectedTimezone) ? (selectedTimezone).value = $event : null)),\n          class: \"map-dropdowns timezone-dropdown\",\n          label: \"Timezone\",\n          items: _unref(timezoneOptions),\n          \"item-title\": \"name\",\n          \"item-value\": \"tz\",\n          \"hide-details\": \"\",\n          dense: \"\",\n          variant: \"outlined\"\n        }, null, 8, [\"modelValue\", \"items\"])\n      ])\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"map-view\">\n    <h2>Explore Map View</h2>\n    <p class=\"my-2\">Select a date and timezone to display</p>\n    <div class=\"map-view-controls\">\n      <div class=\"date-view-controls mt-2\">\n        <div class=\"d-flex flex-row align-center\">\n          <v-radio-group v-model=\"radio\">\n            <date-picker\n              class=\"cds__date-picker tall\"\n              ref=\"calendar\"\n              :model-value=\"singleDateSelected\"\n              @internal-model-change=\"(value: Date) => {\n                if (value != null && value.getTime() != singleDateSelected.getTime()) {\n                  radio = null;\n                  singleDateSelected = value;\n                  calendar?.closeMenu();\n                }\n              }\"\n              :allowed-dates=\"uniqueDays\"\n              :input-atters=\"{clearable: false}\"\n              :time-config=\"{ enableTimePicker: false }\"\n              :multi-dates=\"false\"\n              :transitions=\"false\"\n              :formats=\"{'input': (date: Date | null) => date?.toDateString(), 'preview': (date: Date | null) => date?.toDateString()}\"\n              :week-start=\"0\"\n              no-today\n              dark\n              :year-range=\"[uniqueDays[0]?.getFullYear(), uniqueDays[uniqueDays.length - 1]?.getFullYear()]\"\n              six-weeks\n            >\n              <template #action-buttons>\n                <button\n                  class=\"dp__action_button dp__action-latest\"\n                  @click=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n                  @keyup.enter=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n                  :disabled=\"singleDateSelected === uniqueDays[uniqueDays.length - 1]\"\n                  elevation=\"0\"\n                  size=\"sm\"\n                >\n                  Latest\n              </button>\n              </template>\n              <!-- <template #action-extra=\"{ selectCurrentDate }\">\n              \n              </template> -->\n            </date-picker>\n            <!-- time chips to select time specifically for esri times -->\n          </v-radio-group>\n        </div>        \n        <!-- add buttons to increment and decrement the singledateselected -->\n        <div class=\"d-flex flex-row align-center my-2\">\n          <v-tooltip :disabled=\"touchscreen\" text=\"Previous Date\">\n            <template v-slot:activator=\"{ props }\">\n              <v-btn\n                v-bind=\"props\"\n                class=\"rounded-icon-wrapper\"\n                @click=\"store.moveBackwardOneDay\"\n                @keyup.enter=\"store.moveBackwardOneDay\"\n                :disabled=\"singleDateSelected === uniqueDays[0]\"\n                color=\"#009ade\"\n                variant=\"outlined\"\n                elevation=\"0\"\n                size=\"md\"\n              >\n                <v-icon>mdi-chevron-double-left</v-icon>\n              </v-btn>\n            </template>\n          </v-tooltip>\n          <v-spacer></v-spacer>\n          <v-tooltip :disabled=\"touchscreen\" text=\"Get Data for latest available day\">\n            <template v-slot:activator=\"{ props }\">\n              <v-btn\n                v-bind=\"props\"\n                style=\"padding-inline: 4px;\"\n                @click=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n                @keyup.enter=\"() => singleDateSelected = uniqueDays[uniqueDays.length - 1]\"\n                :disabled=\"singleDateSelected === uniqueDays[uniqueDays.length - 1]\"\n                color=\"#009ade\"\n                variant=\"outlined\"\n                elevation=\"0\"\n                size=\"md\"\n              >\n                Latest Available Data\n              </v-btn>\n            </template>\n          </v-tooltip>\n          <v-spacer></v-spacer>\n          <v-tooltip :disabled=\"touchscreen\" text=\"Next Date\">\n            <template v-slot:activator=\"{ props }\">\n              <v-btn\n                v-bind=\"props\"\n                class=\"rounded-icon-wrapper\"\n                @click=\"store.moveForwardOneDay\"\n                @keyup.enter=\"store.moveForwardOneDay\"\n                :disabled=\"singleDateSelected === uniqueDays[uniqueDays.length - 1]\"\n                color=\"#009ade\"\n                variant=\"outlined\"\n                elevation=\"0\"\n                size=\"md\"\n              >\n                <v-icon>mdi-chevron-double-right</v-icon>\n              </v-btn>\n            </template>\n          </v-tooltip>\n        </div>\n      </div>\n      <div class=\"map-dropdown-container d-flex flex-row flex-wrap\">\n        <v-select\n          v-model=\"selectedTimezone\"\n          class=\"map-dropdowns timezone-dropdown\"\n          label=\"Timezone\"\n          :items=\"timezoneOptions\"\n          item-title=\"name\"\n          item-value=\"tz\"\n          hide-details\n          dense\n          variant=\"outlined\"\n        ></v-select>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch } from \"vue\";\nimport { storeToRefs } from \"pinia\";\nimport { VueDatePicker } from \"@vuepic/vue-datepicker\";\nimport { supportsTouchscreen } from \"@cosmicds/vue-toolkit\";\n\nimport { type MoleculeType } from \"@/esri/utils\";\nimport { useTempoStore } from \"@/stores/app\";\n// import { useEsriTimesteps } from \"@/composables/useEsriTimesteps\";\n\n// import TimeChips from \"@/components/TimeChips.vue\";\n\nconst store = useTempoStore();\nconst {\n  singleDateSelected,\n  uniqueDays,\n  selectedTimezone,\n  timezoneOptions,\n} = storeToRefs(store);\n\nconst emit = defineEmits<{\n  (event: \"molecule\", molecule: MoleculeType): void;\n}>();\n\nconst molecule = ref<MoleculeType>('no2');\n\nconst radio = ref<number | null>(null);\nconst touchscreen = supportsTouchscreen();\n\nconst calendar = ref<typeof VueDatePicker | null>(null);\n\n\nwatch(molecule, (newMol: MoleculeType) => {\n  emit(\"molecule\", newMol);\n});\n</script>\n\n<style lang=\"less\">\n\n.map-view {\n  margin: 1rem;\n}\n\n.map-view-controls {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: 1rem;\n}\n\n.date-view-controls {\n  flex: 0 0 auto; /* Don't shrink, don't grow, auto width */\n  min-width: 220px; /* Minimum width before parent wraps */\n}\n\n.cds__date-picker .tall {\n  height: 58px;\n}\n\n.map-dropdown-container {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: 1rem;\n  flex: 1 1 210px; \n\n  .map-dropdowns {\n\n    font-family: var(--dp-font-family);\n    height: 56px !important;\n\n    .v-field--variant-outlined .v-field__outline__start, .v-field--variant-outlined .v-field__outline__end {\n      border-color: rgba(255, 255, 255, 0.7);\n      opacity: 1;\n    }\n\n    .v-field--variant-outlined .v-field__outline__notch {\n      border-bottom: solid 1px rgba(255, 255, 255, 0.7);\n    }\n\n    .v-field--variant-outlined .v-field__outline__notch::after {\n      border-bottom: solid 1px rgba(255, 255, 255, 0.6);\n    }\n\n    &.timezone-dropdown {\n      width: 220px !important;\n      max-width: 220px !important;\n    }\n\n    &.molecule-dropdown {\n      width: 220px !important;\n      max-width: 220px !important;\n    }\n\n  }\n}\n\n</style>\n","import script from \"./MapControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapControls.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapControls.vue?vue&type=style&index=0&id=5f4dd346&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import {Ref, ref, watch} from 'vue';\nimport M, {Marker} from 'maplibre-gl';\nimport { LatLngPair } from '@/types';\n\n\nexport interface MaplibreLocationMarker {\n  locationMarker: Ref<M.Marker | null>;\n  setMarker: (latlng: LatLngPair) => void;\n  removeMarker: () => void;\n  showLocationMarker: Ref<boolean>;\n}\n\nexport function useLocationMarker( map: Ref<M.Map | null>, show: boolean): MaplibreLocationMarker {\n  \n  const showLocationMarker = ref(show);\n  const locationMarker = ref<null | Marker>(null);\n  \n  \n  const addToMap = () => {\n    if (locationMarker.value !== null && map.value !== null) {\n      locationMarker.value.addTo(map.value);\n    }\n  };\n  \n  function setMarker(latlng: LatLngPair) {\n    if (!map.value) return ;\n    \n    const lnglat = [latlng[1], latlng[0]] as M.LngLatLike;\n    \n    if (locationMarker.value == null) {\n      \n      locationMarker.value = new M.Marker()\n        .setLngLat(lnglat);\n      \n    } else {\n      locationMarker.value.setLngLat(lnglat);\n    }\n    \n    if (showLocationMarker.value) {\n      addToMap();\n    }\n  }\n  \n  function removeMarker() {\n    locationMarker.value?.remove();\n  }\n  \n  watch(showLocationMarker, (show: boolean) => {\n    if (show) {\n      addToMap();\n    } else {\n      removeMarker();\n    }\n  });\n  \n  return {\n    locationMarker: locationMarker as Ref<M.Marker | null>,\n    setMarker,\n    removeMarker,\n    showLocationMarker\n  };\n}\n","import { onMounted, onUnmounted, toRef, watch } from \"vue\";\nimport { Map, MapMouseEvent } from \"maplibre-gl\";\n\nimport { UseSelectionOptions } from \"../../types\";\n\nexport function baseUseSelection<SelectionInfo>(\n  options: UseSelectionOptions<Map, MapMouseEvent, SelectionInfo>,\n) {\n\n  const { map, handler } = options;\n  const active = toRef(options.active ?? false);\n\n  onMounted(() => {\n    const mMap = map.value;\n    if (active.value && mMap) {\n      updateListeners(mMap, active.value);\n    }\n  });\n\n  function updateListeners(map: Map, active: boolean) {\n    if (active) {\n      map.dragPan.disable();\n      map.scrollZoom.disable();\n      if (handler.onMousedown) {\n        map.on(\"mousedown\", handler.onMousedown);\n      }\n      if (handler.onMouseup) {\n        map.on(\"mouseup\", handler.onMouseup);\n      }\n      if (handler.onMousemove) {\n        map.on(\"mousemove\", handler.onMousemove);\n      }\n    } else {\n      map.dragPan.enable();\n      map.scrollZoom.enable();\n      if (handler.onMousedown) {\n        map.off(\"mousedown\", handler.onMousedown);\n      }\n      if (handler.onMouseup) {\n        map.off(\"mouseup\", handler.onMouseup);\n      }\n      if (handler.onMousemove) {\n        map.off(\"mousemove\", handler.onMousemove);\n      }\n    }\n  }\n\n  watch(active, (nowActive: boolean) => {\n    const mMap = map.value;\n    if (mMap !== null) {\n      updateListeners(mMap, nowActive);\n      mMap.getCanvas().style.cursor = nowActive ? 'crosshair' : '';\n    }\n  });\n\n  // If we're going to take in the map as a ref,\n  // we might as well update if its value does\n  watch(map, (newMap: Map | null) => {\n    if (newMap !== null) {\n      updateListeners(newMap, active.value);\n    }\n  });\n\n  onUnmounted(() => {\n    // The map will probably be destroyed along with the component using this composable\n    // But if not, we should remove handlers\n    const mMap = map.value;\n    if (mMap !== null && active.value) {\n      updateListeners(mMap, false);\n    }\n  });\n\n  return {\n    active,\n    selectionInfo: handler.selectionInfo,\n  };\n\n}\n","import { ref, type MaybeRef, type Ref } from \"vue\";\nimport { GeoJSONSource, LngLat, Map, MapMouseEvent } from \"maplibre-gl\";\nimport { v4 } from \"uuid\";\n\nimport type { RectangleSelectionInfo, SelectionHandler } from \"../../types\";\nimport type { LayerType } from \"./utils\";\nimport { baseUseSelection } from \"./baseUseSelection\";\n\n\nexport function useRectangleSelection(\n  map: Ref<Map | null>,\n  interactColor: string = \"yellow\",\n  active: MaybeRef<boolean>,\n) {\n\n  let rectangleSource: GeoJSONSource | null = null;\n  let rectangleLayer: LayerType | undefined = undefined;\n  let startCoords: LngLat | null = null;\n  let geoJson: GeoJSON.FeatureCollection;\n  const uuid = v4();\n\n  const handler: SelectionHandler<MapMouseEvent, RectangleSelectionInfo> = {\n\n    selectionInfo: ref<RectangleSelectionInfo | null>(null),\n\n    onMousedown(event: MapMouseEvent) {\n      const mMap = map.value;\n      if (!mMap) {\n        return;\n      }\n\n      startCoords = event.lngLat;\n      geoJson = {\n        type: \"FeatureCollection\",\n        features: [{\n          type: \"Feature\",\n          geometry: {\n            type: \"Polygon\",\n            coordinates: [[\n              [startCoords.lng, startCoords.lat],\n              [startCoords.lng, startCoords.lat],\n              [startCoords.lng, startCoords.lat],\n              [startCoords.lng, startCoords.lat],\n            ]],\n          },\n          properties: {},\n        }],\n      };\n\n      mMap.addSource(uuid, {\n        type: \"geojson\",\n        data: geoJson,\n      });\n\n      const source = mMap.getSource(uuid);\n      if (!source) {\n        return;\n      }\n\n      rectangleSource = source as GeoJSONSource;\n\n      mMap.addLayer({\n        id: uuid,\n        type: \"line\",\n        source: uuid,\n        paint: {\n          \"line-color\": interactColor,\n          \"line-width\": 2,\n          \"line-dasharray\": [2, 1],\n        }\n      });\n\n      const layer = mMap.getLayer(uuid);\n      if (layer) {\n        rectangleLayer = layer;\n      }\n    },\n\n    onMouseup(event: MapMouseEvent) {\n      const mMap = map.value;\n      if (!mMap || startCoords === null) {\n        return;\n      }\n\n      const eventCoords = event.lngLat;\n      handler.selectionInfo.value = {\n        xmin: Math.min(startCoords.lng, eventCoords.lng),\n        ymin: Math.min(startCoords.lat, eventCoords.lat),\n        xmax: Math.max(startCoords.lng, eventCoords.lng),\n        ymax: Math.max(startCoords.lat, eventCoords.lat),\n      };\n\n      if (rectangleLayer) {\n        mMap.removeLayer(rectangleLayer.id);\n      }\n      if (rectangleSource) {\n        mMap.removeSource(rectangleSource.id);\n      }\n      startCoords = null;\n\n    },\n\n    onMousemove(event: MapMouseEvent) {\n      const mMap = map.value;\n      if (!mMap || (startCoords === null) || (!geoJson)) {\n        return;\n      }\n\n      const eventCoords = event.lngLat;\n      const coordinates = [[\n        [startCoords.lng, startCoords.lat],\n        [eventCoords.lng, startCoords.lat],\n        [eventCoords.lng, eventCoords.lat],\n        [startCoords.lng, eventCoords.lat],\n        [startCoords.lng, startCoords.lat],\n      ]];\n\n      geoJson.features[0] = {\n        ...geoJson.features[0],\n        geometry: {\n          type: \"Polygon\",\n          coordinates,\n        }\n      };\n\n      rectangleSource?.setData(geoJson);\n    }\n  };\n\n  return baseUseSelection({ map, handler, active });\n\n}\n","import { GeoJSONSource, LngLatBoundsLike, Map } from \"maplibre-gl\";\nimport { v4 } from \"uuid\";\n\nimport { RectangleSelectionInfo, PointSelectionInfo, UnifiedRegion } from \"../../types\";\n\nconst layerGetter = (m: Map, id: string) => m.getLayer(id);\nexport type LayerType = Exclude<ReturnType<typeof layerGetter>, undefined>;\n\nfunction createBounds(info: RectangleSelectionInfo) {\n  return [\n    [info.xmin, info.ymin],\n    [info.xmax, info.ymin],\n    [info.xmax, info.ymax],\n    [info.xmin, info.ymax],\n    [info.xmin, info.ymin],\n  ];\n}\n\n\nexport function addRectangleLayer(\n  map: Map,\n  info: RectangleSelectionInfo,\n  color: string,\n  opacity=0.7,\n  visible=true,\n) {\n\n  const uuid = v4();\n  const geoJson: GeoJSON.FeatureCollection = {\n    type: \"FeatureCollection\",\n    features: [{\n      type: \"Feature\",\n      geometry: {\n        type: \"Polygon\",\n        coordinates: [\n          createBounds(info),\n        ],\n      },\n      properties: {},\n    }],\n  };\n\n  map.addSource(uuid, {\n    type: \"geojson\",\n    data: geoJson,\n  });\n  const source = map.getSource(uuid) as GeoJSONSource;\n\n  map.addLayer({\n    id: uuid,\n    type: \"fill\",\n    source: uuid,\n    paint: {\n      \"fill-color\": color,\n      \"fill-opacity\": opacity,\n    },\n    layout: {\n      visibility: visible ? \"visible\" : \"none\",\n    }\n  });\n\n  return { layer: source };\n}\n\nexport function updateRectangleBounds(\n  source: GeoJSONSource,\n  info: RectangleSelectionInfo,\n) {\n  source.getData().then(data => {\n    const geoJson = data as GeoJSON.FeatureCollection;\n    geoJson.features[0] = {\n      ...geoJson.features[0],\n      geometry: {\n        type: \"Polygon\",\n        coordinates: [createBounds(info)],\n      }\n    };\n\n    source.setData(geoJson);\n  });\n}\n\nexport function removeRectangleLayer(\n  map: Map,\n  layer: LayerType,\n) {\n  map.removeLayer(layer.id);\n  map.removeSource(layer.id);\n}\n\n// Point layer utilities\nexport function addPointLayer(\n  map: Map,\n  info: PointSelectionInfo,\n  color: string,\n  visible=true,\n) {\n  const uuid = v4();\n  const geoJson: GeoJSON.FeatureCollection = {\n    type: \"FeatureCollection\",\n    features: [{\n      type: \"Feature\",\n      geometry: {\n        type: \"Point\",\n        coordinates: [info.x, info.y],\n      },\n      properties: {},\n    }],\n  };\n\n  map.addSource(uuid, {\n    type: \"geojson\",\n    data: geoJson,\n  });\n  const source = map.getSource(uuid) as GeoJSONSource;\n\n  map.addLayer({\n    id: uuid,\n    type: \"circle\",\n    source: uuid,\n    paint: {\n      \"circle-radius\": 8,\n      \"circle-color\": color,\n      \"circle-stroke-color\": \"white\",\n      \"circle-stroke-width\": 2,\n    },\n    layout: {\n      visibility: visible ? \"visible\" : \"none\",\n    }\n  });\n\n  return { layer: source };\n}\n\nexport function updatePointLocation(\n  source: GeoJSONSource,\n  info: PointSelectionInfo,\n) {\n  source.getData().then(data => {\n    const geoJson = data as GeoJSON.FeatureCollection;\n    geoJson.features[0] = {\n      ...geoJson.features[0],\n      geometry: {\n        type: \"Point\",\n        coordinates: [info.x, info.y],\n      }\n    };\n    source.setData(geoJson);\n  });\n}\n\nexport function removePointLayer(\n  map: Map,\n  layer: LayerType,\n) {\n  map.removeLayer(layer.id);\n  map.removeSource(layer.id);\n}\n\nexport function regionBounds(region: UnifiedRegion): [[number, number], [number, number]] {\n  const pointPadding = 1;\n  return region.geometryType == \"rectangle\" ?\n    [[region.geometryInfo.xmin, region.geometryInfo.ymin], [region.geometryInfo.xmax, region.geometryInfo.ymax]] :\n    [[region.geometryInfo.x - pointPadding, region.geometryInfo.y - pointPadding], [region.geometryInfo.x + pointPadding, region.geometryInfo.y + pointPadding]];\n}\n\nexport function fitBounds(map: Map, bounds: LngLatBoundsLike, _fly: boolean) {\n  map.fitBounds(bounds);\n}\n","import { ref, type MaybeRef, type Ref } from \"vue\";\nimport { Map, MapMouseEvent } from \"maplibre-gl\";\n\nimport type { PointSelectionInfo, SelectionHandler } from \"../../types\";\nimport { baseUseSelection } from \"./baseUseSelection\";\n\nexport function usePointSelection(\n  map: Ref<Map | null>,\n  active: MaybeRef<boolean>,\n) {\n  \n  const handler: SelectionHandler<MapMouseEvent, PointSelectionInfo> = {\n    selectionInfo: ref<PointSelectionInfo | null>(null),\n\n    onMouseup(event: MapMouseEvent) {\n      handler.selectionInfo.value = {\n        x: event.lngLat.lng,\n        y: event.lngLat.lat,\n      };\n    },\n  };\n\n  return baseUseSelection({ map, handler, active });\n}\n","// https://davidmathlogic.com/colorblind \nexport const paulTolMutedColorblindSafeColors = ['#CC6677', '#332288', '#117733', '#882255', '#44aa99', '#999933', '#aa4499',];\nexport const wongColorblindSafeColors = ['#009E73', '#56B4E9', '#CC79A7', '#D55E00','#F0E442', '#0072B2', '#E69F00']; \n\nexport const COLORS = [\n  ...wongColorblindSafeColors,\n  ...paulTolMutedColorblindSafeColors,\n  '#e6194b', '#3cb44b', '#4363d8', '#911eb4', '#46f0f0',\n  '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff', '#9a6324', '#fffac8',\n  '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#808080', '#ffffff',\n  '#000000'\n];\n\n\nexport function contrastingColor(hexColor: string): string {\n  const h = hexColor.slice(1); // remove the #\n  const r = parseInt(h.substring(0, 2), 16) / 255.0;\n  const g = parseInt(h.substring(2, 4), 16) / 255.0;\n  const b = parseInt(h.substring(4, 6), 16) / 255.0;\n  // https://stackoverflow.com/questions/3942878/how-to-decide-font-color-in-white-or-black-depending-on-background-color\n  const c = (v: number) => v <= 0.04045 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);\n  const lum = 0.2126 * c(r) + 0.7152 * c(g) + 0.0722 * c(b);\n  \n  // create a console log the previews the color choice as PREVIEW with background color the hexColor and text color the chosen contrasting color\n  console.log(`%c PREVIEW `, `background: ${hexColor}; color: ${lum > 0.179 ? '#000000' : '#FFFFFF'}`);\n\n  return lum > 0.179 ? '#000000' : '#FFFFFF';\n}","import { Ref } from 'vue';\nimport maplibregl from 'maplibre-gl';\n\nexport interface MultiMarkerOptions {\n  label?: string;\n  color?: string;\n  fillColor?: string;\n  fillOpacity?: number;\n  opacity?: number;\n  radius?: number;\n  outlineColor?: string;\n  paint?: maplibregl.CircleLayerSpecification['paint'];\n  layout?: maplibregl.CircleLayerSpecification['layout'];\n  shape?: 'circle' | 'marker';\n  scale?: 'world' | 'screen';\n  visible?: boolean;\n}\n\n\nconst DEG_DEFAULT = 0.05; // example default: 0.05\nconst PX_DEFAULT  = 8;\n\n  \nfunction toGeoJSON(points: Array<{ x: number; y: number }>, radius_deg?: number): GeoJSON.FeatureCollection<GeoJSON.Point> {\n  return {\n    type: 'FeatureCollection',\n    features: points.map(pt => ({\n      type: 'Feature',\n      geometry: { type: 'Point', coordinates: [pt.x, pt.y] } as GeoJSON.Point,\n      properties: {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        radius_deg: radius_deg ?? DEG_DEFAULT,\n        // the below are unused, but useful if we want something different in the future\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        radius_px: PX_DEFAULT,\n        lat: pt.y,\n        lon: pt.x,\n      },\n    })),\n  };\n}\n\nexport function useMultiMarker(map: Ref<maplibregl.Map | null>, options: MultiMarkerOptions = {}) {\n  const sourceId = `${options.label ?? 'multi-marker'}-source`;\n  const layerId = `${options.label ?? 'multi-marker'}-layer`;\n  \n  options.scale = options.scale ?? 'screen';\n  \n  function optionsToPaint() {\n    return {\n      // 'circle-radius': options.radius ?? 8,\n      'circle-color': options.fillColor ?? options.color ?? '#ff0000',\n      'circle-opacity': options.fillOpacity ?? options.opacity ?? 0.8,\n      'circle-stroke-color': options.outlineColor ?? options.color ?? '#000',\n      'circle-stroke-width': 2\n    };\n  }\n\n  function addMarkers(points: Array<{ x: number; y: number }>) {\n    if (!map.value) return;\n    clearMarkers();\n    const geojson = toGeoJSON(points, options.scale === 'world' ? (options.radius ?? DEG_DEFAULT) : options.radius ?? PX_DEFAULT);\n    if (map.value.getSource(sourceId)) {\n      (map.value.getSource(sourceId) as maplibregl.GeoJSONSource).setData(geojson);\n    } else {\n      map.value.addSource(sourceId, {\n        type: 'geojson',\n        data: geojson,\n      });\n    }\n    if (!map.value.getLayer(layerId)) {\n      \n      const paint = {\n        ...optionsToPaint(),\n        ...(options.paint ?? {}),\n      };\n      \n      if (options.scale === 'screen') {\n        paint['circle-radius'] = options.radius ?? PX_DEFAULT;\n        paint['circle-pitch-scale'] = 'viewport'; // stays in screen pixels even when pitched\n      } else {\n        // use a maplibre expression to avoid js handlers. https://maplibre.org/maplibre-style-spec/expressions/#zoom\n\n        // conversion from degrees to pixels at equator at zoom = 0\n        // Explanation: at zoom = 0\n        // 360 degrees = 256 pixels @ equator. we will ignore latitude scaling.\n        // to include latitude scaling, multiply radius by cos(lat) where lat is in radians\n        // after testing, a slightly smaller factor seems to work better visually\n        const degreeToPixel = 512 / 360; // typically we would use 256 but maplibre-gl uses 2x the resolution\n        \n        paint['circle-radius'] = [\n          // pixel scale is dependent on zoom ~ 2^zoom\n          // https://leafletjs.com/examples/zoom-levels/ (zoom explainer from leaflet)\n          'interpolate', ['exponential', 2], ['zoom'],\n          // at zoom = 0, the pixel radius = radius in degrees * K\n          0,  ['*', ['get', 'radius_deg'], degreeToPixel],\n          // at zoom = 24  (or whatever max zoom your style uses)\n          24, ['*', ['get', 'radius_deg'], degreeToPixel * Math.pow(2, 24)]\n        ];\n        paint['circle-pitch-scale'] = 'viewport'; // stays in screen pixels even when pitched\n      }\n      \n      \n      \n      const visible = options.visible ?? true;\n      map.value.addLayer({\n        id: layerId,\n        type: 'circle',\n        source: sourceId,\n        paint: paint,\n        layout: options.layout ?? {\n          visibility: visible ? \"visible\" : \"none\",\n        },\n      } as maplibregl.CircleLayerSpecification);\n    }\n  }\n\n  function clearMarkers() {\n    if (!map.value) return;\n    if (map.value.getLayer(layerId)) {\n      map.value.removeLayer(layerId);\n    }\n    if (map.value.getSource(sourceId)) {\n      map.value.removeSource(sourceId);\n    }\n  }\n\n  return { addMarkers, clearMarkers };\n}\n","import type { Map } from \"maplibre-gl\";\n//\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction isNumeric(value: any): boolean {\n  return !isNaN(value - parseFloat(value));\n}\n\nexport function setLayerOpacity(map: Map, layerId: string, opacity: number) {\n  const layer = map.getLayer(layerId);\n  if (!layer) {\n    console.warn('Layer not found:', layerId);\n    return;\n  }\n\n  if (layer.type !== 'symbol') {\n    const paintProp = `${layer.type}-opacity`;\n    map.setPaintProperty(layerId, paintProp, opacity);\n  }\n  if (layer.type === 'circle') {\n    if (map.getPaintProperty(layerId, 'circle-opacity') !== undefined) {\n      map.setPaintProperty(layerId, 'circle-stroke-opacity', opacity);\n    }\n  }  \n  if (layer.type === 'symbol') {\n    // icon-opacity\n    if (map.getPaintProperty(layerId, 'icon-opacity') !== undefined) {\n      map.setPaintProperty(layerId, 'icon-opacity', opacity);\n    }\n    // text-opacity\n    if (map.getPaintProperty(layerId, 'text-opacity') !== undefined) {\n      map.setPaintProperty(layerId, 'text-opacity', opacity);\n    }\n  }\n}\n\nexport function getLayerOpacity(map: Map, layerId: string): number {\n  const layer = map.getLayer(layerId);\n  if (!layer) return 1;\n  \n  let op: unknown = 1;\n  \n  if (layer.type === 'symbol') {\n    op = map.getPaintProperty(layerId, 'icon-opacity');\n    if (isNaN(op as unknown as number)) {\n      op = map.getPaintProperty(layerId, 'text-opacity');\n    }\n  } else if (layer.type === 'circle') {\n    op = map.getPaintProperty(layerId, 'circle-opacity');\n    if (isNaN(op as unknown as number)) {\n      op = map.getPaintProperty(layerId, 'circle-stroke-opacity');\n    }\n  } else {\n    const paintProp = `${layer.type}-opacity`;\n    op = map.getPaintProperty(layerId, paintProp);\n  }\n  \n  return isNumeric(op) ? (op as unknown as number) : 1;\n} \n\nexport function getLayerVisibility(map: Map, layerId: string): boolean {\n  if (!map.getLayer(layerId)) {\n    return false;\n  }\n  // NB: If this hasn't been explicitly set yet, the layer is visible but the\n  // value returned by `getLayoutProperty` is undefined, so we can't do `=== \"visible\"`\n  return map.getLayoutProperty(layerId, \"visibility\") !== \"none\";\n}\n\nexport function setLayerVisibility(map: Map, layerId: string, visible: boolean) {\n  if (!map.getLayer(layerId)) {\n    return;\n  }\n  map.setLayoutProperty(\n    layerId,\n    \"visibility\",\n    visible ? \"visible\" : \"none\",\n  );\n}\n","import { Ref, ref, onMounted, onUnmounted } from 'vue';\nimport M, { Map, AttributionControl } from 'maplibre-gl';\nimport { InitMapOptions, LatLngPair } from '@/types';\n\n\nconst scale = window.devicePixelRatio;\nconst retinaParam = scale > 1 ? '@2x' : '';\n\nexport interface MapLibreComposable {\n    map: Ref<M.Map | null>;\n    createMap: () => Ref<M.Map>;\n    setView: (latlng: LatLngPair, zoom: number) => void;\n    resetView: () => void;\n    cleanupMap: () => void;\n    getCenter: () => M.LngLat;\n  }\n  \n\n  \nexport function useMap(id=\"map\", options: InitMapOptions, _showRoads: Ref<boolean>, onReady?: (map: M.Map) => void): MapLibreComposable {\n  // Something to know about MatLibre it likes longitude, latitude as opposed\n  // to leaflet which uses latitude, longitude\n  // this is where our map will be\n  const map = ref<M.Map | null>(null);\n  \n  async function addStates(map: M.Map) {\n    fetch(\"states.geojson\")\n      .then(response => response.json())\n      .then(data => {\n        map.addSource('states-custom', {\n          'type': 'geojson',\n          'data': data\n        });\n        map.addLayer({\n          'id': 'states-custom',\n          'type': 'line',\n          'source': 'states-custom',\n          'paint': {\n            'line-color': 'black',\n            'line-width': 0.5,\n            'line-opacity': 0.8,\n          }\n        });\n      });\n  }\n  \n  async function addCoastlines(map: M.Map) {\n    fetch(\"coastlines.geojson\")\n      .then(response => response.json())\n      .then(data => {\n        map.addSource('coastline-custom', {\n          'type': 'geojson',\n          'data': data\n        });\n        map.addLayer({\n          'id': 'coastline-custom',\n          'type': 'line',\n          'source': 'coastline-custom',\n          'maxzoom': 5,\n          'paint': {\n            'line-color': 'black',\n            'line-width': 1,\n            'line-opacity': 0.8,\n          }\n        });\n      });\n  }\n\n  function addRoads(map: M.Map) {\n    map.addSource('stamen-toner-lines', {\n      type: 'raster',\n      tiles: [`https://tiles.stadiamaps.com/tiles/stamen_toner_lines/{z}/{x}/{y}${retinaParam}.png`],\n      tileSize: 256,\n    });\n    \n    map.addLayer({\n      id: 'stamen-toner-lines',\n      type: 'raster',\n      source: 'stamen-toner-lines',\n      minzoom: 0,\n      maxzoom: 20,\n      \n    });\n    \n    // Ensure labels are on top\n    map.moveLayer('stamen-toner-lines');\n  } \n  \n  \n  function addLabels(map: M.Map) {\n    map.addSource('stamen-toner-labels', {\n      type: 'raster',\n      tiles: [`https://tiles.stadiamaps.com/tiles/stamen_toner_labels/{z}/{x}/{y}${retinaParam}.png`],\n      tileSize: 256,\n    });\n\n    map.addLayer({\n      id: 'stamen-toner-labels',\n      type: 'raster',\n      source: 'stamen-toner-labels',\n      minzoom: 0,\n      maxzoom: 20\n    });\n    \n    map.moveLayer('stamen-toner-labels');\n  }\n  \n  function setupMap() {\n    if (map.value === null) return;\n    \n    // Need to use weird type assertion to avoid\n    // Type instantiation is excessively deep and possibly infinite.ts(2589)\n    // See discussion here https://github.com/mapbox/mapbox-gl-js/issues/13203#issuecomment-2634013147\n    const libreMap = map.value as unknown as M.Map;\n    \n\n    // libreMap.setProjection({\n    //   type: 'globe' // This activates the 3D globe view\n    // });\n\n    addCoastlines(libreMap);\n    addStates(libreMap);\n    addRoads(libreMap);\n    addLabels(libreMap);\n    \n    \n    if (onReady !== undefined) {\n      onReady(libreMap);\n    }\n  }\n\n  function cleanupMap() {\n    if (map.value) {\n      map.value.remove();\n      map.value = null;\n    }\n  }\n  \n  // { MapLibre Demo Tiles\n  //   container: id,\n  //   style: 'https://demotiles.maplibre.org/style.json', // style URL\n  //   center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n  //   zoom: options.zoom ?? 1 // starting zoom\n  // }\n  \n  // { \n  //   container: id,\n  //   style: 'https://tiles.openfreemap.org/styles/liberty', // style URL\n  //   center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n  //   zoom: options.zoom ?? 1, // starting zoom,\n  //   attributionControl: false\n  // }\n  \n  // { CartoDB Positron\n  //   container: id,\n  //   style: 'https://{s}.basemaps.cartocdn.com/mapboxgl/style_tpl.json', // style URL\n  //   center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n  //   zoom: options.zoom ?? 1 // starting zoom\n  // }  \n  // https://github.com/CartoDB/basemap-styles other \"basemap\" styles\n  function createMap(): Ref<M.Map> {\n    const _map = new M.Map({\n      container: id,\n      // style: 'https://tiles.openfreemap.org/styles/liberty', // style URL\n      style: 'https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json',\n      center: options.loc ? [options.loc[1], options.loc[0]] : [0, 0], // starting position [lng, lat]\n      zoom: options.zoom ?? 1, // starting zoom,\n      attributionControl: false,\n      \n    }).addControl(new AttributionControl({\n      compact: true,\n    }));\n    \n    _map.on('style.load', setupMap);\n    \n    map.value = _map;\n    return map as unknown as Ref<M.Map>;\n  }\n\n  function setView(latlng: LatLngPair, zoom: number) {\n    if (map.value) {\n      map.value.setCenter([latlng[1], latlng[0]]);\n      map.value.setZoom(zoom);\n    }\n  }\n  \n  function getCenter() {\n    if (map.value) {\n      return map.value.getCenter();\n    }\n  }\n  \n  // function getZoom() {\n  //   if (map.value) {\n  //     return map.value.getZoom();\n  //   }\n  // }\n  \n  function resetView() {\n    if (map.value) {\n      setView(options.loc, options.zoom);\n    }\n  }\n  \n  onMounted(() => {\n    \n  });\n\n  onUnmounted(() => {\n    cleanupMap();\n  });\n\n  return {\n    map: map as Ref<M.Map | null>,\n    createMap,\n    setView,\n    resetView,\n    cleanupMap,\n    getCenter\n  } as MapLibreComposable;\n}\n","import { IControl, Map } from \"maplibre-gl\";\nimport { LngLatPair } from \"@/types\";\n\nexport class CDSMaplibreHomeTool implements IControl {\n  private _container: HTMLElement | undefined;\n  private _button: HTMLButtonElement | undefined;\n  private _homeIcon: HTMLImageElement | undefined;\n  private _map: Map | undefined;\n  private _centerLonLat: [number, number];\n  private _zoom: number;\n  private _onHome: CallableFunction;\n    \n  constructor(centerLonLat: LngLatPair, zoom: number, onHome: CallableFunction ) {\n    this._centerLonLat = centerLonLat;\n    this._zoom = zoom;\n    this._onHome = onHome;\n  }\n    \n  onAdd(map: Map): HTMLElement {\n    \n    this._map = map;\n    this._container = document.createElement('div');\n    this._container.className = 'maplibregl-ctrl maplibregl-ctrl-group maplibre-control-cds-home';\n    \n    this._button = document.createElement('button');\n    this._button.className = 'maplibregl-ctrl-icon maplibre-control-cds-home-button';\n    this._button.type = 'button';\n    this._button.title = 'Home';\n    this._button.addEventListener('click', this._goHome.bind(this));\n    \n    this._homeIcon = document.createElement('img');\n    this._homeIcon.style.padding = '5px';\n    // SVG icon from Font Awesome https://fontawesome.com/icons/house?f=classic&s=solid (free one)\n    const svg = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d=\"M575.8 255.5c0 18-15 32.1-32 32.1l-32 0 .7 160.2c0 2.7-.2 5.4-.5 8.1l0 16.2c0 22.1-17.9 40-40 40l-16 0c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1L416 512l-24 0c-22.1 0-40-17.9-40-40l0-24 0-64c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32 14.3-32 32l0 64 0 24c0 22.1-17.9 40-40 40l-24 0-31.9 0c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2l-16 0c-22.1 0-40-17.9-40-40l0-112c0-.9 0-1.9 .1-2.8l0-69.7-32 0c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z\"/></svg>';\n    this._homeIcon.src = `data:image/svg+xml,${encodeURIComponent(svg)}`;\n    \n    this._button.appendChild(this._homeIcon);\n    this._container.appendChild(this._button);\n    \n    return this._container;\n  }\n  \n  onRemove(): void {\n    // remove the event listener & element\n    this._container?.removeEventListener('click', this._goHome);\n    if (this._container && this._container.parentNode) {\n      this._container.parentNode.removeChild(this._container);\n    }\n  }\n  \n  _goHome() {\n    if (this._map) {\n      this._map.flyTo({\n        center: this._centerLonLat,\n        zoom: this._zoom\n      });\n      this._onHome();\n    }\n  }\n    \n    \n}","import { Ref, ref, watch } from 'vue';\nimport { Map, NavigationControl } from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\nimport { CDSMaplibreHomeTool } from './MaplibreHomeTool';\nimport { LatLngPair, LngLatPair } from '@/types';\n\nexport function usezoomhome(map: Ref<Map | null>, home: LatLngPair, zoom: number, callback: CallableFunction = () => null) {\n\n  const startingCenter = [home[1], home[0]] as LngLatPair;\n  const zoomHome: Ref<null | CDSMaplibreHomeTool> = ref(null);\n  \n\n  \n  function createControl() {\n    const control = new CDSMaplibreHomeTool(startingCenter, zoom, callback);\n    return control;\n  }\n  \n  \n  if (map.value !== null) {\n    map.value.addControl(new NavigationControl({showCompass: false}), 'top-left');\n    zoomHome.value = createControl();\n    map.value.addControl(zoomHome.value, 'top-left');\n  }\n  \n  watch(map, (newValue) => {\n    if (newValue !== null) {\n      newValue.addControl(new NavigationControl({showCompass: false}), 'top-left');\n      zoomHome.value = createControl();\n      newValue.addControl(zoomHome.value, 'top-left');\n    }\n  });\n  \n  \n  return zoomHome.value;\n\n}\n","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { renderSlot as _renderSlot, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\n\nimport { ref, watch, onMounted, onBeforeUnmount } from \"vue\";\nimport { LatLngPair, InitMapOptions } from \"@/types\";\nimport type { PropType } from 'vue';\nimport type { Map, MapEventType, Listener } from 'maplibre-gl';\nimport { useMap } from \"@/composables/maplibre/useMap\";\nimport { usezoomhome } from '@/composables/maplibre/useZoomHome';\n\n\n// should be using a defined Prop type and widthDefaults, but \n// i could not get that to work with the center (LatLngPair is a weird type)\n// but apparently the old options syntax is still good\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MaplibreMap',\n  props: /*@__PURE__*/_mergeModels({\n  mapID: {\n    type: String as PropType<string>,\n    required: true\n  },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions | null>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  }\n}, {\n    \"latitude\": {\n    default: 0\n  },\n    \"latitudeModifiers\": {},\n    \"longitude\": {\n    default: 0\n  },\n    \"longitudeModifiers\": {},\n    \"zoom\": {\n    default: 0\n  },\n    \"zoomModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"ready\", \"zoomhome\"], [\"update:latitude\", \"update:longitude\", \"update:zoom\"]),\n  setup(__props, { expose: __expose, emit: __emit }) {\n\nconst props = __props;\n\n// define model values that set and return the current map center and zoom\nconst latitude = _useModel<number>(\n  __props, 'latitude');\nconst longitude = _useModel<number>(\n  __props, 'longitude');\nconst zoom = _useModel<number>(\n  __props, 'zoom');\n\n\n\n\nconst showRoadsRef = ref(props.showRoads);\nwatch(() => props.showRoads, (value) => {\n  showRoadsRef.value = value;\n});\n\nconst emit = __emit;\n\n\n\n\n\n\nfunction attachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.on(evt, handler);\n  });\n}\n\nfunction detachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.off(evt, handler);\n  });\n}\n\nconst mapReady = ref(false);\n// https://stackoverflow.com/a/36072263/11594175\nlet promiseResolve: (value: Map) => void;\n// let promiseReject: (reason?: any) => void; // we won't use the reject\nconst whenMapReady: Promise<Map> = new Promise((resolve, _reject) => {\n  promiseResolve = resolve; /**   this is just javascript, so this pulls \n                                  the resolve function\n                                  out of the promise constructor and makes it \n                                  available for us to use\n                            **/\n  // promiseReject = reject;\n});\n\nconst onMapReady = (m: Map) => {\n  console.log(\"Map is ready\", m);\n  mapReady.value = true;\n  emit('ready', m);\n  promiseResolve(m);\n  attachAllEvents(m, props.events);\n};\n\nconst {\n  map,\n  createMap,\n  setView,\n  resetView,\n  getCenter,\n  cleanupMap\n} = useMap(props.mapID, props.initial ?? props.home, showRoadsRef, onMapReady);\n\nwatch(() => [latitude.value, longitude.value, zoom.value], ([newLat, newLng, newZoom]) => {\n  if (map.value && mapReady.value) {\n    setView([newLat, newLng] as LatLngPair, newZoom);\n  }\n});\n\nonMounted(() => {\n\n  const mMap = createMap(); // just use the return value instead of map.value. eases type checking\n  \n  usezoomhome(mMap, props.home.loc, props.home.zoom, () => {\n    emit('zoomhome');\n  });\n\n  mMap.value.on('moveend', () => {\n    if (map.value) {\n      const center = map.value.getCenter();\n      latitude.value = center.lat;\n      longitude.value = center.lng;\n      zoom.value = map.value.getZoom();\n    }\n  });\n  \n});\n\nonBeforeUnmount(() => {\n  if (map.value) {\n    detachAllEvents(map.value, props.events);\n    cleanupMap();\n  }\n});\n\n\n// provide only works downwards and i don't think we need it\n// const MAPLIBRE_PROVIDE_KEY = props.mapID;\n// provide(MAPLIBRE_PROVIDE_KEY, \nconst exposedMapApi = {\n  map,\n  setView,\n  resetView,\n  getCenter,\n  on: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.on(evt, handler);\n    }\n  },\n  off: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.off(evt, handler);\n    }\n  },\n  once: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.once(evt, handler);\n    }\n  },\n  mapReady,\n  onReady: whenMapReady\n};\n\n// we will also expose these on the template ref\n__expose(exposedMapApi);\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: __props.mapID,\n    class: \"tempo-map\",\n    style: _normalizeStyle({ '--width': __props.width, '--height': __props.height })\n  }, [\n    _renderSlot(_ctx.$slots, \"default\")\n  ], 12, _hoisted_1))\n}\n}\n\n})","<template>\n  <!-- this will automatically gets the class maplibregl-map added to it -->\n  <div :id=\"mapID\" class=\"tempo-map\" :style=\"{ '--width': width, '--height': height }\">\n    <slot></slot>\n  </div>\n</template>\n  \n<script setup lang=\"ts\">\nimport { ref, watch, onMounted, onBeforeUnmount, defineModel } from \"vue\";\nimport { LatLngPair, InitMapOptions } from \"@/types\";\nimport type { PropType } from 'vue';\nimport type { Map, MapEventType, Listener } from 'maplibre-gl';\nimport { useMap } from \"@/composables/maplibre/useMap\";\nimport { usezoomhome } from '@/composables/maplibre/useZoomHome';\n\n\n// should be using a defined Prop type and widthDefaults, but \n// i could not get that to work with the center (LatLngPair is a weird type)\n// but apparently the old options syntax is still good\nconst props = defineProps({\n  mapID: {\n    type: String as PropType<string>,\n    required: true\n  },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions | null>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  }\n});\n\n// define model values that set and return the current map center and zoom\nconst latitude = defineModel<number>(\n  'latitude', \n  {\n    default: 0\n  });\nconst longitude = defineModel<number>(\n  'longitude', \n  {\n    default: 0\n  });\nconst zoom = defineModel<number>(\n  'zoom', \n  {\n    default: 0\n  });\n\n\n\n\nconst showRoadsRef = ref(props.showRoads);\nwatch(() => props.showRoads, (value) => {\n  showRoadsRef.value = value;\n});\n\nconst emit = defineEmits<{\n  (e: 'ready', map: Map): void;\n  (e: 'zoomhome'): void;\n}>();\n\n\n\n\n\n\nfunction attachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.on(evt, handler);\n  });\n}\n\nfunction detachAllEvents(m: Map, handlers: typeof props.events) {\n  Object.entries(handlers).forEach(([evt, handler]) => {\n    m.off(evt, handler);\n  });\n}\n\nconst mapReady = ref(false);\n// https://stackoverflow.com/a/36072263/11594175\nlet promiseResolve: (value: Map) => void;\n// let promiseReject: (reason?: any) => void; // we won't use the reject\nconst whenMapReady: Promise<Map> = new Promise((resolve, _reject) => {\n  promiseResolve = resolve; /**   this is just javascript, so this pulls \n                                  the resolve function\n                                  out of the promise constructor and makes it \n                                  available for us to use\n                            **/\n  // promiseReject = reject;\n});\n\nconst onMapReady = (m: Map) => {\n  console.log(\"Map is ready\", m);\n  mapReady.value = true;\n  emit('ready', m);\n  promiseResolve(m);\n  attachAllEvents(m, props.events);\n};\n\nconst {\n  map,\n  createMap,\n  setView,\n  resetView,\n  getCenter,\n  cleanupMap\n} = useMap(props.mapID, props.initial ?? props.home, showRoadsRef, onMapReady);\n\nwatch(() => [latitude.value, longitude.value, zoom.value], ([newLat, newLng, newZoom]) => {\n  if (map.value && mapReady.value) {\n    setView([newLat, newLng] as LatLngPair, newZoom);\n  }\n});\n\nonMounted(() => {\n\n  const mMap = createMap(); // just use the return value instead of map.value. eases type checking\n  \n  usezoomhome(mMap, props.home.loc, props.home.zoom, () => {\n    emit('zoomhome');\n  });\n\n  mMap.value.on('moveend', () => {\n    if (map.value) {\n      const center = map.value.getCenter();\n      latitude.value = center.lat;\n      longitude.value = center.lng;\n      zoom.value = map.value.getZoom();\n    }\n  });\n  \n});\n\nonBeforeUnmount(() => {\n  if (map.value) {\n    detachAllEvents(map.value, props.events);\n    cleanupMap();\n  }\n});\n\n\n// provide only works downwards and i don't think we need it\n// const MAPLIBRE_PROVIDE_KEY = props.mapID;\n// provide(MAPLIBRE_PROVIDE_KEY, \nconst exposedMapApi = {\n  map,\n  setView,\n  resetView,\n  getCenter,\n  on: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.on(evt, handler);\n    }\n  },\n  off: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.off(evt, handler);\n    }\n  },\n  once: (evt: keyof MapEventType | string, handler: Listener) => {\n    if (map.value) {\n      map.value.once(evt, handler);\n    }\n  },\n  mapReady,\n  onReady: whenMapReady\n};\n\n// we will also expose these on the template ref\ndefineExpose(exposedMapApi);\n\n\n\n</script>\n  \n<style lang=\"less\">\n\n.tempo-map {\n  width: var(--width);\n  height: var(--height);\n}\n\n.tempo-map canvas.maplibregl-canvas {\n  background-color: whitesmoke;\n}\n\n</style>\n\n","import script from \"./MaplibreMap.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MaplibreMap.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MaplibreMap.vue?vue&type=style&index=0&id=3f41f34d&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","export function cleanTrailingSlash (url) {\n  return url.replace(/\\/$/, '');\n}\n\nexport function getServiceDetails (url, fetchOptions = {}) {\n  return new Promise((resolve, reject) => {\n    fetch(`${url}?f=json`, fetchOptions)\n      .then(response => response.json())\n      .then(data => resolve(data))\n      .catch(error => reject(error));\n  });\n}\n\nconst POWERED_BY_ESRI_ATTRIBUTION_STRING = 'Powered by <a href=\"https://www.esri.com\">Esri</a>';\n// This requires hooking into some undocumented properties\nexport function updateAttribution (newAttribution, sourceId, map) {\n  const attributionController = map._controls.find(c => '_attribHTML' in c);\n  if (!attributionController) return;\n\n  const customAttribution = attributionController.options.customAttribution;\n\n  if (typeof customAttribution === 'string') {\n    attributionController.options.customAttribution = `${customAttribution} | ${POWERED_BY_ESRI_ATTRIBUTION_STRING}`;\n  } else if (customAttribution === undefined) {\n    attributionController.options.customAttribution = POWERED_BY_ESRI_ATTRIBUTION_STRING;\n  } else if (Array.isArray(customAttribution)) {\n    if (customAttribution.indexOf(POWERED_BY_ESRI_ATTRIBUTION_STRING) === -1) {\n      customAttribution.push(POWERED_BY_ESRI_ATTRIBUTION_STRING);\n    }\n  }\n\n  if (map.style.sourceCaches) {\n    map.style.sourceCaches[sourceId]._source.attribution = newAttribution;\n  } else if (map.style._otherSourceCaches) {\n    map.style._otherSourceCaches[sourceId]._source.attribution = newAttribution;\n  }\n  attributionController._updateAttributions();\n}\n","import {cleanTrailingSlash, getServiceDetails, updateAttribution} from './utils';\n\nexport class ImageService {\n\n  constructor (sourceId, map, esriServiceOptions, rasterSrcOptions) {\n    if (!esriServiceOptions.url) throw new Error('A url must be supplied as part of the esriServiceOptions object.');\n\n    esriServiceOptions.url = cleanTrailingSlash(esriServiceOptions.url);\n\n    this._sourceId = sourceId;\n    this._map = map;\n\n    this._defaultEsriOptions = {\n      format: 'jpgpng',\n      dpi: 96,\n      getAttributionFromService: true\n    };\n\n    this.rasterSrcOptions = rasterSrcOptions;\n    this.esriServiceOptions = esriServiceOptions;\n    this._createSource();\n\n    this._serviceMetadata = null;\n\n    if (this.options.getAttributionFromService) this.setAttributionFromService();\n  }\n\n  get options () {\n    return {\n      ...this._defaultEsriOptions,\n      ...this.esriServiceOptions\n    };\n  }\n\n  get _time () {\n    if (!this.options.to) return false;\n    let from = this.options.from;\n    let to = this.options.to;\n    if (from instanceof Date) from = from.valueOf();\n    if (to instanceof Date) to = to.valueOf();\n\n    return `${from},${to}`;\n  }\n\n  get _source () {\n    const tileSize = this.rasterSrcOptions ? this.rasterSrcOptions.tileSize ? this.rasterSrcOptions.tileSize : 256 : 256;\n    // These are the bare minimum parameters\n    const params = new URLSearchParams({\n      bboxSR: 3857,\n      imageSR: 3857,\n      format: this.options.format,\n      size: [tileSize, tileSize],\n      f: 'image'\n    });\n\n    // These are optional params\n    if (this._time) params.append('time', this._time);\n    if (this.options.mosaicRule) params.append('mosaicRule', JSON.stringify(this.options.mosaicRule));\n    if (this.options.renderingRule) params.append('renderingRule', JSON.stringify(this.options.renderingRule));\n\n    return {\n      type: 'raster',\n      tiles: [\n        `${this.options.url}/exportImage?bbox={bbox-epsg-3857}&${params.toString()}`\n      ],\n      tileSize,\n      ...this.rasterSrcOptions\n    };\n  }\n\n  _createSource () {\n    this._map.addSource(this._sourceId, this._source);\n  }\n\n  // This requires hooking into some undocumented methods\n  _updateSource () {\n    const src = this._map.getSource(this._sourceId);\n    src.tiles[0] = this._source.tiles[0];\n    src._options = this._source;\n    if (src.setTiles) {\n      // New MapboxGL >= 2.13.0\n      src.setTiles(this._source.tiles);\n    } else if (this._map.style.sourceCaches) {\n      // Old MapboxGL and MaplibreGL\n      this._map.style.sourceCaches[this._sourceId].clearTiles();\n      this._map.style.sourceCaches[this._sourceId].update(this._map.transform);\n    } else if (this._map.style._otherSourceCaches) {\n      this._map.style.sourceCaches[this._sourceId].clearTiles();\n      this._map.style.sourceCaches[this._sourceId].update(this._map.transform);\n    }\n  }\n\n  setDate (from, to) {\n    this.esriServiceOptions.from = from;\n    this.esriServiceOptions.to = to;\n    this._updateSource();\n  }\n\n  setRenderingRule (rule) {\n    this.esriServiceOptions.renderingRule = rule;\n    this._updateSource();\n  }\n\n  setMosiacRule (rule) {\n    this.esriServiceOptions.mosaicRule = rule;\n    this._updateSource();\n  }\n\n  setAttributionFromService () {\n    if (this._serviceMetadata) updateAttribution(this._serviceMetadata.copyrightText, this._sourceId, this._map);\n    else {\n      this.getMetadata()\n        .then(() => {\n          updateAttribution(this._serviceMetadata.copyrightText, this._sourceId, this._map);\n        });\n    }\n  }\n\n  getMetadata() {\n    if (this._serviceMetadata !== null) return Promise.resolve(this._serviceMetadata);\n    return new Promise((resolve, reject) => {\n      getServiceDetails(this.esriServiceOptions.url, this.esriServiceOptions.fetchOptions)\n        .then((data) => {\n          this._serviceMetadata = data;\n          resolve(this._serviceMetadata);\n        })\n        .catch(err => reject(err));\n    });\n  }\n\n  identify (lnglat, returnGeometry) {\n    const canvas = this._map.getCanvas();\n    const bounds = this._map.getBounds().toArray();\n    returnGeometry = returnGeometry ? returnGeometry : false;\n    const params = new URLSearchParams({\n      sr: 4326,\n      geometryType: 'esriGeometryPoint',\n      geometry: JSON.stringify({\n        x: lnglat.lng,\n        y: lnglat.lat,\n        spatialReference: {\n          wkid: 4326\n        }\n      }),\n      tolerance: 3,\n      returnGeometry,\n      imageDisplay: `${canvas.width},${canvas.height},96`,\n      mapExtent: `${bounds[0][0]},${bounds[0][1]},${bounds[1][0]},${bounds[1][1]}`,\n      layers: this._layersStr,\n      layerDefs: this._layerDefs,\n      time: this._time,\n      f: 'json'\n    });\n\n    return new Promise((resolve, reject) => {\n      fetch(`${this.esriServiceOptions.url}/identify?${params.toString()}`, this.esriServiceOptions.fetchOptions)\n        .then(response => response.json())\n        .then(data => resolve(data))\n        .catch(error => reject(error));\n    });\n  }\n}\n","import { toRef, ref, watch, type MaybeRef, onMounted } from \"vue\";\n\nimport { MoleculeType } from \"../esri/utils\";\nimport { useTempoStore } from \"@/stores/app\";\n\nexport function useEsriTimesteps(initialMolecule: MaybeRef<MoleculeType>, updateOnMount=true) {\n  const molecule = toRef(initialMolecule);\n  const loadingTimesteps = ref(false);\n  const esriTimesteps = ref<number[]>([]);\n  const error = ref<string | null>(null);\n  const store = useTempoStore();\n\n  function updateEsriTimeSteps(): Promise<void> {\n    loadingTimesteps.value = true;\n    const tds = store.getTempoDataService(molecule.value);\n    return tds.getMergedTimesteps()\n      .then(timesteps => {\n        esriTimesteps.value = timesteps;\n      })\n      .catch((err: Error) => {\n        console.error(`Error fetching ESRI time steps: ${err}`);\n        error.value = err.message;\n      })\n      .finally(() => {\n        loadingTimesteps.value = false;\n      });\n  }\n\n  if (updateOnMount) {\n    onMounted(updateEsriTimeSteps);\n  }\n\n  watch(molecule, () => {\n    updateEsriTimeSteps();\n  });\n\n  return {\n    molecule,\n    loadingTimesteps,\n    esriTimesteps,\n    error,\n    refresh: updateEsriTimeSteps,\n  };\n}\n","import { ref, watch, Ref, MaybeRef, toRef, nextTick, computed } from 'vue';\nimport { renderingRule, stretches, colorramps, rgbcolorramps, RenderingRuleOptions, ColorRamps } from '../ImageLayerConfig';\nimport { type Map, type MapSourceDataEvent } from 'maplibre-gl';\nimport { validate as uuidValidate } from \"uuid\";\n\nimport { ImageService } from '@/esri/ImageServiceLayer/ImageService';\nimport { useEsriTimesteps } from '../../composables/useEsriTimesteps';\nimport { MoleculeType } from '../utils';\nimport { useTempoStore } from '@/stores/app';\n\n\nexport interface UseEsriTempoLayer {\n  esriImageSource: Ref<maplibregl.RasterTileSource | null>;\n  opacity: Ref<number>;\n  noEsriData: Ref<boolean>;\n  loadingEsriTimeSteps: Ref<boolean>;\n  esriTimesteps: Ref<number[]>;\n  updateEsriOpacity: (value?: number | null | undefined) => void;\n  updateEsriTimeRange: () => void;\n  addEsriSource: (map: Map) => void;\n  removeEsriSource: () => void;\n  setVisibility: (visible: boolean) => void;\n  renderOptions: Ref<RenderingRuleOptions>;\n}\n\nexport interface UseEsriTempoLayerOptions {\n  initialMolecule: MaybeRef<MoleculeType>;\n  timestamp: Ref<number | null>;\n  opacity: MaybeRef<number>;\n  fetchOnMount?: boolean;\n  layerName?: string;\n  initVisible?: boolean;\n  initRGB?: boolean;\n}\n\nexport function useTempoLayer(esriLayerOptions: UseEsriTempoLayerOptions): UseEsriTempoLayer {\n\n  const esriLayerId = esriLayerOptions.layerName ?? 'esri-source';\n  const esriImageSource = ref<maplibregl.RasterTileSource | null>(null);\n  const map = ref<Map | null>(null);\n  const molecule = toRef(esriLayerOptions.initialMolecule);\n  const store = useTempoStore();\n\n  const { esriTimesteps } = useEsriTimesteps(molecule, esriLayerOptions.fetchOnMount);\n  const tds = computed(() => store.getTempoDataService(molecule.value));\n  const variable = computed(() => tds.value.getVariable());\n\n  const timestamp = esriLayerOptions.timestamp;\n\n  const opacityRef = toRef(esriLayerOptions.opacity);\n  const noEsriData = ref(false);\n  const loadingEsriTimeSteps = ref(false);\n  const initRGB = esriLayerOptions.initRGB ?? false;\n  const ramps = initRGB ? rgbcolorramps : colorramps;\n  const renderOptions = ref<RenderingRuleOptions>({\n    range: stretches[variable.value],\n    colormap: ramps[variable.value],\n  });\n\n  \n  const options = computed(() => {\n    return  {\n      'format': 'jpgpng',\n      'pixelType': 'U8',\n      'size': '256,256',\n      'transparent': true,\n      'bboxSR': 3857,\n      'imageSR': 3857,\n      'bbox': '{bbox-epsg-3857}',\n      'interpolation': 'RSP_NearestNeighbor',\n      'renderingRule': renderingRule(renderOptions.value.range, renderOptions.value.colormap),\n    };\n  });\n  // const _esriImageOptions = Object.entries(options).map(([key, value]) => `${key}=${value}`).join('&');\n  \n  function addLayer(map: Map | null | undefined) {\n\n    if (map && !map.getLayer(esriLayerId)) {\n      map.addLayer({\n        id: esriLayerId,\n        type: 'raster',\n        source: esriLayerId,\n        layout: {\n          visibility: esriLayerOptions.initVisible === false ? 'none' : 'visible',\n        },\n        paint: {\n          'raster-resampling': 'nearest',\n          'raster-opacity': opacityRef.value ?? 0.8,\n        },\n      });\n      let index = -1;\n      for (const [idx, layer] of Object.entries(map.getStyle().layers)) {\n        if (uuidValidate(layer.id)) {\n          index = Number(idx) - 1;\n        }\n      }\n      if (index >= 0) {\n        map.moveLayer(esriLayerId, map.getStyle().layers[index].id);\n      }\n    }\n  }\n  \n  function removeLayer(map: Map | null | undefined) {\n    if (map && map.getLayer(esriLayerId)) {\n      map.removeLayer(esriLayerId);\n    }\n  }\n  \n  const dynamicMapService = ref<ImageService | null>(null);\n  \n  function onSourceLoad(e: MapSourceDataEvent) {\n    // console.log(`sourcedate event for ${esriLayerId}: `);\n    if (e.sourceId === esriLayerId && e.isSourceLoaded && map.value?.getSource(esriLayerId)) {\n      console.log(`[${esriLayerId}] ESRI source loaded with time`, new Date(timestamp.value ?? 0 ));\n      esriImageSource.value = map.value?.getSource(esriLayerId) as maplibregl.RasterTileSource;\n      updateEsriOpacity();\n      updateEsriTimeRange();\n      map.value?.off('sourcedata', onSourceLoad);\n    } \n  }\n  \n  function setVisibility(visible: boolean) {\n    if (map.value && map.value.getLayer(esriLayerId)) {\n      map.value.setLayoutProperty(\n        esriLayerId, \n        'visibility', \n        visible ? 'visible' : 'none'\n      );\n    }\n  }\n  \n  function createImageService(map: Map, url: string, options) {\n    return new ImageService(\n      esriLayerId,\n      map,\n      {\n        url: url,\n        ...options\n      },\n      {\n        tileSize: 256,\n      }\n    );\n    \n  }\n\n  function addEsriSource(mMap: Map) {\n    if (!mMap) return;\n    map.value = mMap;\n\n    const svc = tds.value;\n    const url = timestamp.value \n      ? svc.selectBaseUrlForTimestamp(timestamp.value)\n      : svc.baseUrlArray[svc.baseUrlArray.length - 1];\n\n    dynamicMapService.value = createImageService(mMap, url, options.value);\n\n    addLayer(mMap);\n    // this event will run until the source is loaded\n    console.log(`[${esriLayerId}] Adding ESRI source to map`);\n    mMap.on('sourcedata', onSourceLoad);\n  }\n  \n  function removeEsriSource() {\n    if (map.value) {\n      if (map.value.getLayer(esriLayerId)) {\n        map.value.removeLayer(esriLayerId);\n      }\n      if (map.value.getSource(esriLayerId)) {\n        map.value.removeSource(esriLayerId);\n      }\n    }\n  }\n  \n  function hasEsriSource() {\n    return map.value?.getSource(esriLayerId) !== undefined;\n  }\n\n  function setDynamicMapServiceDate(nearest: number) {\n    if (!dynamicMapService.value) {\n      console.error(`[${esriLayerId}] Dynamic Map Service is not initialized`);\n      return;\n    }\n\n    const svc = tds.value;\n    const url = svc.selectBaseUrlForRange({ start: nearest, end: nearest });\n\n    const currentUrl = dynamicMapService.value.esriServiceOptions.url;\n    if (currentUrl !== url) {\n      console.log(`[${esriLayerId}] Switching TEMPO ESRI version to ${url}`);\n      dynamicMapService.value.esriServiceOptions.url = url;\n      dynamicMapService.value.setRenderingRule(renderingRule(renderOptions.value.range, renderOptions.value.colormap));\n    }\n\n    dynamicMapService.value.setDate(new Date(nearest), new Date(nearest * 2));\n  }\n  \n  function updateEsriTimeRange() {\n    if (!map.value) return;\n    if (timestamp.value === null) return;\n    const time = timestamp.value;\n\n    const nearest = esriTimesteps.value.length > 0 \n      ? esriTimesteps.value.reduce((a, b) => Math.abs(b - time) < Math.abs(a - time) ? b : a)\n      : time - 1000 * 60 * 15; \n    noEsriData.value = Math.abs((nearest - time) / (1000 * 60)) > 60;\n    // noEsriData.value = nearest > 1752595200000; // Example condition (July 15, 2025 12pm ET for testing)\n    if (noEsriData.value) {\n      console.error(`[${esriLayerId}] No ESRI data available for the selected time`);\n    }\n\n    if (!dynamicMapService.value) {\n      console.error(`[${esriLayerId}] Dynamic Map Service is not initialized`);\n      return;\n    }\n\n    setDynamicMapServiceDate(nearest);\n  }\n\n  watch(esriTimesteps, _timesteps => {\n    nextTick(updateEsriTimeRange);\n  });\n\n\n  watch(timestamp, (_value) => {\n    console.log(`[${esriLayerId}] esri imageset timestamp set to `, _value ? new Date(_value) : null);\n    if ( hasEsriSource() ) {\n      updateEsriTimeRange();\n    } else {\n      console.error(`[${esriLayerId}] ESRI source not yet available`);\n    }\n  });\n  \n  \n  function updateEsriOpacity(value: number | null | undefined = undefined) {\n    if (map.value) {\n      map.value.setPaintProperty(esriLayerId, 'raster-opacity', value ?? opacityRef.value ?? 0.8);\n    }\n  }\n\n  watch(molecule, (_newMol: MoleculeType) => {\n    // refresh() already handled by useEsriTimesteps watch\n    const svc = tds.value;\n    const url = timestamp.value\n      ? svc.selectBaseUrlForTimestamp(timestamp.value)\n      : svc.baseUrlArray[svc.baseUrlArray.length - 1];\n    \n    if (dynamicMapService.value) {\n      dynamicMapService.value.esriServiceOptions.url = url;\n      dynamicMapService.value.setRenderingRule(renderingRule(renderOptions.value.range, renderOptions.value.colormap));\n    }\n  });\n  \n  function updateStretch(vmin: number, vmax: number) {\n    if (dynamicMapService.value) {\n      dynamicMapService.value.setRenderingRule(renderingRule([vmin, vmax], renderOptions.value.colormap));\n    }\n  }\n  \n  function updateColormap(colormap: ColorRamps) {\n    if (dynamicMapService.value) {\n      dynamicMapService.value.setRenderingRule(renderingRule(renderOptions.value.range, colormap));\n    }\n  }\n  \n  watch(() => renderOptions.value.range, (newRange) => {\n    console.log(`[${esriLayerId}] Range changed to `, newRange);\n    updateStretch(newRange[0], newRange[1]);\n  });\n  watch(() => renderOptions.value.colormap, (newColormap) => {\n    console.log(`[${esriLayerId}] Colormap changed to `, newColormap);\n    updateColormap(newColormap);\n  });\n  \n  watch(variable, () => {\n    renderOptions.value.range = stretches[variable.value];\n    renderOptions.value.colormap = colorramps[variable.value];\n  });\n\n  watch(opacityRef, (_value: number) => {\n    updateEsriOpacity(_value);\n  });\n\n  watch(noEsriData, (value: boolean) => {\n    if (value) {\n      updateEsriOpacity(0);\n      removeLayer(map.value as Map | null);\n    } else {\n      addLayer(map.value as Map | null);\n    }\n  });\n\n  return {\n    esriImageSource,\n    opacity: opacityRef,\n    noEsriData,\n    esriTimesteps,\n    loadingEsriTimeSteps,\n    updateEsriOpacity,\n    updateEsriTimeRange,\n    addEsriSource,\n    removeEsriSource,\n    renderOptions,\n    setVisibility,\n  } as UseEsriTempoLayer;\n}\n\n\n","import {ref, watch, Ref, onUnmounted} from 'vue';\n\n\nimport fieldOfRegard from \"@/assets/TEMPO_FOR.json\";\nimport augustFieldOfRegard from \"@/assets/august_for.json\";\n\n\nimport M from 'maplibre-gl';\n\nexport interface MaplibreFieldOfRegardComposable {\n  addFieldOfRegard: () => void;\n  showFieldOfRegard: Ref<boolean>;\n  updateFieldOfRegard: () => void;\n  fieldOfRegardLayer: Ref<M.GeoJSONSource | null>;\n}\n\nexport function useFieldOfRegard(\n  date: Ref<Date | null>,\n  map: Ref<M.Map | null>\n): MaplibreFieldOfRegardComposable {\n\n  const showFieldOfRegard = ref(true);\n  let usingAugust = true as boolean | null;\n  const fieldOfRegardLayer = ref<M.GeoJSONSource | null>(null);\n  const fieldOfRegardLayerId = 'field-of-regard';\n\n\n  function createFoRLayer() {\n    if (!map.value) {\n      console.warn(\"Map is not initialized, cannot create Field of Regard layer.\");\n      return;\n    }\n    // Create the Source if it doesn't exist\n    let source = map.value.getSource(fieldOfRegardLayerId);\n    if (source === undefined) {\n      map.value.addSource(fieldOfRegardLayerId, {\n        'type': 'geojson',\n        data: fieldOfRegard as GeoJSON.GeometryCollection,\n      });\n\n      source = map.value.getSource(fieldOfRegardLayerId);\n    }\n\n    // Create the layer if it doesn't exist\n    let layer = map.value.getLayer(fieldOfRegardLayerId);\n    if (layer === undefined) {\n      map.value.addLayer({\n        id: fieldOfRegardLayerId,\n        type: 'line',\n        source: fieldOfRegardLayerId,\n        paint: {\n          \"line-color\": \"#c10124\",\n          \"line-width\": 1,\n          \"line-opacity\": 0.8,\n        }\n      });\n\n      layer = map.value.getLayer(fieldOfRegardLayerId);\n    }\n\n    if (source) {\n      fieldOfRegardLayer.value = source as M.GeoJSONSource;\n    }\n  }\n\n  function clearFoR() {\n    if (fieldOfRegardLayer.value) {\n      if (fieldOfRegardLayer.value.map.getLayer(fieldOfRegardLayerId)) {\n        fieldOfRegardLayer.value.map\n          .removeLayer(fieldOfRegardLayerId)\n          .removeSource(fieldOfRegardLayerId);\n      }\n    }\n  }\n\n\n  function updateFieldOfRegard() {\n\n    if (date.value !== null && date.value.getUTCFullYear() === 2023 && date.value.getUTCMonth() === 7) {\n      fieldOfRegardLayer.value?.setData(augustFieldOfRegard as GeoJSON.GeometryCollection);\n      usingAugust = true;\n    } else {\n      if (usingAugust) { // only want this to run if it has to\n        fieldOfRegardLayer.value?.setData(fieldOfRegard as GeoJSON.GeometryCollection);\n        usingAugust = false;\n      }\n    }\n  }\n\n  function addFieldOfRegard() {\n    if (showFieldOfRegard.value && map.value) {\n      if (map.value.loaded()) {\n        createFoRLayer();\n      } else {\n        // style.load as already fired depending on where this is placed\n        // so we use 'load' event of the map itself\n        map.value.on('load', () => {\n          createFoRLayer();\n        });\n      }\n    }\n  }\n\n  watch(showFieldOfRegard, (show: boolean) => {\n    if (show) {\n      createFoRLayer();\n    } else if (map.value) {\n      clearFoR();\n    }\n  });\n\n  watch(date, updateFieldOfRegard);\n\n\n  onUnmounted(() => {\n    if (map.value) {\n      clearFoR();\n    }\n  });\n\n  return {\n    addFieldOfRegard,\n    showFieldOfRegard,\n    updateFieldOfRegard,\n    fieldOfRegardLayer: fieldOfRegardLayer as Ref<M.GeoJSONSource | null>,\n  };\n}\n","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, renderSlot as _renderSlot, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"d-flex flex-column align-center justify-center ga-2\" }\n\nimport { ref, watch, toRef, computed, type Ref, useTemplateRef, onMounted } from 'vue';\nimport type { PropType } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport type { Map } from 'maplibre-gl';\nimport MaplibreMap from './MaplibreMap.vue';\nimport { useTempoLayer } from '@/esri/maplibre/useTempoImageLayer';\nimport { useFieldOfRegard } from '@/composables/maplibre/useFieldOfRegard';\nimport { type MoleculeType } from '@/esri/utils';\nimport type { InitMapOptions, LatLngPair } from '@/types';\nimport type { MapEventType, Listener } from 'maplibre-gl';\nimport type { AvailableColorMaps } from \"@/colormaps\";\n\nimport { useTempoStore } from \"@/stores/app\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'EsriMap',\n  props: /*@__PURE__*/_mergeModels({\n  mapID: { type: String, required: true },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions | null>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    required: false,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  // ESRI-specific props\n  timestamp: { \n    type: Number as PropType<number | null>, \n    required: false, \n    default: null \n  },\n  molecule: { \n    type: String as PropType<MoleculeType>, \n    required: true \n  },\n  opacity: { \n    type: Number, \n    required: false, \n    default: 0.9 \n  },\n  showFieldOfRegard: { \n    type: Boolean, \n    required: false, \n    default: true \n  },\n  maplibreLayerName: {\n    type: String || undefined,\n    required: false,\n    default: undefined\n  }\n}, {\n    \"latitude\": { default: 0 },\n    \"latitudeModifiers\": {},\n    \"longitude\": { default: 0 },\n    \"longitudeModifiers\": {},\n    \"zoom\": { default: 0 },\n    \"zoomModifiers\": {},\n  }),\n  emits: /*@__PURE__*/_mergeModels([\"ready\", \"zoomhome\", \"colormap\", \"esri-timesteps-loaded\", \"esri-layer\"], [\"update:latitude\", \"update:longitude\", \"update:zoom\"]),\n  setup(__props, { expose: __expose, emit: __emit }) {\n\nconst store = useTempoStore();\n\nconst { showRGBMode } = storeToRefs(store);\n\nconst props = __props;\n\nconst emit = __emit;\n\n// Reference to inner MaplibreMap exposed API\nconst innerMap = useTemplateRef<InstanceType<typeof MaplibreMap> | null>(\"innerMap\");\nconst map = ref<Map | null>(null);\n\n// Pass-through models for view state\nconst latitude = _useModel<number>(__props, 'latitude');\nconst longitude = _useModel<number>(__props, 'longitude');\nconst zoom = _useModel<number>(__props, 'zoom');\n\n// add a watcher to console log the lat/long/zoom changes\nwatch([latitude, longitude, zoom], ([newLat, newLng, newZoom]) => {\n  console.log(`Map view changed: lat=${newLat}, lng=${newLng}, zoom=${newZoom}`);\n});\n\n// Internal readiness tracking: single concept (base map ready)\nconst mapReady = ref(false);              // Underlying Maplibre map style loaded\nlet promiseResolve: (value: Map) => void;\nconst onReady: Promise<Map> = new Promise((resolve) => { promiseResolve = resolve; });\n\nconst molecule = computed(() => props.molecule);\n\n//https://vuejs.org/api/reactivity-utilities#toref (two-way)\n// can also do toRef(()=>props.timestamp) in v 3.3+\nconst timestampRef = toRef(props, 'timestamp');\nconst opacityRef = toRef(props, 'opacity');\n\n// ESRI layer composable\nconst theEsriLayer = useTempoLayer({\n  initialMolecule: molecule,\n  timestamp: timestampRef,\n  opacity: opacityRef,\n  fetchOnMount: true,\n  layerName: props.maplibreLayerName,\n  initVisible: true,\n  initRGB: showRGBMode.value,\n});\n\nconst { loadingEsriTimeSteps, addEsriSource, esriTimesteps, renderOptions } = theEsriLayer;\n\nwatch(esriTimesteps, (newSteps, old) => {\n  if (newSteps.length > 0 && newSteps !== old) {\n    emit('esri-timesteps-loaded', newSteps);\n  }\n});\n\nwatch(() => renderOptions.value.colormap, cmap => emit(\"colormap\", cmap));\n\nwatch(map, (newMap, oldMap) => {\n  if (oldMap) {\n    store.deregisterMap(oldMap as unknown as Map);\n  }\n  if (newMap) {\n    store.registerMap(newMap as unknown as Map);\n  }\n});\n\nconst singleDateSelected = computed(() => {\n  // a date object with the current day\n  if (props.timestamp) {\n    const dt = new Date(props.timestamp);\n    return new Date(dt.getFullYear(), dt.getMonth(), dt.getDate());\n  }\n  return null;\n});\n// Field of Regard handling\nconst { \n  addFieldOfRegard, \n  showFieldOfRegard: internalShowFieldOfRegard, \n  updateFieldOfRegard \n} = useFieldOfRegard(singleDateSelected, map as Ref<Map | null>);\n  \ninternalShowFieldOfRegard.value = props.showFieldOfRegard;\nwatch(() => props.showFieldOfRegard, (val) => {\n  internalShowFieldOfRegard.value = val;\n});\n\nfunction onInnerMapReady(m: Map) {\n  // Resolve base map readiness immediately\n  mapReady.value = true;\n  promiseResolve(m);\n  map.value = m;\n  // Attach ESRI source right after base readiness (microtask keeps UI snappy)\n  addEsriSource(m);\n  emit('esri-layer', theEsriLayer);\n  emit('ready', m);\n  console.log(m);\n}\n\nonMounted(() => {\n  if (internalShowFieldOfRegard.value) {\n    updateFieldOfRegard();\n    addFieldOfRegard();\n  }\n});\n\n// Forward selected parts of inner MaplibreMap API after it's ready\nconst exposedApi = {\n  map,\n  mapReady,\n  onReady, // Promise resolves when base map ready\n  // Forwarded methods\n  setView: (center: LatLngPair, zoom: number) => innerMap.value?.setView(center, zoom),\n  resetView: () => innerMap.value?.resetView(),\n  getCenter: () => innerMap.value?.getCenter(),\n  on: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.on(type, listener),\n  off: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.off(type, listener),\n  once: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.once(type, listener),\n  // ESRI specifics\n  esriTimesteps,\n  loadingEsriTimeSteps,\n  renderOptions,\n};\n\n__expose(exposedApi);\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_progress_circular = _resolveComponent(\"v-progress-circular\")!\n  const _component_v_overlay = _resolveComponent(\"v-overlay\")!\n\n  return (_openBlock(), _createBlock(MaplibreMap, {\n    mapID: __props.mapID,\n    home: __props.home,\n    initial: __props.initial,\n    \"show-roads\": __props.showRoads,\n    events: __props.events,\n    width: __props.width,\n    height: __props.height,\n    latitude: latitude.value,\n    longitude: longitude.value,\n    zoom: zoom.value,\n    \"onUpdate:latitude\": _cache[0] || (_cache[0] = (v)=> latitude.value = v),\n    \"onUpdate:longitude\": _cache[1] || (_cache[1] = (v)=> longitude.value = v),\n    \"onUpdate:zoom\": _cache[2] || (_cache[2] = (v)=> zoom.value = v),\n    ref_key: \"innerMap\",\n    ref: innerMap,\n    onReady: onInnerMapReady,\n    onZoomhome: _cache[3] || (_cache[3] = ($event: any) => (_ctx.$emit('zoomhome')))\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_overlay, {\n        \"model-value\": _unref(loadingEsriTimeSteps),\n        style: {\"z-index\":\"1000\"},\n        class: \"align-center justify-center\",\n        contained: \"\",\n        opacity: \".8\"\n      }, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_1, [\n            _cache[4] || (_cache[4] = _createElementVNode(\"label\", { class: \"text-white\" }, \"Fetching time steps from NASA Earthdata GIS service...\", -1)),\n            _createVNode(_component_v_progress_circular, {\n              size: 80,\n              width: 12,\n              indeterminate: _unref(loadingEsriTimeSteps),\n              color: \"#092088\"\n            }, null, 8, [\"indeterminate\"])\n          ])\n        ]),\n        _: 1\n      }, 8, [\"model-value\"]),\n      _renderSlot(_ctx.$slots, \"default\")\n    ]),\n    _: 3\n  }, 8, [\"mapID\", \"home\", \"initial\", \"show-roads\", \"events\", \"width\", \"height\", \"latitude\", \"longitude\", \"zoom\"]))\n}\n}\n\n})","<template>\n  <MaplibreMap\n    :mapID=\"mapID\"\n    :home=\"home\"\n    :initial=\"initial\"\n    :show-roads=\"showRoads\"\n    :events=\"events\"\n    :width=\"width\"\n    :height=\"height\"\n    :latitude=\"latitude\"\n    :longitude=\"longitude\"\n    :zoom=\"zoom\"\n    @update:latitude=\"(v:number)=> latitude = v\"\n    @update:longitude=\"(v:number)=> longitude = v\"\n    @update:zoom=\"(v:number)=> zoom = v\"\n    ref=\"innerMap\"\n    @ready=\"onInnerMapReady\"\n    @zoomhome=\"$emit('zoomhome')\"\n  >\n    <!-- Loading overlay while fetching ESRI time steps -->\n    <v-overlay\n      :model-value=\"loadingEsriTimeSteps\"\n      style=\"z-index: 1000;\"\n      class=\"align-center justify-center\"\n      contained\n      opacity=\".8\"\n    >\n      <div class=\"d-flex flex-column align-center justify-center ga-2\">\n        <label class=\"text-white\">Fetching time steps from NASA Earthdata GIS service...</label>\n        <v-progress-circular\n          :size=\"80\"\n          :width=\"12\"\n          :indeterminate=\"loadingEsriTimeSteps\"\n          color=\"#092088\"\n        />\n      </div>\n    </v-overlay>\n    <slot />\n  </MaplibreMap>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, toRef, computed, type Ref, useTemplateRef, onMounted } from 'vue';\nimport type { PropType } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport type { Map } from 'maplibre-gl';\nimport MaplibreMap from './MaplibreMap.vue';\nimport { useTempoLayer } from '@/esri/maplibre/useTempoImageLayer';\nimport { useFieldOfRegard } from '@/composables/maplibre/useFieldOfRegard';\nimport { type MoleculeType } from '@/esri/utils';\nimport type { InitMapOptions, LatLngPair } from '@/types';\nimport type { MapEventType, Listener } from 'maplibre-gl';\nimport type { AvailableColorMaps } from \"@/colormaps\";\n\nimport { useTempoStore } from \"@/stores/app\";\n\nconst store = useTempoStore();\n\nconst { showRGBMode } = storeToRefs(store);\n\nconst props = defineProps({\n  mapID: { type: String, required: true },\n  home: {\n    type: Object as PropType<InitMapOptions>,\n    required: false,\n    default: () => {\n      return {\n        loc: [39.8283, -98.5795] as LatLngPair, \n        zoom: 4, \n        t: null\n      };\n    }\n  },\n  initial: {\n    type: Object as PropType<InitMapOptions | null>,\n    required: false,\n    default: null\n  },\n  showRoads: {\n    type: Boolean,\n    required: false,\n    default: true\n  },\n  // events: { moveend: handler, zoomend: handler, click: handler, etc. }\n  events: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: Object as PropType<Record<keyof MapEventType | string, Listener>>,\n    required: false,\n    default: () => ({})\n  },\n  // width and height, default to 100%\n  width: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  height: {\n    type: String,\n    required: false,\n    default: '100%'\n  },\n  // ESRI-specific props\n  timestamp: { \n    type: Number as PropType<number | null>, \n    required: false, \n    default: null \n  },\n  molecule: { \n    type: String as PropType<MoleculeType>, \n    required: true \n  },\n  opacity: { \n    type: Number, \n    required: false, \n    default: 0.9 \n  },\n  showFieldOfRegard: { \n    type: Boolean, \n    required: false, \n    default: true \n  },\n  maplibreLayerName: {\n    type: String || undefined,\n    required: false,\n    default: undefined\n  }\n});\n\nconst emit = defineEmits<{\n  // Single, simplified ready event: base map (Maplibre) is ready.\n  (e:'ready', map: Map): void; \n  (e:'zoomhome'): void; \n  (e: 'colormap', colormap: AvailableColorMaps): void;\n  // Timesteps loaded (can fire multiple times e.g., molecule switch)\n  (e:'esri-timesteps-loaded', steps: number[]): void;\n  (e: 'esri-layer', esriLayer: ReturnType<typeof useTempoLayer>)\n}>();\n\n// Reference to inner MaplibreMap exposed API\nconst innerMap = useTemplateRef<InstanceType<typeof MaplibreMap> | null>(\"innerMap\");\nconst map = ref<Map | null>(null);\n\n// Pass-through models for view state\nconst latitude = defineModel<number>('latitude', { default: 0 });\nconst longitude = defineModel<number>('longitude', { default: 0 });\nconst zoom = defineModel<number>('zoom', { default: 0 });\n\n// add a watcher to console log the lat/long/zoom changes\nwatch([latitude, longitude, zoom], ([newLat, newLng, newZoom]) => {\n  console.log(`Map view changed: lat=${newLat}, lng=${newLng}, zoom=${newZoom}`);\n});\n\n// Internal readiness tracking: single concept (base map ready)\nconst mapReady = ref(false);              // Underlying Maplibre map style loaded\nlet promiseResolve: (value: Map) => void;\nconst onReady: Promise<Map> = new Promise((resolve) => { promiseResolve = resolve; });\n\nconst molecule = computed(() => props.molecule);\n\n//https://vuejs.org/api/reactivity-utilities#toref (two-way)\n// can also do toRef(()=>props.timestamp) in v 3.3+\nconst timestampRef = toRef(props, 'timestamp');\nconst opacityRef = toRef(props, 'opacity');\n\n// ESRI layer composable\nconst theEsriLayer = useTempoLayer({\n  initialMolecule: molecule,\n  timestamp: timestampRef,\n  opacity: opacityRef,\n  fetchOnMount: true,\n  layerName: props.maplibreLayerName,\n  initVisible: true,\n  initRGB: showRGBMode.value,\n});\n\nconst { loadingEsriTimeSteps, addEsriSource, esriTimesteps, renderOptions } = theEsriLayer;\n\nwatch(esriTimesteps, (newSteps, old) => {\n  if (newSteps.length > 0 && newSteps !== old) {\n    emit('esri-timesteps-loaded', newSteps);\n  }\n});\n\nwatch(() => renderOptions.value.colormap, cmap => emit(\"colormap\", cmap));\n\nwatch(map, (newMap, oldMap) => {\n  if (oldMap) {\n    store.deregisterMap(oldMap as unknown as Map);\n  }\n  if (newMap) {\n    store.registerMap(newMap as unknown as Map);\n  }\n});\n\nconst singleDateSelected = computed(() => {\n  // a date object with the current day\n  if (props.timestamp) {\n    const dt = new Date(props.timestamp);\n    return new Date(dt.getFullYear(), dt.getMonth(), dt.getDate());\n  }\n  return null;\n});\n// Field of Regard handling\nconst { \n  addFieldOfRegard, \n  showFieldOfRegard: internalShowFieldOfRegard, \n  updateFieldOfRegard \n} = useFieldOfRegard(singleDateSelected, map as Ref<Map | null>);\n  \ninternalShowFieldOfRegard.value = props.showFieldOfRegard;\nwatch(() => props.showFieldOfRegard, (val) => {\n  internalShowFieldOfRegard.value = val;\n});\n\nfunction onInnerMapReady(m: Map) {\n  // Resolve base map readiness immediately\n  mapReady.value = true;\n  promiseResolve(m);\n  map.value = m;\n  // Attach ESRI source right after base readiness (microtask keeps UI snappy)\n  addEsriSource(m);\n  emit('esri-layer', theEsriLayer);\n  emit('ready', m);\n  console.log(m);\n}\n\nonMounted(() => {\n  if (internalShowFieldOfRegard.value) {\n    updateFieldOfRegard();\n    addFieldOfRegard();\n  }\n});\n\n// Forward selected parts of inner MaplibreMap API after it's ready\nconst exposedApi = {\n  map,\n  mapReady,\n  onReady, // Promise resolves when base map ready\n  // Forwarded methods\n  setView: (center: LatLngPair, zoom: number) => innerMap.value?.setView(center, zoom),\n  resetView: () => innerMap.value?.resetView(),\n  getCenter: () => innerMap.value?.getCenter(),\n  on: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.on(type, listener),\n  off: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.off(type, listener),\n  once: (type: keyof MapEventType | string, listener: Listener) => innerMap.value?.once(type, listener),\n  // ESRI specifics\n  esriTimesteps,\n  loadingEsriTimeSteps,\n  renderOptions,\n};\n\ndefineExpose(exposedApi);\n\n</script>\n\n<style scoped lang=\"less\">\n#map-legend {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n  background: rgba(255,255,255,0.85);\n  padding: 4px 8px;\n  font-size: 0.8rem;\n  border-radius: 4px;\n  z-index: 500;\n  pointer-events: none;\n}\n.line-legend {\n  border: none;\n  border-top: 2px solid #c10124;\n  margin: 0 0 2px 0;\n}\n</style>\n","import script from \"./EsriMap.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EsriMap.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EsriMap.vue?vue&type=style&index=0&id=35ce1898&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-35ce1898\"]])\n\nexport default __exports__","import { Map } from 'maplibre-gl';\n/** \n * Utitlity function for downloading canvas content as an image file.\n */\ntype ImageFormats = 'png' | 'jpeg';\nexport function downloadCanvasToImage(canvas: HTMLCanvasElement, filename: string = 'canvas_image', format: ImageFormats = 'png') {\n  console.log('Downloading canvas to image...');\n  const dataUrl = canvas.toDataURL(`image/${format}`);\n  const link = document.createElement('a');\n  link.href = dataUrl;\n  link.download = filename;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n\nexport function downloadMap(map: Map, name = 'tempo-map', format: ImageFormats = 'png') {\n  if (!map) {\n    alert('Map not ready yet!');\n    return;\n  }\n  \n  // use regex so that if name ends with .png, .jpeg, .jpg, strip it off\n  name = name.replace(/\\.(png|jpeg|jpg)$/i, '');\n  \n  const html = map.getCanvas();\n  console.log('Downloading map image...', html);\n  // see: https://stackoverflow.com/a/78283389/11594175\n  map.once('render', () => {\n    // do this once when we render\n    downloadCanvasToImage(html, name, format);\n  });\n  map.redraw(); // render now!\n  \n}","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, withKeys as _withKeys, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { downloadMap } from '@/utils/canvas_downloader';\nimport { type Map } from 'maplibre-gl';\n\ninterface MaplibreDownloadButtonProps {\n  map: Map,\n  filename: string\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MaplibreDownloadButton',\n  props: {\n    map: {},\n    filename: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\n\nconst onClick = () => {\n  downloadMap(props.map, props.filename);\n};\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n\n  return (_openBlock(), _createBlock(_component_v_btn, {\n    onClick: onClick,\n    onKeyup: _withKeys(onClick, [\"enter\"]),\n    icon: \"mdi-camera-outline\"\n  }))\n}\n}\n\n})","<template>\n  <v-btn\n  @click=\"onClick\"\n  @keyup.enter=\"onClick\"\n  icon=\"mdi-camera-outline\"\n  >\n  </v-btn>\n</template>\n\n<script setup lang=\"ts\">\nimport { downloadMap } from '@/utils/canvas_downloader';\nimport { type Map } from 'maplibre-gl';\n\ninterface MaplibreDownloadButtonProps {\n  map: Map,\n  filename: string\n}\n\nconst props = defineProps<MaplibreDownloadButtonProps>();\n\nconst onClick = () => {\n  downloadMap(props.map, props.filename);\n};\n</script>\n","import script from \"./MaplibreDownloadButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MaplibreDownloadButton.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import type { ColorMap } from \"./types\";\nimport { colormaps, type AllAvailableColorMaps } from \".\";\n\nfunction lerp(a: number, b: number, t: number): number {\n  return a + (b - a) * t;\n}\n\n// linear spline\nfunction spline( t: number, ...values: number[]): number {\n  if (t <= 0) return values[0] as number;\n  if (t >= 1) return values[values.length - 1] as number;\n  const n = values.length - 1;\n  const i = Math.floor(t * n);\n  const u = t * n - i;\n  return lerp(values[i], values[i + 1] ?? values[i], u);\n}\n\nfunction clamp(x: number, min: number, max: number): number {\n  return Math.min(Math.max(x, min), max);\n}\n\nexport function colormap(cmap: AllAvailableColorMaps, cmin: number, cmax: number, val: number): [number, number, number]\n{ \n  let reversed = false;\n  if (cmap.endsWith('_r')) {\n    cmap = cmap.slice(0, -2) as AllAvailableColorMaps;\n    reversed = true;\n  }\n  if (!(cmap in colormaps)) {\n    console.log(`Colormap ${cmap} not found, returning gray`);\n    return [128,128,128];\n  }\n  \n  const { r: redValues, g: greenValues, b: blueValues } = colormaps[cmap] as ColorMap;\n\n  // const normalizedVal = clamp((val-cmin)/(cmax-cmin),0,1);\n  const normalizedVal = reversed ? clamp((cmax - val) / (cmax - cmin), 0, 1) : clamp((val - cmin) / (cmax - cmin), 0, 1);\n  const r = spline(normalizedVal, ...redValues);\n  const g = spline(normalizedVal, ...greenValues);\n  const b = spline(normalizedVal, ...blueValues);\n  return [Math.round(r*255),Math.round(g*255),Math.round(b*255)];\n}\n\nexport function sampleColormap(cmap: AllAvailableColorMaps, steps: number): number[][] {\n  const colors: number[][] = [];\n  for (let i = 0; i < steps; i++) {\n    const t = i / (steps - 1);\n    colors.push(colormap(cmap, 0, 1, t));\n  }\n  return colors;\n}\n\n// should return an array of values that is compatible with the \"heatmap-color\" property of a heatmap layer\n// So it will be an array like: [0, 'color1', 0.2, 'color2', 0.4, 'color3', ..., 1, 'colorN']\nexport function createHeatmapColorMap(colormapName: AllAvailableColorMaps = 'viridis', steps: number[] = [0.1, 0.2, 0.4, 0.6, 0.8, 1], transparentTo = 0): Array<number | string> {\n  const colors: Array<string | number> = [];\n  \n  // start with fully transparent\n  colors.push(0);\n  colors.push('rgba(0,0,0,0)'); \n  \n  let transparentAdded = false;\n  // then add colors from transparentTo to 1\n  for (const t of steps) {\n    const [r, g, b] = colormap(colormapName, 0, 1, t);\n    const c = `rgb(${r},${g},${b})`;\n    if (transparentTo < t && !transparentAdded) {\n      console.log('Adding transparent to color at', transparentTo, c);\n      colors.push(transparentTo);\n      colors.push(c);\n      transparentAdded = true;\n    }\n    colors.push(t);\n    colors.push(c);\n  }\n  return colors;\n  \n}\n\nexport function previewColormapInConsole(colormapName: AllAvailableColorMaps = 'viridis', steps: number[] = [0.1, 0.2, 0.4, 0.6, 0.8, 1], transparentTo = 0) {\n  // using console log stying appling hte color to a character\n  const colors = createHeatmapColorMap(colormapName, steps, transparentTo);\n  let str = '';\n  const style: string[] = [];\n  for (let i = 0; i < colors.length; i += 2) {\n    // const t = colors[i];\n    const c = colors[i + 1];\n    str += '%c';\n    style.push(`color: ${c}`);\n  }\n  console.log('%cColormap: ' + colormapName, 'font-weight: bold;');\n  console.log(str, ...style);\n}\n\nexport function colormapFunction(cmapName: string) {\n  return (x: number) => {\n    let rgb: number[] = [128, 128, 128];\n    try {\n      rgb = colormap(cmapName.toLowerCase() as AllAvailableColorMaps, 0, 1, x);\n    }\n    catch {\n      console.log(\"no valid colormap. returning gray\");\n    }\n    return `rgba(${rgb[0]}, ${rgb[1]}, ${rgb[2]},1)`;\n  };\n}\n","import { ref, type Ref } from \"vue\";\nimport { Map, Popup, type GeoJSONSource } from \"maplibre-gl\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { createHeatmapColorMap, previewColormapInConsole } from \"@/colormaps/utils\";\nimport { PrimSource } from \"@/assets/power_plants\";\n\n\n\n// const steps = Array.from({ length: 20 }, (_, i) => i / 19);\n// console.log('Heatmap colors:', createHeatmapColorMap('svs', steps, 0.05));\n// previewColormapInConsole('svs', steps, 0.05);\n\nexport const POWER_PLANT_COLORS: Record<PrimSource, string> = {\n  batteries: \"#00FF00\",\n  biomass: \"#654321\",\n  coal: \"#36454F\",\n  geothermal: \"#FF0000\",\n  hydroelectric: \"#00008B\",\n  \"natural gas\": \"#C4A484\",\n  nuclear: \"#5D3FD3\",\n  other: \"#FAF9F6\",\n  petroleum: \"#D3D3D3\",\n  \"pumped storage\": \"#00FFFF\",\n  solar: \"#FFFF00\",\n  wind: \"#ADD8E6\",\n} as const;\n\n\nexport function addPowerPlants(map: Ref<Map | null> | null, startVisible = true) {\n  const powerPlantsLayerId = \"power-plants-layer\";\n  const powerPlantsHeatmapLayerId = \"power-plants-heatmap\";\n  const powerPlantsSourceId = \"power-plants-source\";\n  const powerPlantsVisible = ref(startVisible);\n  const loading = ref(false);\n  let loadPromise: Promise<GeoJSON.FeatureCollection> | null = null;\n  // let usingHeatmap = false;\n\n  function togglePowerPlants(vis?: boolean | undefined) {\n    if (!map || !map.value) return;\n    const layerIDs = [powerPlantsLayerId, powerPlantsHeatmapLayerId];\n    layerIDs.forEach(id => {\n      if (!map.value || !map.value!.getLayer(id)) return;\n      \n      if (vis !== undefined) {\n        powerPlantsVisible.value = vis;\n        map.value.setLayoutProperty(id, \"visibility\", vis ? \"visible\" : \"none\");\n        return;\n      }\n      \n      const visibility = map.value.getLayoutProperty(\n        id,\n        \"visibility\"\n      );\n      if (visibility === \"visible\") {\n        map.value.setLayoutProperty(id, \"visibility\", \"none\");\n        powerPlantsVisible.value = false;\n      } else {\n        map.value.setLayoutProperty(id, \"visibility\", \"visible\");\n        powerPlantsVisible.value = true;\n      }\n    });\n  }\n  \n  function isValidMap(map: Ref<Map | null> | null): map is Ref<Map> {\n    return map !== null && map.value !== null;\n  }\n\n  // asynchronously load the heavy GeoJSON chunk and update the source when ready\n  function ensureDataLoaded() {\n    if (loadPromise) return loadPromise;\n    loading.value = true;\n    loadPromise = import(\"@/assets/power_plants\")\n      .then((mod) => mod.powerPlantsGeoJSON as GeoJSON.FeatureCollection)\n      .then((data) => {\n        if (isValidMap(map)) {\n          const src = map.value.getSource(powerPlantsSourceId) as GeoJSONSource | undefined;\n          if (src) src.setData(data);\n        }\n        return data;\n      })\n      .finally(() => {\n        loading.value = false;\n      });\n    return loadPromise;\n  }\n\n  function addSource() {\n    if (!isValidMap(map)) return;\n    \n    if (!map.value.getSource(powerPlantsSourceId)) {\n      map.value.addSource(powerPlantsSourceId, {\n        type: \"geojson\",\n        data: { type: \"FeatureCollection\", features: [] },\n      });\n    }\n    // kick off loading in the background; do not await\n    ensureDataLoaded();\n  }\n\n  function addLayer(op = {minzoom: 0}) {\n    if (!isValidMap(map)) return;\n    \n    addSource();\n\n    if (map.value.getLayer(powerPlantsLayerId)) {\n      console.error(\"Power plants layer already exists.\");\n      return;\n    }\n    \n    // Create a popup, but don't add it to the map yet.\n    //https://maplibre.org/maplibre-gl-js/docs/examples/display-a-popup-on-hover/\n    const popup = new Popup({\n      closeButton: true,\n      closeOnClick: false,\n      className: 'powerplant-popup'\n    });\n\n\n    // add a point layer for power plants\n    map.value.addLayer({\n      id: powerPlantsLayerId,\n      type: \"circle\",\n      source: powerPlantsSourceId,\n      minzoom: op.minzoom || 0,\n      layout: {\n        visibility: powerPlantsVisible.value ? \"visible\" : \"none\",\n      },\n      paint: {\n        \"circle-radius\": [\n          \"interpolate\",\n          [\"linear\"],\n          [\"sqrt\", [\"get\", \"Total_MW\"]],\n\n          // These two points define a linear interpolation\n          // so if Install_MW is 0, the radius is 0\n          // and if sqrt(Install_MW) is 55, the radius is 10\n          0, 1,\n          55, 10,\n        ],\n        \"circle-color\": [\n          \"match\",\n          [\"get\", \"PrimSource\"],\n          \n          // Traditional Sources (Black, Gray, Brown)\n          'coal',          POWER_PLANT_COLORS.coal,\n          'petroleum',     POWER_PLANT_COLORS.petroleum,\n          'natural gas',   POWER_PLANT_COLORS['natural gas'],\n          \n          // Renewable Sources (Bright & Cool Hues)\n          'solar',         POWER_PLANT_COLORS.solar,\n          'wind',          POWER_PLANT_COLORS.wind,\n          'hydroelectric', POWER_PLANT_COLORS.hydroelectric,\n          'geothermal',    POWER_PLANT_COLORS.geothermal,\n          'biomass',       POWER_PLANT_COLORS.biomass,\n          \n          // Storage & Unique Sources (Magenta, Purple, Light Blue)\n          'nuclear',       POWER_PLANT_COLORS.nuclear,\n          'batteries',     POWER_PLANT_COLORS.batteries,\n          'pumped storage', POWER_PLANT_COLORS['pumped storage'],\n          \n          // Fallback\n          /* other */ POWER_PLANT_COLORS.other // Lightest Gray\n          \n        ],\n        \"circle-opacity\": 1,\n        \"circle-stroke-width\": 1,\n        \"circle-stroke-color\": [\n          \"match\",\n          [\"get\", \"PrimSource\"],\n          // light colors get black, else white stroke\n          'solar',         \"#000000\",\n          'wind',     \"#000000\",\n          'petroleum', \"#000000\",\n          'other',          \"#000000\",\n          'natural gas',     \"#000000\",\n          /* default */    \"#FFFFFF\"\n        ]\n      },\n    });\n    //\n    \n    let currentFeatureCoordinates = undefined;\n    \n    map.value.on('mouseenter', powerPlantsLayerId, () => {\n      map.value.getCanvas().style.cursor = 'pointer';\n    });\n    \n    map.value.on('click', powerPlantsLayerId, (e) => {\n      if (!e.features || e.features.length === 0) {\n        return;\n      }\n      // eslint-disable-next-line\n      // @ts-ignore\n      const featureCoordinates = e.features[0].geometry.coordinates.toString();\n      if (currentFeatureCoordinates !== featureCoordinates) {\n        currentFeatureCoordinates = featureCoordinates;\n\n        // Change the cursor style as a UI indicator.\n        map.value.getCanvas().style.cursor = 'pointer';\n        \n        // eslint-disable-next-line\n        // @ts-ignore\n        const coordinates = e.features[0].geometry.coordinates.slice();\n        // Plant_Name, PrimSource, Total_MW\n        const description = e.features[0].properties.Plant_Name + '<br/>' +\n          'Primary Source: ' + e.features[0].properties.PrimSource + '<br/>' +\n          'Total MW: ' + e.features[0].properties.Total_MW;\n\n        // Ensure that if the map is zoomed out such that multiple\n        // copies of the feature are visible, the popup appears\n        // over the copy being pointed to.\n        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n          coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n        }\n\n        // Populate the popup and set its coordinates\n        // based on the feature found.\n        popup.setLngLat(coordinates).setHTML(description).addTo(map.value);\n      }\n    });\n\n    map.value.on('mouseleave', powerPlantsLayerId, () => {\n      currentFeatureCoordinates = undefined;\n      map.value.getCanvas().style.cursor = '';\n      popup.remove();\n    });\n    \n    \n    \n    \n    ////\n  }\n\n    \n  function addheatmapLayer() {\n    if (!isValidMap(map)) return;\n    \n    addSource();\n    \n    // get screen pixel ratio\n    const pixelRatio = window.devicePixelRatio || 1;\n    \n    map.value.addLayer( {\n      id: powerPlantsHeatmapLayerId,\n      type: 'heatmap',\n      source: powerPlantsSourceId,\n      // maxzoom: 5,\n      paint: {\n        \"heatmap-radius\": [\n          'interpolate',\n          ['linear'],\n          ['zoom'],\n          0, // zoom = 0\n          4 / pixelRatio, // radius = 1 @ zoom = 0\n          9, // zoom = 9\n          40 / pixelRatio // radius = 20 @ zoom = 9\n        ],\n        \"heatmap-intensity\": 1,\n        \"heatmap-weight\": [\n          'interpolate',\n          ['linear'],\n          ['get', 'Install_MW'],\n          0, // \n          0, // density is 0 at 0 MW\n          1000,\n          1, // densitity = 1 @ 1 GW\n        ],\n        \"heatmap-color\": [\n          'interpolate',\n          ['linear'],\n          ['heatmap-density'],\n          // 0.0, 'rgb(0,0,0,0)',\n          // 0.05, 'rgb(37,52,148)',\n          // 0.1, 'rgb(37,52,148)',\n          // 0.2, 'rgb(44,127,184)',\n          // 0.4, 'rgb(65,182,196)',\n          // 0.6, 'rgb(127,205,187)',\n          // 0.8, 'rgb(199,233,180)',\n          // 1.0, 'rgb(255,255,204)',\n          // ...[\n          //   0, \"rgba(0,0,0,0)\",\n          //   0.1, \"rgb(7,4,13)\",\n          //   0.125, \"rgb(91,21,124)\",\n          //   0.25, \"rgb(223,79,103)\",\n          //   0.375, \"rgb(254,156,84)\",\n          //   0.5, \"rgb(254,232,161)\",\n          //   0.625,\"rgb(252,250,189)\",\n          //   0.75, \"rgb(181,220,168)\",\n          //   0.875, \"rgb(118,196,173)\",\n          //   1.0, \"rgb(64,157,191)\",\n          // ]\n          ...createHeatmapColorMap('viridis', [0.1, 0.2, 0.4, 0.6, 0.8, 1], 0.05) // aweful by default\n        ],\n        // only fade at the zoom limit\n        \"heatmap-opacity\": 0.8,\n        // \"heatmap-opacity\": [\n        //   'interpolate',\n        //   ['linear'],\n        //   ['zoom'],\n        //   4.9, // zoom = 4.9\n        //   1, // opacity = 1 @ zoom = 4.9\n        //   5, // zoom = 5\n        //   0 // opacity = 0 @ zoom = 5\n        // ],\n      }\n\n    });\n    \n    addLayer(); // add the point layer on top of the heatmap\n    \n    // usingHeatmap = true;\n    \n    /** we don't need to sync visibility, we will handle these two independently **/\n    // map.value.on('idle', () => {\n    //   if (!isValidMap(map)) return;\n    //   if (usingHeatmap) {\n    //     if (map.value.getLayer(powerPlantsLayerId) && map.value.getLayer(powerPlantsHeatmapLayerId)) {\n    //       const heatmapVis = map.value.getLayoutProperty(powerPlantsHeatmapLayerId, 'visibility');\n    //       map.value.setLayoutProperty(powerPlantsLayerId, 'visibility', heatmapVis);\n          \n    //     }\n    //   }\n      \n    // }); \n    \n  }\n  \n  function removeLayer() {\n    if (!map || !map.value) return;\n    [powerPlantsLayerId, powerPlantsHeatmapLayerId].forEach(id => {\n      if (!map || !map.value) return;\n      \n      if (map.value.getLayer(id)) {\n        map.value.removeLayer(id);\n      }\n\n      if (map.value.getSource(id)) {\n        map.value.removeSource(id);\n      }\n    });\n  }\n\n  return {\n    addLayer,\n    removeLayer,\n    addheatmapLayer,\n    togglePowerPlants,\n    powerPlantsVisible,\n    loading, // expose loading state\n  };\n}\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n// Copyright (c) 2016 Mapbox All rights reserved.\n// \"Redistribution and use in source and binary forms, with or without modification, are permitted provided\"\n// Full notice is contained below\n// This has been modified from the original to\n// 1) Update to use const/let as appropriate\n// 2) Add support for extraTags option to include additional tags (e.g., aqi) in properties\nexport default (function () {\n  'use strict';\n  \n  let extraTagsOption = ['aqi'];\n  const excludeDirectChildren = new Set([\n    'name','address','description','timespan','timestamp','extendeddata','visibility',\n    'styleurl','linestyle','polystyle',\n    'multigeometry','multitrack','track','gx:track',\n    'point','linestring','polygon'\n  ]);\n  const removeSpace = /\\s*/g,\n    trimSpace = /^\\s*|\\s*$/g,\n    splitSpace = /\\s+/;\n  // generate a short, numeric hash of a string\n  function okhash(x) {\n    let h;\n    if (!x || !x.length) return 0;\n    for (let i = 0; i < x.length; i++) {\n      h = ((h << 5) - h) + x.charCodeAt(i) | 0;\n    } \n    return h;\n  }\n  // all Y children of X\n  function get(x, y) { return x.getElementsByTagName(y); }\n  function attr(x, y) { return x.getAttribute(y); }\n  function attrf(x, y) { return parseFloat(attr(x, y)); }\n  // one Y child of X, if any, otherwise null\n  function get1(x, y) { const n = get(x, y); return n.length ? n[0] : null; }\n  // https://developer.mozilla.org/en-US/docs/Web/API/Node.normalize\n  function norm(el) { if (el.normalize) { el.normalize(); } return el; }\n  // cast array x into numbers\n  function numarray(x) {\n    const o = [];\n    for (let j = 0; j < x.length; j++) { o[j] = parseFloat(x[j]); }\n    return o;\n  }\n  // get the content of a text node, if any\n  function nodeVal(x) {\n    if (x) { norm(x); }\n    return (x && x.textContent) || '';\n  }\n  // get the contents of multiple text nodes, if present\n  function getMulti(x, ys) {\n    const o = {};\n    let n, k;\n    for (k = 0; k < ys.length; k++) {\n      n = get1(x, ys[k]);\n      if (n) o[ys[k]] = nodeVal(n);\n    }\n    return o;\n  }\n  // add properties of Y to X, overwriting if present in both\n  function extend(x, y) { for (const k in y) x[k] = y[k]; }\n  // get one coordinate from a coordinate array, if any\n  function coord1(v) { return numarray(v.replace(removeSpace, '').split(',')); }\n  // get all coordinates from a coordinate array as [[],[]]\n  function coord(v) {\n    const coords = v.replace(trimSpace, '').split(splitSpace),\n      o = [];\n    for (let i = 0; i < coords.length; i++) {\n      o.push(coord1(coords[i]));\n    }\n    return o;\n  }\n  function coordPair(x) {\n    const ll = [attrf(x, 'lon'), attrf(x, 'lat')],\n      ele = get1(x, 'ele'),\n      // handle namespaced attribute in browser\n      heartRate = get1(x, 'gpxtpx:hr') || get1(x, 'hr'),\n      time = get1(x, 'time');\n    let e;\n    if (ele) {\n      e = parseFloat(nodeVal(ele));\n      if (!isNaN(e)) {\n        ll.push(e);\n      }\n    }\n    return {\n      coordinates: ll,\n      time: time ? nodeVal(time) : null,\n      heartRate: heartRate ? parseFloat(nodeVal(heartRate)) : null\n    };\n  }\n\n  // create a new feature collection parent object\n  function fc() {\n    return {\n      type: 'FeatureCollection',\n      features: []\n    };\n  }\n\n  let serializer;\n  if (typeof XMLSerializer !== 'undefined') {\n    /* istanbul ignore next */\n    serializer = new XMLSerializer();\n  } else {\n    // const isNodeEnv = false; //(typeof process === 'object' && !process.browser);\n    // const isTitaniumEnv = false; //(typeof Titanium === 'object');\n    // if (typeof exports === 'object' && (isNodeEnv || isTitaniumEnv)) {\n    //   serializer = new (require('@xmldom/xmldom').XMLSerializer)();\n    // } else {\n    //   throw new Error('Unable to initialize serializer');\n    // }\n    throw new Error('Unable to initialize serializer');\n  }\n  function xml2str(str) {\n    // IE9 will create a new XMLSerializer but it'll crash immediately.\n    // This line is ignored because we don't run coverage tests in IE9\n    /* istanbul ignore next */\n    if (str.xml !== undefined) return str.xml;\n    return serializer.serializeToString(str);\n  }\n\n  const t = {\n    // Accept an optional options object, e.g., { styles: true, extraTags: ['aqi'] | 'auto' | true }\n    kml: function (doc, options = {}) {\n\n      const gj = fc(),\n        // styleindex keeps track of hashed styles in order to match features\n        styleIndex = {}, styleByHash = {},\n        // stylemapindex keeps track of style maps to expose in properties\n        styleMapIndex = {},\n        // atomic geospatial types supported by KML - MultiGeometry is\n        // handled separately\n        geotypes = ['Polygon', 'LineString', 'Point', 'Track', 'gx:Track'],\n        // all root placemarks in the file\n        placemarks = get(doc, 'Placemark'),\n        styles = get(doc, 'Style'),\n        styleMaps = get(doc, 'StyleMap');\n\n      for (let k = 0; k < styles.length; k++) {\n        const hash = okhash(xml2str(styles[k])).toString(16);\n        styleIndex['#' + attr(styles[k], 'id')] = hash;\n        styleByHash[hash] = styles[k];\n      }\n      for (let l = 0; l < styleMaps.length; l++) {\n        styleIndex['#' + attr(styleMaps[l], 'id')] = okhash(xml2str(styleMaps[l])).toString(16);\n        const pairs = get(styleMaps[l], 'Pair');\n        const pairsMap = {};\n        for (let m = 0; m < pairs.length; m++) {\n          pairsMap[nodeVal(get1(pairs[m], 'key'))] = nodeVal(get1(pairs[m], 'styleUrl'));\n        }\n        styleMapIndex['#' + attr(styleMaps[l], 'id')] = pairsMap;\n\n      }\n      \n      \n      for (let j = 0; j < placemarks.length; j++) {\n        gj.features = gj.features.concat(getPlacemark(placemarks[j]));\n      }\n\n      // Helper to collect extra tags into properties\n      // added from here\n      extraTagsOption = options.extraTags ?? ['aqi'];\n      \n      function addExtraTags(root, properties) {\n        // Array mode: pick selected tags\n        if (Array.isArray(extraTagsOption)) {\n          for (const tag of extraTagsOption) {\n            const el = get1(root, tag);\n            if (el) {\n              const key = tag; // keep as-is (e.g., 'aqi')\n              if (properties[key] === undefined) properties[key] = nodeVal(el);\n            }\n          }\n          return;\n        }\n        // Auto mode: include all unhandled direct child elements\n        if (extraTagsOption === 'auto' || extraTagsOption === true) {\n          for (let i = 0; i < root.childNodes.length; i++) {\n            const node = root.childNodes[i];\n            if (node.nodeType === 1) {\n              const local = node.localName ? node.localName.toLowerCase() : (node.nodeName || '').toLowerCase();\n              if (!excludeDirectChildren.has(local) && properties[local] === undefined) {\n                properties[local] = nodeVal(node);\n              }\n            }\n          }\n        }\n      }\n      // to here\n      \n      function kmlColor(v) {\n        let color, opacity;\n        v = v || '';\n        if (v.substr(0, 1) === '#') { v = v.substr(1); }\n        if (v.length === 6 || v.length === 3) { color = v; }\n        if (v.length === 8) {\n          opacity = parseInt(v.substr(0, 2), 16) / 255;\n          color = '#' + v.substr(6, 2) +\n            v.substr(4, 2) +\n            v.substr(2, 2);\n        }\n        return [color, isNaN(opacity) ? undefined : opacity];\n      }\n      function gxCoord(v) { return numarray(v.split(' ')); }\n      function gxCoords(root) {\n        let elems = get(root, 'coord', 'gx');\n        const coords = [], times = [];\n        if (elems.length === 0) elems = get(root, 'gx:coord');\n        for (let i = 0; i < elems.length; i++) coords.push(gxCoord(nodeVal(elems[i])));\n        const timeElems = get(root, 'when');\n        for (let j = 0; j < timeElems.length; j++) times.push(nodeVal(timeElems[j]));\n        return {\n          coords: coords,\n          times: times\n        };\n      }\n      function getGeometry(root) {\n        let geomNode, geomNodes, i, j, k;\n        const geoms = [], coordTimes = [];\n        if (get1(root, 'MultiGeometry')) { return getGeometry(get1(root, 'MultiGeometry')); }\n        if (get1(root, 'MultiTrack')) { return getGeometry(get1(root, 'MultiTrack')); }\n        if (get1(root, 'gx:MultiTrack')) { return getGeometry(get1(root, 'gx:MultiTrack')); }\n        for (i = 0; i < geotypes.length; i++) {\n          geomNodes = get(root, geotypes[i]);\n          if (geomNodes) {\n            for (j = 0; j < geomNodes.length; j++) {\n              geomNode = geomNodes[j];\n              if (geotypes[i] === 'Point') {\n                const coordsText = nodeVal(get1(geomNode, 'coordinates'));\n                if (coordsText && coordsText.trim().length) {\n                  geoms.push({\n                    type: 'Point',\n                    coordinates: coord1(coordsText)\n                  });\n                }\n              } else if (geotypes[i] === 'LineString') {\n                const coordsText = nodeVal(get1(geomNode, 'coordinates'));\n                if (coordsText && coordsText.trim().length) {\n                  geoms.push({\n                    type: 'LineString',\n                    coordinates: coord(coordsText)\n                  });\n                }\n              } else if (geotypes[i] === 'Polygon') {\n                const rings = get(geomNode, 'LinearRing'),\n                  coords = [];\n                for (k = 0; k < rings.length; k++) {\n                  const ringCoordsText = nodeVal(get1(rings[k], 'coordinates'));\n                  if (ringCoordsText && ringCoordsText.trim().length) {\n                    coords.push(coord(ringCoordsText));\n                  }\n                }\n                if (coords.length) {\n                  geoms.push({\n                    type: 'Polygon',\n                    coordinates: coords\n                  });\n                }\n              } else if (geotypes[i] === 'Track' ||\n                geotypes[i] === 'gx:Track') {\n                const track = gxCoords(geomNode);\n                geoms.push({\n                  type: 'LineString',\n                  coordinates: track.coords\n                });\n                if (track.times.length) coordTimes.push(track.times);\n              }\n            }\n          }\n        }\n        return {\n          geoms: geoms,\n          coordTimes: coordTimes\n        };\n      }\n      \n      \n      function getPlacemark(root) {\n        let i, styleUrl = nodeVal(get1(root, 'styleUrl')),\n          lineStyle = get1(root, 'LineStyle'),\n          polyStyle = get1(root, 'PolyStyle');\n        const geomsAndTimes = getGeometry(root), properties = {},\n          name = nodeVal(get1(root, 'name')),\n          address = nodeVal(get1(root, 'address')),\n          description = nodeVal(get1(root, 'description')),\n          timeSpan = get1(root, 'TimeSpan'),\n          timeStamp = get1(root, 'TimeStamp'),\n          extendedData = get1(root, 'ExtendedData'),\n          visibility = get1(root, 'visibility');\n\n        if (!geomsAndTimes.geoms.length) return [];\n        if (name) properties.name = name;\n        if (address) properties.address = address;\n        if (styleUrl) {\n          if (styleUrl[0] !== '#') {\n            styleUrl = '#' + styleUrl;\n          }\n\n          properties.styleUrl = styleUrl;\n          if (styleIndex[styleUrl]) {\n            properties.styleHash = styleIndex[styleUrl];\n          }\n          if (styleMapIndex[styleUrl]) {\n            properties.styleMapHash = styleMapIndex[styleUrl];\n            properties.styleHash = styleIndex[styleMapIndex[styleUrl].normal];\n          }\n          // Try to populate the lineStyle or polyStyle since we got the style hash\n          const style = styleByHash[properties.styleHash];\n          if (style) {\n            if (!lineStyle) lineStyle = get1(style, 'LineStyle');\n            if (!polyStyle) polyStyle = get1(style, 'PolyStyle');\n            const iconStyle = get1(style, 'IconStyle');\n            if (iconStyle) {\n              const icon = get1(iconStyle, 'Icon');\n              if (icon) {\n                const href = nodeVal(get1(icon, 'href'));\n                if (href) properties.icon = href;\n              }\n            }\n          }\n        }\n        if (description) properties.description = description;\n        if (timeSpan) {\n          const begin = nodeVal(get1(timeSpan, 'begin'));\n          const end = nodeVal(get1(timeSpan, 'end'));\n          properties.timespan = { begin: begin, end: end };\n        }\n        if (timeStamp) {\n          properties.timestamp = nodeVal(get1(timeStamp, 'when'));\n        }\n        if (lineStyle) {\n          const linestyles = kmlColor(nodeVal(get1(lineStyle, 'color'))),\n            color = linestyles[0],\n            opacity = linestyles[1],\n            width = parseFloat(nodeVal(get1(lineStyle, 'width')));\n          if (color) properties.stroke = color;\n          if (!isNaN(opacity)) properties['stroke-opacity'] = opacity;\n          if (!isNaN(width)) properties['stroke-width'] = width;\n        }\n        if (polyStyle) {\n          const polystyles = kmlColor(nodeVal(get1(polyStyle, 'color'))),\n            pcolor = polystyles[0],\n            popacity = polystyles[1],\n            fill = nodeVal(get1(polyStyle, 'fill')),\n            outline = nodeVal(get1(polyStyle, 'outline'));\n          if (pcolor) properties.fill = pcolor;\n          if (!isNaN(popacity)) properties['fill-opacity'] = popacity;\n          if (fill) properties['fill-opacity'] = fill === '1' ? properties['fill-opacity'] || 1 : 0;\n          if (outline) properties['stroke-opacity'] = outline === '1' ? properties['stroke-opacity'] || 1 : 0;\n        }\n        \n        // After known properties, add extra tags (e.g., aqi)\n        addExtraTags(root, properties);\n\n        if (extendedData) {\n          const datas = get(extendedData, 'Data'),\n            simpleDatas = get(extendedData, 'SimpleData');\n\n          for (i = 0; i < datas.length; i++) {\n            properties[datas[i].getAttribute('name')] = nodeVal(get1(datas[i], 'value'));\n          }\n          for (i = 0; i < simpleDatas.length; i++) {\n            properties[simpleDatas[i].getAttribute('name')] = nodeVal(simpleDatas[i]);\n          }\n        }\n        if (visibility) {\n          properties.visibility = nodeVal(visibility);\n        }\n        if (geomsAndTimes.coordTimes.length) {\n          properties.coordTimes = (geomsAndTimes.coordTimes.length === 1) ?\n            geomsAndTimes.coordTimes[0] : geomsAndTimes.coordTimes;\n        }\n        const feature = {\n          type: 'Feature',\n          geometry: (geomsAndTimes.geoms.length === 1) ? geomsAndTimes.geoms[0] : {\n            type: 'GeometryCollection',\n            geometries: geomsAndTimes.geoms\n          },\n          properties: properties\n        };\n        if (attr(root, 'id')) feature.id = attr(root, 'id');\n        return [feature];\n      }\n      return gj;\n    },\n    gpx: function (doc) {\n      let i, feature;\n      const tracks = get(doc, 'trk'),\n        routes = get(doc, 'rte'),\n        waypoints = get(doc, 'wpt'),\n        // a feature collection\n        gj = fc();\n      for (i = 0; i < tracks.length; i++) {\n        feature = getTrack(tracks[i]);\n        if (feature) gj.features.push(feature);\n      }\n      for (i = 0; i < routes.length; i++) {\n        feature = getRoute(routes[i]);\n        if (feature) gj.features.push(feature);\n      }\n      for (i = 0; i < waypoints.length; i++) {\n        gj.features.push(getPoint(waypoints[i]));\n      }\n      function initializeArray(arr, size) {\n        for (let h = 0; h < size; h++) {\n          arr.push(null);\n        }\n        return arr;\n      }\n      function getPoints(node, pointname) {\n        const pts = get(node, pointname),\n          line = [],\n          times = [],\n          heartRates = [],\n          l = pts.length;\n        if (l < 2) {\n          console.error('toGeoJSON: a line must have at least two points');\n          return {};  // Invalid line in GeoJSON\n        }\n        for (let i = 0; i < l; i++) {\n          const c = coordPair(pts[i]);\n          line.push(c.coordinates);\n          if (c.time) times.push(c.time);\n          if (c.heartRate || heartRates.length) {\n            if (!heartRates.length) initializeArray(heartRates, i);\n            heartRates.push(c.heartRate || null);\n          }\n        }\n        return {\n          line: line,\n          times: times,\n          heartRates: heartRates\n        };\n      }\n      function getTrack(node) {\n        let line;\n        const segments = get(node, 'trkseg'),\n          track = [],\n          times = [],\n          heartRates = [];\n        for (let i = 0; i < segments.length; i++) {\n          line = getPoints(segments[i], 'trkpt');\n          if (line) {\n            if (line.line) track.push(line.line);\n            if (line.times && line.times.length) times.push(line.times);\n            if (heartRates.length || (line.heartRates && line.heartRates.length)) {\n              if (!heartRates.length) {\n                for (let s = 0; s < i; s++) {\n                  heartRates.push(initializeArray([], track[s].length));\n                }\n              }\n              if (line.heartRates && line.heartRates.length) {\n                heartRates.push(line.heartRates);\n              } else {\n                heartRates.push(initializeArray([], line.line.length || 0));\n              }\n            }\n          }\n        }\n        if (track.length === 0) return;\n        const properties = getProperties(node);\n        extend(properties, getLineStyle(get1(node, 'extensions')));\n        if (times.length) properties.coordTimes = track.length === 1 ? times[0] : times;\n        if (heartRates.length) properties.heartRates = track.length === 1 ? heartRates[0] : heartRates;\n        return {\n          type: 'Feature',\n          properties: properties,\n          geometry: {\n            type: track.length === 1 ? 'LineString' : 'MultiLineString',\n            coordinates: track.length === 1 ? track[0] : track\n          }\n        };\n      }\n      function getRoute(node) {\n        const line = getPoints(node, 'rtept');\n        if (!line.line) return;\n        const prop = getProperties(node);\n        extend(prop, getLineStyle(get1(node, 'extensions')));\n        const routeObj = {\n          type: 'Feature',\n          properties: prop,\n          geometry: {\n            type: 'LineString',\n            coordinates: line.line\n          }\n        };\n        return routeObj;\n      }\n      function getPoint(node) {\n        const prop = getProperties(node);\n        extend(prop, getMulti(node, ['sym']));\n        return {\n          type: 'Feature',\n          properties: prop,\n          geometry: {\n            type: 'Point',\n            coordinates: coordPair(node).coordinates\n          }\n        };\n      }\n      function getLineStyle(extensions) {\n        const style = {};\n        if (extensions) {\n          const lineStyle = get1(extensions, 'line');\n          if (lineStyle) {\n            const color = nodeVal(get1(lineStyle, 'color')),\n              opacity = parseFloat(nodeVal(get1(lineStyle, 'opacity'))),\n              width = parseFloat(nodeVal(get1(lineStyle, 'width')));\n            if (color) style.stroke = color;\n            if (!isNaN(opacity)) style['stroke-opacity'] = opacity;\n            // GPX width is in mm, convert to px with 96 px per inch\n            if (!isNaN(width)) style['stroke-width'] = width * 96 / 25.4;\n          }\n        }\n        return style;\n      }\n      function getProperties(node) {\n        const prop = getMulti(node, ['name', 'cmt', 'desc', 'type', 'time', 'keywords']),\n          links = get(node, 'link');\n        if (links.length) prop.links = [];\n        for (let i = 0, link; i < links.length; i++) {\n          link = { href: attr(links[i], 'href') };\n          extend(link, getMulti(links[i], ['text', 'type']));\n          prop.links.push(link);\n        }\n        return prop;\n      }\n      return gj;\n    }\n  };\n  return t;\n})();\n\n// if (typeof module !== 'undefined') module.exports = toGeoJSON;\n\n\n// Copyright (c) 2016 Mapbox All rights reserved.\n// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n// 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, \n// INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, \n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; \n// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF \n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n","import { ref } from 'vue';\n\n\n/** composeable\n * @description \n * A composable providing an abortable fetch function using the AbortController API.\n * \n * Usage:\n * ```\n * const { loading, error, abortController, abortableFetch, abort } = useAbortableFetch();\n * ```\n * - `loading`: provides access to current loading state\n * - `error`: provides access to non-abort errors encountered during fetch (all errors are thrown, include abort)\n * - `abortController`: provides access to the current AbortController, if any\n * - `abort(msg)`: aborts the current fetch request and clears the controller (set to null)\n * \n * adapted from https://stackoverflow.com/a/62992971/11594175\n */\nexport function useAbortableFetch() {\n  const loading = ref(false);\n  const error = ref<Error | null>(null);\n  const abortController = ref<AbortController | null>(null);\n\n\n  function abortableFetch(input: string | Request | URL, init?: RequestInit): Promise<Response> {\n    const controller = new AbortController();\n    const signal = controller.signal;\n    abortController.value = controller;\n\n    loading.value = true;\n    error.value = null;\n    \n\n    return fetch(input, { ...init, signal: signal })\n      .then((response) => response) // directly return the response. Handle HTTP errors when calling it\n      .catch((err: Error) => { // rethrow the error to avoid returning Promise<void>\n        if (err.name === 'AbortError') {\n          console.error('useKML: Fetch aborted with message:', err.message);\n        } else {\n          error.value = err;\n        }\n        throw err;\n      })\n      .finally(() => {\n        loading.value = false;\n        abortController.value = null;\n      });\n  }\n\n  function abort(msg: string = 'Fetch aborted by Abort Controller'): void {\n    if (abortController.value) {\n      abortController.value.abort(msg);\n      abortController.value = null;\n    }\n  }\n\n  return {\n    loading,\n    error,\n    abortController,\n    abortableFetch,\n    abort,\n  };\n}","import { ref, type Ref, onBeforeUnmount } from 'vue';\nimport toGeoJSON from '../togeojson.js';\nimport { useAbortableFetch } from './useAbortableFetch';\n\n\nexport interface KMLResource {\n  kmlUrl: Ref<string>\n  geoJsonData: Ref<GeoJSON.FeatureCollection | null>\n  loading: Ref<boolean>\n  error: Ref<Error | null>\n  setUrl: (newUrl: string) => Promise<void>\n  loadKML: () => Promise<unknown>\n  cleanUp: () => void\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString#error_handling\nfunction parseXML(xmlString: string): Document | null {\n  const parser = new DOMParser();\n\n  const doc = parser.parseFromString(xmlString, \"application/xml\");\n  const errorNode = doc.querySelector(\"parsererror\");\n  if (errorNode) {\n    return null;\n  } else {\n    return doc;\n  }\n}\n\nexport function useKML(url: string): KMLResource {\n  const { loading, error, abortController, abortableFetch, abort } = useAbortableFetch();\n  const kmlUrl = ref(url);\n  const geoJsonData = ref<GeoJSON.FeatureCollection | null>(null);\n\n  // Convert KML to GeoJSON\n  const _convertKmlToGeoJson = (kmlContent: string): GeoJSON.FeatureCollection => {\n    \n    const kmlDoc = parseXML(kmlContent);\n    if (!kmlDoc) {\n      throw new Error('Invalid KML format');\n    }\n    // Convert using local togeojson library\n    const geoJson = toGeoJSON.kml(kmlDoc, { styles: true }) as GeoJSON.FeatureCollection;\n\n    \n    return geoJson;\n      \n  };\n\n\n  // Load KML from URL\n  async function loadKML() {\n    \n    const requestedUrl = kmlUrl.value;\n\n    // Abort any in-flight request\n    if (abortController.value) {\n      abort('Aborting previous KML fetch due to new request');\n    }\n    \n\n    return abortableFetch(requestedUrl).then((response) => {\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return response;\n      \n    })\n      .then((response) => response.text())\n      .then((kmlContent) => {\n        \n        // short-circuit lengthy processing if URL changed\n        if (requestedUrl !== kmlUrl.value) {\n          console.warn('KML URL changed during fetch, ignoring this result');\n          return;\n        }\n        \n        // convert Kml to GeoJSON and save to ref\n        const geoJson = _convertKmlToGeoJson(kmlContent);\n        if (requestedUrl !== kmlUrl.value) {\n          console.warn('KML URL changed during KML parsing, ignoring this result');\n          return;\n        }\n        if (geoJson) {\n          geoJsonData.value = geoJson;\n        }\n        \n        return kmlContent;\n      })\n      .catch((err) => {\n        // only error if not abort\n        if (err.name === 'AbortError') {\n          console.warn('KML fetch aborted:', err.message);\n        } else {\n          console.error('Error fetching KML:', err);\n        }\n      });\n    \n  }\n\n\n  // Change URL and refresh layer\n  async function setUrl(newUrl: string) {\n    const next = (newUrl || '').trim();\n    // right now lets avoid loops.\n    if (next !== kmlUrl.value) {\n      kmlUrl.value = next;\n    } // avoid loops\n\n    // Abort any in-flight fetch before switching\n    if (abortController.value) {\n      abort('Aborting previous KML fetch due to URL change');\n    }\n    \n    geoJsonData.value = null;\n    error.value = null;\n  }\n\n  // Watch for URL changes to auto-reload (will be idempotent due to early return)\n  // watch(kmlUrl, (newUrl) => {\n  //   console.log('KML URL changed, reloading:', kmlUrl.value);\n  //   setUrl(newUrl);\n  // });\n\n  // Remove from map\n  function cleanUp() {\n    // Abort any in-flight fetch\n    if (abortController.value) {\n      abort('Aborting KML fetch due to layer removal');\n    }\n  }\n  \n  onBeforeUnmount(() => {\n    cleanUp();\n  });\n  return {\n    geoJsonData,\n    loadKML,\n    loading,\n    error,\n    kmlUrl,\n    setUrl,\n    cleanUp,\n  };\n}","/* eslint-disable @typescript-eslint/naming-convention */\n\n// https://www.ospo.noaa.gov/products/land/hms.html#about\n// https://www.usgs.gov/centers/eros/science/usgs-eros-archive-land-cover-products-global-land-cover-characterization-glcc?qt-science_center_objects=0#qt-science_center_objects\n// https://www.usgs.gov/media/files/global-land-cover-characteristics-data-base-readme-version2 -- appendix 1\n/**\n * Global Land Cover Characteristics Data Base Version 2.0\n * Appendix 1: Global Ecosystems Legend\n */\nenum GlobalEcosystems {\n  Urban = 1,\n  LowSparseGrassland = 2,\n  ConiferousForest = 3,\n  DeciduousConiferForest = 4,\n  DeciduousBroadleafForest = 5,\n  EvergreenBroadleafForests = 6,\n  TallGrassesAndShrubs = 7,\n  BareDesert = 8,\n  UplandTundra = 9,\n  IrrigatedGrassland = 10,\n  SemiDesert = 11,\n  GlacierIce = 12,\n  WoodedWetSwamp = 13,\n  InlandWater = 14,\n  SeaWater = 15,\n  ShrubEvergreen = 16,\n  ShrubDeciduous = 17,\n  MixedForestAndField = 18,\n  EvergreenForestAndFields = 19,\n  CoolRainForest = 20,\n  ConiferBorealForest = 21,\n  CoolConiferForest = 22,\n  CoolMixedForest = 23,\n  MixedForest = 24,\n  CoolBroadleafForest = 25,\n  DeciduousBroadleafForest_2 = 26, // Note: Value 5 is also \"Deciduous Broadleaf Forest\"\n  ConiferForest = 27,\n  MontaneTropicalForests = 28,\n  SeasonalTropicalForest = 29,\n  CoolCropsAndTowns = 30,\n  CropsAndTown = 31,\n  DryTropicalWoods = 32,\n  TropicalRainforest = 33,\n  TropicalDegradedForest = 34,\n  CornAndBeansCropland = 35,\n  RicePaddyAndField = 36,\n  HotIrrigatedCropland = 37,\n  CoolIrrigatedCropland = 38,\n  ColdIrrigatedCropland = 39,\n  CoolGrassesAndShrubs = 40,\n  HotAndMildGrassesAndShrubs = 41,\n  ColdGrassland = 42,\n  SavannaWoods = 43,\n  MireBogFen = 44,\n  MarshWetland = 45,\n  MediterraneanScrub = 46,\n  DryWoodyScrub = 47,\n  DryEvergreenWoods = 48,\n  VolcanicRock = 49,\n  SandDesert = 50,\n  SemiDesertShrubs = 51,\n  SemiDesertSage = 52,\n  BarrenTundra = 53,\n  CoolSouthernHemisphereMixedForests = 54,\n  CoolFieldsAndWoods = 55,\n  ForestAndField = 56,\n  CoolForestAndField = 57,\n  FieldsAndWoodySavanna = 58,\n  SucculentAndThornScrub = 59,\n  SmallLeafMixedWoods = 60,\n  DeciduousAndMixedBorealForest = 61,\n  NarrowConifers = 62,\n  WoodedTundra = 63,\n  HeathScrub = 64,\n  CoastalWetlandNW = 65,\n  CoastalWetlandNE = 66,\n  CoastalWetlandSE = 67,\n  CoastalWetlandSW = 68,\n  PolarAndAlpineDesert = 69,\n  GlacierRock = 70,\n  SaltPlayas = 71,\n  Mangrove = 72,\n  WaterAndIslandFringe = 73,\n  LandWaterAndShore = 74,\n  LandAndWaterRivers = 75,\n  CropAndWaterMixtures = 76,\n  SouthernHemisphereConifers = 77,\n  SouthernHemisphereMixedForest = 78,\n  WetSclerophylicForest = 79,\n  CoastlineFringe = 80,\n  BeachesAndDunes = 81,\n  SparseDunesAndRidges = 82,\n  BareCoastalDunes = 83,\n  ResidualDunesAndBeaches = 84,\n  CompoundCoastlines = 85,\n  RockyCliffsAndSlopes = 86,\n  SandyGrasslandAndShrubs = 87,\n  Bamboo = 88,\n  MoistEucalyptus = 89,\n  RainGreenTropicalForest = 90,\n  WoodySavanna = 91,\n  BroadleafCrops = 92,\n  GrassCrops = 93,\n  CropsGrassShrubs = 94,\n  EvergreenTreeCrop = 95,\n  DeciduousTreeCrop = 96,\n  InterruptedAreas = 99,\n  MissingData = 100\n}\n\nexport function glccLabel(code: GlobalEcosystems): string {\n  const label = GlobalEcosystems[code];\n  // convert from camel case to normal words with capitalized first letters\n  return label.replace(/([a-z])([A-Z])/g, '$1 $2').replace(/\\b\\w/g, c => c.toUpperCase());\n}","import { ref, watch, computed, type WritableComputedRef, type Ref, onBeforeUnmount } from 'vue';\nimport M from 'maplibre-gl';\nimport { Popup } from 'maplibre-gl';\nimport { useKML } from './useKML';\n\n\n\nexport type InternalMapLayerEventType = M.MapMouseEvent & {features?: M.MapGeoJSONFeature[];};\nexport type InternalMapLayerEventTypeHandler = (e: InternalMapLayerEventType) => void;\n\nexport const replaceYearDay = (s: string | null): string | null => {\n  if (!s) return null;\n  const m = s.match(/(YearDay: )(\\d{7})/);\n  if (!m) return null;\n  const [, prefix, ydd] = m;\n  const y = parseInt(ydd.substring(0, 4));\n  const d = parseInt(ydd.substring(4));\n  const dateStr = new Date(y, 0, d).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });\n  \n  return s.replace(m[0], prefix + dateStr);\n};\n\nimport { glccLabel } from '../utils/glcc';\n\nexport const replaceEcosystem = (s: string | null): string | null => {\n  if (!s) return null;\n  const m = s.match(/(Ecosystem: )(\\d+)/);\n  if (!m) return s;\n  const [, prefix, numStr] = m;\n  const label = glccLabel(parseInt(numStr));\n  \n  return s.replace(m[0], prefix + label);\n};\n\n\nexport interface HMSLayer {\n  addToMap: (map: M.Map) => Promise<void>\n  removeFromMap: (map: M.Map) => void\n  geoJsonData: Ref<GeoJSON.FeatureCollection | null>\n  loading: Ref<boolean>\n  error: Ref<Error | null>\n  layerVisible: WritableComputedRef<boolean>\n  toggleHMSVisibility: (vis?: boolean | undefined) => void\n  setUrl: (newUrl: string) => Promise<void>\n}\n\n// Optional settings for labels\nexport interface UseKMLOptions {\n  labelMinZoom?: number;            // min zoom at which labels appear\n  layerName: string;               // custom id base for source/layers, e.g. 'fire'\n  showPopup?: boolean;            // whether to show popup on click/hover\n  showLabel?: boolean;           // whether to show labels\n  visible?: boolean;              // initial visibility state; defaults to true\n}\n\n// description\nfunction description2props(desc: string | null): Record<string, string | number> {\n  const props: Record<string, string | number> = {};\n  if (!desc) return props;\n  const vals = desc.split('<br>');\n  vals.reduce((acc, pair) => {\n    const [key, value] = pair.split(':').map(s => s.trim());\n    if (key && value) {\n      acc[key] = isNaN(parseFloat(value)) ? value : parseFloat(value);\n    }\n    return acc;\n  }, props);\n  return props;\n}\n\n// Post-process GeoJSON to apply styleUrl-based HMS coloring\nconst postProcessGeoJson = (geoJson: GeoJSON.FeatureCollection): GeoJSON.FeatureCollection => {\n  const processedFeatures = geoJson.features.map((feature) => {\n    const processedFeature = { ...feature };\n    const props = processedFeature.properties || {};\n    // const styleUrl = props.styleUrl ?? props.styleURL ?? null;\n    processedFeature.properties = {\n      ...props,\n      ...props.description ? description2props(props.description as string) : {},\n    };\n    return processedFeature;\n  });\n  \n  const features = processedFeatures\n    .filter(f => f.properties && f.properties.FRP > 0)\n    .sort((a, b) => (a?.properties?.FRP || 0) - (b?.properties?.FRP || 0)); // descending FRP\n\n  return {\n    ...geoJson,\n    features: features,\n  };\n};\n\n\nexport function addHMSFire(date: Ref<Date>, options: UseKMLOptions = {layerName: 'hms-layer'}) {\n\n  const url = computed(() => {\n    const _date = date.value;\n    if (!_date) {\n      return 'https://satepsanone.nesdis.noaa.gov/pub/FIRE/web/HMS/Fire_Points/KML/2025/09/hms_fire20250914.kml';\n    }\n    const year = _date.getUTCFullYear();\n    const month = (_date.getUTCMonth() + 1).toString().padStart(2, '0');\n    const day = _date.getUTCDate().toString().padStart(2, '0');\n    return `https://worldwidetelescope.org/webserviceproxy.aspx?targeturl=https://satepsanone.nesdis.noaa.gov/pub/FIRE/web/HMS/Fire_Points/KML/${year}/${month}/hms_fire${year}${month}${day}.kml`;\n  });\n  \n  const { geoJsonData, loading, error, setUrl: internalSetUrl, loadKML, cleanUp } = useKML(url.value);\n  \n  watch(url, (newUrl) => {\n    setUrl(newUrl).catch(() => {/* ignore */});\n  });\n  \n  function getYearDay(date: Date): number {\n    const dayOfYear = Math.floor((date.getTime() - new Date(date.getFullYear(), 0, 0).getTime()) / (1000 * 60 * 60 * 24));\n    return Math.floor(date.getFullYear() * 1000 + dayOfYear);\n  }\n  \n  const yearDay = computed(() => {\n    const _date = date.value;\n    if (!_date) {\n      return 2025001; // Jan 1, 2025\n    }\n    return getYearDay(_date);\n  });\n\n  const showPopup = options.showPopup ?? true;\n\n  // Store runtime state in refs (avoid caching on the function)\n  const mapRef = ref<M.Map | null>(null);\n  const idBase = options.layerName ? options.layerName : '';\n  const sourceId = `${idBase}-source`;\n  const layerId = idBase;\n  const labelLayerId = layerId + '-label';\n\n  const popupRef = ref<Popup | null>(null);\n  const onEnterRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onMoveRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onLeaveRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onStyleDataRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n\n  // Track the last known layer visibility across URL changes (persisted)\n  const lastKnownVisible = ref<boolean>(options.visible ?? true); \n\n  // layerVisible reflects actual map state; falls back to lastKnownVisible if layer missing\n  const layerVisible = computed<boolean>({\n    get() {\n      const map = mapRef.value;\n      if (!map) {\n        console.warn(`HMS: Tried to get ${layerId} but map is not set`);\n        return lastKnownVisible.value;\n      }\n      if (!map.getLayer(layerId)) {\n        console.warn(`HMS: Tried to get ${layerId} but layer is not present on map`);\n        return lastKnownVisible.value;\n      }\n      \n      const vis = map.getLayoutProperty(layerId, 'visibility');\n      return vis === 'visible';\n    },\n    set(val: boolean) {\n      lastKnownVisible.value = val;\n      const map = mapRef.value;\n      if (!map) {\n        console.warn(`HMS: Tried to get ${layerId} but map is not set`);\n        return lastKnownVisible.value;\n      }\n      if (!map.getLayer(layerId)) {\n        console.warn(`HMS: Tried to get ${layerId} but layer is not present on map`);\n        return lastKnownVisible.value;\n      }\n      \n      const vis = val ? 'visible' : 'none';\n      map.setLayoutProperty(layerId, 'visibility', vis);\n      if (map.getLayer(labelLayerId)) {\n        map.setLayoutProperty(labelLayerId, 'visibility', vis);\n      }\n    }\n  });\n\n\n  \n  function preloadImages(map: M.Map, images: Record<string, string>)  {\n    return Promise.all(Object.entries(images).map(([name, url]) => {\n      url = \"./FireIcon.png\";\n      if (map.hasImage(name)) {\n        return;\n      }\n      return map.loadImage(url)\n        .then((img) => {\n          map.addImage(name, img.data);\n        });\n    }));\n  }\n\n  \n  function setupLayerPopup(map: M.Map, layerId: string) {\n    const popup = new Popup({ closeButton: false, closeOnClick: false, maxWidth: '200px', className: 'hms-popup' });\n    const onEnter = (e: InternalMapLayerEventType) => {\n      map.getCanvas().style.cursor = 'pointer';\n      const f = e.features && e.features[0];\n      if (f?.properties?.description) {\n        const desc = f?.properties?.description ; \n        popup\n          .setLngLat(e.lngLat)\n          .setHTML(replaceEcosystem(replaceYearDay(desc)) || '')\n          .addTo(map)\n          .addClassName('hms-popup');\n      }\n    };\n    const onMove = (e: InternalMapLayerEventType) => {\n      popup.setLngLat(e.lngLat);\n      const f = e.features && e.features[0];\n      if (f?.properties?.description) {\n        popup.setHTML(replaceEcosystem(replaceYearDay(f?.properties?.description)) || '');\n      }\n    };\n    const onLeave = () => {\n      map.getCanvas().style.cursor = '';\n      popup.remove();\n    };\n    \n    map.on('mouseenter', layerId, () => {\n      map.getCanvas().style.cursor = 'pointer';\n    });\n    map.on('click', layerId, onEnter);\n    map.on('mousemove', layerId, onMove);\n    map.on('mouseleave', layerId, onLeave);\n\n    // Store state in refs (not on function)\n    popupRef.value = popup;\n    onEnterRef.value = onEnter;\n    onMoveRef.value = onMove;\n    onLeaveRef.value = onLeave;\n  }\n\n  function setupVisibilitySync(map: M.Map) {\n    // Keep label visibility equal to main layer & sync external visibility changes\n    const syncLabelVisibility = () => {\n      if (!map.getLayer(layerId)) return;\n      const mainVis = (map.getLayoutProperty(layerId, 'visibility') as string) || 'visible';\n      const isVisible = mainVis === 'visible';\n      if (lastKnownVisible.value !== isVisible) {\n        lastKnownVisible.value = isVisible;\n      }\n      if (map.getLayer(labelLayerId)) {\n        const labelVis = (map.getLayoutProperty(labelLayerId, 'visibility') as string) || 'visible';\n        if (labelVis !== mainVis) {\n          map.setLayoutProperty(labelLayerId, 'visibility', mainVis);\n        }\n      }\n    };\n    \n    syncLabelVisibility();\n    // idle takes a bit longer than styledata, and the user can tell\n    // but idle would be less frequent i think\n    map.on('styledata', syncLabelVisibility); \n    onStyleDataRef.value = syncLabelVisibility;\n  }\n\n\n  const cleanupMapLayers = () => {\n    const map = mapRef.value;\n    if (map) {\n      if (map.getLayer(labelLayerId)) { \n        map.removeLayer(labelLayerId);\n      }\n      \n      if (map.getLayer(layerId)) {\n        map.removeLayer(layerId);\n      }\n      if (map.getLayer(layerId+'-circle')) {\n        map.removeLayer(layerId+'-circle');\n      }\n      if (map.getSource(sourceId)) {\n        map.removeSource(sourceId);\n      }\n    }\n  };\n\n  // Add GeoJSON to map\n  const addToMap = async (map: M.Map): Promise<void> => {\n    // Always store map first so subsequent retries have a reference\n    mapRef.value = map;\n    \n    // Load KML if not already loaded\n    if (!geoJsonData.value) {\n      // console.log('HMS: No GeoJSON data, loading KML from URL:', kmlUrl.value);\n      await loadKML();\n    }\n    if (!geoJsonData.value) {\n      throw new Error('No GeoJSON data available');\n    }\n\n    // Remove existing layer and source if they exist\n    cleanupMapLayers();\n    \n    const images: Record<string, string> = {};\n    geoJsonData.value.features.forEach((feature) => {\n      const props = feature.properties || {};\n      const iconUrl: string = props.icon;\n      const styleUrl = props.styleUrl || iconUrl.split('/').pop(); \n      if (iconUrl && typeof iconUrl === 'string' && !(iconUrl in images)) {\n        images[styleUrl] = iconUrl;\n      }\n    });\n    // Preload all icons\n    preloadImages(map, images)\n      .then(() => {\n        if (!geoJsonData.value) {\n          throw new Error('No GeoJSON data available after image preload');\n        }\n        // Add new source and layer\n        map.addSource(sourceId, {\n          type: 'geojson',\n          data: postProcessGeoJson(geoJsonData.value)\n        });\n\n        // Add point layer colored by 'marker-color'\n        map.addLayer({\n          id: layerId,\n          type: 'symbol',\n          source: sourceId,\n          paint: {\n            'icon-opacity': 1,\n          },\n          layout: {\n            'icon-image': ['coalesce', ['get', 'styleUrl'], 'circle-15'],\n            'icon-size': [\n              \"*\", \n              .025, \n              ['abs',['log10', [\n                '*', 10,\n                ['number', ['get', 'FRP']]\n              ]\n              ]]\n            ],\n            'icon-allow-overlap': true,\n            'visibility': lastKnownVisible.value ? 'visible' : 'none'\n          },\n          filter: [\n            'all',\n            ['>', ['get', 'FRP'], 1],\n            ['>', ['get', 'YearDay'], yearDay.value - 1]\n          ]\n        });\n        \n        \n        \n        \n        function circleRadiusExpression(meters: number, stops = [0, 5, 10, 15, 20]): M.DataDrivenPropertyValueSpecification<number> {\n          return [\n            \"interpolate\", [\"linear\"], [\"zoom\"],\n            ...stops.flatMap(z => [\n              z,\n              [\n                \"/\",\n                [\"*\", meters, Math.pow(2, z)],\n                [\"*\", 156543.03392, [\"cos\", [\"/\", [\"*\", Math.PI, [\"get\", \"Lat\"]], 180]]]\n              // eslint-disable-next-line @typescript-eslint/no-explicit-any\n              ] as any\n            ])\n          ];\n        }\n        \n        \n        \n        map.addLayer({\n          id: layerId+'-circle',\n          type: 'circle',\n          source: sourceId,\n          minzoom: 9,\n          // paint with a pale yellow to dark red scale based on FRP\n          layout: {\n            'visibility': lastKnownVisible.value ? 'visible' : 'none'\n          },\n          paint: {\n            // 375 meter radius using zoom, 'Lat', and 'Lon'\n            'circle-radius': circleRadiusExpression(375/2),\n            'circle-color': [\n              \"interpolate\",\n              [\"linear\"],\n              [\"get\", \"FRP\"],\n              0, \"rgb(255, 255, 204)\",       // pale yellow\n              1, \"rgb(255, 237, 160)\",\n              5, \"rgb(254, 178, 76)\",\n              10, \"rgb(240, 59, 32)\",\n              20, \"rgb(189, 0, 38)\",\n              50, \"rgb(128, 0, 38)\",           // dark red\n              1000, \"rgb(77, 0, 75)\"            // very dark red\n            ],\n            'circle-opacity': 0.5,\n            'circle-stroke-color': 'black',\n            // 'circle-stroke-width': 0.5,\n            // 'circle-stroke-opacity': 0.8\n          },\n          // filter for TimeDay \n          filter: ['>', ['get', 'YearDay'], yearDay.value-2],\n        });\n\n        // Optionally add labels\n        \n\n        \n        // Add popup/handlers if it hasn't been added yet\n        if (showPopup && popupRef.value === null) {\n          setupLayerPopup(map, layerId);\n        }\n        \n        // Even without labels still sync visibility (for external toggles)\n        if (onStyleDataRef.value === null) {\n          setupVisibilitySync(map);\n        }\n        \n      })\n      .catch((err) => {\n        console.error('HMS: Error adding KML layer to map:', err);\n        throw err;\n      });\n        \n    \n  };\n  \n  \n  // Optional: debug logging\n  // watch(layerVisible, (newVis) => {\n  //   console.log('HMS layer visibility changed to:', newVis);\n  // });\n\n  // Toggle visibility for main and label layers using the computed setter\n  const toggleFireVisibility = (val?: boolean | undefined): void => {\n    const next = val ?? !layerVisible.value;\n    layerVisible.value = next;\n  };\n\n  // Change URL and refresh layer\n  const setUrl = async (newUrl: string): Promise<void> => {\n    // console.log('HMS: Setting new KML URL:', newUrl);\n    cleanupMapLayers();\n    internalSetUrl(newUrl) // will automatically load new and abort prior\n      .then(() => {\n        const map = mapRef.value;\n\n        if (map) {\n          addToMap(map as never);\n        }\n      }).catch((err) => {\n        console.error('HMS: Error setting new KML URL:', err);\n      });\n  };\n\n  // Remove from map\n  const removeFromMap = (map: M.Map): void => {\n    cleanUp();\n    \n    // Remove hover handlers and popup\n    if (onEnterRef.value) map.off('click', layerId, onEnterRef.value);\n    if (onMoveRef.value) map.off('mousemove', layerId, onMoveRef.value);\n    if (onLeaveRef.value) map.off('mouseleave', layerId, onLeaveRef.value);\n    if (popupRef.value) popupRef.value.remove();\n    if (onStyleDataRef.value) map.off('styledata', onStyleDataRef.value);\n    // if (onStyleDataRef.value) map.off('idle', onStyleDataRef.value); \n\n    // Remove layers and source\n    cleanupMapLayers();\n\n    // Clear stored handlers/popup; keep mapRef so we can re-add later\n    popupRef.value = null;\n    onEnterRef.value = null;\n    onMoveRef.value = null;\n    onLeaveRef.value = null;\n  };\n  \n  onBeforeUnmount(() => {\n    const map = mapRef.value;\n    if (map) {\n      removeFromMap(map as never);\n      mapRef.value = null;\n    }\n  });\n  \n  return {\n    addToMap,\n    layerId,\n    removeFromMap,\n    geoJsonData,\n    loading,\n    error,\n    layerVisible,\n    toggleFireVisibility,\n    setUrl\n  };\n}\n","import { ref, computed, type WritableComputedRef, type Ref, onBeforeUnmount } from 'vue';\nimport M from 'maplibre-gl';\nimport { Popup } from 'maplibre-gl';\nimport { useKML } from './useKML';\n\n// AQI styleUrl -> color mapping (hex), derived from the\n// legend here https://gispub.epa.gov/airnow/?tab=archive\nconst AQI_STYLE_COLORS: Record<string, string> = {\n  '#undefined': '#D9D9D9',\n  '#normalstateundefined': '#D9D9D9',\n  '#highlightstateundefined': '#D9D9D9',\n  '#legendicon': '#D9D9D9',\n\n  '#good': '#00E400',\n  '#normalstategood': '#00E400',\n  '#highlightstategood': '#00E400',\n\n  '#moderate': '#FFFF00',\n  '#normalstatemoderate': '#FFFF00',\n  '#highlightstatemoderate': '#FFFF00',\n\n  '#unhealthysg': '#FF7E00',\n  '#normalstateunhealthysg': '#FF7E00',\n  '#highlightstateunhealthysg': '#FF7E00',\n\n  '#unhealthy': '#FF0000',\n  '#normalstateunhealthy': '#FF0000',\n  '#highlightstateunhealthy': '#FF0000',\n\n  '#veryunhealthy': '#8F3F97',\n  '#normalstateveryunhealthy': '#8F3F97',\n  '#highlightstateveryunhealthy': '#8F3F97',\n\n  '#hazardous': '#7E0023',\n  '#normalstatehazardous': '#7E0023',\n  '#highlightstatehazardous': '#7E0023'\n};\n\n// Normalize and resolve a styleUrl to an AQI color\nfunction getAqiColorFromStyleUrl(styleUrlRaw: string | null | undefined): string {\n  const key = (styleUrlRaw || '').trim();\n  if (!key) return '#D9D9D9';\n  // ensure hash prefix and lowercase for lookup\n  const normalized = (key.startsWith('#') ? key : `#${key}`).toLowerCase();\n  return AQI_STYLE_COLORS[normalized] || '#D9D9D9';\n}\n\nexport type InternalMapLayerEventType = M.MapMouseEvent & {features?: M.MapGeoJSONFeature[];};\nexport type InternalMapLayerEventTypeHandler = (e: InternalMapLayerEventType) => void;\n\nexport interface AQILayer {\n  addToMap: (map: M.Map) => Promise<void>\n  removeFromMap: (map: M.Map) => void\n  geoJsonData: Ref<GeoJSON.FeatureCollection | null>\n  loading: Ref<boolean>\n  error: Ref<Error | null>\n  layerVisible: WritableComputedRef<boolean>\n  toggleAQIVisibility: (vis?: boolean | undefined) => void\n  setUrl: (newUrl: string) => Promise<void>\n}\n\n// Optional settings for labels\nexport interface UseKMLOptions {\n  propertyToShow?: string | null;   // e.g., 'aqi'. If null/undefined, no labels are shown.\n  labelMinZoom?: number;            // min zoom at which labels appear\n  layerName?: string;               // custom id base for source/layers, e.g. 'aqi'\n  showPopup?: boolean;            // whether to show popup on click/hover\n  showLabel?: boolean;           // whether to show labels\n  visible?: boolean;              // initial visibility state; defaults to true\n}\n\n\n\nexport function addQUI(url: string, options: UseKMLOptions = {}): AQILayer {\n  const { geoJsonData, loading, error, setUrl: internalSetUrl, loadKML, cleanUp } = useKML(url);\n\n  const propertyToShow = options.propertyToShow ?? null;\n  const labelMinZoom = options.labelMinZoom ?? 8;\n  const showPopup = options.showPopup ?? true;\n  const showLabel = options.showLabel ?? true;\n\n  // Store runtime state in refs (avoid caching on the function)\n  const mapRef = ref<M.Map | null>(null);\n  const idBase = options.layerName ? options.layerName : '';\n  const sourceId = idBase ? `aqi-source-${idBase}` : 'aqi-source';\n  const layerId = idBase ? `aqi-layer-${idBase}` : 'aqi-layer';\n  const labelLayerId = layerId + '-label';\n\n  const popupRef = ref<Popup | null>(null);\n  const onEnterRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onMoveRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onLeaveRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n  const onStyleDataRef = ref<InternalMapLayerEventTypeHandler | null>(null);\n\n  // Track the last known layer visibility across URL changes (persisted)\n  const lastKnownVisible = ref<boolean>(options.visible ?? true); \n\n  // layerVisible reflects actual map state; falls back to lastKnownVisible if layer missing\n  const layerVisible = computed<boolean>({\n    get() {\n      const map = mapRef.value;\n      if (!map) {\n        console.warn(`AQI: Tried to get ${layerId} but map is not set`);\n        return lastKnownVisible.value;\n      }\n      if (!map.getLayer(layerId)) {\n        console.warn(`AQI: Tried to get ${layerId} but layer is not present on map`);\n        return lastKnownVisible.value;\n      }\n      \n      const vis = map.getLayoutProperty(layerId, 'visibility');\n      return vis === 'visible';\n    },\n    set(val: boolean) {\n      lastKnownVisible.value = val;\n      const map = mapRef.value;\n      if (!map) {\n        console.warn(`AQI: Tried to get ${layerId} but map is not set`);\n        return lastKnownVisible.value;\n      }\n      if (!map.getLayer(layerId)) {\n        console.warn(`AQI: Tried to get ${layerId} but layer is not present on map`);\n        return lastKnownVisible.value;\n      }\n      \n      const vis = val ? 'visible' : 'none';\n      map.setLayoutProperty(layerId, 'visibility', vis);\n      if (map.getLayer(labelLayerId)) {\n        map.setLayoutProperty(labelLayerId, 'visibility', vis);\n      }\n    }\n  });\n\n  \n\n  // Post-process GeoJSON to apply styleUrl-based AQI coloring\n  const postProcessGeoJson = (geoJson: GeoJSON.FeatureCollection): GeoJSON.FeatureCollection => {\n    const processedFeatures = geoJson.features.map((feature) => {\n      const processedFeature = { ...feature };\n      const props = processedFeature.properties || {};\n      const styleUrl = props.styleUrl ?? props.styleURL ?? null;\n      const color = getAqiColorFromStyleUrl(styleUrl);\n      processedFeature.properties = {\n        ...props,\n        'marker-color': color\n      };\n      return processedFeature;\n    });\n\n    return {\n      ...geoJson,\n      features: processedFeatures\n    };\n  };\n\n  \n  function setupLayerPopup(propertyToShow: string, map: M.Map, layerId: string) {\n    const popup = new Popup({ closeButton: false, closeOnClick: false, maxWidth: '200px' });\n    const valueProp = propertyToShow || 'aqi';\n    const onEnter = (e: InternalMapLayerEventType) => {\n      map.getCanvas().style.cursor = 'pointer';\n      const f = e.features && e.features[0];\n      const val = f?.properties?.[valueProp];\n      if (val !== undefined && val !== null && `${val}` !== '') {\n        const desc = `<div style=\"font:12px sans-serif;color:#000\">AQI: ${val}</div>`;\n        popup\n          .setLngLat(e.lngLat)\n          .setHTML(desc)\n          .addTo(map);\n      }\n    };\n    const onMove = (e: InternalMapLayerEventType) => {\n      popup.setLngLat(e.lngLat);\n      const f = e.features && e.features[0];\n      const val = f?.properties?.[valueProp];\n      if (val !== undefined && val !== null && `${val}` !== '') {\n        const desc = `<div style=\"font:12px sans-serif;color:#000\">AQI: ${val}</div>`;\n        popup.setHTML(desc);\n      }\n    };\n    const onLeave = () => {\n      map.getCanvas().style.cursor = '';\n      popup.remove();\n    };\n    \n    map.on('mouseenter', layerId, () => {\n      map.getCanvas().style.cursor = 'pointer';\n    });\n    map.on('click', layerId, onEnter);\n    map.on('mousemove', layerId, onMove);\n    map.on('mouseleave', layerId, onLeave);\n\n    // Store state in refs (not on function)\n    popupRef.value = popup;\n    onEnterRef.value = onEnter;\n    onMoveRef.value = onMove;\n    onLeaveRef.value = onLeave;\n  }\n\n  function setupVisibilitySync(map: M.Map) {\n    // Keep label visibility equal to main layer & sync external visibility changes\n    const syncLabelVisibility = () => {\n      if (!map.getLayer(layerId)) return;\n      const mainVis = (map.getLayoutProperty(layerId, 'visibility') as string) || 'visible';\n      const isVisible = mainVis === 'visible';\n      if (lastKnownVisible.value !== isVisible) {\n        lastKnownVisible.value = isVisible;\n      }\n      if (map.getLayer(labelLayerId)) {\n        const labelVis = (map.getLayoutProperty(labelLayerId, 'visibility') as string) || 'visible';\n        if (labelVis !== mainVis) {\n          map.setLayoutProperty(labelLayerId, 'visibility', mainVis);\n        }\n      }\n    };\n    \n    syncLabelVisibility();\n    // idle takes a bit longer than styledata, and the user can tell\n    // but idle would be less frequent i think\n    map.on('styledata', syncLabelVisibility); \n    onStyleDataRef.value = syncLabelVisibility;\n  }\n\n\n  // Add GeoJSON to map\n  const addToMap = async (map: M.Map): Promise<void> => {\n    // Always store map first so subsequent retries have a reference\n    mapRef.value = map;\n    \n    // Load KML if not already loaded\n    if (!geoJsonData.value) {\n      // console.log('AQI: No GeoJSON data, loading KML from URL:', kmlUrl.value);\n      await loadKML();\n    }\n    if (!geoJsonData.value) {\n      throw new Error('No GeoJSON data available');\n    }\n\n    // Remove existing layer and source if they exist\n    if (map.getLayer(layerId)) {\n      map.removeLayer(layerId);\n    }\n    if (labelLayerId && map.getLayer(labelLayerId)) {\n      map.removeLayer(labelLayerId);\n    }\n    if (map.getSource(sourceId)) {\n      map.removeSource(sourceId);\n    }\n\n    // Add new source and layer\n    map.addSource(sourceId, {\n      type: 'geojson',\n      data: postProcessGeoJson(geoJsonData.value)\n    });\n\n    // Add point layer colored by 'marker-color'\n    map.addLayer({\n      id: layerId,\n      type: 'circle',\n      source: sourceId,\n      layout: {\n        visibility: lastKnownVisible.value ? 'visible' : 'none'\n      },\n      paint: {\n        'circle-radius': [\n          'interpolate', ['linear'], ['zoom'],\n          0, 1,\n          5, 8,\n          20, 12\n        ],\n        'circle-color': [\n          'case',\n          ['has', 'marker-color'],\n          ['get', 'marker-color'],\n          '#808080'\n        ],\n        'circle-stroke-color': '#969696ff',\n        'circle-stroke-width': 1,\n        'circle-opacity': 0.8\n      },\n      filter: ['==', '$type', 'Point']\n    });\n\n    // Conditionally add text labels\n    if (propertyToShow && showLabel) {\n      map.addLayer({\n        id: labelLayerId,\n        type: 'symbol',\n        source: sourceId,\n        minzoom: labelMinZoom,\n        layout: {\n          'text-field': ['coalesce', ['to-string', ['get', propertyToShow]], ''],\n          'text-size': 10,\n          'text-offset': [0, 0],\n          'visibility': lastKnownVisible.value ? 'visible' : 'none'\n        },\n        paint: {\n          'text-color': '#1a1a1a',\n          'text-opacity': 1, // needs to be set so we can detect if we change it\n          'text-halo-color': '#ffffff',\n          'text-halo-width': 1\n        },\n        filter: ['==', '$type', 'Point']\n      });\n\n      \n      // Add popup/handlers if it hasn't been added yet\n      if (showPopup && popupRef.value === null) {\n        setupLayerPopup(propertyToShow, map, layerId);\n      }\n    }\n    // Even without labels still sync visibility (for external toggles)\n    if (onStyleDataRef.value === null) {\n      setupVisibilitySync(map);\n\n    }\n\n    // Apply last known visibility after layers are added\n    // const vis = lastKnownVisible.value ? 'visible' : 'none';\n    // map.setLayoutProperty(layerId, 'visibility', vis);\n    // if (map.getLayer(labelLayerId)) {\n    //   map.setLayoutProperty(labelLayerId, 'visibility', vis);\n    // }\n      \n    \n  };\n  \n  \n  // Optional: debug logging\n  // watch(layerVisible, (newVis) => {\n  //   console.log('AQI layer visibility changed to:', newVis);\n  // });\n\n  // Toggle visibility for main and label layers using the computed setter\n  const toggleAQIVisibility = (val?: boolean | undefined): void => {\n    const next = val ?? !layerVisible.value;\n    layerVisible.value = next;\n  };\n\n  // Change URL and refresh layer\n  const setUrl = async (newUrl: string): Promise<void> => {\n    internalSetUrl(newUrl) // will automatically load new and abort prior\n      .then(() => {\n        const map = mapRef.value;\n\n        if (map) {\n          addToMap(map as never);\n        }\n      }).catch((err) => {\n        console.error('AQI: Error setting new KML URL:', err);\n      });\n  };\n\n  // Watch for URL changes to auto-reload (will be idempotent due to early return)\n\n  // Remove from map\n  const removeFromMap = (map: M.Map): void => {\n    cleanUp();\n    \n    // Remove hover handlers and popup\n    if (onEnterRef.value) map.off('click', layerId, onEnterRef.value);\n    if (onMoveRef.value) map.off('mousemove', layerId, onMoveRef.value);\n    if (onLeaveRef.value) map.off('mouseleave', layerId, onLeaveRef.value);\n    if (popupRef.value) popupRef.value.remove();\n    if (onStyleDataRef.value) map.off('styledata', onStyleDataRef.value);\n    // if (onStyleDataRef.value) map.off('idle', onStyleDataRef.value); \n\n    // Remove layers and source\n    if (map.getLayer(labelLayerId)) {\n      map.removeLayer(labelLayerId);\n    }\n    if (map.getLayer(layerId)) {\n      map.removeLayer(layerId);\n    }\n    if (map.getSource(sourceId)) {\n      map.removeSource(sourceId);\n    }\n\n    // Clear stored handlers/popup; keep mapRef so we can re-add later\n    popupRef.value = null;\n    onEnterRef.value = null;\n    onMoveRef.value = null;\n    onLeaveRef.value = null;\n  };\n  \n  onBeforeUnmount(() => {\n    const map = mapRef.value;\n    if (map) {\n      removeFromMap(map as never);\n      mapRef.value = null;\n    }\n  });\n  \n  return {\n    addToMap,\n    removeFromMap,\n    geoJsonData,\n    loading,\n    error,\n    layerVisible,\n    toggleAQIVisibility,\n    setUrl\n  };\n}\n","import { ref, watch, Ref, MaybeRef, toRef, computed } from 'vue';\nimport { RenderingRuleOptions } from '@/esri/ImageLayerConfig';\nimport { Map, type MapSourceDataEvent } from 'maplibre-gl';\nimport { validate as uuidValidate } from \"uuid\";\n\nimport { ImageService } from '@/esri/ImageServiceLayer/ImageService';\nimport { TempoDataService } from '@/esri/services/TempoDataService';\nimport { type PointBounds } from '@/esri/geometry';\n\n\n\nexport interface UseEsriLayer {\n  esriImageSource: Ref<maplibregl.RasterTileSource | null>;\n  opacity: Ref<number>;\n  noEsriData: Ref<boolean>;\n  loadingEsriTimeSteps: Ref<boolean>;\n  esriTimesteps: Ref<number[]>;\n  updateEsriOpacity: (value?: number | null | undefined) => void;\n  updateEsriTimeRange: () => void;\n  addEsriSource: (map: Map) => void;\n  removeEsriSource: () => void;\n  renderOptions: Ref<RenderingRuleOptions>;\n}\n\nexport interface ImageSerivceLayerOptions {\n  renderingRule?: RenderingRuleOptions;\n  visible?: boolean;\n  clickValue?: boolean;\n  exportImageOptions?: Record<string, unknown>;\n}\n\nexport function useEsriImageServiceLayer(\n  serviceUrl: string,\n  layerId: string,\n  opacity: MaybeRef<number>,\n  variable: MaybeRef<string>,\n  _timestamp: MaybeRef<number>,\n  options: ImageSerivceLayerOptions = {},\n): UseEsriLayer {\n\n  const timestamp = toRef(_timestamp);\n  const url = ref(serviceUrl);\n  const esriLayerId = layerId;\n  const esriImageSource = ref<maplibregl.RasterTileSource | null>(null);\n  const map = ref<Map | null>(null);\n  const variableRef = toRef(variable);\n  \n  const tds = new TempoDataService(serviceUrl, variableRef.value);\n  // bind tds to the window\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n  const opacityRef = toRef(opacity);\n  const noEsriData = ref(false);\n\n  \n  const esriOptions = computed(() => {\n    return  {\n      'format': 'png',\n      'pixelType': 'U8',\n      'size': '256,256',\n      'transparent': true,\n      'bboxSR': 3857,\n      'imageSR': 3857,\n      'bbox': '{bbox-epsg-3857}',\n      'interpolation': 'RSP_NearestNeighbor',\n      'renderingRule': options.renderingRule || {},\n      ...options.exportImageOptions || {},\n    };\n  });\n\n  \n  function addLayer(map: Map | null | undefined) {\n\n    if (map && !map.getLayer(esriLayerId)) {\n      map.addLayer({\n        id: esriLayerId,\n        type: 'raster',\n        source: esriLayerId,\n        paint: {\n          'raster-resampling': 'nearest',\n          'raster-opacity': (options.visible === false) ? 0.0 : (opacityRef.value ?? 0.8),\n        },\n        layout: {\n          'visibility': (options.visible === false) ? 'none' : 'visible',\n        }\n      });\n      let index = -1;\n      for (const [idx, layer] of Object.entries(map.getStyle().layers)) {\n        if (uuidValidate(layer.id)) {\n          index = Number(idx) - 1;\n        }\n      }\n      if (index >= 0) {\n        map.moveLayer(esriLayerId, map.getStyle().layers[index].id);\n      }\n    }\n  }\n  \n  function removeLayer(map: Map | null | undefined) {\n    if (map && map.getLayer(esriLayerId)) {\n      map.removeLayer(esriLayerId);\n    }\n  }\n  \n  const dynamicMapService = ref<ImageService | null>(null);\n  \n  function onSourceLoad(e: MapSourceDataEvent) {\n    // console.log(`sourcedata event for ${esriLayerId}: `);\n    if (e.sourceId === esriLayerId && e.isSourceLoaded && map.value?.getSource(esriLayerId)) {\n      console.log(`ESRI source ${esriLayerId} loaded`);\n      esriImageSource.value = map.value?.getSource(esriLayerId) as maplibregl.RasterTileSource;\n      updateEsriOpacity();\n      dynamicMapService.value.setDate(new Date(timestamp.value-1), new Date(timestamp.value+1));\n      if (options.visible !== undefined && !options.visible) {\n        map.value?.setLayoutProperty(esriLayerId, 'visibility', 'none');\n      }\n      map.value?.off('sourcedata', onSourceLoad);\n    }\n  }\n  \n  function createImageService(map: Map, url: string, options) {\n    // console.log(`[${esriLayerId}] Creating image service with options:`, options);\n    return new ImageService(\n      esriLayerId,\n      map,\n      {\n        url: url,\n        ...options\n      },\n      {\n        tileSize: 256,\n      }\n    );\n    \n  }\n  \n  function addEsriSource(mMap: Map) {\n    if (!mMap) return;\n    map.value = mMap;\n    \n    dynamicMapService.value = createImageService(mMap, url.value, esriOptions.value);\n\n    addLayer(mMap);\n    // this event will run until the source is loaded\n    mMap.on('sourcedata', onSourceLoad);\n    \n    console.log(`[${esriLayerId}] Adding ESRI source to map`);\n    // on click on the layer\n    if (options.clickValue) {\n      mMap.on('click', (e) => {\n        if (_hasEsriSource() && map.value) {\n          const point = { x: e.lngLat.lng, y: e.lngLat.lat } as PointBounds;\n          const timeRange = {start: timestamp.value - 1, end: timestamp.value + 1};\n          tds.fetchSample(point, timeRange ).then((val) => {\n            console.log(`[${esriLayerId}] Value at point`, point, 'is', val.samples.map(v => v.value));\n          }).catch((err) => {\n            console.error(`[${esriLayerId}] Error fetching sample:`, err);\n          });\n        }\n      });\n    }\n  }\n  \n    \n  function removeEsriSource() {\n    removeLayer(map.value as Map | null);\n    if (map.value && map.value.getSource(esriLayerId)) {\n      map.value.removeSource(esriLayerId);\n    }\n  }\n  \n  function _hasEsriSource() {\n    return map.value?.getSource(esriLayerId) !== undefined;\n  }\n  \n  watch(timestamp, (_value) => {\n    console.log(`[${esriLayerId}] esri imageset timestamp set to `, _value ? new Date(_value) : null);\n    if ( _hasEsriSource() ) {\n      dynamicMapService.value.setDate(new Date(_value-1), new Date(_value+1));\n    } else {\n      console.error(`[${esriLayerId}] ESRI source not yet available`);\n    }\n  });\n  \n  \n  \n  function updateEsriOpacity(value: number | null | undefined = undefined) {\n    if (map.value) {\n      map.value.setPaintProperty(esriLayerId, 'raster-opacity', value ?? opacityRef.value ?? 0.8);\n    }\n  }\n\n  \n\n  watch(opacityRef, (_value: number) => {\n    updateEsriOpacity(_value);\n  });\n\n  watch(noEsriData, (value: boolean) => {\n    if (value) {\n      updateEsriOpacity(0);\n      removeLayer(map.value as Map | null);\n    } else {\n      addLayer(map.value as Map | null);\n    }\n  });\n\n  return {\n    esriImageSource,\n    opacity: opacityRef,\n    noEsriData,\n    updateEsriOpacity,\n    addEsriSource,\n    removeEsriSource,\n  } as UseEsriLayer;\n}\n\n\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { useEsriImageServiceLayer } from \"@/composables/useEsriMapLayer\";\n\nconst count = \"gpw_v4_population_count_adjusted_to_2015_unwpp_country_totals_rev11\";\nconst countVar = 'un-adjusted-population-count';\n\n\nconst density = \"gpw_v4_population_density_adjusted_to_2015_unwpp_country_totals_rev11\";\nconst densityVar = 'un-adjusted-population-density';\nconsole.log(sampleColormap('haline_r', 7).map((rgb, i) => `rgb(${rgb.join(',')})`));\nconst densityRaster = {\n  \"rasterFunctionArguments\": {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    \"Colormap\": [\n      // generate 7 equally spaced colors from the 'haline' colormap\n      // and map it to values 1 - 7\n      ...sampleColormap('haline_r', 7).map((rgb, i) => [i + 1, ...rgb]),\n    ],\n    // https://developers.arcgis.com/rest/services-reference/enterprise/raster-function-objects/#remap\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    \"Raster\": {\n      \"rasterFunctionArguments\": {\n        // each of these pairs defines a range of map values to be mapped to a single output value\n        // 1 - 7 are the indices of the colormap defined above\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        \"InputRanges\": [\n          0.0001, 0.9901,           // 1\n          0.9901, 5.0001,          // 2\n          5.0001, 25.0001,         // 3\n          25.0001, 250.0001,       // 4\n          250.0001, 1000.0001,     // 5\n          1000.0001, 5000.0001,    // 6\n          5000.0001, 50000.0001,    // 7\n        ],\n\n        \"OutputValues\": [1, 2, 3, 4, 5, 6, 7],\n        \"NoDataRanges\": [0, 0],\n        \"replacementValue\": 0,\n        \"AllowUnmatched\": false,\n      },\n      \"rasterFunction\": \"Remap\", \"variableName\": \"Raster\"\n    }\n  },\n  \"rasterFunction\": \"Colormap\"\n};\n\nconst countRaster = {\n  \"rasterFunctionArguments\": {\n    \"colorRamp\": {\n      \"type\": \"multipart\",\n      \"colorRamps\": [\n        { \"type\": \"algorithmic\", \"algorithm\": \"esriHSVAlgorithm\", \"fromColor\": [255, 252, 255, 255], \"toColor\": [181, 150, 181, 255] }, \n        { \"type\": \"algorithmic\", \"algorithm\": \"esriHSVAlgorithm\", \"fromColor\": [181, 150, 181, 255], \"toColor\": [150, 150, 181, 255] }, \n        { \"type\": \"algorithmic\", \"algorithm\": \"esriHSVAlgorithm\", \"fromColor\": [150, 150, 181, 255], \"toColor\": [135, 96, 38, 255] }, \n        { \"type\": \"algorithmic\", \"algorithm\": \"esriHSVAlgorithm\", \"fromColor\": [135, 96, 38, 255], \"toColor\": [217, 194, 121, 255] }, \n        { \"type\": \"algorithmic\", \"algorithm\": \"esriHSVAlgorithm\", \"fromColor\": [217, 194, 121, 255], \"toColor\": [255, 255, 128, 255] }, \n        { \"type\": \"algorithmic\", \"algorithm\": \"esriHSVAlgorithm\", \"fromColor\": [255, 255, 128, 255], \"toColor\": [255, 255, 199, 255] }, \n        { \"type\": \"algorithmic\", \"algorithm\": \"esriHSVAlgorithm\", \"fromColor\": [255, 255, 199, 255], \"toColor\": [118, 219, 211, 255] }\n      ]\n    },\n    \"Raster\": {\n      \"rasterFunctionArguments\": {\n        \"StretchType\": 5,\n        \"Statistics\": [[0, 602380.375, 31.152280479445455, 272.81391026456805]],\n        \"DRA\": false,\n        \"UseGamma\": true,\n        \"Gamma\": [5.02],\n        \"ComputeGamma\": false,\n        \"Min\": 0,\n        \"Max\": 255\n      },\n      \"rasterFunction\": \"Stretch\",\n      \"outputPixelType\": \"U8\",\n      \"variableName\": \"Raster\"\n    }\n  },\n  \"rasterFunction\": \"Colormap\",\n  \"variableName\": \"Raster\"\n};\n\n// Esri Image Service URL for GPWv4 Population Density\nconst gpw4url = `https://gis.earthdata.nasa.gov/image/rest/services/gpw-v4/${density}/ImageServer`;\n\nimport { sampleColormap } from \"@/colormaps/utils\";\nconst populationLayerOptions = {};\npopulationLayerOptions['visible'] = false;\npopulationLayerOptions['clickValue'] = true;\npopulationLayerOptions['renderingRule'] = densityRaster;\n\n//valid timestamp otions are\n/*\n* 962424000000, 2000, \n* 1120190400000, 2005\n* 1277956800000, 2010 \n* 1435723200000, 2015\n* 1593576000000, 2020 << use this\n*/\nexport function addPopulationDensityLayer() {\n  const popLayer = useEsriImageServiceLayer(\n    gpw4url,\n    'pop-dens',\n    1,\n    densityVar,\n    1593576000000,\n    populationLayerOptions,\n  );\n  return popLayer;\n}\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { useEsriImageServiceLayer } from \"@/composables/useEsriMapLayer\";\nimport { layer } from \"@fortawesome/fontawesome-svg-core\";\n\n\n// https://www.arcgis.com/home/item.html?id=cfcb7609de5f478eb7666240902d4d3d\n\n// Esri Image Service URL for GPWv4 Population Density\nconst url = \"https://ic.imagery1.arcgis.com/arcgis/rest/services/Sentinel2_10m_LandCover/ImageServer\";\n\n\n\nconst layerOptions = {};\nlayerOptions['visible'] = false;\nlayerOptions['clickValue'] = true;\nlayerOptions['renderingRule'] = {\n  \"rasterFunction\": \"Cartographic Renderer for Visualization and Analysis\"\n};\nlayerOptions['exportImageOptions'] = {\n  \"format\": \"jpgpng\" // to get transparency\n};\n\n//valid timestamp otions are\n/*\n\n*/\nexport function addLandUseLayer() {\n  const popLayer = useEsriImageServiceLayer(\n    url,\n    'land-use',\n    1,\n    'LandCoverType',\n    1735689599000,\n    layerOptions,\n  );\n  return popLayer;\n}\n\n\n// const availableRasterFunctions = { \n//   \"rasterFunctionInfos\": [\n//     { \n//       \"name\": \"Cartographic Renderer for Visualization and Analysis\", \n//       \"description\": \"Legend and attribute table for Sentinel 2 10m Land Cover.\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"None\", \n//       \"description\": \"Make a Raster or Raster Dataset into a Function Raster Dataset.\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Bare Ground Areas for Visualization and Analysis\", \n//       \"description\": \"Shows only areas of bare ground(class 8).\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Built Areas for Visualization and Analysis\", \n//       \"description\": \"Shows only built areas (class 7).\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Clouds for Visualization and Analysis\", \n//       \"description\": \"Shows only Clouds(class 10)\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Converted Lands for Visualization and Analysis\", \n//       \"description\": \"Shows only built areas and crops (class 5 and 7).\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Crops for Visualization and Analysis\", \n//       \"description\": \"Shows only Croplands(class 5)\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Flooded Vegeation Areas for Visualization and Analysis\", \n//       \"description\": \"Shows only areas of flooded vegetation (class 4).\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Rangelands Areas for Visualization and Analysis\", \n//       \"description\": \"Shows only rangeland areas (class 11).\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Snow or Ice for Visualization and Analysis\", \n//       \"description\": \"Shows only areas of snow or ice (class 9).\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Trees for Visualization and Analysis\", \n//       \"description\": \"Shows only areas of trees (class 2).\", \"help\": \"\" \n//     }, \n//     { \n//       \"name\": \"Isolate Water Areas for Visualization and Analysis\", \n//       \"description\": \"Shows only water areas (class 1).\", \"help\": \"\" }\n//   ] \n// };","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, mergeProps as _mergeProps, withCtx as _withCtx, unref as _unref, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, isRef as _isRef } from \"vue\"\n\nconst _hoisted_1 = { class: \"map-container\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"map-legend\"\n}\nconst _hoisted_3 = { class: \"location-and-sharing\" }\nconst _hoisted_4 = { class: \"slider-row mx-16 mt-12\" }\nconst _hoisted_5 = { class: \"thumb-label\" }\nconst _hoisted_6 = { class: \"d-flex flex-row\" }\n\nimport { computed, ref, toRaw, useTemplateRef, watch, type Ref, type WritableComputedRef } from \"vue\";\nimport { useDisplay } from 'vuetify';\nimport { storeToRefs } from \"pinia\";\nimport { MapBoxFeature, MapBoxFeatureCollection, MapBoxFeatureType, MapBoxForwardGeocodingOptions, geocodingInfoForSearch } from \"@cosmicds/vue-toolkit\";\nimport { Map, GeoJSONSource, type StyleLayer } from \"maplibre-gl\";\nimport { getTimezoneOffset } from \"date-fns-tz\";\nimport { v4 } from \"uuid\";\n\nimport type { LatLngPair, PointSelectionInfo, RectangleSelectionInfo, SelectionType } from \"@/types\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"@/esri/utils\";\nimport { colorbarOptions } from \"@/esri/ImageLayerConfig\";\nimport { useTempoStore } from \"@/stores/app\";\nimport { useLocationMarker } from \"@/composables/maplibre/useMarker\";\nimport { useRectangleSelection } from \"@/composables/maplibre/useRectangleSelection\";\nimport { addRectangleLayer, addPointLayer, regionBounds, fitBounds, removeRectangleLayer, removePointLayer } from \"@/composables/maplibre/utils\";\nimport { usePointSelection } from \"@/composables/maplibre/usePointSelection\";\nimport { COLORS } from \"@/utils/color\";\nimport { EsriSampler } from \"@/esri/services/sampling\";\nimport { useMultiMarker } from '@/composables/maplibre/useMultiMarker';\n\nimport { setLayerOpacity, setLayerVisibility } from \"@/maplibre_controls\";\n\nimport EsriMap from \"@/components/EsriMap.vue\";\nimport MapColorbarWrap from \"@/components/MapColorbarWrap.vue\";\nimport MaplibreDownloadButton from \"@/components/MaplibreDownloadButton.vue\";\n\nimport { addPowerPlants } from \"@/composables/addPowerPlants\";\nimport { addHMSFire } from \"@/composables/addHMSFire\";\n\nimport { addQUI } from '@/composables/addAQI';\n\n// base it of singleDateSelected\nimport { addPopulationDensityLayer } from '@/composables/addPopulationDensity';\nimport { addLandUseLayer } from \"@/composables/addLandUse\";\nimport { type UseEsriTempoLayer, useTempoLayer } from \"@/esri/maplibre/useTempoImageLayer\";\n// just use the hcho layer for now\nimport { stretches, colorramps, rgbstretches, rgbcolorramps, type ColorRamps } from \"@/esri/ImageLayerConfig\";\n  \ntype MapType = Map | null;\ntype MapTypeRef = Ref<MapType>;\ntype Timeout = ReturnType<typeof setTimeout>;\n\ntype UnifiedRegionType = typeof regions.value[number];\n\ntype ColorbarOptionsKey = keyof typeof colorbarOptions;\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MapWithControls',\n  setup(__props) {\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst maplibreMap = useTemplateRef<InstanceType<typeof EsriMap>>(\"maplibreMap\");\nconst map = ref<MapType>(null);\n\nconst mapID = `map-${v4().replace(\"-\", \"\")}`;\n\nconst store = useTempoStore();\nconst {\n  regions,\n  regionOpacity,\n  regionVisibility,\n  timestamp,\n  timeIndex,\n  minIndex,\n  maxIndex,\n  date,\n  selectedTimezone,\n  timeSliderUsedCount,\n  playButtonClickedCount,\n  timestamps,\n  timestampsLoaded,\n  selectionActive,\n  regionsCreatedCount,\n  maxSampleCount,\n  focusRegion,\n  initState,\n  homeState,\n  showFieldOfRegard,\n  showRoads,\n  showSamplingPreviewMarkers,\n  singleDateSelected,\n  showAdvancedLayers,\n  showRGBMode,\n} = storeToRefs(store);\n\nconst molecule = ref<MoleculeType>(\"no2\");\nconst currentTempoDataService = computed(() => store.getTempoDataService(molecule.value));\n\nfunction createSelectionComputed(selection: SelectionType): WritableComputedRef<boolean> {\n  return computed({\n    get() {\n      return selectionActive.value === selection;\n    },\n    set(value: boolean) {\n      if (value === (selectionActive.value !== selection)) {\n        selectionActive.value = value ? selection : null;\n      }\n    },\n  });\n}\n\nconst pointSelectionActive = createSelectionComputed(\"point\");\nconst rectangleSelectionActive = createSelectionComputed(\"rectangle\");\n\nconst { selectionInfo: rectangleInfo } = useRectangleSelection(map as MapTypeRef, \"red\", rectangleSelectionActive);\nconst { selectionInfo: pointInfo } = usePointSelection(map as MapTypeRef, pointSelectionActive);\n\nconst display = useDisplay();\n\nconst pp = addPowerPlants(map as Ref<Map | null> | null, false);\nconst airQualityUrl = computed(() => {\n  const date = store.singleDateSelected;\n  if (!date) {\n    return 'https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/2025/20250914/KMLPointMaps_PM2.5-24hr.kml';\n  }\n\n  const year = date.getUTCFullYear();\n  const month = (date.getUTCMonth() + 1).toString().padStart(2, '0');\n  const day = date.getUTCDate().toString().padStart(2, '0');\n  return `https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/${year}/${year}${month}${day}/KMLPointMaps_PM2.5-24hr.kml`;\n});\nconst aqiLayer = addQUI(airQualityUrl.value, { \n  propertyToShow: 'aqi', \n  labelMinZoom: 5, \n  layerName: 'aqi', \n  visible: false,\n  showLabel: true, \n  showPopup: true\n});\n\n// Ensure date/url changes trigger a reload, even if initial load failed\nwatch(airQualityUrl, (newUrl) => {\n  aqiLayer.setUrl(newUrl).catch(() => {/* ignore */});\n});\n\n\nconst popLayer = addPopulationDensityLayer();\n\nconst sentinalLandUseLayer = addLandUseLayer();\n\nconst hmsFire = addHMSFire(singleDateSelected, {\n  layerName: 'hms-fire',\n  visible: false,\n  showPopup: true,\n  showLabel: false,\n});\n\nconst hchoLayer = useTempoLayer({\n  initialMolecule: \"hcho\",\n  timestamp,\n  opacity: 1,\n  fetchOnMount: true,\n  layerName: \"tempo-hcho\",\n  initVisible: false,\n  initRGB: showRGBMode.value,\n});\nconst ozoneLayer = useTempoLayer({\n  initialMolecule: \"o3\",\n  timestamp,\n  opacity: 1,\n  fetchOnMount: true,\n  layerName: \"tempo-o3\",\n  initVisible: false,\n  initRGB: showRGBMode.value,\n});\nconst no2Layer = ref<UseEsriTempoLayer | null>(null);\n\nfunction addAdvancedLayers(m: Map | null) {\n  if (m === null) {\n    throw new Error('Tried to addAdvancedLayers but map was null');\n  }\n  // pp.addheatmapLayer();\n  // pp.togglePowerPlants(false);\n  aqiLayer.addToMap(m);\n  popLayer.addEsriSource(m);\n  sentinalLandUseLayer.addEsriSource(m);\n  hmsFire.addToMap(m);\n  hchoLayer.addEsriSource(m);\n  ozoneLayer.addEsriSource(m);\n  // Only move if target layer exists (avoid errors if initial KML load failed)\n  try {\n    if (m.getLayer('kml-layer-aqi')) {\n      m.moveLayer('states-custom','kml-layer-aqi');\n    }\n  } catch {\n    // ignore\n  }\n  \n  pp.addLayer();\n  // pp.togglePowerPlants(false);\n}\n\nfunction removeAdvancedLayers(m: Map | null) {\n  if (m === null) {\n    throw new Error('Tried to removeAdvancedLayers but map was null');\n  }\n  aqiLayer.removeFromMap(m);\n  popLayer.removeEsriSource();\n  sentinalLandUseLayer.removeEsriSource();\n  hmsFire.removeFromMap(m);\n  hchoLayer.removeEsriSource();\n  ozoneLayer.removeEsriSource();\n  pp.removeLayer();\n}\n\nconst onMapReady = (m: Map) => {\n  map.value = m; // ESRI source already added by EsriMap\n  if (showAdvancedLayers.value) addAdvancedLayers(m);\n  updateRegionLayers(regions.value);\n  m.resize();\n};\n\nwatch(showAdvancedLayers, (value) => {\n  if (value) {\n    addAdvancedLayers(map.value as Map | null);\n    return;\n  }\n  removeAdvancedLayers(map.value as Map | null);\n  \n  \n});\n\nwatch(molecule, (newMolecule) => {\n  if (map.value) {\n    hchoLayer.setVisibility(newMolecule === 'hcho');\n    ozoneLayer.setVisibility(newMolecule === 'o3');\n    no2Layer.value?.setVisibility(newMolecule === 'no2');\n    // map.value.moveLayer(`tempo-${newMolecule}`, 'tempo-no2');\n  }\n});\n\nconst activeLayer = computed(() => `tempo-${molecule.value}`);\n\nwatch(showRGBMode, (cMode) => {\n\n  const colormapsToUse = cMode ? rgbcolorramps : colorramps;\n  hchoLayer.renderOptions.value.colormap = colormapsToUse['HCHO'];\n  ozoneLayer.renderOptions.value.colormap = colormapsToUse['Ozone_Column_Amount'];\n  if (no2Layer.value) {\n    no2Layer.value.renderOptions.colormap = colormapsToUse['NO2_Troposphere'];\n  }\n\n  const stretchesToUse = cMode ? rgbstretches : stretches;\n  hchoLayer.renderOptions.value.range = stretchesToUse['HCHO'];\n  ozoneLayer.renderOptions.value.range = stretchesToUse['Ozone_Column_Amount'];\n  if (no2Layer.value) {\n    no2Layer.value.renderOptions.range = stretchesToUse['NO2_Troposphere'];\n  }\n\n});\n\nconst showLocationMarker = ref(true);\nconst {\n  setMarker,\n  removeMarker,\n  locationMarker,\n} = useLocationMarker(map as Ref<Map | null>, showLocationMarker.value);\n\nconst opacity = ref(0.9);\nconst playing = ref(false);\nconst playInterval = ref<Timeout | null>(null);\n\n\nconst searchOpen = ref(true);\nconst searchErrorMessage = ref<string | null>(null);\nfunction activateRectangleSelectionMode() {\n  rectangleSelectionActive.value = !rectangleSelectionActive.value;\n}\n\nfunction activatePointSelectionMode() {\n  pointSelectionActive.value = !pointSelectionActive.value;\n}\n\nconst regionLayers: Record<string, GeoJSONSource> = {};\n\n// const colorMap = computed(() => colorbarOptions[molecule.value].colormap.toLowerCase());\nconst colorMap = computed(() => {\n  const mol = molecule.value == 'no2' \n    ? 'NO2_Troposphere' : molecule.value == 'hcho' \n      ? 'HCHO' : 'Ozone_Column_Amount';\n  return showRGBMode.value ? rgbcolorramps[mol].toLowerCase() : colorramps[mol].toLowerCase();\n});\n\nconst currentColorbarOptions = computed<typeof colorbarOptions[ColorbarOptionsKey]>(() => {\n  const mol = molecule.value == 'no2' \n    ? 'NO2_Troposphere' : molecule.value == 'hcho' \n      ? 'HCHO' : 'Ozone_Column_Amount';\n  return {\n    ...colorbarOptions[molecule.value],\n    colormap: showRGBMode.value ? rgbcolorramps[mol] : colorramps[mol],\n    stretch: showRGBMode.value ? rgbstretches[mol] : stretches[mol],\n  };\n});\n\nwatch(currentColorbarOptions, (cc) => {\n  console.log('current colorbar options changed to', cc);\n});\n\nwatch(colorMap, (value) => {\n  console.log('color map changed to', value);\n});\n\n\n// TODO: Maybe there's a built-in Date function to get this formatting?\nconst thumbLabel = computed(() => {\n  if (date.value === null || timestamp.value === null) {\n    return '';\n  }\n  const offset = getTimezoneOffset(selectedTimezone.value, date.value);\n  const dateObj = new Date(timestamp.value + offset);\n  const hours = dateObj.getUTCHours();\n  const amPm = hours >= 12 ? \"PM\" : \"AM\";\n  let hourValue = hours % 12;\n  if (hourValue === 0) {\n    hourValue = 12;\n  }\n  return `${date.value.getUTCMonth() + 1}/${dateObj.getUTCDate()}/${dateObj.getUTCFullYear()} ${hourValue}:${dateObj.getUTCMinutes().toString().padStart(2, '0')} ${amPm}`;\n});\n\nconst defaultMapboxOptions = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  types: [\"place\", \"postcode\"] as MapBoxFeatureType[],\n  countries: [\"US\", \"CA\", \"MX\", \"CU\", \"BM\", \"HT\", \"DO\"],\n  limit: 5,\n};\nasync function geocodingInfoForSearchLimited(searchText: string, options?: MapBoxForwardGeocodingOptions): Promise<MapBoxFeatureCollection | null> {\n  const token = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const opts = options ?? { ...defaultMapboxOptions, access_token: token ?? \"\" };\n  return geocodingInfoForSearch(searchText, opts).catch(_err => null);\n}\n\nfunction setLocationFromSearch(items: [MapBoxFeature | null, string]) {\n  const [feature, text] = items;\n  if (feature !== null) {\n    // Latitude, Longitude order\n    const coordinates: LatLngPair = [feature.center[1], feature.center[0]] as LatLngPair;\n    maplibreMap.value?.setView(coordinates, 12);\n    setMarker(coordinates);\n    store.userSelectedLocations.push(text);\n  }\n}\n\nfunction onZoomhome() {\n  if (locationMarker.value !== null) {\n    removeMarker();\n  }\n}\n\nconst currentUrl = ref(window.location.href);\nfunction updateURL() {\n  if (map.value) {\n    const center = map.value.getCenter();\n    let stateObj = null as Record<string, string> | null;\n    stateObj = {\n      lat: `${center.lat.toFixed(4)}`,\n      lon: `${center.lng.toFixed(4)}`,\n      zoom: `${map.value.getZoom()}`,\n      t: `${timestamp.value}`\n    };\n    const url = new URL(location.origin);\n    const searchParams = new URLSearchParams(stateObj ?? {});\n    // const hash = window.location.hash;\n    // url.hash = hash;\n    url.pathname = location.pathname;\n    window.history.replaceState(null, '', url.toString());\n    url.search = searchParams.toString();\n    currentUrl.value = url.toString();\n    // window.history.replaceState(stateObj, '', url);\n  }\n}\n\n// ESRI timesteps arrive from EsriMap component; store directly in timestamps\nfunction onEsriTimestepsLoaded(steps: number[]) {\n  if (!Array.isArray(steps) || steps.length === 0) return;\n  console.log(`%c[EsriMap] onEsriTimestepsLoaded: received ${steps.length} steps`, 'color: purple');\n  const sorted = steps.slice().sort();\n  timestamps.value = sorted;\n  if (timeIndex.value >= sorted.length) {\n    timeIndex.value = 0;\n  }\n  timestampsLoaded.value = true;\n}\n\nwatch(playing, (val: boolean) => {\n  if (val) {\n    play();\n    playButtonClickedCount.value += 1;\n  } else {\n    pause();\n  }\n});\n\nfunction play() {\n  playInterval.value = setInterval(() => {\n    if (timeIndex.value >= maxIndex.value) {\n      if (playInterval.value) {\n        // clearInterval(this.playInterval);\n        // this.playInterval = null;\n        // let it loop\n        timeIndex.value = minIndex.value;\n      }\n    } else {\n      timeIndex.value += 1;\n    }\n  }, 1000);\n}\n\n\nfunction pause() {\n  if (playInterval.value) {\n    clearInterval(playInterval.value);\n  }\n}\n\nfunction rectangleIsDegenerate(info: RectangleSelectionInfo): boolean {\n  return info.xmax === info.xmin || info.ymax === info.ymin;\n}\n\nfunction addLayer(\n  info: RectangleSelectionInfo | PointSelectionInfo,\n  geometryType: \"rectangle\" | \"point\",\n  color: string,\n): { layer: GeoJSONSource } {\n  const isRect = geometryType === 'rectangle';\n  const layerInfo = isRect ?\n    addRectangleLayer((map.value as MapType)!, info as RectangleSelectionInfo, color, regionOpacity.value, regionVisibility.value) :\n    addPointLayer((map.value as MapType)!, info as PointSelectionInfo, color, regionVisibility.value);\n  map.value?.moveLayer(layerInfo.layer.id);\n  return layerInfo;\n}\n\nfunction removeLayer(\n  layer: StyleLayer,\n  geometryType: \"rectangle\" | \"point\",\n) {\n  const isRect = geometryType === 'rectangle';\n  if (isRect) {\n    removeRectangleLayer((map.value as MapType)!, layer);\n  } else {\n    removePointLayer((map.value as MapType)!, layer);\n  }\n}\n\nfunction createRegion(info: RectangleSelectionInfo | PointSelectionInfo, geometryType: \"rectangle\" | \"point\"): UnifiedRegionType {\n  const color = COLORS[regionsCreatedCount.value % COLORS.length];\n  regionsCreatedCount.value += 1;\n\n  const id = v4();\n  const { layer } = addLayer(info, geometryType, color);\n  regionLayers[id] = layer;\n  return {\n    id,\n    name: `${geometryType === \"rectangle\" ? 'Region' : 'Point'} ${regionsCreatedCount.value}`,\n    geometryInfo: toRaw(info),\n    geometryType: geometryType,\n    color,\n  };\n}\n\nfunction getRegionsDifference(arr1: UnifiedRegionType[], arr2: UnifiedRegionType[]): UnifiedRegionType[] {\n  const ids2 = arr2.map(r => r.id);\n  return arr1.filter(element => !ids2.includes(element.id));\n}\n\nlet existingRegions: UnifiedRegionType[] = [];\nfunction updateRegionLayers(newRegions: UnifiedRegionType[]) {\n  const added = getRegionsDifference(newRegions, existingRegions);\n  const removed = getRegionsDifference(existingRegions, newRegions);\n  added.forEach(region => {\n    if (map.value && !regionLayers[region.id]) {\n      const { layer } = addLayer(region.geometryInfo, region.geometryType, region.color);\n      regionLayers[region.id] = layer;\n    }\n  });\n\n  removed.forEach(region => {\n    if (map.value && regionLayers[region.id]) {\n      removeLayer(regionLayers[region.id] as unknown as StyleLayer, region.geometryType);\n      delete regionLayers[region.id];\n    }\n  });\n  existingRegions = [...newRegions];\n}\n\nwatch(regions, updateRegionLayers, { deep: true });\n\nwatch(regionOpacity, (opacity: number) => {\n  if (map.value !== null) {\n    Object.values(regionLayers).forEach(layer => {\n      setLayerOpacity(map.value as Map, layer.id, opacity);\n    });\n    setLayerOpacity(map.value as Map, \"predicted-samples-locations-layer\", opacity);\n  }\n});\n\nwatch(regionVisibility, (visible: boolean) => {\n  if (map.value !== null) {\n    Object.values(regionLayers).forEach(layer => {\n      setLayerVisibility(map.value as Map, layer.id, visible);\n    });\n    setLayerVisibility(map.value as Map, \"predicted-samples-locations-layer\", visible);\n  }\n});\n\nwatch(rectangleInfo, (info: RectangleSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    rectangleSelectionActive.value = false;\n    return;\n  }\n  if (rectangleIsDegenerate(info)) {\n    // make it a point selection instead\n    // TODO: only implement when we have a solution to only do this on a double-click\n    // pointInfo.value = {\n    //   x: info.xmin,\n    //   y: info.ymin\n    // };\n    rectangleSelectionActive.value = false;\n    return;\n  }\n\n  const newRegion = createRegion(info, \"rectangle\");\n  store.addRegion(newRegion);\n  rectangleSelectionActive.value = false;\n  \n  // do not permit editing a region on a selection\n  // handleSelectionRegionEdit(info);\n  \n\n});\n\n// Add watcher for point selection\nwatch(pointInfo, (info: PointSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    pointSelectionActive.value = false;\n    return;\n  }\n  const newRegion = createRegion(info, \"point\"); \n  store.addRegion(newRegion);\n  pointSelectionActive.value = false;\n});\n\nconst samplingPreviewMarkers = useMultiMarker(map as MapTypeRef , {\n  shape: 'circle',\n  color: '#0000ff',\n  fillColor: '#0000ff',\n  fillOpacity: 0.5,\n  opacity: regionOpacity.value,\n  radius: 0.02 / 2, // degrees\n  scale: 'world',\n  outlineColor: '#0000ff',\n  label: 'predicted-samples-locations'\n});\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nconst sampler = ref<EsriSampler>(null);\ncurrentTempoDataService.value.withMetadataCache().then(meta => {\n  sampler.value = new EsriSampler(meta);\n});\n\nwatch([showSamplingPreviewMarkers, regions, ()=> regions.value.length], (newVal) => {\n  const tempoDataService = currentTempoDataService.value;\n  const show = newVal[0];\n  const regs = newVal[1];\n  samplingPreviewMarkers.clearMarkers();\n  let locations: {x: number, y:number}[] = [];\n  if (sampler.value && show && regs.length > 0) {\n    regs.forEach(r => {\n      if (r.geometryType === 'rectangle') {\n        sampler.value.setGeometry(r.geometryInfo);\n        if (tempoDataService.meta) {\n          sampler.value.setMetadata(tempoDataService.meta);\n        }\n        locations = [...locations, ...sampler.value.getSampleLocationsGrid(maxSampleCount.value)];\n        // samplingPreviewMarkers.addMarkers(locations);\n      }\n    });\n    samplingPreviewMarkers.addMarkers(locations);\n  }\n});\n\n// TODO: This may need to be revisited when there are two maps\nwatch(focusRegion, region => {\n  if (region !== null) {\n    const bounds = regionBounds(region);\n    fitBounds(map.value, bounds, true);\n    focusRegion.value = null;\n  }\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_location_search = _resolveComponent(\"location-search\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_slider = _resolveComponent(\"v-slider\")!\n  const _component_icon_button = _resolveComponent(\"icon-button\")!\n  const _component_map_controls = _resolveComponent(\"map-controls\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(_component_v_card, {\n      class: \"map-contents\",\n      style: {\"width\":\"100%\",\"height\":\"100%\"}\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_v_toolbar, {\n          density: \"compact\",\n          color: \"var(--info-background)\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_v_toolbar_title, { text: \"TEMPO Data Viewer\" }),\n            _createVNode(_component_v_tooltip, { text: \"Save map as image\" }, {\n              activator: _withCtx(({ props }) => [\n                _createVNode(MaplibreDownloadButton, _mergeProps(props, {\n                  map: map.value,\n                  filename: \"tempo-lab\"\n                }), null, 16, [\"map\"])\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_v_tooltip, {\n              text: _unref(selectionActive) === 'rectangle' ? 'Cancel selection' : 'Select a region'\n            }, {\n              activator: _withCtx(({ props }) => [\n                _createVNode(_component_v_btn, _mergeProps(props, {\n                  icon: \"mdi-select\",\n                  color: _unref(selectionActive) === 'rectangle' ? 'info' : 'default',\n                  variant: _unref(selectionActive) === 'rectangle' ? 'tonal' : 'text',\n                  disabled: _unref(selectionActive) === 'point',\n                  onClick: activateRectangleSelectionMode\n                }), null, 16, [\"color\", \"variant\", \"disabled\"])\n              ]),\n              _: 1\n            }, 8, [\"text\"]),\n            _createVNode(_component_v_tooltip, {\n              text: _unref(selectionActive) === 'point' ? 'Cancel selection' : 'Select a point'\n            }, {\n              activator: _withCtx(({ props }) => [\n                _createVNode(_component_v_btn, _mergeProps(props, {\n                  icon: \"mdi-plus\",\n                  color: _unref(selectionActive) === 'point' ? 'info' : 'default',\n                  variant: _unref(selectionActive) === 'point' ? 'tonal' : 'text',\n                  disabled: _unref(selectionActive) === 'rectangle',\n                  onClick: activatePointSelectionMode\n                }), null, 16, [\"color\", \"variant\", \"disabled\"])\n              ]),\n              _: 1\n            }, 8, [\"text\"])\n          ]),\n          _: 1\n        }),\n        _createVNode(EsriMap, {\n          mapID: mapID,\n          initial: _unref(initState),\n          home: _unref(homeState),\n          \"show-roads\": _unref(showRoads),\n          events: {\n          'moveend': updateURL,\n          'zoomend': updateURL,\n        },\n          timestamp: _unref(timestamp),\n          molecule: \"no2\",\n          opacity: opacity.value,\n          \"show-field-of-regard\": _unref(showFieldOfRegard),\n          onZoomhome: onZoomhome,\n          onReady: onMapReady,\n          onEsriLayer: _cache[0] || (_cache[0] = ($event: any) => (no2Layer.value = $event)),\n          onEsriTimestepsLoaded: onEsriTimestepsLoaded,\n          ref_key: \"maplibreMap\",\n          ref: maplibreMap,\n          width: \"100%\",\n          height: \"100%\",\n          \"maplibre-layer-name\": \"tempo-no2\"\n        }, null, 8, [\"initial\", \"home\", \"show-roads\", \"events\", \"timestamp\", \"opacity\", \"show-field-of-regard\"]),\n        (_unref(showFieldOfRegard))\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[7] || (_cache[7] = [\n              _createElementVNode(\"hr\", { class: \"line-legend\" }, null, -1),\n              _createTextVNode(\"TEMPO Field of Regard\", -1)\n            ]))]))\n          : _createCommentVNode(\"\", true),\n        _createElementVNode(\"div\", _hoisted_3, [\n          _createVNode(_component_location_search, {\n            modelValue: searchOpen.value,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((searchOpen).value = $event)),\n            small: \"\",\n            \"stay-open\": \"\",\n            buttonSize: \"xl\",\n            \"persist-selected\": \"\",\n            \"search-provider\": geocodingInfoForSearchLimited,\n            onSetLocation: setLocationFromSearch,\n            onError: _cache[2] || (_cache[2] = (error) => searchErrorMessage.value = error)\n          }, null, 8, [\"modelValue\"])\n        ])\n      ]),\n      _: 1\n    }),\n    _createElementVNode(\"div\", _hoisted_4, [\n      _createVNode(_component_v_slider, {\n        class: \"time-slider\",\n        modelValue: _unref(timeIndex),\n        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => (_isRef(timeIndex) ? (timeIndex).value = $event : null)),\n        min: _unref(minIndex),\n        max: _unref(maxIndex),\n        step: 1,\n        color: \"#068ede95\",\n        \"thumb-label\": \"always\",\n        \"track-size\": 10,\n        \"show-ticks\": \"always\",\n        \"hide-details\": \"\",\n        onEnd: _cache[4] || (_cache[4] = () => {\n          timeSliderUsedCount.value += 1;\n          // if (map) {\n          //   setLayerVisibility(map as Map, activeLayer, true);\n          // }\n        })\n      }, {\n        \"thumb-label\": _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_5, _toDisplayString(thumbLabel.value), 1)\n        ]),\n        _: 1\n      }, 8, [\"modelValue\", \"min\", \"max\"]),\n      _createVNode(_component_icon_button, {\n        class: \"play-pause\",\n        \"fa-icon\": playing.value ? 'pause' : 'play',\n        \"fa-size\": \"sm\",\n        onActivate: _cache[5] || (_cache[5] = ($event: any) => (playing.value = !playing.value))\n      }, null, 8, [\"fa-icon\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_6, [\n      _createVNode(_component_map_controls, {\n        class: \"flex-grow-1\",\n        onMolecule: _cache[6] || (_cache[6] = (mol) => {\n          molecule.value = mol;\n          // if (map) {\n          //   setLayerVisibility(map as Map, activeLayer, true);\n          // }\n        })\n      })\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"map-container\">\n    <v-card class=\"map-contents\" style=\"width:100%; height: 100%;\">\n      <v-toolbar\n        density=\"compact\"\n        color=\"var(--info-background)\"\n      >\n        <v-toolbar-title text=\"TEMPO Data Viewer\"></v-toolbar-title>\n        <v-tooltip text=\"Save map as image\">\n          <template #activator=\"{ props }\">\n            <MaplibreDownloadButton\n              v-bind=\"props\"\n              :map=\"map\" \n              filename=\"tempo-lab\"\n              />\n          </template>\n        </v-tooltip>\n        <!-- switch for preview points -->\n        <v-tooltip :text=\"selectionActive === 'rectangle' ? 'Cancel selection' : 'Select a region'\">\n          <template #activator=\"{ props }\">\n            <v-btn\n              v-bind=\"props\"\n              icon=\"mdi-select\"\n              :color=\"selectionActive === 'rectangle' ? 'info' : 'default'\"\n              :variant=\"selectionActive === 'rectangle' ? 'tonal' : 'text'\"\n              :disabled=\"selectionActive === 'point'\"\n              @click=\"activateRectangleSelectionMode\"\n            ></v-btn>\n          </template>\n        </v-tooltip>\n        <v-tooltip :text=\"selectionActive === 'point' ? 'Cancel selection' : 'Select a point'\">\n          <template #activator=\"{ props }\">\n            <v-btn\n              v-bind=\"props\"\n              icon=\"mdi-plus\"\n              :color=\"selectionActive === 'point' ? 'info' : 'default'\"\n              :variant=\"selectionActive === 'point' ? 'tonal' : 'text'\"\n              :disabled=\"selectionActive === 'rectangle'\"\n              @click=\"activatePointSelectionMode\"\n            ></v-btn>\n          </template>\n        </v-tooltip>\n      </v-toolbar>\n      <EsriMap\n        :mapID=\"mapID\"\n        :initial=\"initState\"\n        :home=\"homeState\"\n        :show-roads=\"showRoads\"\n        :events=\"{\n          'moveend': updateURL,\n          'zoomend': updateURL,\n        }\"\n        :timestamp=\"timestamp\"\n        molecule=\"no2\"\n        :opacity=\"opacity\"\n        :show-field-of-regard=\"showFieldOfRegard\"\n        @zoomhome=\"onZoomhome\"\n        @ready=\"onMapReady\"\n        @esri-layer=\"no2Layer = $event\"\n        @esri-timesteps-loaded=\"onEsriTimestepsLoaded\"\n        ref=\"maplibreMap\"\n        width=\"100%\"\n        height=\"100%\"\n        maplibre-layer-name=\"tempo-no2\"\n      />\n\n      <div v-if=\"showFieldOfRegard\" class=\"map-legend\"><hr class=\"line-legend\">TEMPO Field of Regard</div>\n      <!-- show hide cloud data, disable if none is available -->\n\n      <div class=\"location-and-sharing\">\n        <location-search\n          v-model=\"searchOpen\"\n          small\n          stay-open\n          buttonSize=\"xl\"\n          persist-selected\n          :search-provider=\"geocodingInfoForSearchLimited\"\n          @set-location=\"setLocationFromSearch\"\n          @error=\"(error: string) => searchErrorMessage = error\"\n        ></location-search>\n      </div>\n    </v-card>\n    <div class=\"slider-row mx-16 mt-12\">\n      <v-slider\n        class=\"time-slider\"\n        v-model=\"timeIndex\"\n        :min=\"minIndex\"\n        :max=\"maxIndex\"\n        :step=\"1\"\n        color=\"#068ede95\"\n        thumb-label=\"always\"\n        :track-size=\"10\"\n        show-ticks=\"always\"\n        hide-details\n        @end=\"() => {\n          timeSliderUsedCount += 1;\n          // if (map) {\n          //   setLayerVisibility(map as Map, activeLayer, true);\n          // }\n        }\"\n      >\n        <template v-slot:thumb-label>\n          <div class=\"thumb-label\">\n            {{ thumbLabel }}\n          </div>\n        </template>\n      </v-slider>\n      <icon-button\n        class=\"play-pause\"\n        :fa-icon=\"playing ? 'pause' : 'play'\"\n        fa-size=\"sm\"\n        @activate=\"playing = !playing\"\n      ></icon-button>\n    </div>\n    <div class=\"d-flex flex-row\">\n      <map-controls\n        class=\"flex-grow-1\"\n        @molecule=\"(mol: MoleculeType) => {\n          molecule = mol;\n          // if (map) {\n          //   setLayerVisibility(map as Map, activeLayer, true);\n          // }\n        }\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { computed, ref, toRaw, useTemplateRef, watch, type Ref, type WritableComputedRef } from \"vue\";\nimport { useDisplay } from 'vuetify';\nimport { storeToRefs } from \"pinia\";\nimport { MapBoxFeature, MapBoxFeatureCollection, MapBoxFeatureType, MapBoxForwardGeocodingOptions, geocodingInfoForSearch } from \"@cosmicds/vue-toolkit\";\nimport { Map, GeoJSONSource, type StyleLayer } from \"maplibre-gl\";\nimport { getTimezoneOffset } from \"date-fns-tz\";\nimport { v4 } from \"uuid\";\n\nimport type { LatLngPair, PointSelectionInfo, RectangleSelectionInfo, SelectionType } from \"@/types\";\nimport { type MoleculeType, MOLECULE_OPTIONS } from \"@/esri/utils\";\nimport { colorbarOptions } from \"@/esri/ImageLayerConfig\";\nimport { useTempoStore } from \"@/stores/app\";\nimport { useLocationMarker } from \"@/composables/maplibre/useMarker\";\nimport { useRectangleSelection } from \"@/composables/maplibre/useRectangleSelection\";\nimport { addRectangleLayer, addPointLayer, regionBounds, fitBounds, removeRectangleLayer, removePointLayer } from \"@/composables/maplibre/utils\";\nimport { usePointSelection } from \"@/composables/maplibre/usePointSelection\";\nimport { COLORS } from \"@/utils/color\";\nimport { EsriSampler } from \"@/esri/services/sampling\";\nimport { useMultiMarker } from '@/composables/maplibre/useMultiMarker';\n\nimport { setLayerOpacity, setLayerVisibility } from \"@/maplibre_controls\";\n\nimport EsriMap from \"@/components/EsriMap.vue\";\nimport MapColorbarWrap from \"@/components/MapColorbarWrap.vue\";\nimport MaplibreDownloadButton from \"@/components/MaplibreDownloadButton.vue\";\n\ntype MapType = Map | null;\ntype MapTypeRef = Ref<MapType>;\nconst maplibreMap = useTemplateRef<InstanceType<typeof EsriMap>>(\"maplibreMap\");\nconst map = ref<MapType>(null);\n\ntype Timeout = ReturnType<typeof setTimeout>;\n\nconst mapID = `map-${v4().replace(\"-\", \"\")}`;\n\nconst store = useTempoStore();\nconst {\n  regions,\n  regionOpacity,\n  regionVisibility,\n  timestamp,\n  timeIndex,\n  minIndex,\n  maxIndex,\n  date,\n  selectedTimezone,\n  timeSliderUsedCount,\n  playButtonClickedCount,\n  timestamps,\n  timestampsLoaded,\n  selectionActive,\n  regionsCreatedCount,\n  maxSampleCount,\n  focusRegion,\n  initState,\n  homeState,\n  showFieldOfRegard,\n  showRoads,\n  showSamplingPreviewMarkers,\n  singleDateSelected,\n  showAdvancedLayers,\n  showRGBMode,\n} = storeToRefs(store);\n\nconst molecule = ref<MoleculeType>(\"no2\");\nconst currentTempoDataService = computed(() => store.getTempoDataService(molecule.value));\n\nfunction createSelectionComputed(selection: SelectionType): WritableComputedRef<boolean> {\n  return computed({\n    get() {\n      return selectionActive.value === selection;\n    },\n    set(value: boolean) {\n      if (value === (selectionActive.value !== selection)) {\n        selectionActive.value = value ? selection : null;\n      }\n    },\n  });\n}\n\nconst pointSelectionActive = createSelectionComputed(\"point\");\nconst rectangleSelectionActive = createSelectionComputed(\"rectangle\");\n\nconst { selectionInfo: rectangleInfo } = useRectangleSelection(map as MapTypeRef, \"red\", rectangleSelectionActive);\nconst { selectionInfo: pointInfo } = usePointSelection(map as MapTypeRef, pointSelectionActive);\n\ntype UnifiedRegionType = typeof regions.value[number];\n\nconst display = useDisplay();\n\nimport { addPowerPlants } from \"@/composables/addPowerPlants\";\nimport { addHMSFire } from \"@/composables/addHMSFire\";\n\nconst pp = addPowerPlants(map as Ref<Map | null> | null, false);\nimport { addQUI } from '@/composables/addAQI';\n\n// base it of singleDateSelected\nconst airQualityUrl = computed(() => {\n  const date = store.singleDateSelected;\n  if (!date) {\n    return 'https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/2025/20250914/KMLPointMaps_PM2.5-24hr.kml';\n  }\n\n  const year = date.getUTCFullYear();\n  const month = (date.getUTCMonth() + 1).toString().padStart(2, '0');\n  const day = date.getUTCDate().toString().padStart(2, '0');\n  return `https://s3-us-west-1.amazonaws.com/files.airnowtech.org/airnow/${year}/${year}${month}${day}/KMLPointMaps_PM2.5-24hr.kml`;\n});\nconst aqiLayer = addQUI(airQualityUrl.value, { \n  propertyToShow: 'aqi', \n  labelMinZoom: 5, \n  layerName: 'aqi', \n  visible: false,\n  showLabel: true, \n  showPopup: true\n});\n\n// Ensure date/url changes trigger a reload, even if initial load failed\nwatch(airQualityUrl, (newUrl) => {\n  aqiLayer.setUrl(newUrl).catch(() => {/* ignore */});\n});\n\n\nimport { addPopulationDensityLayer } from '@/composables/addPopulationDensity';\nconst popLayer = addPopulationDensityLayer();\n\nimport { addLandUseLayer } from \"@/composables/addLandUse\";\nconst sentinalLandUseLayer = addLandUseLayer();\n\nconst hmsFire = addHMSFire(singleDateSelected, {\n  layerName: 'hms-fire',\n  visible: false,\n  showPopup: true,\n  showLabel: false,\n});\n\nimport { type UseEsriTempoLayer, useTempoLayer } from \"@/esri/maplibre/useTempoImageLayer\";\n// just use the hcho layer for now\nconst hchoLayer = useTempoLayer({\n  initialMolecule: \"hcho\",\n  timestamp,\n  opacity: 1,\n  fetchOnMount: true,\n  layerName: \"tempo-hcho\",\n  initVisible: false,\n  initRGB: showRGBMode.value,\n});\nconst ozoneLayer = useTempoLayer({\n  initialMolecule: \"o3\",\n  timestamp,\n  opacity: 1,\n  fetchOnMount: true,\n  layerName: \"tempo-o3\",\n  initVisible: false,\n  initRGB: showRGBMode.value,\n});\nconst no2Layer = ref<UseEsriTempoLayer | null>(null);\n\nfunction addAdvancedLayers(m: Map | null) {\n  if (m === null) {\n    throw new Error('Tried to addAdvancedLayers but map was null');\n  }\n  // pp.addheatmapLayer();\n  // pp.togglePowerPlants(false);\n  aqiLayer.addToMap(m);\n  popLayer.addEsriSource(m);\n  sentinalLandUseLayer.addEsriSource(m);\n  hmsFire.addToMap(m);\n  hchoLayer.addEsriSource(m);\n  ozoneLayer.addEsriSource(m);\n  // Only move if target layer exists (avoid errors if initial KML load failed)\n  try {\n    if (m.getLayer('kml-layer-aqi')) {\n      m.moveLayer('states-custom','kml-layer-aqi');\n    }\n  } catch {\n    // ignore\n  }\n  \n  pp.addLayer();\n  // pp.togglePowerPlants(false);\n}\n\nfunction removeAdvancedLayers(m: Map | null) {\n  if (m === null) {\n    throw new Error('Tried to removeAdvancedLayers but map was null');\n  }\n  aqiLayer.removeFromMap(m);\n  popLayer.removeEsriSource();\n  sentinalLandUseLayer.removeEsriSource();\n  hmsFire.removeFromMap(m);\n  hchoLayer.removeEsriSource();\n  ozoneLayer.removeEsriSource();\n  pp.removeLayer();\n}\n\nconst onMapReady = (m: Map) => {\n  map.value = m; // ESRI source already added by EsriMap\n  if (showAdvancedLayers.value) addAdvancedLayers(m);\n  updateRegionLayers(regions.value);\n  m.resize();\n};\n\nwatch(showAdvancedLayers, (value) => {\n  if (value) {\n    addAdvancedLayers(map.value as Map | null);\n    return;\n  }\n  removeAdvancedLayers(map.value as Map | null);\n  \n  \n});\n\nwatch(molecule, (newMolecule) => {\n  if (map.value) {\n    hchoLayer.setVisibility(newMolecule === 'hcho');\n    ozoneLayer.setVisibility(newMolecule === 'o3');\n    no2Layer.value?.setVisibility(newMolecule === 'no2');\n    // map.value.moveLayer(`tempo-${newMolecule}`, 'tempo-no2');\n  }\n});\n\nconst activeLayer = computed(() => `tempo-${molecule.value}`);\n\nimport { stretches, colorramps, rgbstretches, rgbcolorramps, type ColorRamps } from \"@/esri/ImageLayerConfig\";\n  \nwatch(showRGBMode, (cMode) => {\n\n  const colormapsToUse = cMode ? rgbcolorramps : colorramps;\n  hchoLayer.renderOptions.value.colormap = colormapsToUse['HCHO'];\n  ozoneLayer.renderOptions.value.colormap = colormapsToUse['Ozone_Column_Amount'];\n  if (no2Layer.value) {\n    no2Layer.value.renderOptions.colormap = colormapsToUse['NO2_Troposphere'];\n  }\n\n  const stretchesToUse = cMode ? rgbstretches : stretches;\n  hchoLayer.renderOptions.value.range = stretchesToUse['HCHO'];\n  ozoneLayer.renderOptions.value.range = stretchesToUse['Ozone_Column_Amount'];\n  if (no2Layer.value) {\n    no2Layer.value.renderOptions.range = stretchesToUse['NO2_Troposphere'];\n  }\n\n});\n\nconst showLocationMarker = ref(true);\nconst {\n  setMarker,\n  removeMarker,\n  locationMarker,\n} = useLocationMarker(map as Ref<Map | null>, showLocationMarker.value);\n\nconst opacity = ref(0.9);\nconst playing = ref(false);\nconst playInterval = ref<Timeout | null>(null);\n\n\nconst searchOpen = ref(true);\nconst searchErrorMessage = ref<string | null>(null);\nfunction activateRectangleSelectionMode() {\n  rectangleSelectionActive.value = !rectangleSelectionActive.value;\n}\n\nfunction activatePointSelectionMode() {\n  pointSelectionActive.value = !pointSelectionActive.value;\n}\n\nconst regionLayers: Record<string, GeoJSONSource> = {};\n\n// const colorMap = computed(() => colorbarOptions[molecule.value].colormap.toLowerCase());\nconst colorMap = computed(() => {\n  const mol = molecule.value == 'no2' \n    ? 'NO2_Troposphere' : molecule.value == 'hcho' \n      ? 'HCHO' : 'Ozone_Column_Amount';\n  return showRGBMode.value ? rgbcolorramps[mol].toLowerCase() : colorramps[mol].toLowerCase();\n});\n\ntype ColorbarOptionsKey = keyof typeof colorbarOptions;\nconst currentColorbarOptions = computed<typeof colorbarOptions[ColorbarOptionsKey]>(() => {\n  const mol = molecule.value == 'no2' \n    ? 'NO2_Troposphere' : molecule.value == 'hcho' \n      ? 'HCHO' : 'Ozone_Column_Amount';\n  return {\n    ...colorbarOptions[molecule.value],\n    colormap: showRGBMode.value ? rgbcolorramps[mol] : colorramps[mol],\n    stretch: showRGBMode.value ? rgbstretches[mol] : stretches[mol],\n  };\n});\n\nwatch(currentColorbarOptions, (cc) => {\n  console.log('current colorbar options changed to', cc);\n});\n\nwatch(colorMap, (value) => {\n  console.log('color map changed to', value);\n});\n\n\n// TODO: Maybe there's a built-in Date function to get this formatting?\nconst thumbLabel = computed(() => {\n  if (date.value === null || timestamp.value === null) {\n    return '';\n  }\n  const offset = getTimezoneOffset(selectedTimezone.value, date.value);\n  const dateObj = new Date(timestamp.value + offset);\n  const hours = dateObj.getUTCHours();\n  const amPm = hours >= 12 ? \"PM\" : \"AM\";\n  let hourValue = hours % 12;\n  if (hourValue === 0) {\n    hourValue = 12;\n  }\n  return `${date.value.getUTCMonth() + 1}/${dateObj.getUTCDate()}/${dateObj.getUTCFullYear()} ${hourValue}:${dateObj.getUTCMinutes().toString().padStart(2, '0')} ${amPm}`;\n});\n\nconst defaultMapboxOptions = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  types: [\"place\", \"postcode\"] as MapBoxFeatureType[],\n  countries: [\"US\", \"CA\", \"MX\", \"CU\", \"BM\", \"HT\", \"DO\"],\n  limit: 5,\n};\nasync function geocodingInfoForSearchLimited(searchText: string, options?: MapBoxForwardGeocodingOptions): Promise<MapBoxFeatureCollection | null> {\n  const token = process.env.VUE_APP_MAPBOX_ACCESS_TOKEN;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const opts = options ?? { ...defaultMapboxOptions, access_token: token ?? \"\" };\n  return geocodingInfoForSearch(searchText, opts).catch(_err => null);\n}\n\nfunction setLocationFromSearch(items: [MapBoxFeature | null, string]) {\n  const [feature, text] = items;\n  if (feature !== null) {\n    // Latitude, Longitude order\n    const coordinates: LatLngPair = [feature.center[1], feature.center[0]] as LatLngPair;\n    maplibreMap.value?.setView(coordinates, 12);\n    setMarker(coordinates);\n    store.userSelectedLocations.push(text);\n  }\n}\n\nfunction onZoomhome() {\n  if (locationMarker.value !== null) {\n    removeMarker();\n  }\n}\n\nconst currentUrl = ref(window.location.href);\nfunction updateURL() {\n  if (map.value) {\n    const center = map.value.getCenter();\n    let stateObj = null as Record<string, string> | null;\n    stateObj = {\n      lat: `${center.lat.toFixed(4)}`,\n      lon: `${center.lng.toFixed(4)}`,\n      zoom: `${map.value.getZoom()}`,\n      t: `${timestamp.value}`\n    };\n    const url = new URL(location.origin);\n    const searchParams = new URLSearchParams(stateObj ?? {});\n    // const hash = window.location.hash;\n    // url.hash = hash;\n    url.pathname = location.pathname;\n    window.history.replaceState(null, '', url.toString());\n    url.search = searchParams.toString();\n    currentUrl.value = url.toString();\n    // window.history.replaceState(stateObj, '', url);\n  }\n}\n\n// ESRI timesteps arrive from EsriMap component; store directly in timestamps\nfunction onEsriTimestepsLoaded(steps: number[]) {\n  if (!Array.isArray(steps) || steps.length === 0) return;\n  console.log(`%c[EsriMap] onEsriTimestepsLoaded: received ${steps.length} steps`, 'color: purple');\n  const sorted = steps.slice().sort();\n  timestamps.value = sorted;\n  if (timeIndex.value >= sorted.length) {\n    timeIndex.value = 0;\n  }\n  timestampsLoaded.value = true;\n}\n\nwatch(playing, (val: boolean) => {\n  if (val) {\n    play();\n    playButtonClickedCount.value += 1;\n  } else {\n    pause();\n  }\n});\n\nfunction play() {\n  playInterval.value = setInterval(() => {\n    if (timeIndex.value >= maxIndex.value) {\n      if (playInterval.value) {\n        // clearInterval(this.playInterval);\n        // this.playInterval = null;\n        // let it loop\n        timeIndex.value = minIndex.value;\n      }\n    } else {\n      timeIndex.value += 1;\n    }\n  }, 1000);\n}\n\n\nfunction pause() {\n  if (playInterval.value) {\n    clearInterval(playInterval.value);\n  }\n}\n\nfunction rectangleIsDegenerate(info: RectangleSelectionInfo): boolean {\n  return info.xmax === info.xmin || info.ymax === info.ymin;\n}\n\nfunction addLayer(\n  info: RectangleSelectionInfo | PointSelectionInfo,\n  geometryType: \"rectangle\" | \"point\",\n  color: string,\n): { layer: GeoJSONSource } {\n  const isRect = geometryType === 'rectangle';\n  const layerInfo = isRect ?\n    addRectangleLayer((map.value as MapType)!, info as RectangleSelectionInfo, color, regionOpacity.value, regionVisibility.value) :\n    addPointLayer((map.value as MapType)!, info as PointSelectionInfo, color, regionVisibility.value);\n  map.value?.moveLayer(layerInfo.layer.id);\n  return layerInfo;\n}\n\nfunction removeLayer(\n  layer: StyleLayer,\n  geometryType: \"rectangle\" | \"point\",\n) {\n  const isRect = geometryType === 'rectangle';\n  if (isRect) {\n    removeRectangleLayer((map.value as MapType)!, layer);\n  } else {\n    removePointLayer((map.value as MapType)!, layer);\n  }\n}\n\nfunction createRegion(info: RectangleSelectionInfo | PointSelectionInfo, geometryType: \"rectangle\" | \"point\"): UnifiedRegionType {\n  const color = COLORS[regionsCreatedCount.value % COLORS.length];\n  regionsCreatedCount.value += 1;\n\n  const id = v4();\n  const { layer } = addLayer(info, geometryType, color);\n  regionLayers[id] = layer;\n  return {\n    id,\n    name: `${geometryType === \"rectangle\" ? 'Region' : 'Point'} ${regionsCreatedCount.value}`,\n    geometryInfo: toRaw(info),\n    geometryType: geometryType,\n    color,\n  };\n}\n\nfunction getRegionsDifference(arr1: UnifiedRegionType[], arr2: UnifiedRegionType[]): UnifiedRegionType[] {\n  const ids2 = arr2.map(r => r.id);\n  return arr1.filter(element => !ids2.includes(element.id));\n}\n\nlet existingRegions: UnifiedRegionType[] = [];\nfunction updateRegionLayers(newRegions: UnifiedRegionType[]) {\n  const added = getRegionsDifference(newRegions, existingRegions);\n  const removed = getRegionsDifference(existingRegions, newRegions);\n  added.forEach(region => {\n    if (map.value && !regionLayers[region.id]) {\n      const { layer } = addLayer(region.geometryInfo, region.geometryType, region.color);\n      regionLayers[region.id] = layer;\n    }\n  });\n\n  removed.forEach(region => {\n    if (map.value && regionLayers[region.id]) {\n      removeLayer(regionLayers[region.id] as unknown as StyleLayer, region.geometryType);\n      delete regionLayers[region.id];\n    }\n  });\n  existingRegions = [...newRegions];\n}\n\nwatch(regions, updateRegionLayers, { deep: true });\n\nwatch(regionOpacity, (opacity: number) => {\n  if (map.value !== null) {\n    Object.values(regionLayers).forEach(layer => {\n      setLayerOpacity(map.value as Map, layer.id, opacity);\n    });\n    setLayerOpacity(map.value as Map, \"predicted-samples-locations-layer\", opacity);\n  }\n});\n\nwatch(regionVisibility, (visible: boolean) => {\n  if (map.value !== null) {\n    Object.values(regionLayers).forEach(layer => {\n      setLayerVisibility(map.value as Map, layer.id, visible);\n    });\n    setLayerVisibility(map.value as Map, \"predicted-samples-locations-layer\", visible);\n  }\n});\n\nwatch(rectangleInfo, (info: RectangleSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    rectangleSelectionActive.value = false;\n    return;\n  }\n  if (rectangleIsDegenerate(info)) {\n    // make it a point selection instead\n    // TODO: only implement when we have a solution to only do this on a double-click\n    // pointInfo.value = {\n    //   x: info.xmin,\n    //   y: info.ymin\n    // };\n    rectangleSelectionActive.value = false;\n    return;\n  }\n\n  const newRegion = createRegion(info, \"rectangle\");\n  store.addRegion(newRegion);\n  rectangleSelectionActive.value = false;\n  \n  // do not permit editing a region on a selection\n  // handleSelectionRegionEdit(info);\n  \n\n});\n\n// Add watcher for point selection\nwatch(pointInfo, (info: PointSelectionInfo | null) => {\n  if (info === null || map.value === null) {\n    pointSelectionActive.value = false;\n    return;\n  }\n  const newRegion = createRegion(info, \"point\"); \n  store.addRegion(newRegion);\n  pointSelectionActive.value = false;\n});\n\nconst samplingPreviewMarkers = useMultiMarker(map as MapTypeRef , {\n  shape: 'circle',\n  color: '#0000ff',\n  fillColor: '#0000ff',\n  fillOpacity: 0.5,\n  opacity: regionOpacity.value,\n  radius: 0.02 / 2, // degrees\n  scale: 'world',\n  outlineColor: '#0000ff',\n  label: 'predicted-samples-locations'\n});\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nconst sampler = ref<EsriSampler>(null);\ncurrentTempoDataService.value.withMetadataCache().then(meta => {\n  sampler.value = new EsriSampler(meta);\n});\n\nwatch([showSamplingPreviewMarkers, regions, ()=> regions.value.length], (newVal) => {\n  const tempoDataService = currentTempoDataService.value;\n  const show = newVal[0];\n  const regs = newVal[1];\n  samplingPreviewMarkers.clearMarkers();\n  let locations: {x: number, y:number}[] = [];\n  if (sampler.value && show && regs.length > 0) {\n    regs.forEach(r => {\n      if (r.geometryType === 'rectangle') {\n        sampler.value.setGeometry(r.geometryInfo);\n        if (tempoDataService.meta) {\n          sampler.value.setMetadata(tempoDataService.meta);\n        }\n        locations = [...locations, ...sampler.value.getSampleLocationsGrid(maxSampleCount.value)];\n        // samplingPreviewMarkers.addMarkers(locations);\n      }\n    });\n    samplingPreviewMarkers.addMarkers(locations);\n  }\n});\n\n// TODO: This may need to be revisited when there are two maps\nwatch(focusRegion, region => {\n  if (region !== null) {\n    const bounds = regionBounds(region);\n    fitBounds(map.value, bounds, true);\n    focusRegion.value = null;\n  }\n});\n\n</script>\n\n<style lang=\"less\">\n.map-container {\n  width: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  padding-inline: 8px;\n\n  .location-and-sharing {\n    position: absolute;\n    bottom: 0;\n    z-index: 1000;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n    width: fit-content;\n  }\n\n  .forward-geocoding-container {\n    width: 250px;\n    border: 2px solid black;\n  }\n\n  .map-show-hide-controls {\n    z-index: 1000;\n    position: absolute;\n    top: calc(48px + 1rem);\n    right: 80px;\n  }\n\n  .map-legend {\n    position: absolute;\n    top: 48px;\n    right: 80px;\n    width: fit-content;\n    z-index: 1000;\n\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n\n    color: black;\n    background-color: #fff5;\n    padding-left: 0.5rem;\n    padding-right: 0.25rem;\n\n    backdrop-filter: blur(5px);\n\n    hr.line-legend {\n      display: inline-block;\n      border: 0.5px solid #c10124;\n      width: 3rem;\n    }\n  }\n\n  .controls-card {\n    padding: 1rem;\n    border: 1px solid #068ede;\n  }\n\n  .slider-row {\n    display: flex;\n    flex-direction: row;\n    padding-left: 0;\n  }\n\n  >.play-pause {\n    height: fit-content;\n    align-self: center;\n    padding-inline: 0.5rem;\n    margin-left: 0.75rem;\n    width: 2.5rem;\n    color: var(--accent-color);\n    border: 2px solid var(--accent-color);\n  }\n\n  .play-pause[disabled] {\n    filter: grayscale(100%);\n    cursor: progress;\n    cursor: not-allowed;\n  }\n\n  .icon-wrapper {\n    padding-inline: 0.5rem !important;\n  }\n}\n\n.time-slider {\n\n  .v-slider-thumb {\n\n    .v-slider-thumb__surface::after {\n      background-image: url(\"@/assets/smithsonian.png\");\n      background-size: 30px 30px;\n      height: 30px;\n      width: 30px;\n    }\n\n    .v-slider-thumb__label {\n      background-color: var(--accent-color-2);\n      border: 0.25rem solid var(--accent-color);\n      width: max-content;\n      height: 2.5rem;\n      font-size: 1rem;\n\n      &::before {\n        color: var(--accent-color);\n      }\n    }\n  }\n\n  .v-slider-track__tick {\n    background-color: var(--accent-color);\n    /* Change color */\n    height: 15px;\n    /* Change size */\n    width: 4px;\n    margin-top: 0 !important;\n    // top: -10%;\n  }\n\n  .v-slider {\n\n    .v-slider.v-input--horizontal {\n      grid-template-rows: auto 0px;\n    }\n\n    .v-slider.v-input--horizontal .v-slider-thumb__label {\n      // top: calc(var(--v-slider-thumb-size) * 1.5);\n      z-index: 2000;\n    }\n\n    .v-slider.v-input--horizontal .v-slider-thumb__label::before {\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-bottom: 6px solid transparent;\n      border-top: 6px solid currentColor;\n      bottom: -15px;\n    }\n  }\n}\n\n#opacity-slider-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  padding-left: 7%;\n  padding-right: 7%;\n  gap: 2px;\n\n  .v-slider {\n    margin-right: 0;\n    width: 100%;\n  }\n\n  #opacity-slider-label {\n    opacity: 0.7;\n    width: fit-content;\n  }\n}\n\n.hms-popup {\n  font-size: 14px;\n  line-height: 1.4;\n  max-width: 200px;\n  color: black;\n}\n\n@import \"@/styles/maplibre-layer-control.css\";\n</style>\n","import script from \"./MapWithControls.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapWithControls.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapWithControls.vue?vue&type=style&index=0&id=b1403204&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, mergeProps as _mergeProps, renderSlot as _renderSlot, toDisplayString as _toDisplayString, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\ninterface Props {\n  infoText?: string;\n  size?: string | number;\n  width?: string | number;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'PopupInfoButton',\n  props: {\n    infoText: { default: \"No information provided.\" },\n    size: { default: \"small\" },\n    width: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\n\nconst cardProps: Record<string, string | number> = {};\nif (props.width != undefined) {\n  cardProps.width = props.width;\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_card_text = _resolveComponent(\"v-card-text\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n  const _component_v_menu = _resolveComponent(\"v-menu\")!\n\n  return (_openBlock(), _createBlock(_component_v_menu, { \"open-on-hover\": \"\" }, {\n    activator: _withCtx(({ props }) => [\n      _createVNode(_component_v_btn, _mergeProps({\n        icon: \"\",\n        class: \"info-button\"\n      }, props, {\n        density: \"compact\",\n        flat: \"\",\n        size: __props.size\n      }), {\n        default: _withCtx(() => [\n          _createVNode(_component_v_icon, null, {\n            default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n              _createTextVNode(\"mdi-information-variant-circle-outline\", -1)\n            ]))]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 16, [\"size\"])\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_component_v_card, _mergeProps({ class: \"info-card\" }, cardProps), {\n        default: _withCtx(() => [\n          _renderSlot(_ctx.$slots, \"info\", {}, () => [\n            _createVNode(_component_v_card_text, null, {\n              default: _withCtx(() => [\n                _createTextVNode(_toDisplayString(__props.infoText), 1)\n              ]),\n              _: 1\n            })\n          ])\n        ]),\n        _: 3\n      }, 16)\n    ]),\n    _: 3\n  }))\n}\n}\n\n})","<template>\n  <v-menu open-on-hover>\n    <template #activator=\"{ props }\">\n      <v-btn\n        icon\n        class=\"info-button\"\n        v-bind=\"props\"\n        density=\"compact\"\n        flat\n        :size=\"size\"\n      >\n        <v-icon>mdi-information-variant-circle-outline</v-icon>\n      </v-btn>\n    </template>\n    <v-card\n      class=\"info-card\"\n      v-bind=\"cardProps\"\n    >\n      <slot name=\"info\">\n        <v-card-text>{{ infoText }}</v-card-text>\n      </slot>\n    </v-card>\n  </v-menu>\n</template>\n\n<script setup lang=\"ts\">\ninterface Props {\n  infoText?: string;\n  size?: string | number;\n  width?: string | number;\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  infoText: \"No information provided.\",\n  size: \"small\",\n});\n\nconst cardProps: Record<string, string | number> = {};\nif (props.width != undefined) {\n  cardProps.width = props.width;\n}\n</script>\n\n<style scoped>\n.info-card {\n  padding: 10px;\n  border-radius: 5px;\n  outline: 1px solid rgb(var(--v-theme-surface-variant));\n}\n\n.v-btn {\n  background-color: transparent;\n}\n</style>\n","import script from \"./PopupInfoButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PopupInfoButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PopupInfoButton.vue?vue&type=style&index=0&id=e1bdf65c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e1bdf65c\"]])\n\nexport default __exports__","\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { type Ref, type MaybeRef, ref, toRef, watch, computed, onBeforeUnmount } from 'vue';\nimport M from 'maplibre-gl';\n\nfunction checkArrayEquality<T>(arr1: T[], arr2: T[]) {\n  if (arr1.length !== arr2.length) return false;\n  return arr1.map((v, i) => v === arr2[i]).every(v => v);\n}\n\nfunction _isSubset<T>(subset: T[], superset: T[]) {\n  return subset.every(v => superset.includes(v));\n}\n\n/** \n * Make the element at fromIndex be at toIndex, shifting other elements as needed\n * Does not mutate the original array, returns a new array\n * Throws error if fromIndex or toIndex are out of bounds\n */\nfunction arrayMove<T>(arr: T[], fromIndex: number, toIndex: number) {\n  if (fromIndex < 0 || fromIndex >= arr.length) {\n    throw new Error('fromIndex out of bounds');\n  }\n  if (toIndex < 0 || toIndex >= arr.length) {\n    throw new Error('toIndex out of bounds');\n  }\n  \n  const newArr = [...arr];\n  \n  if (fromIndex === toIndex) return newArr;\n  \n  // remove the element from fromIndex and insert it at toIndex\n  const element = newArr.splice(fromIndex, 1)[0];\n  newArr.splice(toIndex, 0, element);\n   \n  \n  return newArr;\n  \n}\n\ninterface LinkedLayers {\n  primary: string,\n  linkedLayers: string[],\n}\n\ninterface Options {\n  keepAtTop?: boolean;\n  linkedLayers?: [string, string[]][];\n}\n\nclass PsuedoEvent {\n  private listeners: Record<string, Array<() => void>> = {};\n  \n  addEventListener(event: string, handler: () => void) {\n    if (!this.listeners[event]) {\n      this.listeners[event] = [];\n    }\n    this.listeners[event].push(handler);\n  }\n  \n  removeEventListener(event: string, handler: () => void) {\n    if (!this.listeners[event]) return;\n    this.listeners[event] = this.listeners[event].filter(h => h !== handler);\n  }\n  \n  dispatchEvent(event: string) {\n    if (!this.listeners[event]) return;\n    this.listeners[event].forEach(handler => handler());\n  }\n  \n  cleanup() {\n    this.listeners = {};\n  }\n}\n\ntype MaplibreLayerOrderControlEvent = 'layer-order-changed';\n\n/**\n * Controls the ordering of MapLibre GL layers in a declarative way.\n * Maintains a desired layer order even as layers are added/removed from the map.\n * Higher index in order array = higher/more visible layer on map.\n */\nexport class MaplibreLayerOrderControl extends PsuedoEvent {\n  private _map: M.Map;\n  private _desiredLayerOrder: string[]; // bottom to top \n  private _keepAtTop: boolean;\n  private _initialized = false;\n  private _eventHandlers: [string, () => void][] = [];\n  private _layerOrder: string[] = [];\n  private _linked: LinkedLayers[] = [];\n  \n  /**\n   * Creates a new layer order controller.\n   * @param map - The MapLibre GL map instance\n   * @param initialOrder - Initial desired layer order (bottom to top)\n   * @param options - Configuration options\n   */\n  constructor(map: M.Map, initialOrder: string[], options: Options = {}) {\n    super();\n    this._desiredLayerOrder = initialOrder;\n    this._map = map;\n    this._keepAtTop = options.keepAtTop ?? false;\n    if (options.linkedLayers) {\n      this._linked = options.linkedLayers.map(link => this._newLink(link));\n    }\n    \n    const idleListener = () => {\n      this._orderLayers();\n      this._initialized = true;\n      this._watchForChanges();\n      this._map.off('idle', idleListener);\n    };\n    // wait for map to be ready\n    this._map.on('idle',idleListener);\n    \n  }\n  \n  /**\n   * Register an event handler for layer order changes.\n   * Handler fires after each ordering pass completes.\n   */\n  on(event: MaplibreLayerOrderControlEvent, handler: () => void) {\n    this.addEventListener(event, handler);\n  }\n\n  /** Get which managed layers are currently available on the map. \n   * \n   * returns {layerName: boolean, ... }\n  */\n  get desiredLayerAvailability() {\n    return this._desiredLayerOrder.reduce((acc, layer) => {\n      acc[layer] = this.hasLayer(layer);\n      return acc;\n    }, {} as Record<string, boolean>);\n  }\n  \n  /**\n   * Get the subset of desired layers that currently exist on the map (bottom to top).\n   * Layers missing from the map are filtered out.\n   */\n  get availableDesiredOrder() {\n    return this._desiredLayerOrder.filter(l => this.hasLayer(l));\n  }\n  \n  /**\n   * Get the current managed layers in their actual order on the map (bottom to top).\n   * Uses the map's actual layer stack, filtered to only managed layers.\n   */\n  get currentlyManagedLayerOrder() {\n    this._layerOrder = this._map.\n      getLayersOrder().\n      filter(l => this._desiredLayerOrder.includes(l));\n    return this._layerOrder;\n  }\n  \n  private _checkLayerChanges() {\n    const orderAtLastCheck = this._layerOrder;\n    const currentOrder = this.currentlyManagedLayerOrder;\n    const val = {\n      removed: orderAtLastCheck.filter(l => !currentOrder.includes(l)),\n      added: currentOrder.filter(l => !orderAtLastCheck.includes(l)),\n    };\n\n    return {\n      ...val, \n      changed: val.removed.length > 0 || val.added.length > 0,\n    };\n  }\n  \n  /** A thin wrapper for maplibre.Map.moveLayer\n   * Moves a layer to a different z-position.\n   * @param layer  The ID of the layer to move.\n   * @param anchor  The ID of an existing layer to insert the new layer before. When viewing the map, the id layer will appear beneath the anchor layer. If anchor is omitted, the layer will be appended to the end of the layers array and appear above all other layers on the map.\n   * @example Move a layer with ID 'polygon' before the layer with ID 'country-label'. The polygon layer will appear beneath the country-label layer on the map.\n   */\n  private _moveLayerBelow(layer: string, anchor: string) {\n    this._map.moveLayer(layer, anchor);\n  }\n  \n  /** Does the oppposite of _moveLayerBelow. Placing the layer\n   * below the anchor layer.\n  */\n  private _moveLayerAbove(layer: string, anchor: string) {\n    // this.map.moveLayer(anchor, layer); \n    // without moving the anchor\n    const currentOrder = this._map.getLayersOrder();\n    const anchorIndex = currentOrder.indexOf(anchor);\n    const nextLayerUpIndex = anchorIndex + 1;\n    if (nextLayerUpIndex >= currentOrder.length) {\n      // anchor is already top layer\n      this._map.moveLayer(layer);\n    } else {\n      // move below the next layer up\n      const nextLayerUp = currentOrder[nextLayerUpIndex];\n      this._map.moveLayer(layer, nextLayerUp);\n    }\n  }\n  \n  private _applyLinkedLayers() {\n    if (!this._linked.length) return;\n    console.log('Applying linked layers', this._linked);\n    \n    const mapOrder = new Map<string, number>(\n      this._map.getLayersOrder().map((layer, index) => [layer, index])\n    );\n    console.log('Current map layer order', mapOrder.size);\n    \n    for (const linked of this._linked) {\n      const { primary } = linked;\n      const linkedLayers = linked.linkedLayers.filter(l => this.hasLayer(l) && mapOrder.has(l));\n      // make sure primary exists and we have linked layers\n      if (!primary || linkedLayers.length === 0) continue;\n      if (!this.hasLayer(primary)) continue;\n      \n      let anchor = primary;\n      const primaryIndex = linkedLayers.indexOf(primary);\n      \n      // if we don't include the primary, then\n      // we will stack them below the primary\n      const belowPrimary = primaryIndex === -1 ? linkedLayers : linkedLayers.slice(0, primaryIndex);\n      const abovePrimary = primaryIndex === -1 ? [] : linkedLayers.slice(primaryIndex + 1);\n      \n      \n      // Stack upwards from the primary\n      for (const layer of abovePrimary) {\n        this._moveLayerAbove(layer, anchor);\n        anchor = layer;\n      }\n      \n      // Stack downwards from the primary\n      // don't update anchor when going down\n      // because we want to keep stacking/pusing downwards\n      anchor = primary;\n      for (const layer of belowPrimary) {\n        if (layer === primary) continue;\n        this._moveLayerBelow(layer, anchor);\n      }\n      \n    }\n  }\n  \n  /**\n   * Creates a new LinkedLayers object from a given linkage tuple.\n   * @param linkage - A tuple where the [primary, [link1, link2, ...]],\n   *   If the anchor is not included in the 2nd element, layers will be ordered below the anchor\n   */\n  private _newLink(linkage: [string, string[]]): LinkedLayers {\n    const [anchor, layersToLink] = linkage;\n    return {\n      primary: anchor,\n      linkedLayers: layersToLink,\n    };\n  }\n  \n  /**\n   * Set all linked layer groups, **replacing any existing linkages.**   \n   * Triggers immediate reordering to apply the new linkages \n   * @example setLinkedLayers([{ primary: 'roads', linkedLayers: ['borders', 'roads', 'labels'] }])\n   * To simply add alink use `linkLayers(linkage: [primary, [link1, link2, ...]])\n   */\n  setLinkedLayers(linkedLayers: LinkedLayers[]) {\n    this._linked = linkedLayers;\n    this._maintainOrder();\n  }\n  \n  /**\n   * Add a group of layers that should move together.\n   * Layers not present on the map are automatically skipped during reordering.\n   * Triggers immediate reordering.\n   */\n  linkLayers(linkage: [string, string[]]) {\n    const [anchor, layersToLink] = linkage;\n    const link: LinkedLayers = {\n      primary: anchor,\n      linkedLayers: layersToLink,\n    };\n    \n    this._linked.push(link);\n    this._maintainOrder();\n  }\n  \n  /** \n   * Oder layers takes the curernt desired layer order and moves layers to match this\n   * After sorting them, it then moves any linked-layers into position\n   */\n  private _orderLayers() {\n    if (this._keepAtTop) {\n      // moves top-most managed available layer to the top\n      this.startAtTop(); \n    }\n    \n    for (let i = this._desiredLayerOrder.length - 1; i > 0; i--) {\n      const bottomLayer = this._desiredLayerOrder[i-1];\n      const topLayer = this._desiredLayerOrder[i];\n      this.safeMoveLayerBelow(bottomLayer, topLayer);\n    }\n    \n    this._applyLinkedLayers();\n    \n    this.dispatchEvent('layer-order-changed');\n  }\n  \n  private _maintainOrder() {\n    const check = this._checkLayerChanges();\n    if (!checkArrayEquality(this.availableDesiredOrder, this.currentlyManagedLayerOrder) || check.changed) {\n      this._orderLayers();\n    }\n  }\n  \n  private _watchForChanges() {\n    const onStyleData = () => this._maintainOrder();\n    this._map.on('styledata', onStyleData);\n    this._eventHandlers.push(['styledata', onStyleData]);\n  }\n  \n  /**\n   * Clean up event listeners and remove this controller.\n   * Safe to call multiple times. Call before discarding the instance.\n   */\n  destroy() {\n    this.cleanup();\n    \n    this._eventHandlers.forEach(([event, handler]) => {\n      this._map.off(event, handler);\n    });\n    this._eventHandlers = [];\n  }\n  \n  /** \n   * Move a layer to a new index within the desired layer order\n   * Does nothing if the layer name given is not in the desired layers\n   */\n  private _moveLayer(layer: string, newIndex: number) {\n    const currentOrder = this._desiredLayerOrder;\n    const currentLayerIndex = currentOrder.indexOf(layer);\n    \n    // if it's not there, ignore it\n    if (currentLayerIndex === -1) {\n      console.error(`Layer ${layer} not found in current managed layers`);\n      return;\n    }\n    \n    const newLayerOrder = arrayMove(this._desiredLayerOrder, currentLayerIndex, newIndex);\n    this._desiredLayerOrder = newLayerOrder;\n    \n    this._maintainOrder();\n  }\n  \n  /**\n   * Move a layer by its current index to a new index position.\n   * Indices must be within bounds of currently available managed layers (those in the desired layer order AND are dispalyed on the map).\n   * @throws {Error} If fromIndex or toIndex are out of bounds\n   */\n  private _moveActualLayerByIndex(fromIndex: number, toIndex: number, maintainOrder = true) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    if (fromIndex < 0 || fromIndex >= currentOrder.length) {\n      throw new Error(`fromIndex out of bounds. Got ${fromIndex} for ${currentOrder.length} available layers ${currentOrder}`);\n    }\n    if (toIndex < 0 || toIndex >= currentOrder.length) {\n      throw new Error(`toIndex out of bounds. Got ${toIndex} for ${currentOrder.length} available layers ${currentOrder}`);\n    }\n    \n    const layer = currentOrder[fromIndex];\n    this._moveActualLayer(layer, toIndex, maintainOrder);\n  }\n  \n  /**\n   * Move a layer by its name to a new index position in the currently visible managed layers (those in the desired layer order AND are dispalyed on the map).\n   * The newIndex refers to positions in currentlyManagedLayerOrder (only layers on the map).\n   * @throws {Error} If newIndex is out of bounds for currentlyManagedLayerOrder\n   * @returns Early if `layer` is not found in `currentlyManagedLayerOrder` (logs error)\n   */\n  private _moveActualLayer(layer: string, newIndex: number, maintainOrder = true) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    const currentLayerIndex = currentOrder.indexOf(layer);\n    \n    // if it's not there, ignore it\n    if (currentLayerIndex === -1) {\n      console.error(`Layer ${layer} not found in current managed layers`);\n      return;\n    }\n    \n    const layerAtNewIndex = currentOrder[newIndex];\n    if (!layerAtNewIndex) {\n      throw new Error(`Must provide a valid new index correpsonding to the available layers. Got ${newIndex} for ${currentOrder.length} available layers ${currentOrder}`);\n    }\n    \n    // get layerAtNewIndex's index in the full layer order\n    const oldLayerOrderIndex = this._desiredLayerOrder.indexOf(layer);\n    const newLayerOrderIndex = this._desiredLayerOrder.indexOf(layerAtNewIndex);\n    \n    const newLayerOrder = arrayMove(this._desiredLayerOrder, oldLayerOrderIndex, newLayerOrderIndex);\n    this._desiredLayerOrder = newLayerOrder;\n    \n    if (maintainOrder) {\n      this._maintainOrder();\n    }\n  }\n  \n  /**\n   * Move a layer to the topmost position in the managed order.\n   * Does nothing if the layer is not part of the managed layers.\n   */\n  moveToFront(layer: string) {\n    const topIndex = this._desiredLayerOrder.length - 1;\n    this._moveLayer(layer, topIndex);\n  }\n  \n  /**\n   * Move a layer to the bottommost position in the managed order.\n   * Does nothing if the layer is not part of the managed layers.\n   */\n  moveToBack(layer: string) {\n    this._moveLayer(layer, 0);\n  }\n  \n  /**\n   * Move a layer up one position in the order.\n   * Does nothing if the layer is not managed or already at the top.\n   */\n  moveUp(layer: string) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    const index = currentOrder.indexOf(layer);\n    if (index === -1 || index === currentOrder.length - 1) return;\n    this._moveActualLayer(layer, index + 1);\n  }\n  \n  /**\n   * Move a layer down one position in the order.\n   * Does nothing if the layer is not managed or already at the bottom.\n   */\n  moveDown(layer: string) {\n    const currentOrder = this.currentlyManagedLayerOrder;\n    const index = currentOrder.indexOf(layer);\n    if (index <= 0) return;\n    this._moveActualLayer(layer, index - 1);\n  }\n  \n  \n  /**\n   * Replace the entire desired layer order.\n   * WARNING: Completely replaces the order, losing track of hidden layer positions.\n   * Use setManagedOrder() instead when layers may be dynamically added/removed.\n   */\n  setOrder(order: string[]) {\n    this._desiredLayerOrder = [...order];\n    if (this._initialized) this._maintainOrder();\n  }\n  \n  /**\n   * Update the \"keep at top\" behavior.\n   * When enabled, the top-most managed layer is moved to the very top of the map's layer stack, \n   * and the rest of the layer's we are managing will follow\n   * Triggers immediate reordering.\n   */\n  setKeepAtTop(keepAtTop: boolean) {\n    this._keepAtTop = keepAtTop;\n    if (this._initialized) this._maintainOrder();\n  }\n  \n  /**\n   * Check if a layer currently exists on the map.\n   * Returns false if the layer was removed or never added.\n   */\n  hasLayer(layer: string) {\n    return this._map.getLayer(layer) !== undefined;\n  }\n  \n  /**\n   * Get the current managed layers in reverse order (top to bottom).\n   * Useful for iterating from top-most to bottom-most layer.\n   * Returns a copy; modifications won't affect the controller.\n   */\n  get reverseLayerOrder() {\n    // create copy to avoid mutating the original\n    return this.currentlyManagedLayerOrder.slice().reverse();\n  }\n  \n  // easy accessor for the top layer\n  startAtTop() {\n    const currentOrder = this._map.getLayersOrder();\n    for (const layer of this.reverseLayerOrder) {\n      if (currentOrder.includes(layer)) {\n        this._map.moveLayer(layer);\n        return;\n      }\n    }\n    console.error('None of layers you wanted sorted was found');\n  }\n  \n\n  \n  \n  /**\n   * Safely moves a layer below another specified layer in the map's layer stack.\n   *\n   * This method checks if the layer to move exists. If the target layer to move below does not exist,\n   * and `layerItShouldBeBelow` is \n   */\n  safeMoveLayerBelow(layerToMove: string, layerItShouldBeBelow: string): boolean {\n    const hasLayer = this.hasLayer(layerToMove);\n    if (!hasLayer) {\n      return false;\n    }\n    \n    if (!this.hasLayer(layerItShouldBeBelow)) {\n      // if it doesn't have this layer, try the next one above it\n      const nextIndex = this._desiredLayerOrder.indexOf(layerItShouldBeBelow) + 1;\n      // if layerItShouldBeBelow is not in _desiredLayerOrder, indexOf returns -1, so gaurd -1 + 1 = 0\n      if (nextIndex > 0 && nextIndex < this._desiredLayerOrder.length) {\n        return this.safeMoveLayerBelow(layerToMove, this._desiredLayerOrder[nextIndex]);\n      }\n      return false;\n    }\n    this._map.moveLayer(layerToMove, layerItShouldBeBelow);\n    return true;\n  }\n  \n  safeMoveLayerAbove(layerToMove: string, layerItShouldBeAbove: string): boolean {\n    const hasLayer = this.hasLayer(layerToMove);\n    if (!hasLayer) {\n      // console.warn(`Layer ${layer} not found`);\n      return false;\n    }\n\n    if (!this.hasLayer(layerItShouldBeAbove)) {\n      // if it doesn't have this layer, try the next one below it\n      const nextIndex = this._desiredLayerOrder.indexOf(layerToMove) - 1;\n      if (nextIndex >= 0) {\n        return this.safeMoveLayerAbove(layerToMove, this._desiredLayerOrder[nextIndex]);\n      }\n      return false;\n    }\n    // to move above a layer, move that layer below this one\n    this._map.moveLayer(layerItShouldBeAbove, layerToMove);\n    return true;\n  }\n\n  /**\n   * Update the order of currently visible layers while preserving positions of hidden layers.\n   * RECOMMENDED method for reordering when layers may be dynamically added/removed.\n   * Early returns if the new managed order is unchanged from current.\n   * Merges the new order with existing order, maintaining positions of absent layers.\n   */\n  setManagedOrder(newManagedOrder: string[]) {\n    // if (!isSubset(newManagedOrder, this.desiredLayerOrder)) {\n    //   throw new Error('New managed order must be a subset of the original managed layers');\n    // }\n    \n    if (checkArrayEquality(newManagedOrder, this.availableDesiredOrder)) return;\n    \n    // merge the order. when a layer comes back, i don't want\n    // to be surprised that it is suddenly on the bottom of the\n    // stack\n    \n    // hashmap!!\n    const managedLayerMap = new Map<string, number>();\n    newManagedOrder.forEach((layer, index) => {\n      managedLayerMap.set(layer, index);\n    });\n    \n    const newDesiredOrder: string[] = [];\n    let managedIndex = 0;\n    \n    for (const layer of this._desiredLayerOrder) {\n      if (managedLayerMap.has(layer)) {\n        newDesiredOrder.push(newManagedOrder[managedIndex]);\n        managedIndex++;\n      } else {\n        newDesiredOrder.push(layer);\n      }\n    }\n    \n    this._desiredLayerOrder = newDesiredOrder;\n    this._maintainOrder();\n    \n  }\n    \n  \n}\n  \ninterface UseMaplibreLayerOrderControlReturn {\n  desiredOrder: Ref<string[]>;\n  currentOrder: Ref<string[]>;\n  controller: MaplibreLayerOrderControl | null;\n  \n}\n\nexport function useMaplibreLayerOrderControl(\n  map: Ref<M.Map | null>,\n  initialOrder: string[] = [],\n  moveToTop: boolean = true,\n  linkedLayers: [string, string[]][] = [],\n): UseMaplibreLayerOrderControlReturn {\n  \n\n  const desiredOrder = ref<string[]>(initialOrder);\n  const currentOrder = ref<string[]>([]);\n  let controller: MaplibreLayerOrderControl | null = null;\n  let initialized = false;\n  \n  // Initialize the controller when the map is ready\n  function init(mapValue: M.Map | null) {\n    if (mapValue && !controller && !initialized) {\n      controller = new MaplibreLayerOrderControl(mapValue, desiredOrder.value, {keepAtTop: moveToTop, linkedLayers: linkedLayers});\n      controller.on('layer-order-changed', () => {\n        if (controller && !checkArrayEquality(currentOrder.value, controller.currentlyManagedLayerOrder ?? [])) {\n          currentOrder.value = controller?.currentlyManagedLayerOrder ?? [];\n        }\n      });\n      currentOrder.value = controller.currentlyManagedLayerOrder;\n      initialized = true;\n    }\n  }\n  init(map.value);\n  watch(map, (newValue) => {\n    if (newValue && !controller && !initialized) {\n      console.log('Map changed, re-initializing controller', newValue);\n      init(newValue);\n    } else if (!newValue && controller) {\n      console.log('Map is now null, destroying controller');\n      controller.destroy();\n      controller = null;\n      initialized = false;\n      currentOrder.value = [];\n    }\n  });\n  \n  // watch(desiredOrder, (newOrder) => {\n  //   console.log('Desired order changed to', newOrder);\n  // }, {deep: true});\n  \n  // watch(currentOrder, (newOrder) => {\n  //   console.log('Current order changed to', newOrder);\n  // }, {deep: true});\n  \n  \n  onBeforeUnmount(() => {\n    controller?.destroy();\n  });\n  \n  \n  return {\n    desiredOrder,\n    currentOrder,\n    controller,\n  };\n  \n  \n  \n  \n}\n","export function capitalizeWords(text: string): string {\n  return text.replace(/\\b(\\w)/g, function(match) {\n    return match.toUpperCase();\n  });\n}\n","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { renderSlot as _renderSlot, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport {  ref, watch } from 'vue';\n\n\n\ninterface Props {\n  item: string\n  label?: string\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'NarrowExpansionPanel',\n  props: /*@__PURE__*/_mergeModels({\n    item: {},\n    label: {}\n  }, {\n    \"isOpen\": { type: Boolean, ...{ required: false, default: true } },\n    \"isOpenModifiers\": {},\n  }),\n  emits: [\"update:isOpen\"],\n  setup(__props: any) {\n\nconst _props = __props;\nconst isOpen = _useModel<boolean>(__props, 'isOpen');\nconst panel = ref(isOpen.value ? 0 : null);\nwatch(panel, (newVal) => {\n  isOpen.value = newVal === 0;\n});\n\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_expansion_panel_title = _resolveComponent(\"v-expansion-panel-title\")!\n  const _component_v_expansion_panel_text = _resolveComponent(\"v-expansion-panel-text\")!\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\")!\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\")!\n\n  return (_openBlock(), _createBlock(_component_v_expansion_panels, {\n    variant: \"default\",\n    modelValue: panel.value,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((panel).value = $event))\n  }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_expansion_panel, {\n        class: \"lcil\",\n        static: \"\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_expansion_panel_title, {\n            class: \"lcil\",\n            tabindex: \"0\",\n            height: \"1.5em\",\n            \"min-height\": \"1.5em\"\n          }, {\n            default: _withCtx(() => [\n              _renderSlot(_ctx.$slots, \"summary\", {}, () => [\n                _createTextVNode(_toDisplayString(__props.label ?? 'Show Legend'), 1)\n              ])\n            ]),\n            _: 3\n          }),\n          _createVNode(_component_v_expansion_panel_text, { class: \"lcil-legend-content\" }, {\n            default: _withCtx(() => [\n              _renderSlot(_ctx.$slots, \"default\")\n            ]),\n            _: 3\n          })\n        ]),\n        _: 3\n      })\n    ]),\n    _: 3\n  }, 8, [\"modelValue\"]))\n}\n}\n\n})","<template>\n  <v-expansion-panels variant=\"default\" v-model=\"panel\">\n    <v-expansion-panel class=\"lcil\" static>\n      <v-expansion-panel-title \n        class=\"lcil\" \n        tabindex=\"0\"\n        height=\"1.5em\"\n        min-height=\"1.5em\"\n        >\n        <slot name=\"summary\">{{ label ?? 'Show Legend' }}</slot>\n      </v-expansion-panel-title>\n      <v-expansion-panel-text class=\"lcil-legend-content\">\n        <slot></slot>\n      </v-expansion-panel-text>\n    </v-expansion-panel>\n  </v-expansion-panels>\n</template>\n\n<script setup lang=\"ts\">\nimport {  ref, watch } from 'vue';\n\n\n\ninterface Props {\n  item: string\n  label?: string\n}\n\nconst _props = defineProps<Props>();\nconst isOpen = defineModel<boolean>('isOpen', { required: false, default: true });\nconst panel = ref(isOpen.value ? 0 : null);\nwatch(panel, (newVal) => {\n  isOpen.value = newVal === 0;\n});\n\n\n\n\n</script>\n\n<style>\n.lcil-legend-content > .v-expansion-panel-text__wrapper {\n  padding-inline: 5px;\n}\n\n</style>","import script from \"./NarrowExpansionPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NarrowExpansionPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NarrowExpansionPanel.vue?vue&type=style&index=0&id=632a556e&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, renderSlot as _renderSlot, mergeProps as _mergeProps, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"tempods-legend-container\" }\nconst _hoisted_2 = { class: \"short-legend\" }\nconst _hoisted_3 = { class: \"legend-text\" }\nconst _hoisted_4 = { class: \"long-legend\" }\nconst _hoisted_5 = { class: \"legend-text\" }\nconst _hoisted_6 = { class: \"legend-text-detail\" }\n\ninterface Entry {\n  name: string;\n  label: string;\n  color: string;\n  text: string;\n}\ninterface Props {\n  data: Entry[];\n  infoText: string;\n  citation: string;\n}\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'LegendBase',\n  props: {\n    data: {},\n    infoText: {},\n    citation: {}\n  },\n  setup(__props: any) {\n\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_info_button = _resolveComponent(\"info-button\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.data, (item) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: _normalizeClass(`legend-label ll-${item.name}`),\n          style: _normalizeStyle({'--label-color': item.color}),\n          key: item.name\n        }, [\n          _createElementVNode(\"dt\", _hoisted_3, _toDisplayString(item.label), 1)\n        ], 6))\n      }), 128))\n    ]),\n    _createVNode(_component_info_button, {\n      \"max-width\": \"80%\",\n      \"max-height\": \"400px\"\n    }, {\n      activator: _withCtx((props) => [\n        _renderSlot(_ctx.$slots, \"infoButton\", { props: props }, () => [\n          _createElementVNode(\"a\", _mergeProps({\n            class: \"legend-more-details\",\n            href: \"#\",\n            role: \"button\"\n          }, props), _toDisplayString(__props.infoText), 17)\n        ])\n      ]),\n      default: _withCtx(() => [\n        _createElementVNode(\"div\", _hoisted_4, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.data, (item) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n              class: _normalizeClass(`legend-label ll-${item.name}`),\n              style: _normalizeStyle({'--label-color': item.color}),\n              key: item.name\n            }, [\n              _createElementVNode(\"dt\", _hoisted_5, _toDisplayString(item.label), 1),\n              _createElementVNode(\"dd\", _hoisted_6, _toDisplayString(item.text), 1)\n            ], 6))\n          }), 128))\n        ]),\n        _renderSlot(_ctx.$slots, \"citation\", {}, () => [\n          _createElementVNode(\"cite\", null, _toDisplayString(__props.citation), 1)\n        ])\n      ]),\n      _: 3\n    })\n  ]))\n}\n}\n\n})","<script setup lang=\"ts\">\n\ninterface Entry {\n  name: string;\n  label: string;\n  color: string;\n  text: string;\n}\ninterface Props {\n  data: Entry[];\n  infoText: string;\n  citation: string;\n}\nconst { data, infoText, citation } = defineProps<Props>();\n\n</script>\n\n<template>\n<div class=\"tempods-legend-container\">\n  \n  <!-- Basic Legend -->\n  <div class=\"short-legend\">\n    <div \n      v-for=\"item of data\" \n      :class=\"`legend-label ll-${item.name}`\" \n      :style=\"{'--label-color': item.color}\" \n      :key=\"item.name\"\n      >\n      <dt class=\"legend-text\">{{item.label}}</dt>\n    </div>\n  </div>\n\n  <!-- More Info -- full Legend w/ explanations -->\n  <info-button max-width=\"80%\" max-height=\"400px\">\n    <template #activator=\"props\">\n      <slot name=\"infoButton\" :props=\"props\">\n      <a\n        class=\"legend-more-details\"\n        href=\"#\"\n        role=\"button\"\n        v-bind=\"props\"\n      >\n        {{ infoText }}\n      </a>\n    </slot>\n    </template>\n    <!-- add this class so that we can still use nesting :) -->\n\n      <div class=\"long-legend\">\n        <div v-for=\"item of data\" :class=\"`legend-label ll-${item.name}`\" :style=\"{'--label-color': item.color}\" :key=\"item.name\">\n          <dt class=\"legend-text\">{{item.label}}</dt>\n          <dd class=\"legend-text-detail\"> {{ item.text }} </dd>\n        </div>\n      </div>\n\n    <slot name=\"citation\">\n      <cite> {{ citation }} </cite>\n    </slot>\n  </info-button>\n  \n</div>\n</template>\n\n<style scoped>\n\n  .legend-label {\n    position: relative;\n    margin: 0.25em;\n    --space: 5px;\n    padding: var(--space);\n    padding-left: calc(1.5em + var(--space));\n  }\n\n  .legend-label::before {\n    content: '';\n    display: inline;\n    width: 1em;\n    height: 1em;\n    position: absolute;\n    left: var(--space);\n    top: 50%;\n    transform: translateY(-50%);\n    box-shadow: 0px 0px 0px 1px white, 0px 0px 0px 3px black;\n    color: var(--label-color);\n    background-color: currentColor;\n  }\n  \n  .legend-text {\n    font-weight: normal;\n  }\n  .legend-text-detail {\n    display: block;\n    padding: 0;\n    margin: 0;\n  }\n  \n  /* short legend */\n  .short-legend {\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n  }\n\n  /* long legend */\n  .long-legend {\n    display: block;\n    padding-left: 0.5em;\n    margin: 1em;\n  }\n\n  .long-legend > .legend-label {\n    border-bottom: 1px solid white;\n    display: grid;\n    grid-template-columns: minmax(auto, 100px) 1fr;\n    column-gap: 1em;\n    align-items: center;\n    margin-bottom: 1.5em;\n  }\n\n  \n  cite {\n    font-size: 0.7em;\n    color: gray;\n  }\n  a.legend-more-details {\n    font-size: 0.8em;\n    cursor: pointer;\n    text-decoration: underline;\n    color:rgb(175, 175, 175);\n  }\n\n</style>","import script from \"./LegendBase.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LegendBase.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LegendBase.vue?vue&type=style&index=0&id=2c8c77c6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2c8c77c6\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport LegendBase from \"@/components/LegendBase.vue\";\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'LandUseLegend',\n  setup(__props) {\n\nconst data = [\n  { name: \"built\",\n    label: \"Built Area\",\n    color: \"#ed242b\",\n    text: \"Human made structures; major road and rail networks; large homogenous impervious surfaces including parking structures, office buildings and residential housing; examples: houses, dense villages / towns / cities, paved roads, asphalt.\"\n  },\n  \n  { name: \"water\",\n    label: \"Water\",\n    color: \"#1b5bab\",\n    text: \"Areas where water was predominantly present throughout the year; may not cover areas with sporadic or ephemeral water; contains little to no sparse vegetation, no rock outcrop nor built up features like docks; examples: rivers, ponds, lakes, oceans, flooded salt plains.\",\n  },\n  \n  { name: \"trees\",\n    label: \"Trees\",\n    color: \"#358221\",\n    text: \"Any significant clustering of tall (~15 feet or higher) dense vegetation, typically with a closed or dense canopy; examples: wooded vegetation, clusters of dense tall vegetation within savannas, plantations, swamp or mangroves (dense/tall vegetation with ephemeral water or canopy too thick to detect water underneath).\",\n  },\n  \n  { name: \"crops\",\n    label: \"Crops\",\n    color: \"#fcdb5c\",\n    text: \"Human planted/plotted cereals, grasses, and crops not at tree height; examples: corn, wheat, soy, fallow plots of structured land.\",\n  },\n  \n  { name: \"rangeland\",\n    label: \"Rangeland\",\n    color: \"#efcfa8\",\n    text: \"Open areas covered in homogenous grasses with little to no taller vegetation; wild cereals and grasses with no obvious human plotting (i.e., not a plotted field); examples: natural meadows and fields with sparse to no tree cover, open savanna with few to no trees, parks/golf courses/lawns, pastures. Mix of small clusters of plants or single plants dispersed on a landscape that shows exposed soil or rock; scrub-filled clearings within dense forests that are clearly not taller than trees; examples: moderate to sparse cover of bushes, shrubs and tufts of grass, savannas with very sparse grasses, trees or other plants.\",\n  },\n  \n  { name: \"flooded\",\n    label: \"Flooded Vegetation\",\n    color: \"#87d19e\",\n    text: \"Areas of any type of vegetation with obvious intermixing of water throughout a majority of the year; seasonally flooded area that is a mix of grass/shrub/trees/bare ground; examples: flooded mangroves, emergent vegetation, rice paddies and other heavily irrigated and inundated agriculture.\",\n  },\n\n  { name: \"bare\",\n    label: \"Bare Ground\",\n    color: \"#ede9e4\",\n    text: \"Areas of rock or soil with very sparse to no vegetation for the entire year; large areas of sand and deserts with no to little vegetation; examples: exposed rock or soil, desert and sand dunes, dry salt flats/pans, dried lake beds, mines.\",\n  },\n  \n  { name: \"snow\",\n    label: \"Snow/Ice\",\n    color: \"#f2faff\",\n    text: \"Large homogenous areas of permanent snow or ice, typically only in mountain areas or highest latitudes; examples: glaciers, permanent snowpack, snow fields.\",\n  },\n  \n  { name: \"clouds\",\n    label: \"Clouds\",\n    color: \"#c8c8c8\",\n    text: \"No land cover information due to persistent cloud cover.\",\n  }\n];\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(LegendBase, {\n    class: \"land-use-legend\",\n    data: data,\n    \"info-text\": \"Learn more about Land Use colors.\",\n    citation: \"Source: ESRI Living Atlas: Sentinel-2 10m Land Use/Land Cover Time Series by Impact Observatory\"\n  }))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport LegendBase from \"@/components/LegendBase.vue\";\nconst data = [\n  { name: \"built\",\n    label: \"Built Area\",\n    color: \"#ed242b\",\n    text: \"Human made structures; major road and rail networks; large homogenous impervious surfaces including parking structures, office buildings and residential housing; examples: houses, dense villages / towns / cities, paved roads, asphalt.\"\n  },\n  \n  { name: \"water\",\n    label: \"Water\",\n    color: \"#1b5bab\",\n    text: \"Areas where water was predominantly present throughout the year; may not cover areas with sporadic or ephemeral water; contains little to no sparse vegetation, no rock outcrop nor built up features like docks; examples: rivers, ponds, lakes, oceans, flooded salt plains.\",\n  },\n  \n  { name: \"trees\",\n    label: \"Trees\",\n    color: \"#358221\",\n    text: \"Any significant clustering of tall (~15 feet or higher) dense vegetation, typically with a closed or dense canopy; examples: wooded vegetation, clusters of dense tall vegetation within savannas, plantations, swamp or mangroves (dense/tall vegetation with ephemeral water or canopy too thick to detect water underneath).\",\n  },\n  \n  { name: \"crops\",\n    label: \"Crops\",\n    color: \"#fcdb5c\",\n    text: \"Human planted/plotted cereals, grasses, and crops not at tree height; examples: corn, wheat, soy, fallow plots of structured land.\",\n  },\n  \n  { name: \"rangeland\",\n    label: \"Rangeland\",\n    color: \"#efcfa8\",\n    text: \"Open areas covered in homogenous grasses with little to no taller vegetation; wild cereals and grasses with no obvious human plotting (i.e., not a plotted field); examples: natural meadows and fields with sparse to no tree cover, open savanna with few to no trees, parks/golf courses/lawns, pastures. Mix of small clusters of plants or single plants dispersed on a landscape that shows exposed soil or rock; scrub-filled clearings within dense forests that are clearly not taller than trees; examples: moderate to sparse cover of bushes, shrubs and tufts of grass, savannas with very sparse grasses, trees or other plants.\",\n  },\n  \n  { name: \"flooded\",\n    label: \"Flooded Vegetation\",\n    color: \"#87d19e\",\n    text: \"Areas of any type of vegetation with obvious intermixing of water throughout a majority of the year; seasonally flooded area that is a mix of grass/shrub/trees/bare ground; examples: flooded mangroves, emergent vegetation, rice paddies and other heavily irrigated and inundated agriculture.\",\n  },\n\n  { name: \"bare\",\n    label: \"Bare Ground\",\n    color: \"#ede9e4\",\n    text: \"Areas of rock or soil with very sparse to no vegetation for the entire year; large areas of sand and deserts with no to little vegetation; examples: exposed rock or soil, desert and sand dunes, dry salt flats/pans, dried lake beds, mines.\",\n  },\n  \n  { name: \"snow\",\n    label: \"Snow/Ice\",\n    color: \"#f2faff\",\n    text: \"Large homogenous areas of permanent snow or ice, typically only in mountain areas or highest latitudes; examples: glaciers, permanent snowpack, snow fields.\",\n  },\n  \n  { name: \"clouds\",\n    label: \"Clouds\",\n    color: \"#c8c8c8\",\n    text: \"No land cover information due to persistent cloud cover.\",\n  }\n];\n\n</script>\n\n<template>\n  <LegendBase\n    class=\"land-use-legend\"\n    :data=\"data\"\n    info-text=\"Learn more about Land Use colors.\"\n    citation=\"Source: ESRI Living Atlas: Sentinel-2 10m Land Use/Land Cover Time Series by Impact Observatory\"\n  />\n\n</template>\n\n<style scoped>\n\n\n.long-legend > .legend-label {\n  grid-template-columns: minmax(auto, 100px) 1fr;\n}\n\n</style>","import script from \"./LandUseLegend.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LandUseLegend.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LandUseLegend.vue?vue&type=style&index=0&id=acdaa76a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-acdaa76a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport LegendBase from \"@/components/LegendBase.vue\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'AQILegend',\n  setup(__props) {\n\nconst data = [\n  {\n    name: \"good\",\n    label: \"Good (050)\",\n    color: \"#00e400\",\n    text: \"Air quality is satisfactory, and air pollution poses little or no risk.\",\n  },\n  {\n    name: \"moderate\",\n    label: \"Moderate (51100)\",\n    color: \"#ffff00\",\n    text: \"Air quality is acceptable. However, there may be a risk for some people, particularly those who are unusually sensitive to air pollution.\",\n  },\n  {\n    name: \"usg\",\n    label: \"Unhealthy for Sensitive Groups (101150)\",\n    color: \"#ff7e00\",\n    text: \"Members of sensitive groups may experience health effects. The general public is less likely to be affected.\",\n  },\n  {\n    name: \"unhealthy\",\n    label: \"Unhealthy (151200)\",\n    color: \"#ff0000\",\n    text: \"Some members of the general public may experience health effects; members of sensitive groups may experience more serious health effects.\",\n  },\n  {\n    name: \"very-unhealthy\",\n    label: \"Very Unhealthy (201300)\",\n    color: \"#8f3f97\",\n    text: \"Health alert: The risk of health effects is increased for everyone.\",\n  },\n  {\n    name: \"hazardous\",\n    label: \"Hazardous (301+)\",\n    color: \"#7e0023\",\n    text: \"Health warning of emergency conditions: everyone is more likely to be affected.\",\n  },\n];\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(LegendBase, {\n    class: \"aqi-legend\",\n    data: data,\n    \"info-text\": \"Learn more about Air Quality colors.\",\n    citation: \"Source: U.S. EPA - AirNow\"\n  }))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport LegendBase from \"@/components/LegendBase.vue\";\n\nconst data = [\n  {\n    name: \"good\",\n    label: \"Good (050)\",\n    color: \"#00e400\",\n    text: \"Air quality is satisfactory, and air pollution poses little or no risk.\",\n  },\n  {\n    name: \"moderate\",\n    label: \"Moderate (51100)\",\n    color: \"#ffff00\",\n    text: \"Air quality is acceptable. However, there may be a risk for some people, particularly those who are unusually sensitive to air pollution.\",\n  },\n  {\n    name: \"usg\",\n    label: \"Unhealthy for Sensitive Groups (101150)\",\n    color: \"#ff7e00\",\n    text: \"Members of sensitive groups may experience health effects. The general public is less likely to be affected.\",\n  },\n  {\n    name: \"unhealthy\",\n    label: \"Unhealthy (151200)\",\n    color: \"#ff0000\",\n    text: \"Some members of the general public may experience health effects; members of sensitive groups may experience more serious health effects.\",\n  },\n  {\n    name: \"very-unhealthy\",\n    label: \"Very Unhealthy (201300)\",\n    color: \"#8f3f97\",\n    text: \"Health alert: The risk of health effects is increased for everyone.\",\n  },\n  {\n    name: \"hazardous\",\n    label: \"Hazardous (301+)\",\n    color: \"#7e0023\",\n    text: \"Health warning of emergency conditions: everyone is more likely to be affected.\",\n  },\n];\n</script>\n\n<template>\n  <LegendBase\n    class=\"aqi-legend\"\n    :data=\"data\"\n    info-text=\"Learn more about Air Quality colors.\"\n    citation=\"Source: U.S. EPA - AirNow\"\n  />\n</template>\n\n<style>\n\n\n.long-legend > .legend-label {\n  grid-template-columns: minmax(auto, 200px) 1fr;\n}\n\n</style>\n","import script from \"./AQILegend.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AQILegend.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AQILegend.vue?vue&type=style&index=0&id=9bda3524&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"mini-legend\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"legend-text\"\n}\n\ninterface Entry {\n  name: string;\n  label: string;\n  color: string;\n  text: string;\n}\n\ninterface MiniOptions {\n  colorIndices: number[];\n  labelIndices: number[];\n}\n\ninterface Props {\n  data: Entry[];\n  subtitle?: string;\n  miniOptions?: MiniOptions;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MiniLegend',\n  props: {\n    data: {},\n    subtitle: {},\n    miniOptions: {}\n  },\n  setup(__props: any) {\n\n\n\n\nconst labelIndices = __props.miniOptions ? __props.miniOptions.labelIndices : [0, __props.data.length - 1];\nconst colorIndices = __props.miniOptions ? __props.miniOptions.colorIndices : labelIndices;\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(colorIndices), (value) => {\n      return (_openBlock(), _createElementBlock(\"div\", {\n        class: _normalizeClass(`legend-label ll-${__props.data[value].name}`),\n        style: _normalizeStyle({'--label-color': __props.data[value].color}),\n        key: __props.data[value].name\n      }, [\n        (_unref(labelIndices).includes(value))\n          ? (_openBlock(), _createElementBlock(\"dt\", _hoisted_2, _toDisplayString(__props.data[value].label), 1))\n          : _createCommentVNode(\"\", true)\n      ], 6))\n    }), 128)),\n    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { style: {\"flex-grow\":\"50\"} }, null, -1))\n  ]))\n}\n}\n\n})","<script setup lang=\"ts\">\n\ninterface Entry {\n  name: string;\n  label: string;\n  color: string;\n  text: string;\n}\n\ninterface MiniOptions {\n  colorIndices: number[];\n  labelIndices: number[];\n}\n\ninterface Props {\n  data: Entry[];\n  subtitle?: string;\n  miniOptions?: MiniOptions;\n}\n\nconst { data, miniOptions } = defineProps<Props>();\n\nconst labelIndices = miniOptions ? miniOptions.labelIndices : [0, data.length - 1];\nconst colorIndices = miniOptions ? miniOptions.colorIndices : labelIndices;\n\n</script>\n\n<template>\n  <div class=\"mini-legend\">\n    <div \n      :class=\"`legend-label ll-${data[value].name}`\" \n      v-for=\"(value) of colorIndices\" \n      :style=\"{'--label-color': data[value].color}\" \n      :key=\"data[value].name\"\n    >\n      <dt v-if=\"labelIndices.includes(value)\" class=\"legend-text\">\n        {{data[value].label}}\n      </dt>\n    </div>\n    <div style=\"flex-grow: 50;\"></div>\n  </div>\n</template>\n\n<style scoped>\n  .legend-label {\n    position: relative;\n    margin: 0.25em;\n    --space: 5px;\n    padding: var(--space);\n    padding-left: calc(1.5em + var(--space));\n  } \n\n  .legend-label::before {\n    content: '';\n    display: inline;\n    width: 1em;\n    height: 1em;\n    position: absolute;\n    left: var(--space);\n    top: 50%;\n    transform: translateY(-50%);\n    box-shadow: 0px 0px 0px 1px white, 0px 0px 0px 3px black;\n    color: var(--label-color);\n    background-color: currentColor;\n  }\n  \n  .legend-text {\n    font-weight: normal;\n  }\n  \n  /* mini-legend */\n  .mini-legend {\n    display: flex;\n    flex-direction: row;\n    align-items: stretch;\n    width: 100%;\n    gap: 1em;\n    justify-content: space-around;\n    flex-wrap: wrap;\n  }\n  \n  .mini-legend .legend-label {\n    margin: 0;\n    height: 3em;\n  }\n  \n  .mini-legend .legend-label::before {\n    display: block;\n    top: 0;\n    left: 50%;\n    transform: translateX(-50%);\n    box-shadow: 0px 0px 0px 1px white, 0px 0px 0px 3px black;\n  }\n  \n  .mini-legend .legend-label .legend-text {\n    font-size: 0.8em;\n    position: absolute;\n    top: 1.5em;\n    left: 50%;\n    transform: translateX(-50%);\n    /* width: 100%; */\n    width: max-content;\n    text-align: center;\n  }\n</style>\n","import script from \"./MiniLegend.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MiniLegend.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MiniLegend.vue?vue&type=style&index=0&id=feceb508&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-feceb508\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"pop-dens-legend-container\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"pop-dens-mini\"\n}\n\nimport LegendBase from \"@/components/LegendBase.vue\";\nimport MiniLegend from \"./MiniLegend.vue\";\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'PopDensLegend',\n  props: {\n    mini: { type: Boolean }\n  },\n  setup(__props: any) {\n\n\nconst colors = [\n  \"rgb(253,239,154)\",\n  \"rgb(169,216,92)\",\n  \"rgb(90,185,120)\",\n  \"rgb(60,147,135)\",\n  \"rgb(32,110,139)\",\n  \"rgb(19,67,155)\",\n  \"rgb(42,24,108)\"\n];\nconst data = [\n  { name: \"1\",\n    label: \"<1\",\n    color: colors[0],\n    text: \"Less than 1 person per square kilometer.\"\n  },\n  \n  { name: \"5\",\n    label: \"1 - 5\",\n    color: colors[1],\n    text: \"1 to 5 people per square kilometer.\",\n  },\n  \n  { name: \"25\",\n    label: \"5 - 25\",\n    color: colors[2],\n    text: \"5 to 25 people per square kilometer.\",\n  },\n  \n  { name: \"250\",\n    label: \"25 - 250\",\n    color: colors[3],\n    text: \"25 to 250 people per square kilometer.\",\n  },\n  \n  { name: \"1000\",\n    label: \"1k - 5k\",\n    color: colors[4],\n    text: \"250 to 1,000 people per square kilometer.\",\n  },\n  \n  { name: \"5k - 50k\",\n    label: \"5k - 50k\",\n    color: colors[5],\n    text: \"5,000 to 50,000 people per square kilometer.\",\n  },\n\n  { name: \"50000\",\n    label: \">50k\",\n    color: colors[6],\n    text: \"More than 50,000 people per square kilometer.\",\n  },\n];\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (__props.mini)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createVNode(MiniLegend, {\n            data: data,\n            miniOptions: { colorIndices: [0, 1, 2, 3, 4, 5, 6], labelIndices: [0, 1, 2, 3, 4, 5, 6] }\n          }),\n          _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"subtitle\" }, \"Population Density (people/km)\", -1))\n        ]))\n      : (_openBlock(), _createBlock(LegendBase, {\n          key: 1,\n          class: \"pop-dens-legend\",\n          data: data,\n          \"info-text\": \"Learn more about Population density colors.\",\n          citation: \"Source: NASA SEDAC: Gridded Population of the World, Version 4 (GPWv4): Population Density\"\n        }))\n  ]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport LegendBase from \"@/components/LegendBase.vue\";\nimport MiniLegend from \"./MiniLegend.vue\";\nconst { mini } = defineProps<{ mini?: boolean }>();\nconst colors = [\n  \"rgb(253,239,154)\",\n  \"rgb(169,216,92)\",\n  \"rgb(90,185,120)\",\n  \"rgb(60,147,135)\",\n  \"rgb(32,110,139)\",\n  \"rgb(19,67,155)\",\n  \"rgb(42,24,108)\"\n];\nconst data = [\n  { name: \"1\",\n    label: \"<1\",\n    color: colors[0],\n    text: \"Less than 1 person per square kilometer.\"\n  },\n  \n  { name: \"5\",\n    label: \"1 - 5\",\n    color: colors[1],\n    text: \"1 to 5 people per square kilometer.\",\n  },\n  \n  { name: \"25\",\n    label: \"5 - 25\",\n    color: colors[2],\n    text: \"5 to 25 people per square kilometer.\",\n  },\n  \n  { name: \"250\",\n    label: \"25 - 250\",\n    color: colors[3],\n    text: \"25 to 250 people per square kilometer.\",\n  },\n  \n  { name: \"1000\",\n    label: \"1k - 5k\",\n    color: colors[4],\n    text: \"250 to 1,000 people per square kilometer.\",\n  },\n  \n  { name: \"5k - 50k\",\n    label: \"5k - 50k\",\n    color: colors[5],\n    text: \"5,000 to 50,000 people per square kilometer.\",\n  },\n\n  { name: \"50000\",\n    label: \">50k\",\n    color: colors[6],\n    text: \"More than 50,000 people per square kilometer.\",\n  },\n];\n\n</script>\n\n<template>\n  <div class=\"pop-dens-legend-container\">\n    <div v-if=\"mini\" class=\"pop-dens-mini\">\n      <MiniLegend\n        :data=\"data\"\n        :miniOptions=\"{ colorIndices: [0, 1, 2, 3, 4, 5, 6], labelIndices: [0, 1, 2, 3, 4, 5, 6] }\"\n      />\n      <div class=\"subtitle\">Population Density (people/km)</div>\n      \n    </div>\n  \n  <LegendBase\n    v-else\n    class=\"pop-dens-legend\"\n    :data=\"data\"\n    info-text=\"Learn more about Population density colors.\"\n    citation=\"Source: NASA SEDAC: Gridded Population of the World, Version 4 (GPWv4): Population Density\"\n  />\n  </div>\n\n</template>\n\n<style scoped>\n\n\n.long-legend > .legend-label {\n  grid-template-columns: minmax(auto, 100px) 1fr;\n}\n\n.subtitle {\n  text-align: center;\n  font-weight: normal;\n  font-size: 0.8em;\n  margin-top: 0.25em;\n}\n\n</style>","import script from \"./PopDensLegend.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PopDensLegend.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PopDensLegend.vue?vue&type=style&index=0&id=fc13343a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fc13343a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, unref as _unref, vShow as _vShow, withDirectives as _withDirectives, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createSlots as _createSlots } from \"vue\"\n\nconst _hoisted_1 = { class: \"layer-order-row\" }\nconst _hoisted_2 = { class: \"drag-handle\" }\nconst _hoisted_3 = [\"innerHTML\"]\nconst _hoisted_4 = [\"innerHTML\"]\n\nimport { computed, type MaybeRef,  toValue, toRef } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport draggable from 'vuedraggable';\nimport M from 'maplibre-gl';\n\nimport { useMaplibreLayerOrderControl } from \"@/composables/useMaplibreLayerOrderControl\";\nimport { capitalizeWords } from \"@/utils/names\";\nimport { colorbarOptions } from \"@/esri/ImageLayerConfig\";\nimport { colormapFunction } from \"@/colormaps/utils\";\nimport { useTempoStore } from \"@/stores/app\";\nimport NarrowExpansionPanel from './NarrowExpansionPanel.vue';\nimport LandUseLegend from './LandUseLegend.vue';\nimport AQILegend from './AQILegend.vue';\nimport PopDensLegend from './PopDensLegend.vue';\n\n\ninterface Props {\n  mapRef: M.Map | null;\n  order: MaybeRef<string[]>;\n}\n\ninterface Emits {\n  (e: 'change', newOrder: string[]): void;\n}\nconst tempoPrefix = \"tempo-\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'LayerOrderControl',\n  props: {\n    mapRef: {},\n    order: {}\n  },\n  emits: [\"change\"],\n  setup(__props: any, { emit: __emit }) {\n\nconst store = useTempoStore();\nconst { showRGBMode } = storeToRefs(store);\n\nconst props = __props;\nconst mapRef = toRef(() => props.mapRef);\n\n// https://vuejs.org/guide/typescript/composition-api.html#typing-component-emits\n\nconst _emit = __emit;\n\n  \nconst connections = {\n  'stamen-toner-lines': ['coastline-custom', 'states-custom', 'stamen-toner-lines'],\n};\nconst getConnectedItems = (layer: string): string[] => {\n  return connections[layer] ?? [];\n};\n\nconst { \n  currentOrder, \n  controller \n} = useMaplibreLayerOrderControl(\n  mapRef, \n  toValue(props.order),\n  false,\n  Object.entries(connections).map(([key, value]) => [key, value])\n  \n);\n\nconst displayOrder = computed({\n  get(): string[] {\n    return currentOrder.value.slice().reverse();\n  },\n  set(value: string[]) {\n    controller?.setManagedOrder(value.slice().reverse());\n  }\n});\n\nconst layerNames: Record<string, string | undefined> = {\n  \"tempo-no2\": \"TEMPO NO2\",\n  \"aqi-layer-aqi\": \"Air Quality Index\",\n  \"power-plants-heatmap\": \"Power Plants\",\n  \"power-plants-layer\": \"Power Plants\",\n  \"stamen-toner-lines\": \"Roads & Boundaries\",\n  \"stamen-toner-labels\": \"Place Labels\",\n  \"pop-dens\": \"Population Density\",\n  \"land-use\": \"Land Use\",\n  \"hms-fire\": \"Fire Detections\",\n  'tempo-hcho': \"TEMPO HCHO\",\n  'tempo-o3': \"TEMPO Ozone\",\n};\n\nconst layerInfo: Record<string, string | undefined> = {\n  \"tempo-no2\": `<h3>TEMPO Nitrogen Dioxide (NO<sub>2</sub>) Data Layer</h3>\n                <br/>\n                This data layer shows the amount of nitrogen dioxide (NO<sub>2</sub>) in the lower part of the Earths atmosphere, called the troposphere. This measurement represents the total number of nitrogen dioxide molecules in a column of air above one square centimeter on the Earths surface (molecules/cm2). NO<sub>2</sub> is an air pollutant that can affect both air quality and human health. It is produced by burning fossil fuels (ie. vehicles and power plants), fires, and even lightning.\n                <br/><br/>\n                TEMPOs sensor captures this data at about 2 km by 4.75 km at the center of the field of regard (FOR). The data is processed into a Level 3 product with a resolution of 0.02 by 0.02 degrees, and the imagery you see is displayed at about 2 km resolution. To ensure accuracy, the layer is filtered, and only includes high-quality data points, based on key quality checks and sunlight conditions (solar zenith angle).`,\n  \"tempo-hcho\": `<h3>TEMPO Formaldehyde (HCHO) Data Layer</h3>\n                 <br/>\n                 This layer shows the total amount of formaldehyde in a vertical column of Earths atmosphere. The measurement represents the number of formaldehyde molecules in a column of air above each square centimeter of Earths surface. Formaldehyde is a Volatile Organic Compound (VOC), a major category of air pollutant that impacts human health and is a precursor to ozone. It is produced by natural sources (trees) as well as man-made sources, such as exhaust from cars, manufacturing plants, and oil and gas extraction.\n                 <br/><br/>\n                 TEMPO collects this information at about 2 km by 4.75 km near the center of its viewing area. The data is processed into a Level 3 product with a resolution of 0.02 by 0.02 degrees. The imagery you see is displayed at about 2 km resolution. To ensure accuracy, the layer only includes high-quality data points, filtered using key quality checks, sunlight conditions, and cloud coverage.`,\n  \"tempo-o3\": `<h3>TEMPO Ozone (O3) Data Layer</h3>\n               <br/>\n               This layer shows the total amount of ozone in a vertical column of Earths atmosphere, measured in Dobson Units (DU). In the upper atmosphere, ozone plays an important role in protecting life on Earth by absorbing harmful ultraviolet radiation, but in the troposphere ozone is an air pollutant that can affect plant, animal, and human health. Ozone in the troposphere is produced when NO<sub>2</sub> and volatile organic compounds, like HCHO interact in sunlight.\n               <br/><br/>\n               TEMPO collects ozone measurements at about 2 km by 4.75 km near the center of its viewing area. The data is processed into a Level 3 product with a resolution of 0.02 by 0.02 degrees, and the imagery you see is displayed at about 2 km resolution. To ensure accuracy, the layer only includes high-quality data points, filtered using sunlight conditions (solar zenith angles less than 80).`,\n  \"hms-fire\": `This layer displays where potential fires have been identified using data from the NOAA Hazard Mapping System. Multiple satellites are used to detect these active fires. However, these sensors are sensitive to both heat sources and reflected sunlight. Industrial sources like steel mills and reflective surfaces like solar panels may create similar signals, but are typically filtered out during data processing. Fire detections can be impacted by environmental factors including cloud cover, dense smoke, and the terrain.\n                <br/><br/>\n                The colors represent the fires radiative power (FRP), which is a measure of the heat energy released by the fire, expressed in megawatts (MW). Higher FRP values often indicate more intense burning within a group of fire pixels, though these values can vary depending on imaging conditions. If FRP data isnt available for a location, a placeholder value is used.\n                <br/><br/>\n                Source: NOAA Hazard Mapping System Fire And Smoke Product (<a href=\"https://www.ospo.noaa.gov/products/land/hms.html\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>)\n                <br/><br/>\n                Satellites: GOES/ABI, the JPSS/VIIRS and EOS/MODIS`,\n  \"land-use\": `This layer shows a global map of land use and land cover (LULC) created from high-resolution Sentinel-2 satellite imagery. The annual map is generated using Impact Observatorys AI land classification model which was trained on billions of pixels each labeled by a person and provided by the National Geographic Society.\n                <br/><br/>\n                The land cover categories include: Water, Trees, Flooded Vegetation, Crops, Built Areas, Bare Ground, Snow/Ice, Clouds, and Rangeland.\n                <br/><br/>\n                Source: ESA Sentinel-2, model produced by ESRI and Impact Observatory (<a href=\"https://livingatlas.arcgis.com/landcoverexplorer/\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>)`,\n  \"pop-dens\": `This layer shows the estimates of human population density, indicated as the number of people per square kilometer, based on official national census and population data. The layer was created using data from ~13.5 million administrative units worldwide.\n                 <br/><br/>\n                 Source: Created by Center for International Earth Science Information Network - CIESIN - Columbia University. Published by NASA Socioeconomic Data and Applications Center (<a href=\"https://www.arcgis.com/home/item.html?id=a9fea1ecd1ba4f7db80a0f667fbc508b\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>)`,\n  \"aqi-layer-aqi\": `This layer shows the air quality index (AQI) using six color coded categories, each representing a range of values. Higher AQI values indicate higher levels of air pollution.  The AQI for each pollutant is based on health standards set for that pollutant and the scientific information that supports that standard. For ozone, the AQI is calculated on an 8-hour average while for particle pollution it uses a 24-hour average. The reported AQI is the highest AQI value for any of the five measured pollutants.\n                    <br/><br/>\n                    Source: Air Quality monitors in the U.S, Canada, and Mexico (<a href=\"https://gispub.epa.gov/airnow/index.html?tab=3&monitors=pm25&xmin=-22773986.638966657&xmax=-6121721.4048757255&ymin=-2287422.7865274334&ymax=10881759.942665514\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>) via the EPA`,\n  \"power-plants-layer\": `This layer shows all of the operable electric power plants in the United States with a maximum combined generating capacity of at least 30 megawatts (MW) or more (anywhere from ~400-800 homes a year). They are categorized by their energy source. The layer includes plants that are currently running, on standby, or are temporarily out of service.\n                         <br/><br/>\n                         The three major categories for generating electricity are fossil fuels, nuclear energy, and renewable energy sources.\n                         <br/><br/>\n                         Source: U.S. Energy Information Administration (EIA)</a>, provided by FEMA Geospatial Resource Center (<a href=\"https://gis-fema.hub.arcgis.com/datasets/b063316fac7345dba4bae96eaa813b2f/about\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>). Last accessed Oct. 16, 2025`,\n\n};\n\nconst hasLegend = ['land-use', 'aqi-layer-aqi', 'power-plants-layer', 'pop-dens'];\n\nfunction displayNameTransform(layerId: string): string {\n  return layerNames[layerId] ?? capitalizeWords(layerId.replace(/-/g, \" \"));\n}\n\nfunction cbarLabel(cbarScale: number, unit: string) {\n  const power = cbarScale > 1 ? `10<sup>${Math.round(Math.log10(cbarScale))}</sup>` : \"\";\n  return `${power} ${unit}`;\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_colorbar_horizontal = _resolveComponent(\"colorbar-horizontal\")!\n  const _component_local_scope = _resolveComponent(\"local-scope\")!\n  const _component_power_plants_filter_control = _resolveComponent(\"power-plants-filter-control\")!\n  const _component_layer_control_item = _resolveComponent(\"layer-control-item\")!\n\n  return (_openBlock(), _createBlock(_unref(draggable), {\n    modelValue: displayOrder.value,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((displayOrder).value = $event)),\n    handle: \".drag-handle\",\n    class: \"layer-order\",\n    \"item-key\": (item) => item\n  }, {\n    item: _withCtx(({ element }) => [\n      _createElementVNode(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createVNode(_component_v_icon, { size: \"x-small\" }, {\n            default: _withCtx(() => [...(_cache[1] || (_cache[1] = [\n              _createTextVNode(\"mdi-menu\", -1)\n            ]))]),\n            _: 1\n          })\n        ]),\n        _createVNode(_component_layer_control_item, {\n          map: mapRef.value,\n          \"layer-id\": element,\n          \"display-name\": displayNameTransform(element),\n          \"synced-items\": getConnectedItems(element)\n        }, _createSlots({\n          extras: _withCtx(({ visible }) => [\n            (element.startsWith(tempoPrefix))\n              ? (_openBlock(), _createBlock(_component_local_scope, {\n                  key: 0,\n                  cbar: _unref(colorbarOptions)[element.slice(tempoPrefix.length)]\n                }, {\n                  default: _withCtx(({ cbar }) => [\n                    _withDirectives(_createVNode(_component_colorbar_horizontal, {\n                      \"cmap-name\": _unref(showRGBMode) ? cbar.rgbcolormap : cbar.colormap,\n                      cmap: _unref(colormapFunction)(_unref(showRGBMode) ? cbar.rgbcolormap : cbar.colormap),\n                      \"background-color\": \"transparent\",\n                      height: \"15px\",\n                      \"font-size\": \"9pt\",\n                      nsteps: 255,\n                      \"start-value\": String((_unref(showRGBMode) ? cbar.rgbstretch : cbar.stretch)[0] / cbar.cbarScale),\n                      \"end-value\": String((_unref(showRGBMode) ? cbar.rgbstretch : cbar.stretch)[1] / cbar.cbarScale),\n                      extend: false\n                    }, {\n                      label: _withCtx(() => [\n                        _createElementVNode(\"span\", {\n                          innerHTML: cbarLabel(cbar.cbarScale, cbar.unit)\n                        }, null, 8, _hoisted_4)\n                      ]),\n                      _: 2\n                    }, 1032, [\"cmap-name\", \"cmap\", \"start-value\", \"end-value\"]), [\n                      [_vShow, visible]\n                    ])\n                  ]),\n                  _: 2\n                }, 1032, [\"cbar\"]))\n              : _createCommentVNode(\"\", true),\n            (hasLegend.includes(element))\n              ? _withDirectives((_openBlock(), _createBlock(NarrowExpansionPanel, {\n                  key: 1,\n                  item: element,\n                  label: element==='power-plants-layer' ? 'Show Filter' : 'Show Legend'\n                }, {\n                  default: _withCtx(() => [\n                    (element === 'land-use')\n                      ? (_openBlock(), _createBlock(LandUseLegend, { key: 0 }))\n                      : _createCommentVNode(\"\", true),\n                    (element === 'aqi-layer-aqi')\n                      ? (_openBlock(), _createBlock(AQILegend, { key: 1 }))\n                      : _createCommentVNode(\"\", true),\n                    (element === 'power-plants-layer')\n                      ? (_openBlock(), _createBlock(_component_power_plants_filter_control, {\n                          key: 2,\n                          map: mapRef.value\n                        }, null, 8, [\"map\"]))\n                      : _createCommentVNode(\"\", true),\n                    (element === 'pop-dens')\n                      ? (_openBlock(), _createBlock(PopDensLegend, {\n                          key: 3,\n                          mini: \"\"\n                        }))\n                      : _createCommentVNode(\"\", true)\n                  ]),\n                  _: 2\n                }, 1032, [\"item\", \"label\"])), [\n                  [_vShow, visible]\n                ])\n              : _createCommentVNode(\"\", true)\n          ]),\n          _: 2\n        }, [\n          (layerInfo[element])\n            ? {\n                name: \"info\",\n                fn: _withCtx(() => [\n                  _createElementVNode(\"div\", {\n                    innerHTML: layerInfo[element]\n                  }, null, 8, _hoisted_3)\n                ]),\n                key: \"0\"\n              }\n            : undefined\n        ]), 1032, [\"map\", \"layer-id\", \"display-name\", \"synced-items\"])\n      ])\n    ]),\n    _: 1\n  }, 8, [\"modelValue\", \"item-key\"]))\n}\n}\n\n})","<template>\n  <draggable \n    v-model=\"displayOrder\" \n    handle=\".drag-handle\"\n    class=\"layer-order\"\n    :item-key=\"(item) => item\"\n  >\n    <template #item=\"{ element }\">\n      <div class=\"layer-order-row\">\n        <div class=\"drag-handle\">\n          <v-icon size=\"x-small\">mdi-menu</v-icon>\n        </div>\n        <layer-control-item\n          :map=\"mapRef\"\n          :layer-id=\"element\"\n          :display-name=\"displayNameTransform(element)\"\n          :synced-items=\"getConnectedItems(element)\"\n        >\n          <template #info\n            v-if=\"layerInfo[element]\"\n          >\n            <div v-html=\"layerInfo[element]\"></div>\n          </template>\n          <template #extras=\"{ visible }\"\n          >\n            <local-scope\n              v-if=\"element.startsWith(tempoPrefix)\"\n              :cbar=\"colorbarOptions[element.slice(tempoPrefix.length)]\"\n            >\n              <template #default=\"{ cbar }\">\n                <colorbar-horizontal\n                  v-show=\"visible\"\n                  :cmap-name=\"showRGBMode ? cbar.rgbcolormap : cbar.colormap\"\n                  :cmap=\"colormapFunction(showRGBMode ? cbar.rgbcolormap : cbar.colormap)\"\n                  background-color=\"transparent\"\n                  height=\"15px\"\n                  font-size=\"9pt\"\n                  :nsteps=\"255\"\n                  :start-value=\"String((showRGBMode ? cbar.rgbstretch : cbar.stretch)[0] / cbar.cbarScale)\"\n                  :end-value=\"String((showRGBMode ? cbar.rgbstretch : cbar.stretch)[1] / cbar.cbarScale)\"\n                  :extend=\"false\"\n                >\n                  <template #label>\n                    <span v-html=\"cbarLabel(cbar.cbarScale, cbar.unit)\"></span>\n                  </template>\n                </colorbar-horizontal>\n              </template>\n            </local-scope>\n            <!-- Legend -->\n\n            <NarrowExpansionPanel v-show=\"visible\" :item=\"element\" v-if=\"hasLegend.includes(element)\" :label=\"element==='power-plants-layer' ? 'Show Filter' : 'Show Legend'\">\n              <land-use-legend  v-if=\"element === 'land-use'\"  />\n              <AQILegend v-if=\"element === 'aqi-layer-aqi'\" />\n              <power-plants-filter-control :map=\"mapRef\" v-if=\"element === 'power-plants-layer'\"/>\n              <pop-dens-legend v-if=\"element === 'pop-dens'\" mini/>\n            </NarrowExpansionPanel>\n\n          </template>\n        </layer-control-item>\n      </div>\n    </template>\n  </draggable>\n</template>\n\n\n<script setup lang=\"ts\">\nimport { computed, type MaybeRef,  toValue, toRef } from 'vue';\nimport { storeToRefs } from \"pinia\";\nimport draggable from 'vuedraggable';\nimport M from 'maplibre-gl';\n\nimport { useMaplibreLayerOrderControl } from \"@/composables/useMaplibreLayerOrderControl\";\nimport { capitalizeWords } from \"@/utils/names\";\nimport { colorbarOptions } from \"@/esri/ImageLayerConfig\";\nimport { colormapFunction } from \"@/colormaps/utils\";\nimport { useTempoStore } from \"@/stores/app\";\nimport NarrowExpansionPanel from './NarrowExpansionPanel.vue';\nimport LandUseLegend from './LandUseLegend.vue';\nimport AQILegend from './AQILegend.vue';\nimport PopDensLegend from './PopDensLegend.vue';\n\n\nconst store = useTempoStore();\nconst { showRGBMode } = storeToRefs(store);\n\ninterface Props {\n  mapRef: M.Map | null;\n  order: MaybeRef<string[]>;\n}\n\nconst props = defineProps<Props>();\nconst mapRef = toRef(() => props.mapRef);\n\n// https://vuejs.org/guide/typescript/composition-api.html#typing-component-emits\n\ninterface Emits {\n  (e: 'change', newOrder: string[]): void;\n}\nconst _emit = defineEmits<Emits>();\n\n  \nconst connections = {\n  'stamen-toner-lines': ['coastline-custom', 'states-custom', 'stamen-toner-lines'],\n};\nconst getConnectedItems = (layer: string): string[] => {\n  return connections[layer] ?? [];\n};\n\nconst { \n  currentOrder, \n  controller \n} = useMaplibreLayerOrderControl(\n  mapRef, \n  toValue(props.order),\n  false,\n  Object.entries(connections).map(([key, value]) => [key, value])\n  \n);\n\nconst tempoPrefix = \"tempo-\";\n\nconst displayOrder = computed({\n  get(): string[] {\n    return currentOrder.value.slice().reverse();\n  },\n  set(value: string[]) {\n    controller?.setManagedOrder(value.slice().reverse());\n  }\n});\n\nconst layerNames: Record<string, string | undefined> = {\n  \"tempo-no2\": \"TEMPO NO2\",\n  \"aqi-layer-aqi\": \"Air Quality Index\",\n  \"power-plants-heatmap\": \"Power Plants\",\n  \"power-plants-layer\": \"Power Plants\",\n  \"stamen-toner-lines\": \"Roads & Boundaries\",\n  \"stamen-toner-labels\": \"Place Labels\",\n  \"pop-dens\": \"Population Density\",\n  \"land-use\": \"Land Use\",\n  \"hms-fire\": \"Fire Detections\",\n  'tempo-hcho': \"TEMPO HCHO\",\n  'tempo-o3': \"TEMPO Ozone\",\n};\n\nconst layerInfo: Record<string, string | undefined> = {\n  \"tempo-no2\": `<h3>TEMPO Nitrogen Dioxide (NO<sub>2</sub>) Data Layer</h3>\n                <br/>\n                This data layer shows the amount of nitrogen dioxide (NO<sub>2</sub>) in the lower part of the Earths atmosphere, called the troposphere. This measurement represents the total number of nitrogen dioxide molecules in a column of air above one square centimeter on the Earths surface (molecules/cm2). NO<sub>2</sub> is an air pollutant that can affect both air quality and human health. It is produced by burning fossil fuels (ie. vehicles and power plants), fires, and even lightning.\n                <br/><br/>\n                TEMPOs sensor captures this data at about 2 km by 4.75 km at the center of the field of regard (FOR). The data is processed into a Level 3 product with a resolution of 0.02 by 0.02 degrees, and the imagery you see is displayed at about 2 km resolution. To ensure accuracy, the layer is filtered, and only includes high-quality data points, based on key quality checks and sunlight conditions (solar zenith angle).`,\n  \"tempo-hcho\": `<h3>TEMPO Formaldehyde (HCHO) Data Layer</h3>\n                 <br/>\n                 This layer shows the total amount of formaldehyde in a vertical column of Earths atmosphere. The measurement represents the number of formaldehyde molecules in a column of air above each square centimeter of Earths surface. Formaldehyde is a Volatile Organic Compound (VOC), a major category of air pollutant that impacts human health and is a precursor to ozone. It is produced by natural sources (trees) as well as man-made sources, such as exhaust from cars, manufacturing plants, and oil and gas extraction.\n                 <br/><br/>\n                 TEMPO collects this information at about 2 km by 4.75 km near the center of its viewing area. The data is processed into a Level 3 product with a resolution of 0.02 by 0.02 degrees. The imagery you see is displayed at about 2 km resolution. To ensure accuracy, the layer only includes high-quality data points, filtered using key quality checks, sunlight conditions, and cloud coverage.`,\n  \"tempo-o3\": `<h3>TEMPO Ozone (O3) Data Layer</h3>\n               <br/>\n               This layer shows the total amount of ozone in a vertical column of Earths atmosphere, measured in Dobson Units (DU). In the upper atmosphere, ozone plays an important role in protecting life on Earth by absorbing harmful ultraviolet radiation, but in the troposphere ozone is an air pollutant that can affect plant, animal, and human health. Ozone in the troposphere is produced when NO<sub>2</sub> and volatile organic compounds, like HCHO interact in sunlight.\n               <br/><br/>\n               TEMPO collects ozone measurements at about 2 km by 4.75 km near the center of its viewing area. The data is processed into a Level 3 product with a resolution of 0.02 by 0.02 degrees, and the imagery you see is displayed at about 2 km resolution. To ensure accuracy, the layer only includes high-quality data points, filtered using sunlight conditions (solar zenith angles less than 80).`,\n  \"hms-fire\": `This layer displays where potential fires have been identified using data from the NOAA Hazard Mapping System. Multiple satellites are used to detect these active fires. However, these sensors are sensitive to both heat sources and reflected sunlight. Industrial sources like steel mills and reflective surfaces like solar panels may create similar signals, but are typically filtered out during data processing. Fire detections can be impacted by environmental factors including cloud cover, dense smoke, and the terrain.\n                <br/><br/>\n                The colors represent the fires radiative power (FRP), which is a measure of the heat energy released by the fire, expressed in megawatts (MW). Higher FRP values often indicate more intense burning within a group of fire pixels, though these values can vary depending on imaging conditions. If FRP data isnt available for a location, a placeholder value is used.\n                <br/><br/>\n                Source: NOAA Hazard Mapping System Fire And Smoke Product (<a href=\"https://www.ospo.noaa.gov/products/land/hms.html\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>)\n                <br/><br/>\n                Satellites: GOES/ABI, the JPSS/VIIRS and EOS/MODIS`,\n  \"land-use\": `This layer shows a global map of land use and land cover (LULC) created from high-resolution Sentinel-2 satellite imagery. The annual map is generated using Impact Observatorys AI land classification model which was trained on billions of pixels each labeled by a person and provided by the National Geographic Society.\n                <br/><br/>\n                The land cover categories include: Water, Trees, Flooded Vegetation, Crops, Built Areas, Bare Ground, Snow/Ice, Clouds, and Rangeland.\n                <br/><br/>\n                Source: ESA Sentinel-2, model produced by ESRI and Impact Observatory (<a href=\"https://livingatlas.arcgis.com/landcoverexplorer/\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>)`,\n  \"pop-dens\": `This layer shows the estimates of human population density, indicated as the number of people per square kilometer, based on official national census and population data. The layer was created using data from ~13.5 million administrative units worldwide.\n                 <br/><br/>\n                 Source: Created by Center for International Earth Science Information Network - CIESIN - Columbia University. Published by NASA Socioeconomic Data and Applications Center (<a href=\"https://www.arcgis.com/home/item.html?id=a9fea1ecd1ba4f7db80a0f667fbc508b\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>)`,\n  \"aqi-layer-aqi\": `This layer shows the air quality index (AQI) using six color coded categories, each representing a range of values. Higher AQI values indicate higher levels of air pollution.  The AQI for each pollutant is based on health standards set for that pollutant and the scientific information that supports that standard. For ozone, the AQI is calculated on an 8-hour average while for particle pollution it uses a 24-hour average. The reported AQI is the highest AQI value for any of the five measured pollutants.\n                    <br/><br/>\n                    Source: Air Quality monitors in the U.S, Canada, and Mexico (<a href=\"https://gispub.epa.gov/airnow/index.html?tab=3&monitors=pm25&xmin=-22773986.638966657&xmax=-6121721.4048757255&ymin=-2287422.7865274334&ymax=10881759.942665514\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>) via the EPA`,\n  \"power-plants-layer\": `This layer shows all of the operable electric power plants in the United States with a maximum combined generating capacity of at least 30 megawatts (MW) or more (anywhere from ~400-800 homes a year). They are categorized by their energy source. The layer includes plants that are currently running, on standby, or are temporarily out of service.\n                         <br/><br/>\n                         The three major categories for generating electricity are fossil fuels, nuclear energy, and renewable energy sources.\n                         <br/><br/>\n                         Source: U.S. Energy Information Administration (EIA)</a>, provided by FEMA Geospatial Resource Center (<a href=\"https://gis-fema.hub.arcgis.com/datasets/b063316fac7345dba4bae96eaa813b2f/about\" target=\"_blank\" rel=\"noopener noreferrer\">link</a>). Last accessed Oct. 16, 2025`,\n\n};\n\nconst hasLegend = ['land-use', 'aqi-layer-aqi', 'power-plants-layer', 'pop-dens'];\n\nfunction displayNameTransform(layerId: string): string {\n  return layerNames[layerId] ?? capitalizeWords(layerId.replace(/-/g, \" \"));\n}\n\nfunction cbarLabel(cbarScale: number, unit: string) {\n  const power = cbarScale > 1 ? `10<sup>${Math.round(Math.log10(cbarScale))}</sup>` : \"\";\n  return `${power} ${unit}`;\n}\n</script>\n\n\n<style scoped>\nul {\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n  margin-left: 1rem;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  height: fit-content;\n}\n\nli {\n  padding: 8px 12px;\n  border-bottom: 1px solid #eee;\n  cursor: move;\n  margin: 10px 0;\n}\n\n.drag-handle {\n  font-size: 20pt;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    cursor: grab;\n  }\n}\n\n.layer-order {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.layer-order-row {\n  background: #404040;\n  border: 1px solid white;\n  border-radius: 10px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 5px;\n}\n\n.mlc-layer-item {\n  border-left: 1px solid white;\n  padding: 2px;\n}\n\n#power-plant-filter-controls {\n  box-sizing: border-box;\n}\n</style>\n","import script from \"./LayerOrderControl.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LayerOrderControl.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LayerOrderControl.vue?vue&type=style&index=0&id=1a874ecc&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1a874ecc\"]])\n\nexport default __exports__","import { Map } from \"maplibre-gl\";\nimport { ref, watch } from \"vue\";\n\nimport { getLayerOpacity, setLayerOpacity } from \"@/maplibre_controls\";\n\nexport function useMaplibreLayerOpacity(\n  map: Map,\n  layerId: string,\n  initialOpacity?: number,\n) {\n  const opacity = ref(initialOpacity ?? getLayerOpacity(map, layerId));\n  watch(opacity, (value: number) => setLayerOpacity(map, layerId, value), { immediate: true });\n  map.on(\"styledata\", () => {\n    opacity.value = getLayerOpacity(map, layerId);\n  });\n\n  return {\n    opacity,\n  };\n}\n","import { Map } from \"maplibre-gl\";\nimport { ref, watch } from \"vue\";\n\nimport { getLayerVisibility, setLayerVisibility } from \"@/maplibre_controls\";\n\nexport function useMaplibreLayerVisibility(\n  map: Map,\n  layerId: string,\n  initialVisibility?: boolean,\n) {\n  const visible = ref(initialVisibility ?? getLayerVisibility(map, layerId));\n  watch(visible, (value: boolean) => setLayerVisibility(map, layerId, value), { immediate: true });\n  map.on(\"styledata\", () => {\n    visible.value = getLayerVisibility(map, layerId);\n  });\n\n  return {\n    visible,\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, renderSlot as _renderSlot, resolveComponent as _resolveComponent, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, isRef as _isRef, createVNode as _createVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\nconst _hoisted_2 = { class: \"mlc-layer-item-checkbox-opacity-container\" }\n\nimport { computed, useSlots, watch } from \"vue\";\nimport type { Map } from \"maplibre-gl\";\nimport { useMaplibreLayerOpacity } from \"@/composables/useMaplibreLayerOpacity\";\nimport { useMaplibreLayerVisibility } from \"@/composables/useMaplibreLayerVisibility\";\nimport { setLayerOpacity, setLayerVisibility } from \"@/maplibre_controls\";\nimport { storeToRefs } from \"pinia\";\nimport { useTempoStore } from \"@/stores/app\";\n\ninterface Props {\n  layerId: string;\n  map: Map;\n  displayName?: string;\n  syncedItems?: string[];\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MaplibreLayerControlItem',\n  props: {\n    layerId: {},\n    map: {},\n    displayName: {},\n    syncedItems: {}\n  },\n  setup(__props: any) {\n\nconst store = useTempoStore();\nconst { shownLayers } = storeToRefs(store);\n\nconst props = __props;\nlet { opacity } = useMaplibreLayerOpacity(props.map, props.layerId);\nlet { visible } = useMaplibreLayerVisibility(props.map, props.layerId);\n\n// sync opacity and visibility to other layers if specified \n// the opacity should be the layers opacity * the opacity of the main layer (layerId)\nconst { layerId, syncedItems } = props;\nfunction syncOpacityAndVisibility() {\n  if (syncedItems && syncedItems.length > 0) {\n    syncedItems.forEach((syncedLayerId) => {\n      setLayerOpacity(props.map, syncedLayerId, opacity.value);\n      setLayerVisibility(props.map, syncedLayerId, visible.value);\n    });\n  }\n}\n\nconst slots = useSlots();\nconst showInfo = computed(() => !!slots.info);\n\n// Watch for changes to opacity and visibility and sync if needed\nwatch(() => [opacity.value, visible.value], () => {\n  syncOpacityAndVisibility();\n  // so just having this update here will miss the initial layers. but it's ok for now\n  // since it only applies to legend layers. when we reload the state\n  // we don't display the previously visible datasets anyway. \n  if (visible.value) {\n    if (!shownLayers.value.includes(props.layerId)) {\n      shownLayers.value.push(props.layerId);\n    }\n  }\n});\n\n// NB: If the props update, we need to make sure that the refs that we're using are still tracking the same layer\n// In particular, if the layer ID changes, without this the component can end up manipulating the wrong layer!\nwatch(() => [props.map, props.layerId],\n  ([map, layerId]: [Map, string]) => {\n    opacity = useMaplibreLayerOpacity(map, layerId).opacity;\n    visible = useMaplibreLayerVisibility(map, layerId).visible;\n    syncOpacityAndVisibility();\n  }\n);\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_popup_info_button = _resolveComponent(\"popup-info-button\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n  const _component_v_slider = _resolveComponent(\"v-slider\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    id: `mlc-layer-item-${_unref(layerId)}`,\n    class: _normalizeClass(['mlc-layer-item', `mlc-layer-item-${_unref(visible) ? 'visible' : 'none'}`])\n  }, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(_component_v_checkbox, {\n        modelValue: _unref(visible),\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => (_isRef(visible) ? (visible).value = $event : visible = $event)),\n        id: `mlc-${_unref(layerId)}-visibility-checkbox`,\n        class: \"mlc-layer-item-checkbox\",\n        density: \"compact\",\n        \"hide-details\": \"\",\n        color: \"primary\",\n        label: __props.displayName ?? _unref(layerId)\n      }, {\n        label: _withCtx(() => [\n          _createTextVNode(_toDisplayString(__props.displayName ?? _unref(layerId)), 1)\n        ]),\n        append: _withCtx(() => [\n          (showInfo.value)\n            ? (_openBlock(), _createBlock(_component_popup_info_button, {\n                key: 0,\n                width: \"500px\"\n              }, {\n                info: _withCtx(() => [\n                  _renderSlot(_ctx.$slots, \"info\")\n                ]),\n                _: 3\n              }))\n            : _createCommentVNode(\"\", true)\n        ]),\n        _: 3\n      }, 8, [\"modelValue\", \"id\", \"label\"]),\n      _createVNode(_component_v_slider, {\n        modelValue: _unref(opacity),\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => (_isRef(opacity) ? (opacity).value = $event : opacity = $event)),\n        modelModifiers: { number: true },\n        id: `mlc-${_unref(layerId)}-opacity-slider`,\n        class: \"mlc-layer-opacity-slider\",\n        min: 0,\n        max: 1,\n        step: 0.01,\n        title: \"Adjust layer opacity\",\n        color: \"primary\",\n        \"hide-details\": \"\",\n        density: \"compact\",\n        \"thumb-size\": 12,\n        \"track-size\": 3\n      }, null, 8, [\"modelValue\", \"id\"])\n    ]),\n    _renderSlot(_ctx.$slots, \"extras\", { visible: _unref(visible) })\n  ], 10, _hoisted_1))\n}\n}\n\n})","<template>\n  <div\n    :id=\"`mlc-layer-item-${layerId}`\"\n    :class=\"['mlc-layer-item', `mlc-layer-item-${visible ? 'visible' : 'none'}`]\"\n  >\n    <div\n      class=\"mlc-layer-item-checkbox-opacity-container\"\n    >\n      <v-checkbox\n        v-model=\"visible\"\n        :id=\"`mlc-${layerId}-visibility-checkbox`\"\n        class=\"mlc-layer-item-checkbox\"\n        density=\"compact\"\n        hide-details\n        color=\"primary\"\n        :label=\"displayName ?? layerId\"\n      >\n        <template #label>\n          {{ displayName ?? layerId }}\n        </template>\n        <template #append>\n          <popup-info-button\n            v-if=\"showInfo\"\n            width=\"500px\"\n          >\n            <template #info>\n              <slot name=\"info\"></slot>\n            </template>\n          </popup-info-button>\n        </template>\n      </v-checkbox>\n\n      <v-slider\n        v-model.number=\"opacity\"\n        :id=\"`mlc-${layerId}-opacity-slider`\"\n        class=\"mlc-layer-opacity-slider\"\n        :min=\"0\"\n        :max=\"1\"\n        :step=\"0.01\"\n        title=\"Adjust layer opacity\"\n        color=\"primary\"\n        hide-details\n        density=\"compact\"\n        :thumb-size=\"12\"\n        :track-size=\"3\"\n      />\n    </div>\n    <slot\n      name=\"extras\"\n      :visible=\"visible\"\n    ></slot>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, useSlots, watch } from \"vue\";\nimport type { Map } from \"maplibre-gl\";\nimport { useMaplibreLayerOpacity } from \"@/composables/useMaplibreLayerOpacity\";\nimport { useMaplibreLayerVisibility } from \"@/composables/useMaplibreLayerVisibility\";\nimport { setLayerOpacity, setLayerVisibility } from \"@/maplibre_controls\";\nimport { storeToRefs } from \"pinia\";\nimport { useTempoStore } from \"@/stores/app\";\n\nconst store = useTempoStore();\nconst { shownLayers } = storeToRefs(store);\n\ninterface Props {\n  layerId: string;\n  map: Map;\n  displayName?: string;\n  syncedItems?: string[];\n}\n\nconst props = defineProps<Props>();\nlet { opacity } = useMaplibreLayerOpacity(props.map, props.layerId);\nlet { visible } = useMaplibreLayerVisibility(props.map, props.layerId);\n\n// sync opacity and visibility to other layers if specified \n// the opacity should be the layers opacity * the opacity of the main layer (layerId)\nconst { layerId, syncedItems } = props;\nfunction syncOpacityAndVisibility() {\n  if (syncedItems && syncedItems.length > 0) {\n    syncedItems.forEach((syncedLayerId) => {\n      setLayerOpacity(props.map, syncedLayerId, opacity.value);\n      setLayerVisibility(props.map, syncedLayerId, visible.value);\n    });\n  }\n}\n\nconst slots = useSlots();\nconst showInfo = computed(() => !!slots.info);\n\n// Watch for changes to opacity and visibility and sync if needed\nwatch(() => [opacity.value, visible.value], () => {\n  syncOpacityAndVisibility();\n  // so just having this update here will miss the initial layers. but it's ok for now\n  // since it only applies to legend layers. when we reload the state\n  // we don't display the previously visible datasets anyway. \n  if (visible.value) {\n    if (!shownLayers.value.includes(props.layerId)) {\n      shownLayers.value.push(props.layerId);\n    }\n  }\n});\n\n// NB: If the props update, we need to make sure that the refs that we're using are still tracking the same layer\n// In particular, if the layer ID changes, without this the component can end up manipulating the wrong layer!\nwatch(() => [props.map, props.layerId],\n  ([map, layerId]: [Map, string]) => {\n    opacity = useMaplibreLayerOpacity(map, layerId).opacity;\n    visible = useMaplibreLayerVisibility(map, layerId).visible;\n    syncOpacityAndVisibility();\n  }\n);\n</script>\n\n<style scoped lang=\"less\">\n:deep(.v-checkbox .v-label) {\n  font-size: 10pt;\n}\n\n.mlc-layer-item {\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: space-between;\n}\n\n.mlc-layer-item-checkbox-opacity-container {\n  width: 100%;\n  padding: 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n\n  :deep(.v-input__append) {\n    margin-left: 5px;\n  }\n\n  .v-slider {\n    width: 70px;\n    flex-grow: 0;\n  }\n}\n</style>\n","import script from \"./MaplibreLayerControlItem.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MaplibreLayerControlItem.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MaplibreLayerControlItem.vue?vue&type=style&index=0&id=0bc866b5&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0bc866b5\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, withModifiers as _withModifiers, unref as _unref, createBlock as _createBlock, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = { class: \"global-filters\" }\nconst _hoisted_2 = { class: \"expansion-panel-title\" }\nconst _hoisted_3 = { class: \"expansion-panel-text\" }\n\nimport { computed, ref, watch, onMounted } from \"vue\";\nimport type { LayerSpecification, Map } from \"maplibre-gl\";\n\nimport { \n  PrimSource,\n  RenewableSources,\n  TraditionalSources,\n} from \"@/assets/power_plants\";\n\nimport { POWER_PLANT_COLORS } from \"@/composables/addPowerPlants\";\n\nimport { setLayerVisibility } from \"@/maplibre_controls\";\n\ninterface Props {\n  map: Map;\n}\n\nconst minColumnWidthPx = 170;\n\ntype PlantCategory = typeof PLANT_CATEGORIES[number];\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'PowerPlantsFilterControl',\n  props: {\n    map: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\n\nconst openPanels = ref<number[]>([]);\nconst columns = ref(2);\nconst cssVars = computed(() => ({\n  \"--column-count\": columns.value, \n}));\n\nconst PLANT_CATEGORIES = [\"Renewables\", \"Fossil Fuels\", \"Other\"] as const;\nconst selectedSources = ref<PrimSource[]>(Object.values(PrimSource));\n\nconst SOURCES_BY_CATEGORY: Record<PlantCategory, readonly PrimSource[]> = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Renewables: RenewableSources,\n  \"Fossil Fuels\": TraditionalSources,\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Other: Object.values(PrimSource).filter(source => \n    !((RenewableSources as unknown as PrimSource[]).includes(source) || \n      (TraditionalSources as unknown as PrimSource[]).includes(source))\n  ),\n};\n\nconst icons: Record<PrimSource, string> = {\n  batteries: \"mdi-battery-charging\",\n  biomass: \"mdi-campfire\",\n  coal: \"mdi-grill\",\n  geothermal: \"fa-earth-americas\",\n  hydroelectric: \"fa-droplet\",\n  \"natural gas\": \"mdi-gas-burner\",\n  nuclear: \"fa-atom\",\n  other: \"mdi-circle\",\n  petroleum: \"mdi-gas-station\",\n  \"pumped storage\": \"mdi-water-pump\",\n  solar: \"fa-solar-panel\",\n  wind: \"mdi-wind-power\",\n};\n\nfunction openPanel(index: number) {\n  if (!openPanels.value.includes(index)) {\n    openPanels.value.push(index);\n  }\n}\n\nfunction openAllPanels() {\n  openPanels.value = [...PLANT_CATEGORIES.keys()];\n}\n\n// function updateSelectedSources(source: PrimSource, value: boolean) {\n//   console.log(\"updating\");\n//   const index = selectedSources.value.indexOf(source);\n//   if (value && index === -1) {\n//     selectedSources.value = [...selectedSources.value, source];\n//   } else if (!value && index >= 0) {\n//     selectedSources.value = selectedSources.value.slice(0, index).concat(selectedSources.value.slice(index + 1));\n//   }\n// }\n\nfunction turnOnPowerPlants() {\n  setLayerVisibility(props.map, \"power-plants-layer\", true);\n}\n\nfunction handleGlobalSelect(value: boolean) {\n  selectedSources.value = value ? [...Object.values(PrimSource)] : [];\n  turnOnPowerPlants();\n}\n\nfunction handleCategoryGlobalSelect(category: PlantCategory, value: boolean) {\n  if (value) {\n    // We could update the ref directly and use a deep watcher, but we don't need\n    // to trigger UI updates on each push here - better to do it all at the end\n    const sources = [...selectedSources.value];\n    SOURCES_BY_CATEGORY[category].forEach(source => {\n      if (!sources.includes(source)) {\n        sources.push(source);\n      }\n    });\n    selectedSources.value = sources;\n  } else {\n    selectedSources.value = selectedSources.value.filter(item => !SOURCES_BY_CATEGORY[category].includes(item));\n  }\n  turnOnPowerPlants();\n}\n\nlet layers: LayerSpecification[] = [];\n\nfunction onLayersChanged(newLayers: LayerSpecification[]) {\n  layers = newLayers;\n  applyPrimSourceFilter(selectedSources.value);\n}\n\nfunction updateColumnCount() {\n  const container = document.querySelector(\"#power-plant-filter-controls\");\n  if (container) {\n    columns.value = Math.max(Math.floor(container.clientWidth / minColumnWidthPx), 1);\n  }\n}\n\n\nonMounted(() => {\n\n  updateColumnCount();\n  const container = document.querySelector(\"#power-plant-filter-controls\");\n  if (container) {\n    const observer = new ResizeObserver(_entries => updateColumnCount());\n    observer.observe(container);\n  }\n\n  props.map.on(\"styledata\", () => {\n    // check if layers changed\n    // console.log('Style data event received');\n    const newLayerIds = new Set((props.map.getStyle().layers || []).map(l => l.id));\n    const oldLayerIds = new Set(layers.map(l => l.id));\n    const hasNewLayers = newLayerIds.size !== oldLayerIds.size || [...newLayerIds].some(id => !oldLayerIds.has(id));\n    if (hasNewLayers) {\n      // console.log('Style data changed, updating layer list');\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n    // check layer visibility changes\n    const visibilityChanged = layers.some(oldLayer => {\n      const newLayer = props.map.getStyle().layers?.find(l => l.id === oldLayer.id);\n      return newLayer && oldLayer.layout?.visibility !== newLayer.layout?.visibility;\n    });\n    if (visibilityChanged) {\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n  });\n\n  applyPrimSourceFilter(selectedSources.value);\n});\n\nwatch(selectedSources, (sources: PrimSource[]) => {\n  applyPrimSourceFilter(sources);\n  turnOnPowerPlants();\n});\n\nfunction applyPrimSourceFilter(sources: PrimSource[]) {\n  const layerIds = [\"power-plants-layer\", \"power-plants-heatmap\"];\n  layerIds.forEach(id => {\n    if (!props.map.getLayer(id)) { return; }\n  \n    if (sources.length === 0) {\n      props.map.setFilter(id, false);\n    } else if (sources.length === Object.values(PrimSource).length) {\n      props.map.setFilter(id, null);\n    } else {\n      props.map.setFilter(id, [\"in\", [\"get\", \"PrimSource\"], [\"literal\", sources]]);\n    }\n  });\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_icon_checkbox = _resolveComponent(\"icon-checkbox\")!\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\")!\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\")!\n\n  return (_openBlock(), _createBlock(_component_v_expansion_panels, {\n    id: \"power-plant-filter-controls\",\n    multiple: \"\",\n    modelValue: openPanels.value,\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((openPanels).value = $event)),\n    style: _normalizeStyle(cssVars.value)\n  }, {\n    default: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_1, [\n        _cache[8] || (_cache[8] = _createElementVNode(\"div\", null, \"Power Plant Filters\", -1)),\n        _createVNode(_component_v_btn, {\n          size: \"small\",\n          onClick: _cache[0] || (_cache[0] = () => {\n          openAllPanels();\n          handleGlobalSelect(true);\n        })\n        }, {\n          default: _withCtx(() => [...(_cache[6] || (_cache[6] = [\n            _createTextVNode(\"All\", -1)\n          ]))]),\n          _: 1\n        }),\n        _createVNode(_component_v_btn, {\n          size: \"small\",\n          onClick: _cache[1] || (_cache[1] = () => {\n          openAllPanels();\n          handleGlobalSelect(false);\n        })\n        }, {\n          default: _withCtx(() => [...(_cache[7] || (_cache[7] = [\n            _createTextVNode(\"None\", -1)\n          ]))]),\n          _: 1\n        })\n      ]),\n      (_openBlock(), _createElementBlock(_Fragment, null, _renderList(PLANT_CATEGORIES, (category, index) => {\n        return _createVNode(_component_v_expansion_panel, { key: index }, {\n          title: _withCtx(() => [\n            _createElementVNode(\"div\", _hoisted_2, [\n              _createElementVNode(\"span\", null, _toDisplayString(category), 1),\n              _createElementVNode(\"span\", null, [\n                _createVNode(_component_v_btn, {\n                  size: \"small\",\n                  onClick: [\n                    () => {\n                openPanel(index); \n                handleCategoryGlobalSelect(category, true);\n              },\n                    _cache[2] || (_cache[2] = _withModifiers(() => {}, [\"stop\"]))\n                  ]\n                }, {\n                  default: _withCtx(() => [...(_cache[9] || (_cache[9] = [\n                    _createTextVNode(\"All\", -1)\n                  ]))]),\n                  _: 1\n                }, 8, [\"onClick\"]),\n                _createVNode(_component_v_btn, {\n                  size: \"small\",\n                  onClick: [\n                    () => {\n                openPanel(index); \n                handleCategoryGlobalSelect(category, false);\n              },\n                    _cache[3] || (_cache[3] = _withModifiers(() => {}, [\"stop\"]))\n                  ]\n                }, {\n                  default: _withCtx(() => [...(_cache[10] || (_cache[10] = [\n                    _createTextVNode(\"None\", -1)\n                  ]))]),\n                  _: 1\n                }, 8, [\"onClick\"])\n              ])\n            ])\n          ]),\n          text: _withCtx(() => [\n            _createElementVNode(\"div\", _hoisted_3, [\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(SOURCES_BY_CATEGORY[category], (source) => {\n                return (_openBlock(), _createBlock(_component_icon_checkbox, {\n                  key: source,\n                  label: source,\n                  value: source,\n                  \"on-icon\": icons[source],\n                  \"off-icon\": icons[source],\n                  \"on-color\": _unref(POWER_PLANT_COLORS)[source],\n                  \"off-color\": \"gray\",\n                  modelValue: selectedSources.value,\n                  \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((selectedSources).value = $event)),\n                  density: \"compact\",\n                  \"hide-details\": \"\"\n                }, null, 8, [\"label\", \"value\", \"on-icon\", \"off-icon\", \"on-color\", \"modelValue\"]))\n              }), 128))\n            ])\n          ]),\n          _: 2\n        }, 1024)\n      }), 64))\n    ]),\n    _: 1\n  }, 8, [\"modelValue\", \"style\"]))\n}\n}\n\n})","<template>\n  <v-expansion-panels\n    id=\"power-plant-filter-controls\"\n    multiple\n    v-model=\"openPanels\"\n    :style=\"cssVars\"\n  >\n    <div class=\"global-filters\">\n      <div>Power Plant Filters</div>\n      <v-btn\n        size=\"small\"\n        @click=\"() => {\n          openAllPanels();\n          handleGlobalSelect(true);\n        }\"\n      >All</v-btn>\n      <v-btn\n        size=\"small\"\n        @click=\"() => {\n          openAllPanels();\n          handleGlobalSelect(false);\n        }\"\n      >None</v-btn>\n    </div>\n    <v-expansion-panel\n      v-for=\"(category, index) in PLANT_CATEGORIES\"\n      :key=\"index\"\n    >\n      <template #title>\n        <div class=\"expansion-panel-title\">\n          <span>{{ category }}</span>\n          <span>\n            <v-btn\n              size=\"small\"\n              @click=\"() => {\n                openPanel(index); \n                handleCategoryGlobalSelect(category, true);\n              }\"\n              @click.stop\n            >All</v-btn>\n            <v-btn\n              size=\"small\"\n              @click=\"() => {\n                openPanel(index); \n                handleCategoryGlobalSelect(category, false);\n              }\"\n              @click.stop\n            >None</v-btn>\n          </span>\n        </div>\n      </template>\n      <template #text>\n        <div class=\"expansion-panel-text\">\n          <icon-checkbox\n            v-for=\"source in SOURCES_BY_CATEGORY[category]\"\n            :key=\"source\"\n            :label=\"source\"\n            :value=\"source\"\n            :on-icon=\"icons[source]\"\n            :off-icon=\"icons[source]\"\n            :on-color=\"POWER_PLANT_COLORS[source]\"\n            off-color=\"gray\"\n            v-model=\"selectedSources\"\n            density=\"compact\"\n            hide-details\n          >\n          </icon-checkbox>\n        </div>\n      </template>\n    </v-expansion-panel>\n  </v-expansion-panels>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch, onMounted } from \"vue\";\nimport type { LayerSpecification, Map } from \"maplibre-gl\";\n\nimport { \n  PrimSource,\n  RenewableSources,\n  TraditionalSources,\n} from \"@/assets/power_plants\";\n\nimport { POWER_PLANT_COLORS } from \"@/composables/addPowerPlants\";\n\nimport { setLayerVisibility } from \"@/maplibre_controls\";\n\ninterface Props {\n  map: Map;\n}\n\nconst props = defineProps<Props>();\n\nconst openPanels = ref<number[]>([]);\nconst columns = ref(2);\nconst minColumnWidthPx = 170;\n\nconst cssVars = computed(() => ({\n  \"--column-count\": columns.value, \n}));\n\nconst PLANT_CATEGORIES = [\"Renewables\", \"Fossil Fuels\", \"Other\"] as const;\ntype PlantCategory = typeof PLANT_CATEGORIES[number];\n\nconst selectedSources = ref<PrimSource[]>(Object.values(PrimSource));\n\nconst SOURCES_BY_CATEGORY: Record<PlantCategory, readonly PrimSource[]> = {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Renewables: RenewableSources,\n  \"Fossil Fuels\": TraditionalSources,\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  Other: Object.values(PrimSource).filter(source => \n    !((RenewableSources as unknown as PrimSource[]).includes(source) || \n      (TraditionalSources as unknown as PrimSource[]).includes(source))\n  ),\n};\n\nconst icons: Record<PrimSource, string> = {\n  batteries: \"mdi-battery-charging\",\n  biomass: \"mdi-campfire\",\n  coal: \"mdi-grill\",\n  geothermal: \"fa-earth-americas\",\n  hydroelectric: \"fa-droplet\",\n  \"natural gas\": \"mdi-gas-burner\",\n  nuclear: \"fa-atom\",\n  other: \"mdi-circle\",\n  petroleum: \"mdi-gas-station\",\n  \"pumped storage\": \"mdi-water-pump\",\n  solar: \"fa-solar-panel\",\n  wind: \"mdi-wind-power\",\n};\n\nfunction openPanel(index: number) {\n  if (!openPanels.value.includes(index)) {\n    openPanels.value.push(index);\n  }\n}\n\nfunction openAllPanels() {\n  openPanels.value = [...PLANT_CATEGORIES.keys()];\n}\n\n// function updateSelectedSources(source: PrimSource, value: boolean) {\n//   console.log(\"updating\");\n//   const index = selectedSources.value.indexOf(source);\n//   if (value && index === -1) {\n//     selectedSources.value = [...selectedSources.value, source];\n//   } else if (!value && index >= 0) {\n//     selectedSources.value = selectedSources.value.slice(0, index).concat(selectedSources.value.slice(index + 1));\n//   }\n// }\n\nfunction turnOnPowerPlants() {\n  setLayerVisibility(props.map, \"power-plants-layer\", true);\n}\n\nfunction handleGlobalSelect(value: boolean) {\n  selectedSources.value = value ? [...Object.values(PrimSource)] : [];\n  turnOnPowerPlants();\n}\n\nfunction handleCategoryGlobalSelect(category: PlantCategory, value: boolean) {\n  if (value) {\n    // We could update the ref directly and use a deep watcher, but we don't need\n    // to trigger UI updates on each push here - better to do it all at the end\n    const sources = [...selectedSources.value];\n    SOURCES_BY_CATEGORY[category].forEach(source => {\n      if (!sources.includes(source)) {\n        sources.push(source);\n      }\n    });\n    selectedSources.value = sources;\n  } else {\n    selectedSources.value = selectedSources.value.filter(item => !SOURCES_BY_CATEGORY[category].includes(item));\n  }\n  turnOnPowerPlants();\n}\n\nlet layers: LayerSpecification[] = [];\n\nfunction onLayersChanged(newLayers: LayerSpecification[]) {\n  layers = newLayers;\n  applyPrimSourceFilter(selectedSources.value);\n}\n\nfunction updateColumnCount() {\n  const container = document.querySelector(\"#power-plant-filter-controls\");\n  if (container) {\n    columns.value = Math.max(Math.floor(container.clientWidth / minColumnWidthPx), 1);\n  }\n}\n\n\nonMounted(() => {\n\n  updateColumnCount();\n  const container = document.querySelector(\"#power-plant-filter-controls\");\n  if (container) {\n    const observer = new ResizeObserver(_entries => updateColumnCount());\n    observer.observe(container);\n  }\n\n  props.map.on(\"styledata\", () => {\n    // check if layers changed\n    // console.log('Style data event received');\n    const newLayerIds = new Set((props.map.getStyle().layers || []).map(l => l.id));\n    const oldLayerIds = new Set(layers.map(l => l.id));\n    const hasNewLayers = newLayerIds.size !== oldLayerIds.size || [...newLayerIds].some(id => !oldLayerIds.has(id));\n    if (hasNewLayers) {\n      // console.log('Style data changed, updating layer list');\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n    // check layer visibility changes\n    const visibilityChanged = layers.some(oldLayer => {\n      const newLayer = props.map.getStyle().layers?.find(l => l.id === oldLayer.id);\n      return newLayer && oldLayer.layout?.visibility !== newLayer.layout?.visibility;\n    });\n    if (visibilityChanged) {\n      onLayersChanged(props.map.getStyle().layers || []);\n    }\n  });\n\n  applyPrimSourceFilter(selectedSources.value);\n});\n\nwatch(selectedSources, (sources: PrimSource[]) => {\n  applyPrimSourceFilter(sources);\n  turnOnPowerPlants();\n});\n\nfunction applyPrimSourceFilter(sources: PrimSource[]) {\n  const layerIds = [\"power-plants-layer\", \"power-plants-heatmap\"];\n  layerIds.forEach(id => {\n    if (!props.map.getLayer(id)) { return; }\n  \n    if (sources.length === 0) {\n      props.map.setFilter(id, false);\n    } else if (sources.length === Object.values(PrimSource).length) {\n      props.map.setFilter(id, null);\n    } else {\n      props.map.setFilter(id, [\"in\", [\"get\", \"PrimSource\"], [\"literal\", sources]]);\n    }\n  });\n}\n</script>\n\n<style scoped lang=\"less\">\n#power-plant-filter-controls {\n  border-radius: 5px;\n  margin: 5px;\n  width: unset;\n}\n\n.global-filters {\n  padding: 5px 0;\n}\n\n.expansion-panel-title {\n  display: flex;\n  align-items: center;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n\n.expansion-panel-text {\n  display: grid;\n  grid-template-columns: repeat(var(--column-count), 1fr);\n}\n</style>\n","import script from \"./PowerPlantsFilterControl.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PowerPlantsFilterControl.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PowerPlantsFilterControl.vue?vue&type=style&index=0&id=5032d522&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5032d522\"]])\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, normalizeClass as _normalizeClass, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, mergeProps as _mergeProps } from \"vue\"\n\nexport interface IconCheckboxProps {\n  value: string;\n  onIcon: string;\n  offIcon: string;\n  onColor?: string;\n  offColor?: string;\n  label: string;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'IconCheckbox',\n  props: /*@__PURE__*/_mergeModels({\n    value: {},\n    onIcon: {},\n    offIcon: {},\n    onColor: { default: \"white\" },\n    offColor: { default: \"gray\" },\n    label: {}\n  }, {\n    \"modelValue\": {},\n    \"modelModifiers\": {},\n  }),\n  emits: [\"update:modelValue\"],\n  setup(__props: any) {\n\nconst modelValue = _useModel(__props, \"modelValue\");\nconst props = __props;\n\nfunction update() {\n  if (typeof modelValue.value === \"boolean\") {\n    modelValue.value = !modelValue.value;\n  } else { // it's an array\n    const index = modelValue.value.indexOf(props.value);\n    if (index >= 0) {\n      modelValue.value = modelValue.value.slice(0, index).concat(modelValue.value.slice(index + 1));\n    } else {\n      modelValue.value = [...modelValue.value, props.value];\n    }\n  }\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_font_awesome_icon = _resolveComponent(\"font-awesome-icon\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\")!\n\n  return (_openBlock(), _createBlock(_component_v_checkbox, _mergeProps({\n    modelValue: modelValue.value,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((modelValue).value = $event)),\n    value: __props.value\n  }, props), {\n    label: _withCtx(() => [\n      _createElementVNode(\"span\", {\n        onClick: _cache[0] || (_cache[0] = () => update())\n      }, _toDisplayString(__props.label), 1)\n    ]),\n    input: _withCtx(({ model }) => [\n      ((model.value ? __props.onIcon : __props.offIcon)?.startsWith('fa-'))\n        ? (_openBlock(), _createBlock(_component_font_awesome_icon, {\n            key: 0,\n            icon: model.value ? __props.onIcon : __props.offIcon,\n            class: _normalizeClass(['fa-icon', model.value ? 'icon-checkbox--checked' : '']),\n            color: model.value ? __props.onColor : __props.offColor,\n            onClick: ($event: any) => (model.value = !model.value)\n          }, null, 8, [\"icon\", \"class\", \"color\", \"onClick\"]))\n        : (_openBlock(), _createBlock(_component_v_icon, {\n            key: 1,\n            class: _normalizeClass(['md-icon', model.value ? 'icon-checkbox--checked' : '']),\n            color: model.value ? __props.onColor : __props.offColor,\n            onClick: ($event: any) => (model.value = !model.value)\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(model ? __props.onIcon : __props.offIcon), 1)\n            ]),\n            _: 2\n          }, 1032, [\"class\", \"color\", \"onClick\"]))\n    ]),\n    _: 1\n  }, 16, [\"modelValue\", \"value\"]))\n}\n}\n\n})","<template>\n  <v-checkbox\n    v-model=\"modelValue\"\n    :value=\"value\"\n    v-bind=\"props\"\n  >\n    <template #label>\n      <span @click=\"() => update()\">\n        {{ label }}\n      </span>\n    </template>\n    <template #input=\"{ model }\">\n      <!-- Using <component :is=\"...\"/> didn't work with v-icon for some reason -->\n      <font-awesome-icon\n          v-if=\"(model.value ? onIcon : offIcon)?.startsWith('fa-')\"\n          :icon=\"model.value ? onIcon : offIcon\"\n          :class=\"['fa-icon', model.value ? 'icon-checkbox--checked' : '']\"\n          :color=\"model.value ? onColor : offColor\"\n          @click=\"model.value = !model.value\"\n        ></font-awesome-icon>\n        <v-icon\n          v-else\n          :class=\"['md-icon', model.value ? 'icon-checkbox--checked' : '']\"\n          :color=\"model.value ? onColor : offColor\"\n          @click=\"model.value = !model.value\"\n        >{{ model ? onIcon : offIcon }}\n      </v-icon>\n    </template>\n  </v-checkbox>\n</template>\n\n<script setup lang=\"ts\">\nexport interface IconCheckboxProps {\n  value: string;\n  onIcon: string;\n  offIcon: string;\n  onColor?: string;\n  offColor?: string;\n  label: string;\n}\n\nconst modelValue = defineModel();\nconst props = withDefaults(defineProps<IconCheckboxProps>(), {\n  onColor: \"white\",\n  offColor: \"gray\",\n});\n\nfunction update() {\n  if (typeof modelValue.value === \"boolean\") {\n    modelValue.value = !modelValue.value;\n  } else { // it's an array\n    const index = modelValue.value.indexOf(props.value);\n    if (index >= 0) {\n      modelValue.value = modelValue.value.slice(0, index).concat(modelValue.value.slice(index + 1));\n    } else {\n      modelValue.value = [...modelValue.value, props.value];\n    }\n  }\n}\n</script>\n\n<style scoped>\n.icon-checkbox--checked {\n  filter: drop-shadow(0 0 2px rgb(var(--v-theme-on-surface)));\n}\n</style>\n","import script from \"./IconCheckbox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./IconCheckbox.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./IconCheckbox.vue?vue&type=style&index=0&id=3ce6dab7&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3ce6dab7\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, unref as _unref, mergeProps as _mergeProps, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"icon-row\" }\nconst _hoisted_2 = { class: \"icon-row\" }\n\nimport { storeToRefs } from \"pinia\";\nimport { type TempoStore, useTempoStore, serializeTempoStore, updateStoreFromJSON } from \"@/stores/app\";\n\ntype OpType = \"save\" | \"load\";\ntype Target = \"local\" | \"google-drive\";\ntype EventType = `${OpType}-${Target}`;\n\nconst DEFAULT_FILENAME = \"tempo_lab.json\";\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'SaveState',\n  emits: [\"save-local\", \"load-local\", \"save-google-drive\", \"load-google-drive\", \"error\"],\n  setup(__props, { emit: __emit }) {\n\nconst store = useTempoStore();\n\nconst {\n  accentColor\n} = storeToRefs(store);\n\nconst emit = __emit;\n\nasync function saveLocalFileSystemAPI(store: TempoStore): Promise<boolean> {\n  const options = {\n    suggestedName: DEFAULT_FILENAME,\n    types: [\n      {\n        description: \"JSON\",\n        accept: { \"application/json\": [\".json\"] },\n      }\n    ],\n    multiple: false,\n  };\n\n  const content = serializeTempoStore(store);\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore window *might* have this, and if we're here it should\n  return window.showSaveFilePicker(options)\n    .then((handle: FileSystemFileHandle) => handle.createWritable())\n    .then((stream: FileSystemWritableFileStream) => {\n      stream.write(content);\n      stream.close();\n      return true;\n    })\n    .catch((error: Error) => {\n      if (error instanceof DOMException) { return false; }\n      emit(\"error\", \"save-local\", error.message);\n      return false;\n    });\n\n}\n\nfunction saveLocalLink(store: TempoStore) {\n  const content = serializeTempoStore(store);\n\n  const blob = new Blob([content], { type: \"application/json\" });\n  const link = document.createElement(\"a\");\n  link.href = URL.createObjectURL(blob);\n  link.download = DEFAULT_FILENAME;\n  document.body.appendChild(link);\n  link.click();\n\n  document.body.removeChild(link);\n  URL.revokeObjectURL(link.href);\n\n  return true;\n}\n\nasync function saveLocal() {\n  let result = false;\n  if ('showSaveFilePicker' in window) {\n    result = await saveLocalFileSystemAPI(store);\n  } else {\n    result = saveLocalLink(store);\n  }\n  if (result) {\n    emit(\"save-local\");\n  }\n}\n\nasync function loadLocalFileSystemAPI(): Promise<boolean> {\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore window *might* have this, and if we're here it should\n  const handles: FileSystemFileHandle[] = await window.showOpenFilePicker();\n  if (handles.length === 0) {\n    return false;\n  }\n\n  const handle = handles[0];\n  const file = await handle.getFile();\n  const content = await file.text();\n\n  const result = updateStoreFromJSON(store, content);\n  if (result) {\n    return true;\n  } else {\n    emit(\"error\", \"load-local\", \"Error loading TEMPO Lab state from local file\");\n    return false;\n  }\n}\n\nfunction loadLocalInput() {\n  const input = document.createElement(\"input\");\n  input.type = \"file\";\n\n  input.addEventListener(\"change\", function (event) {\n    const element = event.target as HTMLInputElement;\n    const files = element.files;\n    if (files && files.length > 0) {\n      const file = files[0];\n      const reader = new FileReader();\n      reader.onload = function (evt) {\n        if (!evt || !evt.target) { return; }\n        const content = evt.target.result as string;\n        const result = updateStoreFromJSON(store, content);\n        if (result) {\n          emit(\"load-local\");\n        } else {\n          emit(\"error\", \"load-local\", \"Error loading TEMPO Lab state from local file\");\n        }\n      };\n      reader.readAsText(file);\n    }\n  });\n\n  input.click();\n}\n\nasync function loadLocal() {\n  let result = false;\n  if ('showOpenFilePicker' in window) {\n    result = await loadLocalFileSystemAPI();\n    if (result) {\n      emit(\"load-local\");\n    }\n  } else {\n    loadLocalInput();\n  }\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\")!\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_card = _resolveComponent(\"v-card\")!\n\n  return (_openBlock(), _createBlock(_component_v_card, { class: \"save-state\" }, {\n    default: _withCtx(() => [\n      _createVNode(_component_v_toolbar, {\n        density: \"compact\",\n        color: \"var(--info-background)\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_v_toolbar_title, { text: \"Save and Load\" })\n        ]),\n        _: 1\n      }),\n      _createElementVNode(\"div\", _hoisted_1, [\n        _cache[2] || (_cache[2] = _createElementVNode(\"h3\", null, \"Save to:\", -1)),\n        _createVNode(_component_v_tooltip, {\n          location: \"top\",\n          text: \"Save to local file\"\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createVNode(_component_v_icon, _mergeProps(props, {\n              icon: \"mdi-file\",\n              color: _unref(accentColor),\n              onClick: _cache[0] || (_cache[0] = () => saveLocal())\n            }), null, 16, [\"color\"])\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_v_tooltip, {\n          location: \"top\",\n          text: \"Coming soon!\"\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createElementVNode(\"span\", _normalizeProps(_guardReactiveProps(props)), [\n              _createVNode(_component_v_icon, {\n                icon: \"mdi-google-drive\",\n                color: _unref(accentColor),\n                disabled: \"\"\n              }, null, 8, [\"color\"])\n            ], 16)\n          ]),\n          _: 1\n        })\n      ]),\n      _createElementVNode(\"div\", _hoisted_2, [\n        _cache[3] || (_cache[3] = _createElementVNode(\"h3\", null, \"Open saved state:\", -1)),\n        _createVNode(_component_v_tooltip, {\n          location: \"top\",\n          text: \"Load from local file\"\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createVNode(_component_v_icon, _mergeProps(props, {\n              icon: \"mdi-file\",\n              color: _unref(accentColor),\n              onClick: _cache[1] || (_cache[1] = () => loadLocal())\n            }), null, 16, [\"color\"])\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_v_tooltip, {\n          location: \"top\",\n          text: \"Coming soon!\"\n        }, {\n          activator: _withCtx(({ props }) => [\n            _createElementVNode(\"span\", _normalizeProps(_guardReactiveProps(props)), [\n              _createVNode(_component_v_icon, {\n                icon: \"mdi-google-drive\",\n                color: _unref(accentColor),\n                disabled: \"\"\n              }, null, 8, [\"color\"])\n            ], 16)\n          ]),\n          _: 1\n        })\n      ])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n  <v-card class=\"save-state\">\n    <v-toolbar\n      density=\"compact\"\n      color=\"var(--info-background)\"\n    >\n      <v-toolbar-title text=\"Save and Load\"></v-toolbar-title>\n    </v-toolbar>\n    <div class=\"icon-row\">\n      <h3>Save to:</h3>\n      <v-tooltip\n        location=\"top\"\n        text=\"Save to local file\"\n      >\n      <template #activator=\"{ props }\">\n          <v-icon\n            v-bind=\"props\"\n            icon=\"mdi-file\"\n            :color=\"accentColor\"\n            @click=\"() => saveLocal()\"\n          />\n        </template>\n      </v-tooltip>\n      <v-tooltip\n        location=\"top\"\n        text=\"Coming soon!\"\n      >\n        <template #activator=\"{ props }\">\n          <span v-bind=\"props\">\n            <v-icon\n              icon=\"mdi-google-drive\"\n              :color=\"accentColor\"\n              disabled\n            />\n          </span>\n        </template>\n      </v-tooltip>\n    </div>\n    <div class=\"icon-row\">\n      <h3>Open saved state:</h3>\n      <v-tooltip\n        location=\"top\"\n        text=\"Load from local file\"\n      >\n        <template #activator=\"{ props }\">\n          <v-icon\n            v-bind=\"props\"\n            icon=\"mdi-file\"\n            :color=\"accentColor\"\n            @click=\"() => loadLocal()\"\n          />\n        </template>\n      </v-tooltip>\n      <v-tooltip\n        location=\"top\"\n        text=\"Coming soon!\"\n      >\n        <template #activator=\"{ props }\">\n          <span v-bind=\"props\">\n            <v-icon\n              icon=\"mdi-google-drive\"\n              :color=\"accentColor\"\n              disabled\n            />\n          </span>\n        </template>\n      </v-tooltip>\n    </div>\n  </v-card>\n</template>\n\n\n<script setup lang=\"ts\">\nimport { storeToRefs } from \"pinia\";\nimport { type TempoStore, useTempoStore, serializeTempoStore, updateStoreFromJSON } from \"@/stores/app\";\n\nconst store = useTempoStore();\n\nconst {\n  accentColor\n} = storeToRefs(store);\n\ntype OpType = \"save\" | \"load\";\ntype Target = \"local\" | \"google-drive\";\ntype EventType = `${OpType}-${Target}`;\n\nconst emit = defineEmits<{\n  (event: \"save-local\"): void;\n  (event: \"load-local\"): void;\n  (event: \"save-google-drive\"): void;\n  (event: \"load-google-drive\"): void;\n  (event: \"error\", type: EventType, message: string): void;\n}>();\n\nconst DEFAULT_FILENAME = \"tempo_lab.json\";\n\nasync function saveLocalFileSystemAPI(store: TempoStore): Promise<boolean> {\n  const options = {\n    suggestedName: DEFAULT_FILENAME,\n    types: [\n      {\n        description: \"JSON\",\n        accept: { \"application/json\": [\".json\"] },\n      }\n    ],\n    multiple: false,\n  };\n\n  const content = serializeTempoStore(store);\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore window *might* have this, and if we're here it should\n  return window.showSaveFilePicker(options)\n    .then((handle: FileSystemFileHandle) => handle.createWritable())\n    .then((stream: FileSystemWritableFileStream) => {\n      stream.write(content);\n      stream.close();\n      return true;\n    })\n    .catch((error: Error) => {\n      if (error instanceof DOMException) { return false; }\n      emit(\"error\", \"save-local\", error.message);\n      return false;\n    });\n\n}\n\nfunction saveLocalLink(store: TempoStore) {\n  const content = serializeTempoStore(store);\n\n  const blob = new Blob([content], { type: \"application/json\" });\n  const link = document.createElement(\"a\");\n  link.href = URL.createObjectURL(blob);\n  link.download = DEFAULT_FILENAME;\n  document.body.appendChild(link);\n  link.click();\n\n  document.body.removeChild(link);\n  URL.revokeObjectURL(link.href);\n\n  return true;\n}\n\nasync function saveLocal() {\n  let result = false;\n  if ('showSaveFilePicker' in window) {\n    result = await saveLocalFileSystemAPI(store);\n  } else {\n    result = saveLocalLink(store);\n  }\n  if (result) {\n    emit(\"save-local\");\n  }\n}\n\nasync function loadLocalFileSystemAPI(): Promise<boolean> {\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore window *might* have this, and if we're here it should\n  const handles: FileSystemFileHandle[] = await window.showOpenFilePicker();\n  if (handles.length === 0) {\n    return false;\n  }\n\n  const handle = handles[0];\n  const file = await handle.getFile();\n  const content = await file.text();\n\n  const result = updateStoreFromJSON(store, content);\n  if (result) {\n    return true;\n  } else {\n    emit(\"error\", \"load-local\", \"Error loading TEMPO Lab state from local file\");\n    return false;\n  }\n}\n\nfunction loadLocalInput() {\n  const input = document.createElement(\"input\");\n  input.type = \"file\";\n\n  input.addEventListener(\"change\", function (event) {\n    const element = event.target as HTMLInputElement;\n    const files = element.files;\n    if (files && files.length > 0) {\n      const file = files[0];\n      const reader = new FileReader();\n      reader.onload = function (evt) {\n        if (!evt || !evt.target) { return; }\n        const content = evt.target.result as string;\n        const result = updateStoreFromJSON(store, content);\n        if (result) {\n          emit(\"load-local\");\n        } else {\n          emit(\"error\", \"load-local\", \"Error loading TEMPO Lab state from local file\");\n        }\n      };\n      reader.readAsText(file);\n    }\n  });\n\n  input.click();\n}\n\nasync function loadLocal() {\n  let result = false;\n  if ('showOpenFilePicker' in window) {\n    result = await loadLocalFileSystemAPI();\n    if (result) {\n      emit(\"load-local\");\n    }\n  } else {\n    loadLocalInput();\n  }\n}\n</script>\n\n<style scoped>\n.save-state {\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n\n.icon-row {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 5px;\n  padding: 5px;\n}\n</style>\n","import script from \"./SaveState.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SaveState.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SaveState.vue?vue&type=style&index=0&id=23d4bf8a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-23d4bf8a\"]])\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, mergeProps as _mergeProps, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = { class: \"open-close-container\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"content\"\n}\nconst _hoisted_3 = {\n  key: 1,\n  class: \"placeholder-content\"\n}\n\nimport { computed } from \"vue\";\n\ninterface Props {\n  openDirection: \"left\" | \"right\";\n  icon: string;\n  color?: string;\n  openArrowColor?: string;\n  closedArrowColor?: string;\n  tooltips?: boolean;\n  openTooltipText?: string | undefined;\n  closedTooltipText?: string | undefined;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'SidePlaceholder',\n  props: /*@__PURE__*/_mergeModels({\n    openDirection: {},\n    icon: {},\n    color: { default: \"white\" },\n    openArrowColor: { default: \"gray\" },\n    closedArrowColor: { default: \"gray\" },\n    tooltips: { type: Boolean, default: false },\n    openTooltipText: { default: undefined },\n    closedTooltipText: { default: undefined }\n  }, {\n    \"open\": { type: Boolean, ...{ type: Boolean, default: false } },\n    \"openModifiers\": {},\n  }),\n  emits: [\"update:open\"],\n  setup(__props: any) {\n\nconst props = __props;\nconst open = _useModel<boolean>(__props, \"open\");\nconst closeDirection = computed(() => props.openDirection === \"left\" ? \"right\" : \"left\");\nconst openIcon = computed(() => `mdi-chevron-double-${closeDirection.value}`);\nconst closedIcon = computed(() => `mdi-chevron-double-${props.openDirection}`);\n\nfunction toggleOpen() {\n  open.value = !open.value;\n}\n\nconst cssVars = computed(() => ({\n  \"--icon-alignment\": props.openDirection == \"left\" ? \"start\" : \"end\",\n}));\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_v_tooltip = _resolveComponent(\"v-tooltip\")!\n  const _component_v_slide_x_transition = _resolveComponent(\"v-slide-x-transition\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass(['side-panel-control', open.value ? 'open' : 'closed']),\n    style: _normalizeStyle(cssVars.value)\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createVNode(_component_v_tooltip, {\n        disabled: !__props.tooltips,\n        text: open.value ? __props.openTooltipText : __props.closedTooltipText\n      }, {\n        activator: _withCtx(({ props }) => [\n          _createVNode(_component_v_icon, _mergeProps(props, {\n            color: open.value ? __props.openArrowColor : __props.closedArrowColor,\n            class: \"open-close-icon\",\n            onClick: _cache[0] || (_cache[0] = ($event: any) => (toggleOpen()))\n          }), {\n            default: _withCtx(() => [\n              _createTextVNode(_toDisplayString(open.value ? openIcon.value : closedIcon.value), 1)\n            ]),\n            _: 1\n          }, 16, [\"color\"])\n        ]),\n        _: 1\n      }, 8, [\"disabled\", \"text\"]),\n      _cache[2] || (_cache[2] = _createElementVNode(\"hr\", null, null, -1))\n    ]),\n    _createVNode(_component_v_slide_x_transition, { class: \"content-container\" }, {\n      default: _withCtx(() => [\n        (open.value)\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n              _renderSlot(_ctx.$slots, \"default\")\n            ]))\n          : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n              _createVNode(_component_v_tooltip, {\n                disabled: !__props.tooltips,\n                text: open.value ? __props.openTooltipText : __props.closedTooltipText\n              }, {\n                activator: _withCtx(({ props }) => [\n                  _createVNode(_component_v_icon, _mergeProps({ class: \"content-icon\" }, { ...props, icon: __props.icon }, {\n                    color: __props.color,\n                    onClick: _cache[1] || (_cache[1] = ($event: any) => (toggleOpen())),\n                    size: \"large\"\n                  }), null, 16, [\"color\"])\n                ]),\n                _: 1\n              }, 8, [\"disabled\", \"text\"])\n            ]))\n      ]),\n      _: 3\n    })\n  ], 6))\n}\n}\n\n})","<template>\n  <div\n    :class=\"['side-panel-control', open ? 'open' : 'closed']\"\n    :style=\"cssVars\"\n  >\n    <div class=\"open-close-container\">\n      <v-tooltip\n        :disabled=\"!tooltips\"\n        :text=\"open ? openTooltipText : closedTooltipText\"\n      >\n        <template #activator=\"{ props }\">\n          <v-icon\n            v-bind=\"props\"\n            :color=\"open ? openArrowColor : closedArrowColor\"\n            class=\"open-close-icon\"\n            @click=\"toggleOpen()\"\n          >\n            {{ open ? openIcon : closedIcon }}\n          </v-icon>\n        </template>\n      </v-tooltip>\n      <hr />\n    </div>\n    <v-slide-x-transition class=\"content-container\">\n      <div v-if=\"open\" class=\"content\">\n        <slot></slot>\n      </div>\n      <div class=\"placeholder-content\" v-else>\n        <v-tooltip\n          :disabled=\"!tooltips\"\n          :text=\"open ? openTooltipText : closedTooltipText\"\n        >\n          <template #activator=\"{ props }\">\n            <v-icon\n              class=\"content-icon\"\n              v-bind=\"{ ...props, icon }\"\n              :color=\"color\"\n              @click=\"toggleOpen()\"\n              size=\"large\"\n            >\n            </v-icon>\n        </template>\n      </v-tooltip>\n      </div>\n    </v-slide-x-transition>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from \"vue\";\n\ninterface Props {\n  openDirection: \"left\" | \"right\";\n  icon: string;\n  color?: string;\n  openArrowColor?: string;\n  closedArrowColor?: string;\n  tooltips?: boolean;\n  openTooltipText?: string | undefined;\n  closedTooltipText?: string | undefined;\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  color: \"white\",\n  openArrowColor: \"gray\",\n  closedArrowColor: \"gray\",\n  tooltips: false,\n  openTooltipText: undefined,\n  closedTooltipText: undefined,\n});\nconst open = defineModel<boolean>(\"open\", { type: Boolean, default: false });\nconst closeDirection = computed(() => props.openDirection === \"left\" ? \"right\" : \"left\");\nconst openIcon = computed(() => `mdi-chevron-double-${closeDirection.value}`);\nconst closedIcon = computed(() => `mdi-chevron-double-${props.openDirection}`);\n\nfunction toggleOpen() {\n  open.value = !open.value;\n}\n\nconst cssVars = computed(() => ({\n  \"--icon-alignment\": props.openDirection == \"left\" ? \"start\" : \"end\",\n}));\n</script>\n\n<style scoped lang=\"less\">\n.side-panel-control {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n  padding: 0;\n\n  &.closed::-webkit-scrollbar {\n    display: none;\n  }\n}\n\nhr {\n  background: white;\n  margin: auto;\n  width: 100%;\n}\n\n.open-close-container {\n  display: flex;\n  background: #222222;\n  flex-direction: column;\n\n  .open-close-icon {\n    align-self: var(--icon-alignment);\n  }\n}\n\n.content-container {\n  margin-top: 10px;\n}\n\n.placeholder-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n</style>\n","import script from \"./SidePlaceholder.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SidePlaceholder.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SidePlaceholder.vue?vue&type=style&index=0&id=8e10aad6&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8e10aad6\"]])\n\nexport default __exports__","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport Vue, { createApp } from \"vue\";\n\nimport { LocalScope } from \"@all1ndev/vue-local-scope\";\n\nimport { FundingAcknowledgement, IconButton, CreditLogos } from \"@cosmicds/vue-toolkit\";\nimport LocationSearch from \"./components/LocationSearch.vue\";\nimport TempoLab from \"./TempoLab.vue\";\nimport Colorbar from './components/ColorBar.vue';\nimport ColorBarHorizontal from \"./components/ColorBarHorizontal.vue\";\nimport InfoButton from \"./components/InfoButton.vue\";\nimport vuetify from \"../plugins/vuetify\";\nimport SnackbarAlert from \"./components/SnackbarAlert.vue\";\nimport ShareButton from \"./components/ShareButton.vue\";\nimport CDSDialog from \"./components/CDSDialog.vue\";\nimport MarqeeAlert from \"./components/MarqeeAlert.vue\";\nimport TimeseriesGraph from \"./components/TimeseriesGraph.vue\";\nimport SelectionComposer from \"./components/SelectionComposer.vue\";\nimport HeaderBar from \"./components/HeaderBar.vue\";\nimport DatasetControls from \"./components/DatasetControls.vue\";\nimport ComparisonDataControls from \"./components/ComparisonDataControls.vue\";\nimport MapControls from \"./components/MapControls.vue\";\nimport MapWithControls from \"./components/MapWithControls.vue\";\nimport PopupInfoButton from \"./components/PopupInfoButton.vue\";\nimport LayerOrderControl from \"./components/LayerOrderControl.vue\";\nimport MaplibreLayerControlItem from \"./components/MaplibreLayerControlItem.vue\";\nimport PowerPlantsFilterControl from \"./components/PowerPlantsFilterControl.vue\";\nimport IconCheckbox from \"./components/IconCheckbox.vue\";\nimport SaveState from \"./components/SaveState.vue\";\nimport SidePlaceholder from \"./components/SidePlaceholder.vue\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport {\n  faBookOpen,\n  faPlay,\n  faPause,\n  faTimes,\n  faVideo,\n  faMagnifyingGlass,\n  faCircleXmark,\n  faSquareXmark,\n  faHome,\n  faSolarPanel,\n  faDroplet,\n  faEarthAmericas,\n  faAtom,\n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { VueDatePicker } from \"@vuepic/vue-datepicker\";\nimport '@vuepic/vue-datepicker/dist/main.css';\nimport \"./styles/vue3-date-picker-styles.css\";\nimport \"./styles/molecule-svg.css\";\nimport \"./styles/styles.css\";\nimport { UseClipboard } from \"@vueuse/components\";\n\nimport { createPinia } from \"pinia\";\n\nlibrary.add(faBookOpen);\nlibrary.add(faPlay);\nlibrary.add(faPause);\nlibrary.add(faTimes);\nlibrary.add(faVideo);\nlibrary.add(faMagnifyingGlass);\nlibrary.add(faCircleXmark);\nlibrary.add(faSquareXmark);\nlibrary.add(faHome);\nlibrary.add(faSolarPanel);\nlibrary.add(faDroplet);\nlibrary.add(faEarthAmericas);\nlibrary.add(faAtom);\n\n// TODO: This doesn't work. Why??\n// import \"golden-layout/dist/css/goldenlayout-base.css\";\n// import \"golden-layout/dist/css/themes/goldenlayout-dark-theme.css\";\n\n/** v-hide directive taken from https://www.ryansouthgate.com/2020/01/30/vue-js-v-hide-element-whilst-keeping-occupied-space/ */\n// Extract the function out, up here, so I'm not writing it twice\nconst update = (el: HTMLElement, binding: Vue.DirectiveBinding) => el.style.visibility = (binding.value) ? \"hidden\" : \"\";\n\nconst pinia = createPinia();\n\ncreateApp(TempoLab, {})\n\n  // Plugins\n  .use(vuetify)\n  .use(pinia)\n\n  // Directives\n  .directive(\n    /**\n    * Hides an HTML element, keeping the space it would have used if it were visible (css: Visibility)\n    */\n    \"hide\", {\n      // Run on initialisation (first render) of the directive on the element\n      beforeMount(el, binding, _vnode, _prevVnode) {\n        update(el, binding);\n      },\n      // Run on subsequent updates to the value supplied to the directive\n      updated(el, binding, _vnode, _prevVnode) {\n        update(el, binding);\n      }\n    })\n\n  // Components\n  .component('font-awesome-icon', FontAwesomeIcon)\n  .component('icon-button', IconButton)\n  .component('funding-acknowledgement', FundingAcknowledgement)\n  .component('credit-logos', CreditLogos)\n  .component('colorbar', Colorbar)\n  .component('location-search', LocationSearch)\n  .component('info-button', InfoButton)\n  .component('colorbar-horizontal', ColorBarHorizontal)\n  .component('date-picker', VueDatePicker)\n  .component('use-clipboard', UseClipboard as Vue.Component)\n  .component('snackbar-alert', SnackbarAlert)\n  .component('share-button', ShareButton)\n  .component('cds-dialog', CDSDialog)\n  .component('marquee-alert', MarqeeAlert)\n  .component('timeseries-graph', TimeseriesGraph)\n  .component('selection-composer', SelectionComposer)\n  .component('dataset-controls', DatasetControls)\n  .component('comparison-data-controls', ComparisonDataControls)\n  .component('map-controls', MapControls)\n  .component('map-with-controls', MapWithControls)\n  .component('header-bar', HeaderBar)\n  .component('popup-info-button', PopupInfoButton)\n  .component('layer-control-item', MaplibreLayerControlItem)\n  .component('layer-order-control', LayerOrderControl)\n  .component('power-plants-filter-control', PowerPlantsFilterControl)\n  .component('icon-checkbox', IconCheckbox)\n  .component('local-scope', LocalScope)\n  .component('save-state', SaveState)\n  .component('side-placeholder', SidePlaceholder)\n\n  // Mount\n  .mount(\"#app\");\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunk_cosmicds_tempo_lab\"] = self[\"webpackChunk_cosmicds_tempo_lab\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], () => (__webpack_require__(3464)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["RenewableSource","TraditionalSource","PrimSource","Source","State","SectorName","TraditionalSources","Coal","NaturalGas","Petroleum","RenewableSources","Biomass","Geothermal","Hydroelectric","Solar","Wind","powerPlants","powerPlantsGeoJSON","type","features","map","plant","geometry","coordinates","Longitude","Latitude","properties","render","_ctx","_cache","$props","$setup","$data","$options","_component_font_awesome_icon","class","style","cssStyles","locationJustUpdated","small","modelValue","searchText","$event","setLocationFromSearchFeature","items","searchResults","textForMapboxFeature","bgColor","label","density","solo","color","accentColor","performForwardGeocodingSearch","searchErrorMessage","focusCombobox","onFocusChange","ref","menu","menuOpen","append","icon","size","searchOpen","buttonSize","toggleSearch","closeSearch","stayOpen","_","RELEVANT_FEATURE_TYPES","NA_COUNTRIES","NA_ABBREVIATIONS","feature","pieces","text","push","context","forEach","item","itemType","id","split","includes","shortCode","short_code","some","abbr","startsWith","substring","itemText","join","name","emits","props","searchProvider","Function","default","Boolean","required","String","theme","persistSelected","data","this","locationUpdatedText","comboFocused","computed","methods","console","log","length","then","info","$emit","focused","blurCombobox","input","$refs","searchInput","blur","focus","undefined","place_name","slice","timedJustUpdatedLocation","clearSearchData","setTimeout","watch","value","__exports__","isComputedRef","effect","magma","r","g","b","inferno","plasma","viridis","cividis","gray","svs_nitrogen_dioxide","svsColorRamp","sargassum","sargassumColorRamp","haline","colormap","esri","colormaps","nonEsriColormaps","rgb","esriColorRamp","_stretchRule","min","max","reverse","ResamplingTypeEnum","stretches","colorramps","rgbstretches","rgbcolorramps","colorbarOptions","stretch","rgbstretch","cbarScale","rgbcolormap","unit","_colorMapRule","colorRamp","Object","keys","toLowerCase","composeRasterRules","rules","Error","currentRule","i","nextOuterRule","rasterFunctionArguments","Raster","renderingRule","range","_resamplineRule","colormapName","endsWith","Math","fetchEsriTimeSteps","Promise","esriUrl","variableName","dimensionName","url","format","multidimensionalDefinition","params","f","JSON","stringify","fetchURL","URL","search","URLSearchParams","toString","fetch","res","json","extractTimeSteps","slices","timesteps","values","reduce","acc","val","Array","isArray","concat","ESRI_URLS_V03","variable","ESRI_URLS_V04","MOLECULE_OPTIONS","title","MOLECULE_NAMES","no2","fullName","html","shortName","shortUnit","o3","hcho","moleculeDescriptor","molecule","moleculeName","find","m","getEsriTimesteps","rectangleToGeometry","rect","xmin","ymin","xmax","ymax","rings","spatialReference","wkid","pointToGeometry","point","x","y","isBad","v","isNaN","nan2null","_getValidData","arr","validArr","sum","a","mean","nanmean","_arr","difference","diff","result","variance","diffs","stdev","sqrt","standardError","s","median","sorted","sort","mid","floor","nanmedian","mad","med","absDevs","abs","arrayMax","current","arrayMin","nanmin","returnIndex","idx","index","nanmax","sumOfSquares","meanOfSquares","rootMeanSquare","ms","arraysEqual","arr1","arr2","cycleIndex","cycle","serviceMetaData","metadata","serviceBounds","fullExtent","pixelXSize","pixelSizeX","pixelYSize","pixelSizeY","serviceXsize","serviceYsize","setGeometry","setMetadata","latSize","lonSize","getSampleDistance","sampleCount","geometryArea","getSampleCount","sampleDistance","calculateActualSampleCount","initialSampleCount","pixelSize","nx","round","geometryXsize","ny","geometryYsize","actualSampleCount","getSamplingSpecificationFromSamplingDistance","count","distance","lats","lons","getSamplingSpecificationFromSampleCount","permitOversampling","adjustedSampleCount","getSampleLocations","spec","delta","sign","j","getSampleLocationsGrid","locations","points","parseTimeString","timeString","lower","replace","hourRegex","minuteRegex","ampmRegex","ampmMatch","match","RegExp","source","hour","parseInt","minute","suffix","h","mm","formatTimeHHMM24","time","padStart","normalizeTimeRange","timeRangeStr","formatter","parts","p","trim","startParsed","endParsed","endEarlier","startStr","endStr","_normalizeTimes","normalized","parsed","filter","isLinearConsecutive","validDiffs","every","d","getIndices","order","indexOf","isRingConsecutive","newArr","indices","isL","consecutive","start","end","n","rolledOrder","shift","ind","DAYS","MONTHS","MS_IN_HOUR","MS_IN_DAY","DEFAULT_TOLERANCE","ALL_DAY_TOLERANCE","parcelLongRange","maxParcelSize","parcels","currentStart","currentEnd","parcelRanges","ranges","allParcels","parseTimeStringToHoursMinutes","timeStr","NaN","hours","minutes","genOneDayRange","date","Date","setUTCHours","getTime","genOneYearRange","setUTCMonth","genOneMonthRange","setUTCDate","getUTCMonth","mergeOverlappingOrConsecutiveRanges","adjacentOnly","merged","next","merge","genHoursForOneDay","times","toleranceMs","toleranceMsBefore","toleranceMsAfter","startHours","startMinutes","endHours","endMinutes","advanceDateToNextMonth","newDate","newMonth","advanceDateToNextYear","setUTCFullYear","getUTCFullYear","mergeConsecutiveRanges","shouldMerge","generatePatternedRanges","config","dateRange","temp","startDate","endDate","currentDate","filterOnTimes","filterOnWeekdays","weekdays","filterOnMonths","months","filterOnYears","years","needsFinerThanYears","needsFinerThanMonths","needsFinerThanWeekdays","currentYear","currentMonth","toLocaleDateString","month","timeZone","currentWeekday","weekday","toleranceHours","dailyRanges","getUTCDate","monthRange","yearRange","monthCheck","weekdayCheck","mergedRanges","generateTimeRanges","parcel","singleDate","shouldParcel","parcelSizeMs","parcelSize","dateInRange","validateTimePointRange","configuredTime","rangeStartDate","targetDate","targetTime","targetWithToleranceStart","targetWithToleranceEnd","within","validateTimeRangeSpec","configuredTimeRange","rangeStartTimeStr","toLocaleTimeString","hour12","rangeEndTimeStr","validateRanges","valid","errors","badRanges","startYear","endYear","startMonth","endMonth","startWeekday","endWeekday","matchesAnyTime","isValid","timezone","getOffsetMs","timestamp","offsetRange","utcRange","offsetMs","localStart","localEnd","offsetRanges","utcRanges","crossesDSTBoundary","startOffset","endOffset","splitRangeAtDSTBoundary","warn","offsetRangesWithDSTHandling","splitRanges","splitRange","_isRectBounds","emptyRawSampleData","timeRange","samples","totalSamples","geometryType","stats","httpStatus","httpStatusCode","status","statusCode","retried","now","safeParseNumber","parseFloat","delay","resolve","stringifyEsriGetSamplesParameters","mosaicRule","returnFirstValueOnly","interpolation","outFields","sliceID","options","t","metadataCache","_loadingMetadata","_getServiceMetadata","response","ok","catch","error","updateMetadataCache","getMetadata","withMetadataCache","waitForCache","timeInfo","timeExtent","extent","clippedToTimeExtent","serviceTimeRange","clipped","baseUrl","rateLimitMs","maxRetries503","_baseUrls","metas","Map","maxSamplesPerRequest","safetyMargin","parcelingMode","defaultParcelSize","availableTimestamps","dryRun","timestepsCache","_boundaries","metadataPromises","baseUrlArray","metaForUrl","err","all","timeBoundaries","boundaries","meta","has","set","ImageServiceServiceMetadata","get","_metaForTimeRange","selectBaseUrlForRange","overlaps","selectBaseUrlForTimestamp","fetchTimestepsForUrl","steps","getMergedTimesteps","allTimesteps","from","Set","flat","setVariable","getVariable","setRateLimit","setRetryLimit","retries","setMaxSamplesPerRequest","setSafetyMargin","margin","setParcelingMode","mode","getParcelingMode","setDefaultParcelSize","sizeMs","setAvailableTimestamps","timestamps","setDryRun","enabled","getDryRun","fetchSample","numRetries","skipRetry","esriGeometry","isRectBounds","urlWithParams","isDryRun","succeedAfter503","httpErrorMessage","code","errorMessage","message","details","wasRetried503","processedSamples","sample","attributes","location","StdTime","locationId","enhancedError","fetchSamples","timeRanges","parceledRanges","smartResult","smartParcelTimeRanges","expectedTotalSamples","splitParcelsAtVersionBoundaries","totalRanges","completedRanges","promises","tr","requestPromise","onProgress","results","validResults","requestStats","successCount","errorCountFromStats","missingStatsCount","failedCount","requestSummary","totalRequests","retrievedSamples","urlList","actualTotalSamples","aggregateByTime","grouped","sampleValues","calculateMean","calculateError","seen","key","add","getTimeSeriesStatistics","jsonData","uniqueLocations","uniqueLatitudes","uniqueLongitudes","valuesPerLocation","locString","totalValues","numUniqueLocations","latitudeSpacing","longitudeSpacing","getRegionCenter","lat","lon","fetchTimeseriesData","centerLat","centerLon","offsetter","TimeRangeOffsetter","timeRangesArray","localTimeRanges","sampler","EsriSampler","rawData","summary","timeseriesLength","fetchCenterPointData","rectangle","center","validSamples","upper","squaredDiffs","pow","squaredSEM","countTimestampsInRanges","counts","timestampIndex","binarySearchStart","target","left","right","binarySearchEnd","startIdx","getTimestampsInRange","endIdx","_getOverlappingBoundaries","overlapping","overlappingBoundaries","boundary","splitStart","splitEnd","effectiveLimit","maxTimestampsPerRequest","timestampCounts","totalTimestampsAcrossAllRanges","timestampCount","timestampsInRange","chunkTimestamps","newRange","ONEDAYMS","useUniqueTimeSelection","timeIndex","singleDateSelected","minIndex","maxIndex","initialTimeSelection","getOneDaysTimestamps","mod","ts","getAllDaysTimestamps","setNearestDate","offset","uniqueDays","easternDates","days","unique","uniqueDaysIndex","e","getUniqueDayIndex","findIndex","day","moveBackwardOneDay","currentIndex","moveForwardOneDay","nextIndex","nearestDate","nearestDateIndex","setNearestTime","selectedDate","sameDay","getFullYear","getMonth","getDate","uniqueDayIndex","newTimestamps","immediate","useTimezone","selectedTimezone","toTimezone","utcDate","fromTimezone","setToMidnight","zonedDate","setHours","setToEndOfDay","formatTimeLong","formatDuration","startUtc","endUtc","startZoned","endZoned","startTime","endTime","formatTimezoneRange","formatUTCRange","formatTime","Number","formatDateDisplay","toDateString","timezoneInfo","toLocaleString","timeZoneName","pop","isDST","standardOffset","currentOffset","timezoneOptions","dateIsDST","tz","atleast1d","formatSingleRange","startString","endString","formatTimeRange","allStarts","allEnds","minStart","maxEnd","rangeForSingleDay","dayUTC","areEquivalentMsRanges","first","second","areEquivalentTimeRanges","array","firstRange","rg","createTempoStore","backend","debugMode","regions","datasets","timestampsLoaded","tempoDataServices","backendRef","maxSampleCount","sampleErrors","regionsCreatedCount","userSelectedCalendarDates","userSelectedTimezones","userSelectedLocations","userSelectedNotableEvents","shareButtonClickedCount","playButtonClickedCount","timeSliderUsedCount","opacitySliderUsedCount","maps","datasetControlsOpen","layerControlsOpen","selectionActive","focusRegion","regionOpacity","regionVisibility","showFieldOfRegard","showRoads","showSamplingPreviewMarkers","showAdvancedLayers","showRGBMode","showAggregationControls","tzOptions","shownLayers","accentColor2","tempoRed","getTempoDataService","v03","v04","tds","TempoDataService","addTimeRange","deleteTimeRange","splice","_newDate","oldDate","oldRange","displayedDateSelections","sel","formatted","oldTimeRange","v4","description","zoomScale","urlParams","window","initLat","initLon","initZoom","initTime","initState","loc","zoom","homeLat","homeLon","homeZoom","homeState","addRegion","region","deleteDataset","dataset","addDataset","fetchDataForDataset","markDatasetUpdated","ds","setRegionName","newName","existing","setTimeRangeName","loading","geometryInfo","fetchCenterPointDataForDataset","datasetHasSamples","regionHasDatasets","deleteRegion","registerMap","deregisterMap","reset","loaded","useTempoStore","isDateLikeString","test","deserializeTempoStore","parse","entry","plotlyDatasets","plotlyDataset","datasetOptions","customdata","OMIT","serializeTempoStore","store","state","entries","$state","layer","stringified","postDeserializeTempoStore","updateStoreFromJSON","$patch","infoColor","HANDLE_SIZE_PX","DEFAULT_PANEL_WIDTH_PX","MIN_PANEL_WIDTH_PX","PLACEHOLDER_WIDTH_PX","localStorageKey","__name","setup","__props","root","leftHandle","rightHandle","query","VUE_APP_TEMPO_LAB_DEBUG","ignoreCache","cssVars","animationFrame","setBasis","panel","sizePx","flexBasis","getBasis","basis","getComputedStyle","updateSizes","layersDefault","datasetsDefault","layers","document","querySelector","layersWidth","clientWidth","datasetsWidth","storedState","localStorage","getItem","dragging","setupHandleEvents","handle","onMove","addEventListener","event","preventDefault","setPointerCapture","pointerId","body","classList","initialEventHandler","onUp","ev","releasePointerCapture","remove","removeEventListener","setHandleVisibility","visible","display","onDatasetPanelOpenChange","open","onLayersPanelOpenChange","leftPanel","onLeftMove","dx","clientX","minLeft","newLeftSize","initialLeftHandler","rightPanel","onRightMove","minRight","newRightSize","initialRightHandler","cancelAnimationFrame","requestAnimationFrame","visibilityState","setItem","_component_header_bar","_component_comparison_data_controls","_component_side_placeholder","_component_map_with_controls","_component_dataset_controls","ref_key","tooltips","disabled","activator","role","_hoisted_1","_hoisted_2","backgroundColor","startValue","endValue","cmapName","nsteps","cmap","extend","mounted","colorbarGradient","random","triangles","showStartTriangle","showEndTriangle","cssLinearGradientFromCmap","colors","co","colorbar","firstChild","removeChild","div","createElement","className","background","height","appendChild","styleDownTriangle","styleUpTriangle","width","offsetWidth","offsetHeight","borderLeft","borderRight","borderBottom","borderTop","fontSize","styleLeftTriangle","styleRightTriangle","styleColorbarChunk","flexGrow","flexShrink","dialogVisible","activatorProps","tooltipTextValue","showTooltip","elevation","handleKeydown","helpText","tooltipText","icons","defaultSet","aliases","sets","mdi","locale","fallback","messages","en","defaultTheme","hide","hideButton","onClick","openDialog","prepend","snackbar","$attrs","timeout","actions","tabindex","variant","closeDialog","msg","$nextTick","snackbarMessage","$el","_component_use_clipboard","copy","tooltipDisabled","alert","transition","buttonColor","rounded","iconColor","getElementRect","element","rectPromise","_reject","resolveRectPromise","observer","IntersectionObserver","boundingClientRect","disconnect","observe","watchContainerSize","containerSelector","callback","container","closest","resizeObserver","ResizeObserver","contentRect","useDraggableDialog","dialogSelector","scrimSelector","dragInfo","mousedown","mouseup","mousemove","leftOffset","removeListeners","setupDraggable","dragPredicate","cursor","closestDialog","button","boundingRect","el","mouseStartX","mouseStartY","clientY","elStartX","elStartY","top","overlays","querySelectorAll","oldTransition","parent","parentElement","position","newLeft","innerWidth","newtop","innerHeight","parentRect","overlay","dialogs","dialog","newRoot","titleColor","shortTitle","draggable","scrim","persistent","modal","maxHeight","maxWidth","card","displayedShortTitle","cardRoot","attrs","updateRoot","close","stopPropagation","isVisible","showErrors","__emit","sampleKeyCounts","plot","graph","emit","datumToDate","datum","legendGroups","errorTraces","traceVisible","renderPlot","plotlyData","len","regionColor","dataT","dataV","legendGroup","legendgroup","showlegend","marker","errs","valueLower","valueHigher","low","high","line","fill","paddingFactor","axisMax","layout","yaxis","modeBarButtonsToRemove","displaylogo","newPlot","on","traceIndex","curveNumber","trace","group","dataId","currentlyVisible","updateErrorDisplay","restyle","newCounts","oldCounts","different","newData","oldData","selectedTimeRange","draftUserDataset","availableMolecules","o","creationProgress","percent","setDraftSelectionRegion","setDraftSelectionMolecule","setDraftSelectionTimeRange","composeSelection","draft","newRegions","exists","rid","selection","loader","indeterminate","highlight","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","href","rel","showChanges","showAboutData","showCredits","showSaveDialog","showErrorSnackbar","ioErrorMessage","touchscreen","supportsTouchscreen","smallSize","smAndDown","mobile","reportError","_error","_component_cds_dialog","_component_save_state","src","alt","changes","change","titleBarPredicate","allowedDates","formatFunction","clearable","textInput","teleport","dark","startDateCalendar","endDateCalendar","startDateObj","endDateObj","errMessage","handleStartDateChange","closeMenu","handleEndDateChange","_component_date_picker","formats","enableTimePicker","preview","monthItemWidthPx","showErrorForEmpty","selectedDays","empty","columns","updateColumnCount","getElementById","selectedMonths","for","possibleYears","selectedYears","year","full","three","short","one","sortedDays","dayOrder","timeFormat","ampm","h12","selectedTimes","timePlusMinus","timeOptions","allDay","_selectedTimesRef","selectedTimesRef","normalizeTimes","direction","multiple","chips","hint","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","validationResults","validation","formatDate","formatDateTime","formatTolerance","tolerance","before","after","countNotAllowedRange","allowedDateSet","toISOString","startDateStr","endDateStr","getRangeValidationClass","_index","getItemValidationError","dateToDayRange","startUTC","UTC","endUTC","filterForAllowedDates","filteredRanges","allowedDayRanges","rangeIndex","dayIndex","currentRange","currentDayRange","hasOverlap","validTimes","validate","enableParceling","tab","currentDateRef","singleDateCalendar","timeSelectionRadio","singleDateObj","datePickerYearRange","minYear","maxYear","dates","currentDateString","timeSelectionMode","newVal","dayNames","monthNames","timeRangeStart","minMonth","monthIndex","utc","timeRangeEnd","maxMonth","lastDay","timeRangeSelectedMonths","timeRangeSelectedYears","timeRangeConfig","patternConfig","invalidConfig","asRangeOrList","sortedArrr","isConsecutive","customTimeRangeName","dateRangeString","monthsString","yearsString","daysString","timesString","currentTimeRanges","submissionTried","updateCustomRange","doEmit","currentRanges","handleSingleDateChange","deep","dtrsRoot","containerSize","setDate","mandatory","crossfade","focusable","aggregateData","aggFunc","errorFunc","aggY","aggE","cleanY","cleanE","calE","finalError","START_WEEK_ON_MONDAY","getBeginningOfWeek","getDay","weekStart","dayOfYear","oneDay","getWeekOfYearSundayStart","currentDayOfYear","januaryFirst","dayOfYearStart","getWeekOfYearMondayStart","getWeekOfYear","daysInMonth","getDaysInYear","altFloorHour","msPerHour","floorWeekendWeekday","_date","isWeekday","MS_IN_SECOND","setMilliseconds","setSeconds","MS_IN_MINUTE","MS_IN_WEEK","method","errorMethod","includeCalibrationUncertainty","_getZonedDate","getGroupId","groupDate","groupDay","utcMidnight","groupData","timeseries","groups","groupId","groupValues","errorValues","sortfoldBinContent","bin","binPhase","bp","sortedIndices","applySort","rawValues","lowers","uppers","foldType","_binCount","Infinity","_binIndex","z","getHours","yearStart","season","seasonStartMonths","yearOff","seasonStart","dayOfSeason","dayOfMonth","seasonStartMonth","zBinStart","isWeekend","_binPhase","getMinutes","seconds","getSeconds","milliseconds","getMilliseconds","hourOfDay","dayOfWeek","foldData","binCount","binsRecord","binIndex","numericValues","calibrationErrors","isNonePeriod","publicBins","binDate","bins","plotlyGridStyles","num2TimeLabel","toFixed","timeLabelAlias","hasDecimal","weekdayWeekendAlias","dayHour","_defaultyAxisStyle","foldTypeStyles","xaxis","tickmode","tick0","nticks","labelalias","tickvals","ticktext","minor","gridcolor","gridwidth","showgrid","ticklen","dtick","tickformat","getFoldTypeStyle","deepMerge","mergeFoldTypeLayout","customLayout","foldStyle","xaxisTitle","prefix","normalizeBadValue","createErrorBands","datasetName","upperY","lowerY","traceErrorOptions","dataHasErrors","hasUpper","hasLower","sameLength","isSymmetric","hasErrors","createErrorBars","symmetric","arrayminus","filterNullValues","filteredX","filteredY","filteredLower","filteredUpper","filteredCustomData","errorType","_appendDataPoint","_createEmptyDatasetCopy","splitDatasetByGap","xValues","gaps","medianGap","threshold","datasetsByGap","currentDataset","gap","DEFAULT_PLOT_LAYOUT","dragmode","modebar","activecolor","DEFAULT_MODEBAR_BUTTONS_TO_REMOVE","DEFAULT_PLOT_CONFIG","dataOptions","errorBarStyles","names","layoutOptions","configOptions","showZero","yaxisTitle","generateHash","string","hash","char","charCodeAt","hashDataset","legendGroupVisible","filterNulls","_plotlyData","validY","useErrorBands","jindex","errorOptions","thickness","_e","dataTraceOptions","isErrorBar","useErrorBar","newMax","newMin","errorBandsVisible","isErrorBand","useErrorBand","yValues","axisMin","autorange","getTraceGroupVisibility","visibility","setLegendGroupErrorVisibility","setErrorVisibilityForTrace","update","updateAllErrorVisibility","onResize","relayout","autosize","updateDatasetMeta","useErrorBars","purge","_newData","_oldData","newHashes","oldHashes","timezones","browserTimeZone","Intl","DateTimeFormat","resolvedOptions","cloneTimeFromLocalToBrowser","rezonedDatasets","newX","mergedLayoutOptions","foldingPeriodOptions","timeBinOptions","methodOptions","originalDataPointCount","foldedDataPointCount","canSave","validFoldingForData","validTimeBinForData","isValidCombination","useTzCenter","useSEM","alignDataToBinCenters","disableIncludePhaseCheckbox","selectedFoldType","selectedFoldingPeriod","selectedTimeBin","selectedMethod","foldedData","_component_info_button","column","option","outline","validTimeBinsForFoldingPeriod","timeBin","foldingPeriod","getFirstValidTimeBin","validTimeBins","dialogOpen","theColor","customColor","MS_IN_MONTH","MS_IN_YEAR","timeBinDurations","foldingPeriodDurations","dataDuration","minMax","aggregationWarning","allFoldingPeriodOptions","newPeriod","validTimeBin","period","charAt","toUpperCase","isHourBinned","isFoldWithNoBin","includeBinPhase","alignToBinCenter","disableBinCenterCheckbox","validPeriods","opt","isNone","regionCenter","tzCenter","foldedDatasetName","foldedSelection","graphData","timeseriesToDataSet","sortedEntries","tsa","tsb","aggValue","foldedTimesSeriesToDataSet","foldedTimeSeries","binIndexa","binIndexb","setMinutes","foldedTimeSeriesRawToDataSet","binContent","sortedBinContent","rv","up","hovertemplate","updateGraphData","original","selectionToTimeseries","createFoldedTimeRange","originalRange","updateAggregatedData","timeSeriesData","grouper","TimeSeriesFolder","handlePointClick","saveFolding","folded","raw","newvValue","_component_local_scope","descriptor","l","automargin","standoff","legend","yanchor","yref","orientation","bordercolor","borderwidth","entrywidthmode","entrywidth","aggControlsVisible","handlePlotClick","saveFolded","inheritAttrs","confirmText","minWidth","local","onConfirm","autofocus","turnOnSelection","selectedDatasets","datasetRowRefs","isFolded","datesetsWithNotFoldedFisrt","aFolded","bFolded","showDetails","isHovering","ref_for","ripple","slim","fn","STOP_WORDS","camelToSentance","out","c","word","camelToSnake","delimeter","DAY_NAMES","MONTH_NAMES","REFERENCE_LEAP_YEAR","normalizeFoldTypeForLabels","formatHourLabel","hourValue","isFinite","wrapped","dayIndexToMonthDay","remaining","lastMonth","formatMonthDay","monthName","formatFoldedBinValue","normalizedFoldType","dayName","week","foldedDataBinUnit","foldTypeToLabel","cleanOutput","_length","_skippedPoints","_size","_x","_y","_lower","_upper","_addPointWithError","_addPointNoError","addPoint","build","isFull","userDatasetToPlotly","useLocalTime","plotlyBuilder","PlotlyDatasetBuilder","useTz","dateToCODAPStrings","utcDateTime","localDateTime","localDate","localTime","utcOffsetHours","getTimezoneOffset","createCODAPMeta","errorMes","regionCenterCoords","convertSamplesToJson","columnDensity","uncertainty","_toSafeString","json2Csv","includeHeaders","includeMeta","includeUnits","delimiter","_headers","headers","rows","row","csvRows","units","unitRow","u","unshift","csv2FixedWidth","csvData","csvDelimiter","fixedWidthDelimiter","lines","colWidths","cell","fixedWidthLines","padEnd","samplesToJSON","foldedSamplesToJSON","foldedDataSet","useTimes","fileOptions","fixedWidth","clipboardOptions","isLoading","startLoading","performance","bothReady","endLoading","fileCSV","clipboardCSV","getfileCSV","csv","getclipboardCSV","csvDownloadLink","setupFileAndUrls","revokeObjectURL","blob","Blob","createObjectURL","downloadCsv","click","oldVal","download","isSupported","FILE_DELIMITER","FIXED_WIDTH_DELIMITER","DOWNLOAD_FILE_FIXED_WIDTH","CLIPBOARD_DELIMITER","toDate","dateStyle","toTime","toDateTime","formatValue","formatError","sampleHeaders","children","samplesItems","getSamplesItems","foldPeriod","errorTypeStrinc","foldedHeaders","foldedItems","getfFoldedItems","getJsonData","processData","requestIdleCallback","onShowClick","foldTypeToHumanReadable","ft","pascalToSnake","dlayoutOptions","dconfigOptions","responsive","ddataOptions","defaultOpt","foldedDatasets","byGroup","normalDatasets","datasetIsFolded","isSingle","commonLayoutOptions","commonConfigOptions","datasetsGroupedByMolecule","nameOnly","colorOnly","model","changed","save","cancel","globalKeydownHandler","skipTags","tagName","placeholder","minlength","popupCardWidth","openPanels","openGraphs","openSelection","tableSelection","currentlyEditingDataset","showConfirmReset","showMultiPlot","createTimeRangeActive","createDatasetActive","sampleErrorID","showEditRegionNameDialog","regionBeingEdited","showEditTimeRangeNameDialog","timeRangeBeingEdited","aggregationDataset","showAggregationDialog","openAggregationDialog","handleAggregationSaved","aggregatedSelection","fromCharCode","handleDatasetCreated","_stats","completed","total","showDatasetEditor","datasetEditorNameOnly","handleEditDataset","removeDataset","handleDateTimeRangeSelectionChange","selectionType","customName","countTimeRanges","editRegionName","editTimeRangeName","allDatasetSelection","showErrorBands","showUserDatasetTable","_component_popup_info_button","_component_selection_composer","active","step","opacity","striped","bottom","block","dense","_component_layer_order_control","mapRef","radio","calendar","newMol","transitions","useLocationMarker","show","showLocationMarker","locationMarker","addToMap","addTo","setMarker","latlng","lnglat","setLngLat","removeMarker","baseUseSelection","handler","updateListeners","dragPan","disable","scrollZoom","onMousedown","onMouseup","onMousemove","enable","off","mMap","nowActive","getCanvas","newMap","selectionInfo","useRectangleSelection","interactColor","geoJson","rectangleSource","rectangleLayer","startCoords","uuid","lngLat","lng","addSource","getSource","addLayer","paint","getLayer","eventCoords","removeLayer","removeSource","setData","createBounds","addRectangleLayer","removeRectangleLayer","addPointLayer","removePointLayer","regionBounds","pointPadding","fitBounds","bounds","_fly","usePointSelection","paulTolMutedColorblindSafeColors","wongColorblindSafeColors","COLORS","DEG_DEFAULT","PX_DEFAULT","toGeoJSON","radius_deg","pt","radius_px","useMultiMarker","sourceId","layerId","optionsToPaint","fillColor","fillOpacity","outlineColor","addMarkers","clearMarkers","geojson","scale","radius","degreeToPixel","isNumeric","setLayerOpacity","paintProp","setPaintProperty","getPaintProperty","getLayerOpacity","op","getLayerVisibility","getLayoutProperty","setLayerVisibility","setLayoutProperty","devicePixelRatio","retinaParam","useMap","_showRoads","onReady","addStates","addCoastlines","addRoads","tiles","tileSize","minzoom","maxzoom","moveLayer","addLabels","setupMap","libreMap","cleanupMap","createMap","_map","attributionControl","addControl","AttributionControl","compact","setView","setCenter","setZoom","getCenter","resetView","centerLonLat","onHome","_centerLonLat","_zoom","_onHome","onAdd","_container","_button","_goHome","bind","_homeIcon","padding","svg","encodeURIComponent","onRemove","parentNode","flyTo","usezoomhome","home","startingCenter","zoomHome","createControl","control","CDSMaplibreHomeTool","NavigationControl","showCompass","newValue","mapID","initial","events","__expose","latitude","longitude","showRoadsRef","attachAllEvents","handlers","evt","detachAllEvents","promiseResolve","mapReady","whenMapReady","onMapReady","newLat","newLng","newZoom","getZoom","exposedMapApi","once","cleanTrailingSlash","getServiceDetails","fetchOptions","reject","POWERED_BY_ESRI_ATTRIBUTION_STRING","updateAttribution","newAttribution","attributionController","_controls","customAttribution","sourceCaches","_source","attribution","_otherSourceCaches","_updateAttributions","ImageService","constructor","esriServiceOptions","rasterSrcOptions","_sourceId","_defaultEsriOptions","dpi","getAttributionFromService","_createSource","_serviceMetadata","setAttributionFromService","_time","to","valueOf","bboxSR","imageSR","_updateSource","_options","setTiles","clearTiles","transform","setRenderingRule","rule","setMosiacRule","copyrightText","identify","returnGeometry","canvas","getBounds","toArray","sr","imageDisplay","mapExtent","_layersStr","layerDefs","_layerDefs","useEsriTimesteps","initialMolecule","updateOnMount","loadingTimesteps","esriTimesteps","updateEsriTimeSteps","finally","refresh","useTempoLayer","esriLayerOptions","esriLayerId","layerName","esriImageSource","fetchOnMount","opacityRef","noEsriData","loadingEsriTimeSteps","initRGB","ramps","renderOptions","initVisible","getStyle","dynamicMapService","onSourceLoad","isSourceLoaded","updateEsriOpacity","updateEsriTimeRange","setVisibility","createImageService","addEsriSource","svc","removeEsriSource","hasEsriSource","setDynamicMapServiceDate","nearest","currentUrl","updateStretch","vmin","vmax","updateColormap","_timesteps","_value","_newMol","newColormap","useFieldOfRegard","usingAugust","fieldOfRegardLayer","fieldOfRegardLayerId","createFoRLayer","clearFoR","updateFieldOfRegard","addFieldOfRegard","maplibreLayerName","innerMap","timestampRef","theEsriLayer","newSteps","old","oldMap","dt","internalShowFieldOfRegard","onInnerMapReady","exposedApi","listener","contained","downloadCanvasToImage","filename","dataUrl","toDataURL","link","downloadMap","redraw","lerp","spline","clamp","cmin","cmax","reversed","redValues","greenValues","blueValues","normalizedVal","sampleColormap","createHeatmapColorMap","transparentTo","transparentAdded","colormapFunction","POWER_PLANT_COLORS","batteries","biomass","coal","geothermal","hydroelectric","nuclear","other","petroleum","solar","wind","addPowerPlants","startVisible","powerPlantsLayerId","powerPlantsHeatmapLayerId","powerPlantsSourceId","powerPlantsVisible","loadPromise","togglePowerPlants","vis","layerIDs","isValidMap","ensureDataLoaded","popup","Popup","closeButton","closeOnClick","currentFeatureCoordinates","featureCoordinates","Plant_Name","Total_MW","setHTML","addheatmapLayer","pixelRatio","extraTagsOption","excludeDirectChildren","removeSpace","trimSpace","splitSpace","okhash","getElementsByTagName","attr","getAttribute","attrf","get1","norm","normalize","numarray","nodeVal","textContent","getMulti","ys","k","coord1","coord","coords","coordPair","ll","ele","heartRate","fc","serializer","XMLSerializer","xml2str","str","xml","serializeToString","kml","doc","gj","styleIndex","styleByHash","styleMapIndex","geotypes","placemarks","styles","styleMaps","pairs","pairsMap","getPlacemark","addExtraTags","tag","childNodes","node","nodeType","localName","nodeName","kmlColor","substr","gxCoord","gxCoords","elems","timeElems","getGeometry","geomNode","geomNodes","geoms","coordTimes","coordsText","ringCoordsText","track","styleUrl","lineStyle","polyStyle","geomsAndTimes","address","timeSpan","timeStamp","extendedData","styleHash","styleMapHash","normal","iconStyle","begin","timespan","linestyles","stroke","polystyles","pcolor","popacity","datas","simpleDatas","geometries","extraTags","gpx","tracks","routes","waypoints","getTrack","getRoute","getPoint","initializeArray","getPoints","pointname","pts","heartRates","segments","getProperties","getLineStyle","prop","routeObj","extensions","links","useAbortableFetch","abortController","abortableFetch","init","controller","AbortController","signal","abort","parseXML","xmlString","parser","DOMParser","parseFromString","errorNode","useKML","kmlUrl","geoJsonData","_convertKmlToGeoJson","kmlContent","kmlDoc","loadKML","requestedUrl","setUrl","newUrl","cleanUp","GlobalEcosystems","glccLabel","replaceYearDay","ydd","dateStr","replaceEcosystem","numStr","description2props","desc","vals","pair","postProcessGeoJson","processedFeatures","processedFeature","FRP","addHMSFire","internalSetUrl","getYearDay","yearDay","showPopup","idBase","labelLayerId","popupRef","onEnterRef","onMoveRef","onLeaveRef","onStyleDataRef","lastKnownVisible","layerVisible","preloadImages","images","hasImage","loadImage","img","addImage","setupLayerPopup","onEnter","addClassName","onLeave","setupVisibilitySync","syncLabelVisibility","mainVis","labelVis","cleanupMapLayers","iconUrl","circleRadiusExpression","meters","stops","flatMap","PI","toggleFireVisibility","removeFromMap","AQI_STYLE_COLORS","getAqiColorFromStyleUrl","styleUrlRaw","addQUI","propertyToShow","labelMinZoom","showLabel","styleURL","valueProp","toggleAQIVisibility","useEsriImageServiceLayer","serviceUrl","_timestamp","variableRef","esriOptions","exportImageOptions","clickValue","_hasEsriSource","densityVar","densityRaster","gpw4url","populationLayerOptions","addPopulationDensityLayer","popLayer","layerOptions","addLandUseLayer","maplibreMap","currentTempoDataService","createSelectionComputed","pointSelectionActive","rectangleSelectionActive","rectangleInfo","pointInfo","pp","airQualityUrl","aqiLayer","sentinalLandUseLayer","hmsFire","hchoLayer","ozoneLayer","no2Layer","addAdvancedLayers","removeAdvancedLayers","updateRegionLayers","resize","newMolecule","cMode","colormapsToUse","stretchesToUse","playing","playInterval","activateRectangleSelectionMode","activatePointSelectionMode","regionLayers","colorMap","mol","currentColorbarOptions","cc","thumbLabel","dateObj","getUTCHours","amPm","getUTCMinutes","defaultMapboxOptions","types","countries","limit","geocodingInfoForSearchLimited","token","opts","access_token","geocodingInfoForSearch","_err","setLocationFromSearch","onZoomhome","updateURL","stateObj","origin","searchParams","pathname","history","replaceState","onEsriTimestepsLoaded","play","setInterval","pause","clearInterval","rectangleIsDegenerate","isRect","layerInfo","createRegion","getRegionsDifference","ids2","existingRegions","added","removed","newRegion","samplingPreviewMarkers","shape","tempoDataService","regs","_component_location_search","_component_icon_button","_component_map_controls","infoText","cardProps","checkArrayEquality","arrayMove","fromIndex","toIndex","listeners","dispatchEvent","cleanup","initialOrder","_initialized","_eventHandlers","_layerOrder","_linked","_desiredLayerOrder","_keepAtTop","keepAtTop","linkedLayers","_newLink","idleListener","_orderLayers","_watchForChanges","hasLayer","getLayersOrder","_checkLayerChanges","orderAtLastCheck","currentOrder","currentlyManagedLayerOrder","_moveLayerBelow","anchor","_moveLayerAbove","anchorIndex","nextLayerUpIndex","nextLayerUp","_applyLinkedLayers","mapOrder","linked","primary","primaryIndex","belowPrimary","abovePrimary","linkage","layersToLink","setLinkedLayers","_maintainOrder","linkLayers","startAtTop","bottomLayer","topLayer","safeMoveLayerBelow","check","availableDesiredOrder","onStyleData","destroy","_moveLayer","newIndex","currentLayerIndex","newLayerOrder","_moveActualLayerByIndex","maintainOrder","_moveActualLayer","layerAtNewIndex","oldLayerOrderIndex","newLayerOrderIndex","moveToFront","topIndex","moveToBack","moveUp","moveDown","setOrder","setKeepAtTop","reverseLayerOrder","layerToMove","layerItShouldBeBelow","safeMoveLayerAbove","layerItShouldBeAbove","setManagedOrder","newManagedOrder","managedLayerMap","newDesiredOrder","managedIndex","PsuedoEvent","useMaplibreLayerOrderControl","moveToTop","desiredOrder","initialized","mapValue","MaplibreLayerOrderControl","capitalizeWords","isOpen","static","citation","subtitle","miniOptions","labelIndices","colorIndices","mini","tempoPrefix","connections","getConnectedItems","displayOrder","layerNames","hasLegend","displayNameTransform","cbarLabel","power","log10","_component_colorbar_horizontal","_component_power_plants_filter_control","_component_layer_control_item","extras","cbar","useMaplibreLayerOpacity","initialOpacity","useMaplibreLayerVisibility","initialVisibility","displayName","syncedItems","syncOpacityAndVisibility","syncedLayerId","slots","showInfo","modelModifiers","minColumnWidthPx","PLANT_CATEGORIES","selectedSources","SOURCES_BY_CATEGORY","Renewables","Other","openPanel","openAllPanels","turnOnPowerPlants","handleGlobalSelect","handleCategoryGlobalSelect","category","onLayersChanged","newLayers","applyPrimSourceFilter","sources","layerIds","setFilter","_entries","newLayerIds","oldLayerIds","hasNewLayers","visibilityChanged","oldLayer","newLayer","_component_icon_checkbox","onIcon","offIcon","onColor","offColor","DEFAULT_FILENAME","saveLocalFileSystemAPI","suggestedName","accept","content","showSaveFilePicker","createWritable","stream","write","DOMException","saveLocalLink","saveLocal","loadLocalFileSystemAPI","showOpenFilePicker","handles","getFile","file","loadLocalInput","files","reader","FileReader","onload","readAsText","loadLocal","openDirection","openArrowColor","closedArrowColor","openTooltipText","closedTooltipText","closeDirection","openIcon","closedIcon","toggleOpen","binding","TempoLab","use","vuetify","directive","beforeMount","_vnode","_prevVnode","updated","component","IconButton","FundingAcknowledgement","CreditLogos","LocationSearch","InfoButton","ColorBarHorizontal","SnackbarAlert","ShareButton","CDSDialog","MarqeeAlert","TimeseriesGraph","SelectionComposer","DatasetControls","ComparisonDataControls","MapControls","MapWithControls","HeaderBar","PopupInfoButton","MaplibreLayerControlItem","LayerOrderControl","PowerPlantsFilterControl","IconCheckbox","SaveState","SidePlaceholder","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","deferred","O","chunkIds","priority","notFulfilled","fulfilled","getter","__esModule","definition","defineProperty","enumerable","globalThis","obj","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}